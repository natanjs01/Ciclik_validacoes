const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pdf-vendor-CF3S67IK.js","assets/ui-vendor-DuOoIZVh.js","assets/react-vendor-DgfAWB4r.js","assets/chart-vendor-BhWYehn7.js"])))=>i.map(i=>d[i]);
var L8=Object.defineProperty;var O2=e=>{throw TypeError(e)};var F8=(e,t,r)=>t in e?L8(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var um=(e,t,r)=>F8(e,typeof t!="symbol"?t+"":t,r),w1=(e,t,r)=>t.has(e)||O2("Cannot "+r);var Ue=(e,t,r)=>(w1(e,t,"read from private field"),r?r.call(e):t.get(e)),Ss=(e,t,r)=>t.has(e)?O2("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),rs=(e,t,r,a)=>(w1(e,t,"write to private field"),a?a.call(e,r):t.set(e,r),r),dr=(e,t,r)=>(w1(e,t,"access private method"),r);var A0=(e,t,r,a)=>({set _(n){rs(e,t,n,r)},get _(){return Ue(e,t,a)}});import{j as s,V as LS,R as FS,A as BS,C as VS,T as US,D as zS,P as B8,c as bi,a as Tf,u as br,b as vg,d as ys,e as Ts,f as il,g as Sw,h as Tw,i as V8,k as Aw,l as $S,m as Ai,n as No,o as kw,_ as U8,p as yg,S as z8,q as wg,r as Af,s as qS,I as WS,t as Rw,v as Ji,w as HS,x as GS,y as KS,F as XS,z as $8,B as dc,E as YS,G as ZS,O as zu,H as $u,J as $p,K as kf,L as Rf,M as qp,N as Wp,Q as bg,U as _g,W as QS,X as q8,Y as JS,Z as e4,$ as W8,a0 as t4,a1 as s4,a2 as r4,a3 as a4,a4 as n4,a5 as i4,a6 as o4,a7 as H8,a8 as G8,a9 as Jm}from"./ui-vendor-DuOoIZVh.js";import{a as _u,r as E,R as He,b as Om,u as ds,e as jg,N as ic,f as l4,L as c4,g as qu,d as rd,h as To,B as K8,i as X8,j as cs}from"./react-vendor-DgfAWB4r.js";import{c as d4,P as Wt,R as mi,a as Pw,b as Iw,C as Ow,T as pi,d as Y8,e as go,X as vo,Y as yo,L as Yo,B as Rl,f as El,g as _x,h as ju}from"./chart-vendor-BhWYehn7.js";import{E as Z8,_ as Ov,G as Q8,D as J8,P as e6}from"./pdf-vendor-CF3S67IK.js";function t6(e,t){for(var r=0;r<t.length;r++){const a=t[r];if(typeof a!="string"&&!Array.isArray(a)){for(const n in a)if(n!=="default"&&!(n in e)){const i=Object.getOwnPropertyDescriptor(a,n);i&&Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:()=>a[n]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var u4,D2=_u;u4=D2.createRoot,D2.hydrateRoot;const s6=1,r6=1e6;let b1=0;function a6(){return b1=(b1+1)%Number.MAX_SAFE_INTEGER,b1.toString()}const _1=new Map,M2=e=>{if(_1.has(e))return;const t=setTimeout(()=>{_1.delete(e),Dm({type:"REMOVE_TOAST",toastId:e})},r6);_1.set(e,t)},n6=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,s6)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?M2(r):e.toasts.forEach(a=>{M2(a.id)}),{...e,toasts:e.toasts.map(a=>a.id===r||r===void 0?{...a,open:!1}:a)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)}}},ox=[];let lx={toasts:[]};function Dm(e){lx=n6(lx,e),ox.forEach(t=>{t(lx)})}function i6({...e}){const t=a6(),r=n=>Dm({type:"UPDATE_TOAST",toast:{...n,id:t}}),a=()=>Dm({type:"DISMISS_TOAST",toastId:t});return Dm({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:n=>{n||a()}}}),{id:t,dismiss:a,update:r}}function _r(){const[e,t]=E.useState(lx);return E.useEffect(()=>(ox.push(t),()=>{const r=ox.indexOf(t);r>-1&&ox.splice(r,1)}),[e]),{...e,toast:i6,dismiss:r=>Dm({type:"DISMISS_TOAST",toastId:r})}}const L2=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,F2=d4,Pf=(e,t)=>r=>{var a;if((t==null?void 0:t.variants)==null)return F2(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:n,defaultVariants:i}=t,o=Object.keys(n).map(h=>{const p=r==null?void 0:r[h],x=i==null?void 0:i[h];if(p===null)return null;const v=L2(p)||L2(x);return n[h][v]}),c=r&&Object.entries(r).reduce((h,p)=>{let[x,v]=p;return v===void 0||(h[x]=v),h},{}),d=t==null||(a=t.compoundVariants)===null||a===void 0?void 0:a.reduce((h,p)=>{let{class:x,className:v,...b}=p;return Object.entries(b).every(N=>{let[_,C]=N;return Array.isArray(C)?C.includes({...i,...c}[_]):{...i,...c}[_]===C})?[...h,x,v]:h},[]);return F2(e,o,d,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o6=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),h4=(...e)=>e.filter((t,r,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var l6={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c6=E.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:n="",children:i,iconNode:o,...c},d)=>E.createElement("svg",{ref:d,...l6,width:t,height:t,stroke:e,strokeWidth:a?Number(r)*24/Number(t):r,className:h4("lucide",n),...c},[...o.map(([h,p])=>E.createElement(h,p)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=(e,t)=>{const r=E.forwardRef(({className:a,...n},i)=>E.createElement(c6,{ref:i,iconNode:t,className:h4(`lucide-${o6(e)}`,a),...n}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d6=Et("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=Et("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=Et("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u6=Et("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qn=Et("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h6=Et("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f6=Et("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dw=Et("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cx=Et("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=Et("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m6=Et("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p6=Et("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=Et("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jx=Et("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Su=Et("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x6=Et("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f4=Et("ChartNoAxesColumnIncreasing",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g6=Et("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=Et("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const If=Et("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m4=Et("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xi=Et("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v6=Et("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B2=Et("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=Et("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tr=Et("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _n=Et("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yi=Et("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=Et("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p4=Et("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gn=Et("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hc=Et("CloudOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j1=Et("Cog",[["path",{d:"M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z",key:"sobvz5"}],["path",{d:"M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z",key:"11i496"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dx=Et("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ep=Et("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tp=Et("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mw=Et("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ua=Et("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gc=Et("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x4=Et("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nx=Et("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mm=Et("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ki=Et("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y6=Et("FileChartColumnIncreasing",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M12 18v-4",key:"q1q25u"}],["path",{d:"M16 18v-6",key:"15y0np"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jl=Et("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w6=Et("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b6=Et("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qa=Et("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Of=Et("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jn=Et("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eh=Et("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xa=Et("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _6=Et("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j6=Et("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dv=Et("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g4=Et("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V2=Et("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N6=Et("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cr=Et("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C6=Et("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=Et("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E6=Et("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gc=Et("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sf=Et("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Co=Et("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S6=Et("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lw=Et("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T6=Et("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A6=Et("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k6=Et("Navigation2",[["polygon",{points:"12 2 19 21 12 17 5 21 12 2",key:"x8c0qg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R6=Et("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P6=Et("PackageSearch",[["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}],["circle",{cx:"18.5",cy:"15.5",r:"2.5",key:"b5zd12"}],["path",{d:"M20.27 17.27 22 19",key:"1l4muz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=Et("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I6=Et("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U2=Et("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O6=Et("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fw=Et("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z2=Et("PhoneCall",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}],["path",{d:"M14.05 2a9 9 0 0 1 8 7.94",key:"vmijpz"}],["path",{d:"M14.05 6A5 5 0 0 1 18 10",key:"13nbpp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bw=Et("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N1=Et("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=Et("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v4=Et("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Da=Et("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ur=Et("Recycle",[["path",{d:"M7 19H4.815a1.83 1.83 0 0 1-1.57-.881 1.785 1.785 0 0 1-.004-1.784L7.196 9.5",key:"x6z5xu"}],["path",{d:"M11 19h8.203a1.83 1.83 0 0 0 1.556-.89 1.784 1.784 0 0 0 0-1.775l-1.226-2.12",key:"1x4zh5"}],["path",{d:"m14 16-3 3 3 3",key:"f6jyew"}],["path",{d:"M8.293 13.596 7.196 9.5 3.1 10.598",key:"wf1obh"}],["path",{d:"m9.344 5.811 1.093-1.892A1.83 1.83 0 0 1 11.985 3a1.784 1.784 0 0 1 1.546.888l3.943 6.843",key:"9tzpgr"}],["path",{d:"m13.378 9.633 4.096 1.098 1.097-4.096",key:"1oe83g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kn=Et("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sl=Et("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wu=Et("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zi=Et("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D6=Et("ScanLine",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M6=Et("Scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eo=Et("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k0=Et("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cx=Et("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ex=Et("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vi=Et("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $2=Et("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Md=Et("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nd=Et("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sp=Et("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eo=Et("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q2=Et("TicketPercent",[["path",{d:"M2 9a3 3 0 1 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 1 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"1l48ns"}],["path",{d:"M9 9h.01",key:"1q5me6"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"M15 15h.01",key:"lqbp3k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W2=Et("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=Et("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eu=Et("TreeDeciduous",[["path",{d:"M8 19a4 4 0 0 1-2.24-7.32A3.5 3.5 0 0 1 9 6.03V6a3 3 0 1 1 6 0v.04a3.5 3.5 0 0 1 3.24 5.65A4 4 0 0 1 16 19Z",key:"oadzkq"}],["path",{d:"M12 19v3",key:"npa21l"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y4=Et("TreePine",[["path",{d:"m17 14 3 3.3a1 1 0 0 1-.7 1.7H4.7a1 1 0 0 1-.7-1.7L7 14h-.3a1 1 0 0 1-.7-1.7L9 9h-.2A1 1 0 0 1 8 7.3L12 3l4 4.3a1 1 0 0 1-.8 1.7H15l3 3.3a1 1 0 0 1-.7 1.7H17Z",key:"cpyugq"}],["path",{d:"M12 22v-3",key:"kmzjlo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vw=Et("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ir=Et("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const un=Et("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wo=Et("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tl=Et("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wd=Et("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mv=Et("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ri=Et("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=Et("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sx=Et("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=Et("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Go=Et("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),Uw="-",L6=e=>{const t=B6(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:a}=e;return{getClassGroupId:o=>{const c=o.split(Uw);return c[0]===""&&c.length!==1&&c.shift(),w4(c,t)||F6(o)},getConflictingClassGroupIds:(o,c)=>{const d=r[o]||[];return c&&a[o]?[...d,...a[o]]:d}}},w4=(e,t)=>{var o;if(e.length===0)return t.classGroupId;const r=e[0],a=t.nextPart.get(r),n=a?w4(e.slice(1),a):void 0;if(n)return n;if(t.validators.length===0)return;const i=e.join(Uw);return(o=t.validators.find(({validator:c})=>c(i)))==null?void 0:o.classGroupId},H2=/^\[(.+)\]$/,F6=e=>{if(H2.test(e)){const t=H2.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},B6=e=>{const{theme:t,prefix:r}=e,a={nextPart:new Map,validators:[]};return U6(Object.entries(e.classGroups),r).forEach(([i,o])=>{Lv(o,a,i,t)}),a},Lv=(e,t,r,a)=>{e.forEach(n=>{if(typeof n=="string"){const i=n===""?t:G2(t,n);i.classGroupId=r;return}if(typeof n=="function"){if(V6(n)){Lv(n(a),t,r,a);return}t.validators.push({validator:n,classGroupId:r});return}Object.entries(n).forEach(([i,o])=>{Lv(o,G2(t,i),r,a)})})},G2=(e,t)=>{let r=e;return t.split(Uw).forEach(a=>{r.nextPart.has(a)||r.nextPart.set(a,{nextPart:new Map,validators:[]}),r=r.nextPart.get(a)}),r},V6=e=>e.isThemeGetter,U6=(e,t)=>t?e.map(([r,a])=>{const n=a.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,c])=>[t+o,c])):i);return[r,n]}):e,z6=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,a=new Map;const n=(i,o)=>{r.set(i,o),t++,t>e&&(t=0,a=r,r=new Map)};return{get(i){let o=r.get(i);if(o!==void 0)return o;if((o=a.get(i))!==void 0)return n(i,o),o},set(i,o){r.has(i)?r.set(i,o):n(i,o)}}},b4="!",$6=e=>{const{separator:t,experimentalParseClassName:r}=e,a=t.length===1,n=t[0],i=t.length,o=c=>{const d=[];let h=0,p=0,x;for(let C=0;C<c.length;C++){let T=c[C];if(h===0){if(T===n&&(a||c.slice(C,C+i)===t)){d.push(c.slice(p,C)),p=C+i;continue}if(T==="/"){x=C;continue}}T==="["?h++:T==="]"&&h--}const v=d.length===0?c:c.substring(p),b=v.startsWith(b4),N=b?v.substring(1):v,_=x&&x>p?x-p:void 0;return{modifiers:d,hasImportantModifier:b,baseClassName:N,maybePostfixModifierPosition:_}};return r?c=>r({className:c,parseClassName:o}):o},q6=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(a=>{a[0]==="["?(t.push(...r.sort(),a),r=[]):r.push(a)}),t.push(...r.sort()),t},W6=e=>({cache:z6(e.cacheSize),parseClassName:$6(e),...L6(e)}),H6=/\s+/,G6=(e,t)=>{const{parseClassName:r,getClassGroupId:a,getConflictingClassGroupIds:n}=t,i=[],o=e.trim().split(H6);let c="";for(let d=o.length-1;d>=0;d-=1){const h=o[d],{modifiers:p,hasImportantModifier:x,baseClassName:v,maybePostfixModifierPosition:b}=r(h);let N=!!b,_=a(N?v.substring(0,b):v);if(!_){if(!N){c=h+(c.length>0?" "+c:c);continue}if(_=a(v),!_){c=h+(c.length>0?" "+c:c);continue}N=!1}const C=q6(p).join(":"),T=x?C+b4:C,A=T+_;if(i.includes(A))continue;i.push(A);const k=n(_,N);for(let I=0;I<k.length;++I){const B=k[I];i.push(T+B)}c=h+(c.length>0?" "+c:c)}return c};function K6(){let e=0,t,r,a="";for(;e<arguments.length;)(t=arguments[e++])&&(r=_4(t))&&(a&&(a+=" "),a+=r);return a}const _4=e=>{if(typeof e=="string")return e;let t,r="";for(let a=0;a<e.length;a++)e[a]&&(t=_4(e[a]))&&(r&&(r+=" "),r+=t);return r};function X6(e,...t){let r,a,n,i=o;function o(d){const h=t.reduce((p,x)=>x(p),e());return r=W6(h),a=r.cache.get,n=r.cache.set,i=c,c(d)}function c(d){const h=a(d);if(h)return h;const p=G6(d,r);return n(d,p),p}return function(){return i(K6.apply(null,arguments))}}const pa=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},j4=/^\[(?:([a-z-]+):)?(.+)\]$/i,Y6=/^\d+\/\d+$/,Z6=new Set(["px","full","screen"]),Q6=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,J6=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,eD=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,tD=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,sD=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Jl=e=>Dh(e)||Z6.has(e)||Y6.test(e),Lc=e=>Df(e,"length",dD),Dh=e=>!!e&&!Number.isNaN(Number(e)),C1=e=>Df(e,"number",Dh),hm=e=>!!e&&Number.isInteger(Number(e)),rD=e=>e.endsWith("%")&&Dh(e.slice(0,-1)),lr=e=>j4.test(e),Fc=e=>Q6.test(e),aD=new Set(["length","size","percentage"]),nD=e=>Df(e,aD,N4),iD=e=>Df(e,"position",N4),oD=new Set(["image","url"]),lD=e=>Df(e,oD,hD),cD=e=>Df(e,"",uD),fm=()=>!0,Df=(e,t,r)=>{const a=j4.exec(e);return a?a[1]?typeof t=="string"?a[1]===t:t.has(a[1]):r(a[2]):!1},dD=e=>J6.test(e)&&!eD.test(e),N4=()=>!1,uD=e=>tD.test(e),hD=e=>sD.test(e),fD=()=>{const e=pa("colors"),t=pa("spacing"),r=pa("blur"),a=pa("brightness"),n=pa("borderColor"),i=pa("borderRadius"),o=pa("borderSpacing"),c=pa("borderWidth"),d=pa("contrast"),h=pa("grayscale"),p=pa("hueRotate"),x=pa("invert"),v=pa("gap"),b=pa("gradientColorStops"),N=pa("gradientColorStopPositions"),_=pa("inset"),C=pa("margin"),T=pa("opacity"),A=pa("padding"),k=pa("saturate"),I=pa("scale"),B=pa("sepia"),O=pa("skew"),D=pa("space"),F=pa("translate"),M=()=>["auto","contain","none"],z=()=>["auto","hidden","clip","visible","scroll"],q=()=>["auto",lr,t],Y=()=>[lr,t],ae=()=>["",Jl,Lc],je=()=>["auto",Dh,lr],H=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Z=()=>["solid","dashed","dotted","double","none"],G=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Q=()=>["start","end","center","between","around","evenly","stretch"],re=()=>["","0",lr],le=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ye=()=>[Dh,lr];return{cacheSize:500,separator:":",theme:{colors:[fm],spacing:[Jl,Lc],blur:["none","",Fc,lr],brightness:ye(),borderColor:[e],borderRadius:["none","","full",Fc,lr],borderSpacing:Y(),borderWidth:ae(),contrast:ye(),grayscale:re(),hueRotate:ye(),invert:re(),gap:Y(),gradientColorStops:[e],gradientColorStopPositions:[rD,Lc],inset:q(),margin:q(),opacity:ye(),padding:Y(),saturate:ye(),scale:ye(),sepia:re(),skew:ye(),space:Y(),translate:Y()},classGroups:{aspect:[{aspect:["auto","square","video",lr]}],container:["container"],columns:[{columns:[Fc]}],"break-after":[{"break-after":le()}],"break-before":[{"break-before":le()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...H(),lr]}],overflow:[{overflow:z()}],"overflow-x":[{"overflow-x":z()}],"overflow-y":[{"overflow-y":z()}],overscroll:[{overscroll:M()}],"overscroll-x":[{"overscroll-x":M()}],"overscroll-y":[{"overscroll-y":M()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[_]}],"inset-x":[{"inset-x":[_]}],"inset-y":[{"inset-y":[_]}],start:[{start:[_]}],end:[{end:[_]}],top:[{top:[_]}],right:[{right:[_]}],bottom:[{bottom:[_]}],left:[{left:[_]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",hm,lr]}],basis:[{basis:q()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",lr]}],grow:[{grow:re()}],shrink:[{shrink:re()}],order:[{order:["first","last","none",hm,lr]}],"grid-cols":[{"grid-cols":[fm]}],"col-start-end":[{col:["auto",{span:["full",hm,lr]},lr]}],"col-start":[{"col-start":je()}],"col-end":[{"col-end":je()}],"grid-rows":[{"grid-rows":[fm]}],"row-start-end":[{row:["auto",{span:[hm,lr]},lr]}],"row-start":[{"row-start":je()}],"row-end":[{"row-end":je()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",lr]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",lr]}],gap:[{gap:[v]}],"gap-x":[{"gap-x":[v]}],"gap-y":[{"gap-y":[v]}],"justify-content":[{justify:["normal",...Q()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Q(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Q(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[A]}],px:[{px:[A]}],py:[{py:[A]}],ps:[{ps:[A]}],pe:[{pe:[A]}],pt:[{pt:[A]}],pr:[{pr:[A]}],pb:[{pb:[A]}],pl:[{pl:[A]}],m:[{m:[C]}],mx:[{mx:[C]}],my:[{my:[C]}],ms:[{ms:[C]}],me:[{me:[C]}],mt:[{mt:[C]}],mr:[{mr:[C]}],mb:[{mb:[C]}],ml:[{ml:[C]}],"space-x":[{"space-x":[D]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[D]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",lr,t]}],"min-w":[{"min-w":[lr,t,"min","max","fit"]}],"max-w":[{"max-w":[lr,t,"none","full","min","max","fit","prose",{screen:[Fc]},Fc]}],h:[{h:[lr,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[lr,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[lr,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[lr,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Fc,Lc]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",C1]}],"font-family":[{font:[fm]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",lr]}],"line-clamp":[{"line-clamp":["none",Dh,C1]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Jl,lr]}],"list-image":[{"list-image":["none",lr]}],"list-style-type":[{list:["none","disc","decimal",lr]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[T]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[T]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Z(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Jl,Lc]}],"underline-offset":[{"underline-offset":["auto",Jl,lr]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:Y()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",lr]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",lr]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[T]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...H(),iD]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",nD]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},lD]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[N]}],"gradient-via-pos":[{via:[N]}],"gradient-to-pos":[{to:[N]}],"gradient-from":[{from:[b]}],"gradient-via":[{via:[b]}],"gradient-to":[{to:[b]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[T]}],"border-style":[{border:[...Z(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[T]}],"divide-style":[{divide:Z()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-s":[{"border-s":[n]}],"border-color-e":[{"border-e":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:["",...Z()]}],"outline-offset":[{"outline-offset":[Jl,lr]}],"outline-w":[{outline:[Jl,Lc]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:ae()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[T]}],"ring-offset-w":[{"ring-offset":[Jl,Lc]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Fc,cD]}],"shadow-color":[{shadow:[fm]}],opacity:[{opacity:[T]}],"mix-blend":[{"mix-blend":[...G(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":G()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[a]}],contrast:[{contrast:[d]}],"drop-shadow":[{"drop-shadow":["","none",Fc,lr]}],grayscale:[{grayscale:[h]}],"hue-rotate":[{"hue-rotate":[p]}],invert:[{invert:[x]}],saturate:[{saturate:[k]}],sepia:[{sepia:[B]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[a]}],"backdrop-contrast":[{"backdrop-contrast":[d]}],"backdrop-grayscale":[{"backdrop-grayscale":[h]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[p]}],"backdrop-invert":[{"backdrop-invert":[x]}],"backdrop-opacity":[{"backdrop-opacity":[T]}],"backdrop-saturate":[{"backdrop-saturate":[k]}],"backdrop-sepia":[{"backdrop-sepia":[B]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",lr]}],duration:[{duration:ye()}],ease:[{ease:["linear","in","out","in-out",lr]}],delay:[{delay:ye()}],animate:[{animate:["none","spin","ping","pulse","bounce",lr]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[I]}],"scale-x":[{"scale-x":[I]}],"scale-y":[{"scale-y":[I]}],rotate:[{rotate:[hm,lr]}],"translate-x":[{"translate-x":[F]}],"translate-y":[{"translate-y":[F]}],"skew-x":[{"skew-x":[O]}],"skew-y":[{"skew-y":[O]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",lr]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",lr]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":Y()}],"scroll-mx":[{"scroll-mx":Y()}],"scroll-my":[{"scroll-my":Y()}],"scroll-ms":[{"scroll-ms":Y()}],"scroll-me":[{"scroll-me":Y()}],"scroll-mt":[{"scroll-mt":Y()}],"scroll-mr":[{"scroll-mr":Y()}],"scroll-mb":[{"scroll-mb":Y()}],"scroll-ml":[{"scroll-ml":Y()}],"scroll-p":[{"scroll-p":Y()}],"scroll-px":[{"scroll-px":Y()}],"scroll-py":[{"scroll-py":Y()}],"scroll-ps":[{"scroll-ps":Y()}],"scroll-pe":[{"scroll-pe":Y()}],"scroll-pt":[{"scroll-pt":Y()}],"scroll-pr":[{"scroll-pr":Y()}],"scroll-pb":[{"scroll-pb":Y()}],"scroll-pl":[{"scroll-pl":Y()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",lr]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Jl,Lc,C1]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},mD=X6(fD);function pt(...e){return mD(d4(e))}const pD=B8,C4=E.forwardRef(({className:e,...t},r)=>s.jsx(LS,{ref:r,className:pt("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));C4.displayName=LS.displayName;const xD=Pf("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),E4=E.forwardRef(({className:e,variant:t,...r},a)=>s.jsx(FS,{ref:a,className:pt(xD({variant:t}),e),...r}));E4.displayName=FS.displayName;const gD=E.forwardRef(({className:e,...t},r)=>s.jsx(BS,{ref:r,className:pt("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",e),...t}));gD.displayName=BS.displayName;const S4=E.forwardRef(({className:e,...t},r)=>s.jsx(VS,{ref:r,className:pt("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:s.jsx(Jr,{className:"h-4 w-4"})}));S4.displayName=VS.displayName;const T4=E.forwardRef(({className:e,...t},r)=>s.jsx(US,{ref:r,className:pt("text-sm font-semibold",e),...t}));T4.displayName=US.displayName;const A4=E.forwardRef(({className:e,...t},r)=>s.jsx(zS,{ref:r,className:pt("text-sm opacity-90",e),...t}));A4.displayName=zS.displayName;function vD(){const{toasts:e}=_r();return s.jsxs(pD,{children:[e.map(function({id:t,title:r,description:a,action:n,...i}){return s.jsxs(E4,{...i,children:[s.jsxs("div",{className:"grid gap-1",children:[r&&s.jsx(T4,{children:r}),a&&s.jsx(A4,{children:a})]}),n,s.jsx(S4,{})]},t)}),s.jsx(C4,{})]})}var K2=["light","dark"],yD="(prefers-color-scheme: dark)",wD=E.createContext(void 0),bD={setTheme:e=>{},themes:[]},_D=()=>{var e;return(e=E.useContext(wD))!=null?e:bD};E.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:a,enableColorScheme:n,defaultTheme:i,value:o,attrs:c,nonce:d})=>{let h=i==="system",p=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${c.map(N=>`'${N}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,x=n?K2.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",v=(N,_=!1,C=!0)=>{let T=o?o[N]:N,A=_?N+"|| ''":`'${T}'`,k="";return n&&C&&!_&&K2.includes(N)&&(k+=`d.style.colorScheme = '${N}';`),r==="class"?_||T?k+=`c.add(${A})`:k+="null":T&&(k+=`d[s](n,${A})`),k},b=e?`!function(){${p}${v(e)}}()`:a?`!function(){try{${p}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${h})){var t='${yD}',m=window.matchMedia(t);if(m.media!==t||m.matches){${v("dark")}}else{${v("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${v(o?"x[e]":"e",!0)}}${h?"":"else{"+v(i,!1,!1)+"}"}${x}}catch(e){}}()`:`!function(){try{${p}var e=localStorage.getItem('${t}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${v(o?"x[e]":"e",!0)}}else{${v(i,!1,!1)};}${x}}catch(t){}}();`;return E.createElement("script",{nonce:d,dangerouslySetInnerHTML:{__html:b}})});var jD=e=>{switch(e){case"success":return ED;case"info":return TD;case"warning":return SD;case"error":return AD;default:return null}},ND=Array(12).fill(0),CD=({visible:e,className:t})=>He.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},He.createElement("div",{className:"sonner-spinner"},ND.map((r,a)=>He.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${a}`})))),ED=He.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},He.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),SD=He.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},He.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),TD=He.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},He.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),AD=He.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},He.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),kD=He.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},He.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),He.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),RD=()=>{let[e,t]=He.useState(document.hidden);return He.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e},Fv=1,PD=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:r,...a}=e,n=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:Fv++,i=this.toasts.find(c=>c.id===n),o=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(n)&&this.dismissedToasts.delete(n),i?this.toasts=this.toasts.map(c=>c.id===n?(this.publish({...c,...e,id:n,title:r}),{...c,...e,id:n,dismissible:o,title:r}):c):this.addToast({title:r,...a,dismissible:o,id:n}),n},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let a=e instanceof Promise?e:e(),n=r!==void 0,i,o=a.then(async d=>{if(i=["resolve",d],He.isValidElement(d))n=!1,this.create({id:r,type:"default",message:d});else if(OD(d)&&!d.ok){n=!1;let h=typeof t.error=="function"?await t.error(`HTTP error! status: ${d.status}`):t.error,p=typeof t.description=="function"?await t.description(`HTTP error! status: ${d.status}`):t.description;this.create({id:r,type:"error",message:h,description:p})}else if(t.success!==void 0){n=!1;let h=typeof t.success=="function"?await t.success(d):t.success,p=typeof t.description=="function"?await t.description(d):t.description;this.create({id:r,type:"success",message:h,description:p})}}).catch(async d=>{if(i=["reject",d],t.error!==void 0){n=!1;let h=typeof t.error=="function"?await t.error(d):t.error,p=typeof t.description=="function"?await t.description(d):t.description;this.create({id:r,type:"error",message:h,description:p})}}).finally(()=>{var d;n&&(this.dismiss(r),r=void 0),(d=t.finally)==null||d.call(t)}),c=()=>new Promise((d,h)=>o.then(()=>i[0]==="reject"?h(i[1]):d(i[1])).catch(h));return typeof r!="string"&&typeof r!="number"?{unwrap:c}:Object.assign(r,{unwrap:c})},this.custom=(e,t)=>{let r=(t==null?void 0:t.id)||Fv++;return this.create({jsx:e(r),id:r,...t}),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Ei=new PD,ID=(e,t)=>{let r=(t==null?void 0:t.id)||Fv++;return Ei.addToast({title:e,...t,id:r}),r},OD=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",DD=ID,MD=()=>Ei.toasts,LD=()=>Ei.getActiveToasts(),ct=Object.assign(DD,{success:Ei.success,info:Ei.info,warning:Ei.warning,error:Ei.error,custom:Ei.custom,message:Ei.message,promise:Ei.promise,dismiss:Ei.dismiss,loading:Ei.loading},{getHistory:MD,getToasts:LD});function FD(e,{insertAt:t}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",t==="top"&&r.firstChild?r.insertBefore(a,r.firstChild):r.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}FD(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function R0(e){return e.label!==void 0}var BD=3,VD="32px",UD="16px",X2=4e3,zD=356,$D=14,qD=20,WD=200;function Lo(...e){return e.filter(Boolean).join(" ")}function HD(e){let[t,r]=e.split("-"),a=[];return t&&a.push(t),r&&a.push(r),a}var GD=e=>{var t,r,a,n,i,o,c,d,h,p,x;let{invert:v,toast:b,unstyled:N,interacting:_,setHeights:C,visibleToasts:T,heights:A,index:k,toasts:I,expanded:B,removeToast:O,defaultRichColors:D,closeButton:F,style:M,cancelButtonStyle:z,actionButtonStyle:q,className:Y="",descriptionClassName:ae="",duration:je,position:H,gap:Z,loadingIcon:G,expandByDefault:Q,classNames:re,icons:le,closeButtonAriaLabel:ye="Close toast",pauseWhenPageIsHidden:W}=e,[ee,ie]=He.useState(null),[ce,xe]=He.useState(null),[Ce,me]=He.useState(!1),[fe,ve]=He.useState(!1),[ne,Me]=He.useState(!1),[Ie,Be]=He.useState(!1),[ot,Se]=He.useState(!1),[ze,we]=He.useState(0),[Le,Nt]=He.useState(0),Ge=He.useRef(b.duration||je||X2),Lt=He.useRef(null),ps=He.useRef(null),ns=k===0,Ke=k+1<=T,dt=b.type,It=b.dismissible!==!1,Ut=b.className||"",ts=b.descriptionClassName||"",us=He.useMemo(()=>A.findIndex(St=>St.toastId===b.id)||0,[A,b.id]),qe=He.useMemo(()=>{var St;return(St=b.closeButton)!=null?St:F},[b.closeButton,F]),jt=He.useMemo(()=>b.duration||je||X2,[b.duration,je]),_t=He.useRef(0),Re=He.useRef(0),et=He.useRef(0),Ct=He.useRef(null),[Yt,bt]=H.split("-"),Dt=He.useMemo(()=>A.reduce((St,ls,is)=>is>=us?St:St+ls.height,0),[A,us]),Jt=RD(),Oe=b.invert||v,Xe=dt==="loading";Re.current=He.useMemo(()=>us*Z+Dt,[us,Dt]),He.useEffect(()=>{Ge.current=jt},[jt]),He.useEffect(()=>{me(!0)},[]),He.useEffect(()=>{let St=ps.current;if(St){let ls=St.getBoundingClientRect().height;return Nt(ls),C(is=>[{toastId:b.id,height:ls,position:b.position},...is]),()=>C(is=>is.filter(ws=>ws.toastId!==b.id))}},[C,b.id]),He.useLayoutEffect(()=>{if(!Ce)return;let St=ps.current,ls=St.style.height;St.style.height="auto";let is=St.getBoundingClientRect().height;St.style.height=ls,Nt(is),C(ws=>ws.find(Bs=>Bs.toastId===b.id)?ws.map(Bs=>Bs.toastId===b.id?{...Bs,height:is}:Bs):[{toastId:b.id,height:is,position:b.position},...ws])},[Ce,b.title,b.description,C,b.id]);let zt=He.useCallback(()=>{ve(!0),we(Re.current),C(St=>St.filter(ls=>ls.toastId!==b.id)),setTimeout(()=>{O(b)},WD)},[b,O,C,Re]);He.useEffect(()=>{if(b.promise&&dt==="loading"||b.duration===1/0||b.type==="loading")return;let St;return B||_||W&&Jt?(()=>{if(et.current<_t.current){let ls=new Date().getTime()-_t.current;Ge.current=Ge.current-ls}et.current=new Date().getTime()})():Ge.current!==1/0&&(_t.current=new Date().getTime(),St=setTimeout(()=>{var ls;(ls=b.onAutoClose)==null||ls.call(b,b),zt()},Ge.current)),()=>clearTimeout(St)},[B,_,b,dt,W,Jt,zt]),He.useEffect(()=>{b.delete&&zt()},[zt,b.delete]);function qt(){var St,ls,is;return le!=null&&le.loading?He.createElement("div",{className:Lo(re==null?void 0:re.loader,(St=b==null?void 0:b.classNames)==null?void 0:St.loader,"sonner-loader"),"data-visible":dt==="loading"},le.loading):G?He.createElement("div",{className:Lo(re==null?void 0:re.loader,(ls=b==null?void 0:b.classNames)==null?void 0:ls.loader,"sonner-loader"),"data-visible":dt==="loading"},G):He.createElement(CD,{className:Lo(re==null?void 0:re.loader,(is=b==null?void 0:b.classNames)==null?void 0:is.loader),visible:dt==="loading"})}return He.createElement("li",{tabIndex:0,ref:ps,className:Lo(Y,Ut,re==null?void 0:re.toast,(t=b==null?void 0:b.classNames)==null?void 0:t.toast,re==null?void 0:re.default,re==null?void 0:re[dt],(r=b==null?void 0:b.classNames)==null?void 0:r[dt]),"data-sonner-toast":"","data-rich-colors":(a=b.richColors)!=null?a:D,"data-styled":!(b.jsx||b.unstyled||N),"data-mounted":Ce,"data-promise":!!b.promise,"data-swiped":ot,"data-removed":fe,"data-visible":Ke,"data-y-position":Yt,"data-x-position":bt,"data-index":k,"data-front":ns,"data-swiping":ne,"data-dismissible":It,"data-type":dt,"data-invert":Oe,"data-swipe-out":Ie,"data-swipe-direction":ce,"data-expanded":!!(B||Q&&Ce),style:{"--index":k,"--toasts-before":k,"--z-index":I.length-k,"--offset":`${fe?ze:Re.current}px`,"--initial-height":Q?"auto":`${Le}px`,...M,...b.style},onDragEnd:()=>{Me(!1),ie(null),Ct.current=null},onPointerDown:St=>{Xe||!It||(Lt.current=new Date,we(Re.current),St.target.setPointerCapture(St.pointerId),St.target.tagName!=="BUTTON"&&(Me(!0),Ct.current={x:St.clientX,y:St.clientY}))},onPointerUp:()=>{var St,ls,is,ws;if(Ie||!It)return;Ct.current=null;let Bs=Number(((St=ps.current)==null?void 0:St.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),js=Number(((ls=ps.current)==null?void 0:ls.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),ha=new Date().getTime()-((is=Lt.current)==null?void 0:is.getTime()),$r=ee==="x"?Bs:js,_a=Math.abs($r)/ha;if(Math.abs($r)>=qD||_a>.11){we(Re.current),(ws=b.onDismiss)==null||ws.call(b,b),xe(ee==="x"?Bs>0?"right":"left":js>0?"down":"up"),zt(),Be(!0),Se(!1);return}Me(!1),ie(null)},onPointerMove:St=>{var ls,is,ws,Bs;if(!Ct.current||!It||((ls=window.getSelection())==null?void 0:ls.toString().length)>0)return;let js=St.clientY-Ct.current.y,ha=St.clientX-Ct.current.x,$r=(is=e.swipeDirections)!=null?is:HD(H);!ee&&(Math.abs(ha)>1||Math.abs(js)>1)&&ie(Math.abs(ha)>Math.abs(js)?"x":"y");let _a={x:0,y:0};ee==="y"?($r.includes("top")||$r.includes("bottom"))&&($r.includes("top")&&js<0||$r.includes("bottom")&&js>0)&&(_a.y=js):ee==="x"&&($r.includes("left")||$r.includes("right"))&&($r.includes("left")&&ha<0||$r.includes("right")&&ha>0)&&(_a.x=ha),(Math.abs(_a.x)>0||Math.abs(_a.y)>0)&&Se(!0),(ws=ps.current)==null||ws.style.setProperty("--swipe-amount-x",`${_a.x}px`),(Bs=ps.current)==null||Bs.style.setProperty("--swipe-amount-y",`${_a.y}px`)}},qe&&!b.jsx?He.createElement("button",{"aria-label":ye,"data-disabled":Xe,"data-close-button":!0,onClick:Xe||!It?()=>{}:()=>{var St;zt(),(St=b.onDismiss)==null||St.call(b,b)},className:Lo(re==null?void 0:re.closeButton,(n=b==null?void 0:b.classNames)==null?void 0:n.closeButton)},(i=le==null?void 0:le.close)!=null?i:kD):null,b.jsx||E.isValidElement(b.title)?b.jsx?b.jsx:typeof b.title=="function"?b.title():b.title:He.createElement(He.Fragment,null,dt||b.icon||b.promise?He.createElement("div",{"data-icon":"",className:Lo(re==null?void 0:re.icon,(o=b==null?void 0:b.classNames)==null?void 0:o.icon)},b.promise||b.type==="loading"&&!b.icon?b.icon||qt():null,b.type!=="loading"?b.icon||(le==null?void 0:le[dt])||jD(dt):null):null,He.createElement("div",{"data-content":"",className:Lo(re==null?void 0:re.content,(c=b==null?void 0:b.classNames)==null?void 0:c.content)},He.createElement("div",{"data-title":"",className:Lo(re==null?void 0:re.title,(d=b==null?void 0:b.classNames)==null?void 0:d.title)},typeof b.title=="function"?b.title():b.title),b.description?He.createElement("div",{"data-description":"",className:Lo(ae,ts,re==null?void 0:re.description,(h=b==null?void 0:b.classNames)==null?void 0:h.description)},typeof b.description=="function"?b.description():b.description):null),E.isValidElement(b.cancel)?b.cancel:b.cancel&&R0(b.cancel)?He.createElement("button",{"data-button":!0,"data-cancel":!0,style:b.cancelButtonStyle||z,onClick:St=>{var ls,is;R0(b.cancel)&&It&&((is=(ls=b.cancel).onClick)==null||is.call(ls,St),zt())},className:Lo(re==null?void 0:re.cancelButton,(p=b==null?void 0:b.classNames)==null?void 0:p.cancelButton)},b.cancel.label):null,E.isValidElement(b.action)?b.action:b.action&&R0(b.action)?He.createElement("button",{"data-button":!0,"data-action":!0,style:b.actionButtonStyle||q,onClick:St=>{var ls,is;R0(b.action)&&((is=(ls=b.action).onClick)==null||is.call(ls,St),!St.defaultPrevented&&zt())},className:Lo(re==null?void 0:re.actionButton,(x=b==null?void 0:b.classNames)==null?void 0:x.actionButton)},b.action.label):null))};function Y2(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function KD(e,t){let r={};return[e,t].forEach((a,n)=>{let i=n===1,o=i?"--mobile-offset":"--offset",c=i?UD:VD;function d(h){["top","right","bottom","left"].forEach(p=>{r[`${o}-${p}`]=typeof h=="number"?`${h}px`:h})}typeof a=="number"||typeof a=="string"?d(a):typeof a=="object"?["top","right","bottom","left"].forEach(h=>{a[h]===void 0?r[`${o}-${h}`]=c:r[`${o}-${h}`]=typeof a[h]=="number"?`${a[h]}px`:a[h]}):d(c)}),r}var XD=E.forwardRef(function(e,t){let{invert:r,position:a="bottom-right",hotkey:n=["altKey","KeyT"],expand:i,closeButton:o,className:c,offset:d,mobileOffset:h,theme:p="light",richColors:x,duration:v,style:b,visibleToasts:N=BD,toastOptions:_,dir:C=Y2(),gap:T=$D,loadingIcon:A,icons:k,containerAriaLabel:I="Notifications",pauseWhenPageIsHidden:B}=e,[O,D]=He.useState([]),F=He.useMemo(()=>Array.from(new Set([a].concat(O.filter(W=>W.position).map(W=>W.position)))),[O,a]),[M,z]=He.useState([]),[q,Y]=He.useState(!1),[ae,je]=He.useState(!1),[H,Z]=He.useState(p!=="system"?p:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),G=He.useRef(null),Q=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),re=He.useRef(null),le=He.useRef(!1),ye=He.useCallback(W=>{D(ee=>{var ie;return(ie=ee.find(ce=>ce.id===W.id))!=null&&ie.delete||Ei.dismiss(W.id),ee.filter(({id:ce})=>ce!==W.id)})},[]);return He.useEffect(()=>Ei.subscribe(W=>{if(W.dismiss){D(ee=>ee.map(ie=>ie.id===W.id?{...ie,delete:!0}:ie));return}setTimeout(()=>{Om.flushSync(()=>{D(ee=>{let ie=ee.findIndex(ce=>ce.id===W.id);return ie!==-1?[...ee.slice(0,ie),{...ee[ie],...W},...ee.slice(ie+1)]:[W,...ee]})})})}),[]),He.useEffect(()=>{if(p!=="system"){Z(p);return}if(p==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Z("dark"):Z("light")),typeof window>"u")return;let W=window.matchMedia("(prefers-color-scheme: dark)");try{W.addEventListener("change",({matches:ee})=>{Z(ee?"dark":"light")})}catch{W.addListener(({matches:ie})=>{try{Z(ie?"dark":"light")}catch(ce){console.error(ce)}})}},[p]),He.useEffect(()=>{O.length<=1&&Y(!1)},[O]),He.useEffect(()=>{let W=ee=>{var ie,ce;n.every(xe=>ee[xe]||ee.code===xe)&&(Y(!0),(ie=G.current)==null||ie.focus()),ee.code==="Escape"&&(document.activeElement===G.current||(ce=G.current)!=null&&ce.contains(document.activeElement))&&Y(!1)};return document.addEventListener("keydown",W),()=>document.removeEventListener("keydown",W)},[n]),He.useEffect(()=>{if(G.current)return()=>{re.current&&(re.current.focus({preventScroll:!0}),re.current=null,le.current=!1)}},[G.current]),He.createElement("section",{ref:t,"aria-label":`${I} ${Q}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},F.map((W,ee)=>{var ie;let[ce,xe]=W.split("-");return O.length?He.createElement("ol",{key:W,dir:C==="auto"?Y2():C,tabIndex:-1,ref:G,className:c,"data-sonner-toaster":!0,"data-theme":H,"data-y-position":ce,"data-lifted":q&&O.length>1&&!i,"data-x-position":xe,style:{"--front-toast-height":`${((ie=M[0])==null?void 0:ie.height)||0}px`,"--width":`${zD}px`,"--gap":`${T}px`,...b,...KD(d,h)},onBlur:Ce=>{le.current&&!Ce.currentTarget.contains(Ce.relatedTarget)&&(le.current=!1,re.current&&(re.current.focus({preventScroll:!0}),re.current=null))},onFocus:Ce=>{Ce.target instanceof HTMLElement&&Ce.target.dataset.dismissible==="false"||le.current||(le.current=!0,re.current=Ce.relatedTarget)},onMouseEnter:()=>Y(!0),onMouseMove:()=>Y(!0),onMouseLeave:()=>{ae||Y(!1)},onDragEnd:()=>Y(!1),onPointerDown:Ce=>{Ce.target instanceof HTMLElement&&Ce.target.dataset.dismissible==="false"||je(!0)},onPointerUp:()=>je(!1)},O.filter(Ce=>!Ce.position&&ee===0||Ce.position===W).map((Ce,me)=>{var fe,ve;return He.createElement(GD,{key:Ce.id,icons:k,index:me,toast:Ce,defaultRichColors:x,duration:(fe=_==null?void 0:_.duration)!=null?fe:v,className:_==null?void 0:_.className,descriptionClassName:_==null?void 0:_.descriptionClassName,invert:r,visibleToasts:N,closeButton:(ve=_==null?void 0:_.closeButton)!=null?ve:o,interacting:ae,position:W,style:_==null?void 0:_.style,unstyled:_==null?void 0:_.unstyled,classNames:_==null?void 0:_.classNames,cancelButtonStyle:_==null?void 0:_.cancelButtonStyle,actionButtonStyle:_==null?void 0:_.actionButtonStyle,removeToast:ye,toasts:O.filter(ne=>ne.position==Ce.position),heights:M.filter(ne=>ne.position==Ce.position),setHeights:z,expandByDefault:i,gap:T,loadingIcon:A,expanded:q,pauseWhenPageIsHidden:B,swipeDirections:e.swipeDirections})})):null}))});const YD=({...e})=>{const{theme:t="system"}=_D();return s.jsx(XD,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var[Ng,Lue]=bi("Tooltip",[Tf]),Cg=Tf(),k4="TooltipProvider",ZD=700,Bv="tooltip.open",[QD,zw]=Ng(k4),R4=e=>{const{__scopeTooltip:t,delayDuration:r=ZD,skipDelayDuration:a=300,disableHoverableContent:n=!1,children:i}=e,o=E.useRef(!0),c=E.useRef(!1),d=E.useRef(0);return E.useEffect(()=>{const h=d.current;return()=>window.clearTimeout(h)},[]),s.jsx(QD,{scope:t,isOpenDelayedRef:o,delayDuration:r,onOpen:E.useCallback(()=>{window.clearTimeout(d.current),o.current=!1},[]),onClose:E.useCallback(()=>{window.clearTimeout(d.current),d.current=window.setTimeout(()=>o.current=!0,a)},[a]),isPointerInTransitRef:c,onPointerInTransitChange:E.useCallback(h=>{c.current=h},[]),disableHoverableContent:n,children:i})};R4.displayName=k4;var rp="Tooltip",[JD,Eg]=Ng(rp),P4=e=>{const{__scopeTooltip:t,children:r,open:a,defaultOpen:n,onOpenChange:i,disableHoverableContent:o,delayDuration:c}=e,d=zw(rp,e.__scopeTooltip),h=Cg(t),[p,x]=E.useState(null),v=Ai(),b=E.useRef(0),N=o??d.disableHoverableContent,_=c??d.delayDuration,C=E.useRef(!1),[T,A]=No({prop:a,defaultProp:n??!1,onChange:D=>{D?(d.onOpen(),document.dispatchEvent(new CustomEvent(Bv))):d.onClose(),i==null||i(D)},caller:rp}),k=E.useMemo(()=>T?C.current?"delayed-open":"instant-open":"closed",[T]),I=E.useCallback(()=>{window.clearTimeout(b.current),b.current=0,C.current=!1,A(!0)},[A]),B=E.useCallback(()=>{window.clearTimeout(b.current),b.current=0,A(!1)},[A]),O=E.useCallback(()=>{window.clearTimeout(b.current),b.current=window.setTimeout(()=>{C.current=!0,A(!0),b.current=0},_)},[_,A]);return E.useEffect(()=>()=>{b.current&&(window.clearTimeout(b.current),b.current=0)},[]),s.jsx(kw,{...h,children:s.jsx(JD,{scope:t,contentId:v,open:T,stateAttribute:k,trigger:p,onTriggerChange:x,onTriggerEnter:E.useCallback(()=>{d.isOpenDelayedRef.current?O():I()},[d.isOpenDelayedRef,O,I]),onTriggerLeave:E.useCallback(()=>{N?B():(window.clearTimeout(b.current),b.current=0)},[B,N]),onOpen:I,onClose:B,disableHoverableContent:N,children:r})})};P4.displayName=rp;var Vv="TooltipTrigger",I4=E.forwardRef((e,t)=>{const{__scopeTooltip:r,...a}=e,n=Eg(Vv,r),i=zw(Vv,r),o=Cg(r),c=E.useRef(null),d=br(t,c,n.onTriggerChange),h=E.useRef(!1),p=E.useRef(!1),x=E.useCallback(()=>h.current=!1,[]);return E.useEffect(()=>()=>document.removeEventListener("pointerup",x),[x]),s.jsx(vg,{asChild:!0,...o,children:s.jsx(ys.button,{"aria-describedby":n.open?n.contentId:void 0,"data-state":n.stateAttribute,...a,ref:d,onPointerMove:Ts(e.onPointerMove,v=>{v.pointerType!=="touch"&&!p.current&&!i.isPointerInTransitRef.current&&(n.onTriggerEnter(),p.current=!0)}),onPointerLeave:Ts(e.onPointerLeave,()=>{n.onTriggerLeave(),p.current=!1}),onPointerDown:Ts(e.onPointerDown,()=>{n.open&&n.onClose(),h.current=!0,document.addEventListener("pointerup",x,{once:!0})}),onFocus:Ts(e.onFocus,()=>{h.current||n.onOpen()}),onBlur:Ts(e.onBlur,n.onClose),onClick:Ts(e.onClick,n.onClose)})})});I4.displayName=Vv;var eM="TooltipPortal",[Fue,tM]=Ng(eM,{forceMount:void 0}),rf="TooltipContent",O4=E.forwardRef((e,t)=>{const r=tM(rf,e.__scopeTooltip),{forceMount:a=r.forceMount,side:n="top",...i}=e,o=Eg(rf,e.__scopeTooltip);return s.jsx(il,{present:a||o.open,children:o.disableHoverableContent?s.jsx(D4,{side:n,...i,ref:t}):s.jsx(sM,{side:n,...i,ref:t})})}),sM=E.forwardRef((e,t)=>{const r=Eg(rf,e.__scopeTooltip),a=zw(rf,e.__scopeTooltip),n=E.useRef(null),i=br(t,n),[o,c]=E.useState(null),{trigger:d,onClose:h}=r,p=n.current,{onPointerInTransitChange:x}=a,v=E.useCallback(()=>{c(null),x(!1)},[x]),b=E.useCallback((N,_)=>{const C=N.currentTarget,T={x:N.clientX,y:N.clientY},A=oM(T,C.getBoundingClientRect()),k=lM(T,A),I=cM(_.getBoundingClientRect()),B=uM([...k,...I]);c(B),x(!0)},[x]);return E.useEffect(()=>()=>v(),[v]),E.useEffect(()=>{if(d&&p){const N=C=>b(C,p),_=C=>b(C,d);return d.addEventListener("pointerleave",N),p.addEventListener("pointerleave",_),()=>{d.removeEventListener("pointerleave",N),p.removeEventListener("pointerleave",_)}}},[d,p,b,v]),E.useEffect(()=>{if(o){const N=_=>{const C=_.target,T={x:_.clientX,y:_.clientY},A=(d==null?void 0:d.contains(C))||(p==null?void 0:p.contains(C)),k=!dM(T,o);A?v():k&&(v(),h())};return document.addEventListener("pointermove",N),()=>document.removeEventListener("pointermove",N)}},[d,p,o,h,v]),s.jsx(D4,{...e,ref:i})}),[rM,aM]=Ng(rp,{isInside:!1}),nM=$S("TooltipContent"),D4=E.forwardRef((e,t)=>{const{__scopeTooltip:r,children:a,"aria-label":n,onEscapeKeyDown:i,onPointerDownOutside:o,...c}=e,d=Eg(rf,r),h=Cg(r),{onClose:p}=d;return E.useEffect(()=>(document.addEventListener(Bv,p),()=>document.removeEventListener(Bv,p)),[p]),E.useEffect(()=>{if(d.trigger){const x=v=>{const b=v.target;b!=null&&b.contains(d.trigger)&&p()};return window.addEventListener("scroll",x,{capture:!0}),()=>window.removeEventListener("scroll",x,{capture:!0})}},[d.trigger,p]),s.jsx(Sw,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:x=>x.preventDefault(),onDismiss:p,children:s.jsxs(Tw,{"data-state":d.stateAttribute,...h,...c,ref:t,style:{...c.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[s.jsx(nM,{children:a}),s.jsx(rM,{scope:r,isInside:!0,children:s.jsx(V8,{id:d.contentId,role:"tooltip",children:n||a})})]})})});O4.displayName=rf;var M4="TooltipArrow",iM=E.forwardRef((e,t)=>{const{__scopeTooltip:r,...a}=e,n=Cg(r);return aM(M4,r).isInside?null:s.jsx(Aw,{...n,...a,ref:t})});iM.displayName=M4;function oM(e,t){const r=Math.abs(t.top-e.y),a=Math.abs(t.bottom-e.y),n=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(r,a,n,i)){case i:return"left";case n:return"right";case r:return"top";case a:return"bottom";default:throw new Error("unreachable")}}function lM(e,t,r=5){const a=[];switch(t){case"top":a.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":a.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":a.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":a.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return a}function cM(e){const{top:t,right:r,bottom:a,left:n}=e;return[{x:n,y:t},{x:r,y:t},{x:r,y:a},{x:n,y:a}]}function dM(e,t){const{x:r,y:a}=e;let n=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const c=t[i],d=t[o],h=c.x,p=c.y,x=d.x,v=d.y;p>a!=v>a&&r<(x-h)*(a-p)/(v-p)+h&&(n=!n)}return n}function uM(e){const t=e.slice();return t.sort((r,a)=>r.x<a.x?-1:r.x>a.x?1:r.y<a.y?-1:r.y>a.y?1:0),hM(t)}function hM(e){if(e.length<=1)return e.slice();const t=[];for(let a=0;a<e.length;a++){const n=e[a];for(;t.length>=2;){const i=t[t.length-1],o=t[t.length-2];if((i.x-o.x)*(n.y-o.y)>=(i.y-o.y)*(n.x-o.x))t.pop();else break}t.push(n)}t.pop();const r=[];for(let a=e.length-1;a>=0;a--){const n=e[a];for(;r.length>=2;){const i=r[r.length-1],o=r[r.length-2];if((i.x-o.x)*(n.y-o.y)>=(i.y-o.y)*(n.x-o.x))r.pop();else break}r.push(n)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var fM=R4,mM=P4,pM=I4,L4=O4;const Zo=fM,Xn=mM,Yn=pM,kn=E.forwardRef(({className:e,sideOffset:t=4,...r},a)=>s.jsx(L4,{ref:a,sideOffset:t,className:pt("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));kn.displayName=L4.displayName;var Mf=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Tu=typeof window>"u"||"Deno"in globalThis;function ci(){}function xM(e,t){return typeof e=="function"?e(t):e}function Uv(e){return typeof e=="number"&&e>=0&&e!==1/0}function F4(e,t){return Math.max(e+(t||0)-Date.now(),0)}function bd(e,t){return typeof e=="function"?e(t):e}function xo(e,t){return typeof e=="function"?e(t):e}function Z2(e,t){const{type:r="all",exact:a,fetchStatus:n,predicate:i,queryKey:o,stale:c}=e;if(o){if(a){if(t.queryHash!==$w(o,t.options))return!1}else if(!ap(t.queryKey,o))return!1}if(r!=="all"){const d=t.isActive();if(r==="active"&&!d||r==="inactive"&&d)return!1}return!(typeof c=="boolean"&&t.isStale()!==c||n&&n!==t.state.fetchStatus||i&&!i(t))}function Q2(e,t){const{exact:r,status:a,predicate:n,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(r){if(Au(t.options.mutationKey)!==Au(i))return!1}else if(!ap(t.options.mutationKey,i))return!1}return!(a&&t.state.status!==a||n&&!n(t))}function $w(e,t){return((t==null?void 0:t.queryKeyHashFn)||Au)(e)}function Au(e){return JSON.stringify(e,(t,r)=>zv(r)?Object.keys(r).sort().reduce((a,n)=>(a[n]=r[n],a),{}):r)}function ap(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>ap(e[r],t[r])):!1}function B4(e,t){if(e===t)return e;const r=J2(e)&&J2(t);if(r||zv(e)&&zv(t)){const a=r?e:Object.keys(e),n=a.length,i=r?t:Object.keys(t),o=i.length,c=r?[]:{},d=new Set(a);let h=0;for(let p=0;p<o;p++){const x=r?p:i[p];(!r&&d.has(x)||r)&&e[x]===void 0&&t[x]===void 0?(c[x]=void 0,h++):(c[x]=B4(e[x],t[x]),c[x]===e[x]&&e[x]!==void 0&&h++)}return n===o&&h===n?e:c}return t}function Tx(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function J2(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function zv(e){if(!ej(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!ej(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function ej(e){return Object.prototype.toString.call(e)==="[object Object]"}function gM(e){return new Promise(t=>{setTimeout(t,e)})}function $v(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?B4(e,t):t}function vM(e,t,r=0){const a=[...e,t];return r&&a.length>r?a.slice(1):a}function yM(e,t,r=0){const a=[t,...e];return r&&a.length>r?a.slice(0,-1):a}var qw=Symbol();function V4(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===qw?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function U4(e,t){return typeof e=="function"?e(...t):!!e}var fu,id,qh,SS,wM=(SS=class extends Mf{constructor(){super();Ss(this,fu);Ss(this,id);Ss(this,qh);rs(this,qh,t=>{if(!Tu&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){Ue(this,id)||this.setEventListener(Ue(this,qh))}onUnsubscribe(){var t;this.hasListeners()||((t=Ue(this,id))==null||t.call(this),rs(this,id,void 0))}setEventListener(t){var r;rs(this,qh,t),(r=Ue(this,id))==null||r.call(this),rs(this,id,t(a=>{typeof a=="boolean"?this.setFocused(a):this.onFocus()}))}setFocused(t){Ue(this,fu)!==t&&(rs(this,fu,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof Ue(this,fu)=="boolean"?Ue(this,fu):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},fu=new WeakMap,id=new WeakMap,qh=new WeakMap,SS),Ww=new wM,Wh,od,Hh,TS,bM=(TS=class extends Mf{constructor(){super();Ss(this,Wh,!0);Ss(this,od);Ss(this,Hh);rs(this,Hh,t=>{if(!Tu&&window.addEventListener){const r=()=>t(!0),a=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",a,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",a)}}})}onSubscribe(){Ue(this,od)||this.setEventListener(Ue(this,Hh))}onUnsubscribe(){var t;this.hasListeners()||((t=Ue(this,od))==null||t.call(this),rs(this,od,void 0))}setEventListener(t){var r;rs(this,Hh,t),(r=Ue(this,od))==null||r.call(this),rs(this,od,t(this.setOnline.bind(this)))}setOnline(t){Ue(this,Wh)!==t&&(rs(this,Wh,t),this.listeners.forEach(a=>{a(t)}))}isOnline(){return Ue(this,Wh)}},Wh=new WeakMap,od=new WeakMap,Hh=new WeakMap,TS),Ax=new bM;function qv(){let e,t;const r=new Promise((n,i)=>{e=n,t=i});r.status="pending",r.catch(()=>{});function a(n){Object.assign(r,n),delete r.resolve,delete r.reject}return r.resolve=n=>{a({status:"fulfilled",value:n}),e(n)},r.reject=n=>{a({status:"rejected",reason:n}),t(n)},r}function _M(e){return Math.min(1e3*2**e,3e4)}function z4(e){return(e??"online")==="online"?Ax.isOnline():!0}var $4=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function E1(e){return e instanceof $4}function q4(e){let t=!1,r=0,a=!1,n;const i=qv(),o=_=>{var C;a||(v(new $4(_)),(C=e.abort)==null||C.call(e))},c=()=>{t=!0},d=()=>{t=!1},h=()=>Ww.isFocused()&&(e.networkMode==="always"||Ax.isOnline())&&e.canRun(),p=()=>z4(e.networkMode)&&e.canRun(),x=_=>{var C;a||(a=!0,(C=e.onSuccess)==null||C.call(e,_),n==null||n(),i.resolve(_))},v=_=>{var C;a||(a=!0,(C=e.onError)==null||C.call(e,_),n==null||n(),i.reject(_))},b=()=>new Promise(_=>{var C;n=T=>{(a||h())&&_(T)},(C=e.onPause)==null||C.call(e)}).then(()=>{var _;n=void 0,a||(_=e.onContinue)==null||_.call(e)}),N=()=>{if(a)return;let _;const C=r===0?e.initialPromise:void 0;try{_=C??e.fn()}catch(T){_=Promise.reject(T)}Promise.resolve(_).then(x).catch(T=>{var O;if(a)return;const A=e.retry??(Tu?0:3),k=e.retryDelay??_M,I=typeof k=="function"?k(r,T):k,B=A===!0||typeof A=="number"&&r<A||typeof A=="function"&&A(r,T);if(t||!B){v(T);return}r++,(O=e.onFail)==null||O.call(e,r,T),gM(I).then(()=>h()?void 0:b()).then(()=>{t?v(T):N()})})};return{promise:i,cancel:o,continue:()=>(n==null||n(),i),cancelRetry:c,continueRetry:d,canStart:p,start:()=>(p()?N():b().then(N),i)}}var jM=e=>setTimeout(e,0);function NM(){let e=[],t=0,r=c=>{c()},a=c=>{c()},n=jM;const i=c=>{t?e.push(c):n(()=>{r(c)})},o=()=>{const c=e;e=[],c.length&&n(()=>{a(()=>{c.forEach(d=>{r(d)})})})};return{batch:c=>{let d;t++;try{d=c()}finally{t--,t||o()}return d},batchCalls:c=>(...d)=>{i(()=>{c(...d)})},schedule:i,setNotifyFunction:c=>{r=c},setBatchNotifyFunction:c=>{a=c},setScheduler:c=>{n=c}}}var dn=NM(),mu,AS,W4=(AS=class{constructor(){Ss(this,mu)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Uv(this.gcTime)&&rs(this,mu,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Tu?1/0:5*60*1e3))}clearGcTimeout(){Ue(this,mu)&&(clearTimeout(Ue(this,mu)),rs(this,mu,void 0))}},mu=new WeakMap,AS),Gh,pu,mo,xu,zn,Bp,gu,qo,sc,kS,CM=(kS=class extends W4{constructor(t){super();Ss(this,qo);Ss(this,Gh);Ss(this,pu);Ss(this,mo);Ss(this,xu);Ss(this,zn);Ss(this,Bp);Ss(this,gu);rs(this,gu,!1),rs(this,Bp,t.defaultOptions),this.setOptions(t.options),this.observers=[],rs(this,xu,t.client),rs(this,mo,Ue(this,xu).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,rs(this,Gh,EM(this.options)),this.state=t.state??Ue(this,Gh),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=Ue(this,zn))==null?void 0:t.promise}setOptions(t){this.options={...Ue(this,Bp),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Ue(this,mo).remove(this)}setData(t,r){const a=$v(this.state.data,t,this.options);return dr(this,qo,sc).call(this,{data:a,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),a}setState(t,r){dr(this,qo,sc).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var a,n;const r=(a=Ue(this,zn))==null?void 0:a.promise;return(n=Ue(this,zn))==null||n.cancel(t),r?r.then(ci).catch(ci):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Ue(this,Gh))}isActive(){return this.observers.some(t=>xo(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===qw||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>bd(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!F4(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(a=>a.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=Ue(this,zn))==null||r.continue()}onOnline(){var r;const t=this.observers.find(a=>a.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=Ue(this,zn))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),Ue(this,mo).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(Ue(this,zn)&&(Ue(this,gu)?Ue(this,zn).cancel({revert:!0}):Ue(this,zn).cancelRetry()),this.scheduleGc()),Ue(this,mo).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||dr(this,qo,sc).call(this,{type:"invalidate"})}fetch(t,r){var h,p,x;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(Ue(this,zn))return Ue(this,zn).continueRetry(),Ue(this,zn).promise}if(t&&this.setOptions(t),!this.options.queryFn){const v=this.observers.find(b=>b.options.queryFn);v&&this.setOptions(v.options)}const a=new AbortController,n=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(rs(this,gu,!0),a.signal)})},i=()=>{const v=V4(this.options,r),N=(()=>{const _={client:Ue(this,xu),queryKey:this.queryKey,meta:this.meta};return n(_),_})();return rs(this,gu,!1),this.options.persister?this.options.persister(v,N,this):v(N)},c=(()=>{const v={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:Ue(this,xu),state:this.state,fetchFn:i};return n(v),v})();(h=this.options.behavior)==null||h.onFetch(c,this),rs(this,pu,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((p=c.fetchOptions)==null?void 0:p.meta))&&dr(this,qo,sc).call(this,{type:"fetch",meta:(x=c.fetchOptions)==null?void 0:x.meta});const d=v=>{var b,N,_,C;E1(v)&&v.silent||dr(this,qo,sc).call(this,{type:"error",error:v}),E1(v)||((N=(b=Ue(this,mo).config).onError)==null||N.call(b,v,this),(C=(_=Ue(this,mo).config).onSettled)==null||C.call(_,this.state.data,v,this)),this.scheduleGc()};return rs(this,zn,q4({initialPromise:r==null?void 0:r.initialPromise,fn:c.fetchFn,abort:a.abort.bind(a),onSuccess:v=>{var b,N,_,C;if(v===void 0){d(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(v)}catch(T){d(T);return}(N=(b=Ue(this,mo).config).onSuccess)==null||N.call(b,v,this),(C=(_=Ue(this,mo).config).onSettled)==null||C.call(_,v,this.state.error,this),this.scheduleGc()},onError:d,onFail:(v,b)=>{dr(this,qo,sc).call(this,{type:"failed",failureCount:v,error:b})},onPause:()=>{dr(this,qo,sc).call(this,{type:"pause"})},onContinue:()=>{dr(this,qo,sc).call(this,{type:"continue"})},retry:c.options.retry,retryDelay:c.options.retryDelay,networkMode:c.options.networkMode,canRun:()=>!0})),Ue(this,zn).start()}},Gh=new WeakMap,pu=new WeakMap,mo=new WeakMap,xu=new WeakMap,zn=new WeakMap,Bp=new WeakMap,gu=new WeakMap,qo=new WeakSet,sc=function(t){const r=a=>{switch(t.type){case"failed":return{...a,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...a,fetchStatus:"paused"};case"continue":return{...a,fetchStatus:"fetching"};case"fetch":return{...a,...H4(a.data,this.options),fetchMeta:t.meta??null};case"success":return rs(this,pu,void 0),{...a,data:t.data,dataUpdateCount:a.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const n=t.error;return E1(n)&&n.revert&&Ue(this,pu)?{...Ue(this,pu),fetchStatus:"idle"}:{...a,error:n,errorUpdateCount:a.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:a.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error"};case"invalidate":return{...a,isInvalidated:!0};case"setState":return{...a,...t.state}}};this.state=r(this.state),dn.batch(()=>{this.observers.forEach(a=>{a.onQueryUpdate()}),Ue(this,mo).notify({query:this,type:"updated",action:t})})},kS);function H4(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:z4(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function EM(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,a=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?a??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var xl,RS,SM=(RS=class extends Mf{constructor(t={}){super();Ss(this,xl);this.config=t,rs(this,xl,new Map)}build(t,r,a){const n=r.queryKey,i=r.queryHash??$w(n,r);let o=this.get(i);return o||(o=new CM({client:t,queryKey:n,queryHash:i,options:t.defaultQueryOptions(r),state:a,defaultOptions:t.getQueryDefaults(n)}),this.add(o)),o}add(t){Ue(this,xl).has(t.queryHash)||(Ue(this,xl).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=Ue(this,xl).get(t.queryHash);r&&(t.destroy(),r===t&&Ue(this,xl).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){dn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return Ue(this,xl).get(t)}getAll(){return[...Ue(this,xl).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(a=>Z2(r,a))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(a=>Z2(t,a)):r}notify(t){dn.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){dn.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){dn.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},xl=new WeakMap,RS),gl,oi,vu,vl,qc,PS,TM=(PS=class extends W4{constructor(t){super();Ss(this,vl);Ss(this,gl);Ss(this,oi);Ss(this,vu);this.mutationId=t.mutationId,rs(this,oi,t.mutationCache),rs(this,gl,[]),this.state=t.state||G4(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){Ue(this,gl).includes(t)||(Ue(this,gl).push(t),this.clearGcTimeout(),Ue(this,oi).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){rs(this,gl,Ue(this,gl).filter(r=>r!==t)),this.scheduleGc(),Ue(this,oi).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){Ue(this,gl).length||(this.state.status==="pending"?this.scheduleGc():Ue(this,oi).remove(this))}continue(){var t;return((t=Ue(this,vu))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,o,c,d,h,p,x,v,b,N,_,C,T,A,k,I,B,O,D,F;const r=()=>{dr(this,vl,qc).call(this,{type:"continue"})};rs(this,vu,q4({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(M,z)=>{dr(this,vl,qc).call(this,{type:"failed",failureCount:M,error:z})},onPause:()=>{dr(this,vl,qc).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Ue(this,oi).canRun(this)}));const a=this.state.status==="pending",n=!Ue(this,vu).canStart();try{if(a)r();else{dr(this,vl,qc).call(this,{type:"pending",variables:t,isPaused:n}),await((o=(i=Ue(this,oi).config).onMutate)==null?void 0:o.call(i,t,this));const z=await((d=(c=this.options).onMutate)==null?void 0:d.call(c,t));z!==this.state.context&&dr(this,vl,qc).call(this,{type:"pending",context:z,variables:t,isPaused:n})}const M=await Ue(this,vu).start();return await((p=(h=Ue(this,oi).config).onSuccess)==null?void 0:p.call(h,M,t,this.state.context,this)),await((v=(x=this.options).onSuccess)==null?void 0:v.call(x,M,t,this.state.context)),await((N=(b=Ue(this,oi).config).onSettled)==null?void 0:N.call(b,M,null,this.state.variables,this.state.context,this)),await((C=(_=this.options).onSettled)==null?void 0:C.call(_,M,null,t,this.state.context)),dr(this,vl,qc).call(this,{type:"success",data:M}),M}catch(M){try{throw await((A=(T=Ue(this,oi).config).onError)==null?void 0:A.call(T,M,t,this.state.context,this)),await((I=(k=this.options).onError)==null?void 0:I.call(k,M,t,this.state.context)),await((O=(B=Ue(this,oi).config).onSettled)==null?void 0:O.call(B,void 0,M,this.state.variables,this.state.context,this)),await((F=(D=this.options).onSettled)==null?void 0:F.call(D,void 0,M,t,this.state.context)),M}finally{dr(this,vl,qc).call(this,{type:"error",error:M})}}finally{Ue(this,oi).runNext(this)}}},gl=new WeakMap,oi=new WeakMap,vu=new WeakMap,vl=new WeakSet,qc=function(t){const r=a=>{switch(t.type){case"failed":return{...a,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...a,isPaused:!0};case"continue":return{...a,isPaused:!1};case"pending":return{...a,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...a,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...a,data:void 0,error:t.error,failureCount:a.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),dn.batch(()=>{Ue(this,gl).forEach(a=>{a.onMutationUpdate(t)}),Ue(this,oi).notify({mutation:this,type:"updated",action:t})})},PS);function G4(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var lc,Wo,Vp,IS,AM=(IS=class extends Mf{constructor(t={}){super();Ss(this,lc);Ss(this,Wo);Ss(this,Vp);this.config=t,rs(this,lc,new Set),rs(this,Wo,new Map),rs(this,Vp,0)}build(t,r,a){const n=new TM({mutationCache:this,mutationId:++A0(this,Vp)._,options:t.defaultMutationOptions(r),state:a});return this.add(n),n}add(t){Ue(this,lc).add(t);const r=P0(t);if(typeof r=="string"){const a=Ue(this,Wo).get(r);a?a.push(t):Ue(this,Wo).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(Ue(this,lc).delete(t)){const r=P0(t);if(typeof r=="string"){const a=Ue(this,Wo).get(r);if(a)if(a.length>1){const n=a.indexOf(t);n!==-1&&a.splice(n,1)}else a[0]===t&&Ue(this,Wo).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=P0(t);if(typeof r=="string"){const a=Ue(this,Wo).get(r),n=a==null?void 0:a.find(i=>i.state.status==="pending");return!n||n===t}else return!0}runNext(t){var a;const r=P0(t);if(typeof r=="string"){const n=(a=Ue(this,Wo).get(r))==null?void 0:a.find(i=>i!==t&&i.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}else return Promise.resolve()}clear(){dn.batch(()=>{Ue(this,lc).forEach(t=>{this.notify({type:"removed",mutation:t})}),Ue(this,lc).clear(),Ue(this,Wo).clear()})}getAll(){return Array.from(Ue(this,lc))}find(t){const r={exact:!0,...t};return this.getAll().find(a=>Q2(r,a))}findAll(t={}){return this.getAll().filter(r=>Q2(t,r))}notify(t){dn.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return dn.batch(()=>Promise.all(t.map(r=>r.continue().catch(ci))))}},lc=new WeakMap,Wo=new WeakMap,Vp=new WeakMap,IS);function P0(e){var t;return(t=e.options.scope)==null?void 0:t.id}function tj(e){return{onFetch:(t,r)=>{var p,x,v,b,N;const a=t.options,n=(v=(x=(p=t.fetchOptions)==null?void 0:p.meta)==null?void 0:x.fetchMore)==null?void 0:v.direction,i=((b=t.state.data)==null?void 0:b.pages)||[],o=((N=t.state.data)==null?void 0:N.pageParams)||[];let c={pages:[],pageParams:[]},d=0;const h=async()=>{let _=!1;const C=k=>{Object.defineProperty(k,"signal",{enumerable:!0,get:()=>(t.signal.aborted?_=!0:t.signal.addEventListener("abort",()=>{_=!0}),t.signal)})},T=V4(t.options,t.fetchOptions),A=async(k,I,B)=>{if(_)return Promise.reject();if(I==null&&k.pages.length)return Promise.resolve(k);const D=(()=>{const q={client:t.client,queryKey:t.queryKey,pageParam:I,direction:B?"backward":"forward",meta:t.options.meta};return C(q),q})(),F=await T(D),{maxPages:M}=t.options,z=B?yM:vM;return{pages:z(k.pages,F,M),pageParams:z(k.pageParams,I,M)}};if(n&&i.length){const k=n==="backward",I=k?kM:sj,B={pages:i,pageParams:o},O=I(a,B);c=await A(B,O,k)}else{const k=e??i.length;do{const I=d===0?o[0]??a.initialPageParam:sj(a,c);if(d>0&&I==null)break;c=await A(c,I),d++}while(d<k)}return c};t.options.persister?t.fetchFn=()=>{var _,C;return(C=(_=t.options).persister)==null?void 0:C.call(_,h,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=h}}}function sj(e,{pages:t,pageParams:r}){const a=t.length-1;return t.length>0?e.getNextPageParam(t[a],t,r[a],r):void 0}function kM(e,{pages:t,pageParams:r}){var a;return t.length>0?(a=e.getPreviousPageParam)==null?void 0:a.call(e,t[0],t,r[0],r):void 0}var Aa,ld,cd,Kh,Xh,dd,Yh,Zh,OS,RM=(OS=class{constructor(e={}){Ss(this,Aa);Ss(this,ld);Ss(this,cd);Ss(this,Kh);Ss(this,Xh);Ss(this,dd);Ss(this,Yh);Ss(this,Zh);rs(this,Aa,e.queryCache||new SM),rs(this,ld,e.mutationCache||new AM),rs(this,cd,e.defaultOptions||{}),rs(this,Kh,new Map),rs(this,Xh,new Map),rs(this,dd,0)}mount(){A0(this,dd)._++,Ue(this,dd)===1&&(rs(this,Yh,Ww.subscribe(async e=>{e&&(await this.resumePausedMutations(),Ue(this,Aa).onFocus())})),rs(this,Zh,Ax.subscribe(async e=>{e&&(await this.resumePausedMutations(),Ue(this,Aa).onOnline())})))}unmount(){var e,t;A0(this,dd)._--,Ue(this,dd)===0&&((e=Ue(this,Yh))==null||e.call(this),rs(this,Yh,void 0),(t=Ue(this,Zh))==null||t.call(this),rs(this,Zh,void 0))}isFetching(e){return Ue(this,Aa).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return Ue(this,ld).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=Ue(this,Aa).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=Ue(this,Aa).build(this,t),a=r.state.data;return a===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(bd(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(a))}getQueriesData(e){return Ue(this,Aa).findAll(e).map(({queryKey:t,state:r})=>{const a=r.data;return[t,a]})}setQueryData(e,t,r){const a=this.defaultQueryOptions({queryKey:e}),n=Ue(this,Aa).get(a.queryHash),i=n==null?void 0:n.state.data,o=xM(t,i);if(o!==void 0)return Ue(this,Aa).build(this,a).setData(o,{...r,manual:!0})}setQueriesData(e,t,r){return dn.batch(()=>Ue(this,Aa).findAll(e).map(({queryKey:a})=>[a,this.setQueryData(a,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=Ue(this,Aa).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=Ue(this,Aa);dn.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=Ue(this,Aa);return dn.batch(()=>(r.findAll(e).forEach(a=>{a.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},a=dn.batch(()=>Ue(this,Aa).findAll(e).map(n=>n.cancel(r)));return Promise.all(a).then(ci).catch(ci)}invalidateQueries(e,t={}){return dn.batch(()=>(Ue(this,Aa).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},a=dn.batch(()=>Ue(this,Aa).findAll(e).filter(n=>!n.isDisabled()&&!n.isStatic()).map(n=>{let i=n.fetch(void 0,r);return r.throwOnError||(i=i.catch(ci)),n.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(a).then(ci)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=Ue(this,Aa).build(this,t);return r.isStaleByTime(bd(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(ci).catch(ci)}fetchInfiniteQuery(e){return e.behavior=tj(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(ci).catch(ci)}ensureInfiniteQueryData(e){return e.behavior=tj(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Ax.isOnline()?Ue(this,ld).resumePausedMutations():Promise.resolve()}getQueryCache(){return Ue(this,Aa)}getMutationCache(){return Ue(this,ld)}getDefaultOptions(){return Ue(this,cd)}setDefaultOptions(e){rs(this,cd,e)}setQueryDefaults(e,t){Ue(this,Kh).set(Au(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...Ue(this,Kh).values()],r={};return t.forEach(a=>{ap(e,a.queryKey)&&Object.assign(r,a.defaultOptions)}),r}setMutationDefaults(e,t){Ue(this,Xh).set(Au(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...Ue(this,Xh).values()],r={};return t.forEach(a=>{ap(e,a.mutationKey)&&Object.assign(r,a.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...Ue(this,cd).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=$w(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===qw&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...Ue(this,cd).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){Ue(this,Aa).clear(),Ue(this,ld).clear()}},Aa=new WeakMap,ld=new WeakMap,cd=new WeakMap,Kh=new WeakMap,Xh=new WeakMap,dd=new WeakMap,Yh=new WeakMap,Zh=new WeakMap,OS),Ni,Nr,Up,li,yu,Qh,ud,hd,zp,Jh,ef,wu,bu,fd,tf,zr,Em,Wv,Hv,Gv,Kv,Xv,Yv,Zv,K4,DS,PM=(DS=class extends Mf{constructor(t,r){super();Ss(this,zr);Ss(this,Ni);Ss(this,Nr);Ss(this,Up);Ss(this,li);Ss(this,yu);Ss(this,Qh);Ss(this,ud);Ss(this,hd);Ss(this,zp);Ss(this,Jh);Ss(this,ef);Ss(this,wu);Ss(this,bu);Ss(this,fd);Ss(this,tf,new Set);this.options=r,rs(this,Ni,t),rs(this,hd,null),rs(this,ud,qv()),this.options.experimental_prefetchInRender||Ue(this,ud).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(Ue(this,Nr).addObserver(this),rj(Ue(this,Nr),this.options)?dr(this,zr,Em).call(this):this.updateResult(),dr(this,zr,Kv).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Qv(Ue(this,Nr),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Qv(Ue(this,Nr),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,dr(this,zr,Xv).call(this),dr(this,zr,Yv).call(this),Ue(this,Nr).removeObserver(this)}setOptions(t){const r=this.options,a=Ue(this,Nr);if(this.options=Ue(this,Ni).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof xo(this.options.enabled,Ue(this,Nr))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");dr(this,zr,Zv).call(this),Ue(this,Nr).setOptions(this.options),r._defaulted&&!Tx(this.options,r)&&Ue(this,Ni).getQueryCache().notify({type:"observerOptionsUpdated",query:Ue(this,Nr),observer:this});const n=this.hasListeners();n&&aj(Ue(this,Nr),a,this.options,r)&&dr(this,zr,Em).call(this),this.updateResult(),n&&(Ue(this,Nr)!==a||xo(this.options.enabled,Ue(this,Nr))!==xo(r.enabled,Ue(this,Nr))||bd(this.options.staleTime,Ue(this,Nr))!==bd(r.staleTime,Ue(this,Nr)))&&dr(this,zr,Wv).call(this);const i=dr(this,zr,Hv).call(this);n&&(Ue(this,Nr)!==a||xo(this.options.enabled,Ue(this,Nr))!==xo(r.enabled,Ue(this,Nr))||i!==Ue(this,fd))&&dr(this,zr,Gv).call(this,i)}getOptimisticResult(t){const r=Ue(this,Ni).getQueryCache().build(Ue(this,Ni),t),a=this.createResult(r,t);return OM(this,a)&&(rs(this,li,a),rs(this,Qh,this.options),rs(this,yu,Ue(this,Nr).state)),a}getCurrentResult(){return Ue(this,li)}trackResult(t,r){return new Proxy(t,{get:(a,n)=>(this.trackProp(n),r==null||r(n),Reflect.get(a,n))})}trackProp(t){Ue(this,tf).add(t)}getCurrentQuery(){return Ue(this,Nr)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=Ue(this,Ni).defaultQueryOptions(t),a=Ue(this,Ni).getQueryCache().build(Ue(this,Ni),r);return a.fetch().then(()=>this.createResult(a,r))}fetch(t){return dr(this,zr,Em).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),Ue(this,li)))}createResult(t,r){var M;const a=Ue(this,Nr),n=this.options,i=Ue(this,li),o=Ue(this,yu),c=Ue(this,Qh),h=t!==a?t.state:Ue(this,Up),{state:p}=t;let x={...p},v=!1,b;if(r._optimisticResults){const z=this.hasListeners(),q=!z&&rj(t,r),Y=z&&aj(t,a,r,n);(q||Y)&&(x={...x,...H4(p.data,t.options)}),r._optimisticResults==="isRestoring"&&(x.fetchStatus="idle")}let{error:N,errorUpdatedAt:_,status:C}=x;b=x.data;let T=!1;if(r.placeholderData!==void 0&&b===void 0&&C==="pending"){let z;i!=null&&i.isPlaceholderData&&r.placeholderData===(c==null?void 0:c.placeholderData)?(z=i.data,T=!0):z=typeof r.placeholderData=="function"?r.placeholderData((M=Ue(this,ef))==null?void 0:M.state.data,Ue(this,ef)):r.placeholderData,z!==void 0&&(C="success",b=$v(i==null?void 0:i.data,z,r),v=!0)}if(r.select&&b!==void 0&&!T)if(i&&b===(o==null?void 0:o.data)&&r.select===Ue(this,zp))b=Ue(this,Jh);else try{rs(this,zp,r.select),b=r.select(b),b=$v(i==null?void 0:i.data,b,r),rs(this,Jh,b),rs(this,hd,null)}catch(z){rs(this,hd,z)}Ue(this,hd)&&(N=Ue(this,hd),b=Ue(this,Jh),_=Date.now(),C="error");const A=x.fetchStatus==="fetching",k=C==="pending",I=C==="error",B=k&&A,O=b!==void 0,F={status:C,fetchStatus:x.fetchStatus,isPending:k,isSuccess:C==="success",isError:I,isInitialLoading:B,isLoading:B,data:b,dataUpdatedAt:x.dataUpdatedAt,error:N,errorUpdatedAt:_,failureCount:x.fetchFailureCount,failureReason:x.fetchFailureReason,errorUpdateCount:x.errorUpdateCount,isFetched:x.dataUpdateCount>0||x.errorUpdateCount>0,isFetchedAfterMount:x.dataUpdateCount>h.dataUpdateCount||x.errorUpdateCount>h.errorUpdateCount,isFetching:A,isRefetching:A&&!k,isLoadingError:I&&!O,isPaused:x.fetchStatus==="paused",isPlaceholderData:v,isRefetchError:I&&O,isStale:Hw(t,r),refetch:this.refetch,promise:Ue(this,ud),isEnabled:xo(r.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const z=ae=>{F.status==="error"?ae.reject(F.error):F.data!==void 0&&ae.resolve(F.data)},q=()=>{const ae=rs(this,ud,F.promise=qv());z(ae)},Y=Ue(this,ud);switch(Y.status){case"pending":t.queryHash===a.queryHash&&z(Y);break;case"fulfilled":(F.status==="error"||F.data!==Y.value)&&q();break;case"rejected":(F.status!=="error"||F.error!==Y.reason)&&q();break}}return F}updateResult(){const t=Ue(this,li),r=this.createResult(Ue(this,Nr),this.options);if(rs(this,yu,Ue(this,Nr).state),rs(this,Qh,this.options),Ue(this,yu).data!==void 0&&rs(this,ef,Ue(this,Nr)),Tx(r,t))return;rs(this,li,r);const a=()=>{if(!t)return!0;const{notifyOnChangeProps:n}=this.options,i=typeof n=="function"?n():n;if(i==="all"||!i&&!Ue(this,tf).size)return!0;const o=new Set(i??Ue(this,tf));return this.options.throwOnError&&o.add("error"),Object.keys(Ue(this,li)).some(c=>{const d=c;return Ue(this,li)[d]!==t[d]&&o.has(d)})};dr(this,zr,K4).call(this,{listeners:a()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&dr(this,zr,Kv).call(this)}},Ni=new WeakMap,Nr=new WeakMap,Up=new WeakMap,li=new WeakMap,yu=new WeakMap,Qh=new WeakMap,ud=new WeakMap,hd=new WeakMap,zp=new WeakMap,Jh=new WeakMap,ef=new WeakMap,wu=new WeakMap,bu=new WeakMap,fd=new WeakMap,tf=new WeakMap,zr=new WeakSet,Em=function(t){dr(this,zr,Zv).call(this);let r=Ue(this,Nr).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(ci)),r},Wv=function(){dr(this,zr,Xv).call(this);const t=bd(this.options.staleTime,Ue(this,Nr));if(Tu||Ue(this,li).isStale||!Uv(t))return;const a=F4(Ue(this,li).dataUpdatedAt,t)+1;rs(this,wu,setTimeout(()=>{Ue(this,li).isStale||this.updateResult()},a))},Hv=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(Ue(this,Nr)):this.options.refetchInterval)??!1},Gv=function(t){dr(this,zr,Yv).call(this),rs(this,fd,t),!(Tu||xo(this.options.enabled,Ue(this,Nr))===!1||!Uv(Ue(this,fd))||Ue(this,fd)===0)&&rs(this,bu,setInterval(()=>{(this.options.refetchIntervalInBackground||Ww.isFocused())&&dr(this,zr,Em).call(this)},Ue(this,fd)))},Kv=function(){dr(this,zr,Wv).call(this),dr(this,zr,Gv).call(this,dr(this,zr,Hv).call(this))},Xv=function(){Ue(this,wu)&&(clearTimeout(Ue(this,wu)),rs(this,wu,void 0))},Yv=function(){Ue(this,bu)&&(clearInterval(Ue(this,bu)),rs(this,bu,void 0))},Zv=function(){const t=Ue(this,Ni).getQueryCache().build(Ue(this,Ni),this.options);if(t===Ue(this,Nr))return;const r=Ue(this,Nr);rs(this,Nr,t),rs(this,Up,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},K4=function(t){dn.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(Ue(this,li))}),Ue(this,Ni).getQueryCache().notify({query:Ue(this,Nr),type:"observerResultsUpdated"})})},DS);function IM(e,t){return xo(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function rj(e,t){return IM(e,t)||e.state.data!==void 0&&Qv(e,t,t.refetchOnMount)}function Qv(e,t,r){if(xo(t.enabled,e)!==!1&&bd(t.staleTime,e)!=="static"){const a=typeof r=="function"?r(e):r;return a==="always"||a!==!1&&Hw(e,t)}return!1}function aj(e,t,r,a){return(e!==t||xo(a.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&Hw(e,r)}function Hw(e,t){return xo(t.enabled,e)!==!1&&e.isStaleByTime(bd(t.staleTime,e))}function OM(e,t){return!Tx(e.getCurrentResult(),t)}var md,pd,Ci,cc,xc,ux,Jv,MS,DM=(MS=class extends Mf{constructor(r,a){super();Ss(this,xc);Ss(this,md);Ss(this,pd);Ss(this,Ci);Ss(this,cc);rs(this,md,r),this.setOptions(a),this.bindMethods(),dr(this,xc,ux).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var n;const a=this.options;this.options=Ue(this,md).defaultMutationOptions(r),Tx(this.options,a)||Ue(this,md).getMutationCache().notify({type:"observerOptionsUpdated",mutation:Ue(this,Ci),observer:this}),a!=null&&a.mutationKey&&this.options.mutationKey&&Au(a.mutationKey)!==Au(this.options.mutationKey)?this.reset():((n=Ue(this,Ci))==null?void 0:n.state.status)==="pending"&&Ue(this,Ci).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=Ue(this,Ci))==null||r.removeObserver(this)}onMutationUpdate(r){dr(this,xc,ux).call(this),dr(this,xc,Jv).call(this,r)}getCurrentResult(){return Ue(this,pd)}reset(){var r;(r=Ue(this,Ci))==null||r.removeObserver(this),rs(this,Ci,void 0),dr(this,xc,ux).call(this),dr(this,xc,Jv).call(this)}mutate(r,a){var n;return rs(this,cc,a),(n=Ue(this,Ci))==null||n.removeObserver(this),rs(this,Ci,Ue(this,md).getMutationCache().build(Ue(this,md),this.options)),Ue(this,Ci).addObserver(this),Ue(this,Ci).execute(r)}},md=new WeakMap,pd=new WeakMap,Ci=new WeakMap,cc=new WeakMap,xc=new WeakSet,ux=function(){var a;const r=((a=Ue(this,Ci))==null?void 0:a.state)??G4();rs(this,pd,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},Jv=function(r){dn.batch(()=>{var a,n,i,o,c,d,h,p;if(Ue(this,cc)&&this.hasListeners()){const x=Ue(this,pd).variables,v=Ue(this,pd).context;(r==null?void 0:r.type)==="success"?((n=(a=Ue(this,cc)).onSuccess)==null||n.call(a,r.data,x,v),(o=(i=Ue(this,cc)).onSettled)==null||o.call(i,r.data,null,x,v)):(r==null?void 0:r.type)==="error"&&((d=(c=Ue(this,cc)).onError)==null||d.call(c,r.error,x,v),(p=(h=Ue(this,cc)).onSettled)==null||p.call(h,void 0,r.error,x,v))}this.listeners.forEach(x=>{x(Ue(this,pd))})})},MS),X4=E.createContext(void 0),Gw=e=>{const t=E.useContext(X4);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},MM=({client:e,children:t})=>(E.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),s.jsx(X4.Provider,{value:e,children:t})),Y4=E.createContext(!1),LM=()=>E.useContext(Y4);Y4.Provider;function FM(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var BM=E.createContext(FM()),VM=()=>E.useContext(BM),UM=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},zM=e=>{E.useEffect(()=>{e.clearReset()},[e])},$M=({result:e,errorResetBoundary:t,throwOnError:r,query:a,suspense:n})=>e.isError&&!t.isReset()&&!e.isFetching&&a&&(n&&e.data===void 0||U4(r,[e.error,a])),qM=e=>{if(e.suspense){const t=a=>a==="static"?a:Math.max(a??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...a)=>t(r(...a)):t(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},WM=(e,t)=>e.isLoading&&e.isFetching&&!t,HM=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,nj=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function GM(e,t,r){var x,v,b,N,_;const a=LM(),n=VM(),i=Gw(),o=i.defaultQueryOptions(e);(v=(x=i.getDefaultOptions().queries)==null?void 0:x._experimental_beforeQuery)==null||v.call(x,o),o._optimisticResults=a?"isRestoring":"optimistic",qM(o),UM(o,n),zM(n);const c=!i.getQueryCache().get(o.queryHash),[d]=E.useState(()=>new t(i,o)),h=d.getOptimisticResult(o),p=!a&&e.subscribed!==!1;if(E.useSyncExternalStore(E.useCallback(C=>{const T=p?d.subscribe(dn.batchCalls(C)):ci;return d.updateResult(),T},[d,p]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),E.useEffect(()=>{d.setOptions(o)},[o,d]),HM(o,h))throw nj(o,d,n);if($M({result:h,errorResetBoundary:n,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw h.error;if((N=(b=i.getDefaultOptions().queries)==null?void 0:b._experimental_afterQuery)==null||N.call(b,o,h),o.experimental_prefetchInRender&&!Tu&&WM(h,a)){const C=c?nj(o,d,n):(_=i.getQueryCache().get(o.queryHash))==null?void 0:_.promise;C==null||C.catch(ci).finally(()=>{d.updateResult()})}return o.notifyOnChangeProps?h:d.trackResult(h)}function KM(e,t){return GM(e,PM)}function S1(e,t){const r=Gw(),[a]=E.useState(()=>new DM(r,e));E.useEffect(()=>{a.setOptions(e)},[a,e]);const n=E.useSyncExternalStore(E.useCallback(o=>a.subscribe(dn.batchCalls(o)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),i=E.useCallback((o,c)=>{a.mutate(o,c).catch(ci)},[a]);if(n.error&&U4(a.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:i,mutateAsync:n.mutate}}const XM=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class Kw extends Error{constructor(t,r="FunctionsError",a){super(t),this.name=r,this.context=a}}class YM extends Kw{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class ij extends Kw{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class oj extends Kw{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var ey;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(ey||(ey={}));class ZM{constructor(t,{headers:r={},customFetch:a,region:n=ey.Any}={}){this.url=t,this.headers=r,this.region=n,this.fetch=XM(a)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return U8(this,arguments,void 0,function*(r,a={}){var n;let i,o;try{const{headers:c,method:d,body:h,signal:p,timeout:x}=a;let v={},{region:b}=a;b||(b=this.region);const N=new URL(`${this.url}/${r}`);b&&b!=="any"&&(v["x-region"]=b,N.searchParams.set("forceFunctionRegion",b));let _;h&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)?typeof Blob<"u"&&h instanceof Blob||h instanceof ArrayBuffer?(v["Content-Type"]="application/octet-stream",_=h):typeof h=="string"?(v["Content-Type"]="text/plain",_=h):typeof FormData<"u"&&h instanceof FormData?_=h:(v["Content-Type"]="application/json",_=JSON.stringify(h)):h&&typeof h!="string"&&!(typeof Blob<"u"&&h instanceof Blob)&&!(h instanceof ArrayBuffer)&&!(typeof FormData<"u"&&h instanceof FormData)?_=JSON.stringify(h):_=h;let C=p;x&&(o=new AbortController,i=setTimeout(()=>o.abort(),x),p?(C=o.signal,p.addEventListener("abort",()=>o.abort())):C=o.signal);const T=yield this.fetch(N.toString(),{method:d||"POST",headers:Object.assign(Object.assign(Object.assign({},v),this.headers),c),body:_,signal:C}).catch(B=>{throw new YM(B)}),A=T.headers.get("x-relay-error");if(A&&A==="true")throw new ij(T);if(!T.ok)throw new oj(T);let k=((n=T.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),I;return k==="application/json"?I=yield T.json():k==="application/octet-stream"||k==="application/pdf"?I=yield T.blob():k==="text/event-stream"?I=T:k==="multipart/form-data"?I=yield T.formData():I=yield T.text(),{data:I,error:null,response:T}}catch(c){return{data:null,error:c,response:c instanceof oj||c instanceof ij?c.context:void 0}}finally{i&&clearTimeout(i)}})}}var QM=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},JM=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let n=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let o=null,c=null,d=null,h=i.status,p=i.statusText;if(i.ok){var x,v;if(r.method!=="HEAD"){var b;const T=await i.text();T===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((b=r.headers.get("Accept"))===null||b===void 0)&&b.includes("application/vnd.pgrst.plan+text"))?c=T:c=JSON.parse(T))}const _=(x=r.headers.get("Prefer"))===null||x===void 0?void 0:x.match(/count=(exact|planned|estimated)/),C=(v=i.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");_&&C&&C.length>1&&(d=parseInt(C[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(c)&&(c.length>1?(o={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,d=null,h=406,p="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{var N;const _=await i.text();try{o=JSON.parse(_),Array.isArray(o)&&i.status===404&&(c=[],o=null,h=200,p="OK")}catch{i.status===404&&_===""?(h=204,p="No Content"):o={message:_}}if(o&&r.isMaybeSingle&&(!(o==null||(N=o.details)===null||N===void 0)&&N.includes("0 rows"))&&(o=null,h=200,p="OK"),o&&r.shouldThrowOnError)throw new QM(o)}return{error:o,data:c,count:d,status:h,statusText:p}});return this.shouldThrowOnError||(n=n.catch(i=>{var o;let c="";const d=i==null?void 0:i.cause;if(d){var h,p,x,v;const N=(h=d==null?void 0:d.message)!==null&&h!==void 0?h:"",_=(p=d==null?void 0:d.code)!==null&&p!==void 0?p:"";c=`${(x=i==null?void 0:i.name)!==null&&x!==void 0?x:"FetchError"}: ${i==null?void 0:i.message}`,c+=`

Caused by: ${(v=d==null?void 0:d.name)!==null&&v!==void 0?v:"Error"}: ${N}`,_&&(c+=` (${_})`),d!=null&&d.stack&&(c+=`
${d.stack}`)}else{var b;c=(b=i==null?void 0:i.stack)!==null&&b!==void 0?b:""}return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:c,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),n.then(e,t)}returns(){return this}overrideTypes(){return this}},eL=class extends JM{select(e){let t=!1;const r=(e??"*").split("").map(a=>/\s/.test(a)&&!t?"":(a==='"'&&(t=!t),a)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:a,referencedTable:n=a}={}){const i=n?`${n}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:a=r}={}){const n=typeof a>"u"?"offset":`${a}.offset`,i=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(n,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:a=!1,wal:n=!1,format:i="text"}={}){var o;const c=[e?"analyze":null,t?"verbose":null,r?"settings":null,a?"buffers":null,n?"wal":null].filter(Boolean).join("|"),d=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${d}"; options=${c};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const lj=new RegExp("[,()]");var yh=class extends eL{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(a=>typeof a=="string"&&lj.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(a=>typeof a=="string"&&lj.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:a}={}){let n="";a==="plain"?n="pl":a==="phrase"?n="ph":a==="websearch"&&(n="w");const i=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${n}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},tL=class{constructor(e,{headers:t={},schema:r,fetch:a}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=a}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:a}=t??{},n=r?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(h=>/\s/.test(h)&&!i?"":(h==='"'&&(i=!i),h)).join(""),{url:c,headers:d}=this.cloneRequestState();return c.searchParams.set("select",o),a&&d.append("Prefer",`count=${a}`),new yh({method:n,url:c,headers:d,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var a;const n="POST",{url:i,headers:o}=this.cloneRequestState();if(t&&o.append("Prefer",`count=${t}`),r||o.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((d,h)=>d.concat(Object.keys(h)),[]);if(c.length>0){const d=[...new Set(c)].map(h=>`"${h}"`);i.searchParams.set("columns",d.join(","))}}return new yh({method:n,url:i,headers:o,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:a,defaultToNull:n=!0}={}){var i;const o="POST",{url:c,headers:d}=this.cloneRequestState();if(d.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&c.searchParams.set("on_conflict",t),a&&d.append("Prefer",`count=${a}`),n||d.append("Prefer","missing=default"),Array.isArray(e)){const h=e.reduce((p,x)=>p.concat(Object.keys(x)),[]);if(h.length>0){const p=[...new Set(h)].map(x=>`"${x}"`);c.searchParams.set("columns",p.join(","))}}return new yh({method:o,url:c,headers:d,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(e,{count:t}={}){var r;const a="PATCH",{url:n,headers:i}=this.cloneRequestState();return t&&i.append("Prefer",`count=${t}`),new yh({method:a,url:n,headers:i,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE",{url:a,headers:n}=this.cloneRequestState();return e&&n.append("Prefer",`count=${e}`),new yh({method:r,url:a,headers:n,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},sL=class Z4{constructor(t,{headers:r={},schema:a,fetch:n}={}){this.url=t,this.headers=new Headers(r),this.schemaName=a,this.fetch=n}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new tL(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Z4(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:a=!1,get:n=!1,count:i}={}){var o;let c;const d=new URL(`${this.url}/rpc/${t}`);let h;const p=b=>b!==null&&typeof b=="object"&&(!Array.isArray(b)||b.some(p)),x=a&&Object.values(r).some(p);x?(c="POST",h=r):a||n?(c=a?"HEAD":"GET",Object.entries(r).filter(([b,N])=>N!==void 0).map(([b,N])=>[b,Array.isArray(N)?`{${N.join(",")}}`:`${N}`]).forEach(([b,N])=>{d.searchParams.append(b,N)})):(c="POST",h=r);const v=new Headers(this.headers);return x?v.set("Prefer",i?`count=${i},return=minimal`:"return=minimal"):i&&v.set("Prefer",`count=${i}`),new yh({method:c,url:d,headers:v,schema:this.schemaName,body:h,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class rL{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const a=r.versions;if(a&&a.node){const n=a.node,i=parseInt(n.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const a=this.getWebSocketConstructor();return new a(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const aL="2.90.1",nL=`realtime-js/${aL}`,Q4="1.0.0",iL="2.0.0",cj=Q4,ty=1e4,oL=1e3,lL=100;var Kc;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Kc||(Kc={}));var an;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(an||(an={}));var Ho;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Ho||(Ho={}));var sy;(function(e){e.websocket="websocket"})(sy||(sy={}));var au;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(au||(au={}));class cL{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let a=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(a))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,a;const n=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(t){var r,a;const n=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:{},o=new TextEncoder().encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(t,r,a){var n,i;const o=t.topic,c=(n=t.ref)!==null&&n!==void 0?n:"",d=(i=t.join_ref)!==null&&i!==void 0?i:"",h=t.payload.event,p=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},x=Object.keys(p).length===0?"":JSON.stringify(p);if(d.length>255)throw new Error(`joinRef length ${d.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`ref length ${c.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`userEvent length ${h.length} exceeds maximum of 255`);if(x.length>255)throw new Error(`metadata length ${x.length} exceeds maximum of 255`);const v=this.USER_BROADCAST_PUSH_META_LENGTH+d.length+c.length+o.length+h.length+x.length,b=new ArrayBuffer(this.HEADER_LENGTH+v);let N=new DataView(b),_=0;N.setUint8(_++,this.KINDS.userBroadcastPush),N.setUint8(_++,d.length),N.setUint8(_++,c.length),N.setUint8(_++,o.length),N.setUint8(_++,h.length),N.setUint8(_++,x.length),N.setUint8(_++,r),Array.from(d,T=>N.setUint8(_++,T.charCodeAt(0))),Array.from(c,T=>N.setUint8(_++,T.charCodeAt(0))),Array.from(o,T=>N.setUint8(_++,T.charCodeAt(0))),Array.from(h,T=>N.setUint8(_++,T.charCodeAt(0))),Array.from(x,T=>N.setUint8(_++,T.charCodeAt(0)));var C=new Uint8Array(b.byteLength+a.byteLength);return C.set(new Uint8Array(b),0),C.set(new Uint8Array(a),b.byteLength),C.buffer}decode(t,r){if(this._isArrayBuffer(t)){let a=this._binaryDecode(t);return r(a)}if(typeof t=="string"){const a=JSON.parse(t),[n,i,o,c,d]=a;return r({join_ref:n,ref:i,topic:o,event:c,payload:d})}return r({})}_binaryDecode(t){const r=new DataView(t),a=r.getUint8(0),n=new TextDecoder;switch(a){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,n)}}_decodeUserBroadcast(t,r,a){const n=r.getUint8(1),i=r.getUint8(2),o=r.getUint8(3),c=r.getUint8(4);let d=this.HEADER_LENGTH+4;const h=a.decode(t.slice(d,d+n));d=d+n;const p=a.decode(t.slice(d,d+i));d=d+i;const x=a.decode(t.slice(d,d+o));d=d+o;const v=t.slice(d,t.byteLength),b=c===this.JSON_ENCODING?JSON.parse(a.decode(v)):v,N={type:this.BROADCAST_EVENT,event:p,payload:b};return o>0&&(N.meta=JSON.parse(x)),{join_ref:null,ref:null,topic:h,event:this.BROADCAST_EVENT,payload:N}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([a])=>r.includes(a)))}}class J4{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ia;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(ia||(ia={}));const dj=(e,t,r={})=>{var a;const n=(a=r.skipTypes)!==null&&a!==void 0?a:[];return t?Object.keys(t).reduce((i,o)=>(i[o]=dL(o,e,t,n),i),{}):{}},dL=(e,t,r,a)=>{const n=t.find(c=>c.name===e),i=n==null?void 0:n.type,o=r[e];return i&&!a.includes(i)?eT(i,o):ry(o)},eT=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return mL(t,r)}switch(e){case ia.bool:return uL(t);case ia.float4:case ia.float8:case ia.int2:case ia.int4:case ia.int8:case ia.numeric:case ia.oid:return hL(t);case ia.json:case ia.jsonb:return fL(t);case ia.timestamp:return pL(t);case ia.abstime:case ia.date:case ia.daterange:case ia.int4range:case ia.int8range:case ia.money:case ia.reltime:case ia.text:case ia.time:case ia.timestamptz:case ia.timetz:case ia.tsrange:case ia.tstzrange:return ry(t);default:return ry(t)}},ry=e=>e,uL=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},hL=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},fL=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},mL=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,a=e[r];if(e[0]==="{"&&a==="}"){let i;const o=e.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(c=>eT(t,c))}return e},pL=e=>typeof e=="string"?e.replace(" ","T"):e,tT=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class T1{constructor(t,r,a={},n=ty){this.channel=t,this.event=r,this.payload=a,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var a;return this._hasReceived(t)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(a=>a.status===t).forEach(a=>a.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var uj;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(uj||(uj={}));class Lm{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},n=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Lm.syncState(this.state,n,i,o),this.pendingDiffs.forEach(d=>{this.state=Lm.syncDiff(this.state,d,i,o)}),this.pendingDiffs=[],c()}),this.channel._on(a.diff,{},n=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Lm.syncDiff(this.state,n,i,o),c())}),this.onJoin((n,i,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:o})}),this.onLeave((n,i,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,a,n){const i=this.cloneDeep(t),o=this.transformState(r),c={},d={};return this.map(i,(h,p)=>{o[h]||(d[h]=p)}),this.map(o,(h,p)=>{const x=i[h];if(x){const v=p.map(C=>C.presence_ref),b=x.map(C=>C.presence_ref),N=p.filter(C=>b.indexOf(C.presence_ref)<0),_=x.filter(C=>v.indexOf(C.presence_ref)<0);N.length>0&&(c[h]=N),_.length>0&&(d[h]=_)}else c[h]=p}),this.syncDiff(i,{joins:c,leaves:d},a,n)}static syncDiff(t,r,a,n){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),n||(n=()=>{}),this.map(i,(c,d)=>{var h;const p=(h=t[c])!==null&&h!==void 0?h:[];if(t[c]=this.cloneDeep(d),p.length>0){const x=t[c].map(b=>b.presence_ref),v=p.filter(b=>x.indexOf(b.presence_ref)<0);t[c].unshift(...v)}a(c,p,d)}),this.map(o,(c,d)=>{let h=t[c];if(!h)return;const p=d.map(x=>x.presence_ref);h=h.filter(x=>p.indexOf(x.presence_ref)<0),t[c]=h,n(c,h,d),h.length===0&&delete t[c]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(a=>r(a,t[a]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,a)=>{const n=t[a];return"metas"in n?r[a]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[a]=n,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var hj;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(hj||(hj={}));var Fm;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Fm||(Fm={}));var nc;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(nc||(nc={}));class Sh{constructor(t,r={config:{}},a){var n,i;if(this.topic=t,this.params=r,this.socket=a,this.bindings={},this.state=an.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new T1(this,Ho.join,this.params,this.timeout),this.rejoinTimer=new J4(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=an.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=an.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=an.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=an.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=an.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ho.reply,{},(o,c)=>{this._trigger(this._replyEventName(c),o)}),this.presence=new Lm(this),this.broadcastEndpointURL=tT(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var a,n,i;if(this.socket.isConnected()||this.socket.connect(),this.state==an.closed){const{config:{broadcast:o,presence:c,private:d}}=this.params,h=(n=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(b=>b.filter))!==null&&n!==void 0?n:[],p=!!this.bindings[Fm.PRESENCE]&&this.bindings[Fm.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,x={},v={broadcast:o,presence:Object.assign(Object.assign({},c),{enabled:p}),postgres_changes:h,private:d};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(b=>t==null?void 0:t(nc.CHANNEL_ERROR,b)),this._onClose(()=>t==null?void 0:t(nc.CLOSED)),this.updateJoinPayload(Object.assign({config:v},x)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:b})=>{var N;if(this.socket._isManualToken()||this.socket.setAuth(),b===void 0){t==null||t(nc.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,C=(N=_==null?void 0:_.length)!==null&&N!==void 0?N:0,T=[];for(let A=0;A<C;A++){const k=_[A],{filter:{event:I,schema:B,table:O,filter:D}}=k,F=b&&b[A];if(F&&F.event===I&&Sh.isFilterValueEqual(F.schema,B)&&Sh.isFilterValueEqual(F.table,O)&&Sh.isFilterValueEqual(F.filter,D))T.push(Object.assign(Object.assign({},k),{id:F.id}));else{this.unsubscribe(),this.state=an.errored,t==null||t(nc.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=T,t&&t(nc.SUBSCRIBED);return}}).receive("error",b=>{this.state=an.errored,t==null||t(nc.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(nc.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,a){return this.state===an.joined&&t===Fm.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,a)}async httpSend(t,r,a={}){var n;if(r==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},c=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(n=a.timeout)!==null&&n!==void 0?n:this.timeout);if(c.status===202)return{success:!0};let d=c.statusText;try{const h=await c.json();d=h.error||h.message||d}catch{}return Promise.reject(new Error(d))}async send(t,r={}){var a,n;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=t,c={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(c.Authorization=`Bearer ${this.socket.accessTokenValue}`);const d={method:"POST",headers:c,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((n=h.body)===null||n===void 0?void 0:n.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,c,d;const h=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((d=(c=(o=this.params)===null||o===void 0?void 0:o.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.ack)&&i("ok"),h.receive("ok",()=>i("ok")),h.receive("error",()=>i("error")),h.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=an.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ho.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(n=>{a=new T1(this,Ho.leave,{},t),a.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a==null||a.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=an.closed,this.bindings={}}async _fetchWithTimeout(t,r,a){const n=new AbortController,i=setTimeout(()=>n.abort(),a),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(i),o}_push(t,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new T1(this,t,r,a);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>lL){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,a){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,a){var n,i;const o=t.toLocaleLowerCase(),{close:c,error:d,leave:h,join:p}=Ho;if(a&&[c,d,h,p].indexOf(o)>=0&&a!==this._joinRef())return;let v=this._onMessage(o,r,a);if(r&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(b=>{var N,_,C;return((N=b.filter)===null||N===void 0?void 0:N.event)==="*"||((C=(_=b.filter)===null||_===void 0?void 0:_.event)===null||C===void 0?void 0:C.toLocaleLowerCase())===o}).map(b=>b.callback(v,a)):(i=this.bindings[o])===null||i===void 0||i.filter(b=>{var N,_,C,T,A,k,I,B;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in b){const O=b.id,D=(N=b.filter)===null||N===void 0?void 0:N.event;return O&&((_=r.ids)===null||_===void 0?void 0:_.includes(O))&&(D==="*"||(D==null?void 0:D.toLocaleLowerCase())===((C=r.data)===null||C===void 0?void 0:C.type.toLocaleLowerCase()))&&(!(!((T=b.filter)===null||T===void 0)&&T.table)||b.filter.table===((A=r.data)===null||A===void 0?void 0:A.table))}else{const O=(I=(k=b==null?void 0:b.filter)===null||k===void 0?void 0:k.event)===null||I===void 0?void 0:I.toLocaleLowerCase();return O==="*"||O===((B=r==null?void 0:r.event)===null||B===void 0?void 0:B.toLocaleLowerCase())}else return b.type.toLocaleLowerCase()===o}).map(b=>{if(typeof v=="object"&&"ids"in v){const N=v.data,{schema:_,table:C,commit_timestamp:T,type:A,errors:k}=N;v=Object.assign(Object.assign({},{schema:_,table:C,commit_timestamp:T,eventType:A,new:{},old:{},errors:k}),this._getPayloadRecords(N))}b.callback(v,a)})}_isClosed(){return this.state===an.closed}_isJoined(){return this.state===an.joined}_isJoining(){return this.state===an.joining}_isLeaving(){return this.state===an.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,a){const n=t.toLocaleLowerCase(),i={type:n,filter:r,callback:a};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(t,r){const a=t.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===a&&Sh.isEqual(n.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const a in t)if(t[a]!==r[a])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Ho.close,{},t)}_onError(t){this._on(Ho.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=an.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=dj(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=dj(t.columns,t.old_record)),r}}const A1=()=>{},I0={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},xL=[1e3,2e3,5e3,1e4],gL=1e4,vL=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class yL{constructor(t,r){var a;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=ty,this.transport=null,this.heartbeatIntervalMs=I0.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=A1,this.ref=0,this.reconnectTimer=null,this.vsn=cj,this.logger=A1,this.conn=null,this.sendBuffer=[],this.serializer=new cL,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=n=>n?(...i)=>n(...i):(...i)=>fetch(...i),!(!((a=r==null?void 0:r.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${sy.websocket}`,this.httpEndpoint=tT(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=rL.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,a){this.logger(t,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case Kc.connecting:return au.Connecting;case Kc.open:return au.Open;case Kc.closing:return au.Closing;default:return au.Closed}}isConnected(){return this.connectionState()===au.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const a=`realtime:${t}`,n=this.getChannels().find(i=>i.topic===a);if(n)return n;{const i=new Sh(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:a,payload:n,ref:i}=t,o=()=>{this.encode(t,c=>{var d;(d=this.conn)===null||d===void 0||d.send(c)})};this.log("push",`${r} ${a} (${i})`,n),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(oL,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},I0.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(a=>a.topic===t&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const h=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",h)}catch(p){this.log("error","error in heartbeat callback",p)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:a,event:n,payload:i,ref:o}=r,c=o?`(${o})`:"",d=i.status||"";this.log("receive",`${d} ${a} ${n} ${c}`.trim(),i),this.channels.filter(h=>h._isMember(a)).forEach(h=>h._trigger(n,i,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===Kc.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Kc.open||this.conn.readyState===Kc.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Ho.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const a=t.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${t}${a}${n}`}_workerObjectUrl(t){let r;if(t)r=t;else{const a=new Blob([vL],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,a=!1;if(t)r=t,a=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(n){this.log("error","Error fetching access token from callback",n),r=this.accessTokenValue}else r=this.accessTokenValue;a?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:nL};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(Ho.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(a=>{try{a(r)}catch(n){this.log("error",`error in ${t} callback`,n)}})}catch(a){this.log("error",`error triggering ${t} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new J4(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},I0.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,a,n,i,o,c,d,h,p,x,v,b;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(a=t==null?void 0:t.timeout)!==null&&a!==void 0?a:ty,this.heartbeatIntervalMs=(n=t==null?void 0:t.heartbeatIntervalMs)!==null&&n!==void 0?n:I0.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(c=t==null?void 0:t.heartbeatCallback)!==null&&c!==void 0?c:A1,this.vsn=(d=t==null?void 0:t.vsn)!==null&&d!==void 0?d:cj,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=t==null?void 0:t.reconnectAfterMs)!==null&&h!==void 0?h:N=>xL[N-1]||gL,this.vsn){case Q4:this.encode=(p=t==null?void 0:t.encode)!==null&&p!==void 0?p:(N,_)=>_(JSON.stringify(N)),this.decode=(x=t==null?void 0:t.decode)!==null&&x!==void 0?x:(N,_)=>_(JSON.parse(N));break;case iL:this.encode=(v=t==null?void 0:t.encode)!==null&&v!==void 0?v:this.serializer.encode.bind(this.serializer),this.decode=(b=t==null?void 0:t.decode)!==null&&b!==void 0?b:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var np=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function wL(e,t,r){const a=new URL(t,e);if(r)for(const[n,i]of Object.entries(r))i!==void 0&&a.searchParams.set(n,i);return a.toString()}async function bL(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function _L(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:a,query:n,body:i,headers:o}){const c=wL(e.baseUrl,a,n),d=await bL(e.auth),h=await t(c,{method:r,headers:{...i?{"Content-Type":"application/json"}:{},...d,...o},body:i?JSON.stringify(i):void 0}),p=await h.text(),x=(h.headers.get("content-type")||"").includes("application/json"),v=x&&p?JSON.parse(p):p;if(!h.ok){const b=x?v:void 0,N=b==null?void 0:b.error;throw new np((N==null?void 0:N.message)??`Request failed with status ${h.status}`,{status:h.status,icebergType:N==null?void 0:N.type,icebergCode:N==null?void 0:N.code,details:b})}return{status:h.status,headers:h.headers,data:v}}}}function O0(e){return e.join("")}var jL=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:O0(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${O0(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${O0(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${O0(e.namespace)}`}),!0}catch(t){if(t instanceof np&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof np&&r.status===409)return;throw r}}};function nh(e){return e.join("")}var NL=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${nh(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${nh(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${nh(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${nh(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${nh(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${nh(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof np&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof np&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},CL=class{constructor(e){var a;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=_L({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(a=e.accessDelegation)==null?void 0:a.join(","),this.namespaceOps=new jL(this.client,t),this.tableOps=new NL(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},Sg=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function Na(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var EL=class extends Sg{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},ay=class extends Sg{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const Xw=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),SL=()=>Response,ny=e=>{if(Array.isArray(e))return e.map(r=>ny(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,a])=>{const n=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[n]=ny(a)}),t},TL=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},AL=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function ip(e){"@babel/helpers - typeof";return ip=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ip(e)}function kL(e,t){if(ip(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t||"default");if(ip(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RL(e){var t=kL(e,"string");return ip(t)=="symbol"?t:t+""}function PL(e,t,r){return(t=RL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Is(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fj(Object(r),!0).forEach(function(a){PL(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fj(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}const k1=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},IL=async(e,t,r)=>{e instanceof await SL()&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{const n=e.status||500,i=(a==null?void 0:a.statusCode)||n+"";t(new EL(k1(a),n,i))}).catch(a=>{t(new ay(k1(a),a))}):t(new ay(k1(e),e))},OL=(e,t,r,a)=>{const n={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!a?n:(TL(a)?(n.headers=Is({"Content-Type":"application/json"},t==null?void 0:t.headers),n.body=JSON.stringify(a)):n.body=a,t!=null&&t.duplex&&(n.duplex=t.duplex),Is(Is({},n),r))};async function Hp(e,t,r,a,n,i){return new Promise((o,c)=>{e(r,OL(t,a,n,i)).then(d=>{if(!d.ok)throw d;return a!=null&&a.noResolveJson?d:d.json()}).then(d=>o(d)).catch(d=>IL(d,c,a))})}async function op(e,t,r,a){return Hp(e,"GET",t,r,a)}async function $o(e,t,r,a,n){return Hp(e,"POST",t,a,n,r)}async function iy(e,t,r,a,n){return Hp(e,"PUT",t,a,n,r)}async function DL(e,t,r,a){return Hp(e,"HEAD",t,Is(Is({},r),{},{noResolveJson:!0}),a)}async function Yw(e,t,r,a,n){return Hp(e,"DELETE",t,a,n,r)}var ML=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Na(t))return{data:null,error:t};throw t}}};let sT;sT=Symbol.toStringTag;var LL=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[sT]="BlobDownloadBuilder",this.promise=null}asStream(){return new ML(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Na(t))return{data:null,error:t};throw t}}};const FL={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},mj={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var BL=class{constructor(e,t={},r,a){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=Xw(a)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,a){var n=this;try{let i;const o=Is(Is({},mj),a);let c=Is(Is({},n.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const d=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),d&&i.append("metadata",n.encodeMetadata(d)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),d&&!i.has("metadata")&&i.append("metadata",n.encodeMetadata(d))):(i=r,c["cache-control"]=`max-age=${o.cacheControl}`,c["content-type"]=o.contentType,d&&(c["x-metadata"]=n.toBase64(n.encodeMetadata(d))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),a!=null&&a.headers&&(c=Is(Is({},c),a.headers));const h=n._removeEmptyFolders(t),p=n._getFinalPath(h),x=await(e=="PUT"?iy:$o)(n.fetch,`${n.url}/object/${p}`,i,Is({headers:c},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:h,id:x.Id,fullPath:x.Key},error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Na(i))return{data:null,error:i};throw i}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,a){var n=this;const i=n._removeEmptyFolders(e),o=n._getFinalPath(i),c=new URL(n.url+`/object/upload/sign/${o}`);c.searchParams.set("token",t);try{let d;const h=Is({upsert:mj.upsert},a),p=Is(Is({},n.headers),{"x-upsert":String(h.upsert)});return typeof Blob<"u"&&r instanceof Blob?(d=new FormData,d.append("cacheControl",h.cacheControl),d.append("",r)):typeof FormData<"u"&&r instanceof FormData?(d=r,d.append("cacheControl",h.cacheControl)):(d=r,p["cache-control"]=`max-age=${h.cacheControl}`,p["content-type"]=h.contentType),{data:{path:i,fullPath:(await iy(n.fetch,c.toString(),d,{headers:p})).Key},error:null}}catch(d){if(n.shouldThrowOnError)throw d;if(Na(d))return{data:null,error:d};throw d}}async createSignedUploadUrl(e,t){var r=this;try{let a=r._getFinalPath(e);const n=Is({},r.headers);t!=null&&t.upsert&&(n["x-upsert"]="true");const i=await $o(r.fetch,`${r.url}/object/upload/sign/${a}`,{},{headers:n}),o=new URL(r.url+i.url),c=o.searchParams.get("token");if(!c)throw new Sg("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:c},error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Na(a))return{data:null,error:a};throw a}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var a=this;try{return{data:await $o(a.fetch,`${a.url}/object/move`,{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:a.headers}),error:null}}catch(n){if(a.shouldThrowOnError)throw n;if(Na(n))return{data:null,error:n};throw n}}async copy(e,t,r){var a=this;try{return{data:{path:(await $o(a.fetch,`${a.url}/object/copy`,{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:a.headers})).Key},error:null}}catch(n){if(a.shouldThrowOnError)throw n;if(Na(n))return{data:null,error:n};throw n}}async createSignedUrl(e,t,r){var a=this;try{let n=a._getFinalPath(e),i=await $o(a.fetch,`${a.url}/object/sign/${n}`,Is({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:a.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${a.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(n){if(a.shouldThrowOnError)throw n;if(Na(n))return{data:null,error:n};throw n}}async createSignedUrls(e,t,r){var a=this;try{const n=await $o(a.fetch,`${a.url}/object/sign/${a.bucketId}`,{expiresIn:t,paths:e},{headers:a.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:n.map(o=>Is(Is({},o),{},{signedUrl:o.signedURL?encodeURI(`${a.url}${o.signedURL}${i}`):null})),error:null}}catch(n){if(a.shouldThrowOnError)throw n;if(Na(n))return{data:null,error:n};throw n}}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),n=a?`?${a}`:"",i=this._getFinalPath(e),o=()=>op(this.fetch,`${this.url}/${r}/${i}${n}`,{headers:this.headers,noResolveJson:!0});return new LL(o,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:ny(await op(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(Na(a))return{data:null,error:a};throw a}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await DL(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(Na(a)&&a instanceof ay){const n=a.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:a}}throw a}}getPublicUrl(e,t){const r=this._getFinalPath(e),a=[],n=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";n!==""&&a.push(n);const i=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",o=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});o!==""&&a.push(o);let c=a.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${c}`)}}}async remove(e){var t=this;try{return{data:await Yw(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Na(r))return{data:null,error:r};throw r}}async list(e,t,r){var a=this;try{const n=Is(Is(Is({},FL),t),{},{prefix:e||""});return{data:await $o(a.fetch,`${a.url}/object/list/${a.bucketId}`,n,{headers:a.headers},r),error:null}}catch(n){if(a.shouldThrowOnError)throw n;if(Na(n))return{data:null,error:n};throw n}}async listV2(e,t){var r=this;try{const a=Is({},e);return{data:await $o(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,a,{headers:r.headers},t),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Na(a))return{data:null,error:a};throw a}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const rT="2.90.1",aT={"X-Client-Info":`storage-js/${rT}`};var VL=class{constructor(e,t={},r,a){this.shouldThrowOnError=!1;const n=new URL(e);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase.")),this.url=n.href.replace(/\/$/,""),this.headers=Is(Is({},aT),t),this.fetch=Xw(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await op(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Na(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await op(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Na(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await $o(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Na(a))return{data:null,error:a};throw a}}async updateBucket(e,t){var r=this;try{return{data:await iy(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Na(a))return{data:null,error:a};throw a}}async emptyBucket(e){var t=this;try{return{data:await $o(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Na(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Yw(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Na(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},UL=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Is(Is({},aT),t),this.fetch=Xw(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await $o(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Na(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const a=r.toString(),n=a?`${t.url}/bucket?${a}`:`${t.url}/bucket`;return{data:await op(t.fetch,n,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Na(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Yw(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Na(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!AL(e))throw new Sg("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new CL({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),a=this.shouldThrowOnError;return new Proxy(r,{get(n,i){const o=n[i];return typeof o!="function"?o:async(...c)=>{try{return{data:await o.apply(n,c),error:null}}catch(d){if(a)throw d;return{data:null,error:d}}}}})}};const Zw={"X-Client-Info":`storage-js/${rT}`,"Content-Type":"application/json"};var nT=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Gi(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var R1=class extends nT{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},zL=class extends nT{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const Qw=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),$L=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},pj=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),qL=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const a=e.status||500,n=e;if(typeof n.json=="function")n.json().then(i=>{const o=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||a+"";t(new R1(pj(i),a,o))}).catch(()=>{const i=a+"";t(new R1(n.statusText||`HTTP ${a} error`,a,i))});else{const i=a+"";t(new R1(n.statusText||`HTTP ${a} error`,a,i))}}else t(new zL(pj(e),e))},WL=(e,t,r,a)=>{const n={method:e,headers:(t==null?void 0:t.headers)||{}};return a?($L(a)?(n.headers=Is({"Content-Type":"application/json"},t==null?void 0:t.headers),n.body=JSON.stringify(a)):n.body=a,Is(Is({},n),r)):n};async function HL(e,t,r,a,n,i){return new Promise((o,c)=>{e(r,WL(t,a,n,i)).then(d=>{if(!d.ok)throw d;if(a!=null&&a.noResolveJson)return d;const h=d.headers.get("content-type");return!h||!h.includes("application/json")?{}:d.json()}).then(d=>o(d)).catch(d=>qL(d,c,a))})}async function Ki(e,t,r,a,n){return HL(e,"POST",t,a,n,r)}var GL=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Is(Is({},Zw),t),this.fetch=Qw(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await Ki(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Gi(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await Ki(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Gi(a))return{data:null,error:a};throw a}}async listIndexes(e){var t=this;try{return{data:await Ki(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Gi(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await Ki(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Gi(a))return{data:null,error:a};throw a}}},KL=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Is(Is({},Zw),t),this.fetch=Qw(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Ki(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Gi(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await Ki(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Gi(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await Ki(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Gi(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await Ki(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Gi(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Ki(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Gi(r))return{data:null,error:r};throw r}}},XL=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Is(Is({},Zw),t),this.fetch=Qw(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Ki(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Gi(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Ki(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Gi(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await Ki(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Gi(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Ki(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Gi(r))return{data:null,error:r};throw r}}},YL=class extends XL{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new ZL(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},ZL=class extends GL{constructor(e,t,r,a){super(e,t,a),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,Is(Is({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,Is(Is({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new QL(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},QL=class extends KL{constructor(e,t,r,a,n){super(e,t,n),this.vectorBucketName=r,this.indexName=a}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,Is(Is({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,Is(Is({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,Is(Is({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,Is(Is({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,Is(Is({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},JL=class extends VL{constructor(e,t={},r,a){super(e,t,r,a)}from(e){return new BL(this.url,this.headers,e,this.fetch)}get vectors(){return new YL(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new UL(this.url+"/iceberg",this.headers,this.fetch)}};const iT="2.90.1",wh=30*1e3,oy=3,P1=oy*wh,eF="http://localhost:9999",tF="supabase.auth.token",sF={"X-Client-Info":`gotrue-js/${iT}`},ly="X-Supabase-Api-Version",oT={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},rF=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,aF=10*60*1e3;class lp extends Error{constructor(t,r,a){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function bs(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class nF extends lp{constructor(t,r,a){super(t,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function iF(e){return bs(e)&&e.name==="AuthApiError"}class nu extends lp{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class jc extends lp{constructor(t,r,a,n){super(t,a,n),this.name=r,this.status=a}}class Vi extends jc{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function oF(e){return bs(e)&&e.name==="AuthSessionMissingError"}class ih extends jc{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class D0 extends jc{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class M0 extends jc{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function lF(e){return bs(e)&&e.name==="AuthImplicitGrantRedirectError"}class xj extends jc{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class cF extends jc{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class cy extends jc{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function I1(e){return bs(e)&&e.name==="AuthRetryableFetchError"}class gj extends jc{constructor(t,r,a){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}class dy extends jc{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const kx="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),vj=` 	
\r=`.split(""),dF=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<vj.length;t+=1)e[vj[t].charCodeAt(0)]=-2;for(let t=0;t<kx.length;t+=1)e[kx[t].charCodeAt(0)]=t;return e})();function yj(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(kx[a]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(kx[a]),t.queuedBits-=6}}function lT(e,t,r){const a=dF[e];if(a>-1)for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function wj(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},a={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=o=>{fF(o,a,r)};for(let o=0;o<e.length;o+=1)lT(e.charCodeAt(o),n,i);return t.join("")}function uF(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function hF(e,t){for(let r=0;r<e.length;r+=1){let a=e.charCodeAt(r);if(a>55295&&a<=56319){const n=(a-55296)*1024&65535;a=(e.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}uF(a,t)}}function fF(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let a=1;a<6;a+=1)if(!(e>>7-a&1)){t.utf8seq=a;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Mh(e){const t=[],r={queue:0,queuedBits:0},a=n=>{t.push(n)};for(let n=0;n<e.length;n+=1)lT(e.charCodeAt(n),r,a);return new Uint8Array(t)}function mF(e){const t=[];return hF(e,r=>t.push(r)),new Uint8Array(t)}function lu(e){const t=[],r={queue:0,queuedBits:0},a=n=>{t.push(n)};return e.forEach(n=>yj(n,r,a)),yj(null,r,a),t.join("")}function pF(e){return Math.round(Date.now()/1e3)+e}function xF(){return Symbol("auth-callback")}const En=()=>typeof window<"u"&&typeof document<"u",Yd={tested:!1,writable:!1},cT=()=>{if(!En())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Yd.tested)return Yd.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Yd.tested=!0,Yd.writable=!0}catch{Yd.tested=!0,Yd.writable=!1}return Yd.writable};function gF(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,i)=>{t[i]=n})}catch{}return r.searchParams.forEach((a,n)=>{t[n]=a}),t}const dT=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),vF=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",bh=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Zd=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Cn=async(e,t)=>{await e.removeItem(t)};class Tg{constructor(){this.promise=new Tg.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Tg.promiseConstructor=Promise;function O1(e){const t=e.split(".");if(t.length!==3)throw new dy("Invalid JWT structure");for(let a=0;a<t.length;a++)if(!rF.test(t[a]))throw new dy("JWT not in base64url format");return{header:JSON.parse(wj(t[0])),payload:JSON.parse(wj(t[1])),signature:Mh(t[2]),raw:{header:t[0],payload:t[1]}}}async function yF(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function wF(e,t){return new Promise((a,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await e(i);if(!t(i,null,o)){a(o);return}}catch(o){if(!t(i,o)){n(o);return}}})()})}function bF(e){return("0"+e.toString(16)).substr(-2)}function _F(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let n="";for(let i=0;i<56;i++)n+=r.charAt(Math.floor(Math.random()*a));return n}return crypto.getRandomValues(t),Array.from(t,bF).join("")}async function jF(e){const r=new TextEncoder().encode(e),a=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(a);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}async function NF(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await jF(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function oh(e,t,r=!1){const a=_F();let n=a;r&&(n+="/PASSWORD_RECOVERY"),await bh(e,`${t}-code-verifier`,n);const i=await NF(a);return[i,a===i?"plain":"s256"]}const CF=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function EF(e){const t=e.headers.get(ly);if(!t||!t.match(CF))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function SF(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function TF(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const AF=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function lh(e){if(!AF.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function D1(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function kF(e,t){return new Proxy(e,{get:(r,a,n)=>{if(a==="__isInsecureUserWarningProxy")return!0;if(typeof a=="symbol"){const i=a.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,a,n)}return!t.value&&typeof a=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,a,n)}})}function bj(e){return JSON.parse(JSON.stringify(e))}const tu=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),RF=[502,503,504];async function _j(e){var t;if(!vF(e))throw new cy(tu(e),0);if(RF.includes(e.status))throw new cy(tu(e),e.status);let r;try{r=await e.json()}catch(i){throw new nu(tu(i),i)}let a;const n=EF(e);if(n&&n.getTime()>=oT["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new gj(tu(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(a==="session_not_found")throw new Vi}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new gj(tu(r),e.status,r.weak_password.reasons);throw new nF(tu(r),e.status||500,a)}const PF=(e,t,r,a)=>{const n={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),n.body=JSON.stringify(a),Object.assign(Object.assign({},n),r))};async function Ps(e,t,r,a){var n;const i=Object.assign({},a==null?void 0:a.headers);i[ly]||(i[ly]=oT["2024-01-01"].name),a!=null&&a.jwt&&(i.Authorization=`Bearer ${a.jwt}`);const o=(n=a==null?void 0:a.query)!==null&&n!==void 0?n:{};a!=null&&a.redirectTo&&(o.redirect_to=a.redirectTo);const c=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",d=await IF(e,t,r+c,{headers:i,noResolveJson:a==null?void 0:a.noResolveJson},{},a==null?void 0:a.body);return a!=null&&a.xform?a==null?void 0:a.xform(d):{data:Object.assign({},d),error:null}}async function IF(e,t,r,a,n,i){const o=PF(t,a,n,i);let c;try{c=await e(r,Object.assign({},o))}catch(d){throw console.error(d),new cy(tu(d),0)}if(c.ok||await _j(c),a!=null&&a.noResolveJson)return c;try{return await c.json()}catch(d){await _j(d)}}function Vo(e){var t;let r=null;MF(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=pF(e.expires_in)));const a=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:a},error:null}}function jj(e){const t=Vo(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(t.data.weak_password=e.weak_password),t}function ad(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function OF(e){return{data:e,error:null}}function DF(e){const{action_link:t,email_otp:r,hashed_token:a,redirect_to:n,verification_type:i}=e,o=yg(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:t,email_otp:r,hashed_token:a,redirect_to:n,verification_type:i},d=Object.assign({},o);return{data:{properties:c,user:d},error:null}}function Nj(e){return e}function MF(e){return e.access_token&&e.refresh_token&&e.expires_in}const M1=["global","local","others"];class LF{constructor({url:t="",headers:r={},fetch:a}){this.url=t,this.headers=r,this.fetch=dT(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=M1[0]){if(M1.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${M1.join(", ")}`);try{return await Ps(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(bs(a))return{data:null,error:a};throw a}}async inviteUserByEmail(t,r={}){try{return await Ps(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:ad})}catch(a){if(bs(a))return{data:{user:null},error:a};throw a}}async generateLink(t){try{const{options:r}=t,a=yg(t,["options"]),n=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(n.new_email=a==null?void 0:a.newEmail,delete n.newEmail),await Ps(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:DF,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(bs(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ps(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:ad})}catch(r){if(bs(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,a,n,i,o,c,d;try{const h={nextPage:null,lastPage:0,total:0},p=await Ps(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(i=(n=t==null?void 0:t.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:Nj});if(p.error)throw p.error;const x=await p.json(),v=(o=p.headers.get("x-total-count"))!==null&&o!==void 0?o:0,b=(d=(c=p.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return b.length>0&&(b.forEach(N=>{const _=parseInt(N.split(";")[0].split("=")[1].substring(0,1)),C=JSON.parse(N.split(";")[1].split("=")[1]);h[`${C}Page`]=_}),h.total=parseInt(v)),{data:Object.assign(Object.assign({},x),h),error:null}}catch(h){if(bs(h))return{data:{users:[]},error:h};throw h}}async getUserById(t){lh(t);try{return await Ps(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:ad})}catch(r){if(bs(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){lh(t);try{return await Ps(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:ad})}catch(a){if(bs(a))return{data:{user:null},error:a};throw a}}async deleteUser(t,r=!1){lh(t);try{return await Ps(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:ad})}catch(a){if(bs(a))return{data:{user:null},error:a};throw a}}async _listFactors(t){lh(t.userId);try{const{data:r,error:a}=await Ps(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:a}}catch(r){if(bs(r))return{data:null,error:r};throw r}}async _deleteFactor(t){lh(t.userId),lh(t.id);try{return{data:await Ps(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(bs(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,a,n,i,o,c,d;try{const h={nextPage:null,lastPage:0,total:0},p=await Ps(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(i=(n=t==null?void 0:t.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:Nj});if(p.error)throw p.error;const x=await p.json(),v=(o=p.headers.get("x-total-count"))!==null&&o!==void 0?o:0,b=(d=(c=p.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return b.length>0&&(b.forEach(N=>{const _=parseInt(N.split(";")[0].split("=")[1].substring(0,1)),C=JSON.parse(N.split(";")[1].split("=")[1]);h[`${C}Page`]=_}),h.total=parseInt(v)),{data:Object.assign(Object.assign({},x),h),error:null}}catch(h){if(bs(h))return{data:{clients:[]},error:h};throw h}}async _createOAuthClient(t){try{return await Ps(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(bs(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Ps(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(bs(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Ps(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(bs(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(t){try{return await Ps(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(bs(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Ps(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(bs(r))return{data:null,error:r};throw r}}}function Cj(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const ch={debug:!!(globalThis&&cT()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class uT extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class FF extends uT{}async function BF(e,t,r){ch.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),ch.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async n=>{if(n){ch.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await r()}finally{ch.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}else{if(t===0)throw ch.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new FF(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(ch.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function VF(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function hT(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function UF(e){return parseInt(e,16)}function zF(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,a=>a.toString(16).padStart(2,"0")).join("")}function $F(e){var t;const{chainId:r,domain:a,expirationTime:n,issuedAt:i=new Date,nonce:o,notBefore:c,requestId:d,resources:h,scheme:p,uri:x,version:v}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!x)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(v!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${v}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const b=hT(e.address),N=p?`${p}://${a}`:a,_=e.statement?`${e.statement}
`:"",C=`${N} wants you to sign in with your Ethereum account:
${b}

${_}`;let T=`URI: ${x}
Version: ${v}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(n&&(T+=`
Expiration Time: ${n.toISOString()}`),c&&(T+=`
Not Before: ${c.toISOString()}`),d&&(T+=`
Request ID: ${d}`),h){let A=`
Resources:`;for(const k of h){if(!k||typeof k!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${k}`);A+=`
- ${k}`}T+=A}return`${C}
${T}`}class Ha extends Error{constructor({message:t,code:r,cause:a,name:n}){var i;super(t,{cause:a}),this.__isWebAuthnError=!0,this.name=(i=n??(a instanceof Error?a.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class Rx extends Ha{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function qF({error:e,options:t}){var r,a,n;const{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Ha({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Ha({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((a=i.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Ha({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Ha({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Ha({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Ha({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return i.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new Ha({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Ha({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const o=window.location.hostname;if(fT(o)){if(i.rp.id!==o)return new Ha({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Ha({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new Ha({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Ha({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Ha({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function WF({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Ha({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Ha({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const a=window.location.hostname;if(fT(a)){if(r.rpId!==a)return new Ha({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Ha({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Ha({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Ha({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class HF{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const GF=new HF;function KF(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:a}=e,n=yg(e,["challenge","user","excludeCredentials"]),i=Mh(t).buffer,o=Object.assign(Object.assign({},r),{id:Mh(r.id).buffer}),c=Object.assign(Object.assign({},n),{challenge:i,user:o});if(a&&a.length>0){c.excludeCredentials=new Array(a.length);for(let d=0;d<a.length;d++){const h=a[d];c.excludeCredentials[d]=Object.assign(Object.assign({},h),{id:Mh(h.id).buffer,type:h.type||"public-key",transports:h.transports})}}return c}function XF(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,a=yg(e,["challenge","allowCredentials"]),n=Mh(t).buffer,i=Object.assign(Object.assign({},a),{challenge:n});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const c=r[o];i.allowCredentials[o]=Object.assign(Object.assign({},c),{id:Mh(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return i}function YF(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:lu(new Uint8Array(e.response.attestationObject)),clientDataJSON:lu(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function ZF(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,a=e.getClientExtensionResults(),n=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:lu(new Uint8Array(n.authenticatorData)),clientDataJSON:lu(new Uint8Array(n.clientDataJSON)),signature:lu(new Uint8Array(n.signature)),userHandle:n.userHandle?lu(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function fT(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function Ej(){var e,t;return!!(En()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function QF(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Rx("Browser returned unexpected credential type",t)}:{data:null,error:new Rx("Empty credential response",t)}}catch(t){return{data:null,error:qF({error:t,options:e})}}}async function JF(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Rx("Browser returned unexpected credential type",t)}:{data:null,error:new Rx("Empty credential response",t)}}catch(t){return{data:null,error:WF({error:t,options:e})}}}const e7={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},t7={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Px(...e){const t=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),r=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),a={};for(const n of e)if(n)for(const i in n){const o=n[i];if(o!==void 0)if(Array.isArray(o))a[i]=o;else if(r(o))a[i]=o;else if(t(o)){const c=a[i];t(c)?a[i]=Px(c,o):a[i]=Px(o)}else a[i]=o}return a}function s7(e,t){return Px(e7,e,t||{})}function r7(e,t){return Px(t7,e,t||{})}class a7{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:a,signal:n},i){try{const{data:o,error:c}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!o)return{data:null,error:c};const d=n??GF.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:h}=o.webauthn.credential_options.publicKey;h.name||(h.name=`${h.id}:${a}`),h.displayName||(h.displayName=h.name)}switch(o.webauthn.type){case"create":{const h=s7(o.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:p,error:x}=await QF({publicKey:h,signal:d});return p?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:p}},error:null}:{data:null,error:x}}case"request":{const h=r7(o.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:p,error:x}=await JF(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:h,signal:d}));return p?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:p}},error:null}:{data:null,error:x}}}}catch(o){return bs(o)?{data:null,error:o}:{data:null,error:new nu("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:r,webauthn:a}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:a})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},i){if(!r)return{data:null,error:new lp("rpId is required for WebAuthn authentication")};try{if(!Ej())return{data:null,error:new nu("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:a},signal:n},{request:i});if(!o)return{data:null,error:c};const{webauthn:d}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:d.type,rpId:r,rpOrigins:a,credential_response:d.credential_response}})}catch(o){return bs(o)?{data:null,error:o}:{data:null,error:new nu("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},i){if(!r)return{data:null,error:new lp("rpId is required for WebAuthn registration")};try{if(!Ej())return{data:null,error:new nu("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(p=>{var x;return(x=p.data)===null||x===void 0?void 0:x.all.find(v=>v.factor_type==="webauthn"&&v.friendly_name===t&&v.status!=="unverified")}).then(p=>p?this.client.mfa.unenroll({factorId:p==null?void 0:p.id}):void 0),{data:null,error:c};const{data:d,error:h}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:a},signal:n},{create:i});return d?this._verify({factorId:o.id,challengeId:d.challengeId,webauthn:{rpId:r,rpOrigins:a,type:d.webauthn.type,credential_response:d.webauthn.credential_response}}):{data:null,error:h}}catch(o){return bs(o)?{data:null,error:o}:{data:null,error:new nu("Unexpected error in register",o)}}}}VF();const n7={url:eF,storageKey:tF,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:sF,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function Sj(e,t,r){return await r()}const dh={};class cp{get jwks(){var t,r;return(r=(t=dh[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){dh[this.storageKey]=Object.assign(Object.assign({},dh[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=dh[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){dh[this.storageKey]=Object.assign(Object.assign({},dh[this.storageKey]),{cachedAt:t})}constructor(t){var r,a,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},n7),t);if(this.storageKey=i.storageKey,this.instanceID=(r=cp.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,cp.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&En()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new LF({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=dT(i.fetch),this.lock=i.lock||Sj,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,this.lockAcquireTimeout=i.lockAcquireTimeout,i.lock?this.lock=i.lock:this.persistSession&&En()&&(!((a=globalThis==null?void 0:globalThis.navigator)===null||a===void 0)&&a.locks)?this.lock=BF:this.lock=Sj,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new a7(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:cT()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Cj(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=Cj(this.memoryStorage)),En()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${iT}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},a="none";if(En()&&(r=gF(window.location.href),this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce")),En()&&this.detectSessionInUrl&&a!=="none"){const{data:n,error:i}=await this._getSessionFromURL(r,a);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),lF(i)){const d=(t=i.details)===null||t===void 0?void 0:t.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:i}}return{error:i}}const{session:o,redirectType:c}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",c),await this._saveSession(o),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return bs(r)?this._returnResult({error:r}):this._returnResult({error:new nu("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,a,n;try{const i=await Ps(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.captchaToken}},xform:Vo}),{data:o,error:c}=i;if(c||!o)return this._returnResult({data:{user:null,session:null},error:c});const d=o.session,h=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:h,session:d},error:null})}catch(i){if(bs(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(t){var r,a,n;try{let i;if("email"in t){const{email:p,password:x,options:v}=t;let b=null,N=null;this.flowType==="pkce"&&([b,N]=await oh(this.storage,this.storageKey)),i=await Ps(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v==null?void 0:v.emailRedirectTo,body:{email:p,password:x,data:(r=v==null?void 0:v.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken},code_challenge:b,code_challenge_method:N},xform:Vo})}else if("phone"in t){const{phone:p,password:x,options:v}=t;i=await Ps(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:x,data:(a=v==null?void 0:v.data)!==null&&a!==void 0?a:{},channel:(n=v==null?void 0:v.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken}},xform:Vo})}else throw new D0("You must provide either an email or phone number and a password");const{data:o,error:c}=i;if(c||!o)return await Cn(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:c});const d=o.session,h=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:h,session:d},error:null})}catch(i){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),bs(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:o,options:c}=t;r=await Ps(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:jj})}else if("phone"in t){const{phone:i,password:o,options:c}=t;r=await Ps(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:jj})}else throw new D0("You must provide either an email or phone number and a password");const{data:a,error:n}=r;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!a||!a.session||!a.user){const i=new ih;return this._returnResult({data:{user:null,session:null},error:i})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:n})}catch(r){if(bs(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,a,n,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(n=t.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,a,n,i,o,c,d,h,p,x,v;let b,N;if("message"in t)b=t.message,N=t.signature;else{const{chain:_,wallet:C,statement:T,options:A}=t;let k;if(En())if(typeof C=="object")k=C;else{const M=window;if("ethereum"in M&&typeof M.ethereum=="object"&&"request"in M.ethereum&&typeof M.ethereum.request=="function")k=M.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof C!="object"||!(A!=null&&A.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=C}const I=new URL((r=A==null?void 0:A.url)!==null&&r!==void 0?r:window.location.href),B=await k.request({method:"eth_requestAccounts"}).then(M=>M).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!B||B.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const O=hT(B[0]);let D=(a=A==null?void 0:A.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!D){const M=await k.request({method:"eth_chainId"});D=UF(M)}const F={domain:I.host,address:O,statement:T,uri:I.href,version:"1",chainId:D,nonce:(n=A==null?void 0:A.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(o=(i=A==null?void 0:A.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(c=A==null?void 0:A.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(d=A==null?void 0:A.signInWithEthereum)===null||d===void 0?void 0:d.notBefore,requestId:(h=A==null?void 0:A.signInWithEthereum)===null||h===void 0?void 0:h.requestId,resources:(p=A==null?void 0:A.signInWithEthereum)===null||p===void 0?void 0:p.resources};b=$F(F),N=await k.request({method:"personal_sign",params:[zF(b),O]})}try{const{data:_,error:C}=await Ps(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:b,signature:N},!((x=t.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(v=t.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:Vo});if(C)throw C;if(!_||!_.session||!_.user){const T=new ih;return this._returnResult({data:{user:null,session:null},error:T})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:C})}catch(_){if(bs(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signInWithSolana(t){var r,a,n,i,o,c,d,h,p,x,v,b;let N,_;if("message"in t)N=t.message,_=t.signature;else{const{chain:C,wallet:T,statement:A,options:k}=t;let I;if(En())if(typeof T=="object")I=T;else{const O=window;if("solana"in O&&typeof O.solana=="object"&&("signIn"in O.solana&&typeof O.solana.signIn=="function"||"signMessage"in O.solana&&typeof O.solana.signMessage=="function"))I=O.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof T!="object"||!(k!=null&&k.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");I=T}const B=new URL((r=k==null?void 0:k.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in I&&I.signIn){const O=await I.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},k==null?void 0:k.signInWithSolana),{version:"1",domain:B.host,uri:B.href}),A?{statement:A}:null));let D;if(Array.isArray(O)&&O[0]&&typeof O[0]=="object")D=O[0];else if(O&&typeof O=="object"&&"signedMessage"in O&&"signature"in O)D=O;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in D&&"signature"in D&&(typeof D.signedMessage=="string"||D.signedMessage instanceof Uint8Array)&&D.signature instanceof Uint8Array)N=typeof D.signedMessage=="string"?D.signedMessage:new TextDecoder().decode(D.signedMessage),_=D.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in I)||typeof I.signMessage!="function"||!("publicKey"in I)||typeof I!="object"||!I.publicKey||!("toBase58"in I.publicKey)||typeof I.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");N=[`${B.host} wants you to sign in with your Solana account:`,I.publicKey.toBase58(),...A?["",A,""]:[""],"Version: 1",`URI: ${B.href}`,`Issued At: ${(n=(a=k==null?void 0:k.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((i=k==null?void 0:k.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${k.signInWithSolana.notBefore}`]:[],...!((o=k==null?void 0:k.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${k.signInWithSolana.expirationTime}`]:[],...!((c=k==null?void 0:k.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${k.signInWithSolana.chainId}`]:[],...!((d=k==null?void 0:k.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${k.signInWithSolana.nonce}`]:[],...!((h=k==null?void 0:k.signInWithSolana)===null||h===void 0)&&h.requestId?[`Request ID: ${k.signInWithSolana.requestId}`]:[],...!((x=(p=k==null?void 0:k.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||x===void 0)&&x.length?["Resources",...k.signInWithSolana.resources.map(D=>`- ${D}`)]:[]].join(`
`);const O=await I.signMessage(new TextEncoder().encode(N),"utf8");if(!O||!(O instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=O}}try{const{data:C,error:T}=await Ps(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:N,signature:lu(_)},!((v=t.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(b=t.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:Vo});if(T)throw T;if(!C||!C.session||!C.user){const A=new ih;return this._returnResult({data:{user:null,session:null},error:A})}return C.session&&(await this._saveSession(C.session),await this._notifyAllSubscribers("SIGNED_IN",C.session)),this._returnResult({data:Object.assign({},C),error:T})}catch(C){if(bs(C))return this._returnResult({data:{user:null,session:null},error:C});throw C}}async _exchangeCodeForSession(t){const r=await Zd(this.storage,`${this.storageKey}-code-verifier`),[a,n]=(r??"").split("/");try{if(!a&&this.flowType==="pkce")throw new cF;const{data:i,error:o}=await Ps(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:a},xform:Vo});if(await Cn(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const c=new ih;return this._returnResult({data:{user:null,session:null,redirectType:null},error:c})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:o})}catch(i){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),bs(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(t){try{const{options:r,provider:a,token:n,access_token:i,nonce:o}=t,c=await Ps(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:n,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Vo}),{data:d,error:h}=c;if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!d||!d.session||!d.user){const p=new ih;return this._returnResult({data:{user:null,session:null},error:p})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:d,error:h})}catch(r){if(bs(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,a,n,i,o;try{if("email"in t){const{email:c,options:d}=t;let h=null,p=null;this.flowType==="pkce"&&([h,p]=await oh(this.storage,this.storageKey));const{error:x}=await Ps(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},create_user:(a=d==null?void 0:d.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:h,code_challenge_method:p},redirectTo:d==null?void 0:d.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:x})}if("phone"in t){const{phone:c,options:d}=t,{data:h,error:p}=await Ps(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},create_user:(i=d==null?void 0:d.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(o=d==null?void 0:d.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:h==null?void 0:h.message_id},error:p})}throw new D0("You must provide either an email or phone number.")}catch(c){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),bs(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async verifyOtp(t){var r,a;try{let n,i;"options"in t&&(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(a=t.options)===null||a===void 0?void 0:a.captchaToken);const{data:o,error:c}=await Ps(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:Vo});if(c)throw c;if(!o)throw new Error("An error occurred on token verification.");const d=o.session,h=o.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),this._returnResult({data:{user:h,session:d},error:null})}catch(n){if(bs(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(t){var r,a,n,i,o;try{let c=null,d=null;this.flowType==="pkce"&&([c,d]=await oh(this.storage,this.storageKey));const h=await Ps(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((n=t==null?void 0:t.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:d}),headers:this.headers,xform:OF});return!((i=h.data)===null||i===void 0)&&i.url&&En()&&!(!((o=t.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(h.data.url),this._returnResult(h)}catch(c){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),bs(c))return this._returnResult({data:null,error:c});throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;if(a)throw a;if(!r)throw new Vi;const{error:n}=await Ps(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(t){if(bs(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:a,type:n,options:i}=t,{error:o}=await Ps(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in t){const{phone:a,type:n,options:i}=t,{data:o,error:c}=await Ps(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:c})}throw new D0("You must provide either an email or phone number and a type")}catch(r){if(bs(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Zd(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const a=t.expires_at?t.expires_at*1e3-Date.now()<P1:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",t.expires_at),!a){if(this.userStorage){const o=await Zd(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=D1()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};t.user=kF(t.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:n,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await Ps(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:ad}):await this._useSession(async r=>{var a,n,i;const{data:o,error:c}=r;if(c)throw c;return!(!((a=o.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Vi}:await Ps(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:ad})})}catch(r){if(bs(r))return oF(r)&&(await this._removeSession(),await Cn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async a=>{const{data:n,error:i}=a;if(i)throw i;if(!n.session)throw new Vi;const o=n.session;let c=null,d=null;this.flowType==="pkce"&&t.email!=null&&([c,d]=await oh(this.storage,this.storageKey));const{data:h,error:p}=await Ps(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:c,code_challenge_method:d}),jwt:o.access_token,xform:ad});if(p)throw p;return o.user=h.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(a){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),bs(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Vi;const r=Date.now()/1e3;let a=r,n=!0,i=null;const{payload:o}=O1(t.access_token);if(o.exp&&(a=o.exp,n=a<=r),n){const{data:c,error:d}=await this._callRefreshToken(t.refresh_token);if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c)return{data:{user:null,session:null},error:null};i=c}else{const{data:c,error:d}=await this._getUser(t.access_token);if(d)throw d;i={access_token:t.access_token,refresh_token:t.refresh_token,user:c.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(r){if(bs(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var a;if(!t){const{data:o,error:c}=r;if(c)throw c;t=(a=o.session)!==null&&a!==void 0?a:void 0}if(!(t!=null&&t.refresh_token))throw new Vi;const{data:n,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(bs(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!En())throw new M0("No browser detected.");if(t.error||t.error_description||t.error_code)throw new M0(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new xj("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new M0("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new xj("No code detected.");const{data:A,error:k}=await this._exchangeCodeForSession(t.code);if(k)throw k;const I=new URL(window.location.href);return I.searchParams.delete("code"),window.history.replaceState(window.history.state,"",I.toString()),{data:{session:A.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:n,access_token:i,refresh_token:o,expires_in:c,expires_at:d,token_type:h}=t;if(!i||!c||!o||!h)throw new M0("No session defined in URL");const p=Math.round(Date.now()/1e3),x=parseInt(c);let v=p+x;d&&(v=parseInt(d));const b=v-p;b*1e3<=wh&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${b}s, should have been closer to ${x}s`);const N=v-x;p-N>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",N,v,p):p-N<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",N,v,p);const{data:_,error:C}=await this._getUser(i);if(C)throw C;const T={provider_token:a,provider_refresh_token:n,access_token:i,expires_in:x,expires_at:v,refresh_token:o,token_type:h,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:T,redirectType:t.type},error:null})}catch(a){if(bs(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Zd(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:n,error:i}=r;if(i)return this._returnResult({error:i});const o=(a=n.session)===null||a===void 0?void 0:a.access_token;if(o){const{error:c}=await this.admin.signOut(o,t);if(c&&!(iF(c)&&(c.status===404||c.status===401||c.status===403)))return this._returnResult({error:c})}return t!=="others"&&(await this._removeSession(),await Cn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=xF(),a={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(t){return await this._useSession(async r=>{var a,n;try{const{data:{session:i},error:o}=r;if(o)throw o;await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let a=null,n=null;this.flowType==="pkce"&&([a,n]=await oh(this.storage,this.storageKey,!0));try{return await Ps(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),bs(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var t;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(bs(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:a,error:n}=await this._useSession(async i=>{var o,c,d,h,p;const{data:x,error:v}=i;if(v)throw v;const b=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(c=t.options)===null||c===void 0?void 0:c.scopes,queryParams:(d=t.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await Ps(this.fetch,"GET",b,{headers:this.headers,jwt:(p=(h=x.session)===null||h===void 0?void 0:h.access_token)!==null&&p!==void 0?p:void 0})});if(n)throw n;return En()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a==null?void 0:a.url),this._returnResult({data:{provider:t.provider,url:a==null?void 0:a.url},error:null})}catch(a){if(bs(a))return this._returnResult({data:{provider:t.provider,url:null},error:a});throw a}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var a;try{const{error:n,data:{session:i}}=r;if(n)throw n;const{options:o,provider:c,token:d,access_token:h,nonce:p}=t,x=await Ps(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=i==null?void 0:i.access_token)!==null&&a!==void 0?a:void 0,body:{provider:c,id_token:d,access_token:h,nonce:p,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Vo}),{data:v,error:b}=x;return b?this._returnResult({data:{user:null,session:null},error:b}):!v||!v.session||!v.user?this._returnResult({data:{user:null,session:null},error:new ih}):(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("USER_UPDATED",v.session)),this._returnResult({data:v,error:b}))}catch(n){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),bs(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var a,n;const{data:i,error:o}=r;if(o)throw o;return await Ps(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(n=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(bs(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await wF(async n=>(n>0&&await yF(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await Ps(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Vo})),(n,i)=>{const o=200*Math.pow(2,n);return i&&I1(i)&&Date.now()+o-a<wh})}catch(a){if(this._debug(r,"error",a),bs(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",a),En()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:t,url:a},error:null}}async _recoverAndRefresh(){var t,r;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const n=await Zd(this.storage,this.storageKey);if(n&&this.userStorage){let o=await Zd(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:n.user},await bh(this.userStorage,this.storageKey+"-user",o)),n.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:D1()}else if(n&&!n.user&&!n.user){const o=await Zd(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(n.user=o.user,await Cn(this.storage,this.storageKey+"-user"),await bh(this.storage,this.storageKey,n)):n.user=D1()}if(this._debug(a,"session from storage",n),!this._isValidSession(n)){this._debug(a,"session is not valid"),n!==null&&await this._removeSession();return}const i=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<P1;if(this._debug(a,`session has${i?"":" not"} expired with margin of ${P1}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:o}=await this._callRefreshToken(n.refresh_token);o&&(console.error(o),I1(o)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:c}=await this._getUser(n.access_token);!c&&(o!=null&&o.user)?(n.user=o.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(a,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(a,"error",n),console.error(n);return}finally{this._debug(a,"end")}}async _callRefreshToken(t){var r,a;if(!t)throw new Vi;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Tg;const{data:i,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new Vi;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const c={data:i.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(i){if(this._debug(n,"error",i),bs(i)){const o={data:null,error:i};return I1(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(t,r,a=!0){const n=`#_notifyAllSubscribers(${t})`;this._debug(n,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(t,r)}catch(d){i.push(d)}});if(await Promise.all(o),i.length>0){for(let c=0;c<i.length;c+=1)console.error(i[c]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Cn(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),a=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&r.user&&await bh(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const i=bj(n);await bh(this.storage,this.storageKey,i)}else{const n=bj(r);await bh(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Cn(this.storage,this.storageKey),await Cn(this.storage,this.storageKey+"-code-verifier"),await Cn(this.storage,this.storageKey+"-user"),this.userStorage&&await Cn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&En()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),wh);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((a.expires_at*1e3-t)/wh);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${wh}ms, refresh threshold is ${oy} ticks`),n<=oy&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof uT)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!En()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,a){const n=[`provider=${encodeURIComponent(r)}`];if(a!=null&&a.redirectTo&&n.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a!=null&&a.scopes&&n.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[i,o]=await oh(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});n.push(c.toString())}if(a!=null&&a.queryParams){const i=new URLSearchParams(a.queryParams);n.push(i.toString())}return a!=null&&a.skipBrowserRedirect&&n.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${t}?${n.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var a;const{data:n,error:i}=r;return i?this._returnResult({data:null,error:i}):await Ps(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(bs(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var a,n;const{data:i,error:o}=r;if(o)return this._returnResult({data:null,error:o});const c=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:d,error:h}=await Ps(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(a=i==null?void 0:i.session)===null||a===void 0?void 0:a.access_token});return h?this._returnResult({data:null,error:h}):(t.factorType==="totp"&&d.type==="totp"&&(!((n=d==null?void 0:d.totp)===null||n===void 0)&&n.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),this._returnResult({data:d,error:null}))})}catch(r){if(bs(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?YF(t.webauthn.credential_response):ZF(t.webauthn.credential_response)})}:{code:t.code}),{data:c,error:d}=await Ps(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token});return d?this._returnResult({data:null,error:d}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),this._returnResult({data:c,error:d}))})}catch(r){if(bs(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=await Ps(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token});if(o.error)return o;const{data:c}=o;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:KF(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:XF(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(bs(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:a}=await this._challenge({factorId:t.factorId});return a?this._returnResult({data:null,error:a}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:a}=await this.getUser();if(a)return{data:null,error:a};const n={all:[],phone:[],totp:[],webauthn:[]};for(const i of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])n.all.push(i),i.status==="verified"&&n[i.factor_type].push(i);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:a},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=O1(a.access_token);let o=null;i.aal&&(o=i.aal);let c=o;((r=(t=a.user.factors)===null||t===void 0?void 0:t.filter(p=>p.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const h=i.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:h},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:a},error:n}=r;return n?this._returnResult({data:null,error:n}):a?await Ps(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:a.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Vi})})}catch(r){if(bs(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async a=>{const{data:{session:n},error:i}=a;if(i)return this._returnResult({data:null,error:i});if(!n)return this._returnResult({data:null,error:new Vi});const o=await Ps(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&En()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(a){if(bs(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(t,r){try{return await this._useSession(async a=>{const{data:{session:n},error:i}=a;if(i)return this._returnResult({data:null,error:i});if(!n)return this._returnResult({data:null,error:new Vi});const o=await Ps(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&En()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(a){if(bs(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;return a?this._returnResult({data:null,error:a}):r?await Ps(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new Vi})})}catch(t){if(bs(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:a},error:n}=r;return n?this._returnResult({data:null,error:n}):a?(await Ps(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Vi})})}catch(r){if(bs(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let a=r.keys.find(c=>c.kid===t);if(a)return a;const n=Date.now();if(a=this.jwks.keys.find(c=>c.kid===t),a&&this.jwks_cached_at+aF>n)return a;const{data:i,error:o}=await Ps(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=n,a=i.keys.find(c=>c.kid===t),!a)?null:a}async getClaims(t,r={}){try{let a=t;if(!a){const{data:b,error:N}=await this.getSession();if(N||!b.session)return this._returnResult({data:null,error:N});a=b.session.access_token}const{header:n,payload:i,signature:o,raw:{header:c,payload:d}}=O1(a);r!=null&&r.allowExpired||SF(i.exp);const h=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!h){const{error:b}=await this.getUser(a);if(b)throw b;return{data:{claims:i,header:n,signature:o},error:null}}const p=TF(n.alg),x=await crypto.subtle.importKey("jwk",h,p,!0,["verify"]);if(!await crypto.subtle.verify(p,x,o,mF(`${c}.${d}`)))throw new dy("Invalid JWT signature");return{data:{claims:i,header:n,signature:o},error:null}}catch(a){if(bs(a))return this._returnResult({data:null,error:a});throw a}}}cp.nextInstanceID={};const i7=cp,o7="2.90.1";let Sm="";typeof Deno<"u"?Sm="deno":typeof document<"u"?Sm="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Sm="react-native":Sm="node";const l7={"X-Client-Info":`supabase-js-${Sm}/${o7}`},c7={headers:l7},d7={schema:"public"},u7={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},h7={};function dp(e){"@babel/helpers - typeof";return dp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dp(e)}function f7(e,t){if(dp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t||"default");if(dp(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function m7(e){var t=f7(e,"string");return dp(t)=="symbol"?t:t+""}function p7(e,t,r){return(t=m7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Ra(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Tj(Object(r),!0).forEach(function(a){p7(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tj(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}const x7=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),g7=()=>Headers,v7=(e,t,r)=>{const a=x7(r),n=g7();return async(i,o)=>{var c;const d=(c=await t())!==null&&c!==void 0?c:e;let h=new n(o==null?void 0:o.headers);return h.has("apikey")||h.set("apikey",e),h.has("Authorization")||h.set("Authorization",`Bearer ${d}`),a(i,Ra(Ra({},o),{},{headers:h}))}};function y7(e){return e.endsWith("/")?e:e+"/"}function w7(e,t){var r,a;const{db:n,auth:i,realtime:o,global:c}=e,{db:d,auth:h,realtime:p,global:x}=t,v={db:Ra(Ra({},d),n),auth:Ra(Ra({},h),i),realtime:Ra(Ra({},p),o),storage:{},global:Ra(Ra(Ra({},x),c),{},{headers:Ra(Ra({},(r=x==null?void 0:x.headers)!==null&&r!==void 0?r:{}),(a=c==null?void 0:c.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return e.accessToken?v.accessToken=e.accessToken:delete v.accessToken,v}function b7(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(y7(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var _7=class extends i7{constructor(e){super(e)}},j7=class{constructor(e,t,r){var a,n;this.supabaseUrl=e,this.supabaseKey=t;const i=b7(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const o=`sb-${i.hostname.split(".")[0]}-auth-token`,c={db:d7,realtime:h7,auth:Ra(Ra({},u7),{},{storageKey:o}),global:c7},d=w7(r??{},c);if(this.storageKey=(a=d.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(n=d.global.headers)!==null&&n!==void 0?n:{},d.accessToken)this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(p,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}});else{var h;this.auth=this._initSupabaseAuthClient((h=d.auth)!==null&&h!==void 0?h:{},this.headers,d.global.fetch)}this.fetch=v7(t,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Ra({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.accessToken&&this.accessToken().then(p=>this.realtime.setAuth(p)).catch(p=>console.warn("Failed to set initial Realtime auth token:",p)),this.rest=new sL(new URL("rest/v1",i).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new JL(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new ZM(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:a}=await e.auth.getSession();return(t=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:n,storageKey:i,flowType:o,lock:c,debug:d,throwOnError:h},p,x){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new _7({url:this.authUrl.href,headers:Ra(Ra({},v),p),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:n,flowType:o,lock:c,debug:d,throwOnError:h,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(b=>b.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new yL(this.realtimeUrl.href,Ra(Ra({},e),{},{params:Ra(Ra({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const N7=(e,t,r)=>new j7(e,t,r);function C7(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}C7()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const E7="https://yfoqehkemzxbwzrbfubq.supabase.co",S7="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inlmb3FlaGtlbXp4Ynd6cmJmdWJxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY1ODM1MzgsImV4cCI6MjA4MjE1OTUzOH0.oxSWr4UN-8ruOpsih5gYqU3qtoaNY6HI02-HFc3Rk-I",J=N7(E7,S7,{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0}}),T7=Object.freeze(Object.defineProperty({__proto__:null,supabase:J},Symbol.toStringTag,{value:"Module"})),mT=E.createContext(void 0);function A7({children:e}){const[t,r]=E.useState(null),[a,n]=E.useState(null),[i,o]=E.useState(null),[c,d]=E.useState(null),[h,p]=E.useState(!0),x=ds(),v=async C=>{const{data:T,error:A}=await J.from("user_roles").select("role").eq("user_id",C);if(A)return console.error("Erro ao buscar role do usurio",A),null;if(!T||T.length===0)return null;if(T.length===1)return T[0].role;const k=["admin","investidor","cooperativa","empresa","vendedor","usuario"];for(const I of k)if(T.some(B=>B.role===I))return I;return T[0].role},b=async C=>{const{data:T,error:A}=await J.from("profiles").select("*").eq("id",C).maybeSingle();return A?(console.error("Erro ao buscar perfil do usurio",A),null):T},N=async()=>{if(t){const C=await b(t.id);d(C)}};E.useEffect(()=>{let C=!1,T=null;const{data:{subscription:A}}=J.auth.onAuthStateChange((k,I)=>{var F;if(["TOKEN_REFRESHED","INITIAL_SESSION"].includes(k))return;const O=k==="SIGNED_IN"||k==="SIGNED_OUT"||k==="USER_UPDATED",D=((F=I==null?void 0:I.user)==null?void 0:F.id)!==T;if(n(I),r((I==null?void 0:I.user)??null),I!=null&&I.user){if(O||D||!C){const z=!C;C=!0,T=I.user.id,z&&p(!0),setTimeout(async()=>{try{const[q,Y]=await Promise.all([v(I.user.id),b(I.user.id)]);o(q),d(Y)}catch(q){console.error("Erro ao carregar dados de autenticao (onAuthStateChange)",q)}finally{p(!1)}},0)}}else C=!1,T=null,o(null),d(null),p(!1)});return J.auth.getSession().then(async({data:{session:k}})=>{if(n(k),r((k==null?void 0:k.user)??null),k!=null&&k.user)try{const[I,B]=await Promise.all([v(k.user.id),b(k.user.id)]);o(I),d(B)}catch(I){console.error("Erro ao carregar dados de autenticao (getSession)",I)}finally{p(!1)}else p(!1)}),()=>A.unsubscribe()},[]);const _=async()=>{try{const{data:{session:C}}=await J.auth.getSession();if(r(null),n(null),o(null),d(null),C)try{const{error:k}=await J.auth.signOut({scope:"local"});k&&console.warn(" [LOGOUT] Aviso ao fazer logout no servidor:",k.message)}catch(k){console.warn(" [LOGOUT] Aviso ao fazer logout no servidor:",k)}const T=Object.keys(localStorage).filter(k=>k.startsWith("tour_completed_")),A={};T.forEach(k=>{A[k]=localStorage.getItem(k)||""}),localStorage.clear(),sessionStorage.clear(),Object.entries(A).forEach(([k,I])=>{localStorage.setItem(k,I)}),x("/auth",{replace:!0})}catch(C){console.error(" [LOGOUT] Erro ao processar logout:",C),r(null),n(null),o(null),d(null);const T=Object.keys(localStorage).filter(k=>k.startsWith("tour_completed_")),A={};T.forEach(k=>{A[k]=localStorage.getItem(k)||""}),localStorage.clear(),sessionStorage.clear(),Object.entries(A).forEach(([k,I])=>{localStorage.setItem(k,I)}),x("/auth",{replace:!0})}};return s.jsx(mT.Provider,{value:{user:t,session:a,userRole:i,profile:c,loading:h,signOut:_,refreshProfile:N},children:e})}function sr(){const e=E.useContext(mT);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}const pT=E.createContext(void 0);function k7({children:e}){const{user:t}=sr(),[r,a]=E.useState([]),[n,i]=E.useState(null),[o,c]=E.useState(!0),d=r.filter(A=>!A.read).length,h=E.useCallback(async()=>{if(!t){a([]),c(!1);return}try{const{data:A,error:k}=await J.from("notifications").select("*").eq("user_id",t.id).order("created_at",{ascending:!1}).limit(50);if(k)throw k;a(A||[])}catch(A){console.error("Erro ao buscar notificaes:",A)}finally{c(!1)}},[t]),p=E.useCallback(async()=>{if(!t){i(null);return}try{const{data:A,error:k}=await J.from("notification_preferences").select("*").eq("user_id",t.id).maybeSingle();if(k&&k.code!=="PGRST116")throw k;if(A)i(A);else{const{data:I,error:B}=await J.from("notification_preferences").insert({user_id:t.id}).select().single();if(B)throw B;i(I)}}catch(A){console.error("Erro ao buscar preferncias:",A)}},[t]),x=E.useCallback(async A=>{try{const{error:k}=await J.rpc("mark_notification_as_read",{notification_id:A});if(k)throw k;a(I=>I.map(B=>B.id===A?{...B,read:!0,read_at:new Date().toISOString()}:B))}catch(k){console.error("Erro ao marcar notificao como lida:",k)}},[]),v=E.useCallback(async()=>{if(t)try{const{error:A}=await J.rpc("mark_all_notifications_as_read",{target_user_id:t.id});if(A)throw A;const k=new Date().toISOString();a(I=>I.map(B=>({...B,read:!0,read_at:k})))}catch(A){console.error("Erro ao marcar todas como lidas:",A)}},[t]),b=E.useCallback(async A=>{try{const{error:k}=await J.from("notifications").delete().eq("id",A);if(k)throw k;a(I=>I.filter(B=>B.id!==A))}catch(k){console.error("Erro ao deletar notificao:",k)}},[]),N=E.useCallback(async A=>{if(t)try{const{data:k,error:I}=await J.from("notification_preferences").update(A).eq("user_id",t.id).select().single();if(I)throw I;i(k)}catch(k){console.error("Erro ao atualizar preferncias:",k)}},[t]),_=E.useCallback(async()=>{if(!("Notification"in window))return console.warn("Este navegador no suporta notificaes"),!1;if(!("serviceWorker"in navigator))return console.warn("Este navegador no suporta Service Workers"),!1;try{if(await Notification.requestPermission()==="granted"){const k=await navigator.serviceWorker.ready;return await N({enable_push:!0}),!0}return!1}catch(A){return console.error("Erro ao solicitar permisso de push:",A),!1}},[N]),C=E.useCallback(async()=>{await h()},[h]);E.useEffect(()=>{if(!t)return;h(),p();const A=J.channel("notifications_changes").on("postgres_changes",{event:"*",schema:"public",table:"notifications",filter:`user_id=eq.${t.id}`},k=>{if(k.eventType==="INSERT"){if(a(I=>[k.new,...I]),n!=null&&n.enable_push&&"Notification"in window&&Notification.permission==="granted"){const I=k.new;new Notification(I.title,{body:I.message,icon:"/icon-192-white.png",badge:"/icon-192-white.png",tag:I.id})}}else k.eventType==="UPDATE"?a(I=>I.map(B=>B.id===k.new.id?k.new:B)):k.eventType==="DELETE"&&a(I=>I.filter(B=>B.id!==k.old.id))}).subscribe();return()=>{J.removeChannel(A)}},[t==null?void 0:t.id]);const T={notifications:r,unreadCount:d,loading:o,preferences:n,markAsRead:x,markAllAsRead:v,deleteNotification:b,updatePreferences:N,requestPushPermission:_,refreshNotifications:C};return s.jsx(pT.Provider,{value:T,children:e})}function R7(){const e=E.useContext(pT);if(e===void 0)throw new Error("useNotifications deve ser usado dentro de NotificationProvider");return e}const P7={termos_uso:"Termos de Uso",politica_privacidade:"Poltica de Privacidade",contrato_cooperado:"Contrato de Cooperado",contrato_investidor:"Contrato de Investidor",termo_lgpd:"Termo LGPD",outros:"Outros"},L1={TAMANHO_MAX_PDF_MB:10,TAMANHO_MAX_PDF_BYTES:10*1024*1024,FORMATO_VERSAO_REGEX:/^[0-9]+\.[0-9]+$/,PDF_NAME_PATTERN:/^[a-zA-Z0-9_-]+\.pdf$/,MIN_LENGTH_TITULO:5,MAX_LENGTH_TITULO:255,MIN_LENGTH_VERSAO:1,MAX_LENGTH_VERSAO:20};async function I7(e){try{const{data:t,error:r}=await J.rpc("buscar_termos_pendentes",{p_user_id:e});if(r)throw console.error("Erro ao buscar termos pendentes:",r),new Error("No foi possvel carregar os termos pendentes");const a=(t||[]).map(n=>({id:n.id,tipo:n.tipo,tipoLabel:P7[n.tipo],versao:n.versao,titulo:n.titulo,pdf_url:n.pdf_url,conteudo_html:n.conteudo_html,resumo:n.resumo,obrigatorio:n.obrigatorio,aceito:!1}));return{termos:a,total:a.length,todos_aceitos:a.length===0}}catch(t){throw console.error("Erro em buscarTermosPendentes:",t),t}}async function xT(e){try{const{data:t,error:r}=await J.rpc("tem_termos_pendentes",{p_user_id:e});return r?(console.error(" Erro ao verificar termos pendentes:",r),!1):t===!0}catch(t){return console.error(" Erro ao verificar termos pendentes:",t),!1}}async function O7(){try{const e=await fetch("https://api.ipify.org?format=json",{signal:AbortSignal.timeout(2e3)});if(e.ok)return(await e.json()).ip||null}catch(e){console.warn("No foi possvel capturar IP:",e)}return null}function D7(){return navigator.userAgent||null}async function gT(e,t){try{if(!e||t.length===0)throw new Error("userId e termosIds so obrigatrios");const r=await O7(),a=D7(),{data:n,error:i}=await J.from("termos_uso").select("id, tipo, versao").in("id",t);if(i)throw console.error("Erro ao buscar dados dos termos:",i),new Error("No foi possvel buscar informaes dos termos");if(!n||n.length===0)throw new Error("Nenhum termo vlido encontrado");const o=n.map(d=>({user_id:e,termo_id:d.id,tipo_termo:d.tipo,versao_aceita:d.versao,ip_aceite:r,user_agent:a})),{error:c}=await J.from("aceites_termos").insert(o);if(c)throw console.error("Erro ao registrar aceites:",c),c.code==="23505"?new Error("Um ou mais termos j foram aceitos anteriormente"):new Error("No foi possvel registrar os aceites");console.log(` ${o.length} aceite(s) registrado(s) com sucesso`)}catch(r){throw console.error("Erro em registrarAceites:",r),r}}async function M7(e,t){return gT(e,[t])}async function L7(e,t=1,r=50){try{const{data:{user:a}}=await J.auth.getUser();if(!a)throw new Error("Usurio no autenticado");const{data:n,error:i}=await J.from("user_roles").select("role").eq("user_id",a.id).single();if(i||n.role!=="admin")throw new Error("Apenas administradores podem visualizar aceites de termos");const o=(t-1)*r,{data:c,error:d,count:h}=await J.from("aceites_termos").select("*",{count:"exact"}).eq("termo_id",e).order("aceito_em",{ascending:!1}).range(o,o+r-1);if(d)throw console.error("Erro ao buscar aceites do termo:",d),new Error("No foi possvel carregar os aceites");if(!c||c.length===0)return{aceites:[],total:h||0,pagina:t,totalPaginas:0};const p=c.map(_=>_.user_id),{data:x,error:v}=await J.from("profiles").select("id, nome, email").in("id",p);v&&console.error("Erro ao buscar profiles:",v);const b=new Map((x||[]).map(_=>[_.id,_]));return{aceites:c.map(_=>({..._,profiles:b.get(_.user_id)||null})),total:h||0,pagina:t,totalPaginas:Math.ceil((h||0)/r)}}catch(a){throw console.error("Erro em buscarAceitesTermo:",a),a}}async function F7(e){try{const{data:{user:t}}=await J.auth.getUser();if(!t)throw new Error("Usurio no autenticado");const{data:r,error:a}=await J.from("user_roles").select("role").eq("user_id",t.id).single();if(a||r.role!=="admin")throw new Error("Apenas administradores podem visualizar estatsticas");const{data:n,error:i}=await J.rpc("estatisticas_aceites_termo",{p_termo_id:e});if(i)throw console.error("Erro ao buscar estatsticas:",i),new Error("No foi possvel carregar as estatsticas");const o=n&&n.length>0?n[0]:null;return o?{total_usuarios:o.total_usuarios||0,total_aceites:o.total_aceites||0,percentual_aceites:o.percentual_aceites||0,pendentes:o.pendentes||0}:{total_usuarios:0,total_aceites:0,percentual_aceites:0,pendentes:0}}catch(t){throw console.error("Erro em buscarEstatisticasAceites:",t),t}}function B7(e=!0,t=null){const{user:r}=sr(),[a,n]=E.useState([]),[i,o]=E.useState(0),[c,d]=E.useState(!0),[h,p]=E.useState(e),[x,v]=E.useState(null),b=E.useCallback(async()=>{if(!(r!=null&&r.id)){n([]),o(0),d(!0),p(!1);return}try{p(!0),v(null);const _=await I7(r.id);n(_.termos),o(_.total),d(_.todos_aceitos)}catch(_){const C=_ instanceof Error?_.message:"Erro ao verificar termos pendentes";v(C),console.error("Erro em useTermosPendentes:",_),n([]),o(0),d(!0)}finally{p(!1)}},[r==null?void 0:r.id]),N=E.useCallback(async()=>{if(!(r!=null&&r.id))return!1;try{return await xT(r.id)}catch(_){return console.error("Erro em verificao rpida:",_),!1}},[r==null?void 0:r.id]);return E.useEffect(()=>{e&&b()},[e]),E.useEffect(()=>{if(!t||t<=0)return;const _=setInterval(()=>{document.hidden||b()},t);return()=>{clearInterval(_)}},[t]),{termosPendentes:a,totalPendentes:i,todosAceitos:c,loading:h,error:x,verificar:b,verificarRapido:N}}function V7(e=!0){const{user:t}=sr(),[r,a]=E.useState(!1),[n,i]=E.useState(e),o=E.useCallback(async()=>{if(!(t!=null&&t.id)){a(!1),i(!1);return}try{i(!0);const c=await xT(t.id);a(c)}catch(c){console.error(" Erro ao verificar termos pendentes:",c),a(!1)}finally{i(!1)}},[t==null?void 0:t.id]);return E.useEffect(()=>{e&&o()},[e,t==null?void 0:t.id]),{temPendentes:r,loading:n,verificar:o}}function ks({children:e,allowedRoles:t,skipTermosCheck:r=!1}){const{user:a,userRole:n,loading:i}=sr(),o=jg(),{temPendentes:c,loading:d}=V7(!0);if(i&&!a)return s.jsx("div",{className:"flex min-h-screen items-center justify-center",children:s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx(_s,{className:"h-8 w-8 animate-spin text-primary mx-auto"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Verificando autenticao..."})]})});if(!a)return s.jsx(ic,{to:"/auth",replace:!0});if(t&&n&&!t.includes(n))return s.jsx(ic,{to:"/",replace:!0});const h=n==="admin",p=o.pathname==="/termos-pendentes";if(!r&&!h&&!p){if(d)return s.jsx("div",{className:"flex min-h-screen items-center justify-center",children:s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx(_s,{className:"h-8 w-8 animate-spin text-primary mx-auto"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Verificando termos de uso..."})]})});if(c)return s.jsx(ic,{to:"/termos-pendentes",replace:!0})}return s.jsx(s.Fragment,{children:e})}const up=Pf("inline-flex items-center justify-center gap-2 whitespace-nowrap font-display font-semibold transition-all duration-300 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 active:scale-[0.98] [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:brightness-105 shadow-sm hover:shadow-[0_0_24px_hsl(76_72%_44%_/_0.35)]",accent:"bg-accent text-accent-foreground hover:brightness-105 shadow-sm hover:shadow-[0_0_24px_hsl(43_97%_54%_/_0.35)]",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm",outline:"border-2 border-primary bg-transparent text-primary hover:bg-primary/10","outline-accent":"border-2 border-accent bg-transparent text-accent hover:bg-accent/10",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-muted text-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-11 px-6 py-2 rounded-xl text-sm",sm:"h-9 px-4 py-1.5 rounded-lg text-sm",lg:"h-12 px-8 py-3 rounded-xl text-base",xl:"h-14 px-10 py-4 rounded-2xl text-lg",icon:"h-10 w-10 rounded-xl","icon-sm":"h-8 w-8 rounded-lg","icon-lg":"h-12 w-12 rounded-xl"}},defaultVariants:{variant:"default",size:"default"}}),oe=E.forwardRef(({className:e,variant:t,size:r,asChild:a=!1,...n},i)=>{const o=a?z8:"button";return s.jsx(o,{className:pt(up({variant:t,size:r,className:e})),ref:i,...n})});oe.displayName="Button";const Ne=E.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:pt("rounded-2xl border border-border/60 bg-card text-card-foreground shadow-sm transition-all duration-300","hover:shadow-md hover:-translate-y-0.5",e),...t}));Ne.displayName="Card";const Ye=E.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:pt("flex flex-col space-y-2 p-6",e),...t}));Ye.displayName="CardHeader";const Qe=E.forwardRef(({className:e,...t},r)=>s.jsx("h3",{ref:r,className:pt("font-display text-xl font-semibold leading-tight tracking-tight text-foreground",e),...t}));Qe.displayName="CardTitle";const Tt=E.forwardRef(({className:e,...t},r)=>s.jsx("p",{ref:r,className:pt("text-sm text-muted-foreground font-body",e),...t}));Tt.displayName="CardDescription";const De=E.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:pt("p-6 pt-0",e),...t}));De.displayName="CardContent";const U7=E.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:pt("flex items-center p-6 pt-0",e),...t}));U7.displayName="CardFooter";const z7=()=>{const[e,t]=E.useState(null),[r,a]=E.useState(!1),[n,i]=E.useState(!1);E.useEffect(()=>{if(window.matchMedia("(display-mode: standalone)").matches){i(!0);return}"serviceWorker"in navigator&&navigator.serviceWorker.register("/Ciclik_validacoes/service-worker.js").then(p=>{}).catch(p=>{});const d=h=>{h.preventDefault(),t(h),a(!0)};return window.addEventListener("beforeinstallprompt",d),window.addEventListener("appinstalled",()=>{i(!0),a(!1),t(null)}),()=>{window.removeEventListener("beforeinstallprompt",d)}},[]);const o=async()=>{if(!e)return;e.prompt();const{outcome:d}=await e.userChoice;t(null),a(!1),d==="accepted"&&i(!0)},c=()=>{a(!1),localStorage.setItem("pwa-install-dismissed","true")};return E.useEffect(()=>{localStorage.getItem("pwa-install-dismissed")==="true"&&a(!1)},[]),n||!r?null:s.jsx("div",{className:"fixed bottom-4 right-4 z-50 max-w-sm animate-in slide-in-from-bottom-5",children:s.jsxs(Ne,{className:"shadow-lg border-2 border-primary/20",children:[s.jsxs(Ye,{className:"pb-3",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ua,{className:"h-5 w-5 text-primary"}),s.jsx(Qe,{className:"text-lg",children:"Instalar Aplicativo"})]}),s.jsx(oe,{variant:"ghost",size:"icon",className:"h-6 w-6 -mt-1 -mr-2",onClick:c,children:s.jsx(Jr,{className:"h-4 w-4"})})]}),s.jsx(Tt,{children:"Instale o Ciclik em seu dispositivo para acesso rpido e fcil"})]}),s.jsxs(De,{className:"flex gap-2",children:[s.jsxs(oe,{onClick:o,className:"flex-1",children:[s.jsx(Ua,{className:"h-4 w-4 mr-2"}),"Instalar"]}),s.jsx(oe,{variant:"outline",onClick:c,children:"Agora no"})]})]})})},We=E.forwardRef(({className:e,type:t,...r},a)=>s.jsx("input",{type:t,className:pt("flex h-11 w-full rounded-xl border border-input bg-background px-4 py-2","font-body text-base text-foreground","placeholder:text-muted-foreground","transition-all duration-200","focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary","disabled:cursor-not-allowed disabled:opacity-50","file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground","md:text-sm",e),ref:a,...r}));We.displayName="Input";var $7="Label",vT=E.forwardRef((e,t)=>s.jsx(ys.label,{...e,ref:t,onMouseDown:r=>{var n;r.target.closest("button, input, select, textarea")||((n=e.onMouseDown)==null||n.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));vT.displayName=$7;var yT=vT;const q7=Pf("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ke=E.forwardRef(({className:e,...t},r)=>s.jsx(yT,{ref:r,className:pt(q7(),e),...t}));ke.displayName=yT.displayName;var Ag="Tabs",[W7,Vue]=bi(Ag,[wg]),wT=wg(),[H7,Jw]=W7(Ag),bT=E.forwardRef((e,t)=>{const{__scopeTabs:r,value:a,onValueChange:n,defaultValue:i,orientation:o="horizontal",dir:c,activationMode:d="automatic",...h}=e,p=Af(c),[x,v]=No({prop:a,onChange:n,defaultProp:i??"",caller:Ag});return s.jsx(H7,{scope:r,baseId:Ai(),value:x,onValueChange:v,orientation:o,dir:p,activationMode:d,children:s.jsx(ys.div,{dir:p,"data-orientation":o,...h,ref:t})})});bT.displayName=Ag;var _T="TabsList",jT=E.forwardRef((e,t)=>{const{__scopeTabs:r,loop:a=!0,...n}=e,i=Jw(_T,r),o=wT(r);return s.jsx(qS,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:a,children:s.jsx(ys.div,{role:"tablist","aria-orientation":i.orientation,...n,ref:t})})});jT.displayName=_T;var NT="TabsTrigger",CT=E.forwardRef((e,t)=>{const{__scopeTabs:r,value:a,disabled:n=!1,...i}=e,o=Jw(NT,r),c=wT(r),d=TT(o.baseId,a),h=AT(o.baseId,a),p=a===o.value;return s.jsx(WS,{asChild:!0,...c,focusable:!n,active:p,children:s.jsx(ys.button,{type:"button",role:"tab","aria-selected":p,"aria-controls":h,"data-state":p?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:d,...i,ref:t,onMouseDown:Ts(e.onMouseDown,x=>{!n&&x.button===0&&x.ctrlKey===!1?o.onValueChange(a):x.preventDefault()}),onKeyDown:Ts(e.onKeyDown,x=>{[" ","Enter"].includes(x.key)&&o.onValueChange(a)}),onFocus:Ts(e.onFocus,()=>{const x=o.activationMode!=="manual";!p&&!n&&x&&o.onValueChange(a)})})})});CT.displayName=NT;var ET="TabsContent",ST=E.forwardRef((e,t)=>{const{__scopeTabs:r,value:a,forceMount:n,children:i,...o}=e,c=Jw(ET,r),d=TT(c.baseId,a),h=AT(c.baseId,a),p=a===c.value,x=E.useRef(p);return E.useEffect(()=>{const v=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(v)},[]),s.jsx(il,{present:n||p,children:({present:v})=>s.jsx(ys.div,{"data-state":p?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":d,hidden:!v,id:h,tabIndex:0,...o,ref:t,style:{...e.style,animationDuration:x.current?"0s":void 0},children:v&&i})})});ST.displayName=ET;function TT(e,t){return`${e}-trigger-${t}`}function AT(e,t){return`${e}-content-${t}`}var G7=bT,kT=jT,RT=CT,PT=ST;const Mn=G7,Nn=E.forwardRef(({className:e,...t},r)=>s.jsx(kT,{ref:r,className:pt("inline-flex h-11 items-center justify-center rounded-xl bg-muted p-1 text-muted-foreground",e),...t}));Nn.displayName=kT.displayName;const Gs=E.forwardRef(({className:e,...t},r)=>s.jsx(RT,{ref:r,className:pt("relative inline-flex items-center justify-center whitespace-nowrap rounded-lg px-4 py-2","font-display text-sm font-medium","ring-offset-background transition-all duration-200","text-muted-foreground hover:text-foreground/80","data-[state=active]:bg-primary/10 data-[state=active]:text-primary data-[state=active]:font-semibold data-[state=active]:shadow-sm","data-[state=active]:after:absolute data-[state=active]:after:bottom-0 data-[state=active]:after:left-1/2 data-[state=active]:after:-translate-x-1/2","data-[state=active]:after:w-2/3 data-[state=active]:after:h-0.5 data-[state=active]:after:bg-primary data-[state=active]:after:rounded-full","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","disabled:pointer-events-none disabled:opacity-50",e),...t}));Gs.displayName=RT.displayName;const hr=E.forwardRef(({className:e,...t},r)=>s.jsx(PT,{ref:r,className:pt("mt-4 ring-offset-background","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));hr.displayName=PT.displayName;function hp(e,[t,r]){return Math.min(r,Math.max(t,e))}function Gp(e){const t=E.useRef({value:e,previous:e});return E.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var K7=[" ","Enter","ArrowUp","ArrowDown"],X7=[" ","Enter"],ku="Select",[kg,Rg,Y7]=Rw(ku),[Lf,Uue]=bi(ku,[Y7,Tf]),Pg=Tf(),[Z7,Ld]=Lf(ku),[Q7,J7]=Lf(ku),IT=e=>{const{__scopeSelect:t,children:r,open:a,defaultOpen:n,onOpenChange:i,value:o,defaultValue:c,onValueChange:d,dir:h,name:p,autoComplete:x,disabled:v,required:b,form:N}=e,_=Pg(t),[C,T]=E.useState(null),[A,k]=E.useState(null),[I,B]=E.useState(!1),O=Af(h),[D,F]=No({prop:a,defaultProp:n??!1,onChange:i,caller:ku}),[M,z]=No({prop:o,defaultProp:c,onChange:d,caller:ku}),q=E.useRef(null),Y=C?N||!!C.closest("form"):!0,[ae,je]=E.useState(new Set),H=Array.from(ae).map(Z=>Z.props.value).join(";");return s.jsx(kw,{..._,children:s.jsxs(Z7,{required:b,scope:t,trigger:C,onTriggerChange:T,valueNode:A,onValueNodeChange:k,valueNodeHasChildren:I,onValueNodeHasChildrenChange:B,contentId:Ai(),value:M,onValueChange:z,open:D,onOpenChange:F,dir:O,triggerPointerDownPosRef:q,disabled:v,children:[s.jsx(kg.Provider,{scope:t,children:s.jsx(Q7,{scope:e.__scopeSelect,onNativeOptionAdd:E.useCallback(Z=>{je(G=>new Set(G).add(Z))},[]),onNativeOptionRemove:E.useCallback(Z=>{je(G=>{const Q=new Set(G);return Q.delete(Z),Q})},[]),children:r})}),Y?s.jsxs(rA,{"aria-hidden":!0,required:b,tabIndex:-1,name:p,autoComplete:x,value:M,onChange:Z=>z(Z.target.value),disabled:v,form:N,children:[M===void 0?s.jsx("option",{value:""}):null,Array.from(ae)]},H):null]})})};IT.displayName=ku;var OT="SelectTrigger",DT=E.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:a=!1,...n}=e,i=Pg(r),o=Ld(OT,r),c=o.disabled||a,d=br(t,o.onTriggerChange),h=Rg(r),p=E.useRef("touch"),[x,v,b]=nA(_=>{const C=h().filter(k=>!k.disabled),T=C.find(k=>k.value===o.value),A=iA(C,_,T);A!==void 0&&o.onValueChange(A.value)}),N=_=>{c||(o.onOpenChange(!0),b()),_&&(o.triggerPointerDownPosRef.current={x:Math.round(_.pageX),y:Math.round(_.pageY)})};return s.jsx(vg,{asChild:!0,...i,children:s.jsx(ys.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:c,"data-disabled":c?"":void 0,"data-placeholder":aA(o.value)?"":void 0,...n,ref:d,onClick:Ts(n.onClick,_=>{_.currentTarget.focus(),p.current!=="mouse"&&N(_)}),onPointerDown:Ts(n.onPointerDown,_=>{p.current=_.pointerType;const C=_.target;C.hasPointerCapture(_.pointerId)&&C.releasePointerCapture(_.pointerId),_.button===0&&_.ctrlKey===!1&&_.pointerType==="mouse"&&(N(_),_.preventDefault())}),onKeyDown:Ts(n.onKeyDown,_=>{const C=x.current!=="";!(_.ctrlKey||_.altKey||_.metaKey)&&_.key.length===1&&v(_.key),!(C&&_.key===" ")&&K7.includes(_.key)&&(N(),_.preventDefault())})})})});DT.displayName=OT;var MT="SelectValue",LT=E.forwardRef((e,t)=>{const{__scopeSelect:r,className:a,style:n,children:i,placeholder:o="",...c}=e,d=Ld(MT,r),{onValueNodeHasChildrenChange:h}=d,p=i!==void 0,x=br(t,d.onValueNodeChange);return Ji(()=>{h(p)},[h,p]),s.jsx(ys.span,{...c,ref:x,style:{pointerEvents:"none"},children:aA(d.value)?s.jsx(s.Fragment,{children:o}):i})});LT.displayName=MT;var e9="SelectIcon",FT=E.forwardRef((e,t)=>{const{__scopeSelect:r,children:a,...n}=e;return s.jsx(ys.span,{"aria-hidden":!0,...n,ref:t,children:a||""})});FT.displayName=e9;var t9="SelectPortal",BT=e=>s.jsx(YS,{asChild:!0,...e});BT.displayName=t9;var Ru="SelectContent",VT=E.forwardRef((e,t)=>{const r=Ld(Ru,e.__scopeSelect),[a,n]=E.useState();if(Ji(()=>{n(new DocumentFragment)},[]),!r.open){const i=a;return i?_u.createPortal(s.jsx(UT,{scope:e.__scopeSelect,children:s.jsx(kg.Slot,{scope:e.__scopeSelect,children:s.jsx("div",{children:e.children})})}),i):null}return s.jsx(zT,{...e,ref:t})});VT.displayName=Ru;var Uo=10,[UT,Fd]=Lf(Ru),s9="SelectContentImpl",r9=ZS("SelectContent.RemoveScroll"),zT=E.forwardRef((e,t)=>{const{__scopeSelect:r,position:a="item-aligned",onCloseAutoFocus:n,onEscapeKeyDown:i,onPointerDownOutside:o,side:c,sideOffset:d,align:h,alignOffset:p,arrowPadding:x,collisionBoundary:v,collisionPadding:b,sticky:N,hideWhenDetached:_,avoidCollisions:C,...T}=e,A=Ld(Ru,r),[k,I]=E.useState(null),[B,O]=E.useState(null),D=br(t,Ce=>I(Ce)),[F,M]=E.useState(null),[z,q]=E.useState(null),Y=Rg(r),[ae,je]=E.useState(!1),H=E.useRef(!1);E.useEffect(()=>{if(k)return HS(k)},[k]),GS();const Z=E.useCallback(Ce=>{const[me,...fe]=Y().map(Me=>Me.ref.current),[ve]=fe.slice(-1),ne=document.activeElement;for(const Me of Ce)if(Me===ne||(Me==null||Me.scrollIntoView({block:"nearest"}),Me===me&&B&&(B.scrollTop=0),Me===ve&&B&&(B.scrollTop=B.scrollHeight),Me==null||Me.focus(),document.activeElement!==ne))return},[Y,B]),G=E.useCallback(()=>Z([F,k]),[Z,F,k]);E.useEffect(()=>{ae&&G()},[ae,G]);const{onOpenChange:Q,triggerPointerDownPosRef:re}=A;E.useEffect(()=>{if(k){let Ce={x:0,y:0};const me=ve=>{var ne,Me;Ce={x:Math.abs(Math.round(ve.pageX)-(((ne=re.current)==null?void 0:ne.x)??0)),y:Math.abs(Math.round(ve.pageY)-(((Me=re.current)==null?void 0:Me.y)??0))}},fe=ve=>{Ce.x<=10&&Ce.y<=10?ve.preventDefault():k.contains(ve.target)||Q(!1),document.removeEventListener("pointermove",me),re.current=null};return re.current!==null&&(document.addEventListener("pointermove",me),document.addEventListener("pointerup",fe,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",me),document.removeEventListener("pointerup",fe,{capture:!0})}}},[k,Q,re]),E.useEffect(()=>{const Ce=()=>Q(!1);return window.addEventListener("blur",Ce),window.addEventListener("resize",Ce),()=>{window.removeEventListener("blur",Ce),window.removeEventListener("resize",Ce)}},[Q]);const[le,ye]=nA(Ce=>{const me=Y().filter(ne=>!ne.disabled),fe=me.find(ne=>ne.ref.current===document.activeElement),ve=iA(me,Ce,fe);ve&&setTimeout(()=>ve.ref.current.focus())}),W=E.useCallback((Ce,me,fe)=>{const ve=!H.current&&!fe;(A.value!==void 0&&A.value===me||ve)&&(M(Ce),ve&&(H.current=!0))},[A.value]),ee=E.useCallback(()=>k==null?void 0:k.focus(),[k]),ie=E.useCallback((Ce,me,fe)=>{const ve=!H.current&&!fe;(A.value!==void 0&&A.value===me||ve)&&q(Ce)},[A.value]),ce=a==="popper"?uy:$T,xe=ce===uy?{side:c,sideOffset:d,align:h,alignOffset:p,arrowPadding:x,collisionBoundary:v,collisionPadding:b,sticky:N,hideWhenDetached:_,avoidCollisions:C}:{};return s.jsx(UT,{scope:r,content:k,viewport:B,onViewportChange:O,itemRefCallback:W,selectedItem:F,onItemLeave:ee,itemTextRefCallback:ie,focusSelectedItem:G,selectedItemText:z,position:a,isPositioned:ae,searchRef:le,children:s.jsx(KS,{as:r9,allowPinchZoom:!0,children:s.jsx(XS,{asChild:!0,trapped:A.open,onMountAutoFocus:Ce=>{Ce.preventDefault()},onUnmountAutoFocus:Ts(n,Ce=>{var me;(me=A.trigger)==null||me.focus({preventScroll:!0}),Ce.preventDefault()}),children:s.jsx(Sw,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:Ce=>Ce.preventDefault(),onDismiss:()=>A.onOpenChange(!1),children:s.jsx(ce,{role:"listbox",id:A.contentId,"data-state":A.open?"open":"closed",dir:A.dir,onContextMenu:Ce=>Ce.preventDefault(),...T,...xe,onPlaced:()=>je(!0),ref:D,style:{display:"flex",flexDirection:"column",outline:"none",...T.style},onKeyDown:Ts(T.onKeyDown,Ce=>{const me=Ce.ctrlKey||Ce.altKey||Ce.metaKey;if(Ce.key==="Tab"&&Ce.preventDefault(),!me&&Ce.key.length===1&&ye(Ce.key),["ArrowUp","ArrowDown","Home","End"].includes(Ce.key)){let ve=Y().filter(ne=>!ne.disabled).map(ne=>ne.ref.current);if(["ArrowUp","End"].includes(Ce.key)&&(ve=ve.slice().reverse()),["ArrowUp","ArrowDown"].includes(Ce.key)){const ne=Ce.target,Me=ve.indexOf(ne);ve=ve.slice(Me+1)}setTimeout(()=>Z(ve)),Ce.preventDefault()}})})})})})})});zT.displayName=s9;var a9="SelectItemAlignedPosition",$T=E.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:a,...n}=e,i=Ld(Ru,r),o=Fd(Ru,r),[c,d]=E.useState(null),[h,p]=E.useState(null),x=br(t,D=>p(D)),v=Rg(r),b=E.useRef(!1),N=E.useRef(!0),{viewport:_,selectedItem:C,selectedItemText:T,focusSelectedItem:A}=o,k=E.useCallback(()=>{if(i.trigger&&i.valueNode&&c&&h&&_&&C&&T){const D=i.trigger.getBoundingClientRect(),F=h.getBoundingClientRect(),M=i.valueNode.getBoundingClientRect(),z=T.getBoundingClientRect();if(i.dir!=="rtl"){const ne=z.left-F.left,Me=M.left-ne,Ie=D.left-Me,Be=D.width+Ie,ot=Math.max(Be,F.width),Se=window.innerWidth-Uo,ze=hp(Me,[Uo,Math.max(Uo,Se-ot)]);c.style.minWidth=Be+"px",c.style.left=ze+"px"}else{const ne=F.right-z.right,Me=window.innerWidth-M.right-ne,Ie=window.innerWidth-D.right-Me,Be=D.width+Ie,ot=Math.max(Be,F.width),Se=window.innerWidth-Uo,ze=hp(Me,[Uo,Math.max(Uo,Se-ot)]);c.style.minWidth=Be+"px",c.style.right=ze+"px"}const q=v(),Y=window.innerHeight-Uo*2,ae=_.scrollHeight,je=window.getComputedStyle(h),H=parseInt(je.borderTopWidth,10),Z=parseInt(je.paddingTop,10),G=parseInt(je.borderBottomWidth,10),Q=parseInt(je.paddingBottom,10),re=H+Z+ae+Q+G,le=Math.min(C.offsetHeight*5,re),ye=window.getComputedStyle(_),W=parseInt(ye.paddingTop,10),ee=parseInt(ye.paddingBottom,10),ie=D.top+D.height/2-Uo,ce=Y-ie,xe=C.offsetHeight/2,Ce=C.offsetTop+xe,me=H+Z+Ce,fe=re-me;if(me<=ie){const ne=q.length>0&&C===q[q.length-1].ref.current;c.style.bottom="0px";const Me=h.clientHeight-_.offsetTop-_.offsetHeight,Ie=Math.max(ce,xe+(ne?ee:0)+Me+G),Be=me+Ie;c.style.height=Be+"px"}else{const ne=q.length>0&&C===q[0].ref.current;c.style.top="0px";const Ie=Math.max(ie,H+_.offsetTop+(ne?W:0)+xe)+fe;c.style.height=Ie+"px",_.scrollTop=me-ie+_.offsetTop}c.style.margin=`${Uo}px 0`,c.style.minHeight=le+"px",c.style.maxHeight=Y+"px",a==null||a(),requestAnimationFrame(()=>b.current=!0)}},[v,i.trigger,i.valueNode,c,h,_,C,T,i.dir,a]);Ji(()=>k(),[k]);const[I,B]=E.useState();Ji(()=>{h&&B(window.getComputedStyle(h).zIndex)},[h]);const O=E.useCallback(D=>{D&&N.current===!0&&(k(),A==null||A(),N.current=!1)},[k,A]);return s.jsx(i9,{scope:r,contentWrapper:c,shouldExpandOnScrollRef:b,onScrollButtonChange:O,children:s.jsx("div",{ref:d,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:I},children:s.jsx(ys.div,{...n,ref:x,style:{boxSizing:"border-box",maxHeight:"100%",...n.style}})})})});$T.displayName=a9;var n9="SelectPopperPosition",uy=E.forwardRef((e,t)=>{const{__scopeSelect:r,align:a="start",collisionPadding:n=Uo,...i}=e,o=Pg(r);return s.jsx(Tw,{...o,...i,ref:t,align:a,collisionPadding:n,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});uy.displayName=n9;var[i9,eb]=Lf(Ru,{}),hy="SelectViewport",qT=E.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:a,...n}=e,i=Fd(hy,r),o=eb(hy,r),c=br(t,i.onViewportChange),d=E.useRef(0);return s.jsxs(s.Fragment,{children:[s.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),s.jsx(kg.Slot,{scope:r,children:s.jsx(ys.div,{"data-radix-select-viewport":"",role:"presentation",...n,ref:c,style:{position:"relative",flex:1,overflow:"hidden auto",...n.style},onScroll:Ts(n.onScroll,h=>{const p=h.currentTarget,{contentWrapper:x,shouldExpandOnScrollRef:v}=o;if(v!=null&&v.current&&x){const b=Math.abs(d.current-p.scrollTop);if(b>0){const N=window.innerHeight-Uo*2,_=parseFloat(x.style.minHeight),C=parseFloat(x.style.height),T=Math.max(_,C);if(T<N){const A=T+b,k=Math.min(N,A),I=A-k;x.style.height=k+"px",x.style.bottom==="0px"&&(p.scrollTop=I>0?I:0,x.style.justifyContent="flex-end")}}}d.current=p.scrollTop})})})]})});qT.displayName=hy;var WT="SelectGroup",[o9,l9]=Lf(WT),c9=E.forwardRef((e,t)=>{const{__scopeSelect:r,...a}=e,n=Ai();return s.jsx(o9,{scope:r,id:n,children:s.jsx(ys.div,{role:"group","aria-labelledby":n,...a,ref:t})})});c9.displayName=WT;var HT="SelectLabel",GT=E.forwardRef((e,t)=>{const{__scopeSelect:r,...a}=e,n=l9(HT,r);return s.jsx(ys.div,{id:n.id,...a,ref:t})});GT.displayName=HT;var Ix="SelectItem",[d9,KT]=Lf(Ix),XT=E.forwardRef((e,t)=>{const{__scopeSelect:r,value:a,disabled:n=!1,textValue:i,...o}=e,c=Ld(Ix,r),d=Fd(Ix,r),h=c.value===a,[p,x]=E.useState(i??""),[v,b]=E.useState(!1),N=br(t,A=>{var k;return(k=d.itemRefCallback)==null?void 0:k.call(d,A,a,n)}),_=Ai(),C=E.useRef("touch"),T=()=>{n||(c.onValueChange(a),c.onOpenChange(!1))};if(a==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return s.jsx(d9,{scope:r,value:a,disabled:n,textId:_,isSelected:h,onItemTextChange:E.useCallback(A=>{x(k=>k||((A==null?void 0:A.textContent)??"").trim())},[]),children:s.jsx(kg.ItemSlot,{scope:r,value:a,disabled:n,textValue:p,children:s.jsx(ys.div,{role:"option","aria-labelledby":_,"data-highlighted":v?"":void 0,"aria-selected":h&&v,"data-state":h?"checked":"unchecked","aria-disabled":n||void 0,"data-disabled":n?"":void 0,tabIndex:n?void 0:-1,...o,ref:N,onFocus:Ts(o.onFocus,()=>b(!0)),onBlur:Ts(o.onBlur,()=>b(!1)),onClick:Ts(o.onClick,()=>{C.current!=="mouse"&&T()}),onPointerUp:Ts(o.onPointerUp,()=>{C.current==="mouse"&&T()}),onPointerDown:Ts(o.onPointerDown,A=>{C.current=A.pointerType}),onPointerMove:Ts(o.onPointerMove,A=>{var k;C.current=A.pointerType,n?(k=d.onItemLeave)==null||k.call(d):C.current==="mouse"&&A.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Ts(o.onPointerLeave,A=>{var k;A.currentTarget===document.activeElement&&((k=d.onItemLeave)==null||k.call(d))}),onKeyDown:Ts(o.onKeyDown,A=>{var I;((I=d.searchRef)==null?void 0:I.current)!==""&&A.key===" "||(X7.includes(A.key)&&T(),A.key===" "&&A.preventDefault())})})})})});XT.displayName=Ix;var Tm="SelectItemText",YT=E.forwardRef((e,t)=>{const{__scopeSelect:r,className:a,style:n,...i}=e,o=Ld(Tm,r),c=Fd(Tm,r),d=KT(Tm,r),h=J7(Tm,r),[p,x]=E.useState(null),v=br(t,T=>x(T),d.onItemTextChange,T=>{var A;return(A=c.itemTextRefCallback)==null?void 0:A.call(c,T,d.value,d.disabled)}),b=p==null?void 0:p.textContent,N=E.useMemo(()=>s.jsx("option",{value:d.value,disabled:d.disabled,children:b},d.value),[d.disabled,d.value,b]),{onNativeOptionAdd:_,onNativeOptionRemove:C}=h;return Ji(()=>(_(N),()=>C(N)),[_,C,N]),s.jsxs(s.Fragment,{children:[s.jsx(ys.span,{id:d.textId,...i,ref:v}),d.isSelected&&o.valueNode&&!o.valueNodeHasChildren?_u.createPortal(i.children,o.valueNode):null]})});YT.displayName=Tm;var ZT="SelectItemIndicator",QT=E.forwardRef((e,t)=>{const{__scopeSelect:r,...a}=e;return KT(ZT,r).isSelected?s.jsx(ys.span,{"aria-hidden":!0,...a,ref:t}):null});QT.displayName=ZT;var fy="SelectScrollUpButton",JT=E.forwardRef((e,t)=>{const r=Fd(fy,e.__scopeSelect),a=eb(fy,e.__scopeSelect),[n,i]=E.useState(!1),o=br(t,a.onScrollButtonChange);return Ji(()=>{if(r.viewport&&r.isPositioned){let c=function(){const h=d.scrollTop>0;i(h)};const d=r.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[r.viewport,r.isPositioned]),n?s.jsx(tA,{...e,ref:o,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=r;c&&d&&(c.scrollTop=c.scrollTop-d.offsetHeight)}}):null});JT.displayName=fy;var my="SelectScrollDownButton",eA=E.forwardRef((e,t)=>{const r=Fd(my,e.__scopeSelect),a=eb(my,e.__scopeSelect),[n,i]=E.useState(!1),o=br(t,a.onScrollButtonChange);return Ji(()=>{if(r.viewport&&r.isPositioned){let c=function(){const h=d.scrollHeight-d.clientHeight,p=Math.ceil(d.scrollTop)<h;i(p)};const d=r.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[r.viewport,r.isPositioned]),n?s.jsx(tA,{...e,ref:o,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=r;c&&d&&(c.scrollTop=c.scrollTop+d.offsetHeight)}}):null});eA.displayName=my;var tA=E.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:a,...n}=e,i=Fd("SelectScrollButton",r),o=E.useRef(null),c=Rg(r),d=E.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return E.useEffect(()=>()=>d(),[d]),Ji(()=>{var p;const h=c().find(x=>x.ref.current===document.activeElement);(p=h==null?void 0:h.ref.current)==null||p.scrollIntoView({block:"nearest"})},[c]),s.jsx(ys.div,{"aria-hidden":!0,...n,ref:t,style:{flexShrink:0,...n.style},onPointerDown:Ts(n.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(a,50))}),onPointerMove:Ts(n.onPointerMove,()=>{var h;(h=i.onItemLeave)==null||h.call(i),o.current===null&&(o.current=window.setInterval(a,50))}),onPointerLeave:Ts(n.onPointerLeave,()=>{d()})})}),u9="SelectSeparator",sA=E.forwardRef((e,t)=>{const{__scopeSelect:r,...a}=e;return s.jsx(ys.div,{"aria-hidden":!0,...a,ref:t})});sA.displayName=u9;var py="SelectArrow",h9=E.forwardRef((e,t)=>{const{__scopeSelect:r,...a}=e,n=Pg(r),i=Ld(py,r),o=Fd(py,r);return i.open&&o.position==="popper"?s.jsx(Aw,{...n,...a,ref:t}):null});h9.displayName=py;var f9="SelectBubbleInput",rA=E.forwardRef(({__scopeSelect:e,value:t,...r},a)=>{const n=E.useRef(null),i=br(a,n),o=Gp(t);return E.useEffect(()=>{const c=n.current;if(!c)return;const d=window.HTMLSelectElement.prototype,p=Object.getOwnPropertyDescriptor(d,"value").set;if(o!==t&&p){const x=new Event("change",{bubbles:!0});p.call(c,t),c.dispatchEvent(x)}},[o,t]),s.jsx(ys.select,{...r,style:{...$8,...r.style},ref:i,defaultValue:t})});rA.displayName=f9;function aA(e){return e===""||e===void 0}function nA(e){const t=dc(e),r=E.useRef(""),a=E.useRef(0),n=E.useCallback(o=>{const c=r.current+o;t(c),function d(h){r.current=h,window.clearTimeout(a.current),h!==""&&(a.current=window.setTimeout(()=>d(""),1e3))}(c)},[t]),i=E.useCallback(()=>{r.current="",window.clearTimeout(a.current)},[]);return E.useEffect(()=>()=>window.clearTimeout(a.current),[]),[r,n,i]}function iA(e,t,r){const n=t.length>1&&Array.from(t).every(h=>h===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let o=m9(e,Math.max(i,0));n.length===1&&(o=o.filter(h=>h!==r));const d=o.find(h=>h.textValue.toLowerCase().startsWith(n.toLowerCase()));return d!==r?d:void 0}function m9(e,t){return e.map((r,a)=>e[(t+a)%e.length])}var p9=IT,oA=DT,x9=LT,g9=FT,v9=BT,lA=VT,y9=qT,cA=GT,dA=XT,w9=YT,b9=QT,uA=JT,hA=eA,fA=sA;const qs=p9,Ws=x9,Ls=E.forwardRef(({className:e,children:t,...r},a)=>s.jsxs(oA,{ref:a,className:pt("flex h-11 w-full items-center justify-between rounded-xl border border-input bg-background px-4 py-2","font-body text-sm text-foreground","ring-offset-background placeholder:text-muted-foreground","transition-all duration-200","focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary","disabled:cursor-not-allowed disabled:opacity-50","[&>span]:line-clamp-1",e),...r,children:[t,s.jsx(g9,{asChild:!0,children:s.jsx(If,{className:"h-4 w-4 opacity-50"})})]}));Ls.displayName=oA.displayName;const mA=E.forwardRef(({className:e,...t},r)=>s.jsx(uA,{ref:r,className:pt("flex cursor-default items-center justify-center py-1",e),...t,children:s.jsx(v6,{className:"h-4 w-4"})}));mA.displayName=uA.displayName;const pA=E.forwardRef(({className:e,...t},r)=>s.jsx(hA,{ref:r,className:pt("flex cursor-default items-center justify-center py-1",e),...t,children:s.jsx(If,{className:"h-4 w-4"})}));pA.displayName=hA.displayName;const Fs=E.forwardRef(({className:e,children:t,position:r="popper",...a},n)=>s.jsx(v9,{children:s.jsxs(lA,{ref:n,className:pt("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-xl border bg-popover text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0","data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95","data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2","data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...a,children:[s.jsx(mA,{}),s.jsx(y9,{className:pt("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),s.jsx(pA,{})]})}));Fs.displayName=lA.displayName;const _9=E.forwardRef(({className:e,...t},r)=>s.jsx(cA,{ref:r,className:pt("py-1.5 pl-8 pr-2 font-display text-sm font-semibold",e),...t}));_9.displayName=cA.displayName;const xt=E.forwardRef(({className:e,children:t,...r},a)=>s.jsxs(dA,{ref:a,className:pt("relative flex w-full cursor-default select-none items-center rounded-lg py-2 pl-8 pr-2","font-body text-sm","outline-none transition-colors duration-150","focus:bg-primary/10 focus:text-primary","data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(b9,{children:s.jsx(Ea,{className:"h-4 w-4 text-primary"})})}),s.jsx(w9,{children:t})]}));xt.displayName=dA.displayName;const j9=E.forwardRef(({className:e,...t},r)=>s.jsx(fA,{ref:r,className:pt("-mx-1 my-1 h-px bg-border",e),...t}));j9.displayName=fA.displayName;var Pr;(function(e){e.assertEqual=n=>{};function t(n){}e.assertIs=t;function r(n){throw new Error}e.assertNever=r,e.arrayToEnum=n=>{const i={};for(const o of n)i[o]=o;return i},e.getValidEnumValues=n=>{const i=e.objectKeys(n).filter(c=>typeof n[n[c]]!="number"),o={};for(const c of i)o[c]=n[c];return e.objectValues(o)},e.objectValues=n=>e.objectKeys(n).map(function(i){return n[i]}),e.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{const i=[];for(const o in n)Object.prototype.hasOwnProperty.call(n,o)&&i.push(o);return i},e.find=(n,i)=>{for(const o of n)if(i(o))return o},e.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&Number.isFinite(n)&&Math.floor(n)===n;function a(n,i=" | "){return n.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}e.joinValues=a,e.jsonStringifyReplacer=(n,i)=>typeof i=="bigint"?i.toString():i})(Pr||(Pr={}));var Aj;(function(e){e.mergeShapes=(t,r)=>({...t,...r})})(Aj||(Aj={}));const gs=Pr.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Xc=e=>{switch(typeof e){case"undefined":return gs.undefined;case"string":return gs.string;case"number":return Number.isNaN(e)?gs.nan:gs.number;case"boolean":return gs.boolean;case"function":return gs.function;case"bigint":return gs.bigint;case"symbol":return gs.symbol;case"object":return Array.isArray(e)?gs.array:e===null?gs.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?gs.promise:typeof Map<"u"&&e instanceof Map?gs.map:typeof Set<"u"&&e instanceof Set?gs.set:typeof Date<"u"&&e instanceof Date?gs.date:gs.object;default:return gs.unknown}},$t=Pr.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class zl extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){const r=t||function(i){return i.message},a={_errors:[]},n=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(n);else if(o.code==="invalid_return_type")n(o.returnTypeError);else if(o.code==="invalid_arguments")n(o.argumentsError);else if(o.path.length===0)a._errors.push(r(o));else{let c=a,d=0;for(;d<o.path.length;){const h=o.path[d];d===o.path.length-1?(c[h]=c[h]||{_errors:[]},c[h]._errors.push(r(o))):c[h]=c[h]||{_errors:[]},c=c[h],d++}}};return n(this),a}static assert(t){if(!(t instanceof zl))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Pr.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},a=[];for(const n of this.issues)if(n.path.length>0){const i=n.path[0];r[i]=r[i]||[],r[i].push(t(n))}else a.push(t(n));return{formErrors:a,fieldErrors:r}}get formErrors(){return this.flatten()}}zl.create=e=>new zl(e);const xy=(e,t)=>{let r;switch(e.code){case $t.invalid_type:e.received===gs.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case $t.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,Pr.jsonStringifyReplacer)}`;break;case $t.unrecognized_keys:r=`Unrecognized key(s) in object: ${Pr.joinValues(e.keys,", ")}`;break;case $t.invalid_union:r="Invalid input";break;case $t.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Pr.joinValues(e.options)}`;break;case $t.invalid_enum_value:r=`Invalid enum value. Expected ${Pr.joinValues(e.options)}, received '${e.received}'`;break;case $t.invalid_arguments:r="Invalid function arguments";break;case $t.invalid_return_type:r="Invalid function return type";break;case $t.invalid_date:r="Invalid date";break;case $t.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:Pr.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case $t.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case $t.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case $t.custom:r="Invalid input";break;case $t.invalid_intersection_types:r="Intersection results could not be merged";break;case $t.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case $t.not_finite:r="Number must be finite";break;default:r=t.defaultError,Pr.assertNever(e)}return{message:r}};let N9=xy;function C9(){return N9}const E9=e=>{const{data:t,path:r,errorMaps:a,issueData:n}=e,i=[...r,...n.path||[]],o={...n,path:i};if(n.message!==void 0)return{...n,path:i,message:n.message};let c="";const d=a.filter(h=>!!h).slice().reverse();for(const h of d)c=h(o,{data:t,defaultError:c}).message;return{...n,path:i,message:c}};function as(e,t){const r=C9(),a=E9({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===xy?void 0:xy].filter(n=>!!n)});e.common.issues.push(a)}class to{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const a=[];for(const n of r){if(n.status==="aborted")return Zs;n.status==="dirty"&&t.dirty(),a.push(n.value)}return{status:t.value,value:a}}static async mergeObjectAsync(t,r){const a=[];for(const n of r){const i=await n.key,o=await n.value;a.push({key:i,value:o})}return to.mergeObjectSync(t,a)}static mergeObjectSync(t,r){const a={};for(const n of r){const{key:i,value:o}=n;if(i.status==="aborted"||o.status==="aborted")return Zs;i.status==="dirty"&&t.dirty(),o.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||n.alwaysSet)&&(a[i.value]=o.value)}return{status:t.value,value:a}}}const Zs=Object.freeze({status:"aborted"}),Am=e=>({status:"dirty",value:e}),Ao=e=>({status:"valid",value:e}),kj=e=>e.status==="aborted",Rj=e=>e.status==="dirty",af=e=>e.status==="valid",Ox=e=>typeof Promise<"u"&&e instanceof Promise;var vs;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(vs||(vs={}));class Cd{constructor(t,r,a,n){this._cachedPath=[],this.parent=t,this.data=r,this._path=a,this._key=n}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Pj=(e,t)=>{if(af(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new zl(e.common.issues);return this._error=r,this._error}}};function yr(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:a,description:n}=e;if(t&&(r||a))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:n}:{errorMap:(o,c)=>{const{message:d}=e;return o.code==="invalid_enum_value"?{message:d??c.defaultError}:typeof c.data>"u"?{message:d??a??c.defaultError}:o.code!=="invalid_type"?{message:c.defaultError}:{message:d??r??c.defaultError}},description:n}}class Ar{get description(){return this._def.description}_getType(t){return Xc(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:Xc(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new to,ctx:{common:t.parent.common,data:t.data,parsedType:Xc(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(Ox(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const a=this.safeParse(t,r);if(a.success)return a.data;throw a.error}safeParse(t,r){const a={common:{issues:[],async:(r==null?void 0:r.async)??!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Xc(t)},n=this._parseSync({data:t,path:a.path,parent:a});return Pj(a,n)}"~validate"(t){var a,n;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Xc(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:r});return af(i)?{value:i.value}:{issues:r.common.issues}}catch(i){(n=(a=i==null?void 0:i.message)==null?void 0:a.toLowerCase())!=null&&n.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:r}).then(i=>af(i)?{value:i.value}:{issues:r.common.issues})}async parseAsync(t,r){const a=await this.safeParseAsync(t,r);if(a.success)return a.data;throw a.error}async safeParseAsync(t,r){const a={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Xc(t)},n=this._parse({data:t,path:a.path,parent:a}),i=await(Ox(n)?n:Promise.resolve(n));return Pj(a,i)}refine(t,r){const a=n=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(n):r;return this._refinement((n,i)=>{const o=t(n),c=()=>i.addIssue({code:$t.custom,...a(n)});return typeof Promise<"u"&&o instanceof Promise?o.then(d=>d?!0:(c(),!1)):o?!0:(c(),!1)})}refinement(t,r){return this._refinement((a,n)=>t(a)?!0:(n.addIssue(typeof r=="function"?r(a,n):r),!1))}_refinement(t){return new of({schema:this,typeName:Qs.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return _d.create(this,this._def)}nullable(){return lf.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Pl.create(this)}promise(){return Fx.create(this,this._def)}or(t){return Mx.create([this,t],this._def)}and(t){return Lx.create(this,t,this._def)}transform(t){return new of({...yr(this._def),schema:this,typeName:Qs.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new yy({...yr(this._def),innerType:this,defaultValue:r,typeName:Qs.ZodDefault})}brand(){return new X9({typeName:Qs.ZodBranded,type:this,...yr(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new wy({...yr(this._def),innerType:this,catchValue:r,typeName:Qs.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return tb.create(this,t)}readonly(){return by.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const S9=/^c[^\s-]{8,}$/i,T9=/^[0-9a-z]+$/,A9=/^[0-9A-HJKMNP-TV-Z]{26}$/i,k9=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,R9=/^[a-z0-9_-]{21}$/i,P9=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,I9=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,O9=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,D9="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let F1;const M9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,L9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,F9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,B9=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,V9=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,U9=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,xA="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",z9=new RegExp(`^${xA}$`);function gA(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const r=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}function $9(e){return new RegExp(`^${gA(e)}$`)}function q9(e){let t=`${xA}T${gA(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function W9(e,t){return!!((t==="v4"||!t)&&M9.test(e)||(t==="v6"||!t)&&F9.test(e))}function H9(e,t){if(!P9.test(e))return!1;try{const[r]=e.split(".");if(!r)return!1;const a=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),n=JSON.parse(atob(a));return!(typeof n!="object"||n===null||"typ"in n&&(n==null?void 0:n.typ)!=="JWT"||!n.alg||t&&n.alg!==t)}catch{return!1}}function G9(e,t){return!!((t==="v4"||!t)&&L9.test(e)||(t==="v6"||!t)&&B9.test(e))}class xd extends Ar{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==gs.string){const i=this._getOrReturnCtx(t);return as(i,{code:$t.invalid_type,expected:gs.string,received:i.parsedType}),Zs}const a=new to;let n;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(n=this._getOrReturnCtx(t,n),as(n,{code:$t.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),a.dirty());else if(i.kind==="max")t.data.length>i.value&&(n=this._getOrReturnCtx(t,n),as(n,{code:$t.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),a.dirty());else if(i.kind==="length"){const o=t.data.length>i.value,c=t.data.length<i.value;(o||c)&&(n=this._getOrReturnCtx(t,n),o?as(n,{code:$t.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):c&&as(n,{code:$t.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),a.dirty())}else if(i.kind==="email")O9.test(t.data)||(n=this._getOrReturnCtx(t,n),as(n,{validation:"email",code:$t.invalid_string,message:i.message}),a.dirty());else if(i.kind==="emoji")F1||(F1=new RegExp(D9,"u")),F1.test(t.data)||(n=this._getOrReturnCtx(t,n),as(n,{validation:"emoji",code:$t.invalid_string,message:i.message}),a.dirty());else if(i.kind==="uuid")k9.test(t.data)||(n=this._getOrReturnCtx(t,n),as(n,{validation:"uuid",code:$t.invalid_string,message:i.message}),a.dirty());else if(i.kind==="nanoid")R9.test(t.data)||(n=this._getOrReturnCtx(t,n),as(n,{validation:"nanoid",code:$t.invalid_string,message:i.message}),a.dirty());else if(i.kind==="cuid")S9.test(t.data)||(n=this._getOrReturnCtx(t,n),as(n,{validation:"cuid",code:$t.invalid_string,message:i.message}),a.dirty());else if(i.kind==="cuid2")T9.test(t.data)||(n=this._getOrReturnCtx(t,n),as(n,{validation:"cuid2",code:$t.invalid_string,message:i.message}),a.dirty());else if(i.kind==="ulid")A9.test(t.data)||(n=this._getOrReturnCtx(t,n),as(n,{validation:"ulid",code:$t.invalid_string,message:i.message}),a.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{n=this._getOrReturnCtx(t,n),as(n,{validation:"url",code:$t.invalid_string,message:i.message}),a.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(n=this._getOrReturnCtx(t,n),as(n,{validation:"regex",code:$t.invalid_string,message:i.message}),a.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(n=this._getOrReturnCtx(t,n),as(n,{code:$t.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),a.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(n=this._getOrReturnCtx(t,n),as(n,{code:$t.invalid_string,validation:{startsWith:i.value},message:i.message}),a.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(n=this._getOrReturnCtx(t,n),as(n,{code:$t.invalid_string,validation:{endsWith:i.value},message:i.message}),a.dirty()):i.kind==="datetime"?q9(i).test(t.data)||(n=this._getOrReturnCtx(t,n),as(n,{code:$t.invalid_string,validation:"datetime",message:i.message}),a.dirty()):i.kind==="date"?z9.test(t.data)||(n=this._getOrReturnCtx(t,n),as(n,{code:$t.invalid_string,validation:"date",message:i.message}),a.dirty()):i.kind==="time"?$9(i).test(t.data)||(n=this._getOrReturnCtx(t,n),as(n,{code:$t.invalid_string,validation:"time",message:i.message}),a.dirty()):i.kind==="duration"?I9.test(t.data)||(n=this._getOrReturnCtx(t,n),as(n,{validation:"duration",code:$t.invalid_string,message:i.message}),a.dirty()):i.kind==="ip"?W9(t.data,i.version)||(n=this._getOrReturnCtx(t,n),as(n,{validation:"ip",code:$t.invalid_string,message:i.message}),a.dirty()):i.kind==="jwt"?H9(t.data,i.alg)||(n=this._getOrReturnCtx(t,n),as(n,{validation:"jwt",code:$t.invalid_string,message:i.message}),a.dirty()):i.kind==="cidr"?G9(t.data,i.version)||(n=this._getOrReturnCtx(t,n),as(n,{validation:"cidr",code:$t.invalid_string,message:i.message}),a.dirty()):i.kind==="base64"?V9.test(t.data)||(n=this._getOrReturnCtx(t,n),as(n,{validation:"base64",code:$t.invalid_string,message:i.message}),a.dirty()):i.kind==="base64url"?U9.test(t.data)||(n=this._getOrReturnCtx(t,n),as(n,{validation:"base64url",code:$t.invalid_string,message:i.message}),a.dirty()):Pr.assertNever(i);return{status:a.value,value:t.data}}_regex(t,r,a){return this.refinement(n=>t.test(n),{validation:r,code:$t.invalid_string,...vs.errToObj(a)})}_addCheck(t){return new xd({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...vs.errToObj(t)})}url(t){return this._addCheck({kind:"url",...vs.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...vs.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...vs.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...vs.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...vs.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...vs.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...vs.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...vs.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...vs.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...vs.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...vs.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...vs.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...vs.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...vs.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...vs.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...vs.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...vs.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...vs.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...vs.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...vs.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...vs.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...vs.errToObj(r)})}nonempty(t){return this.min(1,vs.errToObj(t))}trim(){return new xd({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new xd({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new xd({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}xd.create=e=>new xd({checks:[],typeName:Qs.ZodString,coerce:(e==null?void 0:e.coerce)??!1,...yr(e)});function K9(e,t){const r=(e.toString().split(".")[1]||"").length,a=(t.toString().split(".")[1]||"").length,n=r>a?r:a,i=Number.parseInt(e.toFixed(n).replace(".","")),o=Number.parseInt(t.toFixed(n).replace(".",""));return i%o/10**n}class fp extends Ar{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==gs.number){const i=this._getOrReturnCtx(t);return as(i,{code:$t.invalid_type,expected:gs.number,received:i.parsedType}),Zs}let a;const n=new to;for(const i of this._def.checks)i.kind==="int"?Pr.isInteger(t.data)||(a=this._getOrReturnCtx(t,a),as(a,{code:$t.invalid_type,expected:"integer",received:"float",message:i.message}),n.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(a=this._getOrReturnCtx(t,a),as(a,{code:$t.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(a=this._getOrReturnCtx(t,a),as(a,{code:$t.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="multipleOf"?K9(t.data,i.value)!==0&&(a=this._getOrReturnCtx(t,a),as(a,{code:$t.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(a=this._getOrReturnCtx(t,a),as(a,{code:$t.not_finite,message:i.message}),n.dirty()):Pr.assertNever(i);return{status:n.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,vs.toString(r))}gt(t,r){return this.setLimit("min",t,!1,vs.toString(r))}lte(t,r){return this.setLimit("max",t,!0,vs.toString(r))}lt(t,r){return this.setLimit("max",t,!1,vs.toString(r))}setLimit(t,r,a,n){return new fp({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:a,message:vs.toString(n)}]})}_addCheck(t){return new fp({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:vs.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:vs.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:vs.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:vs.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:vs.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:vs.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:vs.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:vs.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:vs.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Pr.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const a of this._def.checks){if(a.kind==="finite"||a.kind==="int"||a.kind==="multipleOf")return!0;a.kind==="min"?(r===null||a.value>r)&&(r=a.value):a.kind==="max"&&(t===null||a.value<t)&&(t=a.value)}return Number.isFinite(r)&&Number.isFinite(t)}}fp.create=e=>new fp({checks:[],typeName:Qs.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...yr(e)});class mp extends Ar{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==gs.bigint)return this._getInvalidInput(t);let a;const n=new to;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(a=this._getOrReturnCtx(t,a),as(a,{code:$t.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(a=this._getOrReturnCtx(t,a),as(a,{code:$t.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(a=this._getOrReturnCtx(t,a),as(a,{code:$t.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):Pr.assertNever(i);return{status:n.value,value:t.data}}_getInvalidInput(t){const r=this._getOrReturnCtx(t);return as(r,{code:$t.invalid_type,expected:gs.bigint,received:r.parsedType}),Zs}gte(t,r){return this.setLimit("min",t,!0,vs.toString(r))}gt(t,r){return this.setLimit("min",t,!1,vs.toString(r))}lte(t,r){return this.setLimit("max",t,!0,vs.toString(r))}lt(t,r){return this.setLimit("max",t,!1,vs.toString(r))}setLimit(t,r,a,n){return new mp({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:a,message:vs.toString(n)}]})}_addCheck(t){return new mp({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:vs.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:vs.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:vs.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:vs.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:vs.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}mp.create=e=>new mp({checks:[],typeName:Qs.ZodBigInt,coerce:(e==null?void 0:e.coerce)??!1,...yr(e)});class Ij extends Ar{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==gs.boolean){const a=this._getOrReturnCtx(t);return as(a,{code:$t.invalid_type,expected:gs.boolean,received:a.parsedType}),Zs}return Ao(t.data)}}Ij.create=e=>new Ij({typeName:Qs.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...yr(e)});class Dx extends Ar{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==gs.date){const i=this._getOrReturnCtx(t);return as(i,{code:$t.invalid_type,expected:gs.date,received:i.parsedType}),Zs}if(Number.isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return as(i,{code:$t.invalid_date}),Zs}const a=new to;let n;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(n=this._getOrReturnCtx(t,n),as(n,{code:$t.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),a.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(n=this._getOrReturnCtx(t,n),as(n,{code:$t.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),a.dirty()):Pr.assertNever(i);return{status:a.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Dx({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:vs.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:vs.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}Dx.create=e=>new Dx({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:Qs.ZodDate,...yr(e)});class Oj extends Ar{_parse(t){if(this._getType(t)!==gs.symbol){const a=this._getOrReturnCtx(t);return as(a,{code:$t.invalid_type,expected:gs.symbol,received:a.parsedType}),Zs}return Ao(t.data)}}Oj.create=e=>new Oj({typeName:Qs.ZodSymbol,...yr(e)});class Dj extends Ar{_parse(t){if(this._getType(t)!==gs.undefined){const a=this._getOrReturnCtx(t);return as(a,{code:$t.invalid_type,expected:gs.undefined,received:a.parsedType}),Zs}return Ao(t.data)}}Dj.create=e=>new Dj({typeName:Qs.ZodUndefined,...yr(e)});class Mj extends Ar{_parse(t){if(this._getType(t)!==gs.null){const a=this._getOrReturnCtx(t);return as(a,{code:$t.invalid_type,expected:gs.null,received:a.parsedType}),Zs}return Ao(t.data)}}Mj.create=e=>new Mj({typeName:Qs.ZodNull,...yr(e)});class Lj extends Ar{constructor(){super(...arguments),this._any=!0}_parse(t){return Ao(t.data)}}Lj.create=e=>new Lj({typeName:Qs.ZodAny,...yr(e)});class Fj extends Ar{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Ao(t.data)}}Fj.create=e=>new Fj({typeName:Qs.ZodUnknown,...yr(e)});class Ed extends Ar{_parse(t){const r=this._getOrReturnCtx(t);return as(r,{code:$t.invalid_type,expected:gs.never,received:r.parsedType}),Zs}}Ed.create=e=>new Ed({typeName:Qs.ZodNever,...yr(e)});class Bj extends Ar{_parse(t){if(this._getType(t)!==gs.undefined){const a=this._getOrReturnCtx(t);return as(a,{code:$t.invalid_type,expected:gs.void,received:a.parsedType}),Zs}return Ao(t.data)}}Bj.create=e=>new Bj({typeName:Qs.ZodVoid,...yr(e)});class Pl extends Ar{_parse(t){const{ctx:r,status:a}=this._processInputParams(t),n=this._def;if(r.parsedType!==gs.array)return as(r,{code:$t.invalid_type,expected:gs.array,received:r.parsedType}),Zs;if(n.exactLength!==null){const o=r.data.length>n.exactLength.value,c=r.data.length<n.exactLength.value;(o||c)&&(as(r,{code:o?$t.too_big:$t.too_small,minimum:c?n.exactLength.value:void 0,maximum:o?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),a.dirty())}if(n.minLength!==null&&r.data.length<n.minLength.value&&(as(r,{code:$t.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),a.dirty()),n.maxLength!==null&&r.data.length>n.maxLength.value&&(as(r,{code:$t.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),a.dirty()),r.common.async)return Promise.all([...r.data].map((o,c)=>n.type._parseAsync(new Cd(r,o,r.path,c)))).then(o=>to.mergeArray(a,o));const i=[...r.data].map((o,c)=>n.type._parseSync(new Cd(r,o,r.path,c)));return to.mergeArray(a,i)}get element(){return this._def.type}min(t,r){return new Pl({...this._def,minLength:{value:t,message:vs.toString(r)}})}max(t,r){return new Pl({...this._def,maxLength:{value:t,message:vs.toString(r)}})}length(t,r){return new Pl({...this._def,exactLength:{value:t,message:vs.toString(r)}})}nonempty(t){return this.min(1,t)}}Pl.create=(e,t)=>new Pl({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Qs.ZodArray,...yr(t)});function _h(e){if(e instanceof Pa){const t={};for(const r in e.shape){const a=e.shape[r];t[r]=_d.create(_h(a))}return new Pa({...e._def,shape:()=>t})}else return e instanceof Pl?new Pl({...e._def,type:_h(e.element)}):e instanceof _d?_d.create(_h(e.unwrap())):e instanceof lf?lf.create(_h(e.unwrap())):e instanceof Pu?Pu.create(e.items.map(t=>_h(t))):e}class Pa extends Ar{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=Pr.objectKeys(t);return this._cached={shape:t,keys:r},this._cached}_parse(t){if(this._getType(t)!==gs.object){const h=this._getOrReturnCtx(t);return as(h,{code:$t.invalid_type,expected:gs.object,received:h.parsedType}),Zs}const{status:a,ctx:n}=this._processInputParams(t),{shape:i,keys:o}=this._getCached(),c=[];if(!(this._def.catchall instanceof Ed&&this._def.unknownKeys==="strip"))for(const h in n.data)o.includes(h)||c.push(h);const d=[];for(const h of o){const p=i[h],x=n.data[h];d.push({key:{status:"valid",value:h},value:p._parse(new Cd(n,x,n.path,h)),alwaysSet:h in n.data})}if(this._def.catchall instanceof Ed){const h=this._def.unknownKeys;if(h==="passthrough")for(const p of c)d.push({key:{status:"valid",value:p},value:{status:"valid",value:n.data[p]}});else if(h==="strict")c.length>0&&(as(n,{code:$t.unrecognized_keys,keys:c}),a.dirty());else if(h!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const h=this._def.catchall;for(const p of c){const x=n.data[p];d.push({key:{status:"valid",value:p},value:h._parse(new Cd(n,x,n.path,p)),alwaysSet:p in n.data})}}return n.common.async?Promise.resolve().then(async()=>{const h=[];for(const p of d){const x=await p.key,v=await p.value;h.push({key:x,value:v,alwaysSet:p.alwaysSet})}return h}).then(h=>to.mergeObjectSync(a,h)):to.mergeObjectSync(a,d)}get shape(){return this._def.shape()}strict(t){return vs.errToObj,new Pa({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,a)=>{var i,o;const n=((o=(i=this._def).errorMap)==null?void 0:o.call(i,r,a).message)??a.defaultError;return r.code==="unrecognized_keys"?{message:vs.errToObj(t).message??n}:{message:n}}}:{}})}strip(){return new Pa({...this._def,unknownKeys:"strip"})}passthrough(){return new Pa({...this._def,unknownKeys:"passthrough"})}extend(t){return new Pa({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Pa({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Qs.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new Pa({...this._def,catchall:t})}pick(t){const r={};for(const a of Pr.objectKeys(t))t[a]&&this.shape[a]&&(r[a]=this.shape[a]);return new Pa({...this._def,shape:()=>r})}omit(t){const r={};for(const a of Pr.objectKeys(this.shape))t[a]||(r[a]=this.shape[a]);return new Pa({...this._def,shape:()=>r})}deepPartial(){return _h(this)}partial(t){const r={};for(const a of Pr.objectKeys(this.shape)){const n=this.shape[a];t&&!t[a]?r[a]=n:r[a]=n.optional()}return new Pa({...this._def,shape:()=>r})}required(t){const r={};for(const a of Pr.objectKeys(this.shape))if(t&&!t[a])r[a]=this.shape[a];else{let i=this.shape[a];for(;i instanceof _d;)i=i._def.innerType;r[a]=i}return new Pa({...this._def,shape:()=>r})}keyof(){return vA(Pr.objectKeys(this.shape))}}Pa.create=(e,t)=>new Pa({shape:()=>e,unknownKeys:"strip",catchall:Ed.create(),typeName:Qs.ZodObject,...yr(t)});Pa.strictCreate=(e,t)=>new Pa({shape:()=>e,unknownKeys:"strict",catchall:Ed.create(),typeName:Qs.ZodObject,...yr(t)});Pa.lazycreate=(e,t)=>new Pa({shape:e,unknownKeys:"strip",catchall:Ed.create(),typeName:Qs.ZodObject,...yr(t)});class Mx extends Ar{_parse(t){const{ctx:r}=this._processInputParams(t),a=this._def.options;function n(i){for(const c of i)if(c.result.status==="valid")return c.result;for(const c of i)if(c.result.status==="dirty")return r.common.issues.push(...c.ctx.common.issues),c.result;const o=i.map(c=>new zl(c.ctx.common.issues));return as(r,{code:$t.invalid_union,unionErrors:o}),Zs}if(r.common.async)return Promise.all(a.map(async i=>{const o={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:o}),ctx:o}})).then(n);{let i;const o=[];for(const d of a){const h={...r,common:{...r.common,issues:[]},parent:null},p=d._parseSync({data:r.data,path:r.path,parent:h});if(p.status==="valid")return p;p.status==="dirty"&&!i&&(i={result:p,ctx:h}),h.common.issues.length&&o.push(h.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;const c=o.map(d=>new zl(d));return as(r,{code:$t.invalid_union,unionErrors:c}),Zs}}get options(){return this._def.options}}Mx.create=(e,t)=>new Mx({options:e,typeName:Qs.ZodUnion,...yr(t)});function gy(e,t){const r=Xc(e),a=Xc(t);if(e===t)return{valid:!0,data:e};if(r===gs.object&&a===gs.object){const n=Pr.objectKeys(t),i=Pr.objectKeys(e).filter(c=>n.indexOf(c)!==-1),o={...e,...t};for(const c of i){const d=gy(e[c],t[c]);if(!d.valid)return{valid:!1};o[c]=d.data}return{valid:!0,data:o}}else if(r===gs.array&&a===gs.array){if(e.length!==t.length)return{valid:!1};const n=[];for(let i=0;i<e.length;i++){const o=e[i],c=t[i],d=gy(o,c);if(!d.valid)return{valid:!1};n.push(d.data)}return{valid:!0,data:n}}else return r===gs.date&&a===gs.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class Lx extends Ar{_parse(t){const{status:r,ctx:a}=this._processInputParams(t),n=(i,o)=>{if(kj(i)||kj(o))return Zs;const c=gy(i.value,o.value);return c.valid?((Rj(i)||Rj(o))&&r.dirty(),{status:r.value,value:c.data}):(as(a,{code:$t.invalid_intersection_types}),Zs)};return a.common.async?Promise.all([this._def.left._parseAsync({data:a.data,path:a.path,parent:a}),this._def.right._parseAsync({data:a.data,path:a.path,parent:a})]).then(([i,o])=>n(i,o)):n(this._def.left._parseSync({data:a.data,path:a.path,parent:a}),this._def.right._parseSync({data:a.data,path:a.path,parent:a}))}}Lx.create=(e,t,r)=>new Lx({left:e,right:t,typeName:Qs.ZodIntersection,...yr(r)});class Pu extends Ar{_parse(t){const{status:r,ctx:a}=this._processInputParams(t);if(a.parsedType!==gs.array)return as(a,{code:$t.invalid_type,expected:gs.array,received:a.parsedType}),Zs;if(a.data.length<this._def.items.length)return as(a,{code:$t.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Zs;!this._def.rest&&a.data.length>this._def.items.length&&(as(a,{code:$t.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const i=[...a.data].map((o,c)=>{const d=this._def.items[c]||this._def.rest;return d?d._parse(new Cd(a,o,a.path,c)):null}).filter(o=>!!o);return a.common.async?Promise.all(i).then(o=>to.mergeArray(r,o)):to.mergeArray(r,i)}get items(){return this._def.items}rest(t){return new Pu({...this._def,rest:t})}}Pu.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Pu({items:e,typeName:Qs.ZodTuple,rest:null,...yr(t)})};class Vj extends Ar{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:a}=this._processInputParams(t);if(a.parsedType!==gs.map)return as(a,{code:$t.invalid_type,expected:gs.map,received:a.parsedType}),Zs;const n=this._def.keyType,i=this._def.valueType,o=[...a.data.entries()].map(([c,d],h)=>({key:n._parse(new Cd(a,c,a.path,[h,"key"])),value:i._parse(new Cd(a,d,a.path,[h,"value"]))}));if(a.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const d of o){const h=await d.key,p=await d.value;if(h.status==="aborted"||p.status==="aborted")return Zs;(h.status==="dirty"||p.status==="dirty")&&r.dirty(),c.set(h.value,p.value)}return{status:r.value,value:c}})}else{const c=new Map;for(const d of o){const h=d.key,p=d.value;if(h.status==="aborted"||p.status==="aborted")return Zs;(h.status==="dirty"||p.status==="dirty")&&r.dirty(),c.set(h.value,p.value)}return{status:r.value,value:c}}}}Vj.create=(e,t,r)=>new Vj({valueType:t,keyType:e,typeName:Qs.ZodMap,...yr(r)});class pp extends Ar{_parse(t){const{status:r,ctx:a}=this._processInputParams(t);if(a.parsedType!==gs.set)return as(a,{code:$t.invalid_type,expected:gs.set,received:a.parsedType}),Zs;const n=this._def;n.minSize!==null&&a.data.size<n.minSize.value&&(as(a,{code:$t.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),r.dirty()),n.maxSize!==null&&a.data.size>n.maxSize.value&&(as(a,{code:$t.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),r.dirty());const i=this._def.valueType;function o(d){const h=new Set;for(const p of d){if(p.status==="aborted")return Zs;p.status==="dirty"&&r.dirty(),h.add(p.value)}return{status:r.value,value:h}}const c=[...a.data.values()].map((d,h)=>i._parse(new Cd(a,d,a.path,h)));return a.common.async?Promise.all(c).then(d=>o(d)):o(c)}min(t,r){return new pp({...this._def,minSize:{value:t,message:vs.toString(r)}})}max(t,r){return new pp({...this._def,maxSize:{value:t,message:vs.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}pp.create=(e,t)=>new pp({valueType:e,minSize:null,maxSize:null,typeName:Qs.ZodSet,...yr(t)});class Uj extends Ar{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}Uj.create=(e,t)=>new Uj({getter:e,typeName:Qs.ZodLazy,...yr(t)});class vy extends Ar{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return as(r,{received:r.data,code:$t.invalid_literal,expected:this._def.value}),Zs}return{status:"valid",value:t.data}}get value(){return this._def.value}}vy.create=(e,t)=>new vy({value:e,typeName:Qs.ZodLiteral,...yr(t)});function vA(e,t){return new nf({values:e,typeName:Qs.ZodEnum,...yr(t)})}class nf extends Ar{_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),a=this._def.values;return as(r,{expected:Pr.joinValues(a),received:r.parsedType,code:$t.invalid_type}),Zs}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const r=this._getOrReturnCtx(t),a=this._def.values;return as(r,{received:r.data,code:$t.invalid_enum_value,options:a}),Zs}return Ao(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return nf.create(t,{...this._def,...r})}exclude(t,r=this._def){return nf.create(this.options.filter(a=>!t.includes(a)),{...this._def,...r})}}nf.create=vA;class zj extends Ar{_parse(t){const r=Pr.getValidEnumValues(this._def.values),a=this._getOrReturnCtx(t);if(a.parsedType!==gs.string&&a.parsedType!==gs.number){const n=Pr.objectValues(r);return as(a,{expected:Pr.joinValues(n),received:a.parsedType,code:$t.invalid_type}),Zs}if(this._cache||(this._cache=new Set(Pr.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const n=Pr.objectValues(r);return as(a,{received:a.data,code:$t.invalid_enum_value,options:n}),Zs}return Ao(t.data)}get enum(){return this._def.values}}zj.create=(e,t)=>new zj({values:e,typeName:Qs.ZodNativeEnum,...yr(t)});class Fx extends Ar{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==gs.promise&&r.common.async===!1)return as(r,{code:$t.invalid_type,expected:gs.promise,received:r.parsedType}),Zs;const a=r.parsedType===gs.promise?r.data:Promise.resolve(r.data);return Ao(a.then(n=>this._def.type.parseAsync(n,{path:r.path,errorMap:r.common.contextualErrorMap})))}}Fx.create=(e,t)=>new Fx({type:e,typeName:Qs.ZodPromise,...yr(t)});class of extends Ar{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Qs.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:a}=this._processInputParams(t),n=this._def.effect||null,i={addIssue:o=>{as(a,o),o.fatal?r.abort():r.dirty()},get path(){return a.path}};if(i.addIssue=i.addIssue.bind(i),n.type==="preprocess"){const o=n.transform(a.data,i);if(a.common.async)return Promise.resolve(o).then(async c=>{if(r.value==="aborted")return Zs;const d=await this._def.schema._parseAsync({data:c,path:a.path,parent:a});return d.status==="aborted"?Zs:d.status==="dirty"||r.value==="dirty"?Am(d.value):d});{if(r.value==="aborted")return Zs;const c=this._def.schema._parseSync({data:o,path:a.path,parent:a});return c.status==="aborted"?Zs:c.status==="dirty"||r.value==="dirty"?Am(c.value):c}}if(n.type==="refinement"){const o=c=>{const d=n.refinement(c,i);if(a.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(a.common.async===!1){const c=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});return c.status==="aborted"?Zs:(c.status==="dirty"&&r.dirty(),o(c.value),{status:r.value,value:c.value})}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(c=>c.status==="aborted"?Zs:(c.status==="dirty"&&r.dirty(),o(c.value).then(()=>({status:r.value,value:c.value}))))}if(n.type==="transform")if(a.common.async===!1){const o=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});if(!af(o))return Zs;const c=n.transform(o.value,i);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:c}}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(o=>af(o)?Promise.resolve(n.transform(o.value,i)).then(c=>({status:r.value,value:c})):Zs);Pr.assertNever(n)}}of.create=(e,t,r)=>new of({schema:e,typeName:Qs.ZodEffects,effect:t,...yr(r)});of.createWithPreprocess=(e,t,r)=>new of({schema:t,effect:{type:"preprocess",transform:e},typeName:Qs.ZodEffects,...yr(r)});class _d extends Ar{_parse(t){return this._getType(t)===gs.undefined?Ao(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}_d.create=(e,t)=>new _d({innerType:e,typeName:Qs.ZodOptional,...yr(t)});class lf extends Ar{_parse(t){return this._getType(t)===gs.null?Ao(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}lf.create=(e,t)=>new lf({innerType:e,typeName:Qs.ZodNullable,...yr(t)});class yy extends Ar{_parse(t){const{ctx:r}=this._processInputParams(t);let a=r.data;return r.parsedType===gs.undefined&&(a=this._def.defaultValue()),this._def.innerType._parse({data:a,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}yy.create=(e,t)=>new yy({innerType:e,typeName:Qs.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...yr(t)});class wy extends Ar{_parse(t){const{ctx:r}=this._processInputParams(t),a={...r,common:{...r.common,issues:[]}},n=this._def.innerType._parse({data:a.data,path:a.path,parent:{...a}});return Ox(n)?n.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new zl(a.common.issues)},input:a.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new zl(a.common.issues)},input:a.data})}}removeCatch(){return this._def.innerType}}wy.create=(e,t)=>new wy({innerType:e,typeName:Qs.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...yr(t)});class $j extends Ar{_parse(t){if(this._getType(t)!==gs.nan){const a=this._getOrReturnCtx(t);return as(a,{code:$t.invalid_type,expected:gs.nan,received:a.parsedType}),Zs}return{status:"valid",value:t.data}}}$j.create=e=>new $j({typeName:Qs.ZodNaN,...yr(e)});class X9 extends Ar{_parse(t){const{ctx:r}=this._processInputParams(t),a=r.data;return this._def.type._parse({data:a,path:r.path,parent:r})}unwrap(){return this._def.type}}class tb extends Ar{_parse(t){const{status:r,ctx:a}=this._processInputParams(t);if(a.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:a.data,path:a.path,parent:a});return i.status==="aborted"?Zs:i.status==="dirty"?(r.dirty(),Am(i.value)):this._def.out._parseAsync({data:i.value,path:a.path,parent:a})})();{const n=this._def.in._parseSync({data:a.data,path:a.path,parent:a});return n.status==="aborted"?Zs:n.status==="dirty"?(r.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:a.path,parent:a})}}static create(t,r){return new tb({in:t,out:r,typeName:Qs.ZodPipeline})}}class by extends Ar{_parse(t){const r=this._def.innerType._parse(t),a=n=>(af(n)&&(n.value=Object.freeze(n.value)),n);return Ox(r)?r.then(n=>a(n)):a(r)}unwrap(){return this._def.innerType}}by.create=(e,t)=>new by({innerType:e,typeName:Qs.ZodReadonly,...yr(t)});Pa.lazycreate;var Qs;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(Qs||(Qs={}));const qn=xd.create;Ed.create;Pl.create;const yA=Pa.create;Pa.strictCreate;Mx.create;Lx.create;Pu.create;const Y9=vy.create,_y=nf.create;Fx.create;_d.create;lf.create;const jy=e=>{const t=e.replace(/\D/g,"");if(t.length!==11||/^(\d)\1{10}$/.test(t))return!1;let r=0;for(let n=0;n<9;n++)r+=parseInt(t.charAt(n))*(10-n);let a=11-r%11;if(a>=10&&(a=0),a!==parseInt(t.charAt(9)))return!1;r=0;for(let n=0;n<10;n++)r+=parseInt(t.charAt(n))*(11-n);return a=11-r%11,a>=10&&(a=0),a===parseInt(t.charAt(10))},cf=e=>{const t=e.replace(/\D/g,"");if(t.length!==14||/^(\d)\1{13}$/.test(t))return!1;let r=0,a=5;for(let i=0;i<12;i++)r+=parseInt(t.charAt(i))*a,a=a===2?9:a-1;let n=r%11<2?0:11-r%11;if(n!==parseInt(t.charAt(12)))return!1;r=0,a=6;for(let i=0;i<13;i++)r+=parseInt(t.charAt(i))*a,a=a===2?9:a-1;return n=r%11<2?0:11-r%11,n===parseInt(t.charAt(13))},wA=e=>{const t=e.replace(/\D/g,"");return t.length<=3?t:t.length<=6?`${t.slice(0,3)}.${t.slice(3)}`:t.length<=9?`${t.slice(0,3)}.${t.slice(3,6)}.${t.slice(6)}`:`${t.slice(0,3)}.${t.slice(3,6)}.${t.slice(6,9)}-${t.slice(9,11)}`},xp=e=>{const t=e.replace(/\D/g,"");return t.length<=2?t:t.length<=5?`${t.slice(0,2)}.${t.slice(2)}`:t.length<=8?`${t.slice(0,2)}.${t.slice(2,5)}.${t.slice(5)}`:t.length<=12?`${t.slice(0,2)}.${t.slice(2,5)}.${t.slice(5,8)}/${t.slice(8)}`:`${t.slice(0,2)}.${t.slice(2,5)}.${t.slice(5,8)}/${t.slice(8,12)}-${t.slice(12,14)}`},gp=e=>{const t=e.replace(/\D/g,"");return t.length<=2?t:t.length<=6?`(${t.slice(0,2)}) ${t.slice(2)}`:t.length<=10?`(${t.slice(0,2)}) ${t.slice(2,6)}-${t.slice(6)}`:`(${t.slice(0,2)}) ${t.slice(2,7)}-${t.slice(7,11)}`},vp=e=>{const t=e.replace(/\D/g,"");return t.length<=5?t:`${t.slice(0,5)}-${t.slice(5,8)}`};function Il(e){const r="/Ciclik_validacoes/".replace(/\/+$|^$/g,"").replace(/\/$/,""),a=r==="/"||r===""?"":r,n=e.startsWith("/")?e:`/${e}`;return`${window.location.origin}${a}${n}`}const Sa=e=>{const t="/Ciclik_validacoes/",r=e.startsWith("/")?e.slice(1):e;return`${t}${r}`},Z9=yA({nome:qn().min(3,"Nome deve ter no mnimo 3 caracteres"),email:qn().email("Email invlido"),password:qn().min(6,"Senha deve ter no mnimo 6 caracteres"),telefone:qn().min(10,"Telefone invlido"),tipo_pessoa:_y(["PF","PJ"]),cpf:qn().optional(),cnpj:qn().optional(),tipo_pj:qn().optional(),cep:qn().min(8,"CEP invlido"),codigo_indicador:qn().trim().toUpperCase().max(8).optional().or(Y9(""))}),uh=e=>{let t=0;return e.length>=6&&(t+=1),e.length>=8&&(t+=1),/[a-z]/.test(e)&&(t+=1),/[A-Z]/.test(e)&&(t+=1),/[0-9]/.test(e)&&(t+=1),/[^a-zA-Z0-9]/.test(e)&&(t+=1),t<=2?{score:25,label:"Fraca",color:"bg-destructive"}:t<=4?{score:50,label:"Mdia",color:"bg-yellow-500"}:t<=5?{score:75,label:"Boa",color:"bg-blue-500"}:{score:100,label:"Forte",color:"bg-green-500"}};function Q9(){const[e]=l4(),[t,r]=E.useState(!0),[a,n]=E.useState(!1),[i,o]=E.useState("PF"),[c,d]=E.useState(!1),[h,p]=E.useState(""),[x,v]=E.useState(!1),[b,N]=E.useState(!1),_=ds(),{toast:C}=_r(),{user:T}=sr(),[A,k]=E.useState({nome:"",email:"",password:"",confirmPassword:"",telefone:"",cpf:"",cnpj:"",tipo_pj:"",cep:"",logradouro:"",bairro:"",cidade:"",uf:"",numero:"",complemento:"",codigo_indicador:""});E.useEffect(()=>{const D=setTimeout(()=>{T&&!b&&_("/")},100);return()=>clearTimeout(D)},[T,b]),E.useEffect(()=>{(async()=>{const F=new URLSearchParams(window.location.hash.substring(1)),M=F.get("access_token"),z=F.get("refresh_token"),q=F.get("type"),Y=e.get("invited")==="true";if(M&&(q==="invite"||q==="magiclink"||q==="signup")){N(!0);try{const{data:je,error:H}=await J.auth.setSession({access_token:M,refresh_token:z||""});if(H){console.error("Erro ao estabelecer sesso:",H),C({title:"Erro no convite",description:"No foi possvel processar o convite. Tente novamente.",variant:"destructive"}),N(!1);return}if(je.session){const{data:Z}=await J.from("user_roles").select("role").eq("user_id",je.session.user.id);(Z==null?void 0:Z.some(Q=>Q.role==="investidor"))&&C({title:"Bem-vindo!",description:"Voc est logado como investidor."}),_("/")}}catch(je){console.error("Erro ao processar convite:",je),N(!1)}return}Y&&v(!0);const ae=e.get("ref");ae&&(k(je=>({...je,codigo_indicador:ae.toUpperCase()})),C({title:"Cdigo de indicao detectado!",description:`Voc est sendo indicado com o cdigo: ${ae.toUpperCase()}`}))})()},[e]);const I=async D=>{try{const F=D.replace(/\D/g,"");if(F.length!==8)return;const z=await(await fetch(`https://viacep.com.br/ws/${F}/json/`)).json();z.erro||k(q=>({...q,logradouro:z.logradouro||"",bairro:z.bairro||"",cidade:z.localidade||"",uf:z.uf||""}))}catch(F){console.error("Erro ao buscar CEP:",F)}},B=async D=>{D.preventDefault(),n(!0);try{if(A.password!==A.confirmPassword)throw new Error("As senhas no coincidem");const F=Z9.parse({...A,tipo_pessoa:i});if(i==="PF"){if(!A.cpf)throw new Error("CPF  obrigatrio para Pessoa Fsica");if(!jy(A.cpf))throw new Error("CPF invlido")}if(i==="PJ"){if(!A.cnpj)throw new Error("CNPJ  obrigatrio para Pessoa Jurdica");if(!cf(A.cnpj))throw new Error("CNPJ invlido");if(!A.tipo_pj)throw new Error("Tipo de PJ  obrigatrio")}const{data:M,error:z}=await J.auth.signUp({email:F.email,password:F.password,options:{emailRedirectTo:Il("/auth/confirm"),data:{nome:F.nome,email:F.email,telefone:F.telefone,tipo_pessoa:i,cpf:i==="PF"?A.cpf:null,cnpj:i==="PJ"?A.cnpj:null,tipo_pj:i==="PJ"?A.tipo_pj:null,cep:F.cep,logradouro:A.logradouro||null,bairro:A.bairro||null,cidade:A.cidade||null,uf:A.uf||null,numero:A.numero||null,complemento:A.complemento||null,codigo_indicador:A.codigo_indicador||null,role:"usuario"}}});if(z)throw console.error(" [CADASTRO] Erro ao criar usurio:",z),z;if(!M.user)throw new Error("Usurio no foi criado");C({title:" Verifique seu Email!",description:`Cadastro realizado! Enviamos um link de confirmao para ${F.email}. Confirme seu email para fazer login.`}),_("/auth/confirm")}catch(F){console.error(" [CADASTRO] Erro capturado:",F);const M=F.message==="User already registered"?"Este e-mail j est cadastrado. Faa login ou use outro e-mail.":F.message;C({title:"Erro no cadastro",description:M,variant:"destructive"})}finally{n(!1)}},O=async D=>{D.preventDefault(),n(!0);try{const{data:F,error:M}=await J.auth.signInWithPassword({email:A.email,password:A.password});if(M)throw M;if(F.user&&!F.user.email_confirmed_at){const{data:z,error:q}=await J.from("user_roles").select("role").eq("user_id",F.user.id);if(!(z==null?void 0:z.some(ae=>ae.role==="admin")))throw await J.auth.signOut(),new Error("Por favor, confirme seu email antes de fazer login. Verifique sua caixa de entrada e spam.")}if(F.session){const{data:z,error:q}=await J.from("user_roles").select("role").eq("user_id",F.session.user.id);q&&console.error("Erro ao buscar roles:",q),_("/")}}catch(F){console.error("Erro no login:",F),C({title:"Erro no login",description:F.message,variant:"destructive"})}finally{n(!1)}};return b?s.jsx("div",{className:"flex min-h-screen items-center justify-center bg-background p-4",children:s.jsx(Ne,{className:"w-full max-w-md shadow-xl rounded-3xl border-0 p-8",children:s.jsxs("div",{className:"flex flex-col items-center gap-4",children:[s.jsx(_s,{className:"h-12 w-12 animate-spin text-primary"}),s.jsx("p",{className:"text-lg font-medium text-foreground",children:"Processando seu acesso..."}),s.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Aguarde enquanto configuramos sua conta."})]})})}):s.jsxs("div",{className:"flex min-h-screen items-center justify-center bg-background p-4",children:[s.jsx("div",{className:"fixed top-4 left-4 z-50",children:s.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>{window.scrollTo(0,1),setTimeout(()=>{window.scrollTo(0,0),_("/apresentacao")},10)},className:"font-display font-medium bg-white/90 backdrop-blur-sm hover:bg-white shadow-md rounded-full gap-2",children:[s.jsx(As,{className:"w-4 h-4"}),"Voltar"]})}),s.jsxs(Ne,{className:"w-full max-w-md shadow-xl rounded-3xl border-0 overflow-hidden",children:[s.jsxs("div",{className:"pt-8 pb-6 px-6",children:[s.jsx("div",{className:"flex justify-center",children:s.jsx("img",{src:Sa("ciclik-logo-full.png"),alt:"Ciclik - Recicle e Ganhe",className:"h-24 w-auto object-contain",onError:D=>{console.error("Erro ao carregar logo, tentando fallback..."),D.currentTarget.src=Sa("ciclik-logo.png")}})}),s.jsx("p",{className:"text-center text-sm text-muted-foreground mt-4",children:"Recicle, acumule pontos e ganhe prmios"})]}),s.jsx(De,{className:"p-6 pt-4",children:s.jsxs(Mn,{value:t?"login":"signup",onValueChange:D=>r(D==="login"),children:[s.jsxs(Nn,{className:"grid w-full grid-cols-2 mb-6 h-12 rounded-xl bg-muted/50",children:[s.jsx(Gs,{value:"login",className:"rounded-lg data-[state=active]:bg-primary data-[state=active]:text-primary-foreground font-medium",children:"Entrar"}),s.jsx(Gs,{value:"signup",className:"rounded-lg data-[state=active]:bg-primary data-[state=active]:text-primary-foreground font-medium",children:"Cadastrar"})]}),s.jsx(hr,{value:"login",children:s.jsxs("form",{onSubmit:O,className:"space-y-5",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"email",className:"text-foreground font-medium text-sm",children:"Email"}),s.jsx(We,{id:"email",type:"email",placeholder:"Digite seu email",value:A.email,onChange:D=>k({...A,email:D.target.value}),required:!0,autoComplete:"email",className:"h-12 rounded-xl bg-muted/30 border-muted focus:border-primary"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"password",className:"text-foreground font-medium text-sm",children:"Senha"}),s.jsxs("div",{className:"relative",children:[s.jsx(We,{id:"password",type:c?"text":"password",placeholder:"Digite sua senha",value:A.password,onChange:D=>k({...A,password:D.target.value}),required:!0,autoComplete:"current-password",className:"h-12 pr-12 rounded-xl bg-muted/30 border-muted focus:border-primary"}),s.jsx(oe,{type:"button",variant:"ghost",size:"icon",className:"absolute right-1 top-1 h-10 w-10 rounded-lg hover:bg-muted",onClick:()=>d(!c),tabIndex:-1,children:c?s.jsx(Mm,{className:"h-4 w-4 text-muted-foreground"}):s.jsx(ki,{className:"h-4 w-4 text-muted-foreground"})})]}),s.jsx(c4,{to:"/forgot-password",className:"text-sm text-primary hover:text-primary/80 block text-right font-medium",children:"Esqueceu a senha?"})]}),s.jsxs(oe,{type:"submit",className:"w-full h-12 bg-primary hover:bg-primary/90 text-primary-foreground rounded-xl font-semibold shadow-lg shadow-primary/25 transition-all hover:shadow-xl hover:shadow-primary/30",disabled:a,children:[a&&s.jsx(_s,{className:"mr-2 h-4 w-4 animate-spin"}),"Entrar"]})]})}),s.jsx(hr,{value:"signup",children:s.jsxs("form",{onSubmit:B,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2 animate-fade-in",style:{animationDelay:"0ms"},children:[s.jsx(ke,{children:"Tipo de Pessoa"}),s.jsxs(qs,{value:i,onValueChange:D=>o(D),children:[s.jsx(Ls,{children:s.jsx(Ws,{})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"PF",children:"Pessoa Fsica"}),s.jsx(xt,{value:"PJ",children:"Pessoa Jurdica"})]})]})]}),i==="PJ"&&s.jsxs("div",{className:"space-y-2 animate-fade-in",style:{animationDelay:"50ms"},children:[s.jsx(ke,{children:"Tipo de Empresa"}),s.jsxs(qs,{value:A.tipo_pj,onValueChange:D=>k({...A,tipo_pj:D}),children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Selecione"})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"Condominio",children:"Condomnio"}),s.jsx(xt,{value:"Restaurante",children:"Restaurante"}),s.jsx(xt,{value:"Comercio",children:"Comrcio"}),s.jsx(xt,{value:"Servico",children:"Servio"}),s.jsx(xt,{value:"Industria",children:"Indstria"}),s.jsx(xt,{value:"Outro",children:"Outro"})]})]})]}),s.jsxs("div",{className:"space-y-2 animate-fade-in",style:{animationDelay:"50ms"},children:[s.jsxs(ke,{children:["Nome ",i==="PJ"&&"da Empresa"]}),s.jsx(We,{value:A.nome,onChange:D=>k({...A,nome:D.target.value}),required:!0})]}),s.jsxs("div",{className:"space-y-2 animate-fade-in",style:{animationDelay:"100ms"},children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(ke,{children:"Email"}),s.jsx(Zo,{children:s.jsxs(Xn,{children:[s.jsx(Yn,{type:"button",tabIndex:-1,children:s.jsx(Yi,{className:"h-4 w-4 text-muted-foreground hover:text-primary transition-colors"})}),s.jsx(kn,{className:"max-w-[250px] text-center",children:s.jsx("p",{children:"Usamos seu email para validar sua conta e enviar informaes importantes sobre suas entregas e pontos."})})]})})]}),s.jsx(We,{type:"email",value:A.email,onChange:D=>k({...A,email:D.target.value}),required:!0,autoComplete:"email",placeholder:"seu@email.com"})]}),s.jsxs("div",{className:"space-y-2 animate-fade-in",style:{animationDelay:"150ms"},children:[s.jsx(ke,{children:"Senha (mnimo 6 caracteres)"}),s.jsxs("div",{className:"relative",children:[s.jsx(We,{type:c?"text":"password",value:A.password,onChange:D=>k({...A,password:D.target.value}),required:!0,minLength:6,autoComplete:"new-password",className:"pr-10"}),s.jsx(oe,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>d(!c),tabIndex:-1,children:c?s.jsx(Mm,{className:"h-4 w-4 text-muted-foreground"}):s.jsx(ki,{className:"h-4 w-4 text-muted-foreground"})})]}),A.password&&s.jsxs("div",{className:"space-y-1.5",children:[s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsx("span",{className:"text-muted-foreground",children:"Fora da senha:"}),s.jsx("span",{className:`font-medium ${uh(A.password).label==="Fraca"?"text-destructive":uh(A.password).label==="Mdia"?"text-yellow-600":uh(A.password).label==="Boa"?"text-blue-600":"text-green-600"}`,children:uh(A.password).label})]}),s.jsx("div",{className:"h-1.5 w-full bg-muted rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full transition-all duration-300 ${uh(A.password).color}`,style:{width:`${uh(A.password).score}%`}})}),s.jsxs("div",{className:"grid grid-cols-2 gap-1 text-xs text-muted-foreground",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[A.password.length>=6?s.jsx(Ea,{className:"h-3 w-3 text-green-500"}):s.jsx(Jr,{className:"h-3 w-3 text-destructive"}),s.jsx("span",{children:"Mnimo 6 caracteres"})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[/[A-Z]/.test(A.password)?s.jsx(Ea,{className:"h-3 w-3 text-green-500"}):s.jsx(Jr,{className:"h-3 w-3 text-muted-foreground/50"}),s.jsx("span",{children:"Letra maiscula"})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[/[0-9]/.test(A.password)?s.jsx(Ea,{className:"h-3 w-3 text-green-500"}):s.jsx(Jr,{className:"h-3 w-3 text-muted-foreground/50"}),s.jsx("span",{children:"Nmero"})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[/[^a-zA-Z0-9]/.test(A.password)?s.jsx(Ea,{className:"h-3 w-3 text-green-500"}):s.jsx(Jr,{className:"h-3 w-3 text-muted-foreground/50"}),s.jsx("span",{children:"Caractere especial"})]})]})]})]}),s.jsxs("div",{className:"space-y-2 animate-fade-in",style:{animationDelay:"200ms"},children:[s.jsx(ke,{children:"Confirmar Senha"}),s.jsxs("div",{className:"relative",children:[s.jsx(We,{type:c?"text":"password",value:A.confirmPassword,onChange:D=>k({...A,confirmPassword:D.target.value}),required:!0,minLength:6,autoComplete:"new-password",placeholder:"Digite a senha novamente",className:"pr-10"}),s.jsx(oe,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>d(!c),tabIndex:-1,children:c?s.jsx(Mm,{className:"h-4 w-4 text-muted-foreground"}):s.jsx(ki,{className:"h-4 w-4 text-muted-foreground"})})]}),A.confirmPassword&&A.password!==A.confirmPassword&&s.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1",children:[s.jsx(Jr,{className:"h-3 w-3"}),"As senhas no coincidem"]}),A.confirmPassword&&A.password===A.confirmPassword&&A.password.length>=6&&s.jsxs("p",{className:"text-xs text-green-600 flex items-center gap-1",children:[s.jsx(Ea,{className:"h-3 w-3"}),"Senhas coincidem"]})]}),s.jsxs("div",{className:"space-y-2 animate-fade-in",style:{animationDelay:"250ms"},children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(ke,{children:"Telefone"}),s.jsx(Zo,{children:s.jsxs(Xn,{children:[s.jsx(Yn,{type:"button",tabIndex:-1,children:s.jsx(Yi,{className:"h-4 w-4 text-muted-foreground hover:text-primary transition-colors"})}),s.jsx(kn,{className:"max-w-[250px] text-center",children:s.jsx("p",{children:"No enviamos propaganda. Seu telefone  usado apenas para identificao nas entregas de reciclveis."})})]})})]}),s.jsx(We,{value:A.telefone,onChange:D=>{const F=gp(D.target.value);k({...A,telefone:F})},placeholder:"(00) 00000-0000",maxLength:15,required:!0})]}),s.jsxs("div",{className:"space-y-2 animate-fade-in",style:{animationDelay:"300ms"},children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(ke,{children:i==="PF"?"CPF":"CNPJ"}),i==="PF"&&s.jsx(Zo,{children:s.jsxs(Xn,{children:[s.jsx(Yn,{type:"button",tabIndex:-1,children:s.jsx(Yi,{className:"h-4 w-4 text-muted-foreground hover:text-primary transition-colors"})}),s.jsx(kn,{className:"max-w-[250px] text-center",children:s.jsx("p",{children:"Pedimos seu CPF para garantir que seus benefcios e cashback vo diretamente para voc, com segurana."})})]})})]}),s.jsx(We,{value:i==="PF"?A.cpf:A.cnpj,onChange:D=>{const F=i==="PF"?"cpf":"cnpj",M=i==="PF"?wA(D.target.value):xp(D.target.value);k({...A,[F]:M});const z=D.target.value.replace(/\D/g,"");i==="PF"&&z.length===11?p(jy(D.target.value)?"":"CPF invlido"):i==="PJ"&&z.length===14?p(cf(D.target.value)?"":"CNPJ invlido"):p("")},maxLength:i==="PF"?14:18,className:h?"border-destructive":"",required:!0}),h&&s.jsx("p",{className:"text-sm text-destructive",children:h})]}),s.jsxs("div",{className:"space-y-2 animate-fade-in",style:{animationDelay:"350ms"},children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(ke,{children:"CEP"}),s.jsx(Zo,{children:s.jsxs(Xn,{children:[s.jsx(Yn,{type:"button",tabIndex:-1,children:s.jsx(Yi,{className:"h-4 w-4 text-muted-foreground hover:text-primary transition-colors"})}),s.jsx(kn,{className:"max-w-[250px] text-center",children:s.jsx("p",{children:"Usamos seu CEP para encontrar o operador logstico mais prximo para suas entregas de reciclveis."})})]})})]}),s.jsx(We,{value:A.cep,onChange:D=>{const F=vp(D.target.value);k({...A,cep:F}),D.target.value.replace(/\D/g,"").length===8&&I(D.target.value)},placeholder:"00000-000",maxLength:9,required:!0})]}),A.logradouro&&s.jsxs("div",{className:"animate-fade-in",style:{animationDelay:"400ms"},children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{children:"Cidade"}),s.jsx(We,{value:A.cidade,disabled:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{children:"UF"}),s.jsx(We,{value:A.uf,disabled:!0})]})]}),s.jsxs("div",{className:"space-y-2 mb-4",children:[s.jsx(ke,{children:"Logradouro"}),s.jsx(We,{value:A.logradouro,disabled:!0})]}),s.jsxs("div",{className:"space-y-2 mb-4",children:[s.jsx(ke,{children:"Bairro"}),s.jsx(We,{value:A.bairro,disabled:!0})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{children:"Nmero"}),s.jsx(We,{value:A.numero,onChange:D=>k({...A,numero:D.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{children:"Complemento"}),s.jsx(We,{value:A.complemento,onChange:D=>k({...A,complemento:D.target.value})})]})]})]}),s.jsxs("div",{className:"space-y-2 animate-fade-in",style:{animationDelay:"450ms"},children:[s.jsx(ke,{children:"Cdigo de Indicao (opcional)"}),s.jsx(We,{value:A.codigo_indicador,onChange:D=>k({...A,codigo_indicador:D.target.value.toUpperCase()}),placeholder:"Ex: ABC12345",maxLength:8,className:"font-mono uppercase"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Tem um cdigo de indicao? Insira aqui para voc e seu amigo ganharem pontos!"})]}),s.jsxs(oe,{type:"submit",className:"w-full animate-fade-in",style:{animationDelay:"500ms"},disabled:a,children:[a&&s.jsx(_s,{className:"mr-2 h-4 w-4 animate-spin"}),"Criar Conta"]})]})})]})})]})]})}function J9(){const[e,t]=E.useState(""),[r,a]=E.useState(!1),[n,i]=E.useState(!1),{toast:o}=_r(),c=async d=>{d.preventDefault(),a(!0);try{const{error:h}=await J.auth.resetPasswordForEmail(e,{redirectTo:Il("/reset-password")});if(h)throw h;i(!0),o({title:"E-mail enviado!",description:"Verifique sua caixa de entrada para redefinir sua senha."})}catch(h){o({title:"Erro ao enviar e-mail",description:h.message,variant:"destructive"})}finally{a(!1)}};return s.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-green-50 via-white to-green-50",children:s.jsxs(Ne,{className:"w-full max-w-md",children:[s.jsxs(Ye,{className:"space-y-1 flex flex-col items-center",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center mb-2",children:s.jsx(cr,{className:"w-6 h-6 text-primary"})}),s.jsx(Qe,{className:"text-2xl font-bold text-center",children:"Recuperar Senha"}),s.jsx(Tt,{className:"text-center",children:n?"E-mail enviado! Verifique sua caixa de entrada.":"Digite seu e-mail para receber o link de recuperao"})]}),s.jsxs(De,{children:[n?s.jsxs("div",{className:"space-y-4 text-center",children:[s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Enviamos um e-mail para ",s.jsx("strong",{children:e})," com instrues para redefinir sua senha."]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"No recebeu o e-mail? Verifique sua pasta de spam ou tente novamente em alguns minutos."}),s.jsx(oe,{variant:"outline",className:"w-full",onClick:()=>{i(!1),t("")},children:"Tentar outro e-mail"})]}):s.jsxs("form",{onSubmit:c,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"email",children:"Email"}),s.jsx(We,{id:"email",type:"email",placeholder:"seu@email.com",value:e,onChange:d=>t(d.target.value),required:!0,autoComplete:"email"})]}),s.jsx(oe,{type:"submit",className:"w-full",disabled:r,children:r?"Enviando...":"Enviar Link de Recuperao"})]}),s.jsx("div",{className:"mt-6",children:s.jsx(c4,{to:"/auth",children:s.jsxs(oe,{variant:"ghost",className:"w-full",children:[s.jsx(As,{className:"mr-2 h-4 w-4"}),"Voltar para o login"]})})})]})]})})}function eB(){const[e,t]=E.useState(""),[r,a]=E.useState(""),[n,i]=E.useState(!1),[o,c]=E.useState(!1),[d,h]=E.useState(!1),[p,x]=E.useState(!0),v=ds(),{toast:b}=_r();E.useEffect(()=>{(async()=>{const C=new URLSearchParams(window.location.hash.substring(1)),T=new URLSearchParams(window.location.search),A=C.get("access_token")||T.get("access_token"),k=C.get("refresh_token")||T.get("refresh_token"),I=C.get("type")||T.get("type");if(console.log("=== DIAGNSTICO DE LINK DE RECUPERAO ==="),console.log("URL completa:",window.location.href),console.log("Hash params:",window.location.hash),console.log("Query params:",window.location.search),console.log("Type:",I),console.log("Tem access_token?:",!!A),console.log("Tem refresh_token?:",!!k),A&&console.log("Access token (primeiros 50 chars):",A.substring(0,50)+"..."),console.log("=========================================="),A&&I==="recovery"){console.log(" Tokens de recovery detectados - processando..."),console.log(" Estabelecendo nova sesso com token de recovery...");try{const{data:D}=await J.auth.getSession();D.session?(console.log(" HAVIA SESSO ATIVA ANTES DO RECOVERY!"),console.log("   Usurio logado:",D.session.user.email),console.log("   User ID:",D.session.user.id),console.log("   Sesso expira em:",new Date(D.session.expires_at*1e3).toLocaleString())):console.log(" Nenhuma sesso ativa encontrada - tudo OK"),console.log(" Substituindo sesso atual pela sesso de recovery...");const{data:F,error:M}=await J.auth.setSession({access_token:A,refresh_token:k||""});M?(console.error(" ERRO ao estabelecer sesso:",M),console.error("Tipo do erro:",M.name),console.error("Mensagem:",M.message),console.error("Status:",M.status),console.error("Detalhes completos:",JSON.stringify(M,null,2)),b({title:"Erro",description:"Link de recuperao invlido ou expirado.",variant:"destructive"}),h(!1)):F.session?(console.log(" Sesso estabelecida com SUCESSO!"),console.log("Email do usurio:",F.session.user.email),console.log("User ID:",F.session.user.id),h(!0)):(console.warn(" SetSession retornou sem erro, mas sem sesso"),h(!1))}catch(D){console.error(" Erro inesperado ao processar token:",D),b({title:"Erro",description:"No foi possvel processar o link de recuperao.",variant:"destructive"}),h(!1)}x(!1);return}console.log(" No h tokens de recovery na URL - verificando outras formas de autenticao...");const{data:{subscription:B}}=J.auth.onAuthStateChange((D,F)=>{D==="PASSWORD_RECOVERY"||D==="SIGNED_IN"?(h(!0),x(!1)):D==="SIGNED_OUT"&&h(!1)}),{data:{session:O}}=await J.auth.getSession();return O&&h(!0),x(!1),()=>B.unsubscribe()})()},[]);const N=async _=>{if(_.preventDefault(),e!==r){b({title:"Erro",description:"As senhas no coincidem.",variant:"destructive"});return}if(e.length<6){b({title:"Erro",description:"A senha deve ter no mnimo 6 caracteres.",variant:"destructive"});return}i(!0);try{const{data:{session:C}}=await J.auth.getSession(),{error:T}=await J.auth.updateUser({password:e});if(T)throw T;b({title:"Senha definida com sucesso!",description:"Voc ser redirecionado para a pgina de login."}),await J.auth.signOut(),setTimeout(()=>{v("/auth")},2e3)}catch(C){console.error("Erro ao definir senha:",C),b({title:"Erro ao definir senha",description:C.message,variant:"destructive"})}finally{i(!1)}};return p?s.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-green-50 via-white to-green-50",children:s.jsxs("div",{className:"flex flex-col items-center gap-4",children:[s.jsx(_s,{className:"w-8 h-8 animate-spin text-primary"}),s.jsx("p",{className:"text-muted-foreground",children:"Verificando seu acesso..."})]})}):d?s.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-green-50 via-white to-green-50",children:s.jsxs(Ne,{className:"w-full max-w-md",children:[s.jsxs(Ye,{className:"space-y-1 flex flex-col items-center",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center mb-2",children:s.jsx(cr,{className:"w-6 h-6 text-primary"})}),s.jsx(Qe,{className:"text-2xl font-bold text-center",children:"Bem-vindo ao Ciclik!"}),s.jsx(Tt,{className:"text-center",children:"Defina sua senha para acessar o sistema"})]}),s.jsx(De,{children:s.jsxs("form",{onSubmit:N,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"password",children:"Senha"}),s.jsxs("div",{className:"relative",children:[s.jsx(We,{id:"password",type:o?"text":"password",placeholder:"",value:e,onChange:_=>t(_.target.value),required:!0,minLength:6,autoComplete:"new-password",className:"pr-10"}),s.jsx(oe,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>c(!o),tabIndex:-1,children:o?s.jsx(Mm,{className:"h-4 w-4 text-muted-foreground"}):s.jsx(ki,{className:"h-4 w-4 text-muted-foreground"})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"confirmPassword",children:"Confirmar Senha"}),s.jsxs("div",{className:"relative",children:[s.jsx(We,{id:"confirmPassword",type:o?"text":"password",placeholder:"",value:r,onChange:_=>a(_.target.value),required:!0,minLength:6,autoComplete:"new-password",className:"pr-10"}),s.jsx(oe,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>c(!o),tabIndex:-1,children:o?s.jsx(Mm,{className:"h-4 w-4 text-muted-foreground"}):s.jsx(ki,{className:"h-4 w-4 text-muted-foreground"})})]})]}),s.jsx(oe,{type:"submit",className:"w-full",disabled:n,children:n?s.jsxs(s.Fragment,{children:[s.jsx(_s,{className:"w-4 h-4 mr-2 animate-spin"}),"Salvando..."]}):"Definir Senha e Entrar"})]})})]})}):s.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-green-50 via-white to-green-50",children:s.jsxs(Ne,{className:"w-full max-w-md",children:[s.jsxs(Ye,{className:"space-y-1 flex flex-col items-center",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-destructive/10 flex items-center justify-center mb-2",children:s.jsx(cr,{className:"w-6 h-6 text-destructive"})}),s.jsx(Qe,{className:"text-2xl font-bold text-center",children:"Link Invlido ou Expirado"}),s.jsx(Tt,{className:"text-center",children:"Este link de acesso no  mais vlido. Solicite um novo convite ao administrador."})]}),s.jsx(De,{children:s.jsx(oe,{className:"w-full",onClick:()=>v("/auth"),children:"Ir para Login"})})]})})}function sb(){const{user:e}=sr(),[t,r]=E.useState(0),[a,n]=E.useState(!0),[i,o]=E.useState({missoes:0,notasFiscais:0,materiaisCadastrados:0,entregasValidadas:0,indicacoes:0,cuponsResgatados:0}),c=E.useCallback(async()=>{if(!e){n(!1);return}const d=`points_cache_${e.id}`,h=`points_last_calc_${e.id}`,p=sessionStorage.getItem(d),x=sessionStorage.getItem(h);if(p&&x&&Date.now()-parseInt(x)<3e4){const b=JSON.parse(p);r(b.pontos),o(b.breakdown),n(!1);return}try{n(!0);const{data:v}=await J.from("configuracoes_sistema").select("chave, valor").like("chave","pontos_%"),b={};v==null||v.forEach(je=>{b[je.chave]=parseInt(je.valor)});let N=0;const _={missoes:0,notasFiscais:0,materiaisCadastrados:0,entregasValidadas:0,indicacoes:0,cuponsResgatados:0},{data:C}=await J.from("missoes_usuarios").select("id").eq("id_usuario",e.id),T=b.pontos_missao_completa??0;_.missoes=((C==null?void 0:C.length)||0)*T,N+=_.missoes;const{data:A}=await J.from("notas_fiscais").select("id").eq("id_usuario",e.id).eq("status_validacao","validada"),k=b.pontos_nota_fiscal_validada??0;_.notasFiscais=((A==null?void 0:A.length)||0)*k,N+=_.notasFiscais;const{data:I}=await J.from("materiais_reciclaveis_usuario").select("id, origem_cadastro").eq("id_usuario",e.id),B=b.pontos_material_cadastro_nota??0,O=b.pontos_material_cadastro_manual??0;I==null||I.forEach(je=>{const H=je.origem_cadastro==="nota_fiscal"?B:O;_.materiaisCadastrados+=H}),N+=_.materiaisCadastrados;const{data:D}=await J.from("entregas_reciclaveis").select("peso_validado, tipo_material").eq("id_usuario",e.id).eq("status","validada"),F=b.pontos_base_entrega_6kg??20;let M=0;D==null||D.forEach(je=>{je.peso_validado&&je.peso_validado>0&&(M+=je.peso_validado)}),_.entregasValidadas=Math.round(M/6*F),N+=_.entregasValidadas;const{data:z}=await J.from("indicacoes").select("pontos_cadastro_concedidos, pontos_primeira_missao_concedidos").eq("id_indicador",e.id),q=b.pontos_indicacao_cadastro??0,Y=b.pontos_indicacao_primeira_missao??0;z==null||z.forEach(je=>{je.pontos_cadastro_concedidos&&(_.indicacoes+=q),je.pontos_primeira_missao_concedidos&&(_.indicacoes+=Y)}),N+=_.indicacoes;const{data:ae}=await J.from("cupons_resgates").select("pontos_utilizados").eq("id_usuario",e.id);if(ae==null||ae.forEach(je=>{_.cuponsResgatados+=je.pontos_utilizados}),N-=_.cuponsResgatados,r(N),o(_),e){const je=`points_cache_${e.id}`,H=`points_last_calc_${e.id}`;sessionStorage.setItem(je,JSON.stringify({pontos:N,breakdown:_})),sessionStorage.setItem(H,Date.now().toString())}}catch(v){console.error("Erro ao calcular pontos:",v)}finally{n(!1)}},[e==null?void 0:e.id]);return E.useEffect(()=>{c()},[e==null?void 0:e.id]),{pontos:t,loading:a,breakdown:i,refetch:c}}const Br=(e,t=2)=>e.toLocaleString("pt-BR",{minimumFractionDigits:t,maximumFractionDigits:t}),rb=e=>e.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),B1=(e,t=1)=>`${Br(e,t)}%`,gr=(e,t=2)=>`${Br(e,t)} kg`;var ab="Progress",nb=100,[tB,zue]=bi(ab),[sB,rB]=tB(ab),bA=E.forwardRef((e,t)=>{const{__scopeProgress:r,value:a=null,max:n,getValueLabel:i=aB,...o}=e;(n||n===0)&&!qj(n)&&console.error(nB(`${n}`,"Progress"));const c=qj(n)?n:nb;a!==null&&!Wj(a,c)&&console.error(iB(`${a}`,"Progress"));const d=Wj(a,c)?a:null,h=Bx(d)?i(d,c):void 0;return s.jsx(sB,{scope:r,value:d,max:c,children:s.jsx(ys.div,{"aria-valuemax":c,"aria-valuemin":0,"aria-valuenow":Bx(d)?d:void 0,"aria-valuetext":h,role:"progressbar","data-state":NA(d,c),"data-value":d??void 0,"data-max":c,...o,ref:t})})});bA.displayName=ab;var _A="ProgressIndicator",jA=E.forwardRef((e,t)=>{const{__scopeProgress:r,...a}=e,n=rB(_A,r);return s.jsx(ys.div,{"data-state":NA(n.value,n.max),"data-value":n.value??void 0,"data-max":n.max,...a,ref:t})});jA.displayName=_A;function aB(e,t){return`${Math.round(e/t*100)}%`}function NA(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function Bx(e){return typeof e=="number"}function qj(e){return Bx(e)&&!isNaN(e)&&e>0}function Wj(e,t){return Bx(e)&&!isNaN(e)&&e<=t&&e>=0}function nB(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${nb}\`.`}function iB(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${nb} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var CA=bA,oB=jA;const fn=E.forwardRef(({className:e,value:t,variant:r="default",...a},n)=>s.jsx(CA,{ref:n,className:pt("relative h-3 w-full overflow-hidden rounded-full bg-secondary",e),...a,children:s.jsx(oB,{className:pt("h-full w-full flex-1 rounded-full transition-all duration-500 ease-out",r==="default"&&"bg-primary",r==="accent"&&"bg-accent"),style:{transform:`translateX(-${100-(t||0)}%)`}})}));fn.displayName=CA.displayName;const lB=Pf("inline-flex items-center gap-1.5 rounded-full px-3 py-1 text-xs font-display font-medium transition-colors",{variants:{variant:{default:"bg-primary/15 text-primary",accent:"bg-accent/20 text-accent-foreground",success:"bg-success text-success-foreground",warning:"bg-warning text-warning-foreground",secondary:"bg-secondary text-secondary-foreground",muted:"bg-muted text-muted-foreground",destructive:"bg-destructive/15 text-destructive",outline:"border border-primary text-primary bg-transparent","outline-accent":"border border-accent text-accent bg-transparent"}},defaultVariants:{variant:"default"}}),Je=E.forwardRef(({className:e,variant:t,...r},a)=>s.jsx("div",{ref:a,className:pt(lB({variant:t}),e),...r}));Je.displayName="Badge";const ib=E.createContext({});function Kp(e){const t=E.useRef(null);return t.current===null&&(t.current=e()),t.current}const ob=typeof window<"u",lb=ob?E.useLayoutEffect:E.useEffect,Ig=E.createContext(null);function cb(e,t){e.indexOf(t)===-1&&e.push(t)}function Og(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const vc=(e,t,r)=>r>t?t:r<e?e:r;let Vx=()=>{};const yc={},EA=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function SA(e){return typeof e=="object"&&e!==null}const TA=e=>/^0[^.\s]+$/u.test(e);function db(e){let t;return()=>(t===void 0&&(t=e()),t)}const jo=e=>e,cB=(e,t)=>r=>t(e(r)),Xp=(...e)=>e.reduce(cB),df=(e,t,r)=>{const a=t-e;return a===0?1:(r-e)/a};class ub{constructor(){this.subscriptions=[]}add(t){return cb(this.subscriptions,t),()=>Og(this.subscriptions,t)}notify(t,r,a){const n=this.subscriptions.length;if(n)if(n===1)this.subscriptions[0](t,r,a);else for(let i=0;i<n;i++){const o=this.subscriptions[i];o&&o(t,r,a)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const sl=e=>e*1e3,bo=e=>e/1e3;function AA(e,t){return t?e*(1e3/t):0}const dB=(e,t,r)=>{const a=t-e;return((r-e)%a+a)%a+e},kA=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,uB=1e-7,hB=12;function fB(e,t,r,a,n){let i,o,c=0;do o=t+(r-t)/2,i=kA(o,a,n)-e,i>0?r=o:t=o;while(Math.abs(i)>uB&&++c<hB);return o}function Yp(e,t,r,a){if(e===t&&r===a)return jo;const n=i=>fB(i,0,1,e,r);return i=>i===0||i===1?i:kA(n(i),t,a)}const RA=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,PA=e=>t=>1-e(1-t),IA=Yp(.33,1.53,.69,.99),hb=PA(IA),OA=RA(hb),DA=e=>(e*=2)<1?.5*hb(e):.5*(2-Math.pow(2,-10*(e-1))),fb=e=>1-Math.sin(Math.acos(e)),MA=PA(fb),LA=RA(fb),mB=Yp(.42,0,1,1),pB=Yp(0,0,.58,1),FA=Yp(.42,0,.58,1),BA=e=>Array.isArray(e)&&typeof e[0]!="number";function VA(e,t){return BA(e)?e[dB(0,e.length,t)]:e}const UA=e=>Array.isArray(e)&&typeof e[0]=="number",Hj={linear:jo,easeIn:mB,easeInOut:FA,easeOut:pB,circIn:fb,circInOut:LA,circOut:MA,backIn:hb,backInOut:OA,backOut:IA,anticipate:DA},xB=e=>typeof e=="string",Gj=e=>{if(UA(e)){Vx(e.length===4);const[t,r,a,n]=e;return Yp(t,r,a,n)}else if(xB(e))return Vx(Hj[e]!==void 0),Hj[e];return e},L0=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],Kj={value:null,addProjectionMetrics:null};function gB(e,t){let r=new Set,a=new Set,n=!1,i=!1;const o=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1},d=0;function h(x){o.has(x)&&(p.schedule(x),e()),d++,x(c)}const p={schedule:(x,v=!1,b=!1)=>{const _=b&&n?r:a;return v&&o.add(x),_.has(x)||_.add(x),x},cancel:x=>{a.delete(x),o.delete(x)},process:x=>{if(c=x,n){i=!0;return}n=!0,[r,a]=[a,r],r.forEach(h),t&&Kj.value&&Kj.value.frameloop[t].push(d),d=0,r.clear(),n=!1,i&&(i=!1,p.process(x))}};return p}const vB=40;function zA(e,t){let r=!1,a=!0;const n={delta:0,timestamp:0,isProcessing:!1},i=()=>r=!0,o=L0.reduce((k,I)=>(k[I]=gB(i,t?I:void 0),k),{}),{setup:c,read:d,resolveKeyframes:h,preUpdate:p,update:x,preRender:v,render:b,postRender:N}=o,_=()=>{const k=yc.useManualTiming?n.timestamp:performance.now();r=!1,yc.useManualTiming||(n.delta=a?1e3/60:Math.max(Math.min(k-n.timestamp,vB),1)),n.timestamp=k,n.isProcessing=!0,c.process(n),d.process(n),h.process(n),p.process(n),x.process(n),v.process(n),b.process(n),N.process(n),n.isProcessing=!1,r&&t&&(a=!1,e(_))},C=()=>{r=!0,a=!0,n.isProcessing||e(_)};return{schedule:L0.reduce((k,I)=>{const B=o[I];return k[I]=(O,D=!1,F=!1)=>(r||C(),B.schedule(O,D,F)),k},{}),cancel:k=>{for(let I=0;I<L0.length;I++)o[L0[I]].cancel(k)},state:n,steps:o}}const{schedule:ga,cancel:wc,state:Tn,steps:V1}=zA(typeof requestAnimationFrame<"u"?requestAnimationFrame:jo,!0);let hx;function yB(){hx=void 0}const Si={now:()=>(hx===void 0&&Si.set(Tn.isProcessing||yc.useManualTiming?Tn.timestamp:performance.now()),hx),set:e=>{hx=e,queueMicrotask(yB)}},$A=e=>t=>typeof t=="string"&&t.startsWith(e),mb=$A("--"),wB=$A("var(--"),pb=e=>wB(e)?bB.test(e.split("/*")[0].trim()):!1,bB=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Ff={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},yp={...Ff,transform:e=>vc(0,1,e)},F0={...Ff,default:1},Bm=e=>Math.round(e*1e5)/1e5,xb=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function _B(e){return e==null}const jB=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,gb=(e,t)=>r=>!!(typeof r=="string"&&jB.test(r)&&r.startsWith(e)||t&&!_B(r)&&Object.prototype.hasOwnProperty.call(r,t)),qA=(e,t,r)=>a=>{if(typeof a!="string")return a;const[n,i,o,c]=a.match(xb);return{[e]:parseFloat(n),[t]:parseFloat(i),[r]:parseFloat(o),alpha:c!==void 0?parseFloat(c):1}},NB=e=>vc(0,255,e),U1={...Ff,transform:e=>Math.round(NB(e))},cu={test:gb("rgb","red"),parse:qA("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:a=1})=>"rgba("+U1.transform(e)+", "+U1.transform(t)+", "+U1.transform(r)+", "+Bm(yp.transform(a))+")"};function CB(e){let t="",r="",a="",n="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),a=e.substring(5,7),n=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),a=e.substring(3,4),n=e.substring(4,5),t+=t,r+=r,a+=a,n+=n),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(a,16),alpha:n?parseInt(n,16)/255:1}}const Ny={test:gb("#"),parse:CB,transform:cu.transform},Zp=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Wc=Zp("deg"),Ol=Zp("%"),Us=Zp("px"),EB=Zp("vh"),SB=Zp("vw"),Xj={...Ol,parse:e=>Ol.parse(e)/100,transform:e=>Ol.transform(e*100)},Th={test:gb("hsl","hue"),parse:qA("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:a=1})=>"hsla("+Math.round(e)+", "+Ol.transform(Bm(t))+", "+Ol.transform(Bm(r))+", "+Bm(yp.transform(a))+")"},Ga={test:e=>cu.test(e)||Ny.test(e)||Th.test(e),parse:e=>cu.test(e)?cu.parse(e):Th.test(e)?Th.parse(e):Ny.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?cu.transform(e):Th.transform(e),getAnimatableNone:e=>{const t=Ga.parse(e);return t.alpha=0,Ga.transform(t)}},TB=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function AB(e){var t,r;return isNaN(e)&&typeof e=="string"&&(((t=e.match(xb))==null?void 0:t.length)||0)+(((r=e.match(TB))==null?void 0:r.length)||0)>0}const WA="number",HA="color",kB="var",RB="var(",Yj="${}",PB=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function wp(e){const t=e.toString(),r=[],a={color:[],number:[],var:[]},n=[];let i=0;const c=t.replace(PB,d=>(Ga.test(d)?(a.color.push(i),n.push(HA),r.push(Ga.parse(d))):d.startsWith(RB)?(a.var.push(i),n.push(kB),r.push(d)):(a.number.push(i),n.push(WA),r.push(parseFloat(d))),++i,Yj)).split(Yj);return{values:r,split:c,indexes:a,types:n}}function GA(e){return wp(e).values}function KA(e){const{split:t,types:r}=wp(e),a=t.length;return n=>{let i="";for(let o=0;o<a;o++)if(i+=t[o],n[o]!==void 0){const c=r[o];c===WA?i+=Bm(n[o]):c===HA?i+=Ga.transform(n[o]):i+=n[o]}return i}}const IB=e=>typeof e=="number"?0:Ga.test(e)?Ga.getAnimatableNone(e):e;function OB(e){const t=GA(e);return KA(e)(t.map(IB))}const Sd={test:AB,parse:GA,createTransformer:KA,getAnimatableNone:OB};function z1(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function DB({hue:e,saturation:t,lightness:r,alpha:a}){e/=360,t/=100,r/=100;let n=0,i=0,o=0;if(!t)n=i=o=r;else{const c=r<.5?r*(1+t):r+t-r*t,d=2*r-c;n=z1(d,c,e+1/3),i=z1(d,c,e),o=z1(d,c,e-1/3)}return{red:Math.round(n*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:a}}function Ux(e,t){return r=>r>0?t:e}const ba=(e,t,r)=>e+(t-e)*r,$1=(e,t,r)=>{const a=e*e,n=r*(t*t-a)+a;return n<0?0:Math.sqrt(n)},MB=[Ny,cu,Th],LB=e=>MB.find(t=>t.test(e));function Zj(e){const t=LB(e);if(!t)return!1;let r=t.parse(e);return t===Th&&(r=DB(r)),r}const Qj=(e,t)=>{const r=Zj(e),a=Zj(t);if(!r||!a)return Ux(e,t);const n={...r};return i=>(n.red=$1(r.red,a.red,i),n.green=$1(r.green,a.green,i),n.blue=$1(r.blue,a.blue,i),n.alpha=ba(r.alpha,a.alpha,i),cu.transform(n))},Cy=new Set(["none","hidden"]);function FB(e,t){return Cy.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function BB(e,t){return r=>ba(e,t,r)}function vb(e){return typeof e=="number"?BB:typeof e=="string"?pb(e)?Ux:Ga.test(e)?Qj:zB:Array.isArray(e)?XA:typeof e=="object"?Ga.test(e)?Qj:VB:Ux}function XA(e,t){const r=[...e],a=r.length,n=e.map((i,o)=>vb(i)(i,t[o]));return i=>{for(let o=0;o<a;o++)r[o]=n[o](i);return r}}function VB(e,t){const r={...e,...t},a={};for(const n in r)e[n]!==void 0&&t[n]!==void 0&&(a[n]=vb(e[n])(e[n],t[n]));return n=>{for(const i in a)r[i]=a[i](n);return r}}function UB(e,t){const r=[],a={color:0,var:0,number:0};for(let n=0;n<t.values.length;n++){const i=t.types[n],o=e.indexes[i][a[i]],c=e.values[o]??0;r[n]=c,a[i]++}return r}const zB=(e,t)=>{const r=Sd.createTransformer(t),a=wp(e),n=wp(t);return a.indexes.var.length===n.indexes.var.length&&a.indexes.color.length===n.indexes.color.length&&a.indexes.number.length>=n.indexes.number.length?Cy.has(e)&&!n.values.length||Cy.has(t)&&!a.values.length?FB(e,t):Xp(XA(UB(a,n),n.values),r):Ux(e,t)};function YA(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?ba(e,t,r):vb(e)(e,t)}const $B=e=>{const t=({timestamp:r})=>e(r);return{start:(r=!0)=>ga.update(t,r),stop:()=>wc(t),now:()=>Tn.isProcessing?Tn.timestamp:Si.now()}},ZA=(e,t,r=10)=>{let a="";const n=Math.max(Math.round(t/r),2);for(let i=0;i<n;i++)a+=Math.round(e(i/(n-1))*1e4)/1e4+", ";return`linear(${a.substring(0,a.length-2)})`},zx=2e4;function yb(e){let t=0;const r=50;let a=e.next(t);for(;!a.done&&t<zx;)t+=r,a=e.next(t);return t>=zx?1/0:t}function QA(e,t=100,r){const a=r({...e,keyframes:[0,t]}),n=Math.min(yb(a),zx);return{type:"keyframes",ease:i=>a.next(n*i).value/t,duration:bo(n)}}const qB=5;function JA(e,t,r){const a=Math.max(t-qB,0);return AA(r-e(a),t-a)}const Ia={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},q1=.001;function WB({duration:e=Ia.duration,bounce:t=Ia.bounce,velocity:r=Ia.velocity,mass:a=Ia.mass}){let n,i,o=1-t;o=vc(Ia.minDamping,Ia.maxDamping,o),e=vc(Ia.minDuration,Ia.maxDuration,bo(e)),o<1?(n=h=>{const p=h*o,x=p*e,v=p-r,b=Ey(h,o),N=Math.exp(-x);return q1-v/b*N},i=h=>{const x=h*o*e,v=x*r+r,b=Math.pow(o,2)*Math.pow(h,2)*e,N=Math.exp(-x),_=Ey(Math.pow(h,2),o);return(-n(h)+q1>0?-1:1)*((v-b)*N)/_}):(n=h=>{const p=Math.exp(-h*e),x=(h-r)*e+1;return-q1+p*x},i=h=>{const p=Math.exp(-h*e),x=(r-h)*(e*e);return p*x});const c=5/e,d=GB(n,i,c);if(e=sl(e),isNaN(d))return{stiffness:Ia.stiffness,damping:Ia.damping,duration:e};{const h=Math.pow(d,2)*a;return{stiffness:h,damping:o*2*Math.sqrt(a*h),duration:e}}}const HB=12;function GB(e,t,r){let a=r;for(let n=1;n<HB;n++)a=a-e(a)/t(a);return a}function Ey(e,t){return e*Math.sqrt(1-t*t)}const KB=["duration","bounce"],XB=["stiffness","damping","mass"];function Jj(e,t){return t.some(r=>e[r]!==void 0)}function YB(e){let t={velocity:Ia.velocity,stiffness:Ia.stiffness,damping:Ia.damping,mass:Ia.mass,isResolvedFromDuration:!1,...e};if(!Jj(e,XB)&&Jj(e,KB))if(e.visualDuration){const r=e.visualDuration,a=2*Math.PI/(r*1.2),n=a*a,i=2*vc(.05,1,1-(e.bounce||0))*Math.sqrt(n);t={...t,mass:Ia.mass,stiffness:n,damping:i}}else{const r=WB(e);t={...t,...r,mass:Ia.mass},t.isResolvedFromDuration=!0}return t}function bp(e=Ia.visualDuration,t=Ia.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:a,restDelta:n}=r;const i=r.keyframes[0],o=r.keyframes[r.keyframes.length-1],c={done:!1,value:i},{stiffness:d,damping:h,mass:p,duration:x,velocity:v,isResolvedFromDuration:b}=YB({...r,velocity:-bo(r.velocity||0)}),N=v||0,_=h/(2*Math.sqrt(d*p)),C=o-i,T=bo(Math.sqrt(d/p)),A=Math.abs(C)<5;a||(a=A?Ia.restSpeed.granular:Ia.restSpeed.default),n||(n=A?Ia.restDelta.granular:Ia.restDelta.default);let k;if(_<1){const B=Ey(T,_);k=O=>{const D=Math.exp(-_*T*O);return o-D*((N+_*T*C)/B*Math.sin(B*O)+C*Math.cos(B*O))}}else if(_===1)k=B=>o-Math.exp(-T*B)*(C+(N+T*C)*B);else{const B=T*Math.sqrt(_*_-1);k=O=>{const D=Math.exp(-_*T*O),F=Math.min(B*O,300);return o-D*((N+_*T*C)*Math.sinh(F)+B*C*Math.cosh(F))/B}}const I={calculatedDuration:b&&x||null,next:B=>{const O=k(B);if(b)c.done=B>=x;else{let D=B===0?N:0;_<1&&(D=B===0?sl(N):JA(k,B,O));const F=Math.abs(D)<=a,M=Math.abs(o-O)<=n;c.done=F&&M}return c.value=c.done?o:O,c},toString:()=>{const B=Math.min(yb(I),zx),O=ZA(D=>I.next(B*D).value,B,30);return B+"ms "+O},toTransition:()=>{}};return I}bp.applyToOptions=e=>{const t=QA(e,100,bp);return e.ease=t.ease,e.duration=sl(t.duration),e.type="keyframes",e};function Sy({keyframes:e,velocity:t=0,power:r=.8,timeConstant:a=325,bounceDamping:n=10,bounceStiffness:i=500,modifyTarget:o,min:c,max:d,restDelta:h=.5,restSpeed:p}){const x=e[0],v={done:!1,value:x},b=F=>c!==void 0&&F<c||d!==void 0&&F>d,N=F=>c===void 0?d:d===void 0||Math.abs(c-F)<Math.abs(d-F)?c:d;let _=r*t;const C=x+_,T=o===void 0?C:o(C);T!==C&&(_=T-x);const A=F=>-_*Math.exp(-F/a),k=F=>T+A(F),I=F=>{const M=A(F),z=k(F);v.done=Math.abs(M)<=h,v.value=v.done?T:z};let B,O;const D=F=>{b(v.value)&&(B=F,O=bp({keyframes:[v.value,N(v.value)],velocity:JA(k,F,v.value),damping:n,stiffness:i,restDelta:h,restSpeed:p}))};return D(0),{calculatedDuration:null,next:F=>{let M=!1;return!O&&B===void 0&&(M=!0,I(F),D(F)),B!==void 0&&F>=B?O.next(F-B):(!M&&I(F),v)}}}function ZB(e,t,r){const a=[],n=r||yc.mix||YA,i=e.length-1;for(let o=0;o<i;o++){let c=n(e[o],e[o+1]);if(t){const d=Array.isArray(t)?t[o]||jo:t;c=Xp(d,c)}a.push(c)}return a}function e3(e,t,{clamp:r=!0,ease:a,mixer:n}={}){const i=e.length;if(Vx(i===t.length),i===1)return()=>t[0];if(i===2&&t[0]===t[1])return()=>t[1];const o=e[0]===e[1];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const c=ZB(t,a,n),d=c.length,h=p=>{if(o&&p<e[0])return t[0];let x=0;if(d>1)for(;x<e.length-2&&!(p<e[x+1]);x++);const v=df(e[x],e[x+1],p);return c[x](v)};return r?p=>h(vc(e[0],e[i-1],p)):h}function t3(e,t){const r=e[e.length-1];for(let a=1;a<=t;a++){const n=df(0,t,a);e.push(ba(r,1,n))}}function s3(e){const t=[0];return t3(t,e.length-1),t}function QB(e,t){return e.map(r=>r*t)}function JB(e,t){return e.map(()=>t||FA).splice(0,e.length-1)}function Vm({duration:e=300,keyframes:t,times:r,ease:a="easeInOut"}){const n=BA(a)?a.map(Gj):Gj(a),i={done:!1,value:t[0]},o=QB(r&&r.length===t.length?r:s3(t),e),c=e3(o,t,{ease:Array.isArray(n)?n:JB(t,n)});return{calculatedDuration:e,next:d=>(i.value=c(d),i.done=d>=e,i)}}const eV=e=>e!==null;function wb(e,{repeat:t,repeatType:r="loop"},a,n=1){const i=e.filter(eV),c=n<0||t&&r!=="loop"&&t%2===1?0:i.length-1;return!c||a===void 0?i[c]:a}const tV={decay:Sy,inertia:Sy,tween:Vm,keyframes:Vm,spring:bp};function r3(e){typeof e.type=="string"&&(e.type=tV[e.type])}class bb{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const sV=e=>e/100;class _b extends bb{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var a,n;const{motionValue:r}=this.options;r&&r.updatedAt!==Si.now()&&this.tick(Si.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(n=(a=this.options).onStop)==null||n.call(a))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;r3(t);const{type:r=Vm,repeat:a=0,repeatDelay:n=0,repeatType:i,velocity:o=0}=t;let{keyframes:c}=t;const d=r||Vm;d!==Vm&&typeof c[0]!="number"&&(this.mixKeyframes=Xp(sV,YA(c[0],c[1])),c=[0,100]);const h=d({...t,keyframes:c});i==="mirror"&&(this.mirroredGenerator=d({...t,keyframes:[...c].reverse(),velocity:-o})),h.calculatedDuration===null&&(h.calculatedDuration=yb(h));const{calculatedDuration:p}=h;this.calculatedDuration=p,this.resolvedDuration=p+n,this.totalDuration=this.resolvedDuration*(a+1)-n,this.generator=h}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:a,totalDuration:n,mixKeyframes:i,mirroredGenerator:o,resolvedDuration:c,calculatedDuration:d}=this;if(this.startTime===null)return a.next(0);const{delay:h=0,keyframes:p,repeat:x,repeatType:v,repeatDelay:b,type:N,onUpdate:_,finalKeyframe:C}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-n/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const T=this.currentTime-h*(this.playbackSpeed>=0?1:-1),A=this.playbackSpeed>=0?T<0:T>n;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=n);let k=this.currentTime,I=a;if(x){const F=Math.min(this.currentTime,n)/c;let M=Math.floor(F),z=F%1;!z&&F>=1&&(z=1),z===1&&M--,M=Math.min(M,x+1),!!(M%2)&&(v==="reverse"?(z=1-z,b&&(z-=b/c)):v==="mirror"&&(I=o)),k=vc(0,1,z)*c}const B=A?{done:!1,value:p[0]}:I.next(k);i&&(B.value=i(B.value));let{done:O}=B;!A&&d!==null&&(O=this.playbackSpeed>=0?this.currentTime>=n:this.currentTime<=0);const D=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&O);return D&&N!==Sy&&(B.value=wb(p,this.options,C,this.speed)),_&&_(B.value),D&&this.finish(),B}then(t,r){return this.finished.then(t,r)}get duration(){return bo(this.calculatedDuration)}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+bo(t)}get time(){return bo(this.currentTime)}set time(t){var r;t=sl(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(r=this.driver)==null||r.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Si.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=bo(this.currentTime))}play(){var n,i;if(this.isStopped)return;const{driver:t=$B,startTime:r}=this.options;this.driver||(this.driver=t(o=>this.tick(o))),(i=(n=this.options).onPlay)==null||i.call(n);const a=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=a):this.holdTime!==null?this.startTime=a-this.holdTime:this.startTime||(this.startTime=r??a),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Si.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,r;this.notifyFinished(),this.teardown(),this.state="finished",(r=(t=this.options).onComplete)==null||r.call(t)}cancel(){var t,r;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(r=(t=this.options).onCancel)==null||r.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var r;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(r=this.driver)==null||r.stop(),t.observe(this)}}function rV(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const du=e=>e*180/Math.PI,Ty=e=>{const t=du(Math.atan2(e[1],e[0]));return Ay(t)},aV={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:Ty,rotateZ:Ty,skewX:e=>du(Math.atan(e[1])),skewY:e=>du(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},Ay=e=>(e=e%360,e<0&&(e+=360),e),eN=Ty,tN=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),sN=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),nV={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:tN,scaleY:sN,scale:e=>(tN(e)+sN(e))/2,rotateX:e=>Ay(du(Math.atan2(e[6],e[5]))),rotateY:e=>Ay(du(Math.atan2(-e[2],e[0]))),rotateZ:eN,rotate:eN,skewX:e=>du(Math.atan(e[4])),skewY:e=>du(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function ky(e){return e.includes("scale")?1:0}function Ry(e,t){if(!e||e==="none")return ky(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let a,n;if(r)a=nV,n=r;else{const c=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);a=aV,n=c}if(!n)return ky(t);const i=a[t],o=n[1].split(",").map(oV);return typeof i=="function"?i(o):o[i]}const iV=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return Ry(r,t)};function oV(e){return parseFloat(e.trim())}const Bf=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Vf=new Set(Bf),rN=e=>e===Ff||e===Us,lV=new Set(["x","y","z"]),cV=Bf.filter(e=>!lV.has(e));function dV(e){const t=[];return cV.forEach(r=>{const a=e.getValue(r);a!==void 0&&(t.push([r,a.get()]),a.set(r.startsWith("scale")?1:0))}),t}const Nu={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>Ry(t,"x"),y:(e,{transform:t})=>Ry(t,"y")};Nu.translateX=Nu.x;Nu.translateY=Nu.y;const Cu=new Set;let Py=!1,Iy=!1,Oy=!1;function a3(){if(Iy){const e=Array.from(Cu).filter(a=>a.needsMeasurement),t=new Set(e.map(a=>a.element)),r=new Map;t.forEach(a=>{const n=dV(a);n.length&&(r.set(a,n),a.render())}),e.forEach(a=>a.measureInitialState()),t.forEach(a=>{a.render();const n=r.get(a);n&&n.forEach(([i,o])=>{var c;(c=a.getValue(i))==null||c.set(o)})}),e.forEach(a=>a.measureEndState()),e.forEach(a=>{a.suspendedScrollY!==void 0&&window.scrollTo(0,a.suspendedScrollY)})}Iy=!1,Py=!1,Cu.forEach(e=>e.complete(Oy)),Cu.clear()}function n3(){Cu.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(Iy=!0)})}function uV(){Oy=!0,n3(),a3(),Oy=!1}class jb{constructor(t,r,a,n,i,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=a,this.motionValue=n,this.element=i,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(Cu.add(this),Py||(Py=!0,ga.read(n3),ga.resolveKeyframes(a3))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:a,motionValue:n}=this;if(t[0]===null){const i=n==null?void 0:n.get(),o=t[t.length-1];if(i!==void 0)t[0]=i;else if(a&&r){const c=a.readValue(r,o);c!=null&&(t[0]=c)}t[0]===void 0&&(t[0]=o),n&&i===void 0&&n.set(t[0])}rV(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Cu.delete(this)}cancel(){this.state==="scheduled"&&(Cu.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const hV=e=>e.startsWith("--");function fV(e,t,r){hV(t)?e.style.setProperty(t,r):e.style[t]=r}const mV=db(()=>window.ScrollTimeline!==void 0),pV={};function xV(e,t){const r=db(e);return()=>pV[t]??r()}const i3=xV(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),km=([e,t,r,a])=>`cubic-bezier(${e}, ${t}, ${r}, ${a})`,aN={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:km([0,.65,.55,1]),circOut:km([.55,0,1,.45]),backIn:km([.31,.01,.66,-.59]),backOut:km([.33,1.53,.69,.99])};function o3(e,t){if(e)return typeof e=="function"?i3()?ZA(e,t):"ease-out":UA(e)?km(e):Array.isArray(e)?e.map(r=>o3(r,t)||aN.easeOut):aN[e]}function gV(e,t,r,{delay:a=0,duration:n=300,repeat:i=0,repeatType:o="loop",ease:c="easeOut",times:d}={},h=void 0){const p={[t]:r};d&&(p.offset=d);const x=o3(c,n);Array.isArray(x)&&(p.easing=x);const v={delay:a,duration:n,easing:Array.isArray(x)?"linear":x,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"};return h&&(v.pseudoElement=h),e.animate(p,v)}function Nb(e){return typeof e=="function"&&"applyToOptions"in e}function vV({type:e,...t}){return Nb(e)&&i3()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class yV extends bb{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:r,name:a,keyframes:n,pseudoElement:i,allowFlatten:o=!1,finalKeyframe:c,onComplete:d}=t;this.isPseudoElement=!!i,this.allowFlatten=o,this.options=t,Vx(typeof t.type!="string");const h=vV(t);this.animation=gV(r,a,n,h,i),h.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const p=wb(n,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(p):fV(r,a,p),this.animation.cancel()}d==null||d(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,r;(r=(t=this.animation).finish)==null||r.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,r;this.isPseudoElement||(r=(t=this.animation).commitStyles)==null||r.call(t)}get duration(){var r,a;const t=((a=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:a.call(r).duration)||0;return bo(Number(t))}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+bo(t)}get time(){return bo(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=sl(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){var a;return this.allowFlatten&&((a=this.animation.effect)==null||a.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&mV()?(this.animation.timeline=t,jo):r(this)}}const l3={anticipate:DA,backInOut:OA,circInOut:LA};function wV(e){return e in l3}function bV(e){typeof e.ease=="string"&&wV(e.ease)&&(e.ease=l3[e.ease])}const nN=10;class _V extends yV{constructor(t){bV(t),r3(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:a,onComplete:n,element:i,...o}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const c=new _b({...o,autoplay:!1}),d=sl(this.finishedTime??this.time);r.setWithVelocity(c.sample(d-nN).value,c.sample(d).value,nN),c.stop()}}const iN=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Sd.test(e)||e==="0")&&!e.startsWith("url("));function jV(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function NV(e,t,r,a){const n=e[0];if(n===null)return!1;if(t==="display"||t==="visibility")return!0;const i=e[e.length-1],o=iN(n,t),c=iN(i,t);return!o||!c?!1:jV(e)||(r==="spring"||Nb(r))&&a}function Dy(e){e.duration=0,e.type="keyframes"}const CV=new Set(["opacity","clipPath","filter","transform"]),EV=db(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function SV(e){var p;const{motionValue:t,name:r,repeatDelay:a,repeatType:n,damping:i,type:o}=e;if(!(((p=t==null?void 0:t.owner)==null?void 0:p.current)instanceof HTMLElement))return!1;const{onUpdate:d,transformTemplate:h}=t.owner.getProps();return EV()&&r&&CV.has(r)&&(r!=="transform"||!h)&&!d&&!a&&n!=="mirror"&&i!==0&&o!=="inertia"}const TV=40;class AV extends bb{constructor({autoplay:t=!0,delay:r=0,type:a="keyframes",repeat:n=0,repeatDelay:i=0,repeatType:o="loop",keyframes:c,name:d,motionValue:h,element:p,...x}){var N;super(),this.stop=()=>{var _,C;this._animation&&(this._animation.stop(),(_=this.stopTimeline)==null||_.call(this)),(C=this.keyframeResolver)==null||C.cancel()},this.createdAt=Si.now();const v={autoplay:t,delay:r,type:a,repeat:n,repeatDelay:i,repeatType:o,name:d,motionValue:h,element:p,...x},b=(p==null?void 0:p.KeyframeResolver)||jb;this.keyframeResolver=new b(c,(_,C,T)=>this.onKeyframesResolved(_,C,v,!T),d,h,p),(N=this.keyframeResolver)==null||N.scheduleResolve()}onKeyframesResolved(t,r,a,n){this.keyframeResolver=void 0;const{name:i,type:o,velocity:c,delay:d,isHandoff:h,onUpdate:p}=a;this.resolvedAt=Si.now(),NV(t,i,o,c)||((yc.instantAnimations||!d)&&(p==null||p(wb(t,a,r))),t[0]=t[t.length-1],Dy(a),a.repeat=0);const v={startTime:n?this.resolvedAt?this.resolvedAt-this.createdAt>TV?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...a,keyframes:t},b=!h&&SV(v)?new _V({...v,element:v.motionValue.owner.current}):new _b(v);b.finished.then(()=>this.notifyFinished()).catch(jo),this.pendingTimeline&&(this.stopTimeline=b.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=b}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),uV()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}class kV{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}get finished(){return Promise.all(this.animations.map(t=>t.finished))}getAll(t){return this.animations[0][t]}setAll(t,r){for(let a=0;a<this.animations.length;a++)this.animations[a][t]=r}attachTimeline(t){const r=this.animations.map(a=>a.attachTimeline(t));return()=>{r.forEach((a,n)=>{a&&a(),this.animations[n].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get state(){return this.getAll("state")}get startTime(){return this.getAll("startTime")}get duration(){return oN(this.animations,"duration")}get iterationDuration(){return oN(this.animations,"iterationDuration")}runAll(t){this.animations.forEach(r=>r[t]())}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}function oN(e,t){let r=0;for(let a=0;a<e.length;a++){const n=e[a][t];n!==null&&n>r&&(r=n)}return r}class RV extends kV{then(t,r){return this.finished.finally(t).then(()=>{})}}const PV=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function IV(e){const t=PV.exec(e);if(!t)return[,];const[,r,a,n]=t;return[`--${r??a}`,n]}function c3(e,t,r=1){const[a,n]=IV(e);if(!a)return;const i=window.getComputedStyle(t).getPropertyValue(a);if(i){const o=i.trim();return EA(o)?parseFloat(o):o}return pb(n)?c3(n,t,r+1):n}function Cb(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const d3=new Set(["width","height","top","left","right","bottom",...Bf]),OV={test:e=>e==="auto",parse:e=>e},u3=e=>t=>t.test(e),h3=[Ff,Us,Ol,Wc,SB,EB,OV],lN=e=>h3.find(u3(e));function DV(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||TA(e):!0}const MV=new Set(["brightness","contrast","saturate","opacity"]);function LV(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[a]=r.match(xb)||[];if(!a)return e;const n=r.replace(a,"");let i=MV.has(t)?1:0;return a!==r&&(i*=100),t+"("+i+n+")"}const FV=/\b([a-z-]*)\(.*?\)/gu,My={...Sd,getAnimatableNone:e=>{const t=e.match(FV);return t?t.map(LV).join(" "):e}},cN={...Ff,transform:Math.round},BV={rotate:Wc,rotateX:Wc,rotateY:Wc,rotateZ:Wc,scale:F0,scaleX:F0,scaleY:F0,scaleZ:F0,skew:Wc,skewX:Wc,skewY:Wc,distance:Us,translateX:Us,translateY:Us,translateZ:Us,x:Us,y:Us,z:Us,perspective:Us,transformPerspective:Us,opacity:yp,originX:Xj,originY:Xj,originZ:Us},Eb={borderWidth:Us,borderTopWidth:Us,borderRightWidth:Us,borderBottomWidth:Us,borderLeftWidth:Us,borderRadius:Us,radius:Us,borderTopLeftRadius:Us,borderTopRightRadius:Us,borderBottomRightRadius:Us,borderBottomLeftRadius:Us,width:Us,maxWidth:Us,height:Us,maxHeight:Us,top:Us,right:Us,bottom:Us,left:Us,padding:Us,paddingTop:Us,paddingRight:Us,paddingBottom:Us,paddingLeft:Us,margin:Us,marginTop:Us,marginRight:Us,marginBottom:Us,marginLeft:Us,backgroundPositionX:Us,backgroundPositionY:Us,...BV,zIndex:cN,fillOpacity:yp,strokeOpacity:yp,numOctaves:cN},VV={...Eb,color:Ga,backgroundColor:Ga,outlineColor:Ga,fill:Ga,stroke:Ga,borderColor:Ga,borderTopColor:Ga,borderRightColor:Ga,borderBottomColor:Ga,borderLeftColor:Ga,filter:My,WebkitFilter:My},f3=e=>VV[e];function m3(e,t){let r=f3(e);return r!==My&&(r=Sd),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const UV=new Set(["auto","none","0"]);function zV(e,t,r){let a=0,n;for(;a<e.length&&!n;){const i=e[a];typeof i=="string"&&!UV.has(i)&&wp(i).values.length&&(n=e[a]),a++}if(n&&r)for(const i of t)e[i]=m3(r,n)}class $V extends jb{constructor(t,r,a,n,i){super(t,r,a,n,i,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:a}=this;if(!r||!r.current)return;super.readKeyframes();for(let d=0;d<t.length;d++){let h=t[d];if(typeof h=="string"&&(h=h.trim(),pb(h))){const p=c3(h,r.current);p!==void 0&&(t[d]=p),d===t.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!d3.has(a)||t.length!==2)return;const[n,i]=t,o=lN(n),c=lN(i);if(o!==c)if(rN(o)&&rN(c))for(let d=0;d<t.length;d++){const h=t[d];typeof h=="string"&&(t[d]=parseFloat(h))}else Nu[a]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,a=[];for(let n=0;n<t.length;n++)(t[n]===null||DV(t[n]))&&a.push(n);a.length&&zV(t,a,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:a}=this;if(!t||!t.current)return;a==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Nu[a](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const n=r[r.length-1];n!==void 0&&t.getValue(a,n).jump(n,!1)}measureEndState(){var c;const{element:t,name:r,unresolvedKeyframes:a}=this;if(!t||!t.current)return;const n=t.getValue(r);n&&n.jump(this.measuredOrigin,!1);const i=a.length-1,o=a[i];a[i]=Nu[r](t.measureViewportBox(),window.getComputedStyle(t.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(c=this.removedTransforms)!=null&&c.length&&this.removedTransforms.forEach(([d,h])=>{t.getValue(d).set(h)}),this.resolveNoneKeyframes()}}function Sb(e,t,r){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let a=document;const n=(r==null?void 0:r[e])??a.querySelectorAll(e);return n?Array.from(n):[]}return Array.from(e)}const p3=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function x3(e){return SA(e)&&"offsetHeight"in e}const dN=30,qV=e=>!isNaN(parseFloat(e)),Um={current:void 0};class WV{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=a=>{var i;const n=Si.now();if(this.updatedAt!==n&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(a),this.current!==this.prev&&((i=this.events.change)==null||i.notify(this.current),this.dependents))for(const o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=Si.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=qV(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new ub);const a=this.events[t].add(r);return t==="change"?()=>{a(),ga.read(()=>{this.events.change.getSize()||this.stop()})}:a}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,a){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-a}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return Um.current&&Um.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const t=Si.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>dN)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,dN);return AA(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,r;(t=this.dependents)==null||t.clear(),(r=this.events.destroy)==null||r.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Iu(e,t){return new WV(e,t)}const{schedule:Tb,cancel:$ue}=zA(queueMicrotask,!1),zo={x:!1,y:!1};function g3(){return zo.x||zo.y}function HV(e){return e==="x"||e==="y"?zo[e]?null:(zo[e]=!0,()=>{zo[e]=!1}):zo.x||zo.y?null:(zo.x=zo.y=!0,()=>{zo.x=zo.y=!1})}function v3(e,t){const r=Sb(e),a=new AbortController,n={passive:!0,...t,signal:a.signal};return[r,n,()=>a.abort()]}function uN(e){return!(e.pointerType==="touch"||g3())}function GV(e,t,r={}){const[a,n,i]=v3(e,r),o=c=>{if(!uN(c))return;const{target:d}=c,h=t(d,c);if(typeof h!="function"||!d)return;const p=x=>{uN(x)&&(h(x),d.removeEventListener("pointerleave",p))};d.addEventListener("pointerleave",p,n)};return a.forEach(c=>{c.addEventListener("pointerenter",o,n)}),i}const y3=(e,t)=>t?e===t?!0:y3(e,t.parentElement):!1,Ab=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,KV=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function XV(e){return KV.has(e.tagName)||e.tabIndex!==-1}const fx=new WeakSet;function hN(e){return t=>{t.key==="Enter"&&e(t)}}function W1(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const YV=(e,t)=>{const r=e.currentTarget;if(!r)return;const a=hN(()=>{if(fx.has(r))return;W1(r,"down");const n=hN(()=>{W1(r,"up")}),i=()=>W1(r,"cancel");r.addEventListener("keyup",n,t),r.addEventListener("blur",i,t)});r.addEventListener("keydown",a,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",a),t)};function fN(e){return Ab(e)&&!g3()}function ZV(e,t,r={}){const[a,n,i]=v3(e,r),o=c=>{const d=c.currentTarget;if(!fN(c))return;fx.add(d);const h=t(d,c),p=(b,N)=>{window.removeEventListener("pointerup",x),window.removeEventListener("pointercancel",v),fx.has(d)&&fx.delete(d),fN(b)&&typeof h=="function"&&h(b,{success:N})},x=b=>{p(b,d===window||d===document||r.useGlobalTarget||y3(d,b.target))},v=b=>{p(b,!1)};window.addEventListener("pointerup",x,n),window.addEventListener("pointercancel",v,n)};return a.forEach(c=>{(r.useGlobalTarget?window:c).addEventListener("pointerdown",o,n),x3(c)&&(c.addEventListener("focus",h=>YV(h,n)),!XV(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),i}function kb(e){return SA(e)&&"ownerSVGElement"in e}function w3(e){return kb(e)&&e.tagName==="svg"}function QV(...e){const t=!Array.isArray(e[0]),r=t?0:-1,a=e[0+r],n=e[1+r],i=e[2+r],o=e[3+r],c=e3(n,i,o);return t?c(a):c}const yn=e=>!!(e&&e.getVelocity),JV=[...h3,Ga,Sd],eU=e=>JV.find(u3(e)),Dg=E.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function mN(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function tU(...e){return t=>{let r=!1;const a=e.map(n=>{const i=mN(n,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let n=0;n<a.length;n++){const i=a[n];typeof i=="function"?i():mN(e[n],null)}}}}function sU(...e){return E.useCallback(tU(...e),e)}class rU extends E.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const a=r.offsetParent,n=x3(a)&&a.offsetWidth||0,i=this.props.sizeRef.current;i.height=r.offsetHeight||0,i.width=r.offsetWidth||0,i.top=r.offsetTop,i.left=r.offsetLeft,i.right=n-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function aU({children:e,isPresent:t,anchorX:r,root:a}){const n=E.useId(),i=E.useRef(null),o=E.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=E.useContext(Dg),d=sU(i,e==null?void 0:e.ref);return E.useInsertionEffect(()=>{const{width:h,height:p,top:x,left:v,right:b}=o.current;if(t||!i.current||!h||!p)return;const N=r==="left"?`left: ${v}`:`right: ${b}`;i.current.dataset.motionPopId=n;const _=document.createElement("style");c&&(_.nonce=c);const C=a??document.head;return C.appendChild(_),_.sheet&&_.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${h}px !important;
            height: ${p}px !important;
            ${N}px !important;
            top: ${x}px !important;
          }
        `),()=>{C.contains(_)&&C.removeChild(_)}},[t]),s.jsx(rU,{isPresent:t,childRef:i,sizeRef:o,children:E.cloneElement(e,{ref:d})})}const nU=({children:e,initial:t,isPresent:r,onExitComplete:a,custom:n,presenceAffectsLayout:i,mode:o,anchorX:c,root:d})=>{const h=Kp(iU),p=E.useId();let x=!0,v=E.useMemo(()=>(x=!1,{id:p,initial:t,isPresent:r,custom:n,onExitComplete:b=>{h.set(b,!0);for(const N of h.values())if(!N)return;a&&a()},register:b=>(h.set(b,!1),()=>h.delete(b))}),[r,h,a]);return i&&x&&(v={...v}),E.useMemo(()=>{h.forEach((b,N)=>h.set(N,!1))},[r]),E.useEffect(()=>{!r&&!h.size&&a&&a()},[r]),o==="popLayout"&&(e=s.jsx(aU,{isPresent:r,anchorX:c,root:d,children:e})),s.jsx(Ig.Provider,{value:v,children:e})};function iU(){return new Map}function b3(e=!0){const t=E.useContext(Ig);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:a,register:n}=t,i=E.useId();E.useEffect(()=>{if(e)return n(i)},[e]);const o=E.useCallback(()=>e&&a&&a(i),[i,a,e]);return!r&&a?[!1,o]:[!0]}const B0=e=>e.key||"";function pN(e){const t=[];return E.Children.forEach(e,r=>{E.isValidElement(r)&&t.push(r)}),t}const Qi=({children:e,custom:t,initial:r=!0,onExitComplete:a,presenceAffectsLayout:n=!0,mode:i="sync",propagate:o=!1,anchorX:c="left",root:d})=>{const[h,p]=b3(o),x=E.useMemo(()=>pN(e),[e]),v=o&&!h?[]:x.map(B0),b=E.useRef(!0),N=E.useRef(x),_=Kp(()=>new Map),[C,T]=E.useState(x),[A,k]=E.useState(x);lb(()=>{b.current=!1,N.current=x;for(let O=0;O<A.length;O++){const D=B0(A[O]);v.includes(D)?_.delete(D):_.get(D)!==!0&&_.set(D,!1)}},[A,v.length,v.join("-")]);const I=[];if(x!==C){let O=[...x];for(let D=0;D<A.length;D++){const F=A[D],M=B0(F);v.includes(M)||(O.splice(D,0,F),I.push(F))}return i==="wait"&&I.length&&(O=I),k(pN(O)),T(x),null}const{forceRender:B}=E.useContext(ib);return s.jsx(s.Fragment,{children:A.map(O=>{const D=B0(O),F=o&&!h?!1:x===A||v.includes(D),M=()=>{if(_.has(D))_.set(D,!0);else return;let z=!0;_.forEach(q=>{q||(z=!1)}),z&&(B==null||B(),k(N.current),o&&(p==null||p()),a&&a())};return s.jsx(nU,{isPresent:F,initial:!b.current||r?void 0:!1,custom:t,presenceAffectsLayout:n,mode:i,root:d,onExitComplete:F?void 0:M,anchorX:c,children:O},D)})})},_3=E.createContext({strict:!1}),xN={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},uf={};for(const e in xN)uf[e]={isEnabled:t=>xN[e].some(r=>!!t[r])};function oU(e){for(const t in e)uf[t]={...uf[t],...e[t]}}const lU=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function $x(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||lU.has(e)}let j3=e=>!$x(e);function cU(e){typeof e=="function"&&(j3=t=>t.startsWith("on")?!$x(t):e(t))}try{cU(require("@emotion/is-prop-valid").default)}catch{}function dU(e,t,r){const a={};for(const n in e)n==="values"&&typeof e.values=="object"||(j3(n)||r===!0&&$x(n)||!t&&!$x(n)||e.draggable&&n.startsWith("onDrag"))&&(a[n]=e[n]);return a}const Mg=E.createContext({});function Lg(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function _p(e){return typeof e=="string"||Array.isArray(e)}const Rb=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Pb=["initial",...Rb];function Fg(e){return Lg(e.animate)||Pb.some(t=>_p(e[t]))}function N3(e){return!!(Fg(e)||e.variants)}function uU(e,t){if(Fg(e)){const{initial:r,animate:a}=e;return{initial:r===!1||_p(r)?r:void 0,animate:_p(a)?a:void 0}}return e.inherit!==!1?t:{}}function hU(e){const{initial:t,animate:r}=uU(e,E.useContext(Mg));return E.useMemo(()=>({initial:t,animate:r}),[gN(t),gN(r)])}function gN(e){return Array.isArray(e)?e.join(" "):e}const jp={};function fU(e){for(const t in e)jp[t]=e[t],mb(t)&&(jp[t].isCSSVariable=!0)}function C3(e,{layout:t,layoutId:r}){return Vf.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!jp[e]||e==="opacity")}const mU={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},pU=Bf.length;function xU(e,t,r){let a="",n=!0;for(let i=0;i<pU;i++){const o=Bf[i],c=e[o];if(c===void 0)continue;let d=!0;if(typeof c=="number"?d=c===(o.startsWith("scale")?1:0):d=parseFloat(c)===0,!d||r){const h=p3(c,Eb[o]);if(!d){n=!1;const p=mU[o]||o;a+=`${p}(${h}) `}r&&(t[o]=h)}}return a=a.trim(),r?a=r(t,n?"":a):n&&(a="none"),a}function Ib(e,t,r){const{style:a,vars:n,transformOrigin:i}=e;let o=!1,c=!1;for(const d in t){const h=t[d];if(Vf.has(d)){o=!0;continue}else if(mb(d)){n[d]=h;continue}else{const p=p3(h,Eb[d]);d.startsWith("origin")?(c=!0,i[d]=p):a[d]=p}}if(t.transform||(o||r?a.transform=xU(t,e.transform,r):a.transform&&(a.transform="none")),c){const{originX:d="50%",originY:h="50%",originZ:p=0}=i;a.transformOrigin=`${d} ${h} ${p}`}}const Ob=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function E3(e,t,r){for(const a in t)!yn(t[a])&&!C3(a,r)&&(e[a]=t[a])}function gU({transformTemplate:e},t){return E.useMemo(()=>{const r=Ob();return Ib(r,t,e),Object.assign({},r.vars,r.style)},[t])}function vU(e,t){const r=e.style||{},a={};return E3(a,r,e),Object.assign(a,gU(e,t)),a}function yU(e,t){const r={},a=vU(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=a,r}const wU={offset:"stroke-dashoffset",array:"stroke-dasharray"},bU={offset:"strokeDashoffset",array:"strokeDasharray"};function _U(e,t,r=1,a=0,n=!0){e.pathLength=1;const i=n?wU:bU;e[i.offset]=Us.transform(-a);const o=Us.transform(t),c=Us.transform(r);e[i.array]=`${o} ${c}`}function S3(e,{attrX:t,attrY:r,attrScale:a,pathLength:n,pathSpacing:i=1,pathOffset:o=0,...c},d,h,p){if(Ib(e,c,h),d){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:x,style:v}=e;x.transform&&(v.transform=x.transform,delete x.transform),(v.transform||x.transformOrigin)&&(v.transformOrigin=x.transformOrigin??"50% 50%",delete x.transformOrigin),v.transform&&(v.transformBox=(p==null?void 0:p.transformBox)??"fill-box",delete x.transformBox),t!==void 0&&(x.x=t),r!==void 0&&(x.y=r),a!==void 0&&(x.scale=a),n!==void 0&&_U(x,n,i,o,!1)}const T3=()=>({...Ob(),attrs:{}}),A3=e=>typeof e=="string"&&e.toLowerCase()==="svg";function jU(e,t,r,a){const n=E.useMemo(()=>{const i=T3();return S3(i,t,A3(a),e.transformTemplate,e.style),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};E3(i,e.style,e),n.style={...i,...n.style}}return n}const NU=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Db(e){return typeof e!="string"||e.includes("-")?!1:!!(NU.indexOf(e)>-1||/[A-Z]/u.test(e))}function CU(e,t,r,{latestValues:a},n,i=!1){const c=(Db(e)?jU:yU)(t,a,n,e),d=dU(t,typeof e=="string",i),h=e!==E.Fragment?{...d,...c,ref:r}:{},{children:p}=t,x=E.useMemo(()=>yn(p)?p.get():p,[p]);return E.createElement(e,{...h,children:x})}function vN(e){const t=[{},{}];return e==null||e.values.forEach((r,a)=>{t[0][a]=r.get(),t[1][a]=r.getVelocity()}),t}function Mb(e,t,r,a){if(typeof t=="function"){const[n,i]=vN(a);t=t(r!==void 0?r:e.custom,n,i)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[n,i]=vN(a);t=t(r!==void 0?r:e.custom,n,i)}return t}function mx(e){return yn(e)?e.get():e}function EU({scrapeMotionValuesFromProps:e,createRenderState:t},r,a,n){return{latestValues:SU(r,a,n,e),renderState:t()}}function SU(e,t,r,a){const n={},i=a(e,{});for(const v in i)n[v]=mx(i[v]);let{initial:o,animate:c}=e;const d=Fg(e),h=N3(e);t&&h&&!d&&e.inherit!==!1&&(o===void 0&&(o=t.initial),c===void 0&&(c=t.animate));let p=r?r.initial===!1:!1;p=p||o===!1;const x=p?c:o;if(x&&typeof x!="boolean"&&!Lg(x)){const v=Array.isArray(x)?x:[x];for(let b=0;b<v.length;b++){const N=Mb(e,v[b]);if(N){const{transitionEnd:_,transition:C,...T}=N;for(const A in T){let k=T[A];if(Array.isArray(k)){const I=p?k.length-1:0;k=k[I]}k!==null&&(n[A]=k)}for(const A in _)n[A]=_[A]}}}return n}const k3=e=>(t,r)=>{const a=E.useContext(Mg),n=E.useContext(Ig),i=()=>EU(e,t,a,n);return r?i():Kp(i)};function Lb(e,t,r){var i;const{style:a}=e,n={};for(const o in a)(yn(a[o])||t.style&&yn(t.style[o])||C3(o,e)||((i=r==null?void 0:r.getValue(o))==null?void 0:i.liveStyle)!==void 0)&&(n[o]=a[o]);return n}const TU=k3({scrapeMotionValuesFromProps:Lb,createRenderState:Ob});function R3(e,t,r){const a=Lb(e,t,r);for(const n in e)if(yn(e[n])||yn(t[n])){const i=Bf.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;a[i]=e[n]}return a}const AU=k3({scrapeMotionValuesFromProps:R3,createRenderState:T3}),kU=Symbol.for("motionComponentSymbol");function Ah(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function RU(e,t,r){return E.useCallback(a=>{a&&e.onMount&&e.onMount(a),t&&(a?t.mount(a):t.unmount()),r&&(typeof r=="function"?r(a):Ah(r)&&(r.current=a))},[t])}const Fb=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),PU="framerAppearId",P3="data-"+Fb(PU),I3=E.createContext({});function IU(e,t,r,a,n){var _,C;const{visualElement:i}=E.useContext(Mg),o=E.useContext(_3),c=E.useContext(Ig),d=E.useContext(Dg).reducedMotion,h=E.useRef(null);a=a||o.renderer,!h.current&&a&&(h.current=a(e,{visualState:t,parent:i,props:r,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:d}));const p=h.current,x=E.useContext(I3);p&&!p.projection&&n&&(p.type==="html"||p.type==="svg")&&OU(h.current,r,n,x);const v=E.useRef(!1);E.useInsertionEffect(()=>{p&&v.current&&p.update(r,c)});const b=r[P3],N=E.useRef(!!b&&!((_=window.MotionHandoffIsComplete)!=null&&_.call(window,b))&&((C=window.MotionHasOptimisedAnimation)==null?void 0:C.call(window,b)));return lb(()=>{p&&(v.current=!0,window.MotionIsMounted=!0,p.updateFeatures(),p.scheduleRenderMicrotask(),N.current&&p.animationState&&p.animationState.animateChanges())}),E.useEffect(()=>{p&&(!N.current&&p.animationState&&p.animationState.animateChanges(),N.current&&(queueMicrotask(()=>{var T;(T=window.MotionHandoffMarkAsComplete)==null||T.call(window,b)}),N.current=!1),p.enteringChildren=void 0)}),p}function OU(e,t,r,a){const{layoutId:n,layout:i,drag:o,dragConstraints:c,layoutScroll:d,layoutRoot:h,layoutCrossfade:p}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:O3(e.parent)),e.projection.setOptions({layoutId:n,layout:i,alwaysMeasureLayout:!!o||c&&Ah(c),visualElement:e,animationType:typeof i=="string"?i:"both",initialPromotionConfig:a,crossfade:p,layoutScroll:d,layoutRoot:h})}function O3(e){if(e)return e.options.allowProjection!==!1?e.projection:O3(e.parent)}function H1(e,{forwardMotionProps:t=!1}={},r,a){r&&oU(r);const n=Db(e)?AU:TU;function i(c,d){let h;const p={...E.useContext(Dg),...c,layoutId:DU(c)},{isStatic:x}=p,v=hU(c),b=n(c,x);if(!x&&ob){MU();const N=LU(p);h=N.MeasureLayout,v.visualElement=IU(e,b,p,a,N.ProjectionNode)}return s.jsxs(Mg.Provider,{value:v,children:[h&&v.visualElement?s.jsx(h,{visualElement:v.visualElement,...p}):null,CU(e,c,RU(b,v.visualElement,d),b,x,t)]})}i.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const o=E.forwardRef(i);return o[kU]=e,o}function DU({layoutId:e}){const t=E.useContext(ib).id;return t&&e!==void 0?t+"-"+e:e}function MU(e,t){E.useContext(_3).strict}function LU(e){const{drag:t,layout:r}=uf;if(!t&&!r)return{};const a={...t,...r};return{MeasureLayout:t!=null&&t.isEnabled(e)||r!=null&&r.isEnabled(e)?a.MeasureLayout:void 0,ProjectionNode:a.ProjectionNode}}function FU(e,t){if(typeof Proxy>"u")return H1;const r=new Map,a=(i,o)=>H1(i,o,e,t),n=(i,o)=>a(i,o);return new Proxy(n,{get:(i,o)=>o==="create"?a:(r.has(o)||r.set(o,H1(o,void 0,e,t)),r.get(o))})}function D3({top:e,left:t,right:r,bottom:a}){return{x:{min:t,max:r},y:{min:e,max:a}}}function BU({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function VU(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),a=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:a.y,right:a.x}}function G1(e){return e===void 0||e===1}function Ly({scale:e,scaleX:t,scaleY:r}){return!G1(e)||!G1(t)||!G1(r)}function su(e){return Ly(e)||M3(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function M3(e){return yN(e.x)||yN(e.y)}function yN(e){return e&&e!=="0%"}function qx(e,t,r){const a=e-r,n=t*a;return r+n}function wN(e,t,r,a,n){return n!==void 0&&(e=qx(e,n,a)),qx(e,r,a)+t}function Fy(e,t=0,r=1,a,n){e.min=wN(e.min,t,r,a,n),e.max=wN(e.max,t,r,a,n)}function L3(e,{x:t,y:r}){Fy(e.x,t.translate,t.scale,t.originPoint),Fy(e.y,r.translate,r.scale,r.originPoint)}const bN=.999999999999,_N=1.0000000000001;function UU(e,t,r,a=!1){const n=r.length;if(!n)return;t.x=t.y=1;let i,o;for(let c=0;c<n;c++){i=r[c],o=i.projectionDelta;const{visualElement:d}=i.options;d&&d.props.style&&d.props.style.display==="contents"||(a&&i.options.layoutScroll&&i.scroll&&i!==i.root&&Rh(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,L3(e,o)),a&&su(i.latestValues)&&Rh(e,i.latestValues))}t.x<_N&&t.x>bN&&(t.x=1),t.y<_N&&t.y>bN&&(t.y=1)}function kh(e,t){e.min=e.min+t,e.max=e.max+t}function jN(e,t,r,a,n=.5){const i=ba(e.min,e.max,n);Fy(e,t,r,i,a)}function Rh(e,t){jN(e.x,t.x,t.scaleX,t.scale,t.originX),jN(e.y,t.y,t.scaleY,t.scale,t.originY)}function F3(e,t){return D3(VU(e.getBoundingClientRect(),t))}function zU(e,t,r){const a=F3(e,r),{scroll:n}=t;return n&&(kh(a.x,n.offset.x),kh(a.y,n.offset.y)),a}const NN=()=>({translate:0,scale:1,origin:0,originPoint:0}),Ph=()=>({x:NN(),y:NN()}),CN=()=>({min:0,max:0}),ka=()=>({x:CN(),y:CN()}),By={current:null},B3={current:!1};function $U(){if(B3.current=!0,!!ob)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>By.current=e.matches;e.addEventListener("change",t),t()}else By.current=!1}const Np=new WeakMap;function qU(e,t,r){for(const a in t){const n=t[a],i=r[a];if(yn(n))e.addValue(a,n);else if(yn(i))e.addValue(a,Iu(n,{owner:e}));else if(i!==n)if(e.hasValue(a)){const o=e.getValue(a);o.liveStyle===!0?o.jump(n):o.hasAnimated||o.set(n)}else{const o=e.getStaticValue(a);e.addValue(a,Iu(o!==void 0?o:n,{owner:e}))}}for(const a in r)t[a]===void 0&&e.removeValue(a);return t}const EN=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class V3{scrapeMotionValuesFromProps(t,r,a){return{}}constructor({parent:t,props:r,presenceContext:a,reducedMotionConfig:n,blockInitialAnimation:i,visualState:o},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=jb,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const v=Si.now();this.renderScheduledAt<v&&(this.renderScheduledAt=v,ga.render(this.render,!1,!0))};const{latestValues:d,renderState:h}=o;this.latestValues=d,this.baseTarget={...d},this.initialValues=r.initial?{...d}:{},this.renderState=h,this.parent=t,this.props=r,this.presenceContext=a,this.depth=t?t.depth+1:0,this.reducedMotionConfig=n,this.options=c,this.blockInitialAnimation=!!i,this.isControllingVariants=Fg(r),this.isVariantNode=N3(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:p,...x}=this.scrapeMotionValuesFromProps(r,{},this);for(const v in x){const b=x[v];d[v]!==void 0&&yn(b)&&b.set(d[v])}}mount(t){var r;this.current=t,Np.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,n)=>this.bindToMotionValue(n,a)),B3.current||$U(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:By.current,(r=this.parent)==null||r.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var t;this.projection&&this.projection.unmount(),wc(this.notifyUpdate),wc(this.render),this.valueSubscriptions.forEach(r=>r()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(t=this.parent)==null||t.removeChild(this);for(const r in this.events)this.events[r].clear();for(const r in this.features){const a=this.features[r];a&&(a.unmount(),a.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const a=Vf.has(t);a&&this.onBindTransform&&this.onBindTransform();const n=r.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&ga.preRender(this.notifyUpdate),a&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{n(),i&&i(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in uf){const r=uf[t];if(!r)continue;const{isEnabled:a,Feature:n}=r;if(!this.features[t]&&n&&a(this.props)&&(this.features[t]=new n(this)),this.features[t]){const i=this.features[t];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ka()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let a=0;a<EN.length;a++){const n=EN[a];this.propEventSubscriptions[n]&&(this.propEventSubscriptions[n](),delete this.propEventSubscriptions[n]);const i="on"+n,o=t[i];o&&(this.propEventSubscriptions[n]=this.on(n,o))}this.prevMotionValues=qU(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const a=this.values.get(t);r!==a&&(a&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let a=this.values.get(t);return a===void 0&&r!==void 0&&(a=Iu(r===null?void 0:r,{owner:this}),this.addValue(t,a)),a}readValue(t,r){let a=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return a!=null&&(typeof a=="string"&&(EA(a)||TA(a))?a=parseFloat(a):!eU(a)&&Sd.test(r)&&(a=m3(t,r)),this.setBaseTarget(t,yn(a)?a.get():a)),yn(a)?a.get():a}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var i;const{initial:r}=this.props;let a;if(typeof r=="string"||typeof r=="object"){const o=Mb(this.props,r,(i=this.presenceContext)==null?void 0:i.custom);o&&(a=o[t])}if(r&&a!==void 0)return a;const n=this.getBaseTargetFromProps(this.props,t);return n!==void 0&&!yn(n)?n:this.initialValues[t]!==void 0&&a===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new ub),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){Tb.render(this.render)}}class U3 extends V3{constructor(){super(...arguments),this.KeyframeResolver=$V}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:a}){delete r[t],delete a[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;yn(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function z3(e,{style:t,vars:r},a,n){const i=e.style;let o;for(o in t)i[o]=t[o];n==null||n.applyProjectionStyles(i,a);for(o in r)i.setProperty(o,r[o])}function WU(e){return window.getComputedStyle(e)}class $3 extends U3{constructor(){super(...arguments),this.type="html",this.renderInstance=z3}readValueFromInstance(t,r){var a;if(Vf.has(r))return(a=this.projection)!=null&&a.isProjecting?ky(r):iV(t,r);{const n=WU(t),i=(mb(r)?n.getPropertyValue(r):n[r])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(t,{transformPagePoint:r}){return F3(t,r)}build(t,r,a){Ib(t,r,a.transformTemplate)}scrapeMotionValuesFromProps(t,r,a){return Lb(t,r,a)}}const q3=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function HU(e,t,r,a){z3(e,t,void 0,a);for(const n in t.attrs)e.setAttribute(q3.has(n)?n:Fb(n),t.attrs[n])}class W3 extends U3{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ka}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(Vf.has(r)){const a=f3(r);return a&&a.default||0}return r=q3.has(r)?r:Fb(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,a){return R3(t,r,a)}build(t,r,a){S3(t,r,this.isSVGTag,a.transformTemplate,a.style)}renderInstance(t,r,a,n){HU(t,r,a,n)}mount(t){this.isSVGTag=A3(t.tagName),super.mount(t)}}const GU=(e,t)=>Db(e)?new W3(t):new $3(t,{allowProjection:e!==E.Fragment});function Lh(e,t,r){const a=e.getProps();return Mb(a,t,r!==void 0?r:a.custom,e)}const Vy=e=>Array.isArray(e);function KU(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,Iu(r))}function XU(e){return Vy(e)?e[e.length-1]||0:e}function YU(e,t){const r=Lh(e,t);let{transitionEnd:a={},transition:n={},...i}=r||{};i={...i,...a};for(const o in i){const c=XU(i[o]);KU(e,o,c)}}function ZU(e){return!!(yn(e)&&e.add)}function Uy(e,t){const r=e.getValue("willChange");if(ZU(r))return r.add(t);if(!r&&yc.WillChange){const a=new yc.WillChange("auto");e.addValue("willChange",a),a.add(t)}}function H3(e){return e.props[P3]}const QU=e=>e!==null;function JU(e,{repeat:t,repeatType:r="loop"},a){const n=e.filter(QU),i=t&&r!=="loop"&&t%2===1?0:n.length-1;return!i||a===void 0?n[i]:a}const ez={type:"spring",stiffness:500,damping:25,restSpeed:10},tz=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),sz={type:"keyframes",duration:.8},rz={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},az=(e,{keyframes:t})=>t.length>2?sz:Vf.has(e)?e.startsWith("scale")?tz(t[1]):ez:rz;function nz({when:e,delay:t,delayChildren:r,staggerChildren:a,staggerDirection:n,repeat:i,repeatType:o,repeatDelay:c,from:d,elapsed:h,...p}){return!!Object.keys(p).length}const Bb=(e,t,r,a={},n,i)=>o=>{const c=Cb(a,e)||{},d=c.delay||a.delay||0;let{elapsed:h=0}=a;h=h-sl(d);const p={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...c,delay:-h,onUpdate:v=>{t.set(v),c.onUpdate&&c.onUpdate(v)},onComplete:()=>{o(),c.onComplete&&c.onComplete()},name:e,motionValue:t,element:i?void 0:n};nz(c)||Object.assign(p,az(e,p)),p.duration&&(p.duration=sl(p.duration)),p.repeatDelay&&(p.repeatDelay=sl(p.repeatDelay)),p.from!==void 0&&(p.keyframes[0]=p.from);let x=!1;if((p.type===!1||p.duration===0&&!p.repeatDelay)&&(Dy(p),p.delay===0&&(x=!0)),(yc.instantAnimations||yc.skipAnimations)&&(x=!0,Dy(p),p.delay=0),p.allowFlatten=!c.type&&!c.ease,x&&!i&&t.get()!==void 0){const v=JU(p.keyframes,c);if(v!==void 0){ga.update(()=>{p.onUpdate(v),p.onComplete()});return}}return c.isSync?new _b(p):new AV(p)};function iz({protectedKeys:e,needsAnimating:t},r){const a=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,a}function Vb(e,t,{delay:r=0,transitionOverride:a,type:n}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:o,...c}=t;a&&(i=a);const d=[],h=n&&e.animationState&&e.animationState.getState()[n];for(const p in c){const x=e.getValue(p,e.latestValues[p]??null),v=c[p];if(v===void 0||h&&iz(h,p))continue;const b={delay:r,...Cb(i||{},p)},N=x.get();if(N!==void 0&&!x.isAnimating&&!Array.isArray(v)&&v===N&&!b.velocity)continue;let _=!1;if(window.MotionHandoffAnimation){const T=H3(e);if(T){const A=window.MotionHandoffAnimation(T,p,ga);A!==null&&(b.startTime=A,_=!0)}}Uy(e,p),x.start(Bb(p,x,v,e.shouldReduceMotion&&d3.has(p)?{type:!1}:b,e,_));const C=x.animation;C&&d.push(C)}return o&&Promise.all(d).then(()=>{ga.update(()=>{o&&YU(e,o)})}),d}function G3(e,t,r,a=0,n=1){const i=Array.from(e).sort((h,p)=>h.sortNodePosition(p)).indexOf(t),o=e.size,c=(o-1)*a;return typeof r=="function"?r(i,o):n===1?i*a:c-i*a}function zy(e,t,r={}){var d;const a=Lh(e,t,r.type==="exit"?(d=e.presenceContext)==null?void 0:d.custom:void 0);let{transition:n=e.getDefaultTransition()||{}}=a||{};r.transitionOverride&&(n=r.transitionOverride);const i=a?()=>Promise.all(Vb(e,a,r)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?(h=0)=>{const{delayChildren:p=0,staggerChildren:x,staggerDirection:v}=n;return oz(e,t,h,p,x,v,r)}:()=>Promise.resolve(),{when:c}=n;if(c){const[h,p]=c==="beforeChildren"?[i,o]:[o,i];return h().then(()=>p())}else return Promise.all([i(),o(r.delay)])}function oz(e,t,r=0,a=0,n=0,i=1,o){const c=[];for(const d of e.variantChildren)d.notify("AnimationStart",t),c.push(zy(d,t,{...o,delay:r+(typeof a=="function"?0:a)+G3(e.variantChildren,d,a,n,i)}).then(()=>d.notify("AnimationComplete",t)));return Promise.all(c)}function lz(e,t,r={}){e.notify("AnimationStart",t);let a;if(Array.isArray(t)){const n=t.map(i=>zy(e,i,r));a=Promise.all(n)}else if(typeof t=="string")a=zy(e,t,r);else{const n=typeof t=="function"?Lh(e,t,r.custom):t;a=Promise.all(Vb(e,n,r))}return a.then(()=>{e.notify("AnimationComplete",t)})}function K3(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let a=0;a<r;a++)if(t[a]!==e[a])return!1;return!0}const cz=Pb.length;function X3(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?X3(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<cz;r++){const a=Pb[r],n=e.props[a];(_p(n)||n===!1)&&(t[a]=n)}return t}const dz=[...Rb].reverse(),uz=Rb.length;function hz(e){return t=>Promise.all(t.map(({animation:r,options:a})=>lz(e,r,a)))}function fz(e){let t=hz(e),r=SN(),a=!0;const n=d=>(h,p)=>{var v;const x=Lh(e,p,d==="exit"?(v=e.presenceContext)==null?void 0:v.custom:void 0);if(x){const{transition:b,transitionEnd:N,..._}=x;h={...h,..._,...N}}return h};function i(d){t=d(e)}function o(d){const{props:h}=e,p=X3(e.parent)||{},x=[],v=new Set;let b={},N=1/0;for(let C=0;C<uz;C++){const T=dz[C],A=r[T],k=h[T]!==void 0?h[T]:p[T],I=_p(k),B=T===d?A.isActive:null;B===!1&&(N=C);let O=k===p[T]&&k!==h[T]&&I;if(O&&a&&e.manuallyAnimateOnMount&&(O=!1),A.protectedKeys={...b},!A.isActive&&B===null||!k&&!A.prevProp||Lg(k)||typeof k=="boolean")continue;const D=mz(A.prevProp,k);let F=D||T===d&&A.isActive&&!O&&I||C>N&&I,M=!1;const z=Array.isArray(k)?k:[k];let q=z.reduce(n(T),{});B===!1&&(q={});const{prevResolvedValues:Y={}}=A,ae={...Y,...q},je=G=>{F=!0,v.has(G)&&(M=!0,v.delete(G)),A.needsAnimating[G]=!0;const Q=e.getValue(G);Q&&(Q.liveStyle=!1)};for(const G in ae){const Q=q[G],re=Y[G];if(b.hasOwnProperty(G))continue;let le=!1;Vy(Q)&&Vy(re)?le=!K3(Q,re):le=Q!==re,le?Q!=null?je(G):v.add(G):Q!==void 0&&v.has(G)?je(G):A.protectedKeys[G]=!0}A.prevProp=k,A.prevResolvedValues=q,A.isActive&&(b={...b,...q}),a&&e.blockInitialAnimation&&(F=!1);const H=O&&D;F&&(!H||M)&&x.push(...z.map(G=>{const Q={type:T};if(typeof G=="string"&&a&&!H&&e.manuallyAnimateOnMount&&e.parent){const{parent:re}=e,le=Lh(re,G);if(re.enteringChildren&&le){const{delayChildren:ye}=le.transition||{};Q.delay=G3(re.enteringChildren,e,ye)}}return{animation:G,options:Q}}))}if(v.size){const C={};if(typeof h.initial!="boolean"){const T=Lh(e,Array.isArray(h.initial)?h.initial[0]:h.initial);T&&T.transition&&(C.transition=T.transition)}v.forEach(T=>{const A=e.getBaseTarget(T),k=e.getValue(T);k&&(k.liveStyle=!0),C[T]=A??null}),x.push({animation:C})}let _=!!x.length;return a&&(h.initial===!1||h.initial===h.animate)&&!e.manuallyAnimateOnMount&&(_=!1),a=!1,_?t(x):Promise.resolve()}function c(d,h){var x;if(r[d].isActive===h)return Promise.resolve();(x=e.variantChildren)==null||x.forEach(v=>{var b;return(b=v.animationState)==null?void 0:b.setActive(d,h)}),r[d].isActive=h;const p=o(d);for(const v in r)r[v].protectedKeys={};return p}return{animateChanges:o,setActive:c,setAnimateFunction:i,getState:()=>r,reset:()=>{r=SN()}}}function mz(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!K3(t,e):!1}function Qd(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function SN(){return{animate:Qd(!0),whileInView:Qd(),whileHover:Qd(),whileTap:Qd(),whileDrag:Qd(),whileFocus:Qd(),exit:Qd()}}class Bd{constructor(t){this.isMounted=!1,this.node=t}update(){}}class pz extends Bd{constructor(t){super(t),t.animationState||(t.animationState=fz(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();Lg(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let xz=0;class gz extends Bd{constructor(){super(...arguments),this.id=xz++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:a}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===a)return;const n=this.node.animationState.setActive("exit",!t);r&&!t&&n.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const vz={animation:{Feature:pz},exit:{Feature:gz}};function Cp(e,t,r,a={passive:!0}){return e.addEventListener(t,r,a),()=>e.removeEventListener(t,r)}function Qp(e){return{point:{x:e.pageX,y:e.pageY}}}const yz=e=>t=>Ab(t)&&e(t,Qp(t));function zm(e,t,r,a){return Cp(e,t,yz(r),a)}const Y3=1e-4,wz=1-Y3,bz=1+Y3,Z3=.01,_z=0-Z3,jz=0+Z3;function xi(e){return e.max-e.min}function Nz(e,t,r){return Math.abs(e-t)<=r}function TN(e,t,r,a=.5){e.origin=a,e.originPoint=ba(t.min,t.max,e.origin),e.scale=xi(r)/xi(t),e.translate=ba(r.min,r.max,e.origin)-e.originPoint,(e.scale>=wz&&e.scale<=bz||isNaN(e.scale))&&(e.scale=1),(e.translate>=_z&&e.translate<=jz||isNaN(e.translate))&&(e.translate=0)}function $m(e,t,r,a){TN(e.x,t.x,r.x,a?a.originX:void 0),TN(e.y,t.y,r.y,a?a.originY:void 0)}function AN(e,t,r){e.min=r.min+t.min,e.max=e.min+xi(t)}function Cz(e,t,r){AN(e.x,t.x,r.x),AN(e.y,t.y,r.y)}function kN(e,t,r){e.min=t.min-r.min,e.max=e.min+xi(t)}function qm(e,t,r){kN(e.x,t.x,r.x),kN(e.y,t.y,r.y)}function fo(e){return[e("x"),e("y")]}const Q3=({current:e})=>e?e.ownerDocument.defaultView:null,RN=(e,t)=>Math.abs(e-t);function Ez(e,t){const r=RN(e.x,t.x),a=RN(e.y,t.y);return Math.sqrt(r**2+a**2)}class J3{constructor(t,r,{transformPagePoint:a,contextWindow:n=window,dragSnapToOrigin:i=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=X1(this.lastMoveEventInfo,this.history),b=this.startEvent!==null,N=Ez(v.offset,{x:0,y:0})>=this.distanceThreshold;if(!b&&!N)return;const{point:_}=v,{timestamp:C}=Tn;this.history.push({..._,timestamp:C});const{onStart:T,onMove:A}=this.handlers;b||(T&&T(this.lastMoveEvent,v),this.startEvent=this.lastMoveEvent),A&&A(this.lastMoveEvent,v)},this.handlePointerMove=(v,b)=>{this.lastMoveEvent=v,this.lastMoveEventInfo=K1(b,this.transformPagePoint),ga.update(this.updatePoint,!0)},this.handlePointerUp=(v,b)=>{this.end();const{onEnd:N,onSessionEnd:_,resumeAnimation:C}=this.handlers;if(this.dragSnapToOrigin&&C&&C(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=X1(v.type==="pointercancel"?this.lastMoveEventInfo:K1(b,this.transformPagePoint),this.history);this.startEvent&&N&&N(v,T),_&&_(v,T)},!Ab(t))return;this.dragSnapToOrigin=i,this.handlers=r,this.transformPagePoint=a,this.distanceThreshold=o,this.contextWindow=n||window;const c=Qp(t),d=K1(c,this.transformPagePoint),{point:h}=d,{timestamp:p}=Tn;this.history=[{...h,timestamp:p}];const{onSessionStart:x}=r;x&&x(t,X1(d,this.history)),this.removeListeners=Xp(zm(this.contextWindow,"pointermove",this.handlePointerMove),zm(this.contextWindow,"pointerup",this.handlePointerUp),zm(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),wc(this.updatePoint)}}function K1(e,t){return t?{point:t(e.point)}:e}function PN(e,t){return{x:e.x-t.x,y:e.y-t.y}}function X1({point:e},t){return{point:e,delta:PN(e,ek(t)),offset:PN(e,Sz(t)),velocity:Tz(t,.1)}}function Sz(e){return e[0]}function ek(e){return e[e.length-1]}function Tz(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,a=null;const n=ek(e);for(;r>=0&&(a=e[r],!(n.timestamp-a.timestamp>sl(t)));)r--;if(!a)return{x:0,y:0};const i=bo(n.timestamp-a.timestamp);if(i===0)return{x:0,y:0};const o={x:(n.x-a.x)/i,y:(n.y-a.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Az(e,{min:t,max:r},a){return t!==void 0&&e<t?e=a?ba(t,e,a.min):Math.max(e,t):r!==void 0&&e>r&&(e=a?ba(r,e,a.max):Math.min(e,r)),e}function IN(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function kz(e,{top:t,left:r,bottom:a,right:n}){return{x:IN(e.x,r,n),y:IN(e.y,t,a)}}function ON(e,t){let r=t.min-e.min,a=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,a]=[a,r]),{min:r,max:a}}function Rz(e,t){return{x:ON(e.x,t.x),y:ON(e.y,t.y)}}function Pz(e,t){let r=.5;const a=xi(e),n=xi(t);return n>a?r=df(t.min,t.max-a,e.min):a>n&&(r=df(e.min,e.max-n,t.min)),vc(0,1,r)}function Iz(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const $y=.35;function Oz(e=$y){return e===!1?e=0:e===!0&&(e=$y),{x:DN(e,"left","right"),y:DN(e,"top","bottom")}}function DN(e,t,r){return{min:MN(e,t),max:MN(e,r)}}function MN(e,t){return typeof e=="number"?e:e[t]||0}const Dz=new WeakMap;class Mz{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ka(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:a}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const i=x=>{const{dragSnapToOrigin:v}=this.getProps();v?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(Qp(x).point)},o=(x,v)=>{const{drag:b,dragPropagation:N,onDragStart:_}=this.getProps();if(b&&!N&&(this.openDragLock&&this.openDragLock(),this.openDragLock=HV(b),!this.openDragLock))return;this.latestPointerEvent=x,this.latestPanInfo=v,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),fo(T=>{let A=this.getAxisMotionValue(T).get()||0;if(Ol.test(A)){const{projection:k}=this.visualElement;if(k&&k.layout){const I=k.layout.layoutBox[T];I&&(A=xi(I)*(parseFloat(A)/100))}}this.originPoint[T]=A}),_&&ga.postRender(()=>_(x,v)),Uy(this.visualElement,"transform");const{animationState:C}=this.visualElement;C&&C.setActive("whileDrag",!0)},c=(x,v)=>{this.latestPointerEvent=x,this.latestPanInfo=v;const{dragPropagation:b,dragDirectionLock:N,onDirectionLock:_,onDrag:C}=this.getProps();if(!b&&!this.openDragLock)return;const{offset:T}=v;if(N&&this.currentDirection===null){this.currentDirection=Lz(T),this.currentDirection!==null&&_&&_(this.currentDirection);return}this.updateAxis("x",v.point,T),this.updateAxis("y",v.point,T),this.visualElement.render(),C&&C(x,v)},d=(x,v)=>{this.latestPointerEvent=x,this.latestPanInfo=v,this.stop(x,v),this.latestPointerEvent=null,this.latestPanInfo=null},h=()=>fo(x=>{var v;return this.getAnimationState(x)==="paused"&&((v=this.getAxisMotionValue(x).animation)==null?void 0:v.play())}),{dragSnapToOrigin:p}=this.getProps();this.panSession=new J3(t,{onSessionStart:i,onStart:o,onMove:c,onSessionEnd:d,resumeAnimation:h},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:p,distanceThreshold:a,contextWindow:Q3(this.visualElement)})}stop(t,r){const a=t||this.latestPointerEvent,n=r||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!n||!a)return;const{velocity:o}=n;this.startAnimation(o);const{onDragEnd:c}=this.getProps();c&&ga.postRender(()=>c(a,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:a}=this.getProps();!a&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,a){const{drag:n}=this.getProps();if(!a||!V0(t,n,this.currentDirection))return;const i=this.getAxisMotionValue(t);let o=this.originPoint[t]+a[t];this.constraints&&this.constraints[t]&&(o=Az(o,this.constraints[t],this.elastic[t])),i.set(o)}resolveConstraints(){var i;const{dragConstraints:t,dragElastic:r}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,n=this.constraints;t&&Ah(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&a?this.constraints=kz(a.layoutBox,t):this.constraints=!1,this.elastic=Oz(r),n!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&fo(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=Iz(a.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Ah(t))return!1;const a=t.current,{projection:n}=this.visualElement;if(!n||!n.layout)return!1;const i=zU(a,n.root,this.visualElement.getTransformPagePoint());let o=Rz(n.layout.layoutBox,i);if(r){const c=r(BU(o));this.hasMutatedConstraints=!!c,c&&(o=D3(c))}return o}startAnimation(t){const{drag:r,dragMomentum:a,dragElastic:n,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:c}=this.getProps(),d=this.constraints||{},h=fo(p=>{if(!V0(p,r,this.currentDirection))return;let x=d&&d[p]||{};o&&(x={min:0,max:0});const v=n?200:1e6,b=n?40:1e7,N={type:"inertia",velocity:a?t[p]:0,bounceStiffness:v,bounceDamping:b,timeConstant:750,restDelta:1,restSpeed:10,...i,...x};return this.startAxisValueAnimation(p,N)});return Promise.all(h).then(c)}startAxisValueAnimation(t,r){const a=this.getAxisMotionValue(t);return Uy(this.visualElement,t),a.start(Bb(t,a,0,r,this.visualElement,!1))}stopAnimation(){fo(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){fo(t=>{var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,a=this.visualElement.getProps(),n=a[r];return n||this.visualElement.getValue(t,(a.initial?a.initial[t]:void 0)||0)}snapToCursor(t){fo(r=>{const{drag:a}=this.getProps();if(!V0(r,a,this.currentDirection))return;const{projection:n}=this.visualElement,i=this.getAxisMotionValue(r);if(n&&n.layout){const{min:o,max:c}=n.layout.layoutBox[r];i.set(t[r]-ba(o,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:a}=this.visualElement;if(!Ah(r)||!a||!this.constraints)return;this.stopAnimation();const n={x:0,y:0};fo(o=>{const c=this.getAxisMotionValue(o);if(c&&this.constraints!==!1){const d=c.get();n[o]=Pz({min:d,max:d},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",a.root&&a.root.updateScroll(),a.updateLayout(),this.resolveConstraints(),fo(o=>{if(!V0(o,t,null))return;const c=this.getAxisMotionValue(o),{min:d,max:h}=this.constraints[o];c.set(ba(d,h,n[o]))})}addListeners(){if(!this.visualElement.current)return;Dz.set(this.visualElement,this);const t=this.visualElement.current,r=zm(t,"pointerdown",d=>{const{drag:h,dragListener:p=!0}=this.getProps();h&&p&&this.start(d)}),a=()=>{const{dragConstraints:d}=this.getProps();Ah(d)&&d.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,i=n.addEventListener("measure",a);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),ga.read(a);const o=Cp(window,"resize",()=>this.scalePositionWithinConstraints()),c=n.addEventListener("didUpdate",({delta:d,hasLayoutChanged:h})=>{this.isDragging&&h&&(fo(p=>{const x=this.getAxisMotionValue(p);x&&(this.originPoint[p]+=d[p].translate,x.set(x.get()+d[p].translate))}),this.visualElement.render())});return()=>{o(),r(),i(),c&&c()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:a=!1,dragPropagation:n=!1,dragConstraints:i=!1,dragElastic:o=$y,dragMomentum:c=!0}=t;return{...t,drag:r,dragDirectionLock:a,dragPropagation:n,dragConstraints:i,dragElastic:o,dragMomentum:c}}}function V0(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function Lz(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class Fz extends Bd{constructor(t){super(t),this.removeGroupControls=jo,this.removeListeners=jo,this.controls=new Mz(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||jo}unmount(){this.removeGroupControls(),this.removeListeners()}}const LN=e=>(t,r)=>{e&&ga.postRender(()=>e(t,r))};class Bz extends Bd{constructor(){super(...arguments),this.removePointerDownListener=jo}onPointerDown(t){this.session=new J3(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Q3(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:a,onPanEnd:n}=this.node.getProps();return{onSessionStart:LN(t),onStart:LN(r),onMove:a,onEnd:(i,o)=>{delete this.session,n&&ga.postRender(()=>n(i,o))}}}mount(){this.removePointerDownListener=zm(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const px={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function FN(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const mm={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Us.test(e))e=parseFloat(e);else return e;const r=FN(e,t.target.x),a=FN(e,t.target.y);return`${r}% ${a}%`}},Vz={correct:(e,{treeScale:t,projectionDelta:r})=>{const a=e,n=Sd.parse(e);if(n.length>5)return a;const i=Sd.createTransformer(e),o=typeof n[0]!="number"?1:0,c=r.x.scale*t.x,d=r.y.scale*t.y;n[0+o]/=c,n[1+o]/=d;const h=ba(c,d,.5);return typeof n[2+o]=="number"&&(n[2+o]/=h),typeof n[3+o]=="number"&&(n[3+o]/=h),i(n)}};let Y1=!1;class Uz extends E.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:a,layoutId:n}=this.props,{projection:i}=t;fU(zz),i&&(r.group&&r.group.add(i),a&&a.register&&n&&a.register(i),Y1&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),px.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:a,drag:n,isPresent:i}=this.props,{projection:o}=a;return o&&(o.isPresent=i,Y1=!0,n||t.layoutDependency!==r||r===void 0||t.isPresent!==i?o.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?o.promote():o.relegate()||ga.postRender(()=>{const c=o.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),Tb.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:a}=this.props,{projection:n}=t;Y1=!0,n&&(n.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(n),a&&a.deregister&&a.deregister(n))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function tk(e){const[t,r]=b3(),a=E.useContext(ib);return s.jsx(Uz,{...e,layoutGroup:a,switchLayoutGroup:E.useContext(I3),isPresent:t,safeToRemove:r})}const zz={borderRadius:{...mm,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:mm,borderTopRightRadius:mm,borderBottomLeftRadius:mm,borderBottomRightRadius:mm,boxShadow:Vz};function sk(e,t,r){const a=yn(e)?e:Iu(e);return a.start(Bb("",a,t,r)),a.animation}const $z=(e,t)=>e.depth-t.depth;class qz{constructor(){this.children=[],this.isDirty=!1}add(t){cb(this.children,t),this.isDirty=!0}remove(t){Og(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort($z),this.isDirty=!1,this.children.forEach(t)}}function Wz(e,t){const r=Si.now(),a=({timestamp:n})=>{const i=n-r;i>=t&&(wc(a),e(i-t))};return ga.setup(a,!0),()=>wc(a)}const rk=["TopLeft","TopRight","BottomLeft","BottomRight"],Hz=rk.length,BN=e=>typeof e=="string"?parseFloat(e):e,VN=e=>typeof e=="number"||Us.test(e);function Gz(e,t,r,a,n,i){n?(e.opacity=ba(0,r.opacity??1,Kz(a)),e.opacityExit=ba(t.opacity??1,0,Xz(a))):i&&(e.opacity=ba(t.opacity??1,r.opacity??1,a));for(let o=0;o<Hz;o++){const c=`border${rk[o]}Radius`;let d=UN(t,c),h=UN(r,c);if(d===void 0&&h===void 0)continue;d||(d=0),h||(h=0),d===0||h===0||VN(d)===VN(h)?(e[c]=Math.max(ba(BN(d),BN(h),a),0),(Ol.test(h)||Ol.test(d))&&(e[c]+="%")):e[c]=h}(t.rotate||r.rotate)&&(e.rotate=ba(t.rotate||0,r.rotate||0,a))}function UN(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const Kz=ak(0,.5,MA),Xz=ak(.5,.95,jo);function ak(e,t,r){return a=>a<e?0:a>t?1:r(df(e,t,a))}function zN(e,t){e.min=t.min,e.max=t.max}function uo(e,t){zN(e.x,t.x),zN(e.y,t.y)}function $N(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function qN(e,t,r,a,n){return e-=t,e=qx(e,1/r,a),n!==void 0&&(e=qx(e,1/n,a)),e}function Yz(e,t=0,r=1,a=.5,n,i=e,o=e){if(Ol.test(t)&&(t=parseFloat(t),t=ba(o.min,o.max,t/100)-o.min),typeof t!="number")return;let c=ba(i.min,i.max,a);e===i&&(c-=t),e.min=qN(e.min,t,r,c,n),e.max=qN(e.max,t,r,c,n)}function WN(e,t,[r,a,n],i,o){Yz(e,t[r],t[a],t[n],t.scale,i,o)}const Zz=["x","scaleX","originX"],Qz=["y","scaleY","originY"];function HN(e,t,r,a){WN(e.x,t,Zz,r?r.x:void 0,a?a.x:void 0),WN(e.y,t,Qz,r?r.y:void 0,a?a.y:void 0)}function GN(e){return e.translate===0&&e.scale===1}function nk(e){return GN(e.x)&&GN(e.y)}function KN(e,t){return e.min===t.min&&e.max===t.max}function Jz(e,t){return KN(e.x,t.x)&&KN(e.y,t.y)}function XN(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function ik(e,t){return XN(e.x,t.x)&&XN(e.y,t.y)}function YN(e){return xi(e.x)/xi(e.y)}function ZN(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class e${constructor(){this.members=[]}add(t){cb(this.members,t),t.scheduleRender()}remove(t){if(Og(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(n=>t===n);if(r===0)return!1;let a;for(let n=r;n>=0;n--){const i=this.members[n];if(i.isPresent!==!1){a=i;break}}return a?(this.promote(a),!0):!1}promote(t,r){const a=this.lead;if(t!==a&&(this.prevLead=a,this.lead=t,t.show(),a)){a.instance&&a.scheduleRender(),t.scheduleRender(),t.resumeFrom=a,r&&(t.resumeFrom.preserveOpacity=!0),a.snapshot&&(t.snapshot=a.snapshot,t.snapshot.latestValues=a.animationValues||a.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:n}=t.options;n===!1&&a.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:a}=t;r.onExitComplete&&r.onExitComplete(),a&&a.options.onExitComplete&&a.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function t$(e,t,r){let a="";const n=e.x.translate/t.x,i=e.y.translate/t.y,o=(r==null?void 0:r.z)||0;if((n||i||o)&&(a=`translate3d(${n}px, ${i}px, ${o}px) `),(t.x!==1||t.y!==1)&&(a+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:h,rotate:p,rotateX:x,rotateY:v,skewX:b,skewY:N}=r;h&&(a=`perspective(${h}px) ${a}`),p&&(a+=`rotate(${p}deg) `),x&&(a+=`rotateX(${x}deg) `),v&&(a+=`rotateY(${v}deg) `),b&&(a+=`skewX(${b}deg) `),N&&(a+=`skewY(${N}deg) `)}const c=e.x.scale*t.x,d=e.y.scale*t.y;return(c!==1||d!==1)&&(a+=`scale(${c}, ${d})`),a||"none"}const Z1=["","X","Y","Z"],s$=1e3;let r$=0;function Q1(e,t,r,a){const{latestValues:n}=t;n[e]&&(r[e]=n[e],t.setStaticValue(e,0),a&&(a[e]=0))}function ok(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=H3(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:n,layoutId:i}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",ga,!(n||i))}const{parent:a}=e;a&&!a.hasCheckedOptimisedAppear&&ok(a)}function lk({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:a,resetTransform:n}){return class{constructor(o={},c=t==null?void 0:t()){this.id=r$++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(i$),this.nodes.forEach(d$),this.nodes.forEach(u$),this.nodes.forEach(o$)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let d=0;d<this.path.length;d++)this.path[d].shouldResetTransform=!0;this.root===this&&(this.nodes=new qz)}addEventListener(o,c){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new ub),this.eventHandlers.get(o).add(c)}notifyListeners(o,...c){const d=this.eventHandlers.get(o);d&&d.notify(...c)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=kb(o)&&!w3(o),this.instance=o;const{layoutId:c,layout:d,visualElement:h}=this.options;if(h&&!h.current&&h.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(d||c)&&(this.isLayoutDirty=!0),e){let p,x=0;const v=()=>this.root.updateBlockedByResize=!1;ga.read(()=>{x=window.innerWidth}),e(o,()=>{const b=window.innerWidth;b!==x&&(x=b,this.root.updateBlockedByResize=!0,p&&p(),p=Wz(v,250),px.hasAnimatedSinceResize&&(px.hasAnimatedSinceResize=!1,this.nodes.forEach(eC)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&h&&(c||d)&&this.addEventListener("didUpdate",({delta:p,hasLayoutChanged:x,hasRelativeLayoutChanged:v,layout:b})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const N=this.options.transition||h.getDefaultTransition()||x$,{onLayoutAnimationStart:_,onLayoutAnimationComplete:C}=h.getProps(),T=!this.targetLayout||!ik(this.targetLayout,b),A=!x&&v;if(this.options.layoutRoot||this.resumeFrom||A||x&&(T||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const k={...Cb(N,"layout"),onPlay:_,onComplete:C};(h.shouldReduceMotion||this.options.layoutRoot)&&(k.delay=0,k.type=!1),this.startAnimation(k),this.setAnimationOrigin(p,A)}else x||eC(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=b})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),wc(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(h$),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&ok(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let p=0;p<this.path.length;p++){const x=this.path[p];x.shouldResetTransform=!0,x.updateScroll("snapshot"),x.options.layoutRoot&&x.willUpdate(!1)}const{layoutId:c,layout:d}=this.options;if(c===void 0&&!d)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(QN);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(JN);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(c$),this.nodes.forEach(a$),this.nodes.forEach(n$)):this.nodes.forEach(JN),this.clearAllSnapshots();const c=Si.now();Tn.delta=vc(0,1e3/60,c-Tn.timestamp),Tn.timestamp=c,Tn.isProcessing=!0,V1.update.process(Tn),V1.preRender.process(Tn),V1.render.process(Tn),Tn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Tb.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(l$),this.sharedNodes.forEach(f$)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ga.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ga.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!xi(this.snapshot.measuredBox.x)&&!xi(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let d=0;d<this.path.length;d++)this.path[d].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ka(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(c=!1),c&&this.instance){const d=a(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:d,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:d}}}resetTransform(){if(!n)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!nk(this.projectionDelta),d=this.getTransformTemplate(),h=d?d(this.latestValues,""):void 0,p=h!==this.prevTransformTemplateValue;o&&this.instance&&(c||su(this.latestValues)||p)&&(n(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const c=this.measurePageBox();let d=this.removeElementScroll(c);return o&&(d=this.removeTransform(d)),g$(d),{animationId:this.root.animationId,measuredBox:c,layoutBox:d,latestValues:{},source:this.id}}measurePageBox(){var h;const{visualElement:o}=this.options;if(!o)return ka();const c=o.measureViewportBox();if(!(((h=this.scroll)==null?void 0:h.wasRoot)||this.path.some(v$))){const{scroll:p}=this.root;p&&(kh(c.x,p.offset.x),kh(c.y,p.offset.y))}return c}removeElementScroll(o){var d;const c=ka();if(uo(c,o),(d=this.scroll)!=null&&d.wasRoot)return c;for(let h=0;h<this.path.length;h++){const p=this.path[h],{scroll:x,options:v}=p;p!==this.root&&x&&v.layoutScroll&&(x.wasRoot&&uo(c,o),kh(c.x,x.offset.x),kh(c.y,x.offset.y))}return c}applyTransform(o,c=!1){const d=ka();uo(d,o);for(let h=0;h<this.path.length;h++){const p=this.path[h];!c&&p.options.layoutScroll&&p.scroll&&p!==p.root&&Rh(d,{x:-p.scroll.offset.x,y:-p.scroll.offset.y}),su(p.latestValues)&&Rh(d,p.latestValues)}return su(this.latestValues)&&Rh(d,this.latestValues),d}removeTransform(o){const c=ka();uo(c,o);for(let d=0;d<this.path.length;d++){const h=this.path[d];if(!h.instance||!su(h.latestValues))continue;Ly(h.latestValues)&&h.updateSnapshot();const p=ka(),x=h.measurePageBox();uo(p,x),HN(c,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,p)}return su(this.latestValues)&&HN(c,this.latestValues),c}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Tn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var v;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==c;if(!(o||d&&this.isSharedProjectionDirty||this.isProjectionDirty||(v=this.parent)!=null&&v.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:p,layoutId:x}=this.options;if(!(!this.layout||!(p||x))){if(this.resolvedRelativeTargetAt=Tn.timestamp,!this.targetDelta&&!this.relativeTarget){const b=this.getClosestProjectingParent();b&&b.layout&&this.animationProgress!==1?(this.relativeParent=b,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ka(),this.relativeTargetOrigin=ka(),qm(this.relativeTargetOrigin,this.layout.layoutBox,b.layout.layoutBox),uo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=ka(),this.targetWithTransforms=ka()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Cz(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):uo(this.target,this.layout.layoutBox),L3(this.target,this.targetDelta)):uo(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const b=this.getClosestProjectingParent();b&&!!b.resumingFrom==!!this.resumingFrom&&!b.options.layoutScroll&&b.target&&this.animationProgress!==1?(this.relativeParent=b,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ka(),this.relativeTargetOrigin=ka(),qm(this.relativeTargetOrigin,this.target,b.target),uo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||Ly(this.parent.latestValues)||M3(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var N;const o=this.getLead(),c=!!this.resumingFrom||this!==o;let d=!0;if((this.isProjectionDirty||(N=this.parent)!=null&&N.isProjectionDirty)&&(d=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===Tn.timestamp&&(d=!1),d)return;const{layout:h,layoutId:p}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||p))return;uo(this.layoutCorrected,this.layout.layoutBox);const x=this.treeScale.x,v=this.treeScale.y;UU(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=ka());const{target:b}=o;if(!b){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():($N(this.prevProjectionDelta.x,this.projectionDelta.x),$N(this.prevProjectionDelta.y,this.projectionDelta.y)),$m(this.projectionDelta,this.layoutCorrected,b,this.latestValues),(this.treeScale.x!==x||this.treeScale.y!==v||!ZN(this.projectionDelta.x,this.prevProjectionDelta.x)||!ZN(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",b))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var c;if((c=this.options.visualElement)==null||c.scheduleRender(),o){const d=this.getStack();d&&d.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Ph(),this.projectionDelta=Ph(),this.projectionDeltaWithTransform=Ph()}setAnimationOrigin(o,c=!1){const d=this.snapshot,h=d?d.latestValues:{},p={...this.latestValues},x=Ph();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const v=ka(),b=d?d.source:void 0,N=this.layout?this.layout.source:void 0,_=b!==N,C=this.getStack(),T=!C||C.members.length<=1,A=!!(_&&!T&&this.options.crossfade===!0&&!this.path.some(p$));this.animationProgress=0;let k;this.mixTargetDelta=I=>{const B=I/1e3;tC(x.x,o.x,B),tC(x.y,o.y,B),this.setTargetDelta(x),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(qm(v,this.layout.layoutBox,this.relativeParent.layout.layoutBox),m$(this.relativeTarget,this.relativeTargetOrigin,v,B),k&&Jz(this.relativeTarget,k)&&(this.isProjectionDirty=!1),k||(k=ka()),uo(k,this.relativeTarget)),_&&(this.animationValues=p,Gz(p,h,this.latestValues,B,A,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=B},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var c,d,h;this.notifyListeners("animationStart"),(c=this.currentAnimation)==null||c.stop(),(h=(d=this.resumingFrom)==null?void 0:d.currentAnimation)==null||h.stop(),this.pendingAnimation&&(wc(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ga.update(()=>{px.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Iu(0)),this.currentAnimation=sk(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:p=>{this.mixTargetDelta(p),o.onUpdate&&o.onUpdate(p)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(s$),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:c,target:d,layout:h,latestValues:p}=o;if(!(!c||!d||!h)){if(this!==o&&this.layout&&h&&ck(this.options.animationType,this.layout.layoutBox,h.layoutBox)){d=this.target||ka();const x=xi(this.layout.layoutBox.x);d.x.min=o.target.x.min,d.x.max=d.x.min+x;const v=xi(this.layout.layoutBox.y);d.y.min=o.target.y.min,d.y.max=d.y.min+v}uo(c,d),Rh(c,p),$m(this.projectionDeltaWithTransform,this.layoutCorrected,c,p)}}registerSharedNode(o,c){this.sharedNodes.has(o)||this.sharedNodes.set(o,new e$),this.sharedNodes.get(o).add(c);const h=c.options.initialPromotionConfig;c.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(c):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var c;const{layoutId:o}=this.options;return o?((c=this.getStack())==null?void 0:c.lead)||this:this}getPrevLead(){var c;const{layoutId:o}=this.options;return o?(c=this.getStack())==null?void 0:c.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:c,preserveFollowOpacity:d}={}){const h=this.getStack();h&&h.promote(this,d),o&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let c=!1;const{latestValues:d}=o;if((d.z||d.rotate||d.rotateX||d.rotateY||d.rotateZ||d.skewX||d.skewY)&&(c=!0),!c)return;const h={};d.z&&Q1("z",o,h,this.animationValues);for(let p=0;p<Z1.length;p++)Q1(`rotate${Z1[p]}`,o,h,this.animationValues),Q1(`skew${Z1[p]}`,o,h,this.animationValues);o.render();for(const p in h)o.setStaticValue(p,h[p]),this.animationValues&&(this.animationValues[p]=h[p]);o.scheduleRender()}applyProjectionStyles(o,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const d=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=mx(c==null?void 0:c.pointerEvents)||"",o.transform=d?d(this.latestValues,""):"none";return}const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=mx(c==null?void 0:c.pointerEvents)||""),this.hasProjected&&!su(this.latestValues)&&(o.transform=d?d({},""):"none",this.hasProjected=!1);return}o.visibility="";const p=h.animationValues||h.latestValues;this.applyTransformsToTarget();let x=t$(this.projectionDeltaWithTransform,this.treeScale,p);d&&(x=d(p,x)),o.transform=x;const{x:v,y:b}=this.projectionDelta;o.transformOrigin=`${v.origin*100}% ${b.origin*100}% 0`,h.animationValues?o.opacity=h===this?p.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:o.opacity=h===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const N in jp){if(p[N]===void 0)continue;const{correct:_,applyTo:C,isCSSVariable:T}=jp[N],A=x==="none"?p[N]:_(p[N],h);if(C){const k=C.length;for(let I=0;I<k;I++)o[C[I]]=A}else T?this.options.visualElement.renderState.vars[N]=A:o[N]=A}this.options.layoutId&&(o.pointerEvents=h===this?mx(c==null?void 0:c.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var c;return(c=o.currentAnimation)==null?void 0:c.stop()}),this.root.nodes.forEach(QN),this.root.sharedNodes.clear()}}}function a$(e){e.updateLayout()}function n$(e){var r;const t=((r=e.resumeFrom)==null?void 0:r.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:a,measuredBox:n}=e.layout,{animationType:i}=e.options,o=t.source!==e.layout.source;i==="size"?fo(x=>{const v=o?t.measuredBox[x]:t.layoutBox[x],b=xi(v);v.min=a[x].min,v.max=v.min+b}):ck(i,t.layoutBox,a)&&fo(x=>{const v=o?t.measuredBox[x]:t.layoutBox[x],b=xi(a[x]);v.max=v.min+b,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[x].max=e.relativeTarget[x].min+b)});const c=Ph();$m(c,a,t.layoutBox);const d=Ph();o?$m(d,e.applyTransform(n,!0),t.measuredBox):$m(d,a,t.layoutBox);const h=!nk(c);let p=!1;if(!e.resumeFrom){const x=e.getClosestProjectingParent();if(x&&!x.resumeFrom){const{snapshot:v,layout:b}=x;if(v&&b){const N=ka();qm(N,t.layoutBox,v.layoutBox);const _=ka();qm(_,a,b.layoutBox),ik(N,_)||(p=!0),x.options.layoutRoot&&(e.relativeTarget=_,e.relativeTargetOrigin=N,e.relativeParent=x)}}}e.notifyListeners("didUpdate",{layout:a,snapshot:t,delta:d,layoutDelta:c,hasLayoutChanged:h,hasRelativeLayoutChanged:p})}else if(e.isLead()){const{onExitComplete:a}=e.options;a&&a()}e.options.transition=void 0}function i$(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function o$(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function l$(e){e.clearSnapshot()}function QN(e){e.clearMeasurements()}function JN(e){e.isLayoutDirty=!1}function c$(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function eC(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function d$(e){e.resolveTargetDelta()}function u$(e){e.calcProjection()}function h$(e){e.resetSkewAndRotation()}function f$(e){e.removeLeadSnapshot()}function tC(e,t,r){e.translate=ba(t.translate,0,r),e.scale=ba(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function sC(e,t,r,a){e.min=ba(t.min,r.min,a),e.max=ba(t.max,r.max,a)}function m$(e,t,r,a){sC(e.x,t.x,r.x,a),sC(e.y,t.y,r.y,a)}function p$(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const x$={duration:.45,ease:[.4,0,.1,1]},rC=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),aC=rC("applewebkit/")&&!rC("chrome/")?Math.round:jo;function nC(e){e.min=aC(e.min),e.max=aC(e.max)}function g$(e){nC(e.x),nC(e.y)}function ck(e,t,r){return e==="position"||e==="preserve-aspect"&&!Nz(YN(t),YN(r),.2)}function v$(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const y$=lk({attachResizeListener:(e,t)=>Cp(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),J1={current:void 0},dk=lk({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!J1.current){const e=new y$({});e.mount(window),e.setOptions({layoutScroll:!0}),J1.current=e}return J1.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),w$={pan:{Feature:Bz},drag:{Feature:Fz,ProjectionNode:dk,MeasureLayout:tk}};function iC(e,t,r){const{props:a}=e;e.animationState&&a.whileHover&&e.animationState.setActive("whileHover",r==="Start");const n="onHover"+r,i=a[n];i&&ga.postRender(()=>i(t,Qp(t)))}class b$ extends Bd{mount(){const{current:t}=this.node;t&&(this.unmount=GV(t,(r,a)=>(iC(this.node,a,"Start"),n=>iC(this.node,n,"End"))))}unmount(){}}class _$ extends Bd{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Xp(Cp(this.node.current,"focus",()=>this.onFocus()),Cp(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function oC(e,t,r){const{props:a}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&a.whileTap&&e.animationState.setActive("whileTap",r==="Start");const n="onTap"+(r==="End"?"":r),i=a[n];i&&ga.postRender(()=>i(t,Qp(t)))}class j$ extends Bd{mount(){const{current:t}=this.node;t&&(this.unmount=ZV(t,(r,a)=>(oC(this.node,a,"Start"),(n,{success:i})=>oC(this.node,n,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const qy=new WeakMap,ev=new WeakMap,N$=e=>{const t=qy.get(e.target);t&&t(e)},C$=e=>{e.forEach(N$)};function E$({root:e,...t}){const r=e||document;ev.has(r)||ev.set(r,{});const a=ev.get(r),n=JSON.stringify(t);return a[n]||(a[n]=new IntersectionObserver(C$,{root:e,...t})),a[n]}function S$(e,t,r){const a=E$(t);return qy.set(e,r),a.observe(e),()=>{qy.delete(e),a.unobserve(e)}}const T$={some:0,all:1};class A$ extends Bd{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:a,amount:n="some",once:i}=t,o={root:r?r.current:void 0,rootMargin:a,threshold:typeof n=="number"?n:T$[n]},c=d=>{const{isIntersecting:h}=d;if(this.isInView===h||(this.isInView=h,i&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:p,onViewportLeave:x}=this.node.getProps(),v=h?p:x;v&&v(d)};return S$(this.node.current,o,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(k$(t,r))&&this.startObserver()}unmount(){}}function k$({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const R$={inView:{Feature:A$},tap:{Feature:j$},focus:{Feature:_$},hover:{Feature:b$}},P$={layout:{ProjectionNode:dk,MeasureLayout:tk}},I$={...vz,...R$,...w$,...P$},Ee=FU(I$,GU);function uk(e){const t=Kp(()=>Iu(e)),{isStatic:r}=E.useContext(Dg);if(r){const[,a]=E.useState(e);E.useEffect(()=>t.on("change",a),[])}return t}function hk(e,t){const r=uk(t()),a=()=>r.set(t());return a(),lb(()=>{const n=()=>ga.preRender(a,!1,!0),i=e.map(o=>o.on("change",n));return()=>{i.forEach(o=>o()),wc(a)}}),r}function O$(e){Um.current=[],e();const t=hk(Um.current,e);return Um.current=void 0,t}function D$(e,t,r,a){if(typeof e=="function")return O$(e);const n=typeof t=="function"?t:QV(t,r,a);return Array.isArray(e)?lC(e,n):lC([e],([i])=>n(i))}function lC(e,t){const r=Kp(()=>[]);return hk(e,()=>{r.length=0;const a=e.length;for(let n=0;n<a;n++)r[n]=e[n].get();return t(r)})}function Ub(e){return typeof e=="object"&&!Array.isArray(e)}function fk(e,t,r,a){return typeof e=="string"&&Ub(t)?Sb(e,r,a):e instanceof NodeList?Array.from(e):Array.isArray(e)?e:[e]}function M$(e,t,r){return e*(t+1)}function cC(e,t,r,a){return typeof t=="number"?t:t.startsWith("-")||t.startsWith("+")?Math.max(0,e+parseFloat(t)):t==="<"?r:t.startsWith("<")?Math.max(0,r+parseFloat(t.slice(1))):a.get(t)??e}function L$(e,t,r){for(let a=0;a<e.length;a++){const n=e[a];n.at>t&&n.at<r&&(Og(e,n),a--)}}function F$(e,t,r,a,n,i){L$(e,n,i);for(let o=0;o<t.length;o++)e.push({value:t[o],at:ba(n,i,a[o]),easing:VA(r,o)})}function B$(e,t){for(let r=0;r<e.length;r++)e[r]=e[r]/(t+1)}function V$(e,t){return e.at===t.at?e.value===null?1:t.value===null?-1:0:e.at-t.at}const U$="easeInOut";function z$(e,{defaultTransition:t={},...r}={},a,n){const i=t.duration||.3,o=new Map,c=new Map,d={},h=new Map;let p=0,x=0,v=0;for(let b=0;b<e.length;b++){const N=e[b];if(typeof N=="string"){h.set(N,x);continue}else if(!Array.isArray(N)){h.set(N.name,cC(x,N.at,p,h));continue}let[_,C,T={}]=N;T.at!==void 0&&(x=cC(x,T.at,p,h));let A=0;const k=(I,B,O,D=0,F=0)=>{const M=$$(I),{delay:z=0,times:q=s3(M),type:Y="keyframes",repeat:ae,repeatType:je,repeatDelay:H=0,...Z}=B;let{ease:G=t.ease||"easeOut",duration:Q}=B;const re=typeof z=="function"?z(D,F):z,le=M.length,ye=Nb(Y)?Y:n==null?void 0:n[Y||"keyframes"];if(le<=2&&ye){let ce=100;if(le===2&&H$(M)){const me=M[1]-M[0];ce=Math.abs(me)}const xe={...Z};Q!==void 0&&(xe.duration=sl(Q));const Ce=QA(xe,ce,ye);G=Ce.ease,Q=Ce.duration}Q??(Q=i);const W=x+re;q.length===1&&q[0]===0&&(q[1]=1);const ee=q.length-M.length;if(ee>0&&t3(q,ee),M.length===1&&M.unshift(null),ae){Q=M$(Q,ae);const ce=[...M],xe=[...q];G=Array.isArray(G)?[...G]:[G];const Ce=[...G];for(let me=0;me<ae;me++){M.push(...ce);for(let fe=0;fe<ce.length;fe++)q.push(xe[fe]+(me+1)),G.push(fe===0?"linear":VA(Ce,fe-1))}B$(q,ae)}const ie=W+Q;F$(O,M,G,q,W,ie),A=Math.max(re+Q,A),v=Math.max(ie,v)};if(yn(_)){const I=dC(_,c);k(C,T,uC("default",I))}else{const I=fk(_,C,a,d),B=I.length;for(let O=0;O<B;O++){C=C,T=T;const D=I[O],F=dC(D,c);for(const M in C)k(C[M],q$(T,M),uC(M,F),O,B)}}p=x,x+=A}return c.forEach((b,N)=>{for(const _ in b){const C=b[_];C.sort(V$);const T=[],A=[],k=[];for(let B=0;B<C.length;B++){const{at:O,value:D,easing:F}=C[B];T.push(D),A.push(df(0,v,O)),k.push(F||"easeOut")}A[0]!==0&&(A.unshift(0),T.unshift(T[0]),k.unshift(U$)),A[A.length-1]!==1&&(A.push(1),T.push(null)),o.has(N)||o.set(N,{keyframes:{},transition:{}});const I=o.get(N);I.keyframes[_]=T,I.transition[_]={...t,duration:v,ease:k,times:A,...r}}}),o}function dC(e,t){return!t.has(e)&&t.set(e,{}),t.get(e)}function uC(e,t){return t[e]||(t[e]=[]),t[e]}function $$(e){return Array.isArray(e)?e:[e]}function q$(e,t){return e&&e[t]?{...e,...e[t]}:{...e}}const W$=e=>typeof e=="number",H$=e=>e.every(W$);function G$(e,t){return e in t}class K$ extends V3{constructor(){super(...arguments),this.type="object"}readValueFromInstance(t,r){if(G$(r,t)){const a=t[r];if(typeof a=="string"||typeof a=="number")return a}}getBaseTargetFromProps(){}removeValueFromRenderState(t,r){delete r.output[t]}measureInstanceViewportBox(){return ka()}build(t,r){Object.assign(t.output,r)}renderInstance(t,{output:r}){Object.assign(t,r)}sortInstanceNodePosition(){return 0}}function X$(e){const t={presenceContext:null,props:{},visualState:{renderState:{transform:{},transformOrigin:{},style:{},vars:{},attrs:{}},latestValues:{}}},r=kb(e)&&!w3(e)?new W3(t):new $3(t);r.mount(e),Np.set(e,r)}function Y$(e){const t={presenceContext:null,props:{},visualState:{renderState:{output:{}},latestValues:{}}},r=new K$(t);r.mount(e),Np.set(e,r)}function Z$(e,t){return yn(e)||typeof e=="number"||typeof e=="string"&&!Ub(t)}function mk(e,t,r,a){const n=[];if(Z$(e,t))n.push(sk(e,Ub(t)&&t.default||t,r&&(r.default||r)));else{const i=fk(e,t,a),o=i.length;for(let c=0;c<o;c++){const d=i[c],h=d instanceof Element?X$:Y$;Np.has(d)||h(d);const p=Np.get(d),x={...r};"delay"in x&&typeof x.delay=="function"&&(x.delay=x.delay(c,o)),n.push(...Vb(p,{...t,transition:x},{}))}}return n}function Q$(e,t,r){const a=[];return z$(e,t,r,{spring:bp}).forEach(({keyframes:i,transition:o},c)=>{a.push(...mk(c,i,o))}),a}function J$(e){return Array.isArray(e)&&e.some(Array.isArray)}function eq(e){function t(r,a,n){let i=[],o;if(J$(r))i=Q$(r,a,e);else{const{onComplete:d,...h}=n||{};typeof d=="function"&&(o=d),i=mk(r,a,h,e)}const c=new RV(i);return o&&c.finished.then(o),c}return t}const tq=eq(),sq={some:0,all:1};function rq(e,t,{root:r,margin:a,amount:n="some"}={}){const i=Sb(e),o=new WeakMap,c=h=>{h.forEach(p=>{const x=o.get(p.target);if(p.isIntersecting!==!!x)if(p.isIntersecting){const v=t(p.target,p);typeof v=="function"?o.set(p.target,v):d.unobserve(p.target)}else typeof x=="function"&&(x(p),o.delete(p.target))})},d=new IntersectionObserver(c,{root:r,rootMargin:a,threshold:typeof n=="number"?n:sq[n]});return i.forEach(h=>d.observe(h)),()=>d.disconnect()}function zb(e,{root:t,margin:r,amount:a,once:n=!1,initial:i=!1}={}){const[o,c]=E.useState(i);return E.useEffect(()=>{if(!e.current||n&&o)return;const d=()=>(c(!0),n?void 0:()=>c(!1)),h={root:t&&t.current||void 0,margin:r,amount:a};return rq(e.current,d,h)},[t,e,r,n,a]),o}const pk=Wp,xk=bg,aq=qp,gk=E.forwardRef(({className:e,...t},r)=>s.jsx(zu,{className:pt("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));gk.displayName=zu.displayName;const nq=Pf("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),$b=E.forwardRef(({side:e="right",className:t,children:r,...a},n)=>s.jsxs(aq,{children:[s.jsx(gk,{}),s.jsxs($u,{ref:n,className:pt(nq({side:e}),t),...a,children:[r,s.jsxs($p,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-secondary hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[s.jsx(Jr,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));$b.displayName=$u.displayName;const qb=({className:e,...t})=>s.jsx("div",{className:pt("flex flex-col space-y-2 text-center sm:text-left",e),...t});qb.displayName="SheetHeader";const Wb=E.forwardRef(({className:e,...t},r)=>s.jsx(kf,{ref:r,className:pt("text-lg font-semibold text-foreground",e),...t}));Wb.displayName=kf.displayName;const iq=E.forwardRef(({className:e,...t},r)=>s.jsx(Rf,{ref:r,className:pt("text-sm text-muted-foreground",e),...t}));iq.displayName=Rf.displayName;var oq="Separator",hC="horizontal",lq=["horizontal","vertical"],vk=E.forwardRef((e,t)=>{const{decorative:r,orientation:a=hC,...n}=e,i=cq(a)?a:hC,c=r?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return s.jsx(ys.div,{"data-orientation":i,...c,...n,ref:t})});vk.displayName=oq;function cq(e){return lq.includes(e)}var yk=vk;const al=E.forwardRef(({className:e,orientation:t="horizontal",decorative:r=!0,...a},n)=>s.jsx(yk,{ref:n,decorative:r,orientation:t,className:pt("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...a}));al.displayName=yk.displayName;const dq={initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20}};function Nc({children:e,className:t=""}){return s.jsx(Ee.div,{initial:"initial",animate:"animate",exit:"exit",variants:dq,transition:{duration:.3},className:t,children:e})}function wk(e){return t=>typeof t===e}var uq=wk("function"),hq=e=>e===null,fC=e=>Object.prototype.toString.call(e).slice(8,-1)==="RegExp",mC=e=>!fq(e)&&!hq(e)&&(uq(e)||typeof e=="object"),fq=wk("undefined");function mq(e,t){const{length:r}=e;if(r!==t.length)return!1;for(let a=r;a--!==0;)if(!gi(e[a],t[a]))return!1;return!0}function pq(e,t){if(e.byteLength!==t.byteLength)return!1;const r=new DataView(e.buffer),a=new DataView(t.buffer);let n=e.byteLength;for(;n--;)if(r.getUint8(n)!==a.getUint8(n))return!1;return!0}function xq(e,t){if(e.size!==t.size)return!1;for(const r of e.entries())if(!t.has(r[0]))return!1;for(const r of e.entries())if(!gi(r[1],t.get(r[0])))return!1;return!0}function gq(e,t){if(e.size!==t.size)return!1;for(const r of e.entries())if(!t.has(r[0]))return!1;return!0}function gi(e,t){if(e===t)return!0;if(e&&mC(e)&&t&&mC(t)){if(e.constructor!==t.constructor)return!1;if(Array.isArray(e)&&Array.isArray(t))return mq(e,t);if(e instanceof Map&&t instanceof Map)return xq(e,t);if(e instanceof Set&&t instanceof Set)return gq(e,t);if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return pq(e,t);if(fC(e)&&fC(t))return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();const r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(let n=r.length;n--!==0;)if(!Object.prototype.hasOwnProperty.call(t,r[n]))return!1;for(let n=r.length;n--!==0;){const i=r[n];if(!(i==="_owner"&&e.$$typeof)&&!gi(e[i],t[i]))return!1}return!0}return Number.isNaN(e)&&Number.isNaN(t)?!0:e===t}var vq=["Array","ArrayBuffer","AsyncFunction","AsyncGenerator","AsyncGeneratorFunction","Date","Error","Function","Generator","GeneratorFunction","HTMLElement","Map","Object","Promise","RegExp","Set","WeakMap","WeakSet"],yq=["bigint","boolean","null","number","string","symbol","undefined"];function Bg(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(/HTML\w+Element/.test(t))return"HTMLElement";if(wq(t))return t}function ol(e){return t=>Bg(t)===e}function wq(e){return vq.includes(e)}function Uf(e){return t=>typeof t===e}function bq(e){return yq.includes(e)}var _q=["innerHTML","ownerDocument","style","attributes","nodeValue"];function os(e){if(e===null)return"null";switch(typeof e){case"bigint":return"bigint";case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"symbol":return"symbol";case"undefined":return"undefined"}if(os.array(e))return"Array";if(os.plainFunction(e))return"Function";const t=Bg(e);return t||"Object"}os.array=Array.isArray;os.arrayOf=(e,t)=>!os.array(e)&&!os.function(t)?!1:e.every(r=>t(r));os.asyncGeneratorFunction=e=>Bg(e)==="AsyncGeneratorFunction";os.asyncFunction=ol("AsyncFunction");os.bigint=Uf("bigint");os.boolean=e=>e===!0||e===!1;os.date=ol("Date");os.defined=e=>!os.undefined(e);os.domElement=e=>os.object(e)&&!os.plainObject(e)&&e.nodeType===1&&os.string(e.nodeName)&&_q.every(t=>t in e);os.empty=e=>os.string(e)&&e.length===0||os.array(e)&&e.length===0||os.object(e)&&!os.map(e)&&!os.set(e)&&Object.keys(e).length===0||os.set(e)&&e.size===0||os.map(e)&&e.size===0;os.error=ol("Error");os.function=Uf("function");os.generator=e=>os.iterable(e)&&os.function(e.next)&&os.function(e.throw);os.generatorFunction=ol("GeneratorFunction");os.instanceOf=(e,t)=>!e||!t?!1:Object.getPrototypeOf(e)===t.prototype;os.iterable=e=>!os.nullOrUndefined(e)&&os.function(e[Symbol.iterator]);os.map=ol("Map");os.nan=e=>Number.isNaN(e);os.null=e=>e===null;os.nullOrUndefined=e=>os.null(e)||os.undefined(e);os.number=e=>Uf("number")(e)&&!os.nan(e);os.numericString=e=>os.string(e)&&e.length>0&&!Number.isNaN(Number(e));os.object=e=>!os.nullOrUndefined(e)&&(os.function(e)||typeof e=="object");os.oneOf=(e,t)=>os.array(e)?e.indexOf(t)>-1:!1;os.plainFunction=ol("Function");os.plainObject=e=>{if(Bg(e)!=="Object")return!1;const t=Object.getPrototypeOf(e);return t===null||t===Object.getPrototypeOf({})};os.primitive=e=>os.null(e)||bq(typeof e);os.promise=ol("Promise");os.propertyOf=(e,t,r)=>{if(!os.object(e)||!t)return!1;const a=e[t];return os.function(r)?r(a):os.defined(a)};os.regexp=ol("RegExp");os.set=ol("Set");os.string=Uf("string");os.symbol=Uf("symbol");os.undefined=Uf("undefined");os.weakMap=ol("WeakMap");os.weakSet=ol("WeakSet");var hs=os;function jq(...e){return e.every(t=>hs.string(t)||hs.array(t)||hs.plainObject(t))}function Nq(e,t,r){return bk(e,t)?[e,t].every(hs.array)?!e.some(yC(r))&&t.some(yC(r)):[e,t].every(hs.plainObject)?!Object.entries(e).some(vC(r))&&Object.entries(t).some(vC(r)):t===r:!1}function pC(e,t,r){const{actual:a,key:n,previous:i,type:o}=r,c=Tl(e,n),d=Tl(t,n);let h=[c,d].every(hs.number)&&(o==="increased"?c<d:c>d);return hs.undefined(a)||(h=h&&d===a),hs.undefined(i)||(h=h&&c===i),h}function xC(e,t,r){const{key:a,type:n,value:i}=r,o=Tl(e,a),c=Tl(t,a),d=n==="added"?o:c,h=n==="added"?c:o;if(!hs.nullOrUndefined(i)){if(hs.defined(d)){if(hs.array(d)||hs.plainObject(d))return Nq(d,h,i)}else return gi(h,i);return!1}return[o,c].every(hs.array)?!h.every(Hb(d)):[o,c].every(hs.plainObject)?Cq(Object.keys(d),Object.keys(h)):![o,c].every(p=>hs.primitive(p)&&hs.defined(p))&&(n==="added"?!hs.defined(o)&&hs.defined(c):hs.defined(o)&&!hs.defined(c))}function gC(e,t,{key:r}={}){let a=Tl(e,r),n=Tl(t,r);if(!bk(a,n))throw new TypeError("Inputs have different types");if(!jq(a,n))throw new TypeError("Inputs don't have length");return[a,n].every(hs.plainObject)&&(a=Object.keys(a),n=Object.keys(n)),[a,n]}function vC(e){return([t,r])=>hs.array(e)?gi(e,r)||e.some(a=>gi(a,r)||hs.array(r)&&Hb(r)(a)):hs.plainObject(e)&&e[t]?!!e[t]&&gi(e[t],r):gi(e,r)}function Cq(e,t){return t.some(r=>!e.includes(r))}function yC(e){return t=>hs.array(e)?e.some(r=>gi(r,t)||hs.array(t)&&Hb(t)(r)):gi(e,t)}function pm(e,t){return hs.array(e)?e.some(r=>gi(r,t)):gi(e,t)}function Hb(e){return t=>e.some(r=>gi(r,t))}function bk(...e){return e.every(hs.array)||e.every(hs.number)||e.every(hs.plainObject)||e.every(hs.string)}function Tl(e,t){return hs.plainObject(e)||hs.array(e)?hs.string(t)?t.split(".").reduce((a,n)=>a&&a[n],e):hs.number(t)?e[t]:e:e}function Wx(e,t){if([e,t].some(hs.nullOrUndefined))throw new Error("Missing required parameters");if(![e,t].every(p=>hs.plainObject(p)||hs.array(p)))throw new Error("Expected plain objects or array");return{added:(p,x)=>{try{return xC(e,t,{key:p,type:"added",value:x})}catch{return!1}},changed:(p,x,v)=>{try{const b=Tl(e,p),N=Tl(t,p),_=hs.defined(x),C=hs.defined(v);if(_||C){const T=C?pm(v,b):!pm(x,b),A=pm(x,N);return T&&A}return[b,N].every(hs.array)||[b,N].every(hs.plainObject)?!gi(b,N):b!==N}catch{return!1}},changedFrom:(p,x,v)=>{if(!hs.defined(p))return!1;try{const b=Tl(e,p),N=Tl(t,p),_=hs.defined(v);return pm(x,b)&&(_?pm(v,N):!_)}catch{return!1}},decreased:(p,x,v)=>{if(!hs.defined(p))return!1;try{return pC(e,t,{key:p,actual:x,previous:v,type:"decreased"})}catch{return!1}},emptied:p=>{try{const[x,v]=gC(e,t,{key:p});return!!x.length&&!v.length}catch{return!1}},filled:p=>{try{const[x,v]=gC(e,t,{key:p});return!x.length&&!!v.length}catch{return!1}},increased:(p,x,v)=>{if(!hs.defined(p))return!1;try{return pC(e,t,{key:p,actual:x,previous:v,type:"increased"})}catch{return!1}},removed:(p,x)=>{try{return xC(e,t,{key:p,type:"removed",value:x})}catch{return!1}}}}var Eq=new Error("Element already at target scroll position"),Sq=new Error("Scroll cancelled"),Tq=Math.min,wC=Date.now,Aq={left:bC("scrollLeft"),top:bC("scrollTop")};function bC(e){return function(r,a,n,i){n=n||{},typeof n=="function"&&(i=n,n={}),typeof i!="function"&&(i=Rq);var o=wC(),c=r[e],d=n.ease||kq,h=isNaN(n.duration)?350:+n.duration,p=!1;return c===a?i(Eq,r[e]):requestAnimationFrame(v),x;function x(){p=!0}function v(b){if(p)return i(Sq,r[e]);var N=wC(),_=Tq(1,(N-o)/h),C=d(_);r[e]=C*(a-c)+c,_<1?requestAnimationFrame(v):requestAnimationFrame(function(){i(null,r[e])})}}}function kq(e){return .5*(1-Math.cos(Math.PI*e))}function Rq(){}const Pq=qu(Aq);var _k={exports:{}};(function(e){(function(t,r){e.exports?e.exports=r():t.Scrollparent=r()})(rd,function(){function t(a){var n=getComputedStyle(a,null).getPropertyValue("overflow");return n.indexOf("scroll")>-1||n.indexOf("auto")>-1}function r(a){if(a instanceof HTMLElement||a instanceof SVGElement){for(var n=a.parentNode;n.parentNode;){if(t(n))return n;n=n.parentNode}return document.scrollingElement||document.documentElement}}return r})})(_k);var Iq=_k.exports;const jk=qu(Iq);var Oq=function(e){return Object.prototype.hasOwnProperty.call(e,"props")},Dq=function(e,t){return e+Ep(t)},Ep=function(e){return e===null||typeof e=="boolean"||typeof e>"u"?"":typeof e=="number"?e.toString():typeof e=="string"?e:Array.isArray(e)?e.reduce(Dq,""):Oq(e)&&Object.prototype.hasOwnProperty.call(e.props,"children")?Ep(e.props.children):""};Ep.default=Ep;var Mq=Ep;const _C=qu(Mq);var Lq=function(t){return Fq(t)&&!Bq(t)};function Fq(e){return!!e&&typeof e=="object"}function Bq(e){var t=Object.prototype.toString.call(e);return t==="[object RegExp]"||t==="[object Date]"||zq(e)}var Vq=typeof Symbol=="function"&&Symbol.for,Uq=Vq?Symbol.for("react.element"):60103;function zq(e){return e.$$typeof===Uq}function $q(e){return Array.isArray(e)?[]:{}}function Sp(e,t){return t.clone!==!1&&t.isMergeableObject(e)?hf($q(e),e,t):e}function qq(e,t,r){return e.concat(t).map(function(a){return Sp(a,r)})}function Wq(e,t){if(!t.customMerge)return hf;var r=t.customMerge(e);return typeof r=="function"?r:hf}function Hq(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return Object.propertyIsEnumerable.call(e,t)}):[]}function jC(e){return Object.keys(e).concat(Hq(e))}function Nk(e,t){try{return t in e}catch{return!1}}function Gq(e,t){return Nk(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))}function Kq(e,t,r){var a={};return r.isMergeableObject(e)&&jC(e).forEach(function(n){a[n]=Sp(e[n],r)}),jC(t).forEach(function(n){Gq(e,n)||(Nk(e,n)&&r.isMergeableObject(t[n])?a[n]=Wq(n,r)(e[n],t[n],r):a[n]=Sp(t[n],r))}),a}function hf(e,t,r){r=r||{},r.arrayMerge=r.arrayMerge||qq,r.isMergeableObject=r.isMergeableObject||Lq,r.cloneUnlessOtherwiseSpecified=Sp;var a=Array.isArray(t),n=Array.isArray(e),i=a===n;return i?a?r.arrayMerge(e,t,r):Kq(e,t,r):Sp(t,r)}hf.all=function(t,r){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(a,n){return hf(a,n,r)},{})};var Xq=hf,Yq=Xq;const Jo=qu(Yq);/**!
 * @fileOverview Kickass library to create and place poppers near their reference elements.
 * @version 1.16.1
 * @license
 * Copyright (c) 2016 Federico Zivolo and contributors
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Jp=typeof window<"u"&&typeof document<"u"&&typeof navigator<"u",Zq=function(){for(var e=["Edge","Trident","Firefox"],t=0;t<e.length;t+=1)if(Jp&&navigator.userAgent.indexOf(e[t])>=0)return 1;return 0}();function Qq(e){var t=!1;return function(){t||(t=!0,window.Promise.resolve().then(function(){t=!1,e()}))}}function Jq(e){var t=!1;return function(){t||(t=!0,setTimeout(function(){t=!1,e()},Zq))}}var eW=Jp&&window.Promise,tW=eW?Qq:Jq;function Ck(e){var t={};return e&&t.toString.call(e)==="[object Function]"}function Hu(e,t){if(e.nodeType!==1)return[];var r=e.ownerDocument.defaultView,a=r.getComputedStyle(e,null);return t?a[t]:a}function Gb(e){return e.nodeName==="HTML"?e:e.parentNode||e.host}function e0(e){if(!e)return document.body;switch(e.nodeName){case"HTML":case"BODY":return e.ownerDocument.body;case"#document":return e.body}var t=Hu(e),r=t.overflow,a=t.overflowX,n=t.overflowY;return/(auto|scroll|overlay)/.test(r+n+a)?e:e0(Gb(e))}function Ek(e){return e&&e.referenceNode?e.referenceNode:e}var NC=Jp&&!!(window.MSInputMethodContext&&document.documentMode),CC=Jp&&/MSIE 10/.test(navigator.userAgent);function zf(e){return e===11?NC:e===10?CC:NC||CC}function ff(e){if(!e)return document.documentElement;for(var t=zf(10)?document.body:null,r=e.offsetParent||null;r===t&&e.nextElementSibling;)r=(e=e.nextElementSibling).offsetParent;var a=r&&r.nodeName;return!a||a==="BODY"||a==="HTML"?e?e.ownerDocument.documentElement:document.documentElement:["TH","TD","TABLE"].indexOf(r.nodeName)!==-1&&Hu(r,"position")==="static"?ff(r):r}function sW(e){var t=e.nodeName;return t==="BODY"?!1:t==="HTML"||ff(e.firstElementChild)===e}function Wy(e){return e.parentNode!==null?Wy(e.parentNode):e}function Hx(e,t){if(!e||!e.nodeType||!t||!t.nodeType)return document.documentElement;var r=e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING,a=r?e:t,n=r?t:e,i=document.createRange();i.setStart(a,0),i.setEnd(n,0);var o=i.commonAncestorContainer;if(e!==o&&t!==o||a.contains(n))return sW(o)?o:ff(o);var c=Wy(e);return c.host?Hx(c.host,t):Hx(e,Wy(t).host)}function mf(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"top",r=t==="top"?"scrollTop":"scrollLeft",a=e.nodeName;if(a==="BODY"||a==="HTML"){var n=e.ownerDocument.documentElement,i=e.ownerDocument.scrollingElement||n;return i[r]}return e[r]}function rW(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=mf(t,"top"),n=mf(t,"left"),i=r?-1:1;return e.top+=a*i,e.bottom+=a*i,e.left+=n*i,e.right+=n*i,e}function EC(e,t){var r=t==="x"?"Left":"Top",a=r==="Left"?"Right":"Bottom";return parseFloat(e["border"+r+"Width"])+parseFloat(e["border"+a+"Width"])}function SC(e,t,r,a){return Math.max(t["offset"+e],t["scroll"+e],r["client"+e],r["offset"+e],r["scroll"+e],zf(10)?parseInt(r["offset"+e])+parseInt(a["margin"+(e==="Height"?"Top":"Left")])+parseInt(a["margin"+(e==="Height"?"Bottom":"Right")]):0)}function Sk(e){var t=e.body,r=e.documentElement,a=zf(10)&&getComputedStyle(r);return{height:SC("Height",t,r,a),width:SC("Width",t,r,a)}}var aW=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},nW=function(){function e(t,r){for(var a=0;a<r.length;a++){var n=r[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),pf=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},_o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e};function Td(e){return _o({},e,{right:e.left+e.width,bottom:e.top+e.height})}function Hy(e){var t={};try{if(zf(10)){t=e.getBoundingClientRect();var r=mf(e,"top"),a=mf(e,"left");t.top+=r,t.left+=a,t.bottom+=r,t.right+=a}else t=e.getBoundingClientRect()}catch{}var n={left:t.left,top:t.top,width:t.right-t.left,height:t.bottom-t.top},i=e.nodeName==="HTML"?Sk(e.ownerDocument):{},o=i.width||e.clientWidth||n.width,c=i.height||e.clientHeight||n.height,d=e.offsetWidth-o,h=e.offsetHeight-c;if(d||h){var p=Hu(e);d-=EC(p,"x"),h-=EC(p,"y"),n.width-=d,n.height-=h}return Td(n)}function Kb(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=zf(10),n=t.nodeName==="HTML",i=Hy(e),o=Hy(t),c=e0(e),d=Hu(t),h=parseFloat(d.borderTopWidth),p=parseFloat(d.borderLeftWidth);r&&n&&(o.top=Math.max(o.top,0),o.left=Math.max(o.left,0));var x=Td({top:i.top-o.top-h,left:i.left-o.left-p,width:i.width,height:i.height});if(x.marginTop=0,x.marginLeft=0,!a&&n){var v=parseFloat(d.marginTop),b=parseFloat(d.marginLeft);x.top-=h-v,x.bottom-=h-v,x.left-=p-b,x.right-=p-b,x.marginTop=v,x.marginLeft=b}return(a&&!r?t.contains(c):t===c&&c.nodeName!=="BODY")&&(x=rW(x,t)),x}function iW(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=e.ownerDocument.documentElement,a=Kb(e,r),n=Math.max(r.clientWidth,window.innerWidth||0),i=Math.max(r.clientHeight,window.innerHeight||0),o=t?0:mf(r),c=t?0:mf(r,"left"),d={top:o-a.top+a.marginTop,left:c-a.left+a.marginLeft,width:n,height:i};return Td(d)}function Tk(e){var t=e.nodeName;if(t==="BODY"||t==="HTML")return!1;if(Hu(e,"position")==="fixed")return!0;var r=Gb(e);return r?Tk(r):!1}function Ak(e){if(!e||!e.parentElement||zf())return document.documentElement;for(var t=e.parentElement;t&&Hu(t,"transform")==="none";)t=t.parentElement;return t||document.documentElement}function Xb(e,t,r,a){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,i={top:0,left:0},o=n?Ak(e):Hx(e,Ek(t));if(a==="viewport")i=iW(o,n);else{var c=void 0;a==="scrollParent"?(c=e0(Gb(t)),c.nodeName==="BODY"&&(c=e.ownerDocument.documentElement)):a==="window"?c=e.ownerDocument.documentElement:c=a;var d=Kb(c,o,n);if(c.nodeName==="HTML"&&!Tk(o)){var h=Sk(e.ownerDocument),p=h.height,x=h.width;i.top+=d.top-d.marginTop,i.bottom=p+d.top,i.left+=d.left-d.marginLeft,i.right=x+d.left}else i=d}r=r||0;var v=typeof r=="number";return i.left+=v?r:r.left||0,i.top+=v?r:r.top||0,i.right-=v?r:r.right||0,i.bottom-=v?r:r.bottom||0,i}function oW(e){var t=e.width,r=e.height;return t*r}function kk(e,t,r,a,n){var i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;if(e.indexOf("auto")===-1)return e;var o=Xb(r,a,i,n),c={top:{width:o.width,height:t.top-o.top},right:{width:o.right-t.right,height:o.height},bottom:{width:o.width,height:o.bottom-t.bottom},left:{width:t.left-o.left,height:o.height}},d=Object.keys(c).map(function(v){return _o({key:v},c[v],{area:oW(c[v])})}).sort(function(v,b){return b.area-v.area}),h=d.filter(function(v){var b=v.width,N=v.height;return b>=r.clientWidth&&N>=r.clientHeight}),p=h.length>0?h[0].key:d[0].key,x=e.split("-")[1];return p+(x?"-"+x:"")}function Rk(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,n=a?Ak(t):Hx(t,Ek(r));return Kb(r,n,a)}function Pk(e){var t=e.ownerDocument.defaultView,r=t.getComputedStyle(e),a=parseFloat(r.marginTop||0)+parseFloat(r.marginBottom||0),n=parseFloat(r.marginLeft||0)+parseFloat(r.marginRight||0),i={width:e.offsetWidth+n,height:e.offsetHeight+a};return i}function Gx(e){var t={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,function(r){return t[r]})}function Ik(e,t,r){r=r.split("-")[0];var a=Pk(e),n={width:a.width,height:a.height},i=["right","left"].indexOf(r)!==-1,o=i?"top":"left",c=i?"left":"top",d=i?"height":"width",h=i?"width":"height";return n[o]=t[o]+t[d]/2-a[d]/2,r===c?n[c]=t[c]-a[h]:n[c]=t[Gx(c)],n}function t0(e,t){return Array.prototype.find?e.find(t):e.filter(t)[0]}function lW(e,t,r){if(Array.prototype.findIndex)return e.findIndex(function(n){return n[t]===r});var a=t0(e,function(n){return n[t]===r});return e.indexOf(a)}function Ok(e,t,r){var a=r===void 0?e:e.slice(0,lW(e,"name",r));return a.forEach(function(n){n.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var i=n.function||n.fn;n.enabled&&Ck(i)&&(t.offsets.popper=Td(t.offsets.popper),t.offsets.reference=Td(t.offsets.reference),t=i(t,n))}),t}function cW(){if(!this.state.isDestroyed){var e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};e.offsets.reference=Rk(this.state,this.popper,this.reference,this.options.positionFixed),e.placement=kk(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),e.originalPlacement=e.placement,e.positionFixed=this.options.positionFixed,e.offsets.popper=Ik(this.popper,e.offsets.reference,e.placement),e.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",e=Ok(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e))}}function Dk(e,t){return e.some(function(r){var a=r.name,n=r.enabled;return n&&a===t})}function Yb(e){for(var t=[!1,"ms","Webkit","Moz","O"],r=e.charAt(0).toUpperCase()+e.slice(1),a=0;a<t.length;a++){var n=t[a],i=n?""+n+r:e;if(typeof document.body.style[i]<"u")return i}return null}function dW(){return this.state.isDestroyed=!0,Dk(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[Yb("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function Mk(e){var t=e.ownerDocument;return t?t.defaultView:window}function Lk(e,t,r,a){var n=e.nodeName==="BODY",i=n?e.ownerDocument.defaultView:e;i.addEventListener(t,r,{passive:!0}),n||Lk(e0(i.parentNode),t,r,a),a.push(i)}function uW(e,t,r,a){r.updateBound=a,Mk(e).addEventListener("resize",r.updateBound,{passive:!0});var n=e0(e);return Lk(n,"scroll",r.updateBound,r.scrollParents),r.scrollElement=n,r.eventsEnabled=!0,r}function hW(){this.state.eventsEnabled||(this.state=uW(this.reference,this.options,this.state,this.scheduleUpdate))}function fW(e,t){return Mk(e).removeEventListener("resize",t.updateBound),t.scrollParents.forEach(function(r){r.removeEventListener("scroll",t.updateBound)}),t.updateBound=null,t.scrollParents=[],t.scrollElement=null,t.eventsEnabled=!1,t}function mW(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=fW(this.reference,this.state))}function Zb(e){return e!==""&&!isNaN(parseFloat(e))&&isFinite(e)}function Gy(e,t){Object.keys(t).forEach(function(r){var a="";["width","height","top","right","bottom","left"].indexOf(r)!==-1&&Zb(t[r])&&(a="px"),e.style[r]=t[r]+a})}function pW(e,t){Object.keys(t).forEach(function(r){var a=t[r];a!==!1?e.setAttribute(r,t[r]):e.removeAttribute(r)})}function xW(e){return Gy(e.instance.popper,e.styles),pW(e.instance.popper,e.attributes),e.arrowElement&&Object.keys(e.arrowStyles).length&&Gy(e.arrowElement,e.arrowStyles),e}function gW(e,t,r,a,n){var i=Rk(n,t,e,r.positionFixed),o=kk(r.placement,i,t,e,r.modifiers.flip.boundariesElement,r.modifiers.flip.padding);return t.setAttribute("x-placement",o),Gy(t,{position:r.positionFixed?"fixed":"absolute"}),r}function vW(e,t){var r=e.offsets,a=r.popper,n=r.reference,i=Math.round,o=Math.floor,c=function(T){return T},d=i(n.width),h=i(a.width),p=["left","right"].indexOf(e.placement)!==-1,x=e.placement.indexOf("-")!==-1,v=d%2===h%2,b=d%2===1&&h%2===1,N=t?p||x||v?i:o:c,_=t?i:c;return{left:N(b&&!x&&t?a.left-1:a.left),top:_(a.top),bottom:_(a.bottom),right:N(a.right)}}var yW=Jp&&/Firefox/i.test(navigator.userAgent);function wW(e,t){var r=t.x,a=t.y,n=e.offsets.popper,i=t0(e.instance.modifiers,function(k){return k.name==="applyStyle"}).gpuAcceleration;i!==void 0&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var o=i!==void 0?i:t.gpuAcceleration,c=ff(e.instance.popper),d=Hy(c),h={position:n.position},p=vW(e,window.devicePixelRatio<2||!yW),x=r==="bottom"?"top":"bottom",v=a==="right"?"left":"right",b=Yb("transform"),N=void 0,_=void 0;if(x==="bottom"?c.nodeName==="HTML"?_=-c.clientHeight+p.bottom:_=-d.height+p.bottom:_=p.top,v==="right"?c.nodeName==="HTML"?N=-c.clientWidth+p.right:N=-d.width+p.right:N=p.left,o&&b)h[b]="translate3d("+N+"px, "+_+"px, 0)",h[x]=0,h[v]=0,h.willChange="transform";else{var C=x==="bottom"?-1:1,T=v==="right"?-1:1;h[x]=_*C,h[v]=N*T,h.willChange=x+", "+v}var A={"x-placement":e.placement};return e.attributes=_o({},A,e.attributes),e.styles=_o({},h,e.styles),e.arrowStyles=_o({},e.offsets.arrow,e.arrowStyles),e}function Fk(e,t,r){var a=t0(e,function(c){var d=c.name;return d===t}),n=!!a&&e.some(function(c){return c.name===r&&c.enabled&&c.order<a.order});if(!n){var i="`"+t+"`",o="`"+r+"`";console.warn(o+" modifier is required by "+i+" modifier in order to work, be sure to include it before "+i+"!")}return n}function bW(e,t){var r;if(!Fk(e.instance.modifiers,"arrow","keepTogether"))return e;var a=t.element;if(typeof a=="string"){if(a=e.instance.popper.querySelector(a),!a)return e}else if(!e.instance.popper.contains(a))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),e;var n=e.placement.split("-")[0],i=e.offsets,o=i.popper,c=i.reference,d=["left","right"].indexOf(n)!==-1,h=d?"height":"width",p=d?"Top":"Left",x=p.toLowerCase(),v=d?"left":"top",b=d?"bottom":"right",N=Pk(a)[h];c[b]-N<o[x]&&(e.offsets.popper[x]-=o[x]-(c[b]-N)),c[x]+N>o[b]&&(e.offsets.popper[x]+=c[x]+N-o[b]),e.offsets.popper=Td(e.offsets.popper);var _=c[x]+c[h]/2-N/2,C=Hu(e.instance.popper),T=parseFloat(C["margin"+p]),A=parseFloat(C["border"+p+"Width"]),k=_-e.offsets.popper[x]-T-A;return k=Math.max(Math.min(o[h]-N,k),0),e.arrowElement=a,e.offsets.arrow=(r={},pf(r,x,Math.round(k)),pf(r,v,""),r),e}function _W(e){return e==="end"?"start":e==="start"?"end":e}var Bk=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],tv=Bk.slice(3);function TC(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=tv.indexOf(e),a=tv.slice(r+1).concat(tv.slice(0,r));return t?a.reverse():a}var sv={FLIP:"flip",CLOCKWISE:"clockwise",COUNTERCLOCKWISE:"counterclockwise"};function jW(e,t){if(Dk(e.instance.modifiers,"inner")||e.flipped&&e.placement===e.originalPlacement)return e;var r=Xb(e.instance.popper,e.instance.reference,t.padding,t.boundariesElement,e.positionFixed),a=e.placement.split("-")[0],n=Gx(a),i=e.placement.split("-")[1]||"",o=[];switch(t.behavior){case sv.FLIP:o=[a,n];break;case sv.CLOCKWISE:o=TC(a);break;case sv.COUNTERCLOCKWISE:o=TC(a,!0);break;default:o=t.behavior}return o.forEach(function(c,d){if(a!==c||o.length===d+1)return e;a=e.placement.split("-")[0],n=Gx(a);var h=e.offsets.popper,p=e.offsets.reference,x=Math.floor,v=a==="left"&&x(h.right)>x(p.left)||a==="right"&&x(h.left)<x(p.right)||a==="top"&&x(h.bottom)>x(p.top)||a==="bottom"&&x(h.top)<x(p.bottom),b=x(h.left)<x(r.left),N=x(h.right)>x(r.right),_=x(h.top)<x(r.top),C=x(h.bottom)>x(r.bottom),T=a==="left"&&b||a==="right"&&N||a==="top"&&_||a==="bottom"&&C,A=["top","bottom"].indexOf(a)!==-1,k=!!t.flipVariations&&(A&&i==="start"&&b||A&&i==="end"&&N||!A&&i==="start"&&_||!A&&i==="end"&&C),I=!!t.flipVariationsByContent&&(A&&i==="start"&&N||A&&i==="end"&&b||!A&&i==="start"&&C||!A&&i==="end"&&_),B=k||I;(v||T||B)&&(e.flipped=!0,(v||T)&&(a=o[d+1]),B&&(i=_W(i)),e.placement=a+(i?"-"+i:""),e.offsets.popper=_o({},e.offsets.popper,Ik(e.instance.popper,e.offsets.reference,e.placement)),e=Ok(e.instance.modifiers,e,"flip"))}),e}function NW(e){var t=e.offsets,r=t.popper,a=t.reference,n=e.placement.split("-")[0],i=Math.floor,o=["top","bottom"].indexOf(n)!==-1,c=o?"right":"bottom",d=o?"left":"top",h=o?"width":"height";return r[c]<i(a[d])&&(e.offsets.popper[d]=i(a[d])-r[h]),r[d]>i(a[c])&&(e.offsets.popper[d]=i(a[c])),e}function CW(e,t,r,a){var n=e.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),i=+n[1],o=n[2];if(!i)return e;if(o.indexOf("%")===0){var c=void 0;switch(o){case"%p":c=r;break;case"%":case"%r":default:c=a}var d=Td(c);return d[t]/100*i}else if(o==="vh"||o==="vw"){var h=void 0;return o==="vh"?h=Math.max(document.documentElement.clientHeight,window.innerHeight||0):h=Math.max(document.documentElement.clientWidth,window.innerWidth||0),h/100*i}else return i}function EW(e,t,r,a){var n=[0,0],i=["right","left"].indexOf(a)!==-1,o=e.split(/(\+|\-)/).map(function(p){return p.trim()}),c=o.indexOf(t0(o,function(p){return p.search(/,|\s/)!==-1}));o[c]&&o[c].indexOf(",")===-1&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var d=/\s*,\s*|\s+/,h=c!==-1?[o.slice(0,c).concat([o[c].split(d)[0]]),[o[c].split(d)[1]].concat(o.slice(c+1))]:[o];return h=h.map(function(p,x){var v=(x===1?!i:i)?"height":"width",b=!1;return p.reduce(function(N,_){return N[N.length-1]===""&&["+","-"].indexOf(_)!==-1?(N[N.length-1]=_,b=!0,N):b?(N[N.length-1]+=_,b=!1,N):N.concat(_)},[]).map(function(N){return CW(N,v,t,r)})}),h.forEach(function(p,x){p.forEach(function(v,b){Zb(v)&&(n[x]+=v*(p[b-1]==="-"?-1:1))})}),n}function SW(e,t){var r=t.offset,a=e.placement,n=e.offsets,i=n.popper,o=n.reference,c=a.split("-")[0],d=void 0;return Zb(+r)?d=[+r,0]:d=EW(r,i,o,c),c==="left"?(i.top+=d[0],i.left-=d[1]):c==="right"?(i.top+=d[0],i.left+=d[1]):c==="top"?(i.left+=d[0],i.top-=d[1]):c==="bottom"&&(i.left+=d[0],i.top+=d[1]),e.popper=i,e}function TW(e,t){var r=t.boundariesElement||ff(e.instance.popper);e.instance.reference===r&&(r=ff(r));var a=Yb("transform"),n=e.instance.popper.style,i=n.top,o=n.left,c=n[a];n.top="",n.left="",n[a]="";var d=Xb(e.instance.popper,e.instance.reference,t.padding,r,e.positionFixed);n.top=i,n.left=o,n[a]=c,t.boundaries=d;var h=t.priority,p=e.offsets.popper,x={primary:function(b){var N=p[b];return p[b]<d[b]&&!t.escapeWithReference&&(N=Math.max(p[b],d[b])),pf({},b,N)},secondary:function(b){var N=b==="right"?"left":"top",_=p[N];return p[b]>d[b]&&!t.escapeWithReference&&(_=Math.min(p[N],d[b]-(b==="right"?p.width:p.height))),pf({},N,_)}};return h.forEach(function(v){var b=["left","top"].indexOf(v)!==-1?"primary":"secondary";p=_o({},p,x[b](v))}),e.offsets.popper=p,e}function AW(e){var t=e.placement,r=t.split("-")[0],a=t.split("-")[1];if(a){var n=e.offsets,i=n.reference,o=n.popper,c=["bottom","top"].indexOf(r)!==-1,d=c?"left":"top",h=c?"width":"height",p={start:pf({},d,i[d]),end:pf({},d,i[d]+i[h]-o[h])};e.offsets.popper=_o({},o,p[a])}return e}function kW(e){if(!Fk(e.instance.modifiers,"hide","preventOverflow"))return e;var t=e.offsets.reference,r=t0(e.instance.modifiers,function(a){return a.name==="preventOverflow"}).boundaries;if(t.bottom<r.top||t.left>r.right||t.top>r.bottom||t.right<r.left){if(e.hide===!0)return e;e.hide=!0,e.attributes["x-out-of-boundaries"]=""}else{if(e.hide===!1)return e;e.hide=!1,e.attributes["x-out-of-boundaries"]=!1}return e}function RW(e){var t=e.placement,r=t.split("-")[0],a=e.offsets,n=a.popper,i=a.reference,o=["left","right"].indexOf(r)!==-1,c=["top","left"].indexOf(r)===-1;return n[o?"left":"top"]=i[r]-(c?n[o?"width":"height"]:0),e.placement=Gx(t),e.offsets.popper=Td(n),e}var PW={shift:{order:100,enabled:!0,fn:AW},offset:{order:200,enabled:!0,fn:SW,offset:0},preventOverflow:{order:300,enabled:!0,fn:TW,priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:NW},arrow:{order:500,enabled:!0,fn:bW,element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:jW,behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:RW},hide:{order:800,enabled:!0,fn:kW},computeStyle:{order:850,enabled:!0,fn:wW,gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:xW,onLoad:gW,gpuAcceleration:void 0}},IW={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:PW},Tp=function(){function e(t,r){var a=this,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};aW(this,e),this.scheduleUpdate=function(){return requestAnimationFrame(a.update)},this.update=tW(this.update.bind(this)),this.options=_o({},e.Defaults,n),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=t&&t.jquery?t[0]:t,this.popper=r&&r.jquery?r[0]:r,this.options.modifiers={},Object.keys(_o({},e.Defaults.modifiers,n.modifiers)).forEach(function(o){a.options.modifiers[o]=_o({},e.Defaults.modifiers[o]||{},n.modifiers?n.modifiers[o]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(o){return _o({name:o},a.options.modifiers[o])}).sort(function(o,c){return o.order-c.order}),this.modifiers.forEach(function(o){o.enabled&&Ck(o.onLoad)&&o.onLoad(a.reference,a.popper,a.options,o,a.state)}),this.update();var i=this.options.eventsEnabled;i&&this.enableEventListeners(),this.state.eventsEnabled=i}return nW(e,[{key:"update",value:function(){return cW.call(this)}},{key:"destroy",value:function(){return dW.call(this)}},{key:"enableEventListeners",value:function(){return hW.call(this)}},{key:"disableEventListeners",value:function(){return mW.call(this)}}]),e}();Tp.Utils=(typeof window<"u"?window:global).PopperUtils;Tp.placements=Bk;Tp.Defaults=IW;var OW=["innerHTML","ownerDocument","style","attributes","nodeValue"],DW=["Array","ArrayBuffer","AsyncFunction","AsyncGenerator","AsyncGeneratorFunction","Date","Error","Function","Generator","GeneratorFunction","HTMLElement","Map","Object","Promise","RegExp","Set","WeakMap","WeakSet"],MW=["bigint","boolean","null","number","string","symbol","undefined"];function Vg(e){var t=Object.prototype.toString.call(e).slice(8,-1);if(/HTML\w+Element/.test(t))return"HTMLElement";if(LW(t))return t}function ll(e){return function(t){return Vg(t)===e}}function LW(e){return DW.includes(e)}function $f(e){return function(t){return typeof t===e}}function FW(e){return MW.includes(e)}function wt(e){if(e===null)return"null";switch(typeof e){case"bigint":return"bigint";case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"symbol":return"symbol";case"undefined":return"undefined"}if(wt.array(e))return"Array";if(wt.plainFunction(e))return"Function";var t=Vg(e);return t||"Object"}wt.array=Array.isArray;wt.arrayOf=function(e,t){return!wt.array(e)&&!wt.function(t)?!1:e.every(function(r){return t(r)})};wt.asyncGeneratorFunction=function(e){return Vg(e)==="AsyncGeneratorFunction"};wt.asyncFunction=ll("AsyncFunction");wt.bigint=$f("bigint");wt.boolean=function(e){return e===!0||e===!1};wt.date=ll("Date");wt.defined=function(e){return!wt.undefined(e)};wt.domElement=function(e){return wt.object(e)&&!wt.plainObject(e)&&e.nodeType===1&&wt.string(e.nodeName)&&OW.every(function(t){return t in e})};wt.empty=function(e){return wt.string(e)&&e.length===0||wt.array(e)&&e.length===0||wt.object(e)&&!wt.map(e)&&!wt.set(e)&&Object.keys(e).length===0||wt.set(e)&&e.size===0||wt.map(e)&&e.size===0};wt.error=ll("Error");wt.function=$f("function");wt.generator=function(e){return wt.iterable(e)&&wt.function(e.next)&&wt.function(e.throw)};wt.generatorFunction=ll("GeneratorFunction");wt.instanceOf=function(e,t){return!e||!t?!1:Object.getPrototypeOf(e)===t.prototype};wt.iterable=function(e){return!wt.nullOrUndefined(e)&&wt.function(e[Symbol.iterator])};wt.map=ll("Map");wt.nan=function(e){return Number.isNaN(e)};wt.null=function(e){return e===null};wt.nullOrUndefined=function(e){return wt.null(e)||wt.undefined(e)};wt.number=function(e){return $f("number")(e)&&!wt.nan(e)};wt.numericString=function(e){return wt.string(e)&&e.length>0&&!Number.isNaN(Number(e))};wt.object=function(e){return!wt.nullOrUndefined(e)&&(wt.function(e)||typeof e=="object")};wt.oneOf=function(e,t){return wt.array(e)?e.indexOf(t)>-1:!1};wt.plainFunction=ll("Function");wt.plainObject=function(e){if(Vg(e)!=="Object")return!1;var t=Object.getPrototypeOf(e);return t===null||t===Object.getPrototypeOf({})};wt.primitive=function(e){return wt.null(e)||FW(typeof e)};wt.promise=ll("Promise");wt.propertyOf=function(e,t,r){if(!wt.object(e)||!t)return!1;var a=e[t];return wt.function(r)?r(a):wt.defined(a)};wt.regexp=ll("RegExp");wt.set=ll("Set");wt.string=$f("string");wt.symbol=$f("symbol");wt.undefined=$f("undefined");wt.weakMap=ll("WeakMap");wt.weakSet=ll("WeakSet");function Vk(e){return function(t){return typeof t===e}}var BW=Vk("function"),VW=function(e){return e===null},AC=function(e){return Object.prototype.toString.call(e).slice(8,-1)==="RegExp"},kC=function(e){return!UW(e)&&!VW(e)&&(BW(e)||typeof e=="object")},UW=Vk("undefined"),Ky=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function zW(e,t){var r=e.length;if(r!==t.length)return!1;for(var a=r;a--!==0;)if(!Ti(e[a],t[a]))return!1;return!0}function $W(e,t){if(e.byteLength!==t.byteLength)return!1;for(var r=new DataView(e.buffer),a=new DataView(t.buffer),n=e.byteLength;n--;)if(r.getUint8(n)!==a.getUint8(n))return!1;return!0}function qW(e,t){var r,a,n,i;if(e.size!==t.size)return!1;try{for(var o=Ky(e.entries()),c=o.next();!c.done;c=o.next()){var d=c.value;if(!t.has(d[0]))return!1}}catch(x){r={error:x}}finally{try{c&&!c.done&&(a=o.return)&&a.call(o)}finally{if(r)throw r.error}}try{for(var h=Ky(e.entries()),p=h.next();!p.done;p=h.next()){var d=p.value;if(!Ti(d[1],t.get(d[0])))return!1}}catch(x){n={error:x}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}return!0}function WW(e,t){var r,a;if(e.size!==t.size)return!1;try{for(var n=Ky(e.entries()),i=n.next();!i.done;i=n.next()){var o=i.value;if(!t.has(o[0]))return!1}}catch(c){r={error:c}}finally{try{i&&!i.done&&(a=n.return)&&a.call(n)}finally{if(r)throw r.error}}return!0}function Ti(e,t){if(e===t)return!0;if(e&&kC(e)&&t&&kC(t)){if(e.constructor!==t.constructor)return!1;if(Array.isArray(e)&&Array.isArray(t))return zW(e,t);if(e instanceof Map&&t instanceof Map)return qW(e,t);if(e instanceof Set&&t instanceof Set)return WW(e,t);if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return $W(e,t);if(AC(e)&&AC(t))return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();var r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(var n=r.length;n--!==0;)if(!Object.prototype.hasOwnProperty.call(t,r[n]))return!1;for(var n=r.length;n--!==0;){var i=r[n];if(!(i==="_owner"&&e.$$typeof)&&!Ti(e[i],t[i]))return!1}return!0}return Number.isNaN(e)&&Number.isNaN(t)?!0:e===t}function HW(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.every(function(r){return wt.string(r)||wt.array(r)||wt.plainObject(r)})}function GW(e,t,r){return Uk(e,t)?[e,t].every(wt.array)?!e.some(DC(r))&&t.some(DC(r)):[e,t].every(wt.plainObject)?!Object.entries(e).some(OC(r))&&Object.entries(t).some(OC(r)):t===r:!1}function RC(e,t,r){var a=r.actual,n=r.key,i=r.previous,o=r.type,c=Al(e,n),d=Al(t,n),h=[c,d].every(wt.number)&&(o==="increased"?c<d:c>d);return wt.undefined(a)||(h=h&&d===a),wt.undefined(i)||(h=h&&c===i),h}function PC(e,t,r){var a=r.key,n=r.type,i=r.value,o=Al(e,a),c=Al(t,a),d=n==="added"?o:c,h=n==="added"?c:o;if(!wt.nullOrUndefined(i)){if(wt.defined(d)){if(wt.array(d)||wt.plainObject(d))return GW(d,h,i)}else return Ti(h,i);return!1}return[o,c].every(wt.array)?!h.every(Qb(d)):[o,c].every(wt.plainObject)?KW(Object.keys(d),Object.keys(h)):![o,c].every(function(p){return wt.primitive(p)&&wt.defined(p)})&&(n==="added"?!wt.defined(o)&&wt.defined(c):wt.defined(o)&&!wt.defined(c))}function IC(e,t,r){var a=r===void 0?{}:r,n=a.key,i=Al(e,n),o=Al(t,n);if(!Uk(i,o))throw new TypeError("Inputs have different types");if(!HW(i,o))throw new TypeError("Inputs don't have length");return[i,o].every(wt.plainObject)&&(i=Object.keys(i),o=Object.keys(o)),[i,o]}function OC(e){return function(t){var r=t[0],a=t[1];return wt.array(e)?Ti(e,a)||e.some(function(n){return Ti(n,a)||wt.array(a)&&Qb(a)(n)}):wt.plainObject(e)&&e[r]?!!e[r]&&Ti(e[r],a):Ti(e,a)}}function KW(e,t){return t.some(function(r){return!e.includes(r)})}function DC(e){return function(t){return wt.array(e)?e.some(function(r){return Ti(r,t)||wt.array(t)&&Qb(t)(r)}):Ti(e,t)}}function xm(e,t){return wt.array(e)?e.some(function(r){return Ti(r,t)}):Ti(e,t)}function Qb(e){return function(t){return e.some(function(r){return Ti(r,t)})}}function Uk(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.every(wt.array)||e.every(wt.number)||e.every(wt.plainObject)||e.every(wt.string)}function Al(e,t){if(wt.plainObject(e)||wt.array(e)){if(wt.string(t)){var r=t.split(".");return r.reduce(function(a,n){return a&&a[n]},e)}return wt.number(t)?e[t]:e}return e}function XW(e,t){if([e,t].some(wt.nullOrUndefined))throw new Error("Missing required parameters");if(![e,t].every(function(x){return wt.plainObject(x)||wt.array(x)}))throw new Error("Expected plain objects or array");var r=function(x,v){try{return PC(e,t,{key:x,type:"added",value:v})}catch{return!1}},a=function(x,v,b){try{var N=Al(e,x),_=Al(t,x),C=wt.defined(v),T=wt.defined(b);if(C||T){var A=T?xm(b,N):!xm(v,N),k=xm(v,_);return A&&k}return[N,_].every(wt.array)||[N,_].every(wt.plainObject)?!Ti(N,_):N!==_}catch{return!1}},n=function(x,v,b){if(!wt.defined(x))return!1;try{var N=Al(e,x),_=Al(t,x),C=wt.defined(b);return xm(v,N)&&(C?xm(b,_):!C)}catch{return!1}},i=function(x,v){return wt.defined(x)?a(x,v):!1},o=function(x,v,b){if(!wt.defined(x))return!1;try{return RC(e,t,{key:x,actual:v,previous:b,type:"decreased"})}catch{return!1}},c=function(x){try{var v=IC(e,t,{key:x}),b=v[0],N=v[1];return!!b.length&&!N.length}catch{return!1}},d=function(x){try{var v=IC(e,t,{key:x}),b=v[0],N=v[1];return!b.length&&!!N.length}catch{return!1}},h=function(x,v,b){if(!wt.defined(x))return!1;try{return RC(e,t,{key:x,actual:v,previous:b,type:"increased"})}catch{return!1}},p=function(x,v){try{return PC(e,t,{key:x,type:"removed",value:v})}catch{return!1}};return{added:r,changed:a,changedFrom:n,changedTo:i,decreased:o,emptied:c,filled:d,increased:h,removed:p}}function MC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function ya(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?MC(Object(r),!0).forEach(function(a){Wn(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):MC(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function s0(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YW(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,$k(a.key),a)}}function r0(e,t,r){return t&&YW(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wn(e,t,r){return t=$k(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a0(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xy(e,t)}function Kx(e){return Kx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Kx(e)}function Xy(e,t){return Xy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,n){return a.__proto__=n,a},Xy(e,t)}function ZW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function QW(e,t){if(e==null)return{};var r={},a=Object.keys(e),n,i;for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&(r[n]=e[n]);return r}function zk(e,t){if(e==null)return{};var r=QW(e,t),a,n;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function rc(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JW(e,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rc(e)}function n0(e){var t=ZW();return function(){var a=Kx(e),n;if(t){var i=Kx(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return JW(this,n)}}function eH(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $k(e){var t=eH(e,"string");return typeof t=="symbol"?t:String(t)}var tH={flip:{padding:20},preventOverflow:{padding:10}},sH="The typeValidator argument must be a function with the signature function(props, propName, componentName).",rH="The error message is optional, but must be a string if provided.";function aH(e,t,r,a){return typeof e=="boolean"?e:typeof e=="function"?e(t,r,a):e?!!e:!1}function nH(e,t){return Object.hasOwnProperty.call(e,t)}function iH(e,t,r,a){return new Error("Required ".concat(e[t]," `").concat(t,"` was not specified in `").concat(r,"`."))}function oH(e,t){if(typeof e!="function")throw new TypeError(sH);if(t&&typeof t!="string")throw new TypeError(rH)}function LC(e,t,r){return oH(e,r),function(a,n,i){for(var o=arguments.length,c=new Array(o>3?o-3:0),d=3;d<o;d++)c[d-3]=arguments[d];return aH(t,a,n,i)?nH(a,n)?e.apply(void 0,[a,n,i].concat(c)):iH(a,n,i):e.apply(void 0,[a,n,i].concat(c))}}var Cr={INIT:"init",IDLE:"idle",OPENING:"opening",OPEN:"open",CLOSING:"closing",ERROR:"error"},gm=Om.createPortal!==void 0;function yl(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function rv(){return"ontouchstart"in window&&/Mobi/.test(navigator.userAgent)}function U0(e){var t=e.title,r=e.data,a=e.warn,n=a===void 0?!1:a,i=e.debug,o=i===void 0?!1:i,c=n?console.warn||console.error:console.log;o&&t&&r&&(console.groupCollapsed("%creact-floater: ".concat(t),"color: #9b00ff; font-weight: bold; font-size: 12px;"),Array.isArray(r)?r.forEach(function(d){wt.plainObject(d)&&d.key?c.apply(console,[d.key,d.value]):c.apply(console,[d])}):c.apply(console,[r]),console.groupEnd())}function lH(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;e.addEventListener(t,r,a)}function cH(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;e.removeEventListener(t,r,a)}function dH(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,n;n=function(o){r(o),cH(e,t,n)},lH(e,t,n,a)}function FC(){}var qk=function(e){a0(r,e);var t=n0(r);function r(){return s0(this,r),t.apply(this,arguments)}return r0(r,[{key:"componentDidMount",value:function(){yl()&&(this.node||this.appendNode(),gm||this.renderPortal())}},{key:"componentDidUpdate",value:function(){yl()&&(gm||this.renderPortal())}},{key:"componentWillUnmount",value:function(){!yl()||!this.node||(gm||Om.unmountComponentAtNode(this.node),this.node&&this.node.parentNode===document.body&&(document.body.removeChild(this.node),this.node=void 0))}},{key:"appendNode",value:function(){var n=this.props,i=n.id,o=n.zIndex;this.node||(this.node=document.createElement("div"),i&&(this.node.id=i),o&&(this.node.style.zIndex=o),document.body.appendChild(this.node))}},{key:"renderPortal",value:function(){if(!yl())return null;var n=this.props,i=n.children,o=n.setRef;if(this.node||this.appendNode(),gm)return Om.createPortal(i,this.node);var c=Om.unstable_renderSubtreeIntoContainer(this,i.length>1?He.createElement("div",null,i):i[0],this.node);return o(c),null}},{key:"renderReact16",value:function(){var n=this.props,i=n.hasChildren,o=n.placement,c=n.target;return i?this.renderPortal():c||o==="center"?this.renderPortal():null}},{key:"render",value:function(){return gm?this.renderReact16():null}}]),r}(He.Component);Wn(qk,"propTypes",{children:Wt.oneOfType([Wt.element,Wt.array]),hasChildren:Wt.bool,id:Wt.oneOfType([Wt.string,Wt.number]),placement:Wt.string,setRef:Wt.func.isRequired,target:Wt.oneOfType([Wt.object,Wt.string]),zIndex:Wt.number});var Wk=function(e){a0(r,e);var t=n0(r);function r(){return s0(this,r),t.apply(this,arguments)}return r0(r,[{key:"parentStyle",get:function(){var n=this.props,i=n.placement,o=n.styles,c=o.arrow.length,d={pointerEvents:"none",position:"absolute",width:"100%"};return i.startsWith("top")?(d.bottom=0,d.left=0,d.right=0,d.height=c):i.startsWith("bottom")?(d.left=0,d.right=0,d.top=0,d.height=c):i.startsWith("left")?(d.right=0,d.top=0,d.bottom=0):i.startsWith("right")&&(d.left=0,d.top=0),d}},{key:"render",value:function(){var n=this.props,i=n.placement,o=n.setArrowRef,c=n.styles,d=c.arrow,h=d.color,p=d.display,x=d.length,v=d.margin,b=d.position,N=d.spread,_={display:p,position:b},C,T=N,A=x;return i.startsWith("top")?(C="0,0 ".concat(T/2,",").concat(A," ").concat(T,",0"),_.bottom=0,_.marginLeft=v,_.marginRight=v):i.startsWith("bottom")?(C="".concat(T,",").concat(A," ").concat(T/2,",0 0,").concat(A),_.top=0,_.marginLeft=v,_.marginRight=v):i.startsWith("left")?(A=N,T=x,C="0,0 ".concat(T,",").concat(A/2," 0,").concat(A),_.right=0,_.marginTop=v,_.marginBottom=v):i.startsWith("right")&&(A=N,T=x,C="".concat(T,",").concat(A," ").concat(T,",0 0,").concat(A/2),_.left=0,_.marginTop=v,_.marginBottom=v),He.createElement("div",{className:"__floater__arrow",style:this.parentStyle},He.createElement("span",{ref:o,style:_},He.createElement("svg",{width:T,height:A,version:"1.1",xmlns:"http://www.w3.org/2000/svg"},He.createElement("polygon",{points:C,fill:h}))))}}]),r}(He.Component);Wn(Wk,"propTypes",{placement:Wt.string.isRequired,setArrowRef:Wt.func.isRequired,styles:Wt.object.isRequired});var uH=["color","height","width"];function Hk(e){var t=e.handleClick,r=e.styles,a=r.color,n=r.height,i=r.width,o=zk(r,uH);return He.createElement("button",{"aria-label":"close",onClick:t,style:o,type:"button"},He.createElement("svg",{width:"".concat(i,"px"),height:"".concat(n,"px"),viewBox:"0 0 18 18",version:"1.1",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid"},He.createElement("g",null,He.createElement("path",{d:"M8.13911129,9.00268191 L0.171521827,17.0258467 C-0.0498027049,17.248715 -0.0498027049,17.6098394 0.171521827,17.8327545 C0.28204354,17.9443526 0.427188206,17.9998706 0.572051765,17.9998706 C0.71714958,17.9998706 0.862013139,17.9443526 0.972581703,17.8327545 L9.0000937,9.74924618 L17.0276057,17.8327545 C17.1384085,17.9443526 17.2832721,17.9998706 17.4281356,17.9998706 C17.5729992,17.9998706 17.718097,17.9443526 17.8286656,17.8327545 C18.0499901,17.6098862 18.0499901,17.2487618 17.8286656,17.0258467 L9.86135722,9.00268191 L17.8340066,0.973848225 C18.0553311,0.750979934 18.0553311,0.389855532 17.8340066,0.16694039 C17.6126821,-0.0556467968 17.254037,-0.0556467968 17.0329467,0.16694039 L9.00042166,8.25611765 L0.967006424,0.167268345 C0.745681892,-0.0553188426 0.387317931,-0.0553188426 0.165993399,0.167268345 C-0.0553311331,0.390136635 -0.0553311331,0.751261038 0.165993399,0.974176179 L8.13920499,9.00268191 L8.13911129,9.00268191 Z",fill:a}))))}Hk.propTypes={handleClick:Wt.func.isRequired,styles:Wt.object.isRequired};function Gk(e){var t=e.content,r=e.footer,a=e.handleClick,n=e.open,i=e.positionWrapper,o=e.showCloseButton,c=e.title,d=e.styles,h={content:He.isValidElement(t)?t:He.createElement("div",{className:"__floater__content",style:d.content},t)};return c&&(h.title=He.isValidElement(c)?c:He.createElement("div",{className:"__floater__title",style:d.title},c)),r&&(h.footer=He.isValidElement(r)?r:He.createElement("div",{className:"__floater__footer",style:d.footer},r)),(o||i)&&!wt.boolean(n)&&(h.close=He.createElement(Hk,{styles:d.close,handleClick:a})),He.createElement("div",{className:"__floater__container",style:d.container},h.close,h.title,h.content,h.footer)}Gk.propTypes={content:Wt.node.isRequired,footer:Wt.node,handleClick:Wt.func.isRequired,open:Wt.bool,positionWrapper:Wt.bool.isRequired,showCloseButton:Wt.bool.isRequired,styles:Wt.object.isRequired,title:Wt.node};var Kk=function(e){a0(r,e);var t=n0(r);function r(){return s0(this,r),t.apply(this,arguments)}return r0(r,[{key:"style",get:function(){var n=this.props,i=n.disableAnimation,o=n.component,c=n.placement,d=n.hideArrow,h=n.status,p=n.styles,x=p.arrow.length,v=p.floater,b=p.floaterCentered,N=p.floaterClosing,_=p.floaterOpening,C=p.floaterWithAnimation,T=p.floaterWithComponent,A={};return d||(c.startsWith("top")?A.padding="0 0 ".concat(x,"px"):c.startsWith("bottom")?A.padding="".concat(x,"px 0 0"):c.startsWith("left")?A.padding="0 ".concat(x,"px 0 0"):c.startsWith("right")&&(A.padding="0 0 0 ".concat(x,"px"))),[Cr.OPENING,Cr.OPEN].indexOf(h)!==-1&&(A=ya(ya({},A),_)),h===Cr.CLOSING&&(A=ya(ya({},A),N)),h===Cr.OPEN&&!i&&(A=ya(ya({},A),C)),c==="center"&&(A=ya(ya({},A),b)),o&&(A=ya(ya({},A),T)),ya(ya({},v),A)}},{key:"render",value:function(){var n=this.props,i=n.component,o=n.handleClick,c=n.hideArrow,d=n.setFloaterRef,h=n.status,p={},x=["__floater"];return i?He.isValidElement(i)?p.content=He.cloneElement(i,{closeFn:o}):p.content=i({closeFn:o}):p.content=He.createElement(Gk,this.props),h===Cr.OPEN&&x.push("__floater__open"),c||(p.arrow=He.createElement(Wk,this.props)),He.createElement("div",{ref:d,className:x.join(" "),style:this.style},He.createElement("div",{className:"__floater__body"},p.content,p.arrow))}}]),r}(He.Component);Wn(Kk,"propTypes",{component:Wt.oneOfType([Wt.func,Wt.element]),content:Wt.node,disableAnimation:Wt.bool.isRequired,footer:Wt.node,handleClick:Wt.func.isRequired,hideArrow:Wt.bool.isRequired,open:Wt.bool,placement:Wt.string.isRequired,positionWrapper:Wt.bool.isRequired,setArrowRef:Wt.func.isRequired,setFloaterRef:Wt.func.isRequired,showCloseButton:Wt.bool,status:Wt.string.isRequired,styles:Wt.object.isRequired,title:Wt.node});var Xk=function(e){a0(r,e);var t=n0(r);function r(){return s0(this,r),t.apply(this,arguments)}return r0(r,[{key:"render",value:function(){var n=this.props,i=n.children,o=n.handleClick,c=n.handleMouseEnter,d=n.handleMouseLeave,h=n.setChildRef,p=n.setWrapperRef,x=n.style,v=n.styles,b;if(i)if(He.Children.count(i)===1)if(!He.isValidElement(i))b=He.createElement("span",null,i);else{var N=wt.function(i.type)?"innerRef":"ref";b=He.cloneElement(He.Children.only(i),Wn({},N,h))}else b=i;return b?He.createElement("span",{ref:p,style:ya(ya({},v),x),onClick:o,onMouseEnter:c,onMouseLeave:d},b):null}}]),r}(He.Component);Wn(Xk,"propTypes",{children:Wt.node,handleClick:Wt.func.isRequired,handleMouseEnter:Wt.func.isRequired,handleMouseLeave:Wt.func.isRequired,setChildRef:Wt.func.isRequired,setWrapperRef:Wt.func.isRequired,style:Wt.object,styles:Wt.object.isRequired});var hH={zIndex:100};function fH(e){var t=Jo(hH,e.options||{});return{wrapper:{cursor:"help",display:"inline-flex",flexDirection:"column",zIndex:t.zIndex},wrapperPosition:{left:-1e3,position:"absolute",top:-1e3,visibility:"hidden"},floater:{display:"inline-block",filter:"drop-shadow(0 0 3px rgba(0, 0, 0, 0.3))",maxWidth:300,opacity:0,position:"relative",transition:"opacity 0.3s",visibility:"hidden",zIndex:t.zIndex},floaterOpening:{opacity:1,visibility:"visible"},floaterWithAnimation:{opacity:1,transition:"opacity 0.3s, transform 0.2s",visibility:"visible"},floaterWithComponent:{maxWidth:"100%"},floaterClosing:{opacity:0,visibility:"visible"},floaterCentered:{left:"50%",position:"fixed",top:"50%",transform:"translate(-50%, -50%)"},container:{backgroundColor:"#fff",color:"#666",minHeight:60,minWidth:200,padding:20,position:"relative",zIndex:10},title:{borderBottom:"1px solid #555",color:"#555",fontSize:18,marginBottom:5,paddingBottom:6,paddingRight:18},content:{fontSize:15},close:{backgroundColor:"transparent",border:0,borderRadius:0,color:"#555",fontSize:0,height:15,outline:"none",padding:10,position:"absolute",right:0,top:0,width:15,WebkitAppearance:"none"},footer:{borderTop:"1px solid #ccc",fontSize:13,marginTop:10,paddingTop:5},arrow:{color:"#fff",display:"inline-flex",length:16,margin:8,position:"absolute",spread:32},options:t}}var mH=["arrow","flip","offset"],pH=["position","top","right","bottom","left"],Jb=function(e){a0(r,e);var t=n0(r);function r(a){var n;return s0(this,r),n=t.call(this,a),Wn(rc(n),"setArrowRef",function(i){n.arrowRef=i}),Wn(rc(n),"setChildRef",function(i){n.childRef=i}),Wn(rc(n),"setFloaterRef",function(i){n.floaterRef=i}),Wn(rc(n),"setWrapperRef",function(i){n.wrapperRef=i}),Wn(rc(n),"handleTransitionEnd",function(){var i=n.state.status,o=n.props.callback;n.wrapperPopper&&n.wrapperPopper.instance.update(),n.setState({status:i===Cr.OPENING?Cr.OPEN:Cr.IDLE},function(){var c=n.state.status;o(c===Cr.OPEN?"open":"close",n.props)})}),Wn(rc(n),"handleClick",function(){var i=n.props,o=i.event,c=i.open;if(!wt.boolean(c)){var d=n.state,h=d.positionWrapper,p=d.status;(n.event==="click"||n.event==="hover"&&h)&&(U0({title:"click",data:[{event:o,status:p===Cr.OPEN?"closing":"opening"}],debug:n.debug}),n.toggle())}}),Wn(rc(n),"handleMouseEnter",function(){var i=n.props,o=i.event,c=i.open;if(!(wt.boolean(c)||rv())){var d=n.state.status;n.event==="hover"&&d===Cr.IDLE&&(U0({title:"mouseEnter",data:[{key:"originalEvent",value:o}],debug:n.debug}),clearTimeout(n.eventDelayTimeout),n.toggle())}}),Wn(rc(n),"handleMouseLeave",function(){var i=n.props,o=i.event,c=i.eventDelay,d=i.open;if(!(wt.boolean(d)||rv())){var h=n.state,p=h.status,x=h.positionWrapper;n.event==="hover"&&(U0({title:"mouseLeave",data:[{key:"originalEvent",value:o}],debug:n.debug}),c?[Cr.OPENING,Cr.OPEN].indexOf(p)!==-1&&!x&&!n.eventDelayTimeout&&(n.eventDelayTimeout=setTimeout(function(){delete n.eventDelayTimeout,n.toggle()},c*1e3)):n.toggle(Cr.IDLE))}}),n.state={currentPlacement:a.placement,needsUpdate:!1,positionWrapper:a.wrapperOptions.position&&!!a.target,status:Cr.INIT,statusWrapper:Cr.INIT},n._isMounted=!1,n.hasMounted=!1,yl()&&window.addEventListener("load",function(){n.popper&&n.popper.instance.update(),n.wrapperPopper&&n.wrapperPopper.instance.update()}),n}return r0(r,[{key:"componentDidMount",value:function(){if(yl()){var n=this.state.positionWrapper,i=this.props,o=i.children,c=i.open,d=i.target;this._isMounted=!0,U0({title:"init",data:{hasChildren:!!o,hasTarget:!!d,isControlled:wt.boolean(c),positionWrapper:n,target:this.target,floater:this.floaterRef},debug:this.debug}),this.hasMounted||(this.initPopper(),this.hasMounted=!0),!o&&d&&wt.boolean(c)}}},{key:"componentDidUpdate",value:function(n,i){if(yl()){var o=this.props,c=o.autoOpen,d=o.open,h=o.target,p=o.wrapperOptions,x=XW(i,this.state),v=x.changedFrom,b=x.changed;if(n.open!==d){var N;wt.boolean(d)&&(N=d?Cr.OPENING:Cr.CLOSING),this.toggle(N)}(n.wrapperOptions.position!==p.position||n.target!==h)&&this.changeWrapperPosition(this.props),b("status",Cr.IDLE)&&d?this.toggle(Cr.OPEN):v("status",Cr.INIT,Cr.IDLE)&&c&&this.toggle(Cr.OPEN),this.popper&&b("status",Cr.OPENING)&&this.popper.instance.update(),this.floaterRef&&(b("status",Cr.OPENING)||b("status",Cr.CLOSING))&&dH(this.floaterRef,"transitionend",this.handleTransitionEnd),b("needsUpdate",!0)&&this.rebuildPopper()}}},{key:"componentWillUnmount",value:function(){yl()&&(this._isMounted=!1,this.popper&&this.popper.instance.destroy(),this.wrapperPopper&&this.wrapperPopper.instance.destroy())}},{key:"initPopper",value:function(){var n=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.target,o=this.state.positionWrapper,c=this.props,d=c.disableFlip,h=c.getPopper,p=c.hideArrow,x=c.offset,v=c.placement,b=c.wrapperOptions,N=v==="top"||v==="bottom"?"flip":["right","bottom-end","top-end","left","top-start","bottom-start"];if(v==="center")this.setState({status:Cr.IDLE});else if(i&&this.floaterRef){var _=this.options,C=_.arrow,T=_.flip,A=_.offset,k=zk(_,mH);new Tp(i,this.floaterRef,{placement:v,modifiers:ya({arrow:ya({enabled:!p,element:this.arrowRef},C),flip:ya({enabled:!d,behavior:N},T),offset:ya({offset:"0, ".concat(x,"px")},A)},k),onCreate:function(O){var D;if(n.popper=O,!((D=n.floaterRef)!==null&&D!==void 0&&D.isConnected)){n.setState({needsUpdate:!0});return}h(O,"floater"),n._isMounted&&n.setState({currentPlacement:O.placement,status:Cr.IDLE}),v!==O.placement&&setTimeout(function(){O.instance.update()},1)},onUpdate:function(O){n.popper=O;var D=n.state.currentPlacement;n._isMounted&&O.placement!==D&&n.setState({currentPlacement:O.placement})}})}if(o){var I=wt.undefined(b.offset)?0:b.offset;new Tp(this.target,this.wrapperRef,{placement:b.placement||v,modifiers:{arrow:{enabled:!1},offset:{offset:"0, ".concat(I,"px")},flip:{enabled:!1}},onCreate:function(O){n.wrapperPopper=O,n._isMounted&&n.setState({statusWrapper:Cr.IDLE}),h(O,"wrapper"),v!==O.placement&&setTimeout(function(){O.instance.update()},1)}})}}},{key:"rebuildPopper",value:function(){var n=this;this.floaterRefInterval=setInterval(function(){var i;(i=n.floaterRef)!==null&&i!==void 0&&i.isConnected&&(clearInterval(n.floaterRefInterval),n.setState({needsUpdate:!1}),n.initPopper())},50)}},{key:"changeWrapperPosition",value:function(n){var i=n.target,o=n.wrapperOptions;this.setState({positionWrapper:o.position&&!!i})}},{key:"toggle",value:function(n){var i=this.state.status,o=i===Cr.OPEN?Cr.CLOSING:Cr.OPENING;wt.undefined(n)||(o=n),this.setState({status:o})}},{key:"debug",get:function(){var n=this.props.debug;return n||yl()&&"ReactFloaterDebug"in window&&!!window.ReactFloaterDebug}},{key:"event",get:function(){var n=this.props,i=n.disableHoverToClick,o=n.event;return o==="hover"&&rv()&&!i?"click":o}},{key:"options",get:function(){var n=this.props.options;return Jo(tH,n||{})}},{key:"styles",get:function(){var n=this,i=this.state,o=i.status,c=i.positionWrapper,d=i.statusWrapper,h=this.props.styles,p=Jo(fH(h),h);if(c){var x;[Cr.IDLE].indexOf(o)===-1||[Cr.IDLE].indexOf(d)===-1?x=p.wrapperPosition:x=this.wrapperPopper.styles,p.wrapper=ya(ya({},p.wrapper),x)}if(this.target){var v=window.getComputedStyle(this.target);this.wrapperStyles?p.wrapper=ya(ya({},p.wrapper),this.wrapperStyles):["relative","static"].indexOf(v.position)===-1&&(this.wrapperStyles={},c||(pH.forEach(function(b){n.wrapperStyles[b]=v[b]}),p.wrapper=ya(ya({},p.wrapper),this.wrapperStyles),this.target.style.position="relative",this.target.style.top="auto",this.target.style.right="auto",this.target.style.bottom="auto",this.target.style.left="auto"))}return p}},{key:"target",get:function(){if(!yl())return null;var n=this.props.target;return n?wt.domElement(n)?n:document.querySelector(n):this.childRef||this.wrapperRef}},{key:"render",value:function(){var n=this.state,i=n.currentPlacement,o=n.positionWrapper,c=n.status,d=this.props,h=d.children,p=d.component,x=d.content,v=d.disableAnimation,b=d.footer,N=d.hideArrow,_=d.id,C=d.open,T=d.showCloseButton,A=d.style,k=d.target,I=d.title,B=He.createElement(Xk,{handleClick:this.handleClick,handleMouseEnter:this.handleMouseEnter,handleMouseLeave:this.handleMouseLeave,setChildRef:this.setChildRef,setWrapperRef:this.setWrapperRef,style:A,styles:this.styles.wrapper},h),O={};return o?O.wrapperInPortal=B:O.wrapperAsChildren=B,He.createElement("span",null,He.createElement(qk,{hasChildren:!!h,id:_,placement:i,setRef:this.setFloaterRef,target:k,zIndex:this.styles.options.zIndex},He.createElement(Kk,{component:p,content:x,disableAnimation:v,footer:b,handleClick:this.handleClick,hideArrow:N||i==="center",open:C,placement:i,positionWrapper:o,setArrowRef:this.setArrowRef,setFloaterRef:this.setFloaterRef,showCloseButton:T,status:c,styles:this.styles,title:I}),O.wrapperInPortal),O.wrapperAsChildren)}}]),r}(He.Component);Wn(Jb,"propTypes",{autoOpen:Wt.bool,callback:Wt.func,children:Wt.node,component:LC(Wt.oneOfType([Wt.func,Wt.element]),function(e){return!e.content}),content:LC(Wt.node,function(e){return!e.component}),debug:Wt.bool,disableAnimation:Wt.bool,disableFlip:Wt.bool,disableHoverToClick:Wt.bool,event:Wt.oneOf(["hover","click"]),eventDelay:Wt.number,footer:Wt.node,getPopper:Wt.func,hideArrow:Wt.bool,id:Wt.oneOfType([Wt.string,Wt.number]),offset:Wt.number,open:Wt.bool,options:Wt.object,placement:Wt.oneOf(["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end","auto","center"]),showCloseButton:Wt.bool,style:Wt.object,styles:Wt.object,target:Wt.oneOfType([Wt.object,Wt.string]),title:Wt.node,wrapperOptions:Wt.shape({offset:Wt.number,placement:Wt.oneOf(["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end","auto"]),position:Wt.bool})});Wn(Jb,"defaultProps",{autoOpen:!1,callback:FC,debug:!1,disableAnimation:!1,disableFlip:!1,disableHoverToClick:!1,event:"click",eventDelay:.4,getPopper:FC,hideArrow:!1,offset:15,placement:"bottom",showCloseButton:!1,styles:{},target:null,wrapperOptions:{position:!1}});var xH=Object.defineProperty,gH=(e,t,r)=>t in e?xH(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ms=(e,t,r)=>gH(e,typeof t!="symbol"?t+"":t,r),Fr={INIT:"init",START:"start",STOP:"stop",RESET:"reset",PREV:"prev",NEXT:"next",GO:"go",CLOSE:"close",SKIP:"skip",UPDATE:"update"},Ko={TOUR_START:"tour:start",STEP_BEFORE:"step:before",BEACON:"beacon",TOOLTIP:"tooltip",STEP_AFTER:"step:after",TOUR_END:"tour:end",TOUR_STATUS:"tour:status",TARGET_NOT_FOUND:"error:target_not_found",ERROR:"error"},er={INIT:"init",READY:"ready",BEACON:"beacon",TOOLTIP:"tooltip",COMPLETE:"complete",ERROR:"error"},xr={IDLE:"idle",READY:"ready",WAITING:"waiting",RUNNING:"running",PAUSED:"paused",SKIPPED:"skipped",FINISHED:"finished",ERROR:"error"};function nd(){var e;return!!(typeof window<"u"&&((e=window.document)!=null&&e.createElement))}function Yk(e){return e?e.getBoundingClientRect():null}function vH(e=!1){const{body:t,documentElement:r}=document;if(!t||!r)return 0;if(e){const a=[t.scrollHeight,t.offsetHeight,r.clientHeight,r.scrollHeight,r.offsetHeight].sort((i,o)=>i-o),n=Math.floor(a.length/2);return a.length%2===0?(a[n-1]+a[n])/2:a[n]}return Math.max(t.scrollHeight,t.offsetHeight,r.clientHeight,r.scrollHeight,r.offsetHeight)}function uc(e){if(typeof e=="string")try{return document.querySelector(e)}catch{return null}return e}function yH(e){return!e||e.nodeType!==1?null:getComputedStyle(e)}function Ap(e,t,r){if(!e)return uu();const a=jk(e);if(a){if(a.isSameNode(uu()))return r?document:uu();if(!(a.scrollHeight>a.offsetHeight)&&!t)return a.style.overflow="initial",uu()}return a}function Ug(e,t){if(!e)return!1;const r=Ap(e,t);return r?!r.isSameNode(uu()):!1}function wH(e){return e.offsetParent!==document.body}function xf(e,t="fixed"){if(!e||!(e instanceof HTMLElement))return!1;const{nodeName:r}=e,a=yH(e);return r==="BODY"||r==="HTML"?!1:a&&a.position===t?!0:e.parentNode?xf(e.parentNode,t):!1}function bH(e){var t;if(!e)return!1;let r=e;for(;r&&r!==document.body;){if(r instanceof HTMLElement){const{display:a,visibility:n}=getComputedStyle(r);if(a==="none"||n==="hidden")return!1}r=(t=r.parentElement)!=null?t:null}return!0}function _H(e,t,r){var a,n,i;const o=Yk(e),c=Ap(e,r),d=Ug(e,r),h=xf(e);let p=0,x=(a=o==null?void 0:o.top)!=null?a:0;if(d&&h){const v=(n=e==null?void 0:e.offsetTop)!=null?n:0,b=(i=c==null?void 0:c.scrollTop)!=null?i:0;x=v-b}else c instanceof HTMLElement&&(p=c.scrollTop,!d&&!xf(e)&&(x+=p),c.isSameNode(uu())||(x+=uu().scrollTop));return Math.floor(x-t)}function jH(e,t,r){var a;if(!e)return 0;const{offsetTop:n=0,scrollTop:i=0}=(a=jk(e))!=null?a:{};let o=e.getBoundingClientRect().top+i;n&&(Ug(e,r)||wH(e))&&(o-=n);const c=Math.floor(o-t);return c<0?0:c}function uu(){var e;return(e=document.scrollingElement)!=null?e:document.documentElement}function NH(e,t){const{duration:r,element:a}=t;return new Promise((n,i)=>{const{scrollTop:o}=a,c=e>o?e-o:o-e;Pq.top(a,e,{duration:c<100?50:r},d=>d&&d.message!=="Element already at target scroll position"?i(d):n())})}var vm=_u.createPortal!==void 0;function Zk(e=navigator.userAgent){let t=e;return typeof window>"u"?t="node":document.documentMode?t="ie":/Edge/.test(e)?t="edge":window.opera||e.includes(" OPR/")?t="opera":typeof window.InstallTrigger<"u"?t="firefox":window.chrome?t="chrome":/(Version\/([\d._]+).*Safari|CriOS|FxiOS| Mobile\/)/.test(e)&&(t="safari"),t}function xx(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function wl(e,t={}){const{defaultValue:r,step:a,steps:n}=t;let i=_C(e);if(i)(i.includes("{step}")||i.includes("{steps}"))&&a&&n&&(i=i.replace("{step}",a.toString()).replace("{steps}",n.toString()));else if(E.isValidElement(e)&&!Object.values(e.props).length&&xx(e.type)==="function"){const o=e.type({});i=wl(o,t)}else i=_C(r);return i}function CH(e,t){return!hs.plainObject(e)||!hs.array(t)?!1:Object.keys(e).every(r=>t.includes(r))}function EH(e){const t=/^#?([\da-f])([\da-f])([\da-f])$/i,r=e.replace(t,(n,i,o,c)=>i+i+o+o+c+c),a=/^#?([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i.exec(r);return a?[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]:[]}function BC(e){return e.disableBeacon||e.placement==="center"}function VC(){return!["chrome","safari","firefox","opera"].includes(Zk())}function Ou({data:e,debug:t=!1,title:r,warn:a=!1}){const n=a?console.warn||console.error:console.log;t&&(r&&e?(console.groupCollapsed(`%creact-joyride: ${r}`,"color: #ff0044; font-weight: bold; font-size: 12px;"),Array.isArray(e)?e.forEach(i=>{hs.plainObject(i)&&i.key?n.apply(console,[i.key,i.value]):n.apply(console,[i])}):n.apply(console,[e]),console.groupEnd()):console.error("Missing title or data props"))}function SH(e){return Object.keys(e)}function Qk(e,...t){if(!hs.plainObject(e))throw new TypeError("Expected an object");const r={};for(const a in e)({}).hasOwnProperty.call(e,a)&&(t.includes(a)||(r[a]=e[a]));return r}function TH(e,...t){if(!hs.plainObject(e))throw new TypeError("Expected an object");if(!t.length)return e;const r={};for(const a in e)({}).hasOwnProperty.call(e,a)&&t.includes(a)&&(r[a]=e[a]);return r}function Yy(e,t,r){const a=i=>i.replace("{step}",String(t)).replace("{steps}",String(r));if(xx(e)==="string")return a(e);if(!E.isValidElement(e))return e;const{children:n}=e.props;if(xx(n)==="string"&&n.includes("{step}"))return E.cloneElement(e,{children:a(n)});if(Array.isArray(n))return E.cloneElement(e,{children:n.map(i=>typeof i=="string"?a(i):Yy(i,t,r))});if(xx(e.type)==="function"&&!Object.values(e.props).length){const i=e.type({});return Yy(i,t,r)}return e}function AH(e){const{isFirstStep:t,lifecycle:r,previousLifecycle:a,scrollToFirstStep:n,step:i,target:o}=e;return!i.disableScrolling&&(!t||n||r===er.TOOLTIP)&&i.placement!=="center"&&(!i.isFixed||!xf(o))&&a!==r&&[er.BEACON,er.TOOLTIP].includes(r)}var kH={options:{preventOverflow:{boundariesElement:"scrollParent"}},wrapperOptions:{offset:-18,position:!0}},Jk={back:"Back",close:"Close",last:"Last",next:"Next",nextLabelWithProgress:"Next (Step {step} of {steps})",open:"Open the dialog",skip:"Skip"},RH={event:"click",placement:"bottom",offset:10,disableBeacon:!1,disableCloseOnEsc:!1,disableOverlay:!1,disableOverlayClose:!1,disableScrollParentFix:!1,disableScrolling:!1,hideBackButton:!1,hideCloseButton:!1,hideFooter:!1,isFixed:!1,locale:Jk,showProgress:!1,showSkipButton:!1,spotlightClicks:!1,spotlightPadding:10},PH={continuous:!1,debug:!1,disableCloseOnEsc:!1,disableOverlay:!1,disableOverlayClose:!1,disableScrolling:!1,disableScrollParentFix:!1,getHelpers:void 0,hideBackButton:!1,run:!0,scrollOffset:20,scrollDuration:300,scrollToFirstStep:!1,showSkipButton:!1,showProgress:!1,spotlightClicks:!1,spotlightPadding:10,steps:[]},IH={arrowColor:"#fff",backgroundColor:"#fff",beaconSize:36,overlayColor:"rgba(0, 0, 0, 0.5)",primaryColor:"#f04",spotlightShadow:"0 0 15px rgba(0, 0, 0, 0.5)",textColor:"#333",width:380,zIndex:100},ym={backgroundColor:"transparent",border:0,borderRadius:0,color:"#555",cursor:"pointer",fontSize:16,lineHeight:1,padding:8,WebkitAppearance:"none"},UC={borderRadius:4,position:"absolute"};function OH(e,t){var r,a,n,i,o;const{floaterProps:c,styles:d}=e,h=Jo((r=t.floaterProps)!=null?r:{},c??{}),p=Jo(d??{},(a=t.styles)!=null?a:{}),x=Jo(IH,p.options||{}),v=t.placement==="center"||t.disableBeacon;let{width:b}=x;window.innerWidth>480&&(b=380),"width"in x&&(b=typeof x.width=="number"&&window.innerWidth<x.width?window.innerWidth-30:x.width);const N={bottom:0,left:0,overflow:"hidden",position:"absolute",right:0,top:0,zIndex:x.zIndex},_={beacon:{...ym,display:v?"none":"inline-block",height:x.beaconSize,position:"relative",width:x.beaconSize,zIndex:x.zIndex},beaconInner:{animation:"joyride-beacon-inner 1.2s infinite ease-in-out",backgroundColor:x.primaryColor,borderRadius:"50%",display:"block",height:"50%",left:"50%",opacity:.7,position:"absolute",top:"50%",transform:"translate(-50%, -50%)",width:"50%"},beaconOuter:{animation:"joyride-beacon-outer 1.2s infinite ease-in-out",backgroundColor:`rgba(${EH(x.primaryColor).join(",")}, 0.2)`,border:`2px solid ${x.primaryColor}`,borderRadius:"50%",boxSizing:"border-box",display:"block",height:"100%",left:0,opacity:.9,position:"absolute",top:0,transformOrigin:"center",width:"100%"},tooltip:{backgroundColor:x.backgroundColor,borderRadius:5,boxSizing:"border-box",color:x.textColor,fontSize:16,maxWidth:"100%",padding:15,position:"relative",width:b},tooltipContainer:{lineHeight:1.4,textAlign:"center"},tooltipTitle:{fontSize:18,margin:0},tooltipContent:{padding:"20px 10px"},tooltipFooter:{alignItems:"center",display:"flex",justifyContent:"flex-end",marginTop:15},tooltipFooterSpacer:{flex:1},buttonNext:{...ym,backgroundColor:x.primaryColor,borderRadius:4,color:"#fff"},buttonBack:{...ym,color:x.primaryColor,marginLeft:"auto",marginRight:5},buttonClose:{...ym,color:x.textColor,height:14,padding:15,position:"absolute",right:0,top:0,width:14},buttonSkip:{...ym,color:x.textColor,fontSize:14},overlay:{...N,backgroundColor:x.overlayColor,mixBlendMode:"hard-light"},overlayLegacy:{...N},overlayLegacyCenter:{...N,backgroundColor:x.overlayColor},spotlight:{...UC,backgroundColor:"gray"},spotlightLegacy:{...UC,boxShadow:`0 0 0 9999px ${x.overlayColor}, ${x.spotlightShadow}`},floaterStyles:{arrow:{color:(o=(i=(n=h==null?void 0:h.styles)==null?void 0:n.arrow)==null?void 0:i.color)!=null?o:x.arrowColor},options:{zIndex:x.zIndex+100}},options:x};return Jo(_,p)}function DH(e){return TH(e,"beaconComponent","disableCloseOnEsc","disableOverlay","disableOverlayClose","disableScrolling","disableScrollParentFix","floaterProps","hideBackButton","hideCloseButton","locale","showProgress","showSkipButton","spotlightClicks","spotlightPadding","styles","tooltipComponent")}function hh(e,t){var r,a,n,i,o,c;const d=t??{},h=Jo.all([RH,DH(e),d],{isMergeableObject:hs.plainObject}),p=OH(e,h),x=Ug(uc(h.target),h.disableScrollParentFix),v=Jo.all([kH,(r=e.floaterProps)!=null?r:{},(a=h.floaterProps)!=null?a:{}]);return v.offset=h.offset,v.styles=Jo((n=v.styles)!=null?n:{},p.floaterStyles),v.offset+=(o=(i=e.spotlightPadding)!=null?i:h.spotlightPadding)!=null?o:0,h.placementBeacon&&v.wrapperOptions&&(v.wrapperOptions.placement=h.placementBeacon),x&&v.options.preventOverflow&&(v.options.preventOverflow.boundariesElement="window"),{...h,locale:Jo.all([Jk,(c=e.locale)!=null?c:{},h.locale||{}]),floaterProps:v,styles:Qk(p,"floaterStyles")}}function eR(e,t=!1){return hs.plainObject(e)?e.target?!0:(Ou({title:"validateStep",data:"target is missing from the step",warn:!0,debug:t}),!1):(Ou({title:"validateStep",data:"step must be an object",warn:!0,debug:t}),!1)}function zC(e,t=!1){return hs.array(e)?e.every(r=>eR(r,t)):(Ou({title:"validateSteps",data:"steps must be an array",warn:!0,debug:t}),!1)}var tR={action:"init",controlled:!1,index:0,lifecycle:er.INIT,origin:null,size:0,status:xr.IDLE},$C=SH(Qk(tR,"controlled","size")),MH=class{constructor(e){ms(this,"beaconPopper"),ms(this,"tooltipPopper"),ms(this,"data",new Map),ms(this,"listener"),ms(this,"store",new Map),ms(this,"addListener",n=>{this.listener=n}),ms(this,"setSteps",n=>{const{size:i,status:o}=this.getState(),c={size:n.length,status:o};this.data.set("steps",n),o===xr.WAITING&&!i&&n.length&&(c.status=xr.RUNNING),this.setState(c)}),ms(this,"getPopper",n=>n==="beacon"?this.beaconPopper:this.tooltipPopper),ms(this,"setPopper",(n,i)=>{n==="beacon"?this.beaconPopper=i:this.tooltipPopper=i}),ms(this,"cleanupPoppers",()=>{this.beaconPopper=null,this.tooltipPopper=null}),ms(this,"close",(n=null)=>{const{index:i,status:o}=this.getState();o===xr.RUNNING&&this.setState({...this.getNextState({action:Fr.CLOSE,index:i+1,origin:n})})}),ms(this,"go",n=>{const{controlled:i,status:o}=this.getState();if(i||o!==xr.RUNNING)return;const c=this.getSteps()[n];this.setState({...this.getNextState({action:Fr.GO,index:n}),status:c?o:xr.FINISHED})}),ms(this,"info",()=>this.getState()),ms(this,"next",()=>{const{index:n,status:i}=this.getState();i===xr.RUNNING&&this.setState(this.getNextState({action:Fr.NEXT,index:n+1}))}),ms(this,"open",()=>{const{status:n}=this.getState();n===xr.RUNNING&&this.setState({...this.getNextState({action:Fr.UPDATE,lifecycle:er.TOOLTIP})})}),ms(this,"prev",()=>{const{index:n,status:i}=this.getState();i===xr.RUNNING&&this.setState({...this.getNextState({action:Fr.PREV,index:n-1})})}),ms(this,"reset",(n=!1)=>{const{controlled:i}=this.getState();i||this.setState({...this.getNextState({action:Fr.RESET,index:0}),status:n?xr.RUNNING:xr.READY})}),ms(this,"skip",()=>{const{status:n}=this.getState();n===xr.RUNNING&&this.setState({action:Fr.SKIP,lifecycle:er.INIT,status:xr.SKIPPED})}),ms(this,"start",n=>{const{index:i,size:o}=this.getState();this.setState({...this.getNextState({action:Fr.START,index:hs.number(n)?n:i},!0),status:o?xr.RUNNING:xr.WAITING})}),ms(this,"stop",(n=!1)=>{const{index:i,status:o}=this.getState();[xr.FINISHED,xr.SKIPPED].includes(o)||this.setState({...this.getNextState({action:Fr.STOP,index:i+(n?1:0)}),status:xr.PAUSED})}),ms(this,"update",n=>{var i,o;if(!CH(n,$C))throw new Error(`State is not valid. Valid keys: ${$C.join(", ")}`);this.setState({...this.getNextState({...this.getState(),...n,action:(i=n.action)!=null?i:Fr.UPDATE,origin:(o=n.origin)!=null?o:null},!0)})});const{continuous:t=!1,stepIndex:r,steps:a=[]}=e??{};this.setState({action:Fr.INIT,controlled:hs.number(r),continuous:t,index:hs.number(r)?r:0,lifecycle:er.INIT,origin:null,status:a.length?xr.READY:xr.IDLE},!0),this.beaconPopper=null,this.tooltipPopper=null,this.listener=null,this.setSteps(a)}getState(){return this.store.size?{action:this.store.get("action")||"",controlled:this.store.get("controlled")||!1,index:parseInt(this.store.get("index"),10),lifecycle:this.store.get("lifecycle")||"",origin:this.store.get("origin")||null,size:this.store.get("size")||0,status:this.store.get("status")||""}:{...tR}}getNextState(e,t=!1){var r,a,n,i,o;const{action:c,controlled:d,index:h,size:p,status:x}=this.getState(),v=hs.number(e.index)?e.index:h,b=d&&!t?h:Math.min(Math.max(v,0),p);return{action:(r=e.action)!=null?r:c,controlled:d,index:b,lifecycle:(a=e.lifecycle)!=null?a:er.INIT,origin:(n=e.origin)!=null?n:null,size:(i=e.size)!=null?i:p,status:b===p?xr.FINISHED:(o=e.status)!=null?o:x}}getSteps(){const e=this.data.get("steps");return Array.isArray(e)?e:[]}hasUpdatedState(e){const t=JSON.stringify(e),r=JSON.stringify(this.getState());return t!==r}setState(e,t=!1){const r=this.getState(),{action:a,index:n,lifecycle:i,origin:o=null,size:c,status:d}={...r,...e};this.store.set("action",a),this.store.set("index",n),this.store.set("lifecycle",i),this.store.set("origin",o),this.store.set("size",c),this.store.set("status",d),t&&(this.store.set("controlled",e.controlled),this.store.set("continuous",e.continuous)),this.listener&&this.hasUpdatedState(r)&&this.listener(this.getState())}getHelpers(){return{close:this.close,go:this.go,info:this.info,next:this.next,open:this.open,prev:this.prev,reset:this.reset,skip:this.skip}}};function LH(e){return new MH(e)}function FH({styles:e}){return E.createElement("div",{key:"JoyrideSpotlight",className:"react-joyride__spotlight","data-test-id":"spotlight",style:e})}var BH=FH,VH=class extends E.Component{constructor(){super(...arguments),ms(this,"isActive",!1),ms(this,"resizeTimeout"),ms(this,"scrollTimeout"),ms(this,"scrollParent"),ms(this,"state",{isScrolling:!1,mouseOverSpotlight:!1,showSpotlight:!0}),ms(this,"hideSpotlight",()=>{const{continuous:e,disableOverlay:t,lifecycle:r}=this.props,a=[er.INIT,er.BEACON,er.COMPLETE,er.ERROR];return t||(e?a.includes(r):r!==er.TOOLTIP)}),ms(this,"handleMouseMove",e=>{const{mouseOverSpotlight:t}=this.state,{height:r,left:a,position:n,top:i,width:o}=this.spotlightStyles,c=n==="fixed"?e.clientY:e.pageY,d=n==="fixed"?e.clientX:e.pageX,h=c>=i&&c<=i+r,x=d>=a&&d<=a+o&&h;x!==t&&this.updateState({mouseOverSpotlight:x})}),ms(this,"handleScroll",()=>{const{target:e}=this.props,t=uc(e);if(this.scrollParent!==document){const{isScrolling:r}=this.state;r||this.updateState({isScrolling:!0,showSpotlight:!1}),clearTimeout(this.scrollTimeout),this.scrollTimeout=window.setTimeout(()=>{this.updateState({isScrolling:!1,showSpotlight:!0})},50)}else xf(t,"sticky")&&this.updateState({})}),ms(this,"handleResize",()=>{clearTimeout(this.resizeTimeout),this.resizeTimeout=window.setTimeout(()=>{this.isActive&&this.forceUpdate()},100)})}componentDidMount(){const{debug:e,disableScrolling:t,disableScrollParentFix:r=!1,target:a}=this.props,n=uc(a);this.scrollParent=Ap(n??document.body,r,!0),this.isActive=!0,window.addEventListener("resize",this.handleResize)}componentDidUpdate(e){var t;const{disableScrollParentFix:r,lifecycle:a,spotlightClicks:n,target:i}=this.props,{changed:o}=Wx(e,this.props);if(o("target")||o("disableScrollParentFix")){const c=uc(i);this.scrollParent=Ap(c??document.body,r,!0)}o("lifecycle",er.TOOLTIP)&&((t=this.scrollParent)==null||t.addEventListener("scroll",this.handleScroll,{passive:!0}),setTimeout(()=>{const{isScrolling:c}=this.state;c||this.updateState({showSpotlight:!0})},100)),(o("spotlightClicks")||o("disableOverlay")||o("lifecycle"))&&(n&&a===er.TOOLTIP?window.addEventListener("mousemove",this.handleMouseMove,!1):a!==er.TOOLTIP&&window.removeEventListener("mousemove",this.handleMouseMove))}componentWillUnmount(){var e;this.isActive=!1,window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("resize",this.handleResize),clearTimeout(this.resizeTimeout),clearTimeout(this.scrollTimeout),(e=this.scrollParent)==null||e.removeEventListener("scroll",this.handleScroll)}get overlayStyles(){const{mouseOverSpotlight:e}=this.state,{disableOverlayClose:t,placement:r,styles:a}=this.props;let n=a.overlay;return VC()&&(n=r==="center"?a.overlayLegacyCenter:a.overlayLegacy),{cursor:t?"default":"pointer",height:vH(),pointerEvents:e?"none":"auto",...n}}get spotlightStyles(){var e,t,r;const{showSpotlight:a}=this.state,{disableScrollParentFix:n=!1,spotlightClicks:i,spotlightPadding:o=0,styles:c,target:d}=this.props,h=uc(d),p=Yk(h),x=xf(h),v=_H(h,o,n);return{...VC()?c.spotlightLegacy:c.spotlight,height:Math.round(((e=p==null?void 0:p.height)!=null?e:0)+o*2),left:Math.round(((t=p==null?void 0:p.left)!=null?t:0)-o),opacity:a?1:0,pointerEvents:i?"none":"auto",position:x?"fixed":"absolute",top:v,transition:"opacity 0.2s",width:Math.round(((r=p==null?void 0:p.width)!=null?r:0)+o*2)}}updateState(e){this.isActive&&this.setState(t=>({...t,...e}))}render(){const{showSpotlight:e}=this.state,{onClickOverlay:t,placement:r}=this.props,{hideSpotlight:a,overlayStyles:n,spotlightStyles:i}=this;if(a())return null;let o=r!=="center"&&e&&E.createElement(BH,{styles:i});if(Zk()==="safari"){const{mixBlendMode:c,zIndex:d,...h}=n;o=E.createElement("div",{style:{...h}},o),delete n.backgroundColor}return E.createElement("div",{className:"react-joyride__overlay","data-test-id":"overlay",onClick:t,role:"presentation",style:n},o)}},UH=class extends E.Component{constructor(){super(...arguments),ms(this,"node",null)}componentDidMount(){const{id:e}=this.props;nd()&&(this.node=document.createElement("div"),this.node.id=e,document.body.appendChild(this.node),vm||this.renderReact15())}componentDidUpdate(){nd()&&(vm||this.renderReact15())}componentWillUnmount(){!nd()||!this.node||(vm||_u.unmountComponentAtNode(this.node),this.node.parentNode===document.body&&(document.body.removeChild(this.node),this.node=null))}renderReact15(){if(!nd())return;const{children:e}=this.props;this.node&&_u.unstable_renderSubtreeIntoContainer(this,e,this.node)}renderReact16(){if(!nd()||!vm)return null;const{children:e}=this.props;return this.node?_u.createPortal(e,this.node):null}render(){return vm?this.renderReact16():null}},zH=class{constructor(e,t){if(ms(this,"element"),ms(this,"options"),ms(this,"canBeTabbed",r=>{const{tabIndex:a}=r;return a===null||a<0?!1:this.canHaveFocus(r)}),ms(this,"canHaveFocus",r=>{const a=/input|select|textarea|button|object/,n=r.nodeName.toLowerCase();return(a.test(n)&&!r.getAttribute("disabled")||n==="a"&&!!r.getAttribute("href"))&&this.isVisible(r)}),ms(this,"findValidTabElements",()=>[].slice.call(this.element.querySelectorAll("*"),0).filter(this.canBeTabbed)),ms(this,"handleKeyDown",r=>{const{code:a="Tab"}=this.options;r.code===a&&this.interceptTab(r)}),ms(this,"interceptTab",r=>{r.preventDefault();const a=this.findValidTabElements(),{shiftKey:n}=r;if(!a.length)return;let i=document.activeElement?a.indexOf(document.activeElement):0;i===-1||!n&&i+1===a.length?i=0:n&&i===0?i=a.length-1:i+=n?-1:1,a[i].focus()}),ms(this,"isHidden",r=>{const a=r.offsetWidth<=0&&r.offsetHeight<=0,n=window.getComputedStyle(r);return a&&!r.innerHTML?!0:a&&n.getPropertyValue("overflow")!=="visible"||n.getPropertyValue("display")==="none"}),ms(this,"isVisible",r=>{let a=r;for(;a;)if(a instanceof HTMLElement){if(a===document.body)break;if(this.isHidden(a))return!1;a=a.parentNode}return!0}),ms(this,"removeScope",()=>{window.removeEventListener("keydown",this.handleKeyDown)}),ms(this,"checkFocus",r=>{document.activeElement!==r&&(r.focus(),window.requestAnimationFrame(()=>this.checkFocus(r)))}),ms(this,"setFocus",()=>{const{selector:r}=this.options;if(!r)return;const a=this.element.querySelector(r);a&&window.requestAnimationFrame(()=>this.checkFocus(a))}),!(e instanceof HTMLElement))throw new TypeError("Invalid parameter: element must be an HTMLElement");this.element=e,this.options=t,window.addEventListener("keydown",this.handleKeyDown,!1),this.setFocus()}},$H=class extends E.Component{constructor(e){if(super(e),ms(this,"beacon",null),ms(this,"setBeaconRef",n=>{this.beacon=n}),e.beaconComponent)return;const t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.id="joyride-beacon-animation",e.nonce&&r.setAttribute("nonce",e.nonce),r.appendChild(document.createTextNode(`
        @keyframes joyride-beacon-inner {
          20% {
            opacity: 0.9;
          }
        
          90% {
            opacity: 0.7;
          }
        }
        
        @keyframes joyride-beacon-outer {
          0% {
            transform: scale(1);
          }
        
          45% {
            opacity: 0.7;
            transform: scale(0.75);
          }
        
          100% {
            opacity: 0.9;
            transform: scale(1);
          }
        }
      `)),t.appendChild(r)}componentDidMount(){const{shouldFocus:e}=this.props;setTimeout(()=>{hs.domElement(this.beacon)&&e&&this.beacon.focus()},0)}componentWillUnmount(){const e=document.getElementById("joyride-beacon-animation");e!=null&&e.parentNode&&e.parentNode.removeChild(e)}render(){const{beaconComponent:e,continuous:t,index:r,isLastStep:a,locale:n,onClickOrHover:i,size:o,step:c,styles:d}=this.props,h=wl(n.open),p={"aria-label":h,onClick:i,onMouseEnter:i,ref:this.setBeaconRef,title:h};let x;if(e){const v=e;x=E.createElement(v,{continuous:t,index:r,isLastStep:a,size:o,step:c,...p})}else x=E.createElement("button",{key:"JoyrideBeacon",className:"react-joyride__beacon","data-test-id":"button-beacon",style:d.beacon,type:"button",...p},E.createElement("span",{style:d.beaconInner}),E.createElement("span",{style:d.beaconOuter}));return x}};function qH({styles:e,...t}){const{color:r,height:a,width:n,...i}=e;return He.createElement("button",{style:i,type:"button",...t},He.createElement("svg",{height:typeof a=="number"?`${a}px`:a,preserveAspectRatio:"xMidYMid",version:"1.1",viewBox:"0 0 18 18",width:typeof n=="number"?`${n}px`:n,xmlns:"http://www.w3.org/2000/svg"},He.createElement("g",null,He.createElement("path",{d:"M8.13911129,9.00268191 L0.171521827,17.0258467 C-0.0498027049,17.248715 -0.0498027049,17.6098394 0.171521827,17.8327545 C0.28204354,17.9443526 0.427188206,17.9998706 0.572051765,17.9998706 C0.71714958,17.9998706 0.862013139,17.9443526 0.972581703,17.8327545 L9.0000937,9.74924618 L17.0276057,17.8327545 C17.1384085,17.9443526 17.2832721,17.9998706 17.4281356,17.9998706 C17.5729992,17.9998706 17.718097,17.9443526 17.8286656,17.8327545 C18.0499901,17.6098862 18.0499901,17.2487618 17.8286656,17.0258467 L9.86135722,9.00268191 L17.8340066,0.973848225 C18.0553311,0.750979934 18.0553311,0.389855532 17.8340066,0.16694039 C17.6126821,-0.0556467968 17.254037,-0.0556467968 17.0329467,0.16694039 L9.00042166,8.25611765 L0.967006424,0.167268345 C0.745681892,-0.0553188426 0.387317931,-0.0553188426 0.165993399,0.167268345 C-0.0553311331,0.390136635 -0.0553311331,0.751261038 0.165993399,0.974176179 L8.13920499,9.00268191 L8.13911129,9.00268191 Z",fill:r}))))}var WH=qH;function HH(e){const{backProps:t,closeProps:r,index:a,isLastStep:n,primaryProps:i,skipProps:o,step:c,tooltipProps:d}=e,{content:h,hideBackButton:p,hideCloseButton:x,hideFooter:v,showSkipButton:b,styles:N,title:_}=c,C={};return C.primary=E.createElement("button",{"data-test-id":"button-primary",style:N.buttonNext,type:"button",...i}),b&&!n&&(C.skip=E.createElement("button",{"aria-live":"off","data-test-id":"button-skip",style:N.buttonSkip,type:"button",...o})),!p&&a>0&&(C.back=E.createElement("button",{"data-test-id":"button-back",style:N.buttonBack,type:"button",...t})),C.close=!x&&E.createElement(WH,{"data-test-id":"button-close",styles:N.buttonClose,...r}),E.createElement("div",{key:"JoyrideTooltip","aria-label":wl(_??h),className:"react-joyride__tooltip",style:N.tooltip,...d},E.createElement("div",{style:N.tooltipContainer},_&&E.createElement("h1",{"aria-label":wl(_),style:N.tooltipTitle},_),E.createElement("div",{style:N.tooltipContent},h)),!v&&E.createElement("div",{style:N.tooltipFooter},E.createElement("div",{style:N.tooltipFooterSpacer},C.skip),C.back,C.primary),C.close)}var GH=HH,KH=class extends E.Component{constructor(){super(...arguments),ms(this,"handleClickBack",e=>{e.preventDefault();const{helpers:t}=this.props;t.prev()}),ms(this,"handleClickClose",e=>{e.preventDefault();const{helpers:t}=this.props;t.close("button_close")}),ms(this,"handleClickPrimary",e=>{e.preventDefault();const{continuous:t,helpers:r}=this.props;if(!t){r.close("button_primary");return}r.next()}),ms(this,"handleClickSkip",e=>{e.preventDefault();const{helpers:t}=this.props;t.skip()}),ms(this,"getElementsProps",()=>{const{continuous:e,index:t,isLastStep:r,setTooltipRef:a,size:n,step:i}=this.props,{back:o,close:c,last:d,next:h,nextLabelWithProgress:p,skip:x}=i.locale,v=wl(o),b=wl(c),N=wl(d),_=wl(h),C=wl(x);let T=c,A=b;if(e){if(T=h,A=_,i.showProgress&&!r){const k=wl(p,{step:t+1,steps:n});T=Yy(p,t+1,n),A=k}r&&(T=d,A=N)}return{backProps:{"aria-label":v,children:o,"data-action":"back",onClick:this.handleClickBack,role:"button",title:v},closeProps:{"aria-label":b,children:c,"data-action":"close",onClick:this.handleClickClose,role:"button",title:b},primaryProps:{"aria-label":A,children:T,"data-action":"primary",onClick:this.handleClickPrimary,role:"button",title:A},skipProps:{"aria-label":C,children:x,"data-action":"skip",onClick:this.handleClickSkip,role:"button",title:C},tooltipProps:{"aria-modal":!0,ref:a,role:"alertdialog"}}})}render(){const{continuous:e,index:t,isLastStep:r,setTooltipRef:a,size:n,step:i}=this.props,{beaconComponent:o,tooltipComponent:c,...d}=i;let h;if(c){const p={...this.getElementsProps(),continuous:e,index:t,isLastStep:r,size:n,step:d,setTooltipRef:a},x=c;h=E.createElement(x,{...p})}else h=E.createElement(GH,{...this.getElementsProps(),continuous:e,index:t,isLastStep:r,size:n,step:i});return h}},XH=class extends E.Component{constructor(){super(...arguments),ms(this,"scope",null),ms(this,"tooltip",null),ms(this,"handleClickHoverBeacon",e=>{const{step:t,store:r}=this.props;e.type==="mouseenter"&&t.event!=="hover"||r.update({lifecycle:er.TOOLTIP})}),ms(this,"setTooltipRef",e=>{this.tooltip=e}),ms(this,"setPopper",(e,t)=>{var r;const{action:a,lifecycle:n,step:i,store:o}=this.props;t==="wrapper"?o.setPopper("beacon",e):o.setPopper("tooltip",e),o.getPopper("beacon")&&(o.getPopper("tooltip")||i.placement==="center")&&n===er.INIT&&o.update({action:a,lifecycle:er.READY}),(r=i.floaterProps)!=null&&r.getPopper&&i.floaterProps.getPopper(e,t)}),ms(this,"renderTooltip",e=>{const{continuous:t,helpers:r,index:a,size:n,step:i}=this.props;return E.createElement(KH,{continuous:t,helpers:r,index:a,isLastStep:a+1===n,setTooltipRef:this.setTooltipRef,size:n,step:i,...e})})}componentDidMount(){const{debug:e,index:t}=this.props;Ou({title:`step:${t}`,data:[{key:"props",value:this.props}],debug:e})}componentDidUpdate(e){var t;const{action:r,callback:a,continuous:n,controlled:i,debug:o,helpers:c,index:d,lifecycle:h,shouldScroll:p,status:x,step:v,store:b}=this.props,{changed:N,changedFrom:_}=Wx(e,this.props),C=c.info(),T=n&&r!==Fr.CLOSE&&(d>0||r===Fr.PREV),A=N("action")||N("index")||N("lifecycle")||N("status"),k=_("lifecycle",[er.TOOLTIP,er.INIT],er.INIT),I=N("action",[Fr.NEXT,Fr.PREV,Fr.SKIP,Fr.CLOSE]),B=i&&d===e.index;if(I&&(k||B)&&a({...C,index:e.index,lifecycle:er.COMPLETE,step:e.step,type:Ko.STEP_AFTER}),v.placement==="center"&&x===xr.RUNNING&&N("index")&&r!==Fr.START&&h===er.INIT&&b.update({lifecycle:er.READY}),A){const O=uc(v.target),D=!!O;D&&bH(O)?(_("status",xr.READY,xr.RUNNING)||_("lifecycle",er.INIT,er.READY))&&a({...C,step:v,type:Ko.STEP_BEFORE}):(console.warn(D?"Target not visible":"Target not mounted",v),a({...C,type:Ko.TARGET_NOT_FOUND,step:v}),i||b.update({index:d+(r===Fr.PREV?-1:1)}))}_("lifecycle",er.INIT,er.READY)&&b.update({lifecycle:BC(v)||T?er.TOOLTIP:er.BEACON}),N("index")&&Ou({title:`step:${h}`,data:[{key:"props",value:this.props}],debug:o}),N("lifecycle",er.BEACON)&&a({...C,step:v,type:Ko.BEACON}),N("lifecycle",er.TOOLTIP)&&(a({...C,step:v,type:Ko.TOOLTIP}),p&&this.tooltip&&(this.scope=new zH(this.tooltip,{selector:"[data-action=primary]"}),this.scope.setFocus())),_("lifecycle",[er.TOOLTIP,er.INIT],er.INIT)&&((t=this.scope)==null||t.removeScope(),b.cleanupPoppers())}componentWillUnmount(){var e;(e=this.scope)==null||e.removeScope()}get open(){const{lifecycle:e,step:t}=this.props;return BC(t)||e===er.TOOLTIP}render(){const{continuous:e,debug:t,index:r,nonce:a,shouldScroll:n,size:i,step:o}=this.props,c=uc(o.target);return!eR(o)||!hs.domElement(c)?null:E.createElement("div",{key:`JoyrideStep-${r}`,className:"react-joyride__step"},E.createElement(Jb,{...o.floaterProps,component:this.renderTooltip,debug:t,getPopper:this.setPopper,id:`react-joyride-step-${r}`,open:this.open,placement:o.placement,target:o.target},E.createElement($H,{beaconComponent:o.beaconComponent,continuous:e,index:r,isLastStep:r+1===i,locale:o.locale,nonce:a,onClickOrHover:this.handleClickHoverBeacon,shouldFocus:n,size:i,step:o,styles:o.styles})))}},sR=class extends E.Component{constructor(e){super(e),ms(this,"helpers"),ms(this,"store"),ms(this,"callback",o=>{const{callback:c}=this.props;hs.function(c)&&c(o)}),ms(this,"handleKeyboard",o=>{const{index:c,lifecycle:d}=this.state,{steps:h}=this.props,p=h[c];d===er.TOOLTIP&&o.code==="Escape"&&p&&!p.disableCloseOnEsc&&this.store.close("keyboard")}),ms(this,"handleClickOverlay",()=>{const{index:o}=this.state,{steps:c}=this.props;hh(this.props,c[o]).disableOverlayClose||this.helpers.close("overlay")}),ms(this,"syncState",o=>{this.setState(o)});const{debug:t,getHelpers:r,run:a=!0,stepIndex:n}=e;this.store=LH({...e,controlled:a&&hs.number(n)}),this.helpers=this.store.getHelpers();const{addListener:i}=this.store;Ou({title:"init",data:[{key:"props",value:this.props},{key:"state",value:this.state}],debug:t}),i(this.syncState),r&&r(this.helpers),this.state=this.store.getState()}componentDidMount(){if(!nd())return;const{debug:e,disableCloseOnEsc:t,run:r,steps:a}=this.props,{start:n}=this.store;zC(a,e)&&r&&n(),t||document.body.addEventListener("keydown",this.handleKeyboard,{passive:!0})}componentDidUpdate(e,t){if(!nd())return;const{action:r,controlled:a,index:n,status:i}=this.state,{debug:o,run:c,stepIndex:d,steps:h}=this.props,{stepIndex:p,steps:x}=e,{reset:v,setSteps:b,start:N,stop:_,update:C}=this.store,{changed:T}=Wx(e,this.props),{changed:A,changedFrom:k}=Wx(t,this.state),I=hh(this.props,h[n]),B=!gi(x,h),O=hs.number(d)&&T("stepIndex"),D=uc(I.target);if(B&&(zC(h,o)?b(h):console.warn("Steps are not valid",h)),T("run")&&(c?N(d):_()),O){let z=hs.number(p)&&p<d?Fr.NEXT:Fr.PREV;r===Fr.STOP&&(z=Fr.START),[xr.FINISHED,xr.SKIPPED].includes(i)||C({action:r===Fr.CLOSE?Fr.CLOSE:z,index:d,lifecycle:er.INIT})}!a&&i===xr.RUNNING&&n===0&&!D&&(this.store.update({index:n+1}),this.callback({...this.state,type:Ko.TARGET_NOT_FOUND,step:I}));const F={...this.state,index:n,step:I};if(A("action",[Fr.NEXT,Fr.PREV,Fr.SKIP,Fr.CLOSE])&&A("status",xr.PAUSED)){const z=hh(this.props,h[t.index]);this.callback({...F,index:t.index,lifecycle:er.COMPLETE,step:z,type:Ko.STEP_AFTER})}if(A("status",[xr.FINISHED,xr.SKIPPED])){const z=hh(this.props,h[t.index]);a||this.callback({...F,index:t.index,lifecycle:er.COMPLETE,step:z,type:Ko.STEP_AFTER}),this.callback({...F,type:Ko.TOUR_END,step:z,index:t.index}),v()}else k("status",[xr.IDLE,xr.READY],xr.RUNNING)?this.callback({...F,type:Ko.TOUR_START}):(A("status")||A("action",Fr.RESET))&&this.callback({...F,type:Ko.TOUR_STATUS});this.scrollToStep(t)}componentWillUnmount(){const{disableCloseOnEsc:e}=this.props;e||document.body.removeEventListener("keydown",this.handleKeyboard)}scrollToStep(e){const{index:t,lifecycle:r,status:a}=this.state,{debug:n,disableScrollParentFix:i=!1,scrollDuration:o,scrollOffset:c=20,scrollToFirstStep:d=!1,steps:h}=this.props,p=hh(this.props,h[t]),x=uc(p.target),v=AH({isFirstStep:t===0,lifecycle:r,previousLifecycle:e.lifecycle,scrollToFirstStep:d,step:p,target:x});if(a===xr.RUNNING&&v){const b=Ug(x,i),N=Ap(x,i);let _=Math.floor(jH(x,c,i))||0;Ou({title:"scrollToStep",data:[{key:"index",value:t},{key:"lifecycle",value:r},{key:"status",value:a}],debug:n});const C=this.store.getPopper("beacon"),T=this.store.getPopper("tooltip");if(r===er.BEACON&&C){const{offsets:A,placement:k}=C;!["bottom"].includes(k)&&!b&&(_=Math.floor(A.popper.top-c))}else if(r===er.TOOLTIP&&T){const{flipped:A,offsets:k,placement:I}=T;["top","right","left"].includes(I)&&!A&&!b?_=Math.floor(k.popper.top-c):_-=p.spotlightPadding}_=_>=0?_:0,a===xr.RUNNING&&NH(_,{element:N,duration:o}).then(()=>{setTimeout(()=>{var A;(A=this.store.getPopper("tooltip"))==null||A.instance.update()},10)})}}render(){if(!nd())return null;const{index:e,lifecycle:t,status:r}=this.state,{continuous:a=!1,debug:n=!1,nonce:i,scrollToFirstStep:o=!1,steps:c}=this.props,d=r===xr.RUNNING,h={};if(d&&c[e]){const p=hh(this.props,c[e]);h.step=E.createElement(XH,{...this.state,callback:this.callback,continuous:a,debug:n,helpers:this.helpers,nonce:i,shouldScroll:!p.disableScrolling&&(e!==0||o),step:p,store:this.store}),h.overlay=E.createElement(UH,{id:"react-joyride-portal"},E.createElement(VH,{...p,continuous:a,debug:n,lifecycle:t,onClickOverlay:this.handleClickOverlay}))}return E.createElement("div",{className:"react-joyride"},h.step,h.overlay)}};ms(sR,"defaultProps",PH);var YH=sR;const e_=({steps:e,run:t,onComplete:r,onSkip:a})=>{const n=i=>{const{status:o}=i;(o===xr.FINISHED||o===xr.SKIPPED)&&(o===xr.FINISHED?r():a())};return s.jsx(YH,{steps:e,run:t,continuous:!0,showProgress:!0,showSkipButton:!0,scrollToFirstStep:!0,disableScrolling:!1,callback:n,styles:{options:{primaryColor:"hsl(var(--primary))",textColor:"hsl(var(--foreground))",backgroundColor:"hsl(var(--background))",overlayColor:"rgba(0, 0, 0, 0.5)",arrowColor:"hsl(var(--background))",zIndex:1e4},tooltip:{borderRadius:"12px",padding:"20px"},tooltipContent:{padding:"10px 0"},buttonNext:{backgroundColor:"hsl(var(--primary))",borderRadius:"8px",padding:"8px 16px",fontSize:"14px"},buttonBack:{color:"hsl(var(--muted-foreground))",marginRight:"10px"},buttonSkip:{color:"hsl(var(--muted-foreground))"}},locale:{back:"Voltar",close:"Fechar",last:"Finalizar",next:"Prximo",skip:"Pular Tour"}})},ar=Wp,kp=bg,ZH=qp,rR=E.forwardRef(({className:e,...t},r)=>s.jsx(zu,{ref:r,className:pt("fixed inset-0 z-50 bg-foreground/60 backdrop-blur-sm","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));rR.displayName=zu.displayName;const tr=E.forwardRef(({className:e,children:t,...r},a)=>s.jsxs(ZH,{children:[s.jsx(rR,{}),s.jsxs($u,{ref:a,className:pt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%]","gap-4 border border-border/60 bg-card p-6 shadow-lg","rounded-2xl","duration-200","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0","data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95","data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%]","data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%]",e),...r,children:[t,s.jsxs($p,{className:pt("absolute right-4 top-4 rounded-lg p-1.5","opacity-70 transition-all duration-200","hover:opacity-100 hover:bg-muted","focus:outline-none focus:ring-2 focus:ring-primary/30","disabled:pointer-events-none"),children:[s.jsx(Jr,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Fechar"})]})]})]}));tr.displayName=$u.displayName;const nr=({className:e,...t})=>s.jsx("div",{className:pt("flex flex-col space-y-2 text-center sm:text-left",e),...t});nr.displayName="DialogHeader";const Ya=({className:e,...t})=>s.jsx("div",{className:pt("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t});Ya.displayName="DialogFooter";const ir=E.forwardRef(({className:e,...t},r)=>s.jsx(kf,{ref:r,className:pt("font-display text-xl font-semibold leading-none tracking-tight text-foreground",e),...t}));ir.displayName=kf.displayName;const Vr=E.forwardRef(({className:e,...t},r)=>s.jsx(Rf,{ref:r,className:pt("font-body text-sm text-muted-foreground",e),...t}));Vr.displayName=Rf.displayName;function Rs(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function wi(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function di(e,t){const r=Rs(e);return isNaN(t)?wi(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function So(e,t){const r=Rs(e);if(isNaN(t))return wi(e,NaN);if(!t)return r;const a=r.getDate(),n=wi(e,r.getTime());n.setMonth(r.getMonth()+t+1,0);const i=n.getDate();return a>=i?n:(r.setFullYear(n.getFullYear(),n.getMonth(),a),r)}function QH(e,t){const r=+Rs(e);return wi(e,r+t)}const t_=6048e5,JH=864e5,aR=36e5,z0=43200,qC=1440;function eG(e,t){return QH(e,t*aR)}let tG={};function qf(){return tG}function $l(e,t){var c,d,h,p;const r=qf(),a=(t==null?void 0:t.weekStartsOn)??((d=(c=t==null?void 0:t.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??r.weekStartsOn??((p=(h=r.locale)==null?void 0:h.options)==null?void 0:p.weekStartsOn)??0,n=Rs(e),i=n.getDay(),o=(i<a?7:0)+i-a;return n.setDate(n.getDate()-o),n.setHours(0,0,0,0),n}function Du(e){return $l(e,{weekStartsOn:1})}function nR(e){const t=Rs(e),r=t.getFullYear(),a=wi(e,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const n=Du(a),i=wi(e,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const o=Du(i);return t.getTime()>=n.getTime()?r+1:t.getTime()>=o.getTime()?r:r-1}function Mu(e){const t=Rs(e);return t.setHours(0,0,0,0),t}function gf(e){const t=Rs(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function kl(e,t){const r=Mu(e),a=Mu(t),n=+r-gf(r),i=+a-gf(a);return Math.round((n-i)/JH)}function sG(e){const t=nR(e),r=wi(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),Du(r)}function Zy(e,t){const r=t*7;return di(e,r)}function rG(e,t){return So(e,t*12)}function aG(e){let t;return e.forEach(function(r){const a=Rs(r);(t===void 0||t<a||isNaN(Number(a)))&&(t=a)}),t||new Date(NaN)}function nG(e){let t;return e.forEach(r=>{const a=Rs(r);(!t||t>a||isNaN(+a))&&(t=a)}),t||new Date(NaN)}function gx(e,t){const r=Rs(e),a=Rs(t),n=r.getTime()-a.getTime();return n<0?-1:n>0?1:n}function s_(e){return wi(e,Date.now())}function Zn(e,t){const r=Mu(e),a=Mu(t);return+r==+a}function r_(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function iG(e){if(!r_(e)&&typeof e!="number")return!1;const t=Rs(e);return!isNaN(Number(t))}function vf(e,t){const r=Rs(e),a=Rs(t),n=r.getFullYear()-a.getFullYear(),i=r.getMonth()-a.getMonth();return n*12+i}function oG(e,t,r){const a=$l(e,r),n=$l(t,r),i=+a-gf(a),o=+n-gf(n);return Math.round((i-o)/t_)}function iR(e){return t=>{const a=(e?Math[e]:Math.trunc)(t);return a===0?0:a}}function oR(e,t){return+Rs(e)-+Rs(t)}function a_(e,t,r){const a=oR(e,t)/aR;return iR(r==null?void 0:r.roundingMethod)(a)}function Qy(e){const t=Rs(e);return t.setHours(23,59,59,999),t}function Lu(e){const t=Rs(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function lG(e){const t=Rs(e);return+Qy(t)==+Lu(t)}function cG(e,t){const r=Rs(e),a=Rs(t),n=gx(r,a),i=Math.abs(vf(r,a));let o;if(i<1)o=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-n*i);let c=gx(r,a)===-n;lG(Rs(e))&&i===1&&gx(e,a)===1&&(c=!1),o=n*(i-Number(c))}return o===0?0:o}function dG(e,t,r){const a=oR(e,t)/1e3;return iR(r==null?void 0:r.roundingMethod)(a)}function In(e){const t=Rs(e);return t.setDate(1),t.setHours(0,0,0,0),t}function lR(e){const t=Rs(e),r=wi(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function n_(e,t){var c,d,h,p;const r=qf(),a=(t==null?void 0:t.weekStartsOn)??((d=(c=t==null?void 0:t.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??r.weekStartsOn??((p=(h=r.locale)==null?void 0:h.options)==null?void 0:p.weekStartsOn)??0,n=Rs(e),i=n.getDay(),o=(i<a?-7:0)+6-(i-a);return n.setDate(n.getDate()+o),n.setHours(23,59,59,999),n}function cR(e){return n_(e,{weekStartsOn:1})}const uG={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},hG=(e,t,r)=>{let a;const n=uG[e];return typeof n=="string"?a=n:t===1?a=n.one:a=n.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+a:a+" ago":a};function Fh(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const fG={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},mG={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},pG={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},xG={date:Fh({formats:fG,defaultWidth:"full"}),time:Fh({formats:mG,defaultWidth:"full"}),dateTime:Fh({formats:pG,defaultWidth:"full"})},gG={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},vG=(e,t,r,a)=>gG[e];function Nl(e){return(t,r)=>{const a=r!=null&&r.context?String(r.context):"standalone";let n;if(a==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,c=r!=null&&r.width?String(r.width):o;n=e.formattingValues[c]||e.formattingValues[o]}else{const o=e.defaultWidth,c=r!=null&&r.width?String(r.width):e.defaultWidth;n=e.values[c]||e.values[o]}const i=e.argumentCallback?e.argumentCallback(t):t;return n[i]}}const yG={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},wG={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},bG={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},_G={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},jG={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},NG={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},CG=(e,t)=>{const r=Number(e),a=r%100;if(a>20||a<10)switch(a%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},EG={ordinalNumber:CG,era:Nl({values:yG,defaultWidth:"wide"}),quarter:Nl({values:wG,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Nl({values:bG,defaultWidth:"wide"}),day:Nl({values:_G,defaultWidth:"wide"}),dayPeriod:Nl({values:jG,defaultWidth:"wide",formattingValues:NG,defaultFormattingWidth:"wide"})};function Cl(e){return(t,r={})=>{const a=r.width,n=a&&e.matchPatterns[a]||e.matchPatterns[e.defaultMatchWidth],i=t.match(n);if(!i)return null;const o=i[0],c=a&&e.parsePatterns[a]||e.parsePatterns[e.defaultParseWidth],d=Array.isArray(c)?TG(c,x=>x.test(o)):SG(c,x=>x.test(o));let h;h=e.valueCallback?e.valueCallback(d):d,h=r.valueCallback?r.valueCallback(h):h;const p=t.slice(o.length);return{value:h,rest:p}}}function SG(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function TG(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function dR(e){return(t,r={})=>{const a=t.match(e.matchPattern);if(!a)return null;const n=a[0],i=t.match(e.parsePattern);if(!i)return null;let o=e.valueCallback?e.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const c=t.slice(n.length);return{value:o,rest:c}}}const AG=/^(\d+)(th|st|nd|rd)?/i,kG=/\d+/i,RG={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},PG={any:[/^b/i,/^(a|c)/i]},IG={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},OG={any:[/1/i,/2/i,/3/i,/4/i]},DG={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},MG={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},LG={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},FG={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},BG={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},VG={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},UG={ordinalNumber:dR({matchPattern:AG,parsePattern:kG,valueCallback:e=>parseInt(e,10)}),era:Cl({matchPatterns:RG,defaultMatchWidth:"wide",parsePatterns:PG,defaultParseWidth:"any"}),quarter:Cl({matchPatterns:IG,defaultMatchWidth:"wide",parsePatterns:OG,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Cl({matchPatterns:DG,defaultMatchWidth:"wide",parsePatterns:MG,defaultParseWidth:"any"}),day:Cl({matchPatterns:LG,defaultMatchWidth:"wide",parsePatterns:FG,defaultParseWidth:"any"}),dayPeriod:Cl({matchPatterns:BG,defaultMatchWidth:"any",parsePatterns:VG,defaultParseWidth:"any"})},i_={code:"en-US",formatDistance:hG,formatLong:xG,formatRelative:vG,localize:EG,match:UG,options:{weekStartsOn:0,firstWeekContainsDate:1}};function zG(e){const t=Rs(e);return kl(t,lR(t))+1}function uR(e){const t=Rs(e),r=+Du(t)-+sG(t);return Math.round(r/t_)+1}function hR(e,t){var p,x,v,b;const r=Rs(e),a=r.getFullYear(),n=qf(),i=(t==null?void 0:t.firstWeekContainsDate)??((x=(p=t==null?void 0:t.locale)==null?void 0:p.options)==null?void 0:x.firstWeekContainsDate)??n.firstWeekContainsDate??((b=(v=n.locale)==null?void 0:v.options)==null?void 0:b.firstWeekContainsDate)??1,o=wi(e,0);o.setFullYear(a+1,0,i),o.setHours(0,0,0,0);const c=$l(o,t),d=wi(e,0);d.setFullYear(a,0,i),d.setHours(0,0,0,0);const h=$l(d,t);return r.getTime()>=c.getTime()?a+1:r.getTime()>=h.getTime()?a:a-1}function $G(e,t){var c,d,h,p;const r=qf(),a=(t==null?void 0:t.firstWeekContainsDate)??((d=(c=t==null?void 0:t.locale)==null?void 0:c.options)==null?void 0:d.firstWeekContainsDate)??r.firstWeekContainsDate??((p=(h=r.locale)==null?void 0:h.options)==null?void 0:p.firstWeekContainsDate)??1,n=hR(e,t),i=wi(e,0);return i.setFullYear(n,0,a),i.setHours(0,0,0,0),$l(i,t)}function fR(e,t){const r=Rs(e),a=+$l(r,t)-+$G(r,t);return Math.round(a/t_)+1}function Hr(e,t){const r=e<0?"-":"",a=Math.abs(e).toString().padStart(t,"0");return r+a}const Bc={y(e,t){const r=e.getFullYear(),a=r>0?r:1-r;return Hr(t==="yy"?a%100:a,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Hr(r+1,2)},d(e,t){return Hr(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Hr(e.getHours()%12||12,t.length)},H(e,t){return Hr(e.getHours(),t.length)},m(e,t){return Hr(e.getMinutes(),t.length)},s(e,t){return Hr(e.getSeconds(),t.length)},S(e,t){const r=t.length,a=e.getMilliseconds(),n=Math.trunc(a*Math.pow(10,r-3));return Hr(n,t.length)}},fh={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},WC={G:function(e,t,r){const a=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(a,{width:"abbreviated"});case"GGGGG":return r.era(a,{width:"narrow"});case"GGGG":default:return r.era(a,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const a=e.getFullYear(),n=a>0?a:1-a;return r.ordinalNumber(n,{unit:"year"})}return Bc.y(e,t)},Y:function(e,t,r,a){const n=hR(e,a),i=n>0?n:1-n;if(t==="YY"){const o=i%100;return Hr(o,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):Hr(i,t.length)},R:function(e,t){const r=nR(e);return Hr(r,t.length)},u:function(e,t){const r=e.getFullYear();return Hr(r,t.length)},Q:function(e,t,r){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(a);case"QQ":return Hr(a,2);case"Qo":return r.ordinalNumber(a,{unit:"quarter"});case"QQQ":return r.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(a,{width:"wide",context:"formatting"})}},q:function(e,t,r){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(a);case"qq":return Hr(a,2);case"qo":return r.ordinalNumber(a,{unit:"quarter"});case"qqq":return r.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(a,{width:"wide",context:"standalone"})}},M:function(e,t,r){const a=e.getMonth();switch(t){case"M":case"MM":return Bc.M(e,t);case"Mo":return r.ordinalNumber(a+1,{unit:"month"});case"MMM":return r.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(a,{width:"wide",context:"formatting"})}},L:function(e,t,r){const a=e.getMonth();switch(t){case"L":return String(a+1);case"LL":return Hr(a+1,2);case"Lo":return r.ordinalNumber(a+1,{unit:"month"});case"LLL":return r.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(a,{width:"wide",context:"standalone"})}},w:function(e,t,r,a){const n=fR(e,a);return t==="wo"?r.ordinalNumber(n,{unit:"week"}):Hr(n,t.length)},I:function(e,t,r){const a=uR(e);return t==="Io"?r.ordinalNumber(a,{unit:"week"}):Hr(a,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Bc.d(e,t)},D:function(e,t,r){const a=zG(e);return t==="Do"?r.ordinalNumber(a,{unit:"dayOfYear"}):Hr(a,t.length)},E:function(e,t,r){const a=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(a,{width:"short",context:"formatting"});case"EEEE":default:return r.day(a,{width:"wide",context:"formatting"})}},e:function(e,t,r,a){const n=e.getDay(),i=(n-a.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return Hr(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"});case"eeee":default:return r.day(n,{width:"wide",context:"formatting"})}},c:function(e,t,r,a){const n=e.getDay(),i=(n-a.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return Hr(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"});case"cccc":default:return r.day(n,{width:"wide",context:"standalone"})}},i:function(e,t,r){const a=e.getDay(),n=a===0?7:a;switch(t){case"i":return String(n);case"ii":return Hr(n,t.length);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return r.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(a,{width:"short",context:"formatting"});case"iiii":default:return r.day(a,{width:"wide",context:"formatting"})}},a:function(e,t,r){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(e,t,r){const a=e.getHours();let n;switch(a===12?n=fh.noon:a===0?n=fh.midnight:n=a/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(e,t,r){const a=e.getHours();let n;switch(a>=17?n=fh.evening:a>=12?n=fh.afternoon:a>=4?n=fh.morning:n=fh.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let a=e.getHours()%12;return a===0&&(a=12),r.ordinalNumber(a,{unit:"hour"})}return Bc.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Bc.H(e,t)},K:function(e,t,r){const a=e.getHours()%12;return t==="Ko"?r.ordinalNumber(a,{unit:"hour"}):Hr(a,t.length)},k:function(e,t,r){let a=e.getHours();return a===0&&(a=24),t==="ko"?r.ordinalNumber(a,{unit:"hour"}):Hr(a,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Bc.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Bc.s(e,t)},S:function(e,t){return Bc.S(e,t)},X:function(e,t,r){const a=e.getTimezoneOffset();if(a===0)return"Z";switch(t){case"X":return GC(a);case"XXXX":case"XX":return ru(a);case"XXXXX":case"XXX":default:return ru(a,":")}},x:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"x":return GC(a);case"xxxx":case"xx":return ru(a);case"xxxxx":case"xxx":default:return ru(a,":")}},O:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+HC(a,":");case"OOOO":default:return"GMT"+ru(a,":")}},z:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+HC(a,":");case"zzzz":default:return"GMT"+ru(a,":")}},t:function(e,t,r){const a=Math.trunc(e.getTime()/1e3);return Hr(a,t.length)},T:function(e,t,r){const a=e.getTime();return Hr(a,t.length)}};function HC(e,t=""){const r=e>0?"-":"+",a=Math.abs(e),n=Math.trunc(a/60),i=a%60;return i===0?r+String(n):r+String(n)+t+Hr(i,2)}function GC(e,t){return e%60===0?(e>0?"-":"+")+Hr(Math.abs(e)/60,2):ru(e,t)}function ru(e,t=""){const r=e>0?"-":"+",a=Math.abs(e),n=Hr(Math.trunc(a/60),2),i=Hr(a%60,2);return r+n+t+i}const KC=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},mR=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},qG=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],a=r[1],n=r[2];if(!n)return KC(e,t);let i;switch(a){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",KC(a,t)).replace("{{time}}",mR(n,t))},WG={p:mR,P:qG},HG=/^D+$/,GG=/^Y+$/,KG=["D","DD","YY","YYYY"];function XG(e){return HG.test(e)}function YG(e){return GG.test(e)}function ZG(e,t,r){const a=QG(e,t,r);if(console.warn(a),KG.includes(e))throw new RangeError(a)}function QG(e,t,r){const a=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${a} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const JG=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,eK=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,tK=/^'([^]*?)'?$/,sK=/''/g,rK=/[a-zA-Z]/;function Os(e,t,r){var p,x,v,b,N,_,C,T;const a=qf(),n=(r==null?void 0:r.locale)??a.locale??i_,i=(r==null?void 0:r.firstWeekContainsDate)??((x=(p=r==null?void 0:r.locale)==null?void 0:p.options)==null?void 0:x.firstWeekContainsDate)??a.firstWeekContainsDate??((b=(v=a.locale)==null?void 0:v.options)==null?void 0:b.firstWeekContainsDate)??1,o=(r==null?void 0:r.weekStartsOn)??((_=(N=r==null?void 0:r.locale)==null?void 0:N.options)==null?void 0:_.weekStartsOn)??a.weekStartsOn??((T=(C=a.locale)==null?void 0:C.options)==null?void 0:T.weekStartsOn)??0,c=Rs(e);if(!iG(c))throw new RangeError("Invalid time value");let d=t.match(eK).map(A=>{const k=A[0];if(k==="p"||k==="P"){const I=WG[k];return I(A,n.formatLong)}return A}).join("").match(JG).map(A=>{if(A==="''")return{isToken:!1,value:"'"};const k=A[0];if(k==="'")return{isToken:!1,value:aK(A)};if(WC[k])return{isToken:!0,value:A};if(k.match(rK))throw new RangeError("Format string contains an unescaped latin alphabet character `"+k+"`");return{isToken:!1,value:A}});n.localize.preprocessor&&(d=n.localize.preprocessor(c,d));const h={firstWeekContainsDate:i,weekStartsOn:o,locale:n};return d.map(A=>{if(!A.isToken)return A.value;const k=A.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&YG(k)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&XG(k))&&ZG(k,t,String(e));const I=WC[k[0]];return I(c,k,n.localize,h)}).join("")}function aK(e){const t=e.match(tK);return t?t[1].replace(sK,"'"):e}function nK(e,t,r){const a=qf(),n=(r==null?void 0:r.locale)??a.locale??i_,i=2520,o=gx(e,t);if(isNaN(o))throw new RangeError("Invalid time value");const c=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:o});let d,h;o>0?(d=Rs(t),h=Rs(e)):(d=Rs(e),h=Rs(t));const p=dG(h,d),x=(gf(h)-gf(d))/1e3,v=Math.round((p-x)/60);let b;if(v<2)return r!=null&&r.includeSeconds?p<5?n.formatDistance("lessThanXSeconds",5,c):p<10?n.formatDistance("lessThanXSeconds",10,c):p<20?n.formatDistance("lessThanXSeconds",20,c):p<40?n.formatDistance("halfAMinute",0,c):p<60?n.formatDistance("lessThanXMinutes",1,c):n.formatDistance("xMinutes",1,c):v===0?n.formatDistance("lessThanXMinutes",1,c):n.formatDistance("xMinutes",v,c);if(v<45)return n.formatDistance("xMinutes",v,c);if(v<90)return n.formatDistance("aboutXHours",1,c);if(v<qC){const N=Math.round(v/60);return n.formatDistance("aboutXHours",N,c)}else{if(v<i)return n.formatDistance("xDays",1,c);if(v<z0){const N=Math.round(v/qC);return n.formatDistance("xDays",N,c)}else if(v<z0*2)return b=Math.round(v/z0),n.formatDistance("aboutXMonths",b,c)}if(b=cG(h,d),b<12){const N=Math.round(v/z0);return n.formatDistance("xMonths",N,c)}else{const N=b%12,_=Math.trunc(b/12);return N<3?n.formatDistance("aboutXYears",_,c):N<9?n.formatDistance("overXYears",_,c):n.formatDistance("almostXYears",_+1,c)}}function Ad(e,t){return nK(e,s_(e),t)}function iK(e){const t=Rs(e),r=t.getFullYear(),a=t.getMonth(),n=wi(e,0);return n.setFullYear(r,a+1,0),n.setHours(0,0,0,0),n.getDate()}function oK(e){return Rs(e).getMonth()}function lK(e){return Math.trunc(+Rs(e)/1e3)}function cK(e){const t=Rs(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function dK(e,t){return oG(cK(e),In(e),t)+1}function uK(e){return Rs(e).getFullYear()}function Jy(e,t){const r=Rs(e),a=Rs(t);return r.getTime()>a.getTime()}function pR(e,t){const r=Rs(e),a=Rs(t);return+r<+a}function o_(e,t){const r=Rs(e),a=Rs(t);return r.getFullYear()===a.getFullYear()&&r.getMonth()===a.getMonth()}function hK(e,t){const r=Rs(e),a=Rs(t);return r.getFullYear()===a.getFullYear()}function xR(e){return Zn(e,s_(e))}function fK(e,t){const r=+Rs(e),[a,n]=[+Rs(t.start),+Rs(t.end)].sort((i,o)=>i-o);return r>=a&&r<=n}function ln(e,t){return di(e,-t)}function gR(e){return Zn(e,ln(s_(e),1))}function av(e,t){const r=Rs(e),a=r.getFullYear(),n=r.getDate(),i=wi(e,0);i.setFullYear(a,t,15),i.setHours(0,0,0,0);const o=iK(i);return r.setMonth(t,Math.min(n,o)),r}function XC(e,t){const r=Rs(e);return isNaN(+r)?wi(e,NaN):(r.setFullYear(t),r)}function Wm(e,t){return So(e,-t)}function mK(e,t){return eG(e,-t)}const pK={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 ms",other:"cerca de {{count}} meses"},xMonths:{one:"1 ms",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},xK=(e,t,r)=>{let a;const n=pK[e];return typeof n=="string"?a=n:t===1?a=n.one:a=n.other.replace("{{count}}",String(t)),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"em "+a:"h "+a:a},gK={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},vK={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},yK={full:"{{date}} 's' {{time}}",long:"{{date}} 's' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},wK={date:Fh({formats:gK,defaultWidth:"full"}),time:Fh({formats:vK,defaultWidth:"full"}),dateTime:Fh({formats:yK,defaultWidth:"full"})},bK={lastWeek:e=>{const t=e.getDay();return"'"+(t===0||t===6?"ltimo":"ltima")+"' eeee 's' p"},yesterday:"'ontem s' p",today:"'hoje s' p",tomorrow:"'amanh s' p",nextWeek:"eeee 's' p",other:"P"},_K=(e,t,r,a)=>{const n=bK[e];return typeof n=="function"?n(t):n},jK={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},NK={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},CK={narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},EK={narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","tera","quarta","quinta","sexta","sbado"],wide:["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"]},SK={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"}},TK={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},AK=(e,t)=>{const r=Number(e);return(t==null?void 0:t.unit)==="week"?r+"":r+""},kK={ordinalNumber:AK,era:Nl({values:jK,defaultWidth:"wide"}),quarter:Nl({values:NK,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Nl({values:CK,defaultWidth:"wide"}),day:Nl({values:EK,defaultWidth:"wide"}),dayPeriod:Nl({values:SK,defaultWidth:"wide",formattingValues:TK,defaultFormattingWidth:"wide"})},RK=/^(\d+)[o]?/i,PK=/\d+/i,IK={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},OK={any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},DK={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},MK={any:[/1/i,/2/i,/3/i,/4/i]},LK={narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|maro|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},FK={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},BK={narrow:/^(dom|[23456]?|s[a]b)/i,short:/^(dom|[23456]?|s[a]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[a]b)/i,wide:/^(domingo|(segunda|ter[c]a|quarta|quinta|sexta)([- ]feira)?|s[a]bado)/i},VK={short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[a]b/i]},UK={narrow:/^(a|p|mn|md|(da) (manh|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manh|tarde|noite))/i},zK={any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manh/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},$K={ordinalNumber:dR({matchPattern:RK,parsePattern:PK,valueCallback:e=>parseInt(e,10)}),era:Cl({matchPatterns:IK,defaultMatchWidth:"wide",parsePatterns:OK,defaultParseWidth:"any"}),quarter:Cl({matchPatterns:DK,defaultMatchWidth:"wide",parsePatterns:MK,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Cl({matchPatterns:LK,defaultMatchWidth:"wide",parsePatterns:FK,defaultParseWidth:"any"}),day:Cl({matchPatterns:BK,defaultMatchWidth:"wide",parsePatterns:VK,defaultParseWidth:"any"}),dayPeriod:Cl({matchPatterns:UK,defaultMatchWidth:"any",parsePatterns:zK,defaultParseWidth:"any"})},$s={code:"pt-BR",formatDistance:xK,formatLong:wK,formatRelative:_K,localize:kK,match:$K,options:{weekStartsOn:0,firstWeekContainsDate:1}},Vc={co2PerKg:1.5,waterPerKg:15,energyPerKg:3.5,treesPerTon:17};function qK({open:e,onOpenChange:t}){const{user:r}=sr(),[a,n]=E.useState(!0),[i,o]=E.useState(!1),[c,d]=E.useState({notas:0,entregas:0,kgEntregue:0,kgNotas:0}),[h,p]=E.useState({notas:0,entregas:0,kgEntregue:0,kgNotas:0}),[x,v]=E.useState({totalKg:0,totalNotas:0,totalEntregas:0}),[b,N]=E.useState(""),_=async()=>{o(!0);try{const B=document.createElement("canvas"),O=B.getContext("2d");if(!O)throw new Error("Canvas no suportado");B.width=1080,B.height=1080,O.fillStyle="#FFFFFF",O.fillRect(0,0,B.width,B.height),O.strokeStyle="#22c55e",O.lineWidth=12,O.strokeRect(30,30,B.width-60,B.height-60);const D=new Image;D.crossOrigin="anonymous",D.src="/ciclik-logo-full.png",await new Promise((le,ye)=>{D.onload=()=>le(),D.onerror=()=>ye(new Error("Erro ao carregar logo"))});const F=280,M=D.height/D.width*F;O.drawImage(D,(B.width-F)/2,45,F,M),O.fillStyle="#166534",O.font="bold 42px Arial, sans-serif",O.textAlign="center",O.fillText("CERTIFICADO DE IMPACTO",B.width/2,250),O.fillStyle="#15803d",O.font="bold 36px Arial, sans-serif",O.fillText(b||"Guardio Verde",B.width/2,310),O.beginPath(),O.moveTo(200,350),O.lineTo(880,350),O.strokeStyle="#22c55e",O.lineWidth=3,O.stroke();const z=[{icon:"",value:gr(x.totalKg),label:"Reciclados"},{icon:"",value:`${x.totalNotas}`,label:"Notas Fiscais"},{icon:"",value:`${x.totalEntregas}`,label:"Entregas"},{icon:"",value:`${(x.totalKg*Vc.co2PerKg).toLocaleString("pt-BR",{maximumFractionDigits:1})}kg`,label:"CO Evitado"}],q=400,Y=300,ae=140,je=B.width/2-Y/2-100,H=B.width/2+Y/2-50;z.forEach((le,ye)=>{const W=ye%2,ee=Math.floor(ye/2),ie=W===0?je:H,ce=q+ee*ae;O.font="48px Arial",O.textAlign="center",O.fillText(le.icon,ie,ce),O.fillStyle="#166534",O.font="bold 40px Arial, sans-serif",O.textAlign="center",O.fillText(le.value,ie+120,ce),O.fillStyle="#4ade80",O.font="22px Arial, sans-serif",O.textAlign="center",O.fillText(le.label,ie+120,ce+30)}),O.textAlign="center",O.fillStyle="#166534",O.font="bold 28px Arial, sans-serif",O.fillText("IMPACTO AMBIENTAL GERADO",B.width/2,720);const Z=[` ${(x.totalKg*Vc.waterPerKg).toLocaleString("pt-BR",{maximumFractionDigits:0})}L gua economizada`,` ${(x.totalKg*Vc.energyPerKg).toLocaleString("pt-BR",{maximumFractionDigits:1})}kWh energia economizada`,` ${(x.totalKg/1e3*Vc.treesPerTon).toLocaleString("pt-BR",{maximumFractionDigits:2})} rvores preservadas`];O.fillStyle="#15803d",O.font="26px Arial, sans-serif",O.textAlign="center",Z.forEach((le,ye)=>{O.fillText(le,B.width/2,770+ye*40)}),O.textAlign="center",O.fillStyle="#86efac",O.font="20px Arial, sans-serif",O.fillText(`Gerado em ${Os(new Date,"dd 'de' MMMM 'de' yyyy",{locale:$s})}`,B.width/2,930),O.fillStyle="#22c55e",O.font="22px Arial, sans-serif",O.fillText("#Ciclik #Sustentabilidade #RecicleEGanhe",B.width/2,970),O.globalAlpha=.05;const G=400;O.drawImage(D,(B.width-G)/2,(B.height-G)/2,G,G),O.globalAlpha=1;const Q=B.toDataURL("image/png"),re=document.createElement("a");re.download=`certificado-ciclik-${Os(new Date,"yyyy-MM-dd")}.png`,re.href=Q,re.click(),ct.success("Certificado gerado! Compartilhe nas redes sociais.")}catch(B){console.error("Erro ao gerar certificado:",B),ct.error("Erro ao gerar certificado")}finally{o(!1)}};E.useEffect(()=>{e&&r&&C()},[e,r]);const C=async()=>{var B,O,D,F,M,z;if(r){n(!0);try{const q=new Date,Y=In(q),ae=Lu(q),je=In(Wm(q,1)),H=Lu(Wm(q,1)),{data:Z}=await J.from("profiles").select("nome").eq("id",r.id).single();Z&&N(Z.nome.split(" ")[0]);const[G,Q]=await Promise.all([J.from("notas_fiscais").select("id",{count:"exact"}).eq("id_usuario",r.id).gte("data_envio",Y.toISOString()).lte("data_envio",ae.toISOString()),J.from("entregas_reciclaveis").select("id").eq("id_usuario",r.id).eq("status_promessa","finalizada").gte("data_validacao",Y.toISOString()).lte("data_validacao",ae.toISOString())]),[re,le]=await Promise.all([J.from("notas_fiscais").select("id",{count:"exact"}).eq("id_usuario",r.id).gte("data_envio",je.toISOString()).lte("data_envio",H.toISOString()),J.from("entregas_reciclaveis").select("id").eq("id_usuario",r.id).eq("status_promessa","finalizada").gte("data_validacao",je.toISOString()).lte("data_validacao",H.toISOString())]),[ye,W]=await Promise.all([J.from("notas_fiscais").select("id",{count:"exact"}).eq("id_usuario",r.id),J.from("entregas_reciclaveis").select("id").eq("id_usuario",r.id).eq("status_promessa","finalizada")]),ee=((B=Q.data)==null?void 0:B.map(fe=>fe.id))||[],ie=((O=le.data)==null?void 0:O.map(fe=>fe.id))||[],ce=((D=W.data)==null?void 0:D.map(fe=>fe.id))||[];let xe=0,Ce=0,me=0;if(ee.length>0){const{data:fe}=await J.from("materiais_coletados_detalhado").select("peso_kg").in("id_entrega",ee).neq("subtipo_material","REJEITO");xe=(fe==null?void 0:fe.reduce((ve,ne)=>ve+(ne.peso_kg||0),0))||0}if(ie.length>0){const{data:fe}=await J.from("materiais_coletados_detalhado").select("peso_kg").in("id_entrega",ie).neq("subtipo_material","REJEITO");Ce=(fe==null?void 0:fe.reduce((ve,ne)=>ve+(ne.peso_kg||0),0))||0}if(ce.length>0){const{data:fe}=await J.from("materiais_coletados_detalhado").select("peso_kg").in("id_entrega",ce).neq("subtipo_material","REJEITO");me=(fe==null?void 0:fe.reduce((ve,ne)=>ve+(ne.peso_kg||0),0))||0}d({notas:G.count||0,entregas:((F=Q.data)==null?void 0:F.length)||0,kgEntregue:xe,kgNotas:0}),p({notas:re.count||0,entregas:((M=le.data)==null?void 0:M.length)||0,kgEntregue:Ce,kgNotas:0}),v({totalKg:me,totalNotas:ye.count||0,totalEntregas:((z=W.data)==null?void 0:z.length)||0})}catch(q){console.error("Erro ao carregar relatrio:",q)}finally{n(!1)}}},T=(B,O)=>O===0?B>0?100:0:Math.round((B-O)/O*100),A=E.useMemo(()=>[{label:"Notas Fiscais",current:c.notas,previous:h.notas,growth:T(c.notas,h.notas),unit:"",icon:Qa},{label:"Entregas",current:c.entregas,previous:h.entregas,growth:T(c.entregas,h.entregas),unit:"",icon:tl},{label:"Kg Reciclados",current:c.kgEntregue,previous:h.kgEntregue,growth:T(c.kgEntregue,h.kgEntregue),unit:"kg",icon:Ur}],[c,h]),k=E.useMemo(()=>({co2Avoided:x.totalKg*Vc.co2PerKg,waterSaved:x.totalKg*Vc.waterPerKg,energySaved:x.totalKg*Vc.energyPerKg,treesSaved:x.totalKg/1e3*Vc.treesPerTon}),[x.totalKg]);Os(new Date,"MMMM yyyy",{locale:$s});const I=({growth:B})=>B>0?s.jsxs("span",{className:"inline-flex items-center gap-0.5 px-2 py-0.5 rounded-full bg-[#22c55e]/10 text-[#22c55e] text-xs font-semibold",children:[s.jsx(Ir,{className:"h-3 w-3"}),"+",B,"%"]}):B<0?s.jsxs("span",{className:"inline-flex items-center gap-0.5 px-2 py-0.5 rounded-full bg-red-500/10 text-red-500 text-xs font-semibold",children:[s.jsx(Vw,{className:"h-3 w-3"}),B,"%"]}):s.jsxs("span",{className:"inline-flex items-center gap-0.5 px-2 py-0.5 rounded-full bg-gray-100 text-gray-500 text-xs font-semibold",children:[s.jsx(A6,{className:"h-3 w-3"}),"0%"]});return s.jsx(ar,{open:e,onOpenChange:t,children:s.jsx(tr,{className:"max-w-md max-h-[90vh] p-0 bg-white border-0 shadow-2xl overflow-hidden flex flex-col",children:a?s.jsx("div",{className:"flex items-center justify-center py-24 bg-white flex-shrink-0",children:s.jsx(Ee.div,{animate:{rotate:360},transition:{duration:1.5,repeat:1/0,ease:"linear"},children:s.jsx(cr,{className:"h-10 w-10 text-[#22c55e]"})})}):s.jsxs("div",{className:"bg-white flex flex-col max-h-[90vh] relative",children:[s.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-0 overflow-hidden",children:s.jsx("img",{src:Sa("ciclik-logo.png"),alt:"",className:"w-72 h-72 opacity-[0.04] object-contain"})}),s.jsx("div",{className:"bg-white border-b border-gray-100 px-6 py-4 flex-shrink-0 relative z-20",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("img",{src:Sa("ciclik-logo.png"),alt:"Ciclik",className:"h-10 w-10"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"Relatrio de Impacto"}),s.jsx("p",{className:"text-xs text-gray-500",children:b?`Ol ${b}, veja seu impacto ambiental`:"Seu impacto ambiental"})]}),s.jsx("span",{className:"text-[10px] font-medium text-gray-400 uppercase tracking-wider bg-gray-100 px-2.5 py-1 rounded-full",children:Os(new Date,"MMM yyyy",{locale:$s})})]})}),s.jsxs("div",{className:"px-6 py-5 space-y-6 overflow-y-auto flex-1 relative z-10",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-[11px] font-semibold text-gray-400 uppercase tracking-wider mb-3",children:"Seus nmeros totais"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs(Ee.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"flex-1 bg-gray-50 rounded-2xl p-4 text-center",children:[s.jsx("div",{className:"w-10 h-10 bg-[#22c55e]/10 rounded-full flex items-center justify-center mx-auto mb-2",children:s.jsx(Qa,{className:"h-5 w-5 text-[#22c55e]"})}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:x.totalNotas}),s.jsx("p",{className:"text-[11px] text-gray-500 font-medium",children:"Notas"})]}),s.jsxs(Ee.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.15},className:"flex-1 bg-gray-50 rounded-2xl p-4 text-center",children:[s.jsx("div",{className:"w-10 h-10 bg-[#22c55e]/10 rounded-full flex items-center justify-center mx-auto mb-2",children:s.jsx(tl,{className:"h-5 w-5 text-[#22c55e]"})}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:x.totalEntregas}),s.jsx("p",{className:"text-[11px] text-gray-500 font-medium",children:"Entregas"})]}),s.jsxs(Ee.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"flex-1 bg-gray-50 rounded-2xl p-4 text-center",children:[s.jsx("div",{className:"w-10 h-10 bg-[#22c55e]/10 rounded-full flex items-center justify-center mx-auto mb-2",children:s.jsx(Ur,{className:"h-5 w-5 text-[#22c55e]"})}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:gr(x.totalKg)}),s.jsx("p",{className:"text-[11px] text-gray-500 font-medium",children:"Reciclados"})]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-[11px] font-semibold text-gray-400 uppercase tracking-wider mb-3",children:"Evoluo mensal"}),s.jsx("div",{className:"bg-gray-50 rounded-2xl divide-y divide-gray-100",children:A.map((B,O)=>s.jsxs(Ee.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.25+O*.05},className:"flex items-center justify-between px-4 py-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(B.icon,{className:"h-4 w-4 text-gray-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:B.label}),s.jsxs("p",{className:"text-xs text-gray-500",children:[B.current,B.unit," ",s.jsx("span",{className:"text-gray-300",children:""})," ant. ",B.previous,B.unit]})]})]}),s.jsx(I,{growth:B.growth})]},B.label))})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-[11px] font-semibold text-gray-400 uppercase tracking-wider mb-3",children:"Impacto ambiental gerado"}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs(Ee.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.4},className:"bg-gradient-to-br from-emerald-50 to-green-50 rounded-2xl p-4 border border-emerald-100",children:[s.jsx("div",{className:"flex items-center gap-2 mb-2",children:s.jsx("div",{className:"w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-sm",children:s.jsx(Hc,{className:"h-4 w-4 text-emerald-600"})})}),s.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[k.co2Avoided.toLocaleString("pt-BR",{minimumFractionDigits:1,maximumFractionDigits:1}),s.jsx("span",{className:"text-sm font-medium text-gray-500 ml-1",children:"kg"})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"CO evitado"})]}),s.jsxs(Ee.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.45},className:"bg-gradient-to-br from-blue-50 to-cyan-50 rounded-2xl p-4 border border-blue-100",children:[s.jsx("div",{className:"flex items-center gap-2 mb-2",children:s.jsx("div",{className:"w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-sm",children:s.jsx(Gc,{className:"h-4 w-4 text-blue-600"})})}),s.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[k.waterSaved.toLocaleString("pt-BR",{maximumFractionDigits:0}),s.jsx("span",{className:"text-sm font-medium text-gray-500 ml-1",children:"L"})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"gua economizada"})]}),s.jsxs(Ee.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.5},className:"bg-gradient-to-br from-amber-50 to-yellow-50 rounded-2xl p-4 border border-amber-100",children:[s.jsx("div",{className:"flex items-center gap-2 mb-2",children:s.jsx("div",{className:"w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-sm",children:s.jsx(Go,{className:"h-4 w-4 text-amber-600"})})}),s.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[k.energySaved.toLocaleString("pt-BR",{minimumFractionDigits:1,maximumFractionDigits:1}),s.jsx("span",{className:"text-sm font-medium text-gray-500 ml-1",children:"kWh"})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Energia economizada"})]}),s.jsxs(Ee.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.55},className:"bg-gradient-to-br from-green-50 to-teal-50 rounded-2xl p-4 border border-green-100",children:[s.jsx("div",{className:"flex items-center gap-2 mb-2",children:s.jsx("div",{className:"w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-sm",children:s.jsx(y4,{className:"h-4 w-4 text-green-600"})})}),s.jsx("p",{className:"text-xl font-bold text-gray-900",children:k.treesSaved.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}),s.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"rvores preservadas"})]})]})]}),s.jsxs(Ee.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.6},className:"pt-4 space-y-3",children:[s.jsxs(Ee.button,{onClick:_,disabled:i,whileHover:{scale:1.02,boxShadow:"0 20px 40px -10px rgba(34, 197, 94, 0.4)"},whileTap:{scale:.98},className:"relative w-full h-16 rounded-2xl bg-gradient-to-r from-[#8BC34A] via-[#7CB342] to-[#689F38] text-white font-semibold text-lg shadow-xl shadow-[#8BC34A]/30 flex items-center justify-center gap-3 overflow-hidden disabled:opacity-70 disabled:cursor-not-allowed",children:[s.jsx(Ee.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent",animate:{x:["-100%","100%"]},transition:{duration:2,repeat:1/0,ease:"linear",repeatDelay:1}}),s.jsx(Ee.div,{className:"absolute inset-0 rounded-2xl bg-green-400/20",animate:{opacity:[0,.5,0]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}}),s.jsxs("span",{className:"relative flex items-center gap-3",children:[i?s.jsx(Ee.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:s.jsx(cr,{className:"h-6 w-6"})}):s.jsx(Ee.div,{animate:{rotate:[0,-10,10,0]},transition:{duration:.5,repeat:1/0,repeatDelay:2},children:s.jsx(Qn,{className:"h-6 w-6"})}),s.jsx("span",{children:i?"Gerando...":"Gerar Certificado"})]})]}),s.jsx("p",{className:"text-center text-[10px] text-gray-400",children:"Gera uma imagem para compartilhar no Instagram e WhatsApp"})]})]})]})})})}const WK=({percentage:e,size:t=180,strokeWidth:r=12,color:a,children:n})=>{const i=(t-r)/2,o=i*2*Math.PI,c=o-Math.min(e,100)/100*o;return s.jsxs("div",{className:"relative",style:{width:t,height:t},children:[s.jsxs("svg",{width:t,height:t,className:"transform -rotate-90",children:[s.jsx("circle",{cx:t/2,cy:t/2,r:i,fill:"none",stroke:"hsl(var(--muted))",strokeWidth:r}),s.jsx(Ee.circle,{cx:t/2,cy:t/2,r:i,fill:"none",stroke:a,strokeWidth:r,strokeLinecap:"round",strokeDasharray:o,initial:{strokeDashoffset:o},animate:{strokeDashoffset:c},transition:{duration:1.5,ease:"easeOut",delay:.3}})]}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:n})]})},nv=({icon:e,label:t,value:r,color:a,delay:n=0})=>{const i={primary:"bg-primary/10 text-primary border-primary/20",success:"bg-success/10 text-success border-success/20",destructive:"bg-destructive/10 text-destructive border-destructive/20",warning:"bg-warning/10 text-warning border-warning/20"};return s.jsxs(Ee.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:n,duration:.4},className:`flex items-center gap-3 px-4 py-3 rounded-2xl border backdrop-blur-sm ${i[a]}`,children:[s.jsx(e,{className:"h-5 w-5 flex-shrink-0"}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-xs font-medium opacity-80",children:t}),s.jsx("span",{className:"text-lg font-bold",children:r})]})]})};function HK(){const{user:e}=sr(),t=ds(),[r,a]=E.useState({totalNotasFiscais:0,pesoTotalNotas:0,totalEntregasFinalizadas:0,pesoTotalEntregue:0,pesoRejeito:0,pesoEstimadoPromessas:0,percentualEntregue:0}),[n,i]=E.useState(!0),[o,c]=E.useState(!1);E.useEffect(()=>{e&&d()},[e]);const d=async()=>{if(e){i(!0);try{const{count:N}=await J.from("notas_fiscais").select("id",{count:"exact"}).eq("id_usuario",e.id),{data:_}=await J.from("materiais_reciclaveis_usuario").select("peso_total_estimado_gramas, peso_unitario_gramas, quantidade").eq("id_usuario",e.id).not("id_nota_fiscal","is",null),C=(_==null?void 0:_.reduce((q,Y)=>q+(Y.peso_total_estimado_gramas||(Y.peso_unitario_gramas||0)*(Y.quantidade||1)),0))||0,{data:T}=await J.from("entregas_reciclaveis").select("id, peso_estimado").eq("id_usuario",e.id).eq("status_promessa","finalizada"),A=(T==null?void 0:T.reduce((q,Y)=>q+(Y.peso_estimado||0),0))||0;let k=0,I=0;if(T&&T.length>0){const q=T.map(je=>je.id),{data:Y}=await J.from("materiais_coletados_detalhado").select("peso_kg").in("id_entrega",q).neq("subtipo_material","REJEITO");k=(Y==null?void 0:Y.reduce((je,H)=>je+(H.peso_kg||0),0))||0;const{data:ae}=await J.from("materiais_coletados_detalhado").select("peso_kg").in("id_entrega",q).eq("subtipo_material","REJEITO");I=(ae==null?void 0:ae.reduce((je,H)=>je+(H.peso_kg||0),0))||0}const B=Math.round(C/1e3*1e3)/1e3,O=Math.round(k*1e3)/1e3,D=Math.round(I*1e3)/1e3,F=Math.round(A*1e3)/1e3;let M=F;M===0&&B>0&&(M=B);const z=M>0?Math.round(O/M*100):0;a({totalNotasFiscais:N||0,pesoTotalNotas:B,totalEntregasFinalizadas:(T==null?void 0:T.length)||0,pesoTotalEntregue:O,pesoRejeito:D,pesoEstimadoPromessas:F,percentualEntregue:z})}catch(N){console.error("Erro ao carregar estatsticas:",N)}finally{i(!1)}}};if(n)return s.jsx("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-br from-success/5 via-background to-primary/5 p-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ee.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"p-3 rounded-2xl bg-success/20",children:s.jsx(cr,{className:"h-6 w-6 text-success"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-foreground",children:"Impacto Ambiental"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Carregando..."})]})]})});if(r.totalNotasFiscais===0&&r.totalEntregasFinalizadas===0)return s.jsxs(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"relative overflow-hidden rounded-3xl border-2 border-dashed border-muted p-8 text-center",children:[s.jsx(Ee.div,{animate:{y:[0,-8,0]},transition:{duration:2,repeat:1/0},className:"inline-flex p-4 rounded-full bg-muted/50 mb-4",children:s.jsx(cr,{className:"h-8 w-8 text-muted-foreground"})}),s.jsx("h3",{className:"font-semibold text-foreground mb-2",children:"Impacto Ambiental"}),s.jsx("p",{className:"text-sm text-muted-foreground max-w-xs mx-auto",children:"Envie notas fiscais e finalize entregas para acompanhar seu impacto positivo"})]});const h=()=>r.percentualEntregue>=80?"hsl(var(--success))":r.percentualEntregue>=50?"hsl(var(--warning))":"hsl(var(--destructive))",p=r.percentualEntregue>80?{title:"Excelente!",message:"Voc est fazendo a diferena!",color:"success"}:r.percentualEntregue>=50?{title:"Bom trabalho!",message:"Continue assim!",color:"warning"}:{title:"Vamos melhorar!",message:"Entregue mais materiais",color:"destructive"},x=r.pesoEstimadoPromessas>0?r.pesoEstimadoPromessas:r.pesoTotalNotas,v=r.pesoEstimadoPromessas>0?"Prometido nas Entregas":"Registrado em Notas",b=x-r.pesoTotalEntregue;return s.jsxs(Ee.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[s.jsxs(Ee.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:100},className:"relative overflow-hidden rounded-3xl bg-gradient-to-br from-success/10 via-background to-primary/10 border border-success/20",children:[s.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-success/5 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-48 h-48 bg-primary/5 rounded-full blur-3xl translate-y-1/2 -translate-x-1/2"}),s.jsxs("div",{className:"relative p-6 md:p-8",children:[s.jsxs("div",{className:"flex items-start justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ee.div,{className:"p-3 rounded-2xl bg-gradient-to-br from-success to-success/70 shadow-lg shadow-success/25",whileHover:{scale:1.05,rotate:5},children:s.jsx(cr,{className:"h-6 w-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-foreground",children:"Impacto Ambiental"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Seu ciclo de reciclagem"})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ee.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:s.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>c(!0),className:"rounded-full gap-1.5 border-success/30 text-success hover:bg-success/10 hover:text-success",children:[s.jsx(y6,{className:"h-4 w-4"}),"Relatrio"]})}),r.percentualEntregue>0&&s.jsxs(Ee.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.5},className:"flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-success/20 text-success text-sm font-medium",children:[s.jsx(Md,{className:"h-4 w-4"}),s.jsx("span",{children:"Ativo"})]})]})]}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-8 items-center",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx(WK,{percentage:r.percentualEntregue,color:h(),children:s.jsxs("div",{className:"text-center",children:[s.jsxs(Ee.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.8},className:"text-4xl font-bold text-foreground",children:[r.percentualEntregue,"%"]}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Taxa de Entrega"})]})}),s.jsxs(Ee.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:1},className:`mt-4 px-4 py-2 rounded-full text-sm font-medium ${p.color==="success"?"bg-success/20 text-success":p.color==="warning"?"bg-warning/20 text-warning":"bg-destructive/20 text-destructive"}`,children:[p.title," ",p.message]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(nv,{icon:Qa,label:v,value:gr(x),color:"primary",delay:.2}),s.jsx(nv,{icon:tl,label:"Entregue s Cooperativas",value:gr(r.pesoTotalEntregue),color:"success",delay:.3}),r.pesoRejeito>0&&s.jsx(nv,{icon:un,label:"Rejeito",value:gr(r.pesoRejeito),color:"destructive",delay:.4}),b>0&&s.jsxs(Ee.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.5,duration:.4},className:"flex flex-col gap-3 px-4 py-4 rounded-2xl border backdrop-blur-sm bg-warning/10 text-warning border-warning/20 cursor-pointer hover:bg-warning/20 transition-colors",onClick:()=>t("/select-materials"),children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Eo,{className:"h-6 w-6 flex-shrink-0"}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm font-medium opacity-80",children:"Falta Entregar"}),s.jsx("span",{className:"text-xl font-bold",children:gr(b)})]})]}),s.jsxs(oe,{size:"default",className:"w-full rounded-full bg-warning hover:bg-warning/90 text-warning-foreground shadow-lg shadow-warning/25 gap-2 justify-center font-semibold",onClick:N=>{N.stopPropagation(),t("/select-materials")},children:["Entregar",s.jsx(Hn,{className:"h-4 w-4"})]})]})]})]}),s.jsxs(Ee.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"grid grid-cols-2 gap-4 mt-8 pt-6 border-t border-border/50",children:[s.jsxs("div",{className:"text-center",children:[s.jsx(Ee.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.6},className:"inline-flex items-center justify-center w-12 h-12 rounded-2xl bg-primary/10 mb-2",children:s.jsx(Qa,{className:"h-5 w-5 text-primary"})}),s.jsx("p",{className:"text-2xl font-bold text-foreground",children:r.totalNotasFiscais}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Notas Fiscais"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx(Ee.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.7},className:"inline-flex items-center justify-center w-12 h-12 rounded-2xl bg-success/10 mb-2",children:s.jsx(Ur,{className:"h-5 w-5 text-success"})}),s.jsx("p",{className:"text-2xl font-bold text-foreground",children:r.totalEntregasFinalizadas}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Entregas Finalizadas"})]})]})]})]}),s.jsx(qK,{open:o,onOpenChange:c})]})}const GK={plastico:"Plstico",papel:"Papel",papelao:"Papelo",vidro:"Vidro",metal:"Metal",aluminio:"Alumnio",laminado:"Laminado",misto:"Misto",outros:"Outros"},KK=({userId:e})=>{const[t,r]=E.useState([]),[a,n]=E.useState([]),[i,o]=E.useState(!0);E.useEffect(()=>{c();let _;const C=J.channel("materiais-changes").on("postgres_changes",{event:"*",schema:"public",table:"materiais_reciclaveis_usuario",filter:`id_usuario=eq.${e}`},()=>{clearTimeout(_),_=setTimeout(()=>{c()},1e3)}).subscribe();return()=>{clearTimeout(_),J.removeChannel(C)}},[e]);const c=async()=>{try{const{data:_,error:C}=await J.from("materiais_reciclaveis_usuario").select("*").eq("id_usuario",e).order("data_cadastro",{ascending:!1});if(C)throw C;const T=(_==null?void 0:_.filter(I=>I.id_entrega))||[];if(T.length>0){const I=[...new Set(T.map(D=>D.id_entrega))],{data:B}=await J.from("entregas_reciclaveis").select("id, data_geracao, status_promessa").in("id",I),O=_==null?void 0:_.map(D=>{if(D.id_entrega){const F=B==null?void 0:B.find(M=>M.id===D.id_entrega);return{...D,entregas_reciclaveis:F||null}}return D});r(O||[])}else r(_||[]);const{data:A,error:k}=await J.from("entregas_reciclaveis").select("id").eq("id_usuario",e).eq("status_promessa","finalizada");if(k)throw k;if(A&&A.length>0){const I=A.map(D=>D.id),{data:B,error:O}=await J.from("materiais_coletados_detalhado").select("tipo_material, peso_kg, subtipo_material").in("id_entrega",I).neq("subtipo_material","REJEITO");if(O)throw O;n(B||[])}else n([])}catch(_){console.error("Erro ao carregar materiais:",_)}finally{o(!1)}},d=_=>{if(_.status!=="em_entrega"||!_.entregas_reciclaveis)return!1;const C=_.entregas_reciclaveis;if(C.status_promessa==="finalizada")return!1;const T=new Date(C.data_geracao);return(new Date().getTime()-T.getTime())/(1e3*60*60)>24},h=_=>t.filter(C=>_==="em_entrega"?C.status==="em_entrega"&&!d(C):C.status===_),p={disponivel:h("disponivel").length,em_entrega:h("em_entrega").length,entregue:h("entregue").length,total:t.length},x=a.reduce((_,C)=>{var A;const T=((A=C.tipo_material)==null?void 0:A.toLowerCase())||"outros";return _[T]||(_[T]={tipo:T,peso:0,quantidade:0}),_[T].peso+=C.peso_kg||0,_[T].quantidade+=1,_},{}),v=Object.values(x).map((_,C)=>({name:GK[_.tipo]||_.tipo,peso:_.peso,quantidade:_.quantidade,fill:`hsl(var(--chart-${C%5+1}))`})),b=v.reduce((_,C)=>_+C.peso,0);if(i)return s.jsx(Ne,{children:s.jsx(De,{className:"p-6",children:s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})});const N=({active:_,payload:C})=>_&&C&&C.length?s.jsxs("div",{className:"bg-background border border-border rounded-lg p-3 shadow-lg",children:[s.jsx("p",{className:"font-semibold text-foreground",children:C[0].name}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Peso: ",gr(C[0].value)]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Registros: ",C[0].payload.quantidade]})]}):null;return s.jsxs(Ne,{className:"overflow-hidden",children:[s.jsxs(Ye,{className:"pb-3",children:[s.jsx(Qe,{className:"text-lg",children:"Meus Materiais Reciclveis"}),s.jsx(Tt,{className:"text-xs",children:"Resumo dos materiais cadastrados"})]}),s.jsxs(De,{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsxs("div",{className:"p-3 rounded-xl text-center bg-blue-500/10",children:[s.jsx(fs,{className:"w-5 h-5 mx-auto text-blue-600 mb-1"}),s.jsx("p",{className:"text-lg font-bold text-blue-600",children:p.disponivel}),s.jsx("p",{className:"text-[10px] text-blue-600/80",children:"Disponveis"})]}),s.jsxs("div",{className:"p-3 rounded-xl text-center bg-amber-500/10",children:[s.jsx(tl,{className:"w-5 h-5 mx-auto text-amber-600 mb-1"}),s.jsx("p",{className:"text-lg font-bold text-amber-600",children:p.em_entrega}),s.jsx("p",{className:"text-[10px] text-amber-600/80",children:"Em Entrega"})]}),s.jsxs("div",{className:"p-3 rounded-xl text-center bg-emerald-500/10",children:[s.jsx(Tr,{className:"w-5 h-5 mx-auto text-emerald-600 mb-1"}),s.jsx("p",{className:"text-lg font-bold text-emerald-600",children:p.entregue}),s.jsx("p",{className:"text-[10px] text-emerald-600/80",children:"Entregues"})]})]}),v.length>0&&s.jsxs("div",{className:"bg-muted/30 rounded-xl p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold mb-3 text-foreground flex items-center gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-primary"}),"Materiais Entregues por Tipo"]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(mi,{width:100,height:100,children:s.jsxs(Pw,{children:[s.jsx(Iw,{data:v,cx:"50%",cy:"50%",innerRadius:28,outerRadius:45,paddingAngle:2,dataKey:"peso",children:v.map((_,C)=>s.jsx(Ow,{fill:_.fill},`cell-${C}`))}),s.jsx(pi,{content:s.jsx(N,{})})]})}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("p",{className:"text-xs font-bold text-foreground",children:gr(b)})})]}),s.jsxs("div",{className:"flex-1 space-y-1.5",children:[v.slice(0,4).map((_,C)=>s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:_.fill}}),s.jsx("span",{className:"text-muted-foreground truncate max-w-[80px]",children:_.name})]}),s.jsx("span",{className:"font-medium text-foreground",children:gr(_.peso)})]},C)),v.length>4&&s.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["+",v.length-4," outros"]})]})]})]}),p.total===0&&s.jsxs("div",{className:"text-center py-6",children:[s.jsx(fs,{className:"w-10 h-10 mx-auto text-muted-foreground/30 mb-2"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum material cadastrado ainda"})]})]})]})};var i0={},XK=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},vR={},ro={};let l_;const YK=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];ro.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17};ro.getSymbolTotalCodewords=function(t){return YK[t]};ro.getBCHDigit=function(e){let t=0;for(;e!==0;)t++,e>>>=1;return t};ro.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');l_=t};ro.isKanjiModeEnabled=function(){return typeof l_<"u"};ro.toSJIS=function(t){return l_(t)};var zg={};(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+r)}}e.isValid=function(a){return a&&typeof a.bit<"u"&&a.bit>=0&&a.bit<4},e.from=function(a,n){if(e.isValid(a))return a;try{return t(a)}catch{return n}}})(zg);function yR(){this.buffer=[],this.length=0}yR.prototype={get:function(e){const t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)===1},put:function(e,t){for(let r=0;r<t;r++)this.putBit((e>>>t-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var ZK=yR;function o0(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}o0.prototype.set=function(e,t,r,a){const n=e*this.size+t;this.data[n]=r,a&&(this.reservedBit[n]=!0)};o0.prototype.get=function(e,t){return this.data[e*this.size+t]};o0.prototype.xor=function(e,t,r){this.data[e*this.size+t]^=r};o0.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]};var QK=o0,wR={};(function(e){const t=ro.getSymbolSize;e.getRowColCoords=function(a){if(a===1)return[];const n=Math.floor(a/7)+2,i=t(a),o=i===145?26:Math.ceil((i-13)/(2*n-2))*2,c=[i-7];for(let d=1;d<n-1;d++)c[d]=c[d-1]-o;return c.push(6),c.reverse()},e.getPositions=function(a){const n=[],i=e.getRowColCoords(a),o=i.length;for(let c=0;c<o;c++)for(let d=0;d<o;d++)c===0&&d===0||c===0&&d===o-1||c===o-1&&d===0||n.push([i[c],i[d]]);return n}})(wR);var bR={};const JK=ro.getSymbolSize,YC=7;bR.getPositions=function(t){const r=JK(t);return[[0,0],[r-YC,0],[0,r-YC]]};var _R={};(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(n){return n!=null&&n!==""&&!isNaN(n)&&n>=0&&n<=7},e.from=function(n){return e.isValid(n)?parseInt(n,10):void 0},e.getPenaltyN1=function(n){const i=n.size;let o=0,c=0,d=0,h=null,p=null;for(let x=0;x<i;x++){c=d=0,h=p=null;for(let v=0;v<i;v++){let b=n.get(x,v);b===h?c++:(c>=5&&(o+=t.N1+(c-5)),h=b,c=1),b=n.get(v,x),b===p?d++:(d>=5&&(o+=t.N1+(d-5)),p=b,d=1)}c>=5&&(o+=t.N1+(c-5)),d>=5&&(o+=t.N1+(d-5))}return o},e.getPenaltyN2=function(n){const i=n.size;let o=0;for(let c=0;c<i-1;c++)for(let d=0;d<i-1;d++){const h=n.get(c,d)+n.get(c,d+1)+n.get(c+1,d)+n.get(c+1,d+1);(h===4||h===0)&&o++}return o*t.N2},e.getPenaltyN3=function(n){const i=n.size;let o=0,c=0,d=0;for(let h=0;h<i;h++){c=d=0;for(let p=0;p<i;p++)c=c<<1&2047|n.get(h,p),p>=10&&(c===1488||c===93)&&o++,d=d<<1&2047|n.get(p,h),p>=10&&(d===1488||d===93)&&o++}return o*t.N3},e.getPenaltyN4=function(n){let i=0;const o=n.data.length;for(let d=0;d<o;d++)i+=n.data[d];return Math.abs(Math.ceil(i*100/o/5)-10)*t.N4};function r(a,n,i){switch(a){case e.Patterns.PATTERN000:return(n+i)%2===0;case e.Patterns.PATTERN001:return n%2===0;case e.Patterns.PATTERN010:return i%3===0;case e.Patterns.PATTERN011:return(n+i)%3===0;case e.Patterns.PATTERN100:return(Math.floor(n/2)+Math.floor(i/3))%2===0;case e.Patterns.PATTERN101:return n*i%2+n*i%3===0;case e.Patterns.PATTERN110:return(n*i%2+n*i%3)%2===0;case e.Patterns.PATTERN111:return(n*i%3+(n+i)%2)%2===0;default:throw new Error("bad maskPattern:"+a)}}e.applyMask=function(n,i){const o=i.size;for(let c=0;c<o;c++)for(let d=0;d<o;d++)i.isReserved(d,c)||i.xor(d,c,r(n,d,c))},e.getBestMask=function(n,i){const o=Object.keys(e.Patterns).length;let c=0,d=1/0;for(let h=0;h<o;h++){i(h),e.applyMask(h,n);const p=e.getPenaltyN1(n)+e.getPenaltyN2(n)+e.getPenaltyN3(n)+e.getPenaltyN4(n);e.applyMask(h,n),p<d&&(d=p,c=h)}return c}})(_R);var $g={};const gd=zg,$0=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],q0=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];$g.getBlocksCount=function(t,r){switch(r){case gd.L:return $0[(t-1)*4+0];case gd.M:return $0[(t-1)*4+1];case gd.Q:return $0[(t-1)*4+2];case gd.H:return $0[(t-1)*4+3];default:return}};$g.getTotalCodewordsCount=function(t,r){switch(r){case gd.L:return q0[(t-1)*4+0];case gd.M:return q0[(t-1)*4+1];case gd.Q:return q0[(t-1)*4+2];case gd.H:return q0[(t-1)*4+3];default:return}};var jR={},qg={};const Hm=new Uint8Array(512),Xx=new Uint8Array(256);(function(){let t=1;for(let r=0;r<255;r++)Hm[r]=t,Xx[t]=r,t<<=1,t&256&&(t^=285);for(let r=255;r<512;r++)Hm[r]=Hm[r-255]})();qg.log=function(t){if(t<1)throw new Error("log("+t+")");return Xx[t]};qg.exp=function(t){return Hm[t]};qg.mul=function(t,r){return t===0||r===0?0:Hm[Xx[t]+Xx[r]]};(function(e){const t=qg;e.mul=function(a,n){const i=new Uint8Array(a.length+n.length-1);for(let o=0;o<a.length;o++)for(let c=0;c<n.length;c++)i[o+c]^=t.mul(a[o],n[c]);return i},e.mod=function(a,n){let i=new Uint8Array(a);for(;i.length-n.length>=0;){const o=i[0];for(let d=0;d<n.length;d++)i[d]^=t.mul(n[d],o);let c=0;for(;c<i.length&&i[c]===0;)c++;i=i.slice(c)}return i},e.generateECPolynomial=function(a){let n=new Uint8Array([1]);for(let i=0;i<a;i++)n=e.mul(n,new Uint8Array([1,t.exp(i)]));return n}})(jR);const NR=jR;function c_(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}c_.prototype.initialize=function(t){this.degree=t,this.genPoly=NR.generateECPolynomial(this.degree)};c_.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(t.length+this.degree);r.set(t);const a=NR.mod(r,this.genPoly),n=this.degree-a.length;if(n>0){const i=new Uint8Array(this.degree);return i.set(a,n),i}return a};var eX=c_,CR={},Vd={},d_={};d_.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40};var Wl={};const ER="[0-9]+",tX="[A-Z $%*+\\-./:]+";let Rp="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Rp=Rp.replace(/u/g,"\\u");const sX="(?:(?![A-Z0-9 $%*+\\-./:]|"+Rp+`)(?:.|[\r
]))+`;Wl.KANJI=new RegExp(Rp,"g");Wl.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");Wl.BYTE=new RegExp(sX,"g");Wl.NUMERIC=new RegExp(ER,"g");Wl.ALPHANUMERIC=new RegExp(tX,"g");const rX=new RegExp("^"+Rp+"$"),aX=new RegExp("^"+ER+"$"),nX=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");Wl.testKanji=function(t){return rX.test(t)};Wl.testNumeric=function(t){return aX.test(t)};Wl.testAlphanumeric=function(t){return nX.test(t)};(function(e){const t=d_,r=Wl;e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(i,o){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!t.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?i.ccBits[0]:o<27?i.ccBits[1]:i.ccBits[2]},e.getBestModeForData=function(i){return r.testNumeric(i)?e.NUMERIC:r.testAlphanumeric(i)?e.ALPHANUMERIC:r.testKanji(i)?e.KANJI:e.BYTE},e.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},e.isValid=function(i){return i&&i.bit&&i.ccBits};function a(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+n)}}e.from=function(i,o){if(e.isValid(i))return i;try{return a(i)}catch{return o}}})(Vd);(function(e){const t=ro,r=$g,a=zg,n=Vd,i=d_,o=7973,c=t.getBCHDigit(o);function d(v,b,N){for(let _=1;_<=40;_++)if(b<=e.getCapacity(_,N,v))return _}function h(v,b){return n.getCharCountIndicator(v,b)+4}function p(v,b){let N=0;return v.forEach(function(_){const C=h(_.mode,b);N+=C+_.getBitsLength()}),N}function x(v,b){for(let N=1;N<=40;N++)if(p(v,N)<=e.getCapacity(N,b,n.MIXED))return N}e.from=function(b,N){return i.isValid(b)?parseInt(b,10):N},e.getCapacity=function(b,N,_){if(!i.isValid(b))throw new Error("Invalid QR Code version");typeof _>"u"&&(_=n.BYTE);const C=t.getSymbolTotalCodewords(b),T=r.getTotalCodewordsCount(b,N),A=(C-T)*8;if(_===n.MIXED)return A;const k=A-h(_,b);switch(_){case n.NUMERIC:return Math.floor(k/10*3);case n.ALPHANUMERIC:return Math.floor(k/11*2);case n.KANJI:return Math.floor(k/13);case n.BYTE:default:return Math.floor(k/8)}},e.getBestVersionForData=function(b,N){let _;const C=a.from(N,a.M);if(Array.isArray(b)){if(b.length>1)return x(b,C);if(b.length===0)return 1;_=b[0]}else _=b;return d(_.mode,_.getLength(),C)},e.getEncodedBits=function(b){if(!i.isValid(b)||b<7)throw new Error("Invalid QR Code version");let N=b<<12;for(;t.getBCHDigit(N)-c>=0;)N^=o<<t.getBCHDigit(N)-c;return b<<12|N}})(CR);var SR={};const ew=ro,TR=1335,iX=21522,ZC=ew.getBCHDigit(TR);SR.getEncodedBits=function(t,r){const a=t.bit<<3|r;let n=a<<10;for(;ew.getBCHDigit(n)-ZC>=0;)n^=TR<<ew.getBCHDigit(n)-ZC;return(a<<10|n)^iX};var AR={};const oX=Vd;function yf(e){this.mode=oX.NUMERIC,this.data=e.toString()}yf.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)};yf.prototype.getLength=function(){return this.data.length};yf.prototype.getBitsLength=function(){return yf.getBitsLength(this.data.length)};yf.prototype.write=function(t){let r,a,n;for(r=0;r+3<=this.data.length;r+=3)a=this.data.substr(r,3),n=parseInt(a,10),t.put(n,10);const i=this.data.length-r;i>0&&(a=this.data.substr(r),n=parseInt(a,10),t.put(n,i*3+1))};var lX=yf;const cX=Vd,iv=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function wf(e){this.mode=cX.ALPHANUMERIC,this.data=e}wf.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)};wf.prototype.getLength=function(){return this.data.length};wf.prototype.getBitsLength=function(){return wf.getBitsLength(this.data.length)};wf.prototype.write=function(t){let r;for(r=0;r+2<=this.data.length;r+=2){let a=iv.indexOf(this.data[r])*45;a+=iv.indexOf(this.data[r+1]),t.put(a,11)}this.data.length%2&&t.put(iv.indexOf(this.data[r]),6)};var dX=wf;const uX=Vd;function bf(e){this.mode=uX.BYTE,typeof e=="string"?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}bf.getBitsLength=function(t){return t*8};bf.prototype.getLength=function(){return this.data.length};bf.prototype.getBitsLength=function(){return bf.getBitsLength(this.data.length)};bf.prototype.write=function(e){for(let t=0,r=this.data.length;t<r;t++)e.put(this.data[t],8)};var hX=bf;const fX=Vd,mX=ro;function _f(e){this.mode=fX.KANJI,this.data=e}_f.getBitsLength=function(t){return t*13};_f.prototype.getLength=function(){return this.data.length};_f.prototype.getBitsLength=function(){return _f.getBitsLength(this.data.length)};_f.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let r=mX.toSJIS(this.data[t]);if(r>=33088&&r<=40956)r-=33088;else if(r>=57408&&r<=60351)r-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);r=(r>>>8&255)*192+(r&255),e.put(r,13)}};var pX=_f,kR={exports:{}};(function(e){var t={single_source_shortest_paths:function(r,a,n){var i={},o={};o[a]=0;var c=t.PriorityQueue.make();c.push(a,0);for(var d,h,p,x,v,b,N,_,C;!c.empty();){d=c.pop(),h=d.value,x=d.cost,v=r[h]||{};for(p in v)v.hasOwnProperty(p)&&(b=v[p],N=x+b,_=o[p],C=typeof o[p]>"u",(C||_>N)&&(o[p]=N,c.push(p,N),i[p]=h))}if(typeof n<"u"&&typeof o[n]>"u"){var T=["Could not find a path from ",a," to ",n,"."].join("");throw new Error(T)}return i},extract_shortest_path_from_predecessor_list:function(r,a){for(var n=[],i=a;i;)n.push(i),r[i],i=r[i];return n.reverse(),n},find_path:function(r,a,n){var i=t.single_source_shortest_paths(r,a,n);return t.extract_shortest_path_from_predecessor_list(i,n)},PriorityQueue:{make:function(r){var a=t.PriorityQueue,n={},i;r=r||{};for(i in a)a.hasOwnProperty(i)&&(n[i]=a[i]);return n.queue=[],n.sorter=r.sorter||a.default_sorter,n},default_sorter:function(r,a){return r.cost-a.cost},push:function(r,a){var n={value:r,cost:a};this.queue.push(n),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t})(kR);var xX=kR.exports;(function(e){const t=Vd,r=lX,a=dX,n=hX,i=pX,o=Wl,c=ro,d=xX;function h(T){return unescape(encodeURIComponent(T)).length}function p(T,A,k){const I=[];let B;for(;(B=T.exec(k))!==null;)I.push({data:B[0],index:B.index,mode:A,length:B[0].length});return I}function x(T){const A=p(o.NUMERIC,t.NUMERIC,T),k=p(o.ALPHANUMERIC,t.ALPHANUMERIC,T);let I,B;return c.isKanjiModeEnabled()?(I=p(o.BYTE,t.BYTE,T),B=p(o.KANJI,t.KANJI,T)):(I=p(o.BYTE_KANJI,t.BYTE,T),B=[]),A.concat(k,I,B).sort(function(D,F){return D.index-F.index}).map(function(D){return{data:D.data,mode:D.mode,length:D.length}})}function v(T,A){switch(A){case t.NUMERIC:return r.getBitsLength(T);case t.ALPHANUMERIC:return a.getBitsLength(T);case t.KANJI:return i.getBitsLength(T);case t.BYTE:return n.getBitsLength(T)}}function b(T){return T.reduce(function(A,k){const I=A.length-1>=0?A[A.length-1]:null;return I&&I.mode===k.mode?(A[A.length-1].data+=k.data,A):(A.push(k),A)},[])}function N(T){const A=[];for(let k=0;k<T.length;k++){const I=T[k];switch(I.mode){case t.NUMERIC:A.push([I,{data:I.data,mode:t.ALPHANUMERIC,length:I.length},{data:I.data,mode:t.BYTE,length:I.length}]);break;case t.ALPHANUMERIC:A.push([I,{data:I.data,mode:t.BYTE,length:I.length}]);break;case t.KANJI:A.push([I,{data:I.data,mode:t.BYTE,length:h(I.data)}]);break;case t.BYTE:A.push([{data:I.data,mode:t.BYTE,length:h(I.data)}])}}return A}function _(T,A){const k={},I={start:{}};let B=["start"];for(let O=0;O<T.length;O++){const D=T[O],F=[];for(let M=0;M<D.length;M++){const z=D[M],q=""+O+M;F.push(q),k[q]={node:z,lastCount:0},I[q]={};for(let Y=0;Y<B.length;Y++){const ae=B[Y];k[ae]&&k[ae].node.mode===z.mode?(I[ae][q]=v(k[ae].lastCount+z.length,z.mode)-v(k[ae].lastCount,z.mode),k[ae].lastCount+=z.length):(k[ae]&&(k[ae].lastCount=z.length),I[ae][q]=v(z.length,z.mode)+4+t.getCharCountIndicator(z.mode,A))}}B=F}for(let O=0;O<B.length;O++)I[B[O]].end=0;return{map:I,table:k}}function C(T,A){let k;const I=t.getBestModeForData(T);if(k=t.from(A,I),k!==t.BYTE&&k.bit<I.bit)throw new Error('"'+T+'" cannot be encoded with mode '+t.toString(k)+`.
 Suggested mode is: `+t.toString(I));switch(k===t.KANJI&&!c.isKanjiModeEnabled()&&(k=t.BYTE),k){case t.NUMERIC:return new r(T);case t.ALPHANUMERIC:return new a(T);case t.KANJI:return new i(T);case t.BYTE:return new n(T)}}e.fromArray=function(A){return A.reduce(function(k,I){return typeof I=="string"?k.push(C(I,null)):I.data&&k.push(C(I.data,I.mode)),k},[])},e.fromString=function(A,k){const I=x(A,c.isKanjiModeEnabled()),B=N(I),O=_(B,k),D=d.find_path(O.map,"start","end"),F=[];for(let M=1;M<D.length-1;M++)F.push(O.table[D[M]].node);return e.fromArray(b(F))},e.rawSplit=function(A){return e.fromArray(x(A,c.isKanjiModeEnabled()))}})(AR);const Wg=ro,ov=zg,gX=ZK,vX=QK,yX=wR,wX=bR,tw=_R,sw=$g,bX=eX,Yx=CR,_X=SR,jX=Vd,lv=AR;function NX(e,t){const r=e.size,a=wX.getPositions(t);for(let n=0;n<a.length;n++){const i=a[n][0],o=a[n][1];for(let c=-1;c<=7;c++)if(!(i+c<=-1||r<=i+c))for(let d=-1;d<=7;d++)o+d<=-1||r<=o+d||(c>=0&&c<=6&&(d===0||d===6)||d>=0&&d<=6&&(c===0||c===6)||c>=2&&c<=4&&d>=2&&d<=4?e.set(i+c,o+d,!0,!0):e.set(i+c,o+d,!1,!0))}}function CX(e){const t=e.size;for(let r=8;r<t-8;r++){const a=r%2===0;e.set(r,6,a,!0),e.set(6,r,a,!0)}}function EX(e,t){const r=yX.getPositions(t);for(let a=0;a<r.length;a++){const n=r[a][0],i=r[a][1];for(let o=-2;o<=2;o++)for(let c=-2;c<=2;c++)o===-2||o===2||c===-2||c===2||o===0&&c===0?e.set(n+o,i+c,!0,!0):e.set(n+o,i+c,!1,!0)}}function SX(e,t){const r=e.size,a=Yx.getEncodedBits(t);let n,i,o;for(let c=0;c<18;c++)n=Math.floor(c/3),i=c%3+r-8-3,o=(a>>c&1)===1,e.set(n,i,o,!0),e.set(i,n,o,!0)}function cv(e,t,r){const a=e.size,n=_X.getEncodedBits(t,r);let i,o;for(i=0;i<15;i++)o=(n>>i&1)===1,i<6?e.set(i,8,o,!0):i<8?e.set(i+1,8,o,!0):e.set(a-15+i,8,o,!0),i<8?e.set(8,a-i-1,o,!0):i<9?e.set(8,15-i-1+1,o,!0):e.set(8,15-i-1,o,!0);e.set(a-8,8,1,!0)}function TX(e,t){const r=e.size;let a=-1,n=r-1,i=7,o=0;for(let c=r-1;c>0;c-=2)for(c===6&&c--;;){for(let d=0;d<2;d++)if(!e.isReserved(n,c-d)){let h=!1;o<t.length&&(h=(t[o]>>>i&1)===1),e.set(n,c-d,h),i--,i===-1&&(o++,i=7)}if(n+=a,n<0||r<=n){n-=a,a=-a;break}}}function AX(e,t,r){const a=new gX;r.forEach(function(d){a.put(d.mode.bit,4),a.put(d.getLength(),jX.getCharCountIndicator(d.mode,e)),d.write(a)});const n=Wg.getSymbolTotalCodewords(e),i=sw.getTotalCodewordsCount(e,t),o=(n-i)*8;for(a.getLengthInBits()+4<=o&&a.put(0,4);a.getLengthInBits()%8!==0;)a.putBit(0);const c=(o-a.getLengthInBits())/8;for(let d=0;d<c;d++)a.put(d%2?17:236,8);return kX(a,e,t)}function kX(e,t,r){const a=Wg.getSymbolTotalCodewords(t),n=sw.getTotalCodewordsCount(t,r),i=a-n,o=sw.getBlocksCount(t,r),c=a%o,d=o-c,h=Math.floor(a/o),p=Math.floor(i/o),x=p+1,v=h-p,b=new bX(v);let N=0;const _=new Array(o),C=new Array(o);let T=0;const A=new Uint8Array(e.buffer);for(let D=0;D<o;D++){const F=D<d?p:x;_[D]=A.slice(N,N+F),C[D]=b.encode(_[D]),N+=F,T=Math.max(T,F)}const k=new Uint8Array(a);let I=0,B,O;for(B=0;B<T;B++)for(O=0;O<o;O++)B<_[O].length&&(k[I++]=_[O][B]);for(B=0;B<v;B++)for(O=0;O<o;O++)k[I++]=C[O][B];return k}function RX(e,t,r,a){let n;if(Array.isArray(e))n=lv.fromArray(e);else if(typeof e=="string"){let h=t;if(!h){const p=lv.rawSplit(e);h=Yx.getBestVersionForData(p,r)}n=lv.fromString(e,h||40)}else throw new Error("Invalid data");const i=Yx.getBestVersionForData(n,r);if(!i)throw new Error("The amount of data is too big to be stored in a QR Code");if(!t)t=i;else if(t<i)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+i+`.
`);const o=AX(t,r,n),c=Wg.getSymbolSize(t),d=new vX(c);return NX(d,t),CX(d),EX(d,t),cv(d,r,0),t>=7&&SX(d,t),TX(d,o),isNaN(a)&&(a=tw.getBestMask(d,cv.bind(null,d,r))),tw.applyMask(a,d),cv(d,r,a),{modules:d,version:t,errorCorrectionLevel:r,maskPattern:a,segments:n}}vR.create=function(t,r){if(typeof t>"u"||t==="")throw new Error("No input text");let a=ov.M,n,i;return typeof r<"u"&&(a=ov.from(r.errorCorrectionLevel,ov.M),n=Yx.from(r.version),i=tw.from(r.maskPattern),r.toSJISFunc&&Wg.setToSJISFunction(r.toSJISFunc)),RX(t,n,a,i)};var RR={},u_={};(function(e){function t(r){if(typeof r=="number"&&(r=r.toString()),typeof r!="string")throw new Error("Color should be defined as hex string");let a=r.slice().replace("#","").split("");if(a.length<3||a.length===5||a.length>8)throw new Error("Invalid hex color: "+r);(a.length===3||a.length===4)&&(a=Array.prototype.concat.apply([],a.map(function(i){return[i,i]}))),a.length===6&&a.push("F","F");const n=parseInt(a.join(""),16);return{r:n>>24&255,g:n>>16&255,b:n>>8&255,a:n&255,hex:"#"+a.slice(0,6).join("")}}e.getOptions=function(a){a||(a={}),a.color||(a.color={});const n=typeof a.margin>"u"||a.margin===null||a.margin<0?4:a.margin,i=a.width&&a.width>=21?a.width:void 0,o=a.scale||4;return{width:i,scale:i?4:o,margin:n,color:{dark:t(a.color.dark||"#000000ff"),light:t(a.color.light||"#ffffffff")},type:a.type,rendererOpts:a.rendererOpts||{}}},e.getScale=function(a,n){return n.width&&n.width>=a+n.margin*2?n.width/(a+n.margin*2):n.scale},e.getImageWidth=function(a,n){const i=e.getScale(a,n);return Math.floor((a+n.margin*2)*i)},e.qrToImageData=function(a,n,i){const o=n.modules.size,c=n.modules.data,d=e.getScale(o,i),h=Math.floor((o+i.margin*2)*d),p=i.margin*d,x=[i.color.light,i.color.dark];for(let v=0;v<h;v++)for(let b=0;b<h;b++){let N=(v*h+b)*4,_=i.color.light;if(v>=p&&b>=p&&v<h-p&&b<h-p){const C=Math.floor((v-p)/d),T=Math.floor((b-p)/d);_=x[c[C*o+T]?1:0]}a[N++]=_.r,a[N++]=_.g,a[N++]=_.b,a[N]=_.a}}})(u_);(function(e){const t=u_;function r(n,i,o){n.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=o,i.width=o,i.style.height=o+"px",i.style.width=o+"px"}function a(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(i,o,c){let d=c,h=o;typeof d>"u"&&(!o||!o.getContext)&&(d=o,o=void 0),o||(h=a()),d=t.getOptions(d);const p=t.getImageWidth(i.modules.size,d),x=h.getContext("2d"),v=x.createImageData(p,p);return t.qrToImageData(v.data,i,d),r(x,h,p),x.putImageData(v,0,0),h},e.renderToDataURL=function(i,o,c){let d=c;typeof d>"u"&&(!o||!o.getContext)&&(d=o,o=void 0),d||(d={});const h=e.render(i,o,d),p=d.type||"image/png",x=d.rendererOpts||{};return h.toDataURL(p,x.quality)}})(RR);var PR={};const PX=u_;function QC(e,t){const r=e.a/255,a=t+'="'+e.hex+'"';return r<1?a+" "+t+'-opacity="'+r.toFixed(2).slice(1)+'"':a}function dv(e,t,r){let a=e+t;return typeof r<"u"&&(a+=" "+r),a}function IX(e,t,r){let a="",n=0,i=!1,o=0;for(let c=0;c<e.length;c++){const d=Math.floor(c%t),h=Math.floor(c/t);!d&&!i&&(i=!0),e[c]?(o++,c>0&&d>0&&e[c-1]||(a+=i?dv("M",d+r,.5+h+r):dv("m",n,0),n=0,i=!1),d+1<t&&e[c+1]||(a+=dv("h",o),o=0)):n++}return a}PR.render=function(t,r,a){const n=PX.getOptions(r),i=t.modules.size,o=t.modules.data,c=i+n.margin*2,d=n.color.light.a?"<path "+QC(n.color.light,"fill")+' d="M0 0h'+c+"v"+c+'H0z"/>':"",h="<path "+QC(n.color.dark,"stroke")+' d="'+IX(o,i,n.margin)+'"/>',p='viewBox="0 0 '+c+" "+c+'"',v='<svg xmlns="http://www.w3.org/2000/svg" '+(n.width?'width="'+n.width+'" height="'+n.width+'" ':"")+p+' shape-rendering="crispEdges">'+d+h+`</svg>
`;return typeof a=="function"&&a(null,v),v};const OX=XK,rw=vR,IR=RR,DX=PR;function h_(e,t,r,a,n){const i=[].slice.call(arguments,1),o=i.length,c=typeof i[o-1]=="function";if(!c&&!OX())throw new Error("Callback required as last argument");if(c){if(o<2)throw new Error("Too few arguments provided");o===2?(n=r,r=t,t=a=void 0):o===3&&(t.getContext&&typeof n>"u"?(n=a,a=void 0):(n=a,a=r,r=t,t=void 0))}else{if(o<1)throw new Error("Too few arguments provided");return o===1?(r=t,t=a=void 0):o===2&&!t.getContext&&(a=r,r=t,t=void 0),new Promise(function(d,h){try{const p=rw.create(r,a);d(e(p,t,a))}catch(p){h(p)}})}try{const d=rw.create(r,a);n(null,e(d,t,a))}catch(d){n(d)}}i0.create=rw.create;i0.toCanvas=h_.bind(null,IR.render);i0.toDataURL=h_.bind(null,IR.renderToDataURL);i0.toString=h_.bind(null,function(e,t,r){return DX.render(e,r)});async function kd(e){const{data:t,width:r=400,margin:a=2,logoUrl:n="/Ciclik_validacoes/logo_qrcod.png",logoSizeRatio:i=.25,logoBackground:o=!0,logoPadding:c=8,roundedBackground:d=!0}=e;try{console.log("[QRCode] Gerando QR Code com logo"),console.log("[QRCode] Caminho da logo:",n);const h=await i0.toDataURL(t,{width:r,margin:a,errorCorrectionLevel:"H",color:{dark:"#000000",light:"#FFFFFF"}}),p=document.createElement("canvas"),x=p.getContext("2d");if(!x)throw new Error("No foi possvel criar contexto do canvas");const v=await JC(h);p.width=v.width,p.height=v.height,x.drawImage(v,0,0);try{console.log("[QRCode] Carregando logo...");const b=await JC(n);console.log("[QRCode]  Logo carregada com sucesso:",b.width,"x",b.height,"px");const N=Math.floor(p.width*i),_=Math.floor((p.width-N)/2),C=Math.floor((p.height-N)/2);if(o){const T=N+c*2,A=_-c,k=C-c;x.fillStyle="#FFFFFF",d?(x.beginPath(),x.moveTo(A+8,k),x.lineTo(A+T-8,k),x.quadraticCurveTo(A+T,k,A+T,k+8),x.lineTo(A+T,k+T-8),x.quadraticCurveTo(A+T,k+T,A+T-8,k+T),x.lineTo(A+8,k+T),x.quadraticCurveTo(A,k+T,A,k+T-8),x.lineTo(A,k+8),x.quadraticCurveTo(A,k,A+8,k),x.closePath(),x.fill()):x.fillRect(A,k,T,T),x.shadowColor="rgba(0, 0, 0, 0.1)",x.shadowBlur=4,x.shadowOffsetX=0,x.shadowOffsetY=2}x.drawImage(b,_,C,N,N),console.log("[QRCode]  Logo desenhada na posio:",_,",",C),x.shadowColor="transparent",x.shadowBlur=0,x.shadowOffsetX=0,x.shadowOffsetY=0}catch(b){return console.error("[QRCode]  ERRO ao carregar logo:",b),console.error("[QRCode] Caminho tentado:",n),console.warn("[QRCode] Usando fallback (QR Code sem logo)"),h}return console.log("[QRCode]  QR Code com logo gerado com sucesso!"),p.toDataURL("image/png",1)}catch(h){throw console.error("[QRCode] Erro geral ao gerar QR Code:",h),new Error("Falha ao gerar QR Code. Tente novamente.")}}function JC(e){return new Promise((t,r)=>{const a=new Image;a.crossOrigin="anonymous",a.onload=()=>t(a),a.onerror=n=>r(n),a.src=e})}const MX=()=>{const{user:e}=sr(),t=ds(),[r,a]=E.useState([]),[n,i]=E.useState(!0),[o,c]=E.useState(null),[d,h]=E.useState(!1),[p,x]=E.useState("");E.useEffect(()=>{if(e&&(v(),!(window.innerWidth<768))){const k=setInterval(v,6e4);return()=>clearInterval(k)}},[e]);const v=async()=>{try{const A=mK(new Date,24).toISOString(),{data:k,error:I}=await J.from("entregas_reciclaveis").select(`
          id,
          qrcode_id,
          data_geracao,
          peso_estimado,
          status,
          status_promessa,
          itens_vinculados,
          cooperativas!inner(nome_fantasia)
        `).eq("id_usuario",e==null?void 0:e.id).eq("status_promessa","ativa").gte("data_geracao",A).order("data_geracao",{ascending:!1});if(I)throw I;const B=(k==null?void 0:k.map(O=>({...O,cooperativa:Array.isArray(O.cooperativas)?O.cooperativas[0]:O.cooperativas})))||[];a(B)}catch(A){console.error("Erro ao carregar entregas pendentes:",A)}finally{i(!1)}},b=A=>{const k=new Date(A),O=24-a_(new Date,k);return O<=0?{text:"Expirado",color:"bg-destructive/10 text-destructive border-destructive/20",progress:100,urgent:!0}:O<=3?{text:`${O}h`,color:"bg-destructive/10 text-destructive border-destructive/20",progress:Math.min(100,(24-O)/24*100),urgent:!0}:O<=6?{text:`${O}h`,color:"bg-warning/10 text-warning border-warning/20",progress:(24-O)/24*100,urgent:!1}:{text:`${O}h`,color:"bg-primary/10 text-primary border-primary/20",progress:(24-O)/24*100,urgent:!1}},N=A=>{switch(A){case"em_coleta":return{icon:tl,text:"Em coleta",color:"bg-blue-500/10 text-blue-600"};case"ativa":default:return{icon:Gn,text:"Aguardando",color:"bg-amber-500/10 text-amber-600"}}},_=async A=>{if(b(A.data_geracao).text!=="Expirado"){c(A),h(!0);try{const I=await kd({data:A.qrcode_id,width:400,margin:2});x(I)}catch(I){console.error("Erro ao gerar QR Code com logo:",I),ct.error("Erro ao gerar QR Code")}}else ct.error("Esta entrega expirou",{description:"O prazo de 24 horas j passou."})},C=()=>{if(!o||!p)return;const A=document.createElement("a");A.href=p,A.download=`qrcode-entrega-${o.qrcode_id}.png`,A.click(),ct.success("QR Code baixado com sucesso!")},T=()=>{if(!o||!p)return;const A=window.open("","_blank");A&&(A.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>QR Code - Entrega ${o.qrcode_id}</title>
          <style>
            body {
              display: flex;
              flex-direction: column;
              align-items: center;
              justify-content: center;
              min-height: 100vh;
              margin: 0;
              font-family: system-ui, -apple-system, sans-serif;
            }
            .container {
              text-align: center;
              padding: 40px;
            }
            h1 {
              font-size: 24px;
              margin-bottom: 8px;
              color: #333;
            }
            .subtitle {
              font-size: 16px;
              color: #666;
              margin-bottom: 32px;
            }
            .qrcode {
              margin: 20px 0;
            }
            .qrcode img {
              max-width: 400px;
              height: auto;
            }
            .footer {
              margin-top: 32px;
              font-size: 14px;
              color: #888;
            }
            @media print {
              body { margin: 0; }
            }
          </style>
        </head>
        <body>
          <div class="container">
            <h1> Ciclik - Entrega de Reciclveis</h1>
            <div class="subtitle">
              <strong>${o.cooperativa.nome_fantasia}</strong><br>
              ${gr(o.peso_estimado||0)}
            </div>
            <div class="qrcode">
              <img src="${p}" alt="QR Code" />
            </div>
            <div class="footer">
              Cdigo: ${o.qrcode_id}
            </div>
          </div>
          <script>
            window.onload = () => {
              setTimeout(() => {
                window.print();
                setTimeout(() => window.close(), 100);
              }, 250);
            };
          <\/script>
        </body>
      </html>
    `),A.document.close())};return n?s.jsx("div",{className:"space-y-2",children:[1,2].map(A=>s.jsx("div",{className:"h-16 bg-muted/50 rounded-xl animate-pulse"},A))}):r.length===0?s.jsxs("div",{className:"text-center py-6",children:[s.jsx("div",{className:"w-12 h-12 mx-auto mb-3 rounded-full bg-primary/10 flex items-center justify-center",children:s.jsx(_n,{className:"h-6 w-6 text-primary"})}),s.jsx("p",{className:"text-sm font-medium text-foreground",children:"Tudo em dia!"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Nenhuma entrega pendente nas ltimas 24h"})]}):s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between px-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"relative",children:s.jsxs("span",{className:"flex h-2 w-2",children:[s.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-amber-400 opacity-75"}),s.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-amber-500"})]})}),s.jsxs("span",{className:"text-xs font-medium text-muted-foreground",children:[r.length," ",r.length===1?"entrega pendente":"entregas pendentes"]})]}),s.jsx("span",{className:"text-[10px] text-muted-foreground",children:"ltimas 24h"})]}),s.jsx(Qi,{children:r.slice(0,3).map((A,k)=>{var F;const I=b(A.data_geracao),B=N(A.status_promessa),O=B.icon,D=((F=A.itens_vinculados)==null?void 0:F.length)||0;return s.jsxs(Ee.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{delay:k*.05},className:`relative overflow-hidden rounded-xl border cursor-pointer hover:shadow-md transition-all ${I.urgent?"border-destructive/30 bg-destructive/5 hover:border-destructive/50":"border-border/50 bg-card/50 hover:border-primary/30"}`,onClick:()=>_(A),children:[s.jsx("div",{className:"absolute top-0 left-0 right-0 h-0.5 bg-muted/30",children:s.jsx(Ee.div,{className:`h-full ${I.urgent?"bg-destructive":"bg-primary"}`,initial:{width:0},animate:{width:`${I.progress}%`},transition:{duration:.5,delay:k*.1}})}),s.jsxs("div",{className:"p-3 pt-3.5",children:[s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[s.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[s.jsx("div",{className:`w-9 h-9 rounded-full flex items-center justify-center flex-shrink-0 ${B.color}`,children:s.jsx(O,{className:"h-4 w-4"})}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:A.cooperativa.nome_fantasia})}),s.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[s.jsxs("span",{className:"text-[11px] text-muted-foreground flex items-center gap-1",children:[s.jsx(fs,{className:"h-3 w-3"}),D," ",D===1?"item":"itens"]}),s.jsx("span",{className:"text-muted-foreground/30",children:""}),s.jsx("span",{className:"text-[11px] text-muted-foreground",children:gr(A.peso_estimado||0)})]})]})]}),s.jsx("div",{className:"flex items-center gap-2 flex-shrink-0",children:s.jsxs(Je,{variant:"outline",className:`text-[10px] font-semibold px-2 py-0.5 ${I.color}`,children:[s.jsx(Gn,{className:"h-3 w-3 mr-1"}),I.text]})})]}),I.urgent&&I.text!=="Expirado"&&s.jsxs(Ee.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"flex items-center gap-2 mt-2 pt-2 border-t border-destructive/20",children:[s.jsx(un,{className:"h-3 w-3 text-destructive flex-shrink-0"}),s.jsx("span",{className:"text-[10px] text-destructive",children:"Entregue em breve para no perder os pontos!"})]})]})]},A.id)})}),r.length>3&&s.jsxs("p",{className:"text-[11px] text-center text-muted-foreground",children:["+",r.length-3," ",r.length-3===1?"entrega":"entregas"," nas ltimas 24h"]}),s.jsxs(oe,{variant:"ghost",size:"sm",className:"w-full h-9 text-xs text-muted-foreground hover:text-foreground",onClick:()=>t("/delivery-history"),children:["Ver histrico completo",s.jsx(Xi,{className:"h-3.5 w-3.5 ml-1"})]}),s.jsx(ar,{open:d,onOpenChange:h,children:s.jsxs(tr,{className:"sm:max-w-md",children:[s.jsxs(nr,{children:[s.jsxs(ir,{className:"flex items-center gap-2",children:[s.jsx(Da,{className:"h-5 w-5 text-primary"}),"QR Code da Entrega"]}),s.jsx(Vr,{children:o&&s.jsxs(s.Fragment,{children:["Entrega para ",s.jsx("strong",{children:o.cooperativa.nome_fantasia}),s.jsx("br",{}),gr(o.peso_estimado||0)," estimado"]})})]}),o&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"flex justify-center p-6 bg-white rounded-lg border-2 border-dashed",children:p?s.jsx("img",{src:p,alt:"QR Code da Entrega",className:"w-64 h-64"}):s.jsx("div",{className:"w-64 h-64 flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}),s.jsxs("div",{className:"p-3 bg-muted rounded-md",children:[s.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Cdigo da Entrega:"}),s.jsx("p",{className:"font-mono text-sm font-medium break-all",children:o.qrcode_id})]}),(()=>{const A=b(o.data_geracao);return A.text!=="Expirado"&&s.jsx("div",{className:`p-3 rounded-md border ${A.color}`,children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Gn,{className:"h-4 w-4"}),s.jsxs("span",{className:"text-sm font-medium",children:[A.text," restantes para entrega"]})]})})})(),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs(oe,{variant:"outline",className:"w-full",onClick:C,children:[s.jsx(Ua,{className:"h-4 w-4 mr-2"}),"Baixar"]}),s.jsxs(oe,{variant:"outline",className:"w-full",onClick:T,children:[s.jsx(v4,{className:"h-4 w-4 mr-2"}),"Imprimir"]})]}),s.jsx(oe,{className:"w-full",onClick:()=>h(!1),children:"Fechar"})]})]})})]})};function OR({children:e,content:t,side:r="bottom",delayDuration:a=300,className:n,asChild:i=!0}){const[o,c]=E.useState(!1),d=E.useRef(null),h=E.useRef(!1),p=E.useCallback(()=>{d.current&&(clearTimeout(d.current),d.current=null)},[]),x=E.useCallback(b=>{h.current=!0,p(),d.current=setTimeout(()=>{h.current&&c(!0)},500)},[p]),v=E.useCallback(()=>{h.current=!1,p()},[p]);return s.jsx(Zo,{delayDuration:a,children:s.jsxs(Xn,{open:o,onOpenChange:c,children:[s.jsx(Yn,{asChild:i,onMouseEnter:()=>c(!0),onTouchStart:x,onTouchEnd:v,children:e}),s.jsx(kn,{side:r,className:n,onPointerDownOutside:()=>c(!1),children:t})]})})}function wm({icon:e,label:t,onClick:r,iconColor:a="text-primary",bgColor:n="bg-primary/10",className:i,tourClass:o,tooltipContent:c}){const d=s.jsxs(Ee.button,{onClick:r,className:pt("flex flex-col items-center gap-1.5 group",o,i),whileTap:{scale:.92},whileHover:{scale:1.05},transition:{type:"spring",stiffness:400,damping:17},children:[s.jsx(Ee.div,{className:pt("w-14 h-14 rounded-full flex items-center justify-center transition-all duration-300","shadow-sm group-hover:shadow-md",n),whileHover:{boxShadow:"0 8px 25px -5px rgba(34, 197, 94, 0.3)"},children:s.jsx(e,{className:pt("h-6 w-6",a)})}),s.jsx("span",{className:"text-[11px] font-medium text-muted-foreground group-hover:text-foreground transition-colors",children:t})]});return c?s.jsx(OR,{content:c,side:"bottom",className:"max-w-[200px] text-center bg-popover border border-border shadow-lg",delayDuration:300,children:d}):d}const LX={missoes:{atual:0,metaSemanal:3,metaMensal:10,progressoSemanal:0,progressoMensal:0},notas:{atual:0,metaSemanal:1,metaMensal:4,progressoSemanal:0,progressoMensal:0},entregas:{atual:0,metaSemanal:1,metaMensal:4,progressoSemanal:0,progressoMensal:0},indicacoes:{atual:0,metaSemanal:1,metaMensal:3,progressoSemanal:0,progressoMensal:0},pontosMes:0,nivel:"Iniciante",proximoNivel:"Protetor Ciclik",pontosParaProximoNivel:500,progressoNivel:0,diasRestantesSemana:7,diasRestantesMes:30,mensagemIncentivo:"Bem-vindo! Vamos comear sua jornada sustentvel! ",expressaoAssistente:"feliz",metaEmRisco:null,metaProxima:null};function DR(){const{user:e,profile:t}=sr(),{pontos:r}=sb(),[a,n]=E.useState(LX),[i,o]=E.useState(!0),c=x=>{switch(x){case"Iniciante":return"basico";case"Ativo":return"intermediario";case"Guardiao Verde":return"avancado";default:return"basico"}},d=()=>{const x=new Date,v=x.getDay(),b=v===0?0:7-v,_=new Date(x.getFullYear(),x.getMonth()+1,0).getDate()-x.getDate();return{diasRestantesSemana:b,diasRestantesMes:_}},h=(x,v,b)=>{const N=[{nome:"misses",dados:x.missoes,emoji:""},{nome:"notas fiscais",dados:x.notas,emoji:""},{nome:"entregas",dados:x.entregas,emoji:""},{nome:"indicaes",dados:x.indicacoes,emoji:""}],_=N.filter(A=>A.dados&&A.dados.progressoSemanal>=100);if(N.filter(A=>A.dados&&A.dados.progressoMensal>=100),_.length===4)return{mensagem:" Incrvel! Voc bateu TODAS as metas da semana! Continue assim!",expressao:"celebrando",metaEmRisco:null,metaProxima:null};const C=N.find(A=>A.dados&&A.dados.progressoSemanal>=80&&A.dados.progressoSemanal<100);if(C){const A=C.dados.metaSemanal-C.dados.atual;return{mensagem:`${C.emoji} Falta s ${A} ${C.nome} para bater sua meta semanal! Vamos l? `,expressao:"animado",metaEmRisco:null,metaProxima:C.nome}}if(v<=2){const A=N.find(k=>k.dados&&k.dados.progressoSemanal<50);if(A)return{mensagem:` O final da semana est chegando! Complete mais ${A.nome} para garantir sua meta. `,expressao:"preocupado",metaEmRisco:A.nome,metaProxima:null}}if(x.pontosParaProximoNivel&&x.pontosParaProximoNivel<=100)return{mensagem:` Voc est a apenas ${x.pontosParaProximoNivel} pontos de subir para ${x.proximoNivel}!`,expressao:"animado",metaEmRisco:null,metaProxima:null};const T=N.filter(A=>A.dados&&A.dados.progressoSemanal<100).sort((A,k)=>{var I,B;return(((I=A.dados)==null?void 0:I.progressoSemanal)||0)-(((B=k.dados)==null?void 0:B.progressoSemanal)||0)})[0];if(T&&T.dados){const A={misses:"Que tal aprender algo novo com uma aula educacional?","notas fiscais":"Escaneie suas notas fiscais para catalogar embalagens!",entregas:"Separe seus reciclveis e agende uma entrega!",indicaes:"Convide amigos para o Ciclik e ganhe pontos extras!"};return{mensagem:`${T.emoji} ${A[T.nome]}`,expressao:"feliz",metaEmRisco:null,metaProxima:null}}return{mensagem:"Continue sua jornada sustentvel! Cada ao faz a diferena ",expressao:"feliz",metaEmRisco:null,metaProxima:null}},p=E.useCallback(async()=>{if(!e){o(!1);return}const x=`gamification_cache_${e.id}`,v=`gamification_last_fetch_${e.id}`,b=sessionStorage.getItem(x),N=sessionStorage.getItem(v);if(b&&N&&Date.now()-parseInt(N)<45e3){const C=JSON.parse(b);n(C),o(!1);return}try{o(!0);const _=c((t==null?void 0:t.nivel)||"Iniciante"),{data:C}=await J.from("configuracoes_sistema").select("chave, valor").or(`chave.like.meta_semanal_%_${_},chave.like.meta_mensal_%_${_}`),T={missoes_semanal:3,missoes_mensal:10,notas_semanal:1,notas_mensal:4,entregas_semanal:1,entregas_mensal:4,indicacoes_semanal:1,indicacoes_mensal:3};C==null||C.forEach(Be=>{Be.chave.includes("missoes")&&Be.chave.includes("semanal")&&(T.missoes_semanal=parseInt(Be.valor)),Be.chave.includes("missoes")&&Be.chave.includes("mensal")&&(T.missoes_mensal=parseInt(Be.valor)),Be.chave.includes("notas")&&Be.chave.includes("semanal")&&(T.notas_semanal=parseInt(Be.valor)),Be.chave.includes("notas")&&Be.chave.includes("mensal")&&(T.notas_mensal=parseInt(Be.valor)),Be.chave.includes("entregas")&&Be.chave.includes("semanal")&&(T.entregas_semanal=parseInt(Be.valor)),Be.chave.includes("entregas")&&Be.chave.includes("mensal")&&(T.entregas_mensal=parseInt(Be.valor)),Be.chave.includes("indicacoes")&&Be.chave.includes("semanal")&&(T.indicacoes_semanal=parseInt(Be.valor)),Be.chave.includes("indicacoes")&&Be.chave.includes("mensal")&&(T.indicacoes_mensal=parseInt(Be.valor))});const A=new Date,k=new Date(A);k.setDate(A.getDate()-A.getDay()),k.setHours(0,0,0,0);const I=new Date(A.getFullYear(),A.getMonth(),1),[B,O,D,F,M,z,q,Y]=await Promise.all([J.from("missoes_usuarios").select("id",{count:"exact"}).eq("id_usuario",e.id).gte("data_conclusao",k.toISOString()),J.from("missoes_usuarios").select("id",{count:"exact"}).eq("id_usuario",e.id).gte("data_conclusao",I.toISOString()),J.from("notas_fiscais").select("id",{count:"exact"}).eq("id_usuario",e.id).eq("status_validacao","validada").gte("data_envio",k.toISOString()),J.from("notas_fiscais").select("id",{count:"exact"}).eq("id_usuario",e.id).eq("status_validacao","validada").gte("data_envio",I.toISOString()),J.from("entregas_reciclaveis").select("id",{count:"exact"}).eq("id_usuario",e.id).eq("status","validada").gte("data_validacao",k.toISOString()),J.from("entregas_reciclaveis").select("id",{count:"exact"}).eq("id_usuario",e.id).eq("status","validada").gte("data_validacao",I.toISOString()),J.from("indicacoes").select("id",{count:"exact"}).eq("id_indicador",e.id).gte("data_indicacao",k.toISOString()),J.from("indicacoes").select("id",{count:"exact"}).eq("id_indicador",e.id).gte("data_indicacao",I.toISOString())]),ae=(Be,ot)=>Math.min(Be/ot*100,100),je=B.count||0,H=O.count||0,Z=D.count||0,G=F.count||0,Q=M.count||0,re=z.count||0,le=q.count||0,ye=Y.count||0,W={missoes:{atual:H,metaSemanal:T.missoes_semanal,metaMensal:T.missoes_mensal,progressoSemanal:ae(je,T.missoes_semanal),progressoMensal:ae(H,T.missoes_mensal)},notas:{atual:G,metaSemanal:T.notas_semanal,metaMensal:T.notas_mensal,progressoSemanal:ae(Z,T.notas_semanal),progressoMensal:ae(G,T.notas_mensal)},entregas:{atual:re,metaSemanal:T.entregas_semanal,metaMensal:T.entregas_mensal,progressoSemanal:ae(Q,T.entregas_semanal),progressoMensal:ae(re,T.entregas_mensal)},indicacoes:{atual:ye,metaSemanal:T.indicacoes_semanal,metaMensal:T.indicacoes_mensal,progressoSemanal:ae(le,T.indicacoes_semanal),progressoMensal:ae(ye,T.indicacoes_mensal)}},ee=(t==null?void 0:t.nivel)||"Iniciante";let ie="Protetor Ciclik",ce=501-r,xe=r/500*100;r>500&&r<=1e3?(ie="Guardio Ciclik",ce=1001-r,xe=(r-500)/500*100):r>1e3&&(ie="Nvel Mximo",ce=0,xe=100);const{diasRestantesSemana:Ce,diasRestantesMes:me}=d(),{mensagem:fe,expressao:ve,metaEmRisco:ne,metaProxima:Me}=h({...W,pontosParaProximoNivel:ce,proximoNivel:ie},Ce,me),Ie={...W,pontosMes:r,nivel:ee,proximoNivel:ie,pontosParaProximoNivel:Math.max(0,ce),progressoNivel:Math.min(xe,100),diasRestantesSemana:Ce,diasRestantesMes:me,mensagemIncentivo:fe,expressaoAssistente:ve,metaEmRisco:ne,metaProxima:Me};if(n(Ie),e){const Be=`gamification_cache_${e.id}`,ot=`gamification_last_fetch_${e.id}`;sessionStorage.setItem(Be,JSON.stringify(Ie)),sessionStorage.setItem(ot,Date.now().toString())}}catch(_){console.error("Erro ao buscar progresso de gamificao:",_)}finally{o(!1)}},[e==null?void 0:e.id,t==null?void 0:t.id,r]);return E.useEffect(()=>{p()},[e==null?void 0:e.id,t==null?void 0:t.id,r]),{...a,loading:i,refetch:p}}const FX={feliz:"",animado:"",preocupado:"",celebrando:""},W0=[{emoji:"",text:"Que tal aprender algo novo com uma aula educacional?",cta:"Ver Aulas",route:"/missions",color:"amber"},{emoji:"",text:"Escaneie suas notas fiscais e ajude a catalogar embalagens reciclveis!",cta:"Escanear Nota",route:"/upload-receipt",color:"blue"},{emoji:"",text:"Separe seus reciclveis e entregue em uma cooperativa parceira!",cta:"Entregar Agora",route:"/select-materials",color:"green"},{emoji:"",text:"Indique amigos para o Ciclik! Vocs dois ganham pontos!",cta:"Convidar Amigos",route:"/profile",color:"purple"},{emoji:"",text:"Acompanhe suas metas semanais e suba de nvel mais rpido!",cta:"Ver Metas",route:"/goals",color:"primary"},{emoji:"",text:"Troque seus pontos por cupons de desconto em lojas parceiras!",cta:"Ver Cupons",route:"/redeem-coupons",color:"pink"},{emoji:"",text:"Cada kg de material reciclado evita emisso de CO na atmosfera.",cta:"Meu Impacto",route:"/delivery-history",color:"green"},{emoji:"",text:"Quanto mais alto seu nvel, mais benefcios voc desbloqueia!",cta:"Ver Progresso",route:"/goals",color:"amber"}],BX=e=>{const t={amber:"bg-amber-500 hover:bg-amber-600 text-white",blue:"bg-blue-500 hover:bg-blue-600 text-white",green:"bg-green-600 hover:bg-green-700 text-white",purple:"bg-purple-500 hover:bg-purple-600 text-white",pink:"bg-pink-500 hover:bg-pink-600 text-white",primary:"bg-primary hover:bg-primary/90 text-primary-foreground"};return t[e]||t.primary};function VX({compact:e=!1,onClose:t}){const r=ds(),a=DR(),[n,i]=E.useState(!e),[o,c]=E.useState(()=>new Date().getMonth()%W0.length);E.useEffect(()=>{const p=()=>{};document.addEventListener("visibilitychange",p);const x=setInterval(()=>{document.hidden||c(v=>(v+1)%W0.length)},8e3);return()=>{clearInterval(x),document.removeEventListener("visibilitychange",p)}},[]);const d=W0[o];if(a.loading)return s.jsx(Ne,{className:"rounded-2xl border-0 shadow-lg bg-gradient-to-br from-primary/5 via-card to-success/5",children:s.jsx(De,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-muted animate-pulse"}),s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx("div",{className:"h-4 bg-muted rounded animate-pulse w-3/4"}),s.jsx("div",{className:"h-3 bg-muted rounded animate-pulse w-1/2"})]})]})})});const h=[a.missoes.progressoSemanal>=100,a.notas.progressoSemanal>=100,a.entregas.progressoSemanal>=100,a.indicacoes.progressoSemanal>=100].filter(Boolean).length;return e&&!n?s.jsx(Ee.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"fixed bottom-24 right-4 z-50",children:s.jsxs(Ee.button,{onClick:()=>i(!0),className:"relative w-14 h-14 rounded-full bg-gradient-to-br from-primary to-success shadow-lg flex items-center justify-center",whileHover:{scale:1.1},whileTap:{scale:.95},animate:{boxShadow:a.expressaoAssistente==="animado"?["0 0 0 0 rgba(34, 197, 94, 0.4)","0 0 0 20px rgba(34, 197, 94, 0)"]:void 0},transition:{boxShadow:{duration:1.5,repeat:1/0}},children:[s.jsx("span",{className:"text-2xl",children:FX[a.expressaoAssistente]}),h>0&&s.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-success text-white text-xs rounded-full flex items-center justify-center font-bold",children:h})]})}):s.jsx(Ee.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},exit:{y:20,opacity:0},className:e?"fixed bottom-24 right-4 left-4 z-50 max-w-sm ml-auto":"",children:s.jsx(Ne,{className:"rounded-2xl border-0 shadow-lg bg-gradient-to-br from-primary/5 via-card to-success/5 overflow-hidden",children:s.jsxs(De,{className:"p-0",children:[s.jsx("div",{className:"p-4 pb-3",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Ee.div,{initial:{scale:.5,opacity:0,rotate:-10},animate:{scale:1,opacity:1,rotate:0},transition:{type:"spring",stiffness:300},className:"flex-shrink-0",children:s.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-primary to-success flex items-center justify-center shadow-md",children:s.jsx("span",{className:"text-2xl",children:d.emoji})})},o),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:"text-xs font-semibold text-primary",children:"Dica do Ciclo"}),s.jsx("div",{className:"flex gap-1",children:W0.map((p,x)=>s.jsx(Ee.div,{className:`w-1.5 h-1.5 rounded-full cursor-pointer ${x===o?"bg-primary":"bg-muted"}`,animate:x===o?{scale:[1,1.3,1]}:{},transition:{duration:.5},onClick:()=>c(x)},x))})]}),s.jsx(Qi,{mode:"wait",children:s.jsx(Ee.p,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},className:"text-sm text-foreground leading-tight mb-2",children:d.text},o)}),s.jsx(Ee.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.2},children:s.jsxs(oe,{size:"sm",className:`h-8 px-4 rounded-full text-xs font-medium shadow-sm ${BX(d.color)}`,onClick:()=>r(d.route),children:[d.cta,s.jsx(Xi,{className:"h-3.5 w-3.5 ml-1"})]})},`cta-${o}`)]}),e&&t&&s.jsx(oe,{variant:"ghost",size:"icon",className:"h-6 w-6 flex-shrink-0",onClick:t,children:s.jsx(Jr,{className:"h-4 w-4"})})]})}),s.jsx("div",{className:"px-4 pb-3",children:s.jsxs("div",{className:"relative",children:[s.jsx(fn,{value:a.progressoNivel,className:"h-2"}),a.progressoNivel>=80&&s.jsx(Ee.div,{className:"absolute right-0 top-1/2 -translate-y-1/2",animate:{scale:[1,1.3,1]},transition:{duration:1,repeat:1/0},children:s.jsx(Go,{className:"h-4 w-4 text-warning"})})]})}),s.jsx("div",{className:"px-4 pb-3",children:s.jsx("div",{className:"grid grid-cols-4 gap-2",children:[{label:"Misses",value:a.missoes.progressoSemanal,icon:"",route:"/missions"},{label:"Notas",value:a.notas.progressoSemanal,icon:"",route:"/upload-receipt"},{label:"Entregas",value:a.entregas.progressoSemanal,icon:"",route:"/select-materials"},{label:"Convites",value:a.indicacoes.progressoSemanal,icon:"",route:"/profile"}].map(p=>s.jsxs(Ee.div,{className:"relative cursor-pointer",whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>r(p.route),children:[s.jsxs("div",{className:`text-center p-2 rounded-xl transition-colors ${p.value>=100?"bg-success/10":"bg-muted/50 hover:bg-muted"}`,children:[s.jsx("span",{className:"text-lg",children:p.icon}),s.jsx("div",{className:"mt-1",children:s.jsx(fn,{value:p.value,className:"h-1"})}),s.jsxs("span",{className:"text-[10px] text-muted-foreground",children:[Math.round(p.value),"%"]})]}),p.value>=100&&s.jsx(Ee.div,{className:"absolute -top-1 -right-1",initial:{scale:0},animate:{scale:1},children:s.jsx(Je,{className:"h-4 w-4 p-0 bg-success flex items-center justify-center",children:s.jsx("span",{className:"text-[8px]",children:""})})})]},p.label))})}),s.jsx("div",{className:"px-4 pb-4",children:s.jsxs(Ee.button,{onClick:()=>r("/goals"),className:"relative w-full h-14 rounded-2xl overflow-hidden group shadow-lg",whileHover:{scale:1.02,y:-2},whileTap:{scale:.98},initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:300},children:[s.jsx(Ee.div,{className:"absolute inset-0 bg-gradient-to-r from-primary via-success via-50% to-primary bg-[length:200%_100%]",animate:{backgroundPosition:["0% 0%","100% 0%","0% 0%"]},transition:{duration:4,repeat:1/0,ease:"linear"}}),s.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:s.jsx("div",{className:"absolute inset-0 bg-white/20 blur-xl"})}),s.jsx("div",{className:"absolute top-0 left-0 right-0 h-[1px] bg-gradient-to-r from-transparent via-white/50 to-transparent"}),s.jsxs("div",{className:"relative flex items-center justify-between px-5 h-full",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(Ee.div,{className:"relative w-9 h-9 rounded-xl bg-white/20 backdrop-blur-sm flex items-center justify-center border border-white/20",animate:{boxShadow:["0 0 0 0 rgba(255,255,255,0.4)","0 0 0 8px rgba(255,255,255,0)","0 0 0 0 rgba(255,255,255,0.4)"]},transition:{duration:2,repeat:1/0},children:[s.jsx(Ee.div,{animate:{rotate:360},transition:{duration:10,repeat:1/0,ease:"linear"},children:s.jsx(Eo,{className:"h-4.5 w-4.5 text-white"})}),s.jsx(Ee.div,{className:"absolute -top-1 -right-1",animate:{scale:[.8,1.2,.8],opacity:[.5,1,.5]},transition:{duration:1.5,repeat:1/0},children:s.jsx(Md,{className:"h-3 w-3 text-yellow-300"})})]}),s.jsxs("div",{className:"flex flex-col items-start",children:[s.jsx("span",{className:"text-sm font-bold text-white tracking-wide",children:"Ver todas as metas"}),s.jsx("span",{className:"text-[10px] text-white/70 font-medium",children:"Acompanhe seu progresso"})]})]}),s.jsx(Ee.div,{className:"w-8 h-8 rounded-full bg-white/20 flex items-center justify-center",animate:{x:[0,4,0]},transition:{duration:1.2,repeat:1/0,ease:"easeInOut"},children:s.jsx(Xi,{className:"h-5 w-5 text-white"})})]}),s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-[1px] bg-gradient-to-r from-transparent via-white/30 to-transparent"})]})}),s.jsxs("div",{className:"bg-muted/30 px-4 py-2 flex items-center justify-between text-[10px] text-muted-foreground",children:[s.jsxs("span",{children:[" ",a.diasRestantesSemana," dias restantes na semana"]}),s.jsxs("span",{children:[" ",a.diasRestantesMes," dias no ms"]})]})]})})})}const f_=({tourKey:e,autoStart:t=!0})=>{const[r,a]=E.useState(!1),n=`tour_completed_${e}`;E.useEffect(()=>{if(t&&!localStorage.getItem(n)){const h=setTimeout(()=>{a(!0)},1e3);return()=>clearTimeout(h)}},[t,n]);const i=E.useCallback(()=>{a(!0)},[]),o=E.useCallback(()=>{localStorage.removeItem(n),a(!0)},[n]),c=E.useCallback(()=>{localStorage.setItem(n,"true"),a(!1)},[n]);return{run:r,startTour:i,resetTour:o,completeTour:c,setRun:a}};var Hg="Collapsible",[UX,MR]=bi(Hg),[zX,m_]=UX(Hg),LR=E.forwardRef((e,t)=>{const{__scopeCollapsible:r,open:a,defaultOpen:n,disabled:i,onOpenChange:o,...c}=e,[d,h]=No({prop:a,defaultProp:n??!1,onChange:o,caller:Hg});return s.jsx(zX,{scope:r,disabled:i,contentId:Ai(),open:d,onOpenToggle:E.useCallback(()=>h(p=>!p),[h]),children:s.jsx(ys.div,{"data-state":v_(d),"data-disabled":i?"":void 0,...c,ref:t})})});LR.displayName=Hg;var FR="CollapsibleTrigger",p_=E.forwardRef((e,t)=>{const{__scopeCollapsible:r,...a}=e,n=m_(FR,r);return s.jsx(ys.button,{type:"button","aria-controls":n.contentId,"aria-expanded":n.open||!1,"data-state":v_(n.open),"data-disabled":n.disabled?"":void 0,disabled:n.disabled,...a,ref:t,onClick:Ts(e.onClick,n.onOpenToggle)})});p_.displayName=FR;var x_="CollapsibleContent",g_=E.forwardRef((e,t)=>{const{forceMount:r,...a}=e,n=m_(x_,e.__scopeCollapsible);return s.jsx(il,{present:r||n.open,children:({present:i})=>s.jsx($X,{...a,ref:t,present:i})})});g_.displayName=x_;var $X=E.forwardRef((e,t)=>{const{__scopeCollapsible:r,present:a,children:n,...i}=e,o=m_(x_,r),[c,d]=E.useState(a),h=E.useRef(null),p=br(t,h),x=E.useRef(0),v=x.current,b=E.useRef(0),N=b.current,_=o.open||c,C=E.useRef(_),T=E.useRef(void 0);return E.useEffect(()=>{const A=requestAnimationFrame(()=>C.current=!1);return()=>cancelAnimationFrame(A)},[]),Ji(()=>{const A=h.current;if(A){T.current=T.current||{transitionDuration:A.style.transitionDuration,animationName:A.style.animationName},A.style.transitionDuration="0s",A.style.animationName="none";const k=A.getBoundingClientRect();x.current=k.height,b.current=k.width,C.current||(A.style.transitionDuration=T.current.transitionDuration,A.style.animationName=T.current.animationName),d(a)}},[o.open,a]),s.jsx(ys.div,{"data-state":v_(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!_,...i,ref:p,style:{"--radix-collapsible-content-height":v?`${v}px`:void 0,"--radix-collapsible-content-width":N?`${N}px`:void 0,...e.style},children:_&&n})});function v_(e){return e?"open":"closed"}var BR=LR,qX=p_,WX=g_;const vx=BR,yx=p_,wx=g_,H0={initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-10}},HX={animate:{transition:{staggerChildren:.05,delayChildren:.1}}},GX={initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0}};function KX(){const{profile:e,signOut:t,user:r}=sr(),a=ds(),n=jg(),{pontos:i,loading:o,refetch:c}=sb(),[d,h]=E.useState(0),[p,x]=E.useState(0),[v,b]=E.useState(!1),[N,_]=E.useState(!1),[C,T]=E.useState(!1),{run:A,completeTour:k,startTour:I}=f_({tourKey:"user_dashboard",autoStart:!0}),B=[{target:".tour-profile",content:"Bem-vindo ao Ciclik! Clique aqui para acessar seu perfil.",disableBeacon:!0},{target:".tour-score-card",content:"Acompanhe seus Pontos Verdes e progresso mensal!"},{target:".tour-quick-actions",content:"Acesse rapidamente todas as funcionalidades do app."},{target:".tour-missions",content:"Complete aulas educativas para ganhar pontos verdes!"},{target:".tour-deliver",content:"Entregue seus reciclveis e ganhe pontos!"},{target:".tour-coupons",content:"Troque seus pontos por cupons de desconto."}],O=()=>{k()};E.useEffect(()=>{r&&F()},[r]),E.useEffect(()=>{D()},[i]);const D=()=>{const H=i,Z=(e==null?void 0:e.nivel)||"Iniciante";let G=0;Z==="Iniciante"||H<=500?G=H/500*100:Z==="Ativo"||H>500&&H<=1e3?G=(H-500)/500*100:G=100,h(Math.min(G,100))},F=async()=>{if(!r)return;const{data:H}=await J.from("entregas_reciclaveis").select("peso_validado").eq("id_usuario",r.id).eq("status","validada");if(H){const Z=H.reduce((G,Q)=>G+(Q.peso_validado||0),0);x(Z)}},M=H=>H<=500?{proximoNivel:"Protetor Ciclik",pontosRestantes:501-H,metaAtual:500}:H<=1e3?{proximoNivel:"Guardio Ciclik",pontosRestantes:1001-H,metaAtual:1e3}:{proximoNivel:"Nvel Mximo",pontosRestantes:0,metaAtual:1001},z=H=>{switch(H){case"Iniciante":return"Embaixador Ciclik";case"Ativo":return"Protetor Ciclik";case"Guardiao Verde":return"Guardio Ciclik";default:return H}},q=H=>{switch(H){case"Iniciante":return"bg-muted text-muted-foreground";case"Ativo":return"bg-success/20 text-success";case"Guardiao Verde":return"bg-primary/20 text-primary";default:return"bg-muted text-muted-foreground"}},Y=({userId:H,userCity:Z,userState:G})=>{const[Q,re]=E.useState(!1),[le,ye]=E.useState(!1);E.useEffect(()=>{(async()=>{if(!H)return;const{data:ie}=await J.from("interesses_funcionalidades").select("id").eq("id_usuario",H).eq("funcionalidade","nota_fiscal").maybeSingle();ye(!!ie)})()},[H]);const W=async ee=>{if(ee.preventDefault(),ee.stopPropagation(),!(Q||le)){re(!0);try{const{error:ie}=await J.from("interesses_funcionalidades").insert({id_usuario:H||null,funcionalidade:"nota_fiscal",estado:G||null,cidade:Z||null});if(ie)throw ie;ye(!0),ct.success("Interesse registrado! Obrigado pelo feedback.")}catch(ie){console.error("Erro ao registrar interesse:",ie),ct.error("Erro ao registrar interesse")}finally{re(!1)}}};return s.jsxs("div",{className:"text-xs space-y-1.5",children:[s.jsx("p",{className:"font-medium",children:" Disponvel apenas na Bahia"}),le?s.jsx("p",{className:"text-primary",children:" Interesse registrado!"}):s.jsx("button",{onClick:W,disabled:Q,className:"text-primary underline hover:text-primary/80 transition-colors",children:Q?"Registrando...":"Clique aqui se deseja no seu estado"})]})},ae=({userId:H,userCity:Z,userState:G})=>{const[Q,re]=E.useState(!1),[le,ye]=E.useState(!1);E.useEffect(()=>{(async()=>{if(!H)return;const{data:ie}=await J.from("interesses_funcionalidades").select("id").eq("id_usuario",H).eq("funcionalidade","entrega_reciclaveis").maybeSingle();ye(!!ie)})()},[H]);const W=async ee=>{if(ee.preventDefault(),ee.stopPropagation(),!(Q||le)){re(!0);try{const{error:ie}=await J.from("interesses_funcionalidades").insert({id_usuario:H||null,funcionalidade:"entrega_reciclaveis",estado:G||null,cidade:Z||null});if(ie)throw ie;ye(!0),ct.success("Interesse registrado! Obrigado pelo feedback.")}catch(ie){console.error("Erro ao registrar interesse:",ie),ct.error("Erro ao registrar interesse")}finally{re(!1)}}};return s.jsxs("div",{className:"text-xs space-y-1.5",children:[s.jsx("p",{className:"font-medium",children:" Disponvel apenas em Salvador/BA"}),le?s.jsx("p",{className:"text-primary",children:" Interesse registrado!"}):s.jsx("button",{onClick:W,disabled:Q,className:"text-primary underline hover:text-primary/80 transition-colors",children:Q?"Registrando...":"Clique aqui se deseja na sua cidade"})]})};if(!e)return null;const je=[{icon:g4,label:"Incio",path:"/user",active:n.pathname==="/user"},{icon:Xa,label:"Educao",path:"/missions",active:n.pathname==="/missions"},{icon:Ur,label:"Entregar",path:"/select-materials",active:n.pathname==="/select-materials"},{icon:Jn,label:"Cupons",path:"/redeem-coupons",active:n.pathname==="/redeem-coupons"}];return s.jsxs(Nc,{children:[s.jsx(e_,{steps:B,run:A,onComplete:O,onSkip:O}),s.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[s.jsx("div",{className:"bg-white border-b border-border sticky top-0 z-40 shadow-sm",children:s.jsx("div",{className:"mx-auto max-w-6xl px-4 py-3 md:py-4",children:s.jsxs("div",{className:"flex items-center justify-between gap-4 tour-profile",children:[s.jsxs("div",{className:"flex items-start gap-3 md:gap-4 flex-1 min-w-0",children:[s.jsx("img",{src:Sa("ciclik-logo-full.png"),alt:"Ciclik - Recicle e Ganhe",className:"h-12 md:h-16 w-auto object-contain flex-shrink-0 cursor-pointer",onClick:()=>a("/user")}),s.jsxs("div",{className:"flex flex-col justify-center cursor-pointer",onClick:()=>a("/profile"),children:[s.jsxs("h1",{className:"text-base md:text-xl font-bold text-foreground whitespace-nowrap",children:["Ol, ",e.nome.split(" ")[0],"!"]}),s.jsx("p",{className:"text-xs md:text-sm text-muted-foreground whitespace-nowrap",children:"Bem-vindo ao Ciclik"})]})]}),s.jsxs(pk,{children:[s.jsx(xk,{asChild:!0,children:s.jsx(oe,{variant:"ghost",size:"icon",className:"rounded-full h-9 w-9 md:h-10 md:w-10 flex-shrink-0",children:s.jsx(Lw,{className:"h-5 w-5"})})}),s.jsxs($b,{side:"right",className:"w-[280px]",children:[s.jsx(qb,{className:"text-left",children:s.jsx(Wb,{className:"text-foreground",children:"Menu"})}),s.jsxs("div",{className:"mt-6 space-y-1",children:[s.jsxs("div",{className:"px-3 py-2 rounded-lg bg-muted/50",children:[s.jsx("p",{className:"text-sm font-semibold text-foreground",children:e.nome}),s.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:e.email})]}),s.jsx(al,{className:"my-3"}),s.jsxs(oe,{variant:"ghost",className:"w-full justify-start gap-3 h-11",onClick:()=>a("/notifications"),children:[s.jsx(Dw,{className:"h-5 w-5"}),s.jsx("span",{children:"Notificaes"})]}),s.jsxs(oe,{variant:"ghost",className:"w-full justify-start gap-3 h-11",onClick:()=>a("/profile"),children:[s.jsx(Ri,{className:"h-5 w-5"}),s.jsx("span",{children:"Meu Perfil"})]}),s.jsxs(oe,{variant:"ghost",className:"w-full justify-start gap-3 h-11",onClick:I,children:[s.jsx(Yi,{className:"h-5 w-5"}),s.jsx("span",{children:"Ver Tour Guiado"})]}),s.jsx(al,{className:"my-3"}),s.jsxs(oe,{variant:"ghost",className:"w-full justify-start gap-3 h-11 text-destructive hover:text-destructive hover:bg-destructive/10",onClick:t,children:[s.jsx(gc,{className:"h-5 w-5"}),s.jsx("span",{children:"Sair"})]})]})]})]})]})})}),s.jsxs("div",{className:"mx-auto max-w-lg px-4 pt-4 space-y-4",children:[s.jsx(Ee.div,{variants:H0,initial:"initial",animate:"animate",transition:{duration:.4},children:s.jsx(Ne,{className:"tour-score-card overflow-hidden border-0 shadow-lg rounded-3xl bg-gradient-to-br from-card via-card to-primary/5",children:s.jsxs(De,{className:"p-5",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(cr,{className:"h-4 w-4 text-primary"}),s.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Pontos Verdes"})]}),s.jsx(Ee.p,{className:"text-4xl font-bold text-foreground",initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2,type:"spring",stiffness:200},children:i.toLocaleString("pt-BR")})]}),s.jsx(Je,{className:`${q(e.nivel)} text-xs px-3 py-1 rounded-full font-medium`,children:z(e.nivel)})]}),s.jsxs(Ee.button,{onClick:()=>a("/points-statement"),className:"flex items-center gap-1 text-xs text-primary font-medium mb-4",whileTap:{scale:.95},children:["Ver extrato completo",s.jsx(Xi,{className:"h-3.5 w-3.5"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsx("span",{className:"text-muted-foreground",children:"Progresso mensal"}),s.jsxs("span",{className:"font-medium text-primary",children:[i," pts"]})]}),s.jsx(fn,{value:d,className:"h-2 rounded-full"}),i<=1e3&&s.jsxs("p",{className:"text-[10px] text-muted-foreground text-right",children:["Prximo: ",M(i).pontosRestantes," pontos para atingir o prximo nvel"]})]}),s.jsx(Ee.div,{className:"grid grid-cols-3 gap-3 mt-4 pt-4 border-t border-border/50 tour-stats",variants:HX,initial:"initial",animate:"animate",children:[{value:e.missoes_concluidas,label:"Aulas",icon:Xa},{value:e.cupons_resgatados,label:"Cupons",icon:Jn},{value:`${Br(p,2)} kg`,label:"Reciclados",icon:Ur}].map((H,Z)=>s.jsxs(Ee.div,{className:"text-center",variants:GX,transition:{delay:Z*.1},children:[s.jsx(H.icon,{className:"h-4 w-4 mx-auto mb-1 text-primary/70"}),s.jsx("p",{className:"text-lg font-bold text-foreground",children:H.value}),s.jsx("p",{className:"text-[10px] text-muted-foreground",children:H.label})]},H.label))})]})})}),s.jsx(Ee.div,{className:"tour-quick-actions",variants:H0,initial:"initial",animate:"animate",transition:{delay:.1},children:s.jsxs("div",{className:"flex justify-between items-start px-2",children:[s.jsx(wm,{icon:Xa,label:"Educao",onClick:()=>a("/missions"),tourClass:"tour-missions",bgColor:"bg-amber-500/10",iconColor:"text-amber-500",tooltipContent:s.jsx("p",{className:"text-xs font-medium",children:" Disponvel em todo o Brasil"})}),s.jsx(wm,{icon:Qa,label:"Nota Fiscal",onClick:()=>a("/upload-receipt"),bgColor:"bg-blue-500/10",iconColor:"text-blue-500",tooltipContent:s.jsx(Y,{userId:r==null?void 0:r.id,userCity:e==null?void 0:e.cidade,userState:e==null?void 0:e.uf})}),s.jsx(wm,{icon:Ur,label:"Entregar",onClick:()=>a("/select-materials"),tourClass:"tour-deliver",bgColor:"bg-primary/10",iconColor:"text-primary",tooltipContent:s.jsx(ae,{userId:r==null?void 0:r.id,userCity:e==null?void 0:e.cidade,userState:e==null?void 0:e.uf})}),s.jsx(wm,{icon:Jn,label:"Cupons",onClick:()=>a("/redeem-coupons"),tourClass:"tour-coupons",bgColor:"bg-pink-500/10",iconColor:"text-pink-500",tooltipContent:s.jsx("p",{className:"text-xs font-medium",children:" Disponvel em todo o Brasil"})}),s.jsx(wm,{icon:Ir,label:"Histrico",onClick:()=>a("/delivery-history"),bgColor:"bg-purple-500/10",iconColor:"text-purple-500",tooltipContent:s.jsx("p",{className:"text-xs font-medium",children:" Disponvel em todo o Brasil"})})]})}),s.jsx(Ee.div,{variants:H0,initial:"initial",animate:"animate",transition:{delay:.15},children:s.jsx(VX,{})}),s.jsxs(Ee.div,{className:"space-y-3",variants:H0,initial:"initial",animate:"animate",transition:{delay:.2},children:[s.jsx(vx,{open:v,onOpenChange:b,children:s.jsxs(Ne,{className:"rounded-2xl border-0 shadow-sm overflow-hidden",children:[s.jsx(yx,{className:"w-full",children:s.jsxs("div",{className:"flex items-center justify-between p-4 hover:bg-muted/50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center",children:s.jsx(Ur,{className:"h-4 w-4 text-primary"})}),s.jsx("span",{className:"font-medium text-sm",children:"Entregas Pendentes"})]}),s.jsx(Ee.div,{animate:{rotate:v?90:0},transition:{duration:.2},children:s.jsx(Xi,{className:"h-4 w-4 text-muted-foreground"})})]})}),s.jsx(wx,{children:s.jsx(Qi,{children:v&&s.jsx(Ee.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"px-4 pb-4",children:s.jsx(MX,{})})})})]})}),s.jsx(vx,{open:N,onOpenChange:_,children:s.jsxs(Ne,{className:"rounded-2xl border-0 shadow-sm overflow-hidden",children:[s.jsx(yx,{className:"w-full",children:s.jsxs("div",{className:"flex items-center justify-between p-4 hover:bg-muted/50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-500/10 flex items-center justify-center",children:s.jsx(Qa,{className:"h-4 w-4 text-blue-500"})}),s.jsx("span",{className:"font-medium text-sm",children:"Meus Materiais"})]}),s.jsx(Ee.div,{animate:{rotate:N?90:0},transition:{duration:.2},children:s.jsx(Xi,{className:"h-4 w-4 text-muted-foreground"})})]})}),s.jsx(wx,{children:s.jsx(Qi,{children:N&&s.jsx(Ee.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"px-4 pb-4",children:s.jsx(KK,{userId:(r==null?void 0:r.id)||""})})})})]})}),s.jsx(vx,{open:C,onOpenChange:T,children:s.jsxs(Ne,{className:"rounded-2xl border-0 shadow-sm overflow-hidden",children:[s.jsx(yx,{className:"w-full",children:s.jsxs("div",{className:"flex items-center justify-between p-4 hover:bg-muted/50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-emerald-500/10 flex items-center justify-center",children:s.jsx(cr,{className:"h-4 w-4 text-emerald-500"})}),s.jsx("span",{className:"font-medium text-sm",children:"Impacto Ambiental"})]}),s.jsx(Ee.div,{animate:{rotate:C?90:0},transition:{duration:.2},children:s.jsx(Xi,{className:"h-4 w-4 text-muted-foreground"})})]})}),s.jsx(wx,{children:s.jsx(Qi,{children:C&&s.jsx(Ee.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"px-4 pb-4",children:s.jsx(HK,{})})})})]})})]})]}),s.jsx(Ee.div,{className:"fixed bottom-0 left-0 right-0 bg-card/95 backdrop-blur-lg border-t border-border/50 shadow-2xl z-50",initial:{y:100},animate:{y:0},transition:{delay:.3,type:"spring",stiffness:300,damping:30},children:s.jsx("div",{className:"flex justify-around items-center max-w-lg mx-auto py-2 px-4",children:je.map(H=>s.jsxs(Ee.button,{onClick:()=>a(H.path),className:`flex flex-col items-center gap-0.5 py-2 px-4 rounded-xl transition-colors ${H.active?"text-primary":"text-muted-foreground"}`,whileTap:{scale:.9},children:[s.jsx(Ee.div,{animate:H.active?{scale:[1,1.2,1]}:{},transition:{duration:.3},children:s.jsx(H.icon,{className:`h-5 w-5 ${H.active?"text-primary":""}`})}),s.jsx("span",{className:"text-[10px] font-medium",children:H.label}),H.active&&s.jsx(Ee.div,{layoutId:"activeIndicator",className:"absolute -bottom-0.5 w-1 h-1 rounded-full bg-primary",transition:{type:"spring",stiffness:500,damping:30}})]},H.path))})})]})]})}function Rd({showBackButton:e=!1,backTo:t="/user",title:r,showUserActions:a=!0}){const n=ds(),{profile:i,signOut:o}=sr(),c=(i==null?void 0:i.nome.split(" ")[0])||"";return s.jsx("div",{className:"bg-card border-b border-border sticky top-0 z-40 shadow-sm",children:s.jsx("div",{className:"mx-auto max-w-6xl px-4 py-3 md:py-4",children:s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2 md:gap-3 flex-shrink-0",children:[e&&s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>n(t),className:"flex-shrink-0",children:s.jsx(As,{className:"h-5 w-5"})}),s.jsx("img",{src:Sa("ciclik-logo-full.png"),alt:"Ciclik - Recicle e Ganhe",className:"h-10 md:h-12 w-auto object-contain cursor-pointer",onClick:()=>n("/user")})]}),!r&&i&&s.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center px-2 min-w-0",children:[s.jsxs("h1",{className:"text-sm md:text-lg font-bold text-foreground whitespace-nowrap",children:["Ol, ",c,"!"]}),s.jsx("p",{className:"text-xs text-muted-foreground whitespace-nowrap hidden md:block",children:"Bem-vindo ao Ciclik"})]}),r&&s.jsx("div",{className:"flex-1 flex items-center justify-center px-2 min-w-0",children:s.jsx("h1",{className:"text-sm md:text-lg font-bold text-foreground truncate",children:r})}),a&&s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs(pk,{children:[s.jsx(xk,{asChild:!0,children:s.jsx(oe,{variant:"ghost",size:"icon",className:"flex-shrink-0",children:s.jsx(Lw,{className:"h-5 w-5"})})}),s.jsxs($b,{side:"right",className:"w-[280px]",children:[s.jsx(qb,{className:"text-left",children:s.jsx(Wb,{className:"text-foreground",children:"Menu"})}),s.jsxs("div",{className:"mt-6 space-y-1",children:[i&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"px-3 py-2 rounded-lg bg-muted/50",children:[s.jsx("p",{className:"text-sm font-semibold text-foreground",children:i.nome}),s.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:i.email})]}),s.jsx(al,{className:"my-3"})]}),s.jsxs(oe,{variant:"ghost",className:"w-full justify-start gap-3 h-11",onClick:()=>n("/notifications"),children:[s.jsx(Dw,{className:"h-5 w-5"}),s.jsx("span",{children:"Notificaes"})]}),s.jsxs(oe,{variant:"ghost",className:"w-full justify-start gap-3 h-11",onClick:()=>n("/profile"),children:[s.jsx(Ri,{className:"h-5 w-5"}),s.jsx("span",{children:"Meu Perfil"})]}),s.jsx(al,{className:"my-3"}),s.jsxs(oe,{variant:"ghost",className:"w-full justify-start gap-3 h-11 text-destructive hover:text-destructive hover:bg-destructive/10",onClick:o,children:[s.jsx(gc,{className:"h-5 w-5"}),s.jsx("span",{children:"Sair"})]})]})]})]})})]})})})}const XX=e=>{switch(e){case"quiz":return s.jsx(Yi,{className:"h-5 w-5 text-primary"});case"estudo":return s.jsx(Sx,{className:"h-5 w-5 text-primary"});default:return s.jsx(sp,{className:"h-5 w-5 text-primary"})}},YX=e=>{switch(e){case"quiz":return"Quiz";case"estudo":return"Vdeo Educativo";default:return e}};function ZX(){const{user:e,profile:t,refreshProfile:r}=sr(),[a,n]=E.useState([]),[i,o]=E.useState(new Set),c=ds();_r(),E.useEffect(()=>{d(),h()},[e]);const d=async()=>{const{data:x}=await J.from("missoes").select("*").eq("status","ativa").order("ordem",{ascending:!0});x&&n(x)},h=async()=>{if(!e)return;const{data:x}=await J.from("missoes_usuarios").select("id_missao").eq("id_usuario",e.id);x&&o(new Set(x.map(v=>v.id_missao)))},p=x=>{c(`/mission/content/${x.id}`)};return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(Rd,{showBackButton:!0,backTo:"/user"}),s.jsxs("div",{className:"mx-auto max-w-6xl p-4 md:p-8 space-y-8",children:[s.jsxs(Ee.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center",children:[s.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"Central de Educao"}),s.jsx("p",{className:"text-muted-foreground mt-2",children:"Aprenda, jogue e ganhe pontos verdes"})]}),t&&s.jsx(Ee.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.1},children:s.jsx(Ne,{className:"bg-gradient-to-br from-primary/20 via-primary/10 to-accent/20 border-primary/20 shadow-lg",children:s.jsx(De,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[s.jsx(Qn,{className:"h-4 w-4"}),"Aulas Concludas"]}),s.jsx("p",{className:"text-4xl font-bold text-primary",children:t.missoes_concluidas}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[a.length-i.size," aulas disponveis"]})]}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 bg-primary/20 blur-xl rounded-full"}),s.jsx(wo,{className:"h-16 w-16 text-primary relative animate-pulse"})]})]})})})}),s.jsxs("div",{className:"space-y-4",children:[a.map(x=>{const v=i.has(x.id);return s.jsx(Ne,{className:`cursor-pointer transition-all hover:shadow-lg ${v?"border-success/20":"hover:scale-[1.02]"}`,onClick:()=>p(x),children:s.jsx(Ye,{children:s.jsx("div",{className:"flex items-start justify-between gap-4",children:s.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[s.jsx("div",{className:`rounded-lg p-2 ${v?"bg-success/20":"bg-primary/10"}`,children:v?s.jsx(Tr,{className:"h-5 w-5 text-success"}):XX(x.tipo)}),s.jsxs("div",{className:"flex-1",children:[s.jsxs(Qe,{className:"flex items-center gap-2",children:[x.titulo,v&&s.jsx(Je,{variant:"outline",className:"bg-success/10 text-success border-success",children:" Completada - Clique para revisar"})]}),s.jsxs(Tt,{className:"mt-1",children:[x.descricao,v&&s.jsx("span",{className:"block mt-2 text-xs text-success",children:" Voc pode assistir o vdeo novamente para revisar o contedo"})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[s.jsx(Je,{variant:"secondary",children:YX(x.tipo)}),!v&&s.jsxs(Je,{className:"bg-primary/10 text-primary hover:bg-primary/20",children:["+",x.pontos," pontos"]}),v&&s.jsx(Je,{className:"bg-success/10 text-success hover:bg-success/20",children:"Pontos j ganhos"})]})]})]})})})},x.id)}),a.length===0&&s.jsx(Ne,{children:s.jsxs(De,{className:"py-12 text-center",children:[s.jsx(wo,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Nenhuma aula disponvel no momento"})]})})]})]})]})}function VR(e){if(!e)return"";try{if(e.includes("/embed/"))return e;let t="";return e.includes("youtu.be/")?t=e.split("youtu.be/")[1].split("?")[0]:e.includes("watch?v=")?t=e.split("watch?v=")[1].split("&")[0]:e.includes("/v/")&&(t=e.split("/v/")[1].split("?")[0]),t?`https://www.youtube.com/embed/${t}`:e}catch(t){return console.error("Erro ao processar URL do YouTube:",t),e}}function QX(){const{id:e}=To(),{user:t,profile:r,refreshProfile:a}=sr(),[n,i]=E.useState(null),o=ds(),{toast:c}=_r();E.useEffect(()=>{d()},[e]);const d=async()=>{const{data:p}=await J.from("missoes").select("*").eq("id",e).single();p&&i(p)},h=async()=>{if(!(!t||!n))try{const{error:p}=await J.from("missoes_usuarios").insert({id_usuario:t.id,id_missao:n.id});if(p)throw p;const{error:x}=await J.from("profiles").update({score_verde:((r==null?void 0:r.score_verde)||0)+n.pontos,missoes_concluidas:((r==null?void 0:r.missoes_concluidas)||0)+1}).eq("id",t.id);if(x)throw x;const{error:v}=await J.from("estoque_educacao").insert({id_usuario:t.id,id_missao:n.id,minutos_assistidos:n.duracao_minutos||10,modulo:n.titulo,data:new Date().toISOString(),status:"disponivel"});v&&console.error("Erro ao registrar educao no estoque CDV:",v),await a(),c({title:"Misso concluda!",description:`Voc ganhou ${n.pontos} pontos verdes!`}),o("/missions")}catch(p){c({title:"Erro",description:p.message||"No foi possvel concluir a misso",variant:"destructive"})}};return n?s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-8",children:s.jsxs("div",{className:"mx-auto max-w-4xl space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>o("/missions"),children:s.jsx(As,{className:"h-5 w-5"})}),s.jsx("h1",{className:"text-3xl font-bold",children:n.titulo})]}),s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsx(Qe,{children:"Assista ao vdeo"})}),s.jsxs(De,{className:"space-y-6",children:[s.jsx("div",{className:"aspect-video rounded-lg overflow-hidden bg-muted",children:n.video_url?s.jsx("iframe",{src:VR(n.video_url),className:"w-full h-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,title:n.titulo}):s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsx("p",{className:"text-muted-foreground",children:"Vdeo no disponvel"})})}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-muted-foreground",children:n.descricao}),s.jsxs(oe,{onClick:h,className:"w-full",size:"lg",children:[s.jsx(Tr,{className:"mr-2 h-5 w-5"}),"Concluir Misso (+",n.pontos," pontos)"]})]})]})]})]})}):null}var y_="Radio",[JX,UR]=bi(y_),[eY,tY]=JX(y_),zR=E.forwardRef((e,t)=>{const{__scopeRadio:r,name:a,checked:n=!1,required:i,disabled:o,value:c="on",onCheck:d,form:h,...p}=e,[x,v]=E.useState(null),b=br(t,C=>v(C)),N=E.useRef(!1),_=x?h||!!x.closest("form"):!0;return s.jsxs(eY,{scope:r,checked:n,disabled:o,children:[s.jsx(ys.button,{type:"button",role:"radio","aria-checked":n,"data-state":HR(n),"data-disabled":o?"":void 0,disabled:o,value:c,...p,ref:b,onClick:Ts(e.onClick,C=>{n||d==null||d(),_&&(N.current=C.isPropagationStopped(),N.current||C.stopPropagation())})}),_&&s.jsx(WR,{control:x,bubbles:!N.current,name:a,value:c,checked:n,required:i,disabled:o,form:h,style:{transform:"translateX(-100%)"}})]})});zR.displayName=y_;var $R="RadioIndicator",qR=E.forwardRef((e,t)=>{const{__scopeRadio:r,forceMount:a,...n}=e,i=tY($R,r);return s.jsx(il,{present:a||i.checked,children:s.jsx(ys.span,{"data-state":HR(i.checked),"data-disabled":i.disabled?"":void 0,...n,ref:t})})});qR.displayName=$R;var sY="RadioBubbleInput",WR=E.forwardRef(({__scopeRadio:e,control:t,checked:r,bubbles:a=!0,...n},i)=>{const o=E.useRef(null),c=br(o,i),d=Gp(r),h=_g(t);return E.useEffect(()=>{const p=o.current;if(!p)return;const x=window.HTMLInputElement.prototype,b=Object.getOwnPropertyDescriptor(x,"checked").set;if(d!==r&&b){const N=new Event("click",{bubbles:a});b.call(p,r),p.dispatchEvent(N)}},[d,r,a]),s.jsx(ys.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...n,tabIndex:-1,ref:c,style:{...n.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});WR.displayName=sY;function HR(e){return e?"checked":"unchecked"}var rY=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Gg="RadioGroup",[aY,Wue]=bi(Gg,[wg,UR]),GR=wg(),KR=UR(),[nY,iY]=aY(Gg),XR=E.forwardRef((e,t)=>{const{__scopeRadioGroup:r,name:a,defaultValue:n,value:i,required:o=!1,disabled:c=!1,orientation:d,dir:h,loop:p=!0,onValueChange:x,...v}=e,b=GR(r),N=Af(h),[_,C]=No({prop:i,defaultProp:n??null,onChange:x,caller:Gg});return s.jsx(nY,{scope:r,name:a,required:o,disabled:c,value:_,onValueChange:C,children:s.jsx(qS,{asChild:!0,...b,orientation:d,dir:N,loop:p,children:s.jsx(ys.div,{role:"radiogroup","aria-required":o,"aria-orientation":d,"data-disabled":c?"":void 0,dir:N,...v,ref:t})})})});XR.displayName=Gg;var YR="RadioGroupItem",ZR=E.forwardRef((e,t)=>{const{__scopeRadioGroup:r,disabled:a,...n}=e,i=iY(YR,r),o=i.disabled||a,c=GR(r),d=KR(r),h=E.useRef(null),p=br(t,h),x=i.value===n.value,v=E.useRef(!1);return E.useEffect(()=>{const b=_=>{rY.includes(_.key)&&(v.current=!0)},N=()=>v.current=!1;return document.addEventListener("keydown",b),document.addEventListener("keyup",N),()=>{document.removeEventListener("keydown",b),document.removeEventListener("keyup",N)}},[]),s.jsx(WS,{asChild:!0,...c,focusable:!o,active:x,children:s.jsx(zR,{disabled:o,required:i.required,checked:x,...d,...n,name:i.name,ref:p,onCheck:()=>i.onValueChange(n.value),onKeyDown:Ts(b=>{b.key==="Enter"&&b.preventDefault()}),onFocus:Ts(n.onFocus,()=>{var b;v.current&&((b=h.current)==null||b.click())})})})});ZR.displayName=YR;var oY="RadioGroupIndicator",QR=E.forwardRef((e,t)=>{const{__scopeRadioGroup:r,...a}=e,n=KR(r);return s.jsx(qR,{...n,...a,ref:t})});QR.displayName=oY;var JR=XR,eP=ZR,lY=QR;const w_=E.forwardRef(({className:e,...t},r)=>s.jsx(JR,{className:pt("grid gap-2",e),...t,ref:r}));w_.displayName=JR.displayName;const b_=E.forwardRef(({className:e,...t},r)=>s.jsx(eP,{ref:r,className:pt("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:s.jsx(lY,{className:"flex items-center justify-center",children:s.jsx(p4,{className:"h-2.5 w-2.5 fill-current text-current"})})}));b_.displayName=eP.displayName;function cY(){const{id:e}=To(),{user:t,profile:r,refreshProfile:a}=sr(),[n,i]=E.useState(null),[o,c]=E.useState(""),[d,h]=E.useState(!1),[p,x]=E.useState(!1),v=ds(),{toast:b}=_r();E.useEffect(()=>{N()},[e]);const N=async()=>{const{data:C}=await J.from("missoes").select("*").eq("id",e).single();C&&i(C)},_=async()=>{if(!o||!n)return;const C=o===n.resposta_correta;if(x(C),h(!0),C)try{const{error:T}=await J.from("missoes_usuarios").insert({id_usuario:t==null?void 0:t.id,id_missao:n.id});if(T)throw T;const{error:A}=await J.from("profiles").update({score_verde:((r==null?void 0:r.score_verde)||0)+n.pontos,missoes_concluidas:((r==null?void 0:r.missoes_concluidas)||0)+1}).eq("id",t==null?void 0:t.id);if(A)throw A;await a(),b({title:"Resposta correta!",description:`Voc ganhou ${n.pontos} pontos verdes!`}),setTimeout(()=>v("/missions"),2e3)}catch(T){b({title:"Erro",description:T.message,variant:"destructive"})}else b({title:"Resposta incorreta",description:"Tente novamente!",variant:"destructive"})};return n?s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-8",children:s.jsxs("div",{className:"mx-auto max-w-4xl space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>v("/missions"),children:s.jsx(As,{className:"h-5 w-5"})}),s.jsx("h1",{className:"text-3xl font-bold",children:n.titulo})]}),s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsx(Qe,{children:n.pergunta})}),s.jsxs(De,{className:"space-y-6",children:[s.jsx(w_,{value:o,onValueChange:c,children:s.jsx("div",{className:"space-y-3",children:["A","B","C","D"].map(C=>{const T=n[`alternativa_${C.toLowerCase()}`];return T?s.jsxs("div",{className:"flex items-center space-x-2 border rounded-lg p-4 cursor-pointer hover:bg-muted/50",children:[s.jsx(b_,{value:C,id:C}),s.jsxs(ke,{htmlFor:C,className:"flex-1 cursor-pointer",children:[s.jsxs("span",{className:"font-semibold",children:[C,")"]})," ",T]})]},C):null})})}),d&&s.jsx(Ne,{className:p?"border-success bg-success/5":"border-destructive bg-destructive/5",children:s.jsx(De,{className:"pt-6",children:s.jsx("div",{className:"flex items-center gap-3",children:p?s.jsxs(s.Fragment,{children:[s.jsx(Tr,{className:"h-6 w-6 text-success"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-success",children:"Correto!"}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Parabns! Voc ganhou ",n.pontos," pontos."]})]})]}):s.jsxs(s.Fragment,{children:[s.jsx(Va,{className:"h-6 w-6 text-destructive"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-destructive",children:"Incorreto"}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["A resposta correta : ",n.resposta_correta]})]})]})})})}),s.jsx(oe,{onClick:_,className:"w-full",size:"lg",disabled:!o||d,children:"Confirmar Resposta"})]})]})]})}):null}const dY=Pf("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Er=E.forwardRef(({className:e,variant:t,...r},a)=>s.jsx("div",{ref:a,role:"alert",className:pt(dY({variant:t}),e),...r}));Er.displayName="Alert";const tP=E.forwardRef(({className:e,...t},r)=>s.jsx("h5",{ref:r,className:pt("mb-1 font-medium leading-none tracking-tight",e),...t}));tP.displayName="AlertTitle";const Sr=E.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:pt("text-sm [&_p]:leading-relaxed",e),...t}));Sr.displayName="AlertDescription";const jn=E.forwardRef(({className:e,...t},r)=>s.jsx("textarea",{className:pt("flex min-h-[100px] w-full rounded-xl border border-input bg-background px-4 py-3","font-body text-base text-foreground","placeholder:text-muted-foreground","transition-all duration-200","focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary","disabled:cursor-not-allowed disabled:opacity-50","resize-none","md:text-sm",e),ref:r,...t}));jn.displayName="Textarea";function uY(e,t){var a,n;const{type:r}=e;switch(r){case"missao_concluida":return`Acabei de completar a misso "${e.titulo_missao}" no app Ciclik  Recicle e Ganhe, com mais de 80% de acerto.
Estou acumulando pontos verdes enquanto aprendo sobre sustentabilidade e consumo consciente.
#Ciclik #Sustentabilidade #EducaoAmbiental #RecicleEGanhe`;case"entrega_validada":return`Minha ltima entrega de reciclveis foi validada pela cooperativa parceira da Ciclik:
 Material: ${e.tipo_material}
 Peso validado: ${(a=e.peso_validado)==null?void 0:a.toFixed(1)} kg
Cada entrega ajuda a fortalecer a reciclagem e a gerar impacto socioambiental real.
#Ciclik #Reciclagem #ImpactoPositivo #RecicleEGanhe`;case"cupom_resgatado":return`Acabei de resgatar um cupom de R$ ${e.valor_cupom} no app Ciclik  Recicle e Ganhe, estudando sobre sustentabilidade, enviando notas fiscais e entregando reciclveis.
Aprendo, gero impacto e ainda ganho benefcios.
#Ciclik #ConsumoConsciente #RecompensaVerde #RecicleEGanhe`;case"progresso_geral":return`J acumulei ${e.score_verde} pontos verdes na Ciclik, concluindo ${e.missoes_concluidas} misses e entregando ${(n=e.peso_total_entregue)==null?void 0:n.toFixed(1)} kg de reciclveis.
Pequenas aes, grandes impactos.
#Ciclik #ESG #MeuImpactoVerde #RecicleEGanhe`;default:return"Compartilhando minha conquista no Ciclik  Recicle e Ganhe! #Ciclik #Sustentabilidade"}}async function hY(e){try{return await navigator.clipboard.writeText(e),!0}catch(t){return console.error("Erro ao copiar texto:",t),!1}}function fY(){window.open("https://www.linkedin.com","_blank")}function mY(){window.open("https://www.instagram.com/accounts/login/","_blank")}async function pY(e,t,r){return new Promise((a,n)=>{const i=document.createElement("canvas"),o=i.getContext("2d");if(!o){n(new Error("No foi possvel criar o contexto do canvas"));return}i.width=1080,i.height=1080,o.fillStyle="#FFFFFF",o.fillRect(0,0,i.width,i.height);const c=new Image;c.crossOrigin="anonymous",c.src=Sa("ciclik-logo-full.png"),c.onload=()=>{const h=c.height/c.width*350,p=(i.width-350)/2;o.drawImage(c,p,80,350,h),o.strokeStyle="#8BC34A",o.lineWidth=8,o.strokeRect(40,40,i.width-80,i.height-80),o.fillStyle="#333333",o.font="bold 46px Arial, sans-serif",o.textAlign="center",o.fillText(" CONQUISTA DESBLOQUEADA",i.width/2,350),o.fillStyle="#8BC34A",o.font="bold 52px Arial, sans-serif";const v=i.width-160,b=e.split(" ");let N="",_=440;const C=60,T=[];b.forEach(O=>{const D=N+O+" ";o.measureText(D).width>v&&N!==""?(T.push(N.trim()),N=O+" "):N=D}),N.trim()&&T.push(N.trim()),T.forEach((O,D)=>{o.fillText(O,i.width/2,_+D*C)});const A=i.height-210,k=i.height-170,I=i.height-110,B=i.height-70;r&&(o.fillStyle="#666666",o.font="bold 30px Arial, sans-serif",o.fillText(r,i.width/2,A)),o.fillStyle="#FFA726",o.font="bold 44px Arial, sans-serif",o.fillText(`NVEL: ${t.toUpperCase()}`,i.width/2,k),o.fillStyle="#999999",o.font="26px Arial, sans-serif",o.fillText("Ciclik - Recicle e Ganhe",i.width/2,I),o.font="22px Arial, sans-serif",o.fillText("#Ciclik #Sustentabilidade #RecicleEGanhe",i.width/2,B),a(i.toDataURL("image/png"))},c.onerror=()=>{n(new Error("Erro ao carregar a logo"))}})}function xY(e,t){const r=document.createElement("a");r.href=e,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r)}function gY({open:e,onOpenChange:t,platform:r,shareText:a,title:n,conquistaTitulo:i="Misso Concluda"}){const[o,c]=E.useState(!1),[d,h]=E.useState(null),[p,x]=E.useState(!1),{toast:v}=_r(),{profile:b}=sr();E.useEffect(()=>{e&&h(null)},[e]);const N=async()=>{if(!(d||!b)){x(!0);try{const I=b.nome.split(" ")[0],B=await pY(i,b.nivel||"Iniciante",I);h(B)}catch(I){console.error("Erro ao gerar imagem:",I),v({title:"Erro ao gerar imagem",description:"Tente novamente",variant:"destructive"})}finally{x(!1)}}},_=async()=>{await hY(a)?(c(!0),v({title:"Texto copiado!",description:"Cole o texto ao criar seu post"}),setTimeout(()=>c(!1),2e3)):v({title:"Erro ao copiar",description:"Tente novamente",variant:"destructive"})},C=()=>{r==="linkedin"?fY():mY(),v({title:`Abrindo ${r==="linkedin"?"LinkedIn":"Instagram"}`,description:"Cole o texto copiado ao criar seu post"})},T=async()=>{if(!d){await N();return}xY(d,`ciclik-conquista-${Date.now()}.png`),v({title:"Imagem baixada!",description:`Use a imagem ao criar seu post no ${A}`})},A=r==="linkedin"?"LinkedIn":"Instagram",k=r==="linkedin"?"bg-[#0A66C2]":"bg-gradient-to-br from-[#833AB4] via-[#FD1D1D] to-[#F77737]";return s.jsx(ar,{open:e,onOpenChange:t,children:s.jsxs(tr,{className:"sm:max-w-[540px] max-h-[90vh] overflow-y-auto bg-card border-border shadow-lg",children:[s.jsxs(nr,{className:"space-y-3 pb-2 sticky top-0 bg-card z-10 border-b border-border/50 mb-4",children:[s.jsxs(ir,{className:"flex items-center gap-3 text-xl",children:[s.jsx("div",{className:`h-10 w-10 rounded-xl ${k} flex items-center justify-center shadow-md`,children:s.jsx(Nx,{className:"h-5 w-5 text-white"})}),s.jsx("span",{className:"text-foreground font-semibold",children:n||`Compartilhar no ${A}`})]}),s.jsx(Vr,{className:"text-muted-foreground",children:"Gere sua imagem personalizada e compartilhe sua conquista"})]}),s.jsxs("div",{className:"space-y-5 pb-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-semibold text-foreground",children:r==="instagram"?"Legenda sugerida":"Texto sugerido"}),s.jsx(jn,{value:a,readOnly:!0,className:"min-h-[140px] resize-none bg-muted/50 border-border text-foreground text-sm leading-relaxed"})]}),s.jsx(oe,{onClick:_,className:"w-full transition-all",variant:o?"secondary":"default",size:"lg",children:o?s.jsxs(s.Fragment,{children:[s.jsx(Ea,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"Texto Copiado!"})]}):s.jsxs(s.Fragment,{children:[s.jsx(ep,{className:"mr-2 h-4 w-4"}),s.jsxs("span",{children:["Copiar ",r==="instagram"?"Legenda":"Texto"]})]})}),s.jsx("div",{className:"space-y-4 pt-2",children:s.jsxs("div",{className:"border-t border-border pt-4",children:[s.jsx("h3",{className:"text-sm font-semibold text-foreground mb-3",children:"Imagem Personalizada"}),s.jsx(oe,{onClick:N,className:"w-full mb-4 shadow-sm",variant:d?"secondary":"default",disabled:p,size:"lg",children:p?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-primary-foreground border-t-transparent rounded-full mr-2"}),s.jsx("span",{children:"Gerando..."})]}):d?s.jsxs(s.Fragment,{children:[s.jsx(Ea,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"Imagem Gerada"})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"mr-2",children:""}),s.jsx("span",{children:"Gerar Imagem"})]})}),d&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"rounded-lg border border-border bg-card shadow-sm overflow-y-scroll max-h-[500px] scrollbar-thin scrollbar-thumb-primary scrollbar-track-muted",children:s.jsx("div",{className:"p-4",children:s.jsx("img",{src:d,alt:"Conquista Ciclik",className:"mx-auto w-full max-w-sm object-contain"})})}),s.jsxs(oe,{onClick:T,variant:"outline",size:"lg",className:"w-full shadow-sm",children:[s.jsx(Ua,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"Baixar Imagem"})]})]})]})}),s.jsxs(oe,{onClick:C,className:`w-full text-white shadow-md ${r==="linkedin"?"bg-[#0A66C2] hover:bg-[#0A66C2]/90":"bg-gradient-to-r from-[#833AB4] via-[#FD1D1D] to-[#F77737] hover:opacity-90"}`,size:"lg",children:[s.jsx(Nx,{className:"mr-2 h-4 w-4"}),s.jsxs("span",{children:["Abrir ",A]})]}),s.jsx("div",{className:"pt-2 border-t border-border",children:s.jsxs("p",{className:"text-xs text-center text-muted-foreground leading-relaxed",children:["Gere a imagem  Baixe  Copie o texto  Abra o ",A,"  Publique"]})})]})]})})}function __({shareData:e,nomeUsuario:t,className:r="",conquistaTitulo:a}){const[n,i]=E.useState(!1),[o,c]=E.useState("linkedin"),d=uY(e),h=p=>{c(p),i(!0)};return s.jsxs("div",{className:r,children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ex,{className:"h-4 w-4 text-muted-foreground"}),s.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Compartilhar conquista:"})]}),s.jsxs("div",{className:"flex gap-2 mt-2",children:[s.jsxs(oe,{onClick:()=>h("linkedin"),variant:"outline",className:"flex-1 bg-[#0A66C2]/10 hover:bg-[#0A66C2]/20 border-[#0A66C2]/30",children:[s.jsx("svg",{className:"mr-2 h-4 w-4",viewBox:"0 0 24 24",fill:"#0A66C2",children:s.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),"LinkedIn"]}),s.jsxs(oe,{onClick:()=>h("instagram"),variant:"outline",className:"flex-1 bg-gradient-to-r from-[#833AB4]/10 via-[#FD1D1D]/10 to-[#F77737]/10 hover:opacity-80",children:[s.jsxs("svg",{className:"mr-2 h-4 w-4",viewBox:"0 0 24 24",fill:"url(#instagram-gradient)",children:[s.jsx("defs",{children:s.jsxs("linearGradient",{id:"instagram-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[s.jsx("stop",{offset:"0%",stopColor:"#833AB4"}),s.jsx("stop",{offset:"50%",stopColor:"#FD1D1D"}),s.jsx("stop",{offset:"100%",stopColor:"#F77737"})]})}),s.jsx("path",{d:"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"})]}),"Instagram"]})]}),s.jsx(gY,{open:n,onOpenChange:i,platform:o,shareText:d,conquistaTitulo:a})]})}const ec=300;function vY(){const e=async r=>{try{const a=new Date,n=new Date(a.getFullYear(),a.getMonth(),1,0,0,0,0),{data:i,error:o}=await J.from("missoes_usuarios").select(`
          id_missao,
          missoes (
            pontos
          )
        `).eq("id_usuario",r).gte("data_conclusao",n.toISOString());if(o)return console.error("Erro ao verificar limite mensal:",o),{currentPoints:0,withinLimit:!0,remainingPoints:ec};const c=(i==null?void 0:i.reduce((p,x)=>{var b;const v=((b=x.missoes)==null?void 0:b.pontos)||0;return p+v},0))||0,d=c<ec,h=Math.max(0,ec-c);return{currentPoints:c,withinLimit:d,remainingPoints:h}}catch(a){return console.error("Erro ao verificar limite mensal:",a),{currentPoints:0,withinLimit:!0,remainingPoints:ec}}};return{checkMonthlyLimit:e,canEarnPoints:async(r,a)=>{try{const n=await e(r);if(n.currentPoints>=ec)return{canEarn:!1,pointsToEarn:0,message:`Voc atingiu o limite mensal de ${ec} pontos com educao. Continue aprendendo - suas aulas ainda contam para UIBs!`};const i=Math.min(a,n.remainingPoints);return i<a?{canEarn:!0,pointsToEarn:i,message:`Voc ganhou ${i} pontos (limite mensal de ${ec} quase atingido). Faltam ${ec-n.currentPoints-i} pontos para o limite.`}:{canEarn:!0,pointsToEarn:i,message:null}}catch(n){return console.error("Erro ao verificar possibilidade de ganhar pontos:",n),{canEarn:!0,pointsToEarn:a,message:null}}},MONTHLY_LIMIT:ec}}function yY(){const{id:e}=To(),{user:t,profile:r,refreshProfile:a}=sr(),[n,i]=E.useState(null),[o,c]=E.useState([]),[d,h]=E.useState("video"),[p,x]=E.useState(0),[v,b]=E.useState({}),[N,_]=E.useState(0),[C,T]=E.useState([]),[A,k]=E.useState(0),[I,B]=E.useState(!1),[O,D]=E.useState(!1),F=ds(),{toast:M}=_r(),{canEarnPoints:z,MONTHLY_LIMIT:q}=vY();E.useEffect(()=>{t&&Y()},[e,t]);const Y=async()=>{const{data:W,error:ee}=await J.from("missoes").select("*").eq("id",e).single(),{data:ie,error:ce}=await J.from("questoes_missao").select("*").eq("id_missao",e).order("ordem",{ascending:!0});if(W&&i(W),ie&&c(ie),t){const{data:xe,error:Ce}=await J.from("missoes_usuarios").select("*").eq("id_usuario",t.id).eq("id_missao",e).eq("quiz_completo",!0).gte("percentual_acerto",80).order("data_conclusao",{ascending:!1}).limit(1);if(xe&&xe.length>0?xe[0]:null){D(!0);const{data:fe,error:ve}=await J.from("respostas_quiz").select("*, questoes_missao(*)").eq("id_usuario",t.id).eq("id_missao",e);if(fe&&fe.length>0){const ne=fe.map(Be=>({question:Be.questoes_missao,userAnswer:Be.resposta_usuario,isCorrect:Be.correta})),Ie=fe.filter(Be=>Be.correta).length/fe.length*100;T(ne),_(Ie),k((W==null?void 0:W.pontos)||0),h("review")}}}},ae=()=>{if(d==="video"){if(O){M({title:"Misso j completada! ",description:"Voc j completou esta misso e ganhou os pontos. Continue assistindo para revisar o contedo!"});return}h("quiz")}},je=()=>{h("video"),M({title:"Revendo contedo ",description:"Voc pode assistir o vdeo quantas vezes quiser para revisar o contedo!"})},H=(W,ee)=>{b({...v,[W]:ee})},Z=()=>{p<o.length-1?x(p+1):G()},G=async()=>{if(!t||!n)return;let W=0;const ee=[],ie=[];for(const xe of o){const Ce=v[xe.id],me=Ce===xe.resposta_correta;me&&W++,ie.push({question:xe,userAnswer:Ce,isCorrect:me}),ee.push({id_usuario:t.id,id_missao:n.id,id_questao:xe.id,resposta_usuario:Ce,correta:me})}const ce=o.length>0?W/o.length*100:0;_(ce),T(ie),h("review");try{const{error:xe}=await J.from("respostas_quiz").delete().eq("id_usuario",t.id).eq("id_missao",n.id);xe&&console.warn("Aviso ao limpar respostas antigas:",xe);const{error:Ce}=await J.from("respostas_quiz").insert(ee);if(Ce)throw Ce;if(ce>=80){const me=await z(t.id,n.pontos);let fe=0;if(me.canEarn){fe=me.pointsToEarn;const{error:ve}=await J.from("missoes_usuarios").insert({id_usuario:t.id,id_missao:n.id,percentual_acerto:ce,quiz_completo:!0,data_conclusao:new Date().toISOString()});ve&&console.error("Erro ao registrar misso:",ve);const{error:ne}=await J.from("profiles").update({score_verde:((r==null?void 0:r.score_verde)||0)+fe,missoes_concluidas:((r==null?void 0:r.missoes_concluidas)||0)+1}).eq("id",t.id);if(ne)throw ne;const Me=n.duracao_minutos||10,Ie=Me/60,{error:Be}=await J.from("impacto_bruto").insert({tipo:"educacao",valor_bruto:Ie,id_usuario:t.id,id_missao:n.id,data_hora:new Date().toISOString(),descricao_origem:`Misso concluda - ${n.titulo} (${Me} min)`,processado:!0});if(Be)console.error("Erro ao registrar educao no impacto_bruto:",Be);else{const{data:ot}=await J.from("saldo_parcial").select("saldo").eq("tipo","educacao").single(),Se=((ot==null?void 0:ot.saldo)||0)+Ie,{error:ze}=await J.from("saldo_parcial").upsert({tipo:"educacao",saldo:Se,updated_at:new Date().toISOString()},{onConflict:"tipo"});ze?console.error("Erro ao atualizar saldo_parcial:",ze):console.log(` Saldo educao atualizado: ${(ot==null?void 0:ot.saldo)||0}  ${Se} (+${Ie} horas)`)}await a(),k(fe),me.message?M({title:"Misso Concluda! ",description:me.message,duration:7e3}):M({title:"Misso concluda! ",description:`Voc acertou ${ce.toFixed(0)}% e ganhou ${fe} pontos verdes!`})}else{B(!0),k(0),await J.from("missoes_usuarios").insert({id_usuario:t.id,id_missao:n.id,percentual_acerto:ce,quiz_completo:!0,data_conclusao:new Date().toISOString()});const ve=n.duracao_minutos||10,ne=ve/60,{error:Me}=await J.from("impacto_bruto").insert({tipo:"educacao",valor_bruto:ne,id_usuario:t.id,id_missao:n.id,data_hora:new Date().toISOString(),descricao_origem:`Misso concluda (limite atingido) - ${n.titulo} (${ve} min)`,processado:!0});if(!Me){const{data:Ie}=await J.from("saldo_parcial").select("saldo").eq("tipo","educacao").single(),Be=((Ie==null?void 0:Ie.saldo)||0)+ne,{error:ot}=await J.from("saldo_parcial").upsert({tipo:"educacao",saldo:Be,updated_at:new Date().toISOString()},{onConflict:"tipo"});ot?console.error("Erro ao atualizar saldo_parcial:",ot):console.log(` Saldo educao atualizado (limite): ${(Ie==null?void 0:Ie.saldo)||0}  ${Be} (+${ne} horas)`)}M({title:"Limite mensal atingido! ",description:me.message,duration:1e4})}}else M({title:"Quiz incompleto",description:`Voc precisa de 80% de acertos. Voc acertou ${ce.toFixed(0)}%. Revise e tente novamente!`,variant:"destructive"})}catch(xe){M({title:"Erro",description:xe.message,variant:"destructive"})}};if(!n)return null;const Q=o[p],re=o.length>0?(p+1)/o.length*100:0,le=[{id:"video",label:"Vdeo",icon:Sx,completed:d==="quiz"||d==="review"},{id:"quiz",label:"Quiz",icon:Tr,completed:d==="review"}],ye=d==="video"?50:d==="review"?100:50+re*.5;return s.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[s.jsx(Rd,{showBackButton:!0,backTo:"/missions"}),s.jsxs("div",{className:"mx-auto max-w-4xl p-4 md:p-8 space-y-6",children:[O&&d==="video"&&s.jsxs(Er,{className:"border-blue-500 bg-blue-50 dark:bg-blue-950",children:[s.jsx(Tr,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),s.jsxs(Sr,{className:"text-blue-800 dark:text-blue-200",children:[s.jsx("strong",{children:"Misso j completada! "})," Voc j ganhou os pontos desta misso. Voc pode assistir o vdeo quantas vezes quiser para revisar o contedo, mas no poder refazer o quiz."]})]}),I&&s.jsxs(Er,{variant:"destructive",className:"border-yellow-500 bg-yellow-50 dark:bg-yellow-950",children:[s.jsx(un,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-400"}),s.jsxs(Sr,{className:"text-yellow-800 dark:text-yellow-200",children:[s.jsx("strong",{children:"Limite mensal atingido!"})," Voc j conquistou ",q," pontos com educao este ms. Continue assistindo para acumular UIBs (Unidades de Impacto Bruto) para o CDV, mas pontos extras s sero creditados no prximo ms."]})]}),s.jsx(Ne,{children:s.jsxs(De,{className:"pt-6 space-y-4",children:[s.jsx("div",{className:"flex items-center justify-between",children:le.map((W,ee)=>{const ie=W.icon,ce=W.id===d,xe=W.completed;return s.jsxs("div",{className:"flex items-center flex-1",children:[s.jsxs("div",{className:"flex flex-col items-center flex-1",children:[s.jsx("div",{className:pt("flex items-center justify-center w-12 h-12 rounded-full border-2 transition-all",xe&&"bg-primary border-primary text-primary-foreground",ce&&!xe&&"border-primary text-primary",!ce&&!xe&&"border-muted text-muted-foreground"),children:xe?s.jsx(Ea,{className:"h-6 w-6"}):s.jsx(ie,{className:"h-6 w-6"})}),s.jsx("span",{className:pt("mt-2 text-sm font-medium",ce&&"text-primary",!ce&&"text-muted-foreground"),children:W.label})]}),ee<le.length-1&&s.jsx("div",{className:pt("h-0.5 flex-1 mx-2 transition-all",xe?"bg-primary":"bg-muted")})]},W.id)})}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-muted-foreground",children:"Progresso geral"}),s.jsxs("span",{className:"font-medium",children:[Math.round(ye),"%"]})]}),s.jsx(fn,{value:ye,className:"h-2"})]})]})}),d==="video"&&s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(Sx,{className:"h-5 w-5"}),"Vdeo Educativo"]})}),s.jsxs(De,{className:"space-y-6",children:[s.jsx("div",{className:"aspect-video rounded-lg overflow-hidden bg-muted",children:n.video_url?s.jsx("iframe",{src:VR(n.video_url),className:"w-full h-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,title:n.titulo}):s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsx("p",{className:"text-muted-foreground",children:"Vdeo no disponvel"})})}),s.jsx("div",{className:"sticky bottom-0 bg-card pt-4 pb-2 -mx-6 px-6",children:O?s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Er,{className:"border-green-500 bg-green-50 dark:bg-green-950",children:[s.jsx(Tr,{className:"h-4 w-4 text-green-600 dark:text-green-400"}),s.jsx(Sr,{className:"text-green-800 dark:text-green-200",children:"Voc j completou esta misso e ganhou os pontos! Continue assistindo para revisar."})]}),s.jsx(oe,{onClick:()=>h("review"),className:"w-full",size:"lg",children:"Ver Resultados do Quiz"})]}):s.jsx(oe,{onClick:ae,className:"w-full",size:"lg",children:"Continuar para o Quiz"})})]})]}),d==="quiz"&&s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Qe,{children:["Quiz - Questo ",p+1," de ",o.length]}),s.jsx(fn,{value:re})]})}),s.jsx(De,{className:"space-y-6",children:Q&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:Q.pergunta}),s.jsx(w_,{value:v[Q.id]||"",onValueChange:W=>H(Q.id,W),children:s.jsx("div",{className:"space-y-3",children:["A","B","C","D"].map(W=>{const ee=Q[`alternativa_${W.toLowerCase()}`];return ee?s.jsxs("div",{className:"flex items-center space-x-2 border rounded-lg p-4 cursor-pointer hover:bg-muted/50",children:[s.jsx(b_,{value:W,id:`${Q.id}-${W}`}),s.jsxs(ke,{htmlFor:`${Q.id}-${W}`,className:"flex-1 cursor-pointer",children:[s.jsxs("span",{className:"font-semibold",children:[W,")"]})," ",ee]})]},W):null})})})]}),s.jsx("div",{className:"sticky bottom-0 bg-card pt-4 pb-2 -mx-6 px-6 border-t border-border",children:s.jsx(oe,{onClick:Z,disabled:!v[Q.id],className:"w-full",size:"lg",children:p<o.length-1?"Prxima Questo":"Finalizar Quiz"})})]})})]}),d==="review"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx(Ne,{children:s.jsx(De,{className:"pt-6 space-y-4 text-center",children:N>=80?s.jsxs(s.Fragment,{children:[s.jsx(Tr,{className:"h-20 w-20 text-green-500 mx-auto"}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Parabns! "}),s.jsxs("p",{className:"text-lg",children:["Voc acertou ",N.toFixed(0),"% das questes!"]}),s.jsxs("p",{className:"text-muted-foreground",children:["Voc ganhou ",n.pontos," pontos verdes!"]})]})]}):s.jsxs(s.Fragment,{children:[s.jsx(Va,{className:"h-20 w-20 text-destructive mx-auto"}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Quase l!"}),s.jsxs("p",{className:"text-lg",children:["Voc acertou ",N.toFixed(0),"% das questes."]}),s.jsx("p",{className:"text-muted-foreground",children:"Voc precisa de 80% para completar a misso."}),s.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Revise o material e tente novamente!"})]})]})})}),s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsx(Qe,{children:"Reviso das Questes"})}),s.jsxs(De,{className:"space-y-6",children:[C.map((W,ee)=>{var Ce;const ie=W.question,ce=ie[`alternativa_${(Ce=W.userAnswer)==null?void 0:Ce.toLowerCase()}`],xe=ie[`alternativa_${ie.resposta_correta.toLowerCase()}`];return s.jsx("div",{className:pt("p-4 rounded-lg border-2",W.isCorrect?"border-green-500 bg-green-50 dark:bg-green-950/20":"border-red-500 bg-red-50 dark:bg-red-950/20"),children:s.jsx("div",{className:"space-y-3",children:s.jsxs("div",{className:"flex items-start gap-3",children:[W.isCorrect?s.jsx(Tr,{className:"h-5 w-5 text-green-500 mt-0.5 flex-shrink-0"}):s.jsx(Va,{className:"h-5 w-5 text-destructive mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("h3",{className:"font-semibold mb-2",children:["Questo ",ee+1,": ",ie.pergunta]}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Sua resposta: "}),s.jsxs("span",{className:W.isCorrect?"text-green-700 dark:text-green-400":"text-red-700 dark:text-red-400",children:[W.userAnswer,") ",ce]})]}),!W.isCorrect&&s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Resposta correta: "}),s.jsxs("span",{className:"text-green-700 dark:text-green-400",children:[ie.resposta_correta,") ",xe]})]}),ie.explicacao&&s.jsxs("div",{className:"mt-3 p-3 bg-background rounded border",children:[s.jsx("span",{className:"font-medium",children:"Explicao: "}),s.jsx("span",{className:"text-muted-foreground",children:ie.explicacao})]})]})]})]})})},ie.id)}),N>=80&&n&&s.jsx("div",{className:"p-4 bg-primary/10 rounded-lg border border-primary/20",children:s.jsx(__,{shareData:{type:"missao_concluida",titulo_missao:n.titulo},nomeUsuario:r==null?void 0:r.nome.split(" ")[0],conquistaTitulo:n.titulo,className:"mb-4"})}),s.jsx("div",{className:"flex gap-3 sticky bottom-0 bg-card pt-4 pb-4 -mx-6 px-6 border-t border-border",children:N>=80?s.jsxs(s.Fragment,{children:[s.jsx(oe,{onClick:je,variant:"outline",className:"flex-1",size:"lg",children:" Assistir Vdeo Novamente"}),s.jsx(oe,{onClick:()=>F("/missions"),className:"flex-1",size:"lg",children:"Voltar para Misses"})]}):s.jsxs(s.Fragment,{children:[s.jsx(oe,{onClick:()=>F("/missions"),variant:"outline",className:"flex-1",size:"lg",children:"Voltar para Misses"}),s.jsx(oe,{onClick:()=>{h("video"),x(0),b({}),T([]),_(0)},className:"flex-1",size:"lg",children:"Tentar Novamente"})]})})]})]})]})]})]})}function wY({onCapture:e,onCancel:t}){const r=E.useRef(null),[a,n]=E.useState(null),[i,o]=E.useState(!1),c=async()=>{try{const p=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});r.current&&(r.current.srcObject=p),n(p),o(!0)}catch(p){console.error("Error accessing camera:",p)}},d=()=>{if(r.current){const p=document.createElement("canvas");p.width=r.current.videoWidth,p.height=r.current.videoHeight;const x=p.getContext("2d");x&&(x.drawImage(r.current,0,0),p.toBlob(v=>{if(v){const b=new File([v],"camera-capture.jpg",{type:"image/jpeg"});h(),e(b)}},"image/jpeg"))}},h=()=>{a&&(a.getTracks().forEach(p=>p.stop()),n(null),o(!1))};return s.jsx("div",{className:"space-y-4",children:i?s.jsxs(s.Fragment,{children:[s.jsx("video",{ref:r,autoPlay:!0,playsInline:!0,className:"w-full rounded-lg"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(oe,{onClick:d,className:"flex-1",children:"Capturar Foto"}),s.jsx(oe,{variant:"outline",onClick:()=>{h(),t()},children:"Cancelar"})]})]}):s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(oe,{onClick:c,className:"flex-1",children:[s.jsx(jx,{className:"mr-2 h-4 w-4"}),"Iniciar Cmera"]}),s.jsx(oe,{variant:"outline",onClick:t,children:s.jsx(Jr,{className:"h-4 w-4"})})]})})}var es;(function(e){e[e.QR_CODE=0]="QR_CODE",e[e.AZTEC=1]="AZTEC",e[e.CODABAR=2]="CODABAR",e[e.CODE_39=3]="CODE_39",e[e.CODE_93=4]="CODE_93",e[e.CODE_128=5]="CODE_128",e[e.DATA_MATRIX=6]="DATA_MATRIX",e[e.MAXICODE=7]="MAXICODE",e[e.ITF=8]="ITF",e[e.EAN_13=9]="EAN_13",e[e.EAN_8=10]="EAN_8",e[e.PDF_417=11]="PDF_417",e[e.RSS_14=12]="RSS_14",e[e.RSS_EXPANDED=13]="RSS_EXPANDED",e[e.UPC_A=14]="UPC_A",e[e.UPC_E=15]="UPC_E",e[e.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(es||(es={}));var eE=new Map([[es.QR_CODE,"QR_CODE"],[es.AZTEC,"AZTEC"],[es.CODABAR,"CODABAR"],[es.CODE_39,"CODE_39"],[es.CODE_93,"CODE_93"],[es.CODE_128,"CODE_128"],[es.DATA_MATRIX,"DATA_MATRIX"],[es.MAXICODE,"MAXICODE"],[es.ITF,"ITF"],[es.EAN_13,"EAN_13"],[es.EAN_8,"EAN_8"],[es.PDF_417,"PDF_417"],[es.RSS_14,"RSS_14"],[es.RSS_EXPANDED,"RSS_EXPANDED"],[es.UPC_A,"UPC_A"],[es.UPC_E,"UPC_E"],[es.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),tE;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.URL=1]="URL"})(tE||(tE={}));function bY(e){return Object.values(es).includes(e)}var Zx;(function(e){e[e.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",e[e.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Zx||(Zx={}));var _Y=function(){function e(){}return e.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",e.SCAN_DEFAULT_FPS=2,e.DEFAULT_DISABLE_FLIP=!1,e.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,e.DEFAULT_SUPPORTED_SCAN_TYPE=[Zx.SCAN_TYPE_CAMERA,Zx.SCAN_TYPE_FILE],e}(),sP=function(){function e(t,r){this.format=t,this.formatName=r}return e.prototype.toString=function(){return this.formatName},e.create=function(t){if(!eE.has(t))throw"".concat(t," not in html5QrcodeSupportedFormatsTextMap");return new e(t,eE.get(t))},e}(),sE=function(){function e(){}return e.createFromText=function(t){var r={text:t};return{decodedText:t,result:r}},e.createFromQrcodeResult=function(t){return{decodedText:t.text,result:t}},e}(),aw;(function(e){e[e.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",e[e.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",e[e.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(aw||(aw={}));var jY=function(){function e(){}return e.createFrom=function(t){return{errorMessage:t,type:aw.UNKWOWN_ERROR}},e}(),NY=function(){function e(t){this.verbose=t}return e.prototype.log=function(t){this.verbose&&console.log(t)},e.prototype.warn=function(t){this.verbose&&console.warn(t)},e.prototype.logError=function(t,r){(this.verbose||r===!0)&&console.error(t)},e.prototype.logErrors=function(t){if(t.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(t)},e}();function ac(e){return typeof e>"u"||e===null}var Ih=function(){function e(){}return e.codeParseError=function(t){return"QR code parse error, error = ".concat(t)},e.errorGettingUserMedia=function(t){return"Error getting userMedia, error = ".concat(t)},e.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},e.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},e.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},e.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},e.scannerPaused=function(){return"Scanner paused"},e}(),rP=function(){function e(){}return e.isMediaStreamConstraintsValid=function(t,r){if(typeof t!="object"){var a=typeof t;return r.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(a,"."),!0),!1}for(var n=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],i=new Set(n),o=Object.keys(t),c=0,d=o;c<d.length;c++){var h=d[c];if(i.has(h))return r.logError("".concat(h," is not supported videoConstaints."),!0),!1}return!0},e}(),nw={exports:{}};(function(e,t){(function(r,a){a(t)})(rd,function(r){function a(te){return te==null}var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(te,l){te.__proto__=l}||function(te,l){for(var u in l)l.hasOwnProperty(u)&&(te[u]=l[u])};function i(te,l){n(te,l);function u(){this.constructor=te}te.prototype=l===null?Object.create(l):(u.prototype=l.prototype,new u)}function o(te,l){var u=Object.setPrototypeOf;u?u(te,l):te.__proto__=l}function c(te,l){l===void 0&&(l=te.constructor);var u=Error.captureStackTrace;u&&u(te,l)}var d=function(te){i(l,te);function l(u){var m=this.constructor,g=te.call(this,u)||this;return Object.defineProperty(g,"name",{value:m.name,enumerable:!1}),o(g,m.prototype),c(g),g}return l}(Error);class h extends d{constructor(l=void 0){super(l),this.message=l}getKind(){return this.constructor.kind}}h.kind="Exception";class p extends h{}p.kind="ArgumentException";class x extends h{}x.kind="IllegalArgumentException";class v{constructor(l){if(this.binarizer=l,l===null)throw new x("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(l,u){return this.binarizer.getBlackRow(l,u)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(l,u,m,g){const y=this.binarizer.getLuminanceSource().crop(l,u,m,g);return new v(this.binarizer.createBinarizer(y))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const l=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new v(this.binarizer.createBinarizer(l))}rotateCounterClockwise45(){const l=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new v(this.binarizer.createBinarizer(l))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class b extends h{static getChecksumInstance(){return new b}}b.kind="ChecksumException";class N{constructor(l){this.source=l}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class _{static arraycopy(l,u,m,g,y){for(;y--;)m[g++]=l[u++]}static currentTimeMillis(){return Date.now()}}class C extends h{}C.kind="IndexOutOfBoundsException";class T extends C{constructor(l=void 0,u=void 0){super(u),this.index=l,this.message=u}}T.kind="ArrayIndexOutOfBoundsException";class A{static fill(l,u){for(let m=0,g=l.length;m<g;m++)l[m]=u}static fillWithin(l,u,m,g){A.rangeCheck(l.length,u,m);for(let y=u;y<m;y++)l[y]=g}static rangeCheck(l,u,m){if(u>m)throw new x("fromIndex("+u+") > toIndex("+m+")");if(u<0)throw new T(u);if(m>l)throw new T(m)}static asList(...l){return l}static create(l,u,m){return Array.from({length:l}).map(y=>Array.from({length:u}).fill(m))}static createInt32Array(l,u,m){return Array.from({length:l}).map(y=>Int32Array.from({length:u}).fill(m))}static equals(l,u){if(!l||!u||!l.length||!u.length||l.length!==u.length)return!1;for(let m=0,g=l.length;m<g;m++)if(l[m]!==u[m])return!1;return!0}static hashCode(l){if(l===null)return 0;let u=1;for(const m of l)u=31*u+m;return u}static fillUint8Array(l,u){for(let m=0;m!==l.length;m++)l[m]=u}static copyOf(l,u){return l.slice(0,u)}static copyOfUint8Array(l,u){if(l.length<=u){const m=new Uint8Array(u);return m.set(l),m}return l.slice(0,u)}static copyOfRange(l,u,m){const g=m-u,y=new Int32Array(g);return _.arraycopy(l,u,y,0,g),y}static binarySearch(l,u,m){m===void 0&&(m=A.numberComparator);let g=0,y=l.length-1;for(;g<=y;){const j=y+g>>1,S=m(u,l[j]);if(S>0)g=j+1;else if(S<0)y=j-1;else return j}return-g-1}static numberComparator(l,u){return l-u}}class k{static numberOfTrailingZeros(l){let u;if(l===0)return 32;let m=31;return u=l<<16,u!==0&&(m-=16,l=u),u=l<<8,u!==0&&(m-=8,l=u),u=l<<4,u!==0&&(m-=4,l=u),u=l<<2,u!==0&&(m-=2,l=u),m-(l<<1>>>31)}static numberOfLeadingZeros(l){if(l===0)return 32;let u=1;return l>>>16||(u+=16,l<<=16),l>>>24||(u+=8,l<<=8),l>>>28||(u+=4,l<<=4),l>>>30||(u+=2,l<<=2),u-=l>>>31,u}static toHexString(l){return l.toString(16)}static toBinaryString(l){return String(parseInt(String(l),2))}static bitCount(l){return l=l-(l>>>1&1431655765),l=(l&858993459)+(l>>>2&858993459),l=l+(l>>>4)&252645135,l=l+(l>>>8),l=l+(l>>>16),l&63}static truncDivision(l,u){return Math.trunc(l/u)}static parseInt(l,u=void 0){return parseInt(l,u)}}k.MIN_VALUE_32_BITS=-2147483648,k.MAX_VALUE=Number.MAX_SAFE_INTEGER;class I{constructor(l,u){l===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=l,u==null?this.bits=I.makeArray(l):this.bits=u)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(l){if(l>this.bits.length*32){const u=I.makeArray(l);_.arraycopy(this.bits,0,u,0,this.bits.length),this.bits=u}}get(l){return(this.bits[Math.floor(l/32)]&1<<(l&31))!==0}set(l){this.bits[Math.floor(l/32)]|=1<<(l&31)}flip(l){this.bits[Math.floor(l/32)]^=1<<(l&31)}getNextSet(l){const u=this.size;if(l>=u)return u;const m=this.bits;let g=Math.floor(l/32),y=m[g];y&=~((1<<(l&31))-1);const j=m.length;for(;y===0;){if(++g===j)return u;y=m[g]}const S=g*32+k.numberOfTrailingZeros(y);return S>u?u:S}getNextUnset(l){const u=this.size;if(l>=u)return u;const m=this.bits;let g=Math.floor(l/32),y=~m[g];y&=~((1<<(l&31))-1);const j=m.length;for(;y===0;){if(++g===j)return u;y=~m[g]}const S=g*32+k.numberOfTrailingZeros(y);return S>u?u:S}setBulk(l,u){this.bits[Math.floor(l/32)]=u}setRange(l,u){if(u<l||l<0||u>this.size)throw new x;if(u===l)return;u--;const m=Math.floor(l/32),g=Math.floor(u/32),y=this.bits;for(let j=m;j<=g;j++){const S=j>m?0:l&31,V=(2<<(j<g?31:u&31))-(1<<S);y[j]|=V}}clear(){const l=this.bits.length,u=this.bits;for(let m=0;m<l;m++)u[m]=0}isRange(l,u,m){if(u<l||l<0||u>this.size)throw new x;if(u===l)return!0;u--;const g=Math.floor(l/32),y=Math.floor(u/32),j=this.bits;for(let S=g;S<=y;S++){const P=S>g?0:l&31,K=(2<<(S<y?31:u&31))-(1<<P)&4294967295;if((j[S]&K)!==(m?K:0))return!1}return!0}appendBit(l){this.ensureCapacity(this.size+1),l&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(l,u){if(u<0||u>32)throw new x("Num bits must be between 0 and 32");this.ensureCapacity(this.size+u);for(let m=u;m>0;m--)this.appendBit((l>>m-1&1)===1)}appendBitArray(l){const u=l.size;this.ensureCapacity(this.size+u);for(let m=0;m<u;m++)this.appendBit(l.get(m))}xor(l){if(this.size!==l.size)throw new x("Sizes don't match");const u=this.bits;for(let m=0,g=u.length;m<g;m++)u[m]^=l.bits[m]}toBytes(l,u,m,g){for(let y=0;y<g;y++){let j=0;for(let S=0;S<8;S++)this.get(l)&&(j|=1<<7-S),l++;u[m+y]=j}}getBitArray(){return this.bits}reverse(){const l=new Int32Array(this.bits.length),u=Math.floor((this.size-1)/32),m=u+1,g=this.bits;for(let y=0;y<m;y++){let j=g[y];j=j>>1&1431655765|(j&1431655765)<<1,j=j>>2&858993459|(j&858993459)<<2,j=j>>4&252645135|(j&252645135)<<4,j=j>>8&16711935|(j&16711935)<<8,j=j>>16&65535|(j&65535)<<16,l[u-y]=j}if(this.size!==m*32){const y=m*32-this.size;let j=l[0]>>>y;for(let S=1;S<m;S++){const P=l[S];j|=P<<32-y,l[S-1]=j,j=P>>>y}l[m-1]=j}this.bits=l}static makeArray(l){return new Int32Array(Math.floor((l+31)/32))}equals(l){if(!(l instanceof I))return!1;const u=l;return this.size===u.size&&A.equals(this.bits,u.bits)}hashCode(){return 31*this.size+A.hashCode(this.bits)}toString(){let l="";for(let u=0,m=this.size;u<m;u++)u&7||(l+=" "),l+=this.get(u)?"X":".";return l}clone(){return new I(this.size,this.bits.slice())}}var B;(function(te){te[te.OTHER=0]="OTHER",te[te.PURE_BARCODE=1]="PURE_BARCODE",te[te.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",te[te.TRY_HARDER=3]="TRY_HARDER",te[te.CHARACTER_SET=4]="CHARACTER_SET",te[te.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",te[te.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",te[te.ASSUME_GS1=7]="ASSUME_GS1",te[te.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",te[te.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",te[te.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(B||(B={}));var O=B;class D extends h{static getFormatInstance(){return new D}}D.kind="FormatException";var F;(function(te){te[te.Cp437=0]="Cp437",te[te.ISO8859_1=1]="ISO8859_1",te[te.ISO8859_2=2]="ISO8859_2",te[te.ISO8859_3=3]="ISO8859_3",te[te.ISO8859_4=4]="ISO8859_4",te[te.ISO8859_5=5]="ISO8859_5",te[te.ISO8859_6=6]="ISO8859_6",te[te.ISO8859_7=7]="ISO8859_7",te[te.ISO8859_8=8]="ISO8859_8",te[te.ISO8859_9=9]="ISO8859_9",te[te.ISO8859_10=10]="ISO8859_10",te[te.ISO8859_11=11]="ISO8859_11",te[te.ISO8859_13=12]="ISO8859_13",te[te.ISO8859_14=13]="ISO8859_14",te[te.ISO8859_15=14]="ISO8859_15",te[te.ISO8859_16=15]="ISO8859_16",te[te.SJIS=16]="SJIS",te[te.Cp1250=17]="Cp1250",te[te.Cp1251=18]="Cp1251",te[te.Cp1252=19]="Cp1252",te[te.Cp1256=20]="Cp1256",te[te.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",te[te.UTF8=22]="UTF8",te[te.ASCII=23]="ASCII",te[te.Big5=24]="Big5",te[te.GB18030=25]="GB18030",te[te.EUC_KR=26]="EUC_KR"})(F||(F={}));class M{constructor(l,u,m,...g){this.valueIdentifier=l,this.name=m,typeof u=="number"?this.values=Int32Array.from([u]):this.values=u,this.otherEncodingNames=g,M.VALUE_IDENTIFIER_TO_ECI.set(l,this),M.NAME_TO_ECI.set(m,this);const y=this.values;for(let j=0,S=y.length;j!==S;j++){const P=y[j];M.VALUES_TO_ECI.set(P,this)}for(const j of g)M.NAME_TO_ECI.set(j,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(l){if(l<0||l>=900)throw new D("incorect value");const u=M.VALUES_TO_ECI.get(l);if(u===void 0)throw new D("incorect value");return u}static getCharacterSetECIByName(l){const u=M.NAME_TO_ECI.get(l);if(u===void 0)throw new D("incorect value");return u}equals(l){if(!(l instanceof M))return!1;const u=l;return this.getName()===u.getName()}}M.VALUE_IDENTIFIER_TO_ECI=new Map,M.VALUES_TO_ECI=new Map,M.NAME_TO_ECI=new Map,M.Cp437=new M(F.Cp437,Int32Array.from([0,2]),"Cp437"),M.ISO8859_1=new M(F.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),M.ISO8859_2=new M(F.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),M.ISO8859_3=new M(F.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),M.ISO8859_4=new M(F.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),M.ISO8859_5=new M(F.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),M.ISO8859_6=new M(F.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),M.ISO8859_7=new M(F.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),M.ISO8859_8=new M(F.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),M.ISO8859_9=new M(F.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),M.ISO8859_10=new M(F.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),M.ISO8859_11=new M(F.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),M.ISO8859_13=new M(F.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),M.ISO8859_14=new M(F.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),M.ISO8859_15=new M(F.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),M.ISO8859_16=new M(F.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),M.SJIS=new M(F.SJIS,20,"SJIS","Shift_JIS"),M.Cp1250=new M(F.Cp1250,21,"Cp1250","windows-1250"),M.Cp1251=new M(F.Cp1251,22,"Cp1251","windows-1251"),M.Cp1252=new M(F.Cp1252,23,"Cp1252","windows-1252"),M.Cp1256=new M(F.Cp1256,24,"Cp1256","windows-1256"),M.UnicodeBigUnmarked=new M(F.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),M.UTF8=new M(F.UTF8,26,"UTF8","UTF-8"),M.ASCII=new M(F.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),M.Big5=new M(F.Big5,28,"Big5"),M.GB18030=new M(F.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),M.EUC_KR=new M(F.EUC_KR,30,"EUC_KR","EUC-KR");class z extends h{}z.kind="UnsupportedOperationException";class q{static decode(l,u){const m=this.encodingName(u);return this.customDecoder?this.customDecoder(l,m):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(m)?this.decodeFallback(l,m):new TextDecoder(m).decode(l)}static shouldDecodeOnFallback(l){return!q.isBrowser()&&l==="ISO-8859-1"}static encode(l,u){const m=this.encodingName(u);return this.customEncoder?this.customEncoder(l,m):typeof TextEncoder>"u"?this.encodeFallback(l):new TextEncoder().encode(l)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(l){return typeof l=="string"?l:l.getName()}static encodingCharacterSet(l){return l instanceof M?l:M.getCharacterSetECIByName(l)}static decodeFallback(l,u){const m=this.encodingCharacterSet(u);if(q.isDecodeFallbackSupported(m)){let g="";for(let y=0,j=l.length;y<j;y++){let S=l[y].toString(16);S.length<2&&(S="0"+S),g+="%"+S}return decodeURIComponent(g)}if(m.equals(M.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(l.buffer));throw new z(`Encoding ${this.encodingName(u)} not supported by fallback.`)}static isDecodeFallbackSupported(l){return l.equals(M.UTF8)||l.equals(M.ISO8859_1)||l.equals(M.ASCII)}static encodeFallback(l){const m=btoa(unescape(encodeURIComponent(l))).split(""),g=[];for(let y=0;y<m.length;y++)g.push(m[y].charCodeAt(0));return new Uint8Array(g)}}class Y{static castAsNonUtf8Char(l,u=null){const m=u?u.getName():this.ISO88591;return q.decode(new Uint8Array([l]),m)}static guessEncoding(l,u){if(u!=null&&u.get(O.CHARACTER_SET)!==void 0)return u.get(O.CHARACTER_SET).toString();const m=l.length;let g=!0,y=!0,j=!0,S=0,P=0,V=0,K=0,se=0,ue=0,Ae=0,Ve=0,$e=0,st=0,ht=0;const Bt=l.length>3&&l[0]===239&&l[1]===187&&l[2]===191;for(let Vt=0;Vt<m&&(g||y||j);Vt++){const Pt=l[Vt]&255;j&&(S>0?Pt&128?S--:j=!1:Pt&128&&(Pt&64?(S++,Pt&32?(S++,Pt&16?(S++,Pt&8?j=!1:K++):V++):P++):j=!1)),g&&(Pt>127&&Pt<160?g=!1:Pt>159&&(Pt<192||Pt===215||Pt===247)&&ht++),y&&(se>0?Pt<64||Pt===127||Pt>252?y=!1:se--:Pt===128||Pt===160||Pt>239?y=!1:Pt>160&&Pt<224?(ue++,Ve=0,Ae++,Ae>$e&&($e=Ae)):Pt>127?(se++,Ae=0,Ve++,Ve>st&&(st=Ve)):(Ae=0,Ve=0))}return j&&S>0&&(j=!1),y&&se>0&&(y=!1),j&&(Bt||P+V+K>0)?Y.UTF8:y&&(Y.ASSUME_SHIFT_JIS||$e>=3||st>=3)?Y.SHIFT_JIS:g&&y?$e===2&&ue===2||ht*10>=m?Y.SHIFT_JIS:Y.ISO88591:g?Y.ISO88591:y?Y.SHIFT_JIS:j?Y.UTF8:Y.PLATFORM_DEFAULT_ENCODING}static format(l,...u){let m=-1;function g(j,S,P,V,K,se){if(j==="%%")return"%";if(u[++m]===void 0)return;j=V?parseInt(V.substr(1)):void 0;let ue=K?parseInt(K.substr(1)):void 0,Ae;switch(se){case"s":Ae=u[m];break;case"c":Ae=u[m][0];break;case"f":Ae=parseFloat(u[m]).toFixed(j);break;case"p":Ae=parseFloat(u[m]).toPrecision(j);break;case"e":Ae=parseFloat(u[m]).toExponential(j);break;case"x":Ae=parseInt(u[m]).toString(ue||16);break;case"d":Ae=parseFloat(parseInt(u[m],ue||10).toPrecision(j)).toFixed(0);break}Ae=typeof Ae=="object"?JSON.stringify(Ae):(+Ae).toString(ue);let Ve=parseInt(P),$e=P&&P[0]+""=="0"?"0":" ";for(;Ae.length<Ve;)Ae=S!==void 0?Ae+$e:$e+Ae;return Ae}let y=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return l.replace(y,g)}static getBytes(l,u){return q.encode(l,u)}static getCharCode(l,u=0){return l.charCodeAt(u)}static getCharAt(l){return String.fromCharCode(l)}}Y.SHIFT_JIS=M.SJIS.getName(),Y.GB2312="GB2312",Y.ISO88591=M.ISO8859_1.getName(),Y.EUC_JP="EUC_JP",Y.UTF8=M.UTF8.getName(),Y.PLATFORM_DEFAULT_ENCODING=Y.UTF8,Y.ASSUME_SHIFT_JIS=!1;class ae{constructor(l=""){this.value=l}enableDecoding(l){return this.encoding=l,this}append(l){return typeof l=="string"?this.value+=l.toString():this.encoding?this.value+=Y.castAsNonUtf8Char(l,this.encoding):this.value+=String.fromCharCode(l),this}appendChars(l,u,m){for(let g=u;u<u+m;g++)this.append(l[g]);return this}length(){return this.value.length}charAt(l){return this.value.charAt(l)}deleteCharAt(l){this.value=this.value.substr(0,l)+this.value.substring(l+1)}setCharAt(l,u){this.value=this.value.substr(0,l)+u+this.value.substr(l+1)}substring(l,u){return this.value.substring(l,u)}setLengthToZero(){this.value=""}toString(){return this.value}insert(l,u){this.value=this.value.substr(0,l)+u+this.value.substr(l+u.length)}}class je{constructor(l,u,m,g){if(this.width=l,this.height=u,this.rowSize=m,this.bits=g,u==null&&(u=l),this.height=u,l<1||u<1)throw new x("Both dimensions must be greater than 0");m==null&&(m=Math.floor((l+31)/32)),this.rowSize=m,g==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(l){const u=l.length,m=l[0].length,g=new je(m,u);for(let y=0;y<u;y++){const j=l[y];for(let S=0;S<m;S++)j[S]&&g.set(S,y)}return g}static parseFromString(l,u,m){if(l===null)throw new x("stringRepresentation cannot be null");const g=new Array(l.length);let y=0,j=0,S=-1,P=0,V=0;for(;V<l.length;)if(l.charAt(V)===`
`||l.charAt(V)==="\r"){if(y>j){if(S===-1)S=y-j;else if(y-j!==S)throw new x("row lengths do not match");j=y,P++}V++}else if(l.substring(V,V+u.length)===u)V+=u.length,g[y]=!0,y++;else if(l.substring(V,V+m.length)===m)V+=m.length,g[y]=!1,y++;else throw new x("illegal character encountered: "+l.substring(V));if(y>j){if(S===-1)S=y-j;else if(y-j!==S)throw new x("row lengths do not match");P++}const K=new je(S,P);for(let se=0;se<y;se++)g[se]&&K.set(Math.floor(se%S),Math.floor(se/S));return K}get(l,u){const m=u*this.rowSize+Math.floor(l/32);return(this.bits[m]>>>(l&31)&1)!==0}set(l,u){const m=u*this.rowSize+Math.floor(l/32);this.bits[m]|=1<<(l&31)&4294967295}unset(l,u){const m=u*this.rowSize+Math.floor(l/32);this.bits[m]&=~(1<<(l&31)&4294967295)}flip(l,u){const m=u*this.rowSize+Math.floor(l/32);this.bits[m]^=1<<(l&31)&4294967295}xor(l){if(this.width!==l.getWidth()||this.height!==l.getHeight()||this.rowSize!==l.getRowSize())throw new x("input matrix dimensions do not match");const u=new I(Math.floor(this.width/32)+1),m=this.rowSize,g=this.bits;for(let y=0,j=this.height;y<j;y++){const S=y*m,P=l.getRow(y,u).getBitArray();for(let V=0;V<m;V++)g[S+V]^=P[V]}}clear(){const l=this.bits,u=l.length;for(let m=0;m<u;m++)l[m]=0}setRegion(l,u,m,g){if(u<0||l<0)throw new x("Left and top must be nonnegative");if(g<1||m<1)throw new x("Height and width must be at least 1");const y=l+m,j=u+g;if(j>this.height||y>this.width)throw new x("The region must fit inside the matrix");const S=this.rowSize,P=this.bits;for(let V=u;V<j;V++){const K=V*S;for(let se=l;se<y;se++)P[K+Math.floor(se/32)]|=1<<(se&31)&4294967295}}getRow(l,u){u==null||u.getSize()<this.width?u=new I(this.width):u.clear();const m=this.rowSize,g=this.bits,y=l*m;for(let j=0;j<m;j++)u.setBulk(j*32,g[y+j]);return u}setRow(l,u){_.arraycopy(u.getBitArray(),0,this.bits,l*this.rowSize,this.rowSize)}rotate180(){const l=this.getWidth(),u=this.getHeight();let m=new I(l),g=new I(l);for(let y=0,j=Math.floor((u+1)/2);y<j;y++)m=this.getRow(y,m),g=this.getRow(u-1-y,g),m.reverse(),g.reverse(),this.setRow(y,g),this.setRow(u-1-y,m)}getEnclosingRectangle(){const l=this.width,u=this.height,m=this.rowSize,g=this.bits;let y=l,j=u,S=-1,P=-1;for(let V=0;V<u;V++)for(let K=0;K<m;K++){const se=g[V*m+K];if(se!==0){if(V<j&&(j=V),V>P&&(P=V),K*32<y){let ue=0;for(;!(se<<31-ue&4294967295);)ue++;K*32+ue<y&&(y=K*32+ue)}if(K*32+31>S){let ue=31;for(;!(se>>>ue);)ue--;K*32+ue>S&&(S=K*32+ue)}}}return S<y||P<j?null:Int32Array.from([y,j,S-y+1,P-j+1])}getTopLeftOnBit(){const l=this.rowSize,u=this.bits;let m=0;for(;m<u.length&&u[m]===0;)m++;if(m===u.length)return null;const g=m/l;let y=m%l*32;const j=u[m];let S=0;for(;!(j<<31-S&4294967295);)S++;return y+=S,Int32Array.from([y,g])}getBottomRightOnBit(){const l=this.rowSize,u=this.bits;let m=u.length-1;for(;m>=0&&u[m]===0;)m--;if(m<0)return null;const g=Math.floor(m/l);let y=Math.floor(m%l)*32;const j=u[m];let S=31;for(;!(j>>>S);)S--;return y+=S,Int32Array.from([y,g])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(l){if(!(l instanceof je))return!1;const u=l;return this.width===u.width&&this.height===u.height&&this.rowSize===u.rowSize&&A.equals(this.bits,u.bits)}hashCode(){let l=this.width;return l=31*l+this.width,l=31*l+this.height,l=31*l+this.rowSize,l=31*l+A.hashCode(this.bits),l}toString(l="X ",u="  ",m=`
`){return this.buildToString(l,u,m)}buildToString(l,u,m){let g=new ae;for(let y=0,j=this.height;y<j;y++){for(let S=0,P=this.width;S<P;S++)g.append(this.get(S,y)?l:u);g.append(m)}return g.toString()}clone(){return new je(this.width,this.height,this.rowSize,this.bits.slice())}}class H extends h{static getNotFoundInstance(){return new H}}H.kind="NotFoundException";class Z extends N{constructor(l){super(l),this.luminances=Z.EMPTY,this.buckets=new Int32Array(Z.LUMINANCE_BUCKETS)}getBlackRow(l,u){const m=this.getLuminanceSource(),g=m.getWidth();u==null||u.getSize()<g?u=new I(g):u.clear(),this.initArrays(g);const y=m.getRow(l,this.luminances),j=this.buckets;for(let P=0;P<g;P++)j[(y[P]&255)>>Z.LUMINANCE_SHIFT]++;const S=Z.estimateBlackPoint(j);if(g<3)for(let P=0;P<g;P++)(y[P]&255)<S&&u.set(P);else{let P=y[0]&255,V=y[1]&255;for(let K=1;K<g-1;K++){const se=y[K+1]&255;(V*4-P-se)/2<S&&u.set(K),P=V,V=se}}return u}getBlackMatrix(){const l=this.getLuminanceSource(),u=l.getWidth(),m=l.getHeight(),g=new je(u,m);this.initArrays(u);const y=this.buckets;for(let P=1;P<5;P++){const V=Math.floor(m*P/5),K=l.getRow(V,this.luminances),se=Math.floor(u*4/5);for(let ue=Math.floor(u/5);ue<se;ue++){const Ae=K[ue]&255;y[Ae>>Z.LUMINANCE_SHIFT]++}}const j=Z.estimateBlackPoint(y),S=l.getMatrix();for(let P=0;P<m;P++){const V=P*u;for(let K=0;K<u;K++)(S[V+K]&255)<j&&g.set(K,P)}return g}createBinarizer(l){return new Z(l)}initArrays(l){this.luminances.length<l&&(this.luminances=new Uint8ClampedArray(l));const u=this.buckets;for(let m=0;m<Z.LUMINANCE_BUCKETS;m++)u[m]=0}static estimateBlackPoint(l){const u=l.length;let m=0,g=0,y=0;for(let K=0;K<u;K++)l[K]>y&&(g=K,y=l[K]),l[K]>m&&(m=l[K]);let j=0,S=0;for(let K=0;K<u;K++){const se=K-g,ue=l[K]*se*se;ue>S&&(j=K,S=ue)}if(g>j){const K=g;g=j,j=K}if(j-g<=u/16)throw new H;let P=j-1,V=-1;for(let K=j-1;K>g;K--){const se=K-g,ue=se*se*(j-K)*(m-l[K]);ue>V&&(P=K,V=ue)}return P<<Z.LUMINANCE_SHIFT}}Z.LUMINANCE_BITS=5,Z.LUMINANCE_SHIFT=8-Z.LUMINANCE_BITS,Z.LUMINANCE_BUCKETS=1<<Z.LUMINANCE_BITS,Z.EMPTY=Uint8ClampedArray.from([0]);class G extends Z{constructor(l){super(l),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const l=this.getLuminanceSource(),u=l.getWidth(),m=l.getHeight();if(u>=G.MINIMUM_DIMENSION&&m>=G.MINIMUM_DIMENSION){const g=l.getMatrix();let y=u>>G.BLOCK_SIZE_POWER;u&G.BLOCK_SIZE_MASK&&y++;let j=m>>G.BLOCK_SIZE_POWER;m&G.BLOCK_SIZE_MASK&&j++;const S=G.calculateBlackPoints(g,y,j,u,m),P=new je(u,m);G.calculateThresholdForBlock(g,y,j,u,m,S,P),this.matrix=P}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(l){return new G(l)}static calculateThresholdForBlock(l,u,m,g,y,j,S){const P=y-G.BLOCK_SIZE,V=g-G.BLOCK_SIZE;for(let K=0;K<m;K++){let se=K<<G.BLOCK_SIZE_POWER;se>P&&(se=P);const ue=G.cap(K,2,m-3);for(let Ae=0;Ae<u;Ae++){let Ve=Ae<<G.BLOCK_SIZE_POWER;Ve>V&&(Ve=V);const $e=G.cap(Ae,2,u-3);let st=0;for(let Bt=-2;Bt<=2;Bt++){const Vt=j[ue+Bt];st+=Vt[$e-2]+Vt[$e-1]+Vt[$e]+Vt[$e+1]+Vt[$e+2]}const ht=st/25;G.thresholdBlock(l,Ve,se,ht,g,S)}}}static cap(l,u,m){return l<u?u:l>m?m:l}static thresholdBlock(l,u,m,g,y,j){for(let S=0,P=m*y+u;S<G.BLOCK_SIZE;S++,P+=y)for(let V=0;V<G.BLOCK_SIZE;V++)(l[P+V]&255)<=g&&j.set(u+V,m+S)}static calculateBlackPoints(l,u,m,g,y){const j=y-G.BLOCK_SIZE,S=g-G.BLOCK_SIZE,P=new Array(m);for(let V=0;V<m;V++){P[V]=new Int32Array(u);let K=V<<G.BLOCK_SIZE_POWER;K>j&&(K=j);for(let se=0;se<u;se++){let ue=se<<G.BLOCK_SIZE_POWER;ue>S&&(ue=S);let Ae=0,Ve=255,$e=0;for(let ht=0,Bt=K*g+ue;ht<G.BLOCK_SIZE;ht++,Bt+=g){for(let Vt=0;Vt<G.BLOCK_SIZE;Vt++){const Pt=l[Bt+Vt]&255;Ae+=Pt,Pt<Ve&&(Ve=Pt),Pt>$e&&($e=Pt)}if($e-Ve>G.MIN_DYNAMIC_RANGE)for(ht++,Bt+=g;ht<G.BLOCK_SIZE;ht++,Bt+=g)for(let Vt=0;Vt<G.BLOCK_SIZE;Vt++)Ae+=l[Bt+Vt]&255}let st=Ae>>G.BLOCK_SIZE_POWER*2;if($e-Ve<=G.MIN_DYNAMIC_RANGE&&(st=Ve/2,V>0&&se>0)){const ht=(P[V-1][se]+2*P[V][se-1]+P[V-1][se-1])/4;Ve<ht&&(st=ht)}P[V][se]=st}}return P}}G.BLOCK_SIZE_POWER=3,G.BLOCK_SIZE=1<<G.BLOCK_SIZE_POWER,G.BLOCK_SIZE_MASK=G.BLOCK_SIZE-1,G.MINIMUM_DIMENSION=G.BLOCK_SIZE*5,G.MIN_DYNAMIC_RANGE=24;class Q{constructor(l,u){this.width=l,this.height=u}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(l,u,m,g){throw new z("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new z("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new z("This luminance source does not support rotation by 45 degrees.")}toString(){const l=new Uint8ClampedArray(this.width);let u=new ae;for(let m=0;m<this.height;m++){const g=this.getRow(m,l);for(let y=0;y<this.width;y++){const j=g[y]&255;let S;j<64?S="#":j<128?S="+":j<192?S=".":S=" ",u.append(S)}u.append(`
`)}return u.toString()}}class re extends Q{constructor(l){super(l.getWidth(),l.getHeight()),this.delegate=l}getRow(l,u){const m=this.delegate.getRow(l,u),g=this.getWidth();for(let y=0;y<g;y++)m[y]=255-(m[y]&255);return m}getMatrix(){const l=this.delegate.getMatrix(),u=this.getWidth()*this.getHeight(),m=new Uint8ClampedArray(u);for(let g=0;g<u;g++)m[g]=255-(l[g]&255);return m}isCropSupported(){return this.delegate.isCropSupported()}crop(l,u,m,g){return new re(this.delegate.crop(l,u,m,g))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new re(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new re(this.delegate.rotateCounterClockwise45())}}class le extends Q{constructor(l){super(l.width,l.height),this.canvas=l,this.tempCanvasElement=null,this.buffer=le.makeBufferFromCanvasImageData(l)}static makeBufferFromCanvasImageData(l){const u=l.getContext("2d").getImageData(0,0,l.width,l.height);return le.toGrayscaleBuffer(u.data,l.width,l.height)}static toGrayscaleBuffer(l,u,m){const g=new Uint8ClampedArray(u*m);for(let y=0,j=0,S=l.length;y<S;y+=4,j++){let P;if(l[y+3]===0)P=255;else{const K=l[y],se=l[y+1],ue=l[y+2];P=306*K+601*se+117*ue+512>>10}g[j]=P}return g}getRow(l,u){if(l<0||l>=this.getHeight())throw new x("Requested row is outside the image: "+l);const m=this.getWidth(),g=l*m;return u===null?u=this.buffer.slice(g,g+m):(u.length<m&&(u=new Uint8ClampedArray(m)),u.set(this.buffer.slice(g,g+m))),u}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(l,u,m,g){return super.crop(l,u,m,g),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const l=this.canvas.ownerDocument.createElement("canvas");l.width=this.canvas.width,l.height=this.canvas.height,this.tempCanvasElement=l}return this.tempCanvasElement}rotate(l){const u=this.getTempCanvasElement(),m=u.getContext("2d"),g=l*le.DEGREE_TO_RADIANS,y=this.canvas.width,j=this.canvas.height,S=Math.ceil(Math.abs(Math.cos(g))*y+Math.abs(Math.sin(g))*j),P=Math.ceil(Math.abs(Math.sin(g))*y+Math.abs(Math.cos(g))*j);return u.width=S,u.height=P,m.translate(S/2,P/2),m.rotate(g),m.drawImage(this.canvas,y/-2,j/-2),this.buffer=le.makeBufferFromCanvasImageData(u),this}invert(){return new re(this)}}le.DEGREE_TO_RADIANS=Math.PI/180;class ye{constructor(l,u,m){this.deviceId=l,this.label=u,this.kind="videoinput",this.groupId=m||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var W=(globalThis||rd||self||window||void 0)&&(globalThis||rd||self||window||void 0).__awaiter||function(te,l,u,m){function g(y){return y instanceof u?y:new u(function(j){j(y)})}return new(u||(u=Promise))(function(y,j){function S(K){try{V(m.next(K))}catch(se){j(se)}}function P(K){try{V(m.throw(K))}catch(se){j(se)}}function V(K){K.done?y(K.value):g(K.value).then(S,P)}V((m=m.apply(te,l||[])).next())})};class ee{constructor(l,u=500,m){this.reader=l,this.timeBetweenScansMillis=u,this._hints=m,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(l){this._timeBetweenDecodingAttempts=l<0?0:l}set hints(l){this._hints=l||null}get hints(){return this._hints}listVideoInputDevices(){return W(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const l=yield navigator.mediaDevices.enumerateDevices(),u=[];for(const m of l){const g=m.kind==="video"?"videoinput":m.kind;if(g!=="videoinput")continue;const y=m.deviceId||m.id,j=m.label||`Video device ${u.length+1}`,S=m.groupId,P={deviceId:y,label:j,kind:g,groupId:S};u.push(P)}return u})}getVideoInputDevices(){return W(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(u=>new ye(u.deviceId,u.label))})}findDeviceById(l){return W(this,void 0,void 0,function*(){const u=yield this.listVideoInputDevices();return u?u.find(m=>m.deviceId===l):null})}decodeFromInputVideoDevice(l,u){return W(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(l,u)})}decodeOnceFromVideoDevice(l,u){return W(this,void 0,void 0,function*(){this.reset();let m;l?m={deviceId:{exact:l}}:m={facingMode:"environment"};const g={video:m};return yield this.decodeOnceFromConstraints(g,u)})}decodeOnceFromConstraints(l,u){return W(this,void 0,void 0,function*(){const m=yield navigator.mediaDevices.getUserMedia(l);return yield this.decodeOnceFromStream(m,u)})}decodeOnceFromStream(l,u){return W(this,void 0,void 0,function*(){this.reset();const m=yield this.attachStreamToVideo(l,u);return yield this.decodeOnce(m)})}decodeFromInputVideoDeviceContinuously(l,u,m){return W(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(l,u,m)})}decodeFromVideoDevice(l,u,m){return W(this,void 0,void 0,function*(){let g;l?g={deviceId:{exact:l}}:g={facingMode:"environment"};const y={video:g};return yield this.decodeFromConstraints(y,u,m)})}decodeFromConstraints(l,u,m){return W(this,void 0,void 0,function*(){const g=yield navigator.mediaDevices.getUserMedia(l);return yield this.decodeFromStream(g,u,m)})}decodeFromStream(l,u,m){return W(this,void 0,void 0,function*(){this.reset();const g=yield this.attachStreamToVideo(l,u);return yield this.decodeContinuously(g,m)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(l,u){return W(this,void 0,void 0,function*(){const m=this.prepareVideoElement(u);return this.addVideoSource(m,l),this.videoElement=m,this.stream=l,yield this.playVideoOnLoadAsync(m),m})}playVideoOnLoadAsync(l){return new Promise((u,m)=>this.playVideoOnLoad(l,()=>u()))}playVideoOnLoad(l,u){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(l),l.addEventListener("ended",this.videoEndedListener),l.addEventListener("canplay",this.videoCanPlayListener),l.addEventListener("playing",u),this.tryPlayVideo(l)}isVideoPlaying(l){return l.currentTime>0&&!l.paused&&!l.ended&&l.readyState>2}tryPlayVideo(l){return W(this,void 0,void 0,function*(){if(this.isVideoPlaying(l)){console.warn("Trying to play video that is already playing.");return}try{yield l.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(l,u){const m=document.getElementById(l);if(!m)throw new p(`element with id '${l}' not found`);if(m.nodeName.toLowerCase()!==u.toLowerCase())throw new p(`element with id '${l}' must be an ${u} element`);return m}decodeFromImage(l,u){if(!l&&!u)throw new p("either imageElement with a src set or an url must be provided");return u&&!l?this.decodeFromImageUrl(u):this.decodeFromImageElement(l)}decodeFromVideo(l,u){if(!l&&!u)throw new p("Either an element with a src set or an URL must be provided");return u&&!l?this.decodeFromVideoUrl(u):this.decodeFromVideoElement(l)}decodeFromVideoContinuously(l,u,m){if(l===void 0&&u===void 0)throw new p("Either an element with a src set or an URL must be provided");return u&&!l?this.decodeFromVideoUrlContinuously(u,m):this.decodeFromVideoElementContinuously(l,m)}decodeFromImageElement(l){if(!l)throw new p("An image element must be provided.");this.reset();const u=this.prepareImageElement(l);this.imageElement=u;let m;return this.isImageLoaded(u)?m=this.decodeOnce(u,!1,!0):m=this._decodeOnLoadImage(u),m}decodeFromVideoElement(l){const u=this._decodeFromVideoElementSetup(l);return this._decodeOnLoadVideo(u)}decodeFromVideoElementContinuously(l,u){const m=this._decodeFromVideoElementSetup(l);return this._decodeOnLoadVideoContinuously(m,u)}_decodeFromVideoElementSetup(l){if(!l)throw new p("A video element must be provided.");this.reset();const u=this.prepareVideoElement(l);return this.videoElement=u,u}decodeFromImageUrl(l){if(!l)throw new p("An URL must be provided.");this.reset();const u=this.prepareImageElement();this.imageElement=u;const m=this._decodeOnLoadImage(u);return u.src=l,m}decodeFromVideoUrl(l){if(!l)throw new p("An URL must be provided.");this.reset();const u=this.prepareVideoElement(),m=this.decodeFromVideoElement(u);return u.src=l,m}decodeFromVideoUrlContinuously(l,u){if(!l)throw new p("An URL must be provided.");this.reset();const m=this.prepareVideoElement(),g=this.decodeFromVideoElementContinuously(m,u);return m.src=l,g}_decodeOnLoadImage(l){return new Promise((u,m)=>{this.imageLoadedListener=()=>this.decodeOnce(l,!1,!0).then(u,m),l.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(l){return W(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(l),yield this.decodeOnce(l)})}_decodeOnLoadVideoContinuously(l,u){return W(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(l),this.decodeContinuously(l,u)})}isImageLoaded(l){return!(!l.complete||l.naturalWidth===0)}prepareImageElement(l){let u;return typeof l>"u"&&(u=document.createElement("img"),u.width=200,u.height=200),typeof l=="string"&&(u=this.getMediaElement(l,"img")),l instanceof HTMLImageElement&&(u=l),u}prepareVideoElement(l){let u;return!l&&typeof document<"u"&&(u=document.createElement("video"),u.width=200,u.height=200),typeof l=="string"&&(u=this.getMediaElement(l,"video")),l instanceof HTMLVideoElement&&(u=l),u.setAttribute("autoplay","true"),u.setAttribute("muted","true"),u.setAttribute("playsinline","true"),u}decodeOnce(l,u=!0,m=!0){this._stopAsyncDecode=!1;const g=(y,j)=>{if(this._stopAsyncDecode){j(new H("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const S=this.decode(l);y(S)}catch(S){const P=u&&S instanceof H,K=(S instanceof b||S instanceof D)&&m;if(P||K)return setTimeout(g,this._timeBetweenDecodingAttempts,y,j);j(S)}};return new Promise((y,j)=>g(y,j))}decodeContinuously(l,u){this._stopContinuousDecode=!1;const m=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const g=this.decode(l);u(g,null),setTimeout(m,this.timeBetweenScansMillis)}catch(g){u(null,g);const y=g instanceof b||g instanceof D,j=g instanceof H;(y||j)&&setTimeout(m,this._timeBetweenDecodingAttempts)}};m()}decode(l){const u=this.createBinaryBitmap(l);return this.decodeBitmap(u)}_isHTMLVideoElement(l){return l.videoWidth!==0}drawFrameOnCanvas(l,u,m){u||(u={sx:0,sy:0,sWidth:l.videoWidth,sHeight:l.videoHeight,dx:0,dy:0,dWidth:l.videoWidth,dHeight:l.videoHeight}),m||(m=this.captureCanvasContext),m.drawImage(l,u.sx,u.sy,u.sWidth,u.sHeight,u.dx,u.dy,u.dWidth,u.dHeight)}drawImageOnCanvas(l,u,m=this.captureCanvasContext){u||(u={sx:0,sy:0,sWidth:l.naturalWidth,sHeight:l.naturalHeight,dx:0,dy:0,dWidth:l.naturalWidth,dHeight:l.naturalHeight}),m||(m=this.captureCanvasContext),m.drawImage(l,u.sx,u.sy,u.sWidth,u.sHeight,u.dx,u.dy,u.dWidth,u.dHeight)}createBinaryBitmap(l){this.getCaptureCanvasContext(l),this._isHTMLVideoElement(l)?this.drawFrameOnCanvas(l):this.drawImageOnCanvas(l);const u=this.getCaptureCanvas(l),m=new le(u),g=new G(m);return new v(g)}getCaptureCanvasContext(l){if(!this.captureCanvasContext){const m=this.getCaptureCanvas(l).getContext("2d");this.captureCanvasContext=m}return this.captureCanvasContext}getCaptureCanvas(l){if(!this.captureCanvas){const u=this.createCaptureCanvas(l);this.captureCanvas=u}return this.captureCanvas}decodeBitmap(l){return this.reader.decode(l,this._hints)}createCaptureCanvas(l){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const u=document.createElement("canvas");let m,g;return typeof l<"u"&&(l instanceof HTMLVideoElement?(m=l.videoWidth,g=l.videoHeight):l instanceof HTMLImageElement&&(m=l.naturalWidth||l.width,g=l.naturalHeight||l.height)),u.style.width=m+"px",u.style.height=g+"px",u.width=m,u.height=g,u}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(l=>l.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(l,u){try{l.srcObject=u}catch{l.src=URL.createObjectURL(u)}}cleanVideoSource(l){try{l.srcObject=null}catch{l.src=""}this.videoElement.removeAttribute("src")}}class ie{constructor(l,u,m=u==null?0:8*u.length,g,y,j=_.currentTimeMillis()){this.text=l,this.rawBytes=u,this.numBits=m,this.resultPoints=g,this.format=y,this.timestamp=j,this.text=l,this.rawBytes=u,m==null?this.numBits=u==null?0:8*u.length:this.numBits=m,this.resultPoints=g,this.format=y,this.resultMetadata=null,j==null?this.timestamp=_.currentTimeMillis():this.timestamp=j}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(l,u){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(l,u)}putAllMetadata(l){l!==null&&(this.resultMetadata===null?this.resultMetadata=l:this.resultMetadata=new Map(l))}addResultPoints(l){const u=this.resultPoints;if(u===null)this.resultPoints=l;else if(l!==null&&l.length>0){const m=new Array(u.length+l.length);_.arraycopy(u,0,m,0,u.length),_.arraycopy(l,0,m,u.length,l.length),this.resultPoints=m}}getTimestamp(){return this.timestamp}toString(){return this.text}}var ce;(function(te){te[te.AZTEC=0]="AZTEC",te[te.CODABAR=1]="CODABAR",te[te.CODE_39=2]="CODE_39",te[te.CODE_93=3]="CODE_93",te[te.CODE_128=4]="CODE_128",te[te.DATA_MATRIX=5]="DATA_MATRIX",te[te.EAN_8=6]="EAN_8",te[te.EAN_13=7]="EAN_13",te[te.ITF=8]="ITF",te[te.MAXICODE=9]="MAXICODE",te[te.PDF_417=10]="PDF_417",te[te.QR_CODE=11]="QR_CODE",te[te.RSS_14=12]="RSS_14",te[te.RSS_EXPANDED=13]="RSS_EXPANDED",te[te.UPC_A=14]="UPC_A",te[te.UPC_E=15]="UPC_E",te[te.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(ce||(ce={}));var xe=ce,Ce;(function(te){te[te.OTHER=0]="OTHER",te[te.ORIENTATION=1]="ORIENTATION",te[te.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",te[te.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",te[te.ISSUE_NUMBER=4]="ISSUE_NUMBER",te[te.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",te[te.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",te[te.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",te[te.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",te[te.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",te[te.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Ce||(Ce={}));var me=Ce;class fe{constructor(l,u,m,g,y=-1,j=-1){this.rawBytes=l,this.text=u,this.byteSegments=m,this.ecLevel=g,this.structuredAppendSequenceNumber=y,this.structuredAppendParity=j,this.numBits=l==null?0:8*l.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(l){this.numBits=l}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(l){this.errorsCorrected=l}getErasures(){return this.erasures}setErasures(l){this.erasures=l}getOther(){return this.other}setOther(l){this.other=l}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class ve{exp(l){return this.expTable[l]}log(l){if(l===0)throw new x;return this.logTable[l]}static addOrSubtract(l,u){return l^u}}class ne{constructor(l,u){if(u.length===0)throw new x;this.field=l;const m=u.length;if(m>1&&u[0]===0){let g=1;for(;g<m&&u[g]===0;)g++;g===m?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(m-g),_.arraycopy(u,g,this.coefficients,0,this.coefficients.length))}else this.coefficients=u}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(l){return this.coefficients[this.coefficients.length-1-l]}evaluateAt(l){if(l===0)return this.getCoefficient(0);const u=this.coefficients;let m;if(l===1){m=0;for(let j=0,S=u.length;j!==S;j++){const P=u[j];m=ve.addOrSubtract(m,P)}return m}m=u[0];const g=u.length,y=this.field;for(let j=1;j<g;j++)m=ve.addOrSubtract(y.multiply(l,m),u[j]);return m}addOrSubtract(l){if(!this.field.equals(l.field))throw new x("GenericGFPolys do not have same GenericGF field");if(this.isZero())return l;if(l.isZero())return this;let u=this.coefficients,m=l.coefficients;if(u.length>m.length){const j=u;u=m,m=j}let g=new Int32Array(m.length);const y=m.length-u.length;_.arraycopy(m,0,g,0,y);for(let j=y;j<m.length;j++)g[j]=ve.addOrSubtract(u[j-y],m[j]);return new ne(this.field,g)}multiply(l){if(!this.field.equals(l.field))throw new x("GenericGFPolys do not have same GenericGF field");if(this.isZero()||l.isZero())return this.field.getZero();const u=this.coefficients,m=u.length,g=l.coefficients,y=g.length,j=new Int32Array(m+y-1),S=this.field;for(let P=0;P<m;P++){const V=u[P];for(let K=0;K<y;K++)j[P+K]=ve.addOrSubtract(j[P+K],S.multiply(V,g[K]))}return new ne(S,j)}multiplyScalar(l){if(l===0)return this.field.getZero();if(l===1)return this;const u=this.coefficients.length,m=this.field,g=new Int32Array(u),y=this.coefficients;for(let j=0;j<u;j++)g[j]=m.multiply(y[j],l);return new ne(m,g)}multiplyByMonomial(l,u){if(l<0)throw new x;if(u===0)return this.field.getZero();const m=this.coefficients,g=m.length,y=new Int32Array(g+l),j=this.field;for(let S=0;S<g;S++)y[S]=j.multiply(m[S],u);return new ne(j,y)}divide(l){if(!this.field.equals(l.field))throw new x("GenericGFPolys do not have same GenericGF field");if(l.isZero())throw new x("Divide by 0");const u=this.field;let m=u.getZero(),g=this;const y=l.getCoefficient(l.getDegree()),j=u.inverse(y);for(;g.getDegree()>=l.getDegree()&&!g.isZero();){const S=g.getDegree()-l.getDegree(),P=u.multiply(g.getCoefficient(g.getDegree()),j),V=l.multiplyByMonomial(S,P),K=u.buildMonomial(S,P);m=m.addOrSubtract(K),g=g.addOrSubtract(V)}return[m,g]}toString(){let l="";for(let u=this.getDegree();u>=0;u--){let m=this.getCoefficient(u);if(m!==0){if(m<0?(l+=" - ",m=-m):l.length>0&&(l+=" + "),u===0||m!==1){const g=this.field.log(m);g===0?l+="1":g===1?l+="a":(l+="a^",l+=g)}u!==0&&(u===1?l+="x":(l+="x^",l+=u))}}return l}}class Me extends h{}Me.kind="ArithmeticException";class Ie extends ve{constructor(l,u,m){super(),this.primitive=l,this.size=u,this.generatorBase=m;const g=new Int32Array(u);let y=1;for(let S=0;S<u;S++)g[S]=y,y*=2,y>=u&&(y^=l,y&=u-1);this.expTable=g;const j=new Int32Array(u);for(let S=0;S<u-1;S++)j[g[S]]=S;this.logTable=j,this.zero=new ne(this,Int32Array.from([0])),this.one=new ne(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(l,u){if(l<0)throw new x;if(u===0)return this.zero;const m=new Int32Array(l+1);return m[0]=u,new ne(this,m)}inverse(l){if(l===0)throw new Me;return this.expTable[this.size-this.logTable[l]-1]}multiply(l,u){return l===0||u===0?0:this.expTable[(this.logTable[l]+this.logTable[u])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+k.toHexString(this.primitive)+","+this.size+")"}equals(l){return l===this}}Ie.AZTEC_DATA_12=new Ie(4201,4096,1),Ie.AZTEC_DATA_10=new Ie(1033,1024,1),Ie.AZTEC_DATA_6=new Ie(67,64,1),Ie.AZTEC_PARAM=new Ie(19,16,1),Ie.QR_CODE_FIELD_256=new Ie(285,256,0),Ie.DATA_MATRIX_FIELD_256=new Ie(301,256,1),Ie.AZTEC_DATA_8=Ie.DATA_MATRIX_FIELD_256,Ie.MAXICODE_FIELD_64=Ie.AZTEC_DATA_6;class Be extends h{}Be.kind="ReedSolomonException";class ot extends h{}ot.kind="IllegalStateException";class Se{constructor(l){this.field=l}decode(l,u){const m=this.field,g=new ne(m,l),y=new Int32Array(u);let j=!0;for(let Ae=0;Ae<u;Ae++){const Ve=g.evaluateAt(m.exp(Ae+m.getGeneratorBase()));y[y.length-1-Ae]=Ve,Ve!==0&&(j=!1)}if(j)return;const S=new ne(m,y),P=this.runEuclideanAlgorithm(m.buildMonomial(u,1),S,u),V=P[0],K=P[1],se=this.findErrorLocations(V),ue=this.findErrorMagnitudes(K,se);for(let Ae=0;Ae<se.length;Ae++){const Ve=l.length-1-m.log(se[Ae]);if(Ve<0)throw new Be("Bad error location");l[Ve]=Ie.addOrSubtract(l[Ve],ue[Ae])}}runEuclideanAlgorithm(l,u,m){if(l.getDegree()<u.getDegree()){const Ae=l;l=u,u=Ae}const g=this.field;let y=l,j=u,S=g.getZero(),P=g.getOne();for(;j.getDegree()>=(m/2|0);){let Ae=y,Ve=S;if(y=j,S=P,y.isZero())throw new Be("r_{i-1} was zero");j=Ae;let $e=g.getZero();const st=y.getCoefficient(y.getDegree()),ht=g.inverse(st);for(;j.getDegree()>=y.getDegree()&&!j.isZero();){const Bt=j.getDegree()-y.getDegree(),Vt=g.multiply(j.getCoefficient(j.getDegree()),ht);$e=$e.addOrSubtract(g.buildMonomial(Bt,Vt)),j=j.addOrSubtract(y.multiplyByMonomial(Bt,Vt))}if(P=$e.multiply(S).addOrSubtract(Ve),j.getDegree()>=y.getDegree())throw new ot("Division algorithm failed to reduce polynomial?")}const V=P.getCoefficient(0);if(V===0)throw new Be("sigmaTilde(0) was zero");const K=g.inverse(V),se=P.multiplyScalar(K),ue=j.multiplyScalar(K);return[se,ue]}findErrorLocations(l){const u=l.getDegree();if(u===1)return Int32Array.from([l.getCoefficient(1)]);const m=new Int32Array(u);let g=0;const y=this.field;for(let j=1;j<y.getSize()&&g<u;j++)l.evaluateAt(j)===0&&(m[g]=y.inverse(j),g++);if(g!==u)throw new Be("Error locator degree does not match number of roots");return m}findErrorMagnitudes(l,u){const m=u.length,g=new Int32Array(m),y=this.field;for(let j=0;j<m;j++){const S=y.inverse(u[j]);let P=1;for(let V=0;V<m;V++)if(j!==V){const K=y.multiply(u[V],S),se=K&1?K&-2:K|1;P=y.multiply(P,se)}g[j]=y.multiply(l.evaluateAt(S),y.inverse(P)),y.getGeneratorBase()!==0&&(g[j]=y.multiply(g[j],S))}return g}}var ze;(function(te){te[te.UPPER=0]="UPPER",te[te.LOWER=1]="LOWER",te[te.MIXED=2]="MIXED",te[te.DIGIT=3]="DIGIT",te[te.PUNCT=4]="PUNCT",te[te.BINARY=5]="BINARY"})(ze||(ze={}));class we{decode(l){this.ddata=l;let u=l.getBits(),m=this.extractBits(u),g=this.correctBits(m),y=we.convertBoolArrayToByteArray(g),j=we.getEncodedData(g),S=new fe(y,j,null,null);return S.setNumBits(g.length),S}static highLevelDecode(l){return this.getEncodedData(l)}static getEncodedData(l){let u=l.length,m=ze.UPPER,g=ze.UPPER,y="",j=0;for(;j<u;)if(g===ze.BINARY){if(u-j<5)break;let S=we.readCode(l,j,5);if(j+=5,S===0){if(u-j<11)break;S=we.readCode(l,j,11)+31,j+=11}for(let P=0;P<S;P++){if(u-j<8){j=u;break}const V=we.readCode(l,j,8);y+=Y.castAsNonUtf8Char(V),j+=8}g=m}else{let S=g===ze.DIGIT?4:5;if(u-j<S)break;let P=we.readCode(l,j,S);j+=S;let V=we.getCharacter(g,P);V.startsWith("CTRL_")?(m=g,g=we.getTable(V.charAt(5)),V.charAt(6)==="L"&&(m=g)):(y+=V,g=m)}return y}static getTable(l){switch(l){case"L":return ze.LOWER;case"P":return ze.PUNCT;case"M":return ze.MIXED;case"D":return ze.DIGIT;case"B":return ze.BINARY;case"U":default:return ze.UPPER}}static getCharacter(l,u){switch(l){case ze.UPPER:return we.UPPER_TABLE[u];case ze.LOWER:return we.LOWER_TABLE[u];case ze.MIXED:return we.MIXED_TABLE[u];case ze.PUNCT:return we.PUNCT_TABLE[u];case ze.DIGIT:return we.DIGIT_TABLE[u];default:throw new ot("Bad table")}}correctBits(l){let u,m;this.ddata.getNbLayers()<=2?(m=6,u=Ie.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(m=8,u=Ie.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(m=10,u=Ie.AZTEC_DATA_10):(m=12,u=Ie.AZTEC_DATA_12);let g=this.ddata.getNbDatablocks(),y=l.length/m;if(y<g)throw new D;let j=l.length%m,S=new Int32Array(y);for(let ue=0;ue<y;ue++,j+=m)S[ue]=we.readCode(l,j,m);try{new Se(u).decode(S,y-g)}catch(ue){throw new D(ue)}let P=(1<<m)-1,V=0;for(let ue=0;ue<g;ue++){let Ae=S[ue];if(Ae===0||Ae===P)throw new D;(Ae===1||Ae===P-1)&&V++}let K=new Array(g*m-V),se=0;for(let ue=0;ue<g;ue++){let Ae=S[ue];if(Ae===1||Ae===P-1)K.fill(Ae>1,se,se+m-1),se+=m-1;else for(let Ve=m-1;Ve>=0;--Ve)K[se++]=(Ae&1<<Ve)!==0}return K}extractBits(l){let u=this.ddata.isCompact(),m=this.ddata.getNbLayers(),g=(u?11:14)+m*4,y=new Int32Array(g),j=new Array(this.totalBitsInLayer(m,u));if(u)for(let S=0;S<y.length;S++)y[S]=S;else{let S=g+1+2*k.truncDivision(k.truncDivision(g,2)-1,15),P=g/2,V=k.truncDivision(S,2);for(let K=0;K<P;K++){let se=K+k.truncDivision(K,15);y[P-K-1]=V-se-1,y[P+K]=V+se+1}}for(let S=0,P=0;S<m;S++){let V=(m-S)*4+(u?9:12),K=S*2,se=g-1-K;for(let ue=0;ue<V;ue++){let Ae=ue*2;for(let Ve=0;Ve<2;Ve++)j[P+Ae+Ve]=l.get(y[K+Ve],y[K+ue]),j[P+2*V+Ae+Ve]=l.get(y[K+ue],y[se-Ve]),j[P+4*V+Ae+Ve]=l.get(y[se-Ve],y[se-ue]),j[P+6*V+Ae+Ve]=l.get(y[se-ue],y[K+Ve])}P+=V*8}return j}static readCode(l,u,m){let g=0;for(let y=u;y<u+m;y++)g<<=1,l[y]&&(g|=1);return g}static readByte(l,u){let m=l.length-u;return m>=8?we.readCode(l,u,8):we.readCode(l,u,m)<<8-m}static convertBoolArrayToByteArray(l){let u=new Uint8Array((l.length+7)/8);for(let m=0;m<u.length;m++)u[m]=we.readByte(l,8*m);return u}totalBitsInLayer(l,u){return((u?88:112)+16*l)*l}}we.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],we.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],we.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],we.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],we.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class Le{constructor(){}static round(l){return l===NaN?0:l<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:l>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:l+(l<0?-.5:.5)|0}static distance(l,u,m,g){const y=l-m,j=u-g;return Math.sqrt(y*y+j*j)}static sum(l){let u=0;for(let m=0,g=l.length;m!==g;m++){const y=l[m];u+=y}return u}}class Nt{static floatToIntBits(l){return l}}Nt.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Ge{constructor(l,u){this.x=l,this.y=u}getX(){return this.x}getY(){return this.y}equals(l){if(l instanceof Ge){const u=l;return this.x===u.x&&this.y===u.y}return!1}hashCode(){return 31*Nt.floatToIntBits(this.x)+Nt.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(l){const u=this.distance(l[0],l[1]),m=this.distance(l[1],l[2]),g=this.distance(l[0],l[2]);let y,j,S;if(m>=u&&m>=g?(j=l[0],y=l[1],S=l[2]):g>=m&&g>=u?(j=l[1],y=l[0],S=l[2]):(j=l[2],y=l[0],S=l[1]),this.crossProductZ(y,j,S)<0){const P=y;y=S,S=P}l[0]=y,l[1]=j,l[2]=S}static distance(l,u){return Le.distance(l.x,l.y,u.x,u.y)}static crossProductZ(l,u,m){const g=u.x,y=u.y;return(m.x-g)*(l.y-y)-(m.y-y)*(l.x-g)}}class Lt{constructor(l,u){this.bits=l,this.points=u}getBits(){return this.bits}getPoints(){return this.points}}class ps extends Lt{constructor(l,u,m,g,y){super(l,u),this.compact=m,this.nbDatablocks=g,this.nbLayers=y}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class ns{constructor(l,u,m,g){this.image=l,this.height=l.getHeight(),this.width=l.getWidth(),u==null&&(u=ns.INIT_SIZE),m==null&&(m=l.getWidth()/2|0),g==null&&(g=l.getHeight()/2|0);const y=u/2|0;if(this.leftInit=m-y,this.rightInit=m+y,this.upInit=g-y,this.downInit=g+y,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new H}detect(){let l=this.leftInit,u=this.rightInit,m=this.upInit,g=this.downInit,y=!1,j=!0,S=!1,P=!1,V=!1,K=!1,se=!1;const ue=this.width,Ae=this.height;for(;j;){j=!1;let Ve=!0;for(;(Ve||!P)&&u<ue;)Ve=this.containsBlackPoint(m,g,u,!1),Ve?(u++,j=!0,P=!0):P||u++;if(u>=ue){y=!0;break}let $e=!0;for(;($e||!V)&&g<Ae;)$e=this.containsBlackPoint(l,u,g,!0),$e?(g++,j=!0,V=!0):V||g++;if(g>=Ae){y=!0;break}let st=!0;for(;(st||!K)&&l>=0;)st=this.containsBlackPoint(m,g,l,!1),st?(l--,j=!0,K=!0):K||l--;if(l<0){y=!0;break}let ht=!0;for(;(ht||!se)&&m>=0;)ht=this.containsBlackPoint(l,u,m,!0),ht?(m--,j=!0,se=!0):se||m--;if(m<0){y=!0;break}j&&(S=!0)}if(!y&&S){const Ve=u-l;let $e=null;for(let Vt=1;$e===null&&Vt<Ve;Vt++)$e=this.getBlackPointOnSegment(l,g-Vt,l+Vt,g);if($e==null)throw new H;let st=null;for(let Vt=1;st===null&&Vt<Ve;Vt++)st=this.getBlackPointOnSegment(l,m+Vt,l+Vt,m);if(st==null)throw new H;let ht=null;for(let Vt=1;ht===null&&Vt<Ve;Vt++)ht=this.getBlackPointOnSegment(u,m+Vt,u-Vt,m);if(ht==null)throw new H;let Bt=null;for(let Vt=1;Bt===null&&Vt<Ve;Vt++)Bt=this.getBlackPointOnSegment(u,g-Vt,u-Vt,g);if(Bt==null)throw new H;return this.centerEdges(Bt,$e,ht,st)}else throw new H}getBlackPointOnSegment(l,u,m,g){const y=Le.round(Le.distance(l,u,m,g)),j=(m-l)/y,S=(g-u)/y,P=this.image;for(let V=0;V<y;V++){const K=Le.round(l+V*j),se=Le.round(u+V*S);if(P.get(K,se))return new Ge(K,se)}return null}centerEdges(l,u,m,g){const y=l.getX(),j=l.getY(),S=u.getX(),P=u.getY(),V=m.getX(),K=m.getY(),se=g.getX(),ue=g.getY(),Ae=ns.CORR;return y<this.width/2?[new Ge(se-Ae,ue+Ae),new Ge(S+Ae,P+Ae),new Ge(V-Ae,K-Ae),new Ge(y+Ae,j-Ae)]:[new Ge(se+Ae,ue+Ae),new Ge(S+Ae,P-Ae),new Ge(V-Ae,K+Ae),new Ge(y-Ae,j-Ae)]}containsBlackPoint(l,u,m,g){const y=this.image;if(g){for(let j=l;j<=u;j++)if(y.get(j,m))return!0}else for(let j=l;j<=u;j++)if(y.get(m,j))return!0;return!1}}ns.INIT_SIZE=10,ns.CORR=1;class Ke{static checkAndNudgePoints(l,u){const m=l.getWidth(),g=l.getHeight();let y=!0;for(let j=0;j<u.length&&y;j+=2){const S=Math.floor(u[j]),P=Math.floor(u[j+1]);if(S<-1||S>m||P<-1||P>g)throw new H;y=!1,S===-1?(u[j]=0,y=!0):S===m&&(u[j]=m-1,y=!0),P===-1?(u[j+1]=0,y=!0):P===g&&(u[j+1]=g-1,y=!0)}y=!0;for(let j=u.length-2;j>=0&&y;j-=2){const S=Math.floor(u[j]),P=Math.floor(u[j+1]);if(S<-1||S>m||P<-1||P>g)throw new H;y=!1,S===-1?(u[j]=0,y=!0):S===m&&(u[j]=m-1,y=!0),P===-1?(u[j+1]=0,y=!0):P===g&&(u[j+1]=g-1,y=!0)}}}class dt{constructor(l,u,m,g,y,j,S,P,V){this.a11=l,this.a21=u,this.a31=m,this.a12=g,this.a22=y,this.a32=j,this.a13=S,this.a23=P,this.a33=V}static quadrilateralToQuadrilateral(l,u,m,g,y,j,S,P,V,K,se,ue,Ae,Ve,$e,st){const ht=dt.quadrilateralToSquare(l,u,m,g,y,j,S,P);return dt.squareToQuadrilateral(V,K,se,ue,Ae,Ve,$e,st).times(ht)}transformPoints(l){const u=l.length,m=this.a11,g=this.a12,y=this.a13,j=this.a21,S=this.a22,P=this.a23,V=this.a31,K=this.a32,se=this.a33;for(let ue=0;ue<u;ue+=2){const Ae=l[ue],Ve=l[ue+1],$e=y*Ae+P*Ve+se;l[ue]=(m*Ae+j*Ve+V)/$e,l[ue+1]=(g*Ae+S*Ve+K)/$e}}transformPointsWithValues(l,u){const m=this.a11,g=this.a12,y=this.a13,j=this.a21,S=this.a22,P=this.a23,V=this.a31,K=this.a32,se=this.a33,ue=l.length;for(let Ae=0;Ae<ue;Ae++){const Ve=l[Ae],$e=u[Ae],st=y*Ve+P*$e+se;l[Ae]=(m*Ve+j*$e+V)/st,u[Ae]=(g*Ve+S*$e+K)/st}}static squareToQuadrilateral(l,u,m,g,y,j,S,P){const V=l-m+y-S,K=u-g+j-P;if(V===0&&K===0)return new dt(m-l,y-m,l,g-u,j-g,u,0,0,1);{const se=m-y,ue=S-y,Ae=g-j,Ve=P-j,$e=se*Ve-ue*Ae,st=(V*Ve-ue*K)/$e,ht=(se*K-V*Ae)/$e;return new dt(m-l+st*m,S-l+ht*S,l,g-u+st*g,P-u+ht*P,u,st,ht,1)}}static quadrilateralToSquare(l,u,m,g,y,j,S,P){return dt.squareToQuadrilateral(l,u,m,g,y,j,S,P).buildAdjoint()}buildAdjoint(){return new dt(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(l){return new dt(this.a11*l.a11+this.a21*l.a12+this.a31*l.a13,this.a11*l.a21+this.a21*l.a22+this.a31*l.a23,this.a11*l.a31+this.a21*l.a32+this.a31*l.a33,this.a12*l.a11+this.a22*l.a12+this.a32*l.a13,this.a12*l.a21+this.a22*l.a22+this.a32*l.a23,this.a12*l.a31+this.a22*l.a32+this.a32*l.a33,this.a13*l.a11+this.a23*l.a12+this.a33*l.a13,this.a13*l.a21+this.a23*l.a22+this.a33*l.a23,this.a13*l.a31+this.a23*l.a32+this.a33*l.a33)}}class It extends Ke{sampleGrid(l,u,m,g,y,j,S,P,V,K,se,ue,Ae,Ve,$e,st,ht,Bt,Vt){const Pt=dt.quadrilateralToQuadrilateral(g,y,j,S,P,V,K,se,ue,Ae,Ve,$e,st,ht,Bt,Vt);return this.sampleGridWithTransform(l,u,m,Pt)}sampleGridWithTransform(l,u,m,g){if(u<=0||m<=0)throw new H;const y=new je(u,m),j=new Float32Array(2*u);for(let S=0;S<m;S++){const P=j.length,V=S+.5;for(let K=0;K<P;K+=2)j[K]=K/2+.5,j[K+1]=V;g.transformPoints(j),Ke.checkAndNudgePoints(l,j);try{for(let K=0;K<P;K+=2)l.get(Math.floor(j[K]),Math.floor(j[K+1]))&&y.set(K/2,S)}catch{throw new H}}return y}}class Ut{static setGridSampler(l){Ut.gridSampler=l}static getInstance(){return Ut.gridSampler}}Ut.gridSampler=new It;class ts{constructor(l,u){this.x=l,this.y=u}toResultPoint(){return new Ge(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class us{constructor(l){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=l}detect(){return this.detectMirror(!1)}detectMirror(l){let u=this.getMatrixCenter(),m=this.getBullsEyeCorners(u);if(l){let j=m[0];m[0]=m[2],m[2]=j}this.extractParameters(m);let g=this.sampleGrid(this.image,m[this.shift%4],m[(this.shift+1)%4],m[(this.shift+2)%4],m[(this.shift+3)%4]),y=this.getMatrixCornerPoints(m);return new ps(g,y,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(l){if(!this.isValidPoint(l[0])||!this.isValidPoint(l[1])||!this.isValidPoint(l[2])||!this.isValidPoint(l[3]))throw new H;let u=2*this.nbCenterLayers,m=new Int32Array([this.sampleLine(l[0],l[1],u),this.sampleLine(l[1],l[2],u),this.sampleLine(l[2],l[3],u),this.sampleLine(l[3],l[0],u)]);this.shift=this.getRotation(m,u);let g=0;for(let j=0;j<4;j++){let S=m[(this.shift+j)%4];this.compact?(g<<=7,g+=S>>1&127):(g<<=10,g+=(S>>2&992)+(S>>1&31))}let y=this.getCorrectedParameterData(g,this.compact);this.compact?(this.nbLayers=(y>>6)+1,this.nbDataBlocks=(y&63)+1):(this.nbLayers=(y>>11)+1,this.nbDataBlocks=(y&2047)+1)}getRotation(l,u){let m=0;l.forEach((g,y,j)=>{let S=(g>>u-2<<1)+(g&1);m=(m<<3)+S}),m=((m&1)<<11)+(m>>1);for(let g=0;g<4;g++)if(k.bitCount(m^this.EXPECTED_CORNER_BITS[g])<=2)return g;throw new H}getCorrectedParameterData(l,u){let m,g;u?(m=7,g=2):(m=10,g=4);let y=m-g,j=new Int32Array(m);for(let P=m-1;P>=0;--P)j[P]=l&15,l>>=4;try{new Se(Ie.AZTEC_PARAM).decode(j,y)}catch{throw new H}let S=0;for(let P=0;P<g;P++)S=(S<<4)+j[P];return S}getBullsEyeCorners(l){let u=l,m=l,g=l,y=l,j=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let se=this.getFirstDifferent(u,j,1,-1),ue=this.getFirstDifferent(m,j,1,1),Ae=this.getFirstDifferent(g,j,-1,1),Ve=this.getFirstDifferent(y,j,-1,-1);if(this.nbCenterLayers>2){let $e=this.distancePoint(Ve,se)*this.nbCenterLayers/(this.distancePoint(y,u)*(this.nbCenterLayers+2));if($e<.75||$e>1.25||!this.isWhiteOrBlackRectangle(se,ue,Ae,Ve))break}u=se,m=ue,g=Ae,y=Ve,j=!j}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new H;this.compact=this.nbCenterLayers===5;let S=new Ge(u.getX()+.5,u.getY()-.5),P=new Ge(m.getX()+.5,m.getY()+.5),V=new Ge(g.getX()-.5,g.getY()+.5),K=new Ge(y.getX()-.5,y.getY()-.5);return this.expandSquare([S,P,V,K],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let l,u,m,g;try{let S=new ns(this.image).detect();l=S[0],u=S[1],m=S[2],g=S[3]}catch{let P=this.image.getWidth()/2,V=this.image.getHeight()/2;l=this.getFirstDifferent(new ts(P+7,V-7),!1,1,-1).toResultPoint(),u=this.getFirstDifferent(new ts(P+7,V+7),!1,1,1).toResultPoint(),m=this.getFirstDifferent(new ts(P-7,V+7),!1,-1,1).toResultPoint(),g=this.getFirstDifferent(new ts(P-7,V-7),!1,-1,-1).toResultPoint()}let y=Le.round((l.getX()+g.getX()+u.getX()+m.getX())/4),j=Le.round((l.getY()+g.getY()+u.getY()+m.getY())/4);try{let S=new ns(this.image,15,y,j).detect();l=S[0],u=S[1],m=S[2],g=S[3]}catch{l=this.getFirstDifferent(new ts(y+7,j-7),!1,1,-1).toResultPoint(),u=this.getFirstDifferent(new ts(y+7,j+7),!1,1,1).toResultPoint(),m=this.getFirstDifferent(new ts(y-7,j+7),!1,-1,1).toResultPoint(),g=this.getFirstDifferent(new ts(y-7,j-7),!1,-1,-1).toResultPoint()}return y=Le.round((l.getX()+g.getX()+u.getX()+m.getX())/4),j=Le.round((l.getY()+g.getY()+u.getY()+m.getY())/4),new ts(y,j)}getMatrixCornerPoints(l){return this.expandSquare(l,2*this.nbCenterLayers,this.getDimension())}sampleGrid(l,u,m,g,y){let j=Ut.getInstance(),S=this.getDimension(),P=S/2-this.nbCenterLayers,V=S/2+this.nbCenterLayers;return j.sampleGrid(l,S,S,P,P,V,P,V,V,P,V,u.getX(),u.getY(),m.getX(),m.getY(),g.getX(),g.getY(),y.getX(),y.getY())}sampleLine(l,u,m){let g=0,y=this.distanceResultPoint(l,u),j=y/m,S=l.getX(),P=l.getY(),V=j*(u.getX()-l.getX())/y,K=j*(u.getY()-l.getY())/y;for(let se=0;se<m;se++)this.image.get(Le.round(S+se*V),Le.round(P+se*K))&&(g|=1<<m-se-1);return g}isWhiteOrBlackRectangle(l,u,m,g){let y=3;l=new ts(l.getX()-y,l.getY()+y),u=new ts(u.getX()-y,u.getY()-y),m=new ts(m.getX()+y,m.getY()-y),g=new ts(g.getX()+y,g.getY()+y);let j=this.getColor(g,l);if(j===0)return!1;let S=this.getColor(l,u);return S!==j||(S=this.getColor(u,m),S!==j)?!1:(S=this.getColor(m,g),S===j)}getColor(l,u){let m=this.distancePoint(l,u),g=(u.getX()-l.getX())/m,y=(u.getY()-l.getY())/m,j=0,S=l.getX(),P=l.getY(),V=this.image.get(l.getX(),l.getY()),K=Math.ceil(m);for(let ue=0;ue<K;ue++)S+=g,P+=y,this.image.get(Le.round(S),Le.round(P))!==V&&j++;let se=j/m;return se>.1&&se<.9?0:se<=.1===V?1:-1}getFirstDifferent(l,u,m,g){let y=l.getX()+m,j=l.getY()+g;for(;this.isValid(y,j)&&this.image.get(y,j)===u;)y+=m,j+=g;for(y-=m,j-=g;this.isValid(y,j)&&this.image.get(y,j)===u;)y+=m;for(y-=m;this.isValid(y,j)&&this.image.get(y,j)===u;)j+=g;return j-=g,new ts(y,j)}expandSquare(l,u,m){let g=m/(2*u),y=l[0].getX()-l[2].getX(),j=l[0].getY()-l[2].getY(),S=(l[0].getX()+l[2].getX())/2,P=(l[0].getY()+l[2].getY())/2,V=new Ge(S+g*y,P+g*j),K=new Ge(S-g*y,P-g*j);y=l[1].getX()-l[3].getX(),j=l[1].getY()-l[3].getY(),S=(l[1].getX()+l[3].getX())/2,P=(l[1].getY()+l[3].getY())/2;let se=new Ge(S+g*y,P+g*j),ue=new Ge(S-g*y,P-g*j);return[V,se,K,ue]}isValid(l,u){return l>=0&&l<this.image.getWidth()&&u>0&&u<this.image.getHeight()}isValidPoint(l){let u=Le.round(l.getX()),m=Le.round(l.getY());return this.isValid(u,m)}distancePoint(l,u){return Le.distance(l.getX(),l.getY(),u.getX(),u.getY())}distanceResultPoint(l,u){return Le.distance(l.getX(),l.getY(),u.getX(),u.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(k.truncDivision(this.nbLayers-4,8)+1)+15}}class qe{decode(l,u=null){let m=null,g=new us(l.getBlackMatrix()),y=null,j=null;try{let K=g.detectMirror(!1);y=K.getPoints(),this.reportFoundResultPoints(u,y),j=new we().decode(K)}catch(K){m=K}if(j==null)try{let K=g.detectMirror(!0);y=K.getPoints(),this.reportFoundResultPoints(u,y),j=new we().decode(K)}catch(K){throw m??K}let S=new ie(j.getText(),j.getRawBytes(),j.getNumBits(),y,xe.AZTEC,_.currentTimeMillis()),P=j.getByteSegments();P!=null&&S.putMetadata(me.BYTE_SEGMENTS,P);let V=j.getECLevel();return V!=null&&S.putMetadata(me.ERROR_CORRECTION_LEVEL,V),S}reportFoundResultPoints(l,u){if(l!=null){let m=l.get(O.NEED_RESULT_POINT_CALLBACK);m!=null&&u.forEach((g,y,j)=>{m.foundPossibleResultPoint(g)})}}reset(){}}class jt extends ee{constructor(l=500){super(new qe,l)}}class _t{decode(l,u){try{return this.doDecode(l,u)}catch{if(u&&u.get(O.TRY_HARDER)===!0&&l.isRotateSupported()){const y=l.rotateCounterClockwise(),j=this.doDecode(y,u),S=j.getResultMetadata();let P=270;S!==null&&S.get(me.ORIENTATION)===!0&&(P=P+S.get(me.ORIENTATION)%360),j.putMetadata(me.ORIENTATION,P);const V=j.getResultPoints();if(V!==null){const K=y.getHeight();for(let se=0;se<V.length;se++)V[se]=new Ge(K-V[se].getY()-1,V[se].getX())}return j}else throw new H}}reset(){}doDecode(l,u){const m=l.getWidth(),g=l.getHeight();let y=new I(m);const j=u&&u.get(O.TRY_HARDER)===!0,S=Math.max(1,g>>(j?8:5));let P;j?P=g:P=15;const V=Math.trunc(g/2);for(let K=0;K<P;K++){const se=Math.trunc((K+1)/2),ue=(K&1)===0,Ae=V+S*(ue?se:-se);if(Ae<0||Ae>=g)break;try{y=l.getBlackRow(Ae,y)}catch{continue}for(let Ve=0;Ve<2;Ve++){if(Ve===1&&(y.reverse(),u&&u.get(O.NEED_RESULT_POINT_CALLBACK)===!0)){const $e=new Map;u.forEach((st,ht)=>$e.set(ht,st)),$e.delete(O.NEED_RESULT_POINT_CALLBACK),u=$e}try{const $e=this.decodeRow(Ae,y,u);if(Ve===1){$e.putMetadata(me.ORIENTATION,180);const st=$e.getResultPoints();st!==null&&(st[0]=new Ge(m-st[0].getX()-1,st[0].getY()),st[1]=new Ge(m-st[1].getX()-1,st[1].getY()))}return $e}catch{}}}throw new H}static recordPattern(l,u,m){const g=m.length;for(let V=0;V<g;V++)m[V]=0;const y=l.getSize();if(u>=y)throw new H;let j=!l.get(u),S=0,P=u;for(;P<y;){if(l.get(P)!==j)m[S]++;else{if(++S===g)break;m[S]=1,j=!j}P++}if(!(S===g||S===g-1&&P===y))throw new H}static recordPatternInReverse(l,u,m){let g=m.length,y=l.get(u);for(;u>0&&g>=0;)l.get(--u)!==y&&(g--,y=!y);if(g>=0)throw new H;_t.recordPattern(l,u+1,m)}static patternMatchVariance(l,u,m){const g=l.length;let y=0,j=0;for(let V=0;V<g;V++)y+=l[V],j+=u[V];if(y<j)return Number.POSITIVE_INFINITY;const S=y/j;m*=S;let P=0;for(let V=0;V<g;V++){const K=l[V],se=u[V]*S,ue=K>se?K-se:se-K;if(ue>m)return Number.POSITIVE_INFINITY;P+=ue}return P/y}}class Re extends _t{static findStartPattern(l){const u=l.getSize(),m=l.getNextSet(0);let g=0,y=Int32Array.from([0,0,0,0,0,0]),j=m,S=!1;const P=6;for(let V=m;V<u;V++)if(l.get(V)!==S)y[g]++;else{if(g===P-1){let K=Re.MAX_AVG_VARIANCE,se=-1;for(let ue=Re.CODE_START_A;ue<=Re.CODE_START_C;ue++){const Ae=_t.patternMatchVariance(y,Re.CODE_PATTERNS[ue],Re.MAX_INDIVIDUAL_VARIANCE);Ae<K&&(K=Ae,se=ue)}if(se>=0&&l.isRange(Math.max(0,j-(V-j)/2),j,!1))return Int32Array.from([j,V,se]);j+=y[0]+y[1],y=y.slice(2,y.length-1),y[g-1]=0,y[g]=0,g--}else g++;y[g]=1,S=!S}throw new H}static decodeCode(l,u,m){_t.recordPattern(l,m,u);let g=Re.MAX_AVG_VARIANCE,y=-1;for(let j=0;j<Re.CODE_PATTERNS.length;j++){const S=Re.CODE_PATTERNS[j],P=this.patternMatchVariance(u,S,Re.MAX_INDIVIDUAL_VARIANCE);P<g&&(g=P,y=j)}if(y>=0)return y;throw new H}decodeRow(l,u,m){const g=m&&m.get(O.ASSUME_GS1)===!0,y=Re.findStartPattern(u),j=y[2];let S=0;const P=new Uint8Array(20);P[S++]=j;let V;switch(j){case Re.CODE_START_A:V=Re.CODE_CODE_A;break;case Re.CODE_START_B:V=Re.CODE_CODE_B;break;case Re.CODE_START_C:V=Re.CODE_CODE_C;break;default:throw new D}let K=!1,se=!1,ue="",Ae=y[0],Ve=y[1];const $e=Int32Array.from([0,0,0,0,0,0]);let st=0,ht=0,Bt=j,Vt=0,Pt=!0,pr=!1,Ys=!1;for(;!K;){const lo=se;switch(se=!1,st=ht,ht=Re.decodeCode(u,$e,Ve),P[S++]=ht,ht!==Re.CODE_STOP&&(Pt=!0),ht!==Re.CODE_STOP&&(Vt++,Bt+=Vt*ht),Ae=Ve,Ve+=$e.reduce((v1,Mc)=>v1+Mc,0),ht){case Re.CODE_START_A:case Re.CODE_START_B:case Re.CODE_START_C:throw new D}switch(V){case Re.CODE_CODE_A:if(ht<64)Ys===pr?ue+=String.fromCharCode(32+ht):ue+=String.fromCharCode(32+ht+128),Ys=!1;else if(ht<96)Ys===pr?ue+=String.fromCharCode(ht-64):ue+=String.fromCharCode(ht+64),Ys=!1;else switch(ht!==Re.CODE_STOP&&(Pt=!1),ht){case Re.CODE_FNC_1:g&&(ue.length===0?ue+="]C1":ue+="");break;case Re.CODE_FNC_2:case Re.CODE_FNC_3:break;case Re.CODE_FNC_4_A:!pr&&Ys?(pr=!0,Ys=!1):pr&&Ys?(pr=!1,Ys=!1):Ys=!0;break;case Re.CODE_SHIFT:se=!0,V=Re.CODE_CODE_B;break;case Re.CODE_CODE_B:V=Re.CODE_CODE_B;break;case Re.CODE_CODE_C:V=Re.CODE_CODE_C;break;case Re.CODE_STOP:K=!0;break}break;case Re.CODE_CODE_B:if(ht<96)Ys===pr?ue+=String.fromCharCode(32+ht):ue+=String.fromCharCode(32+ht+128),Ys=!1;else switch(ht!==Re.CODE_STOP&&(Pt=!1),ht){case Re.CODE_FNC_1:g&&(ue.length===0?ue+="]C1":ue+="");break;case Re.CODE_FNC_2:case Re.CODE_FNC_3:break;case Re.CODE_FNC_4_B:!pr&&Ys?(pr=!0,Ys=!1):pr&&Ys?(pr=!1,Ys=!1):Ys=!0;break;case Re.CODE_SHIFT:se=!0,V=Re.CODE_CODE_A;break;case Re.CODE_CODE_A:V=Re.CODE_CODE_A;break;case Re.CODE_CODE_C:V=Re.CODE_CODE_C;break;case Re.CODE_STOP:K=!0;break}break;case Re.CODE_CODE_C:if(ht<100)ht<10&&(ue+="0"),ue+=ht;else switch(ht!==Re.CODE_STOP&&(Pt=!1),ht){case Re.CODE_FNC_1:g&&(ue.length===0?ue+="]C1":ue+="");break;case Re.CODE_CODE_A:V=Re.CODE_CODE_A;break;case Re.CODE_CODE_B:V=Re.CODE_CODE_B;break;case Re.CODE_STOP:K=!0;break}break}lo&&(V=V===Re.CODE_CODE_A?Re.CODE_CODE_B:Re.CODE_CODE_A)}const ma=Ve-Ae;if(Ve=u.getNextUnset(Ve),!u.isRange(Ve,Math.min(u.getSize(),Ve+(Ve-Ae)/2),!1))throw new H;if(Bt-=Vt*st,Bt%103!==st)throw new b;const Bn=ue.length;if(Bn===0)throw new H;Bn>0&&Pt&&(V===Re.CODE_CODE_C?ue=ue.substring(0,Bn-2):ue=ue.substring(0,Bn-1));const Vn=(y[1]+y[0])/2,kr=Ae+ma/2,rn=P.length,Un=new Uint8Array(rn);for(let lo=0;lo<rn;lo++)Un[lo]=P[lo];const Dc=[new Ge(Vn,l),new Ge(kr,l)];return new ie(ue,Un,0,Dc,xe.CODE_128,new Date().getTime())}}Re.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Re.MAX_AVG_VARIANCE=.25,Re.MAX_INDIVIDUAL_VARIANCE=.7,Re.CODE_SHIFT=98,Re.CODE_CODE_C=99,Re.CODE_CODE_B=100,Re.CODE_CODE_A=101,Re.CODE_FNC_1=102,Re.CODE_FNC_2=97,Re.CODE_FNC_3=96,Re.CODE_FNC_4_A=101,Re.CODE_FNC_4_B=100,Re.CODE_START_A=103,Re.CODE_START_B=104,Re.CODE_START_C=105,Re.CODE_STOP=106;class et extends _t{constructor(l=!1,u=!1){super(),this.usingCheckDigit=l,this.extendedMode=u,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(l,u,m){let g=this.counters;g.fill(0),this.decodeRowResult="";let y=et.findAsteriskPattern(u,g),j=u.getNextSet(y[1]),S=u.getSize(),P,V;do{et.recordPattern(u,j,g);let $e=et.toNarrowWidePattern(g);if($e<0)throw new H;P=et.patternToChar($e),this.decodeRowResult+=P,V=j;for(let st of g)j+=st;j=u.getNextSet(j)}while(P!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let K=0;for(let $e of g)K+=$e;let se=j-V-K;if(j!==S&&se*2<K)throw new H;if(this.usingCheckDigit){let $e=this.decodeRowResult.length-1,st=0;for(let ht=0;ht<$e;ht++)st+=et.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(ht));if(this.decodeRowResult.charAt($e)!==et.ALPHABET_STRING.charAt(st%43))throw new b;this.decodeRowResult=this.decodeRowResult.substring(0,$e)}if(this.decodeRowResult.length===0)throw new H;let ue;this.extendedMode?ue=et.decodeExtended(this.decodeRowResult):ue=this.decodeRowResult;let Ae=(y[1]+y[0])/2,Ve=V+K/2;return new ie(ue,null,0,[new Ge(Ae,l),new Ge(Ve,l)],xe.CODE_39,new Date().getTime())}static findAsteriskPattern(l,u){let m=l.getSize(),g=l.getNextSet(0),y=0,j=g,S=!1,P=u.length;for(let V=g;V<m;V++)if(l.get(V)!==S)u[y]++;else{if(y===P-1){if(this.toNarrowWidePattern(u)===et.ASTERISK_ENCODING&&l.isRange(Math.max(0,j-Math.floor((V-j)/2)),j,!1))return[j,V];j+=u[0]+u[1],u.copyWithin(0,2,2+y-1),u[y-1]=0,u[y]=0,y--}else y++;u[y]=1,S=!S}throw new H}static toNarrowWidePattern(l){let u=l.length,m=0,g;do{let y=2147483647;for(let P of l)P<y&&P>m&&(y=P);m=y,g=0;let j=0,S=0;for(let P=0;P<u;P++){let V=l[P];V>m&&(S|=1<<u-1-P,g++,j+=V)}if(g===3){for(let P=0;P<u&&g>0;P++){let V=l[P];if(V>m&&(g--,V*2>=j))return-1}return S}}while(g>3);return-1}static patternToChar(l){for(let u=0;u<et.CHARACTER_ENCODINGS.length;u++)if(et.CHARACTER_ENCODINGS[u]===l)return et.ALPHABET_STRING.charAt(u);if(l===et.ASTERISK_ENCODING)return"*";throw new H}static decodeExtended(l){let u=l.length,m="";for(let g=0;g<u;g++){let y=l.charAt(g);if(y==="+"||y==="$"||y==="%"||y==="/"){let j=l.charAt(g+1),S="\0";switch(y){case"+":if(j>="A"&&j<="Z")S=String.fromCharCode(j.charCodeAt(0)+32);else throw new D;break;case"$":if(j>="A"&&j<="Z")S=String.fromCharCode(j.charCodeAt(0)-64);else throw new D;break;case"%":if(j>="A"&&j<="E")S=String.fromCharCode(j.charCodeAt(0)-38);else if(j>="F"&&j<="J")S=String.fromCharCode(j.charCodeAt(0)-11);else if(j>="K"&&j<="O")S=String.fromCharCode(j.charCodeAt(0)+16);else if(j>="P"&&j<="T")S=String.fromCharCode(j.charCodeAt(0)+43);else if(j==="U")S="\0";else if(j==="V")S="@";else if(j==="W")S="`";else if(j==="X"||j==="Y"||j==="Z")S="";else throw new D;break;case"/":if(j>="A"&&j<="O")S=String.fromCharCode(j.charCodeAt(0)-32);else if(j==="Z")S=":";else throw new D;break}m+=S,g++}else m+=y}return m}}et.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",et.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],et.ASTERISK_ENCODING=148;class Ct extends _t{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(l,u,m){let g=this.decodeStart(u),y=this.decodeEnd(u),j=new ae;Ct.decodeMiddle(u,g[1],y[0],j);let S=j.toString(),P=null;m!=null&&(P=m.get(O.ALLOWED_LENGTHS)),P==null&&(P=Ct.DEFAULT_ALLOWED_LENGTHS);let V=S.length,K=!1,se=0;for(let Ve of P){if(V===Ve){K=!0;break}Ve>se&&(se=Ve)}if(!K&&V>se&&(K=!0),!K)throw new D;const ue=[new Ge(g[1],l),new Ge(y[0],l)];return new ie(S,null,0,ue,xe.ITF,new Date().getTime())}static decodeMiddle(l,u,m,g){let y=new Int32Array(10),j=new Int32Array(5),S=new Int32Array(5);for(y.fill(0),j.fill(0),S.fill(0);u<m;){_t.recordPattern(l,u,y);for(let V=0;V<5;V++){let K=2*V;j[V]=y[K],S[V]=y[K+1]}let P=Ct.decodeDigit(j);g.append(P.toString()),P=this.decodeDigit(S),g.append(P.toString()),y.forEach(function(V){u+=V})}}decodeStart(l){let u=Ct.skipWhiteSpace(l),m=Ct.findGuardPattern(l,u,Ct.START_PATTERN);return this.narrowLineWidth=(m[1]-m[0])/4,this.validateQuietZone(l,m[0]),m}validateQuietZone(l,u){let m=this.narrowLineWidth*10;m=m<u?m:u;for(let g=u-1;m>0&&g>=0&&!l.get(g);g--)m--;if(m!==0)throw new H}static skipWhiteSpace(l){const u=l.getSize(),m=l.getNextSet(0);if(m===u)throw new H;return m}decodeEnd(l){l.reverse();try{let u=Ct.skipWhiteSpace(l),m;try{m=Ct.findGuardPattern(l,u,Ct.END_PATTERN_REVERSED[0])}catch(y){y instanceof H&&(m=Ct.findGuardPattern(l,u,Ct.END_PATTERN_REVERSED[1]))}this.validateQuietZone(l,m[0]);let g=m[0];return m[0]=l.getSize()-m[1],m[1]=l.getSize()-g,m}finally{l.reverse()}}static findGuardPattern(l,u,m){let g=m.length,y=new Int32Array(g),j=l.getSize(),S=!1,P=0,V=u;y.fill(0);for(let K=u;K<j;K++)if(l.get(K)!==S)y[P]++;else{if(P===g-1){if(_t.patternMatchVariance(y,m,Ct.MAX_INDIVIDUAL_VARIANCE)<Ct.MAX_AVG_VARIANCE)return[V,K];V+=y[0]+y[1],_.arraycopy(y,2,y,0,P-1),y[P-1]=0,y[P]=0,P--}else P++;y[P]=1,S=!S}throw new H}static decodeDigit(l){let u=Ct.MAX_AVG_VARIANCE,m=-1,g=Ct.PATTERNS.length;for(let y=0;y<g;y++){let j=Ct.PATTERNS[y],S=_t.patternMatchVariance(l,j,Ct.MAX_INDIVIDUAL_VARIANCE);S<u?(u=S,m=y):S===u&&(m=-1)}if(m>=0)return m%10;throw new H}}Ct.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Ct.MAX_AVG_VARIANCE=.38,Ct.MAX_INDIVIDUAL_VARIANCE=.5,Ct.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Ct.START_PATTERN=Int32Array.from([1,1,1,1]),Ct.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Yt extends _t{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(l){let u=!1,m,g=0,y=Int32Array.from([0,0,0]);for(;!u;){y=Int32Array.from([0,0,0]),m=Yt.findGuardPattern(l,g,!1,this.START_END_PATTERN,y);let j=m[0];g=m[1];let S=j-(g-j);S>=0&&(u=l.isRange(S,j,!1))}return m}static checkChecksum(l){return Yt.checkStandardUPCEANChecksum(l)}static checkStandardUPCEANChecksum(l){let u=l.length;if(u===0)return!1;let m=parseInt(l.charAt(u-1),10);return Yt.getStandardUPCEANChecksum(l.substring(0,u-1))===m}static getStandardUPCEANChecksum(l){let u=l.length,m=0;for(let g=u-1;g>=0;g-=2){let y=l.charAt(g).charCodeAt(0)-48;if(y<0||y>9)throw new D;m+=y}m*=3;for(let g=u-2;g>=0;g-=2){let y=l.charAt(g).charCodeAt(0)-48;if(y<0||y>9)throw new D;m+=y}return(1e3-m)%10}static decodeEnd(l,u){return Yt.findGuardPattern(l,u,!1,Yt.START_END_PATTERN,new Int32Array(Yt.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(l,u,m,g){return this.findGuardPattern(l,u,m,g,new Int32Array(g.length))}static findGuardPattern(l,u,m,g,y){let j=l.getSize();u=m?l.getNextUnset(u):l.getNextSet(u);let S=0,P=u,V=g.length,K=m;for(let se=u;se<j;se++)if(l.get(se)!==K)y[S]++;else{if(S===V-1){if(_t.patternMatchVariance(y,g,Yt.MAX_INDIVIDUAL_VARIANCE)<Yt.MAX_AVG_VARIANCE)return Int32Array.from([P,se]);P+=y[0]+y[1];let ue=y.slice(2,y.length-1);for(let Ae=0;Ae<S-1;Ae++)y[Ae]=ue[Ae];y[S-1]=0,y[S]=0,S--}else S++;y[S]=1,K=!K}throw new H}static decodeDigit(l,u,m,g){this.recordPattern(l,m,u);let y=this.MAX_AVG_VARIANCE,j=-1,S=g.length;for(let P=0;P<S;P++){let V=g[P],K=_t.patternMatchVariance(u,V,Yt.MAX_INDIVIDUAL_VARIANCE);K<y&&(y=K,j=P)}if(j>=0)return j;throw new H}}Yt.MAX_AVG_VARIANCE=.48,Yt.MAX_INDIVIDUAL_VARIANCE=.7,Yt.START_END_PATTERN=Int32Array.from([1,1,1]),Yt.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Yt.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Yt.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class bt{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(l,u,m){let g=this.decodeRowStringBuffer,y=this.decodeMiddle(u,m,g),j=g.toString(),S=bt.parseExtensionString(j),P=[new Ge((m[0]+m[1])/2,l),new Ge(y,l)],V=new ie(j,null,0,P,xe.UPC_EAN_EXTENSION,new Date().getTime());return S!=null&&V.putAllMetadata(S),V}decodeMiddle(l,u,m){let g=this.decodeMiddleCounters;g[0]=0,g[1]=0,g[2]=0,g[3]=0;let y=l.getSize(),j=u[1],S=0;for(let V=0;V<5&&j<y;V++){let K=Yt.decodeDigit(l,g,j,Yt.L_AND_G_PATTERNS);m+=String.fromCharCode(48+K%10);for(let se of g)j+=se;K>=10&&(S|=1<<4-V),V!==4&&(j=l.getNextSet(j),j=l.getNextUnset(j))}if(m.length!==5)throw new H;let P=this.determineCheckDigit(S);if(bt.extensionChecksum(m.toString())!==P)throw new H;return j}static extensionChecksum(l){let u=l.length,m=0;for(let g=u-2;g>=0;g-=2)m+=l.charAt(g).charCodeAt(0)-48;m*=3;for(let g=u-1;g>=0;g-=2)m+=l.charAt(g).charCodeAt(0)-48;return m*=3,m%10}determineCheckDigit(l){for(let u=0;u<10;u++)if(l===this.CHECK_DIGIT_ENCODINGS[u])return u;throw new H}static parseExtensionString(l){if(l.length!==5)return null;let u=bt.parseExtension5String(l);return u==null?null:new Map([[me.SUGGESTED_PRICE,u]])}static parseExtension5String(l){let u;switch(l.charAt(0)){case"0":u="";break;case"5":u="$";break;case"9":switch(l){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}u="";break;default:u="";break}let m=parseInt(l.substring(1)),g=(m/100).toString(),y=m%100,j=y<10?"0"+y:y.toString();return u+g+"."+j}}class Dt{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(l,u,m){let g=this.decodeRowStringBuffer,y=this.decodeMiddle(u,m,g),j=g.toString(),S=Dt.parseExtensionString(j),P=[new Ge((m[0]+m[1])/2,l),new Ge(y,l)],V=new ie(j,null,0,P,xe.UPC_EAN_EXTENSION,new Date().getTime());return S!=null&&V.putAllMetadata(S),V}decodeMiddle(l,u,m){let g=this.decodeMiddleCounters;g[0]=0,g[1]=0,g[2]=0,g[3]=0;let y=l.getSize(),j=u[1],S=0;for(let P=0;P<2&&j<y;P++){let V=Yt.decodeDigit(l,g,j,Yt.L_AND_G_PATTERNS);m+=String.fromCharCode(48+V%10);for(let K of g)j+=K;V>=10&&(S|=1<<1-P),P!==1&&(j=l.getNextSet(j),j=l.getNextUnset(j))}if(m.length!==2)throw new H;if(parseInt(m.toString())%4!==S)throw new H;return j}static parseExtensionString(l){return l.length!==2?null:new Map([[me.ISSUE_NUMBER,parseInt(l)]])}}class Jt{static decodeRow(l,u,m){let g=Yt.findGuardPattern(u,m,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new bt().decodeRow(l,u,g)}catch{return new Dt().decodeRow(l,u,g)}}}Jt.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Oe extends Yt{constructor(){super(),this.decodeRowStringBuffer="",Oe.L_AND_G_PATTERNS=Oe.L_PATTERNS.map(l=>Int32Array.from(l));for(let l=10;l<20;l++){let u=Oe.L_PATTERNS[l-10],m=new Int32Array(u.length);for(let g=0;g<u.length;g++)m[g]=u[u.length-g-1];Oe.L_AND_G_PATTERNS[l]=m}}decodeRow(l,u,m){let g=Oe.findStartGuardPattern(u),y=m==null?null:m.get(O.NEED_RESULT_POINT_CALLBACK);if(y!=null){const Pt=new Ge((g[0]+g[1])/2,l);y.foundPossibleResultPoint(Pt)}let j=this.decodeMiddle(u,g,this.decodeRowStringBuffer),S=j.rowOffset,P=j.resultString;if(y!=null){const Pt=new Ge(S,l);y.foundPossibleResultPoint(Pt)}let V=this.decodeEnd(u,S);if(y!=null){const Pt=new Ge((V[0]+V[1])/2,l);y.foundPossibleResultPoint(Pt)}let K=V[1],se=K+(K-V[0]);if(se>=u.getSize()||!u.isRange(K,se,!1))throw new H;let ue=P.toString();if(ue.length<8)throw new D;if(!Oe.checkChecksum(ue))throw new b;let Ae=(g[1]+g[0])/2,Ve=(V[1]+V[0])/2,$e=this.getBarcodeFormat(),st=[new Ge(Ae,l),new Ge(Ve,l)],ht=new ie(ue,null,0,st,$e,new Date().getTime()),Bt=0;try{let Pt=Jt.decodeRow(l,u,V[1]);ht.putMetadata(me.UPC_EAN_EXTENSION,Pt.getText()),ht.putAllMetadata(Pt.getResultMetadata()),ht.addResultPoints(Pt.getResultPoints()),Bt=Pt.getText().length}catch{}let Vt=m==null?null:m.get(O.ALLOWED_EAN_EXTENSIONS);if(Vt!=null){let Pt=!1;for(let pr in Vt)if(Bt.toString()===pr){Pt=!0;break}if(!Pt)throw new H}return ht}decodeEnd(l,u){return Oe.findGuardPattern(l,u,!1,Oe.START_END_PATTERN,new Int32Array(Oe.START_END_PATTERN.length).fill(0))}static checkChecksum(l){return Oe.checkStandardUPCEANChecksum(l)}static checkStandardUPCEANChecksum(l){let u=l.length;if(u===0)return!1;let m=parseInt(l.charAt(u-1),10);return Oe.getStandardUPCEANChecksum(l.substring(0,u-1))===m}static getStandardUPCEANChecksum(l){let u=l.length,m=0;for(let g=u-1;g>=0;g-=2){let y=l.charAt(g).charCodeAt(0)-48;if(y<0||y>9)throw new D;m+=y}m*=3;for(let g=u-2;g>=0;g-=2){let y=l.charAt(g).charCodeAt(0)-48;if(y<0||y>9)throw new D;m+=y}return(1e3-m)%10}}class Xe extends Oe{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(l,u,m){let g=this.decodeMiddleCounters;g[0]=0,g[1]=0,g[2]=0,g[3]=0;let y=l.getSize(),j=u[1],S=0;for(let V=0;V<6&&j<y;V++){let K=Oe.decodeDigit(l,g,j,Oe.L_AND_G_PATTERNS);m+=String.fromCharCode(48+K%10);for(let se of g)j+=se;K>=10&&(S|=1<<5-V)}m=Xe.determineFirstDigit(m,S),j=Oe.findGuardPattern(l,j,!0,Oe.MIDDLE_PATTERN,new Int32Array(Oe.MIDDLE_PATTERN.length).fill(0))[1];for(let V=0;V<6&&j<y;V++){let K=Oe.decodeDigit(l,g,j,Oe.L_PATTERNS);m+=String.fromCharCode(48+K);for(let se of g)j+=se}return{rowOffset:j,resultString:m}}getBarcodeFormat(){return xe.EAN_13}static determineFirstDigit(l,u){for(let m=0;m<10;m++)if(u===this.FIRST_DIGIT_ENCODINGS[m])return l=String.fromCharCode(48+m)+l,l;throw new H}}Xe.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class zt extends Oe{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(l,u,m){const g=this.decodeMiddleCounters;g[0]=0,g[1]=0,g[2]=0,g[3]=0;let y=l.getSize(),j=u[1];for(let P=0;P<4&&j<y;P++){let V=Oe.decodeDigit(l,g,j,Oe.L_PATTERNS);m+=String.fromCharCode(48+V);for(let K of g)j+=K}j=Oe.findGuardPattern(l,j,!0,Oe.MIDDLE_PATTERN,new Int32Array(Oe.MIDDLE_PATTERN.length).fill(0))[1];for(let P=0;P<4&&j<y;P++){let V=Oe.decodeDigit(l,g,j,Oe.L_PATTERNS);m+=String.fromCharCode(48+V);for(let K of g)j+=K}return{rowOffset:j,resultString:m}}getBarcodeFormat(){return xe.EAN_8}}class qt extends Oe{constructor(){super(...arguments),this.ean13Reader=new Xe}getBarcodeFormat(){return xe.UPC_A}decode(l,u){return this.maybeReturnResult(this.ean13Reader.decode(l))}decodeRow(l,u,m){return this.maybeReturnResult(this.ean13Reader.decodeRow(l,u,m))}decodeMiddle(l,u,m){return this.ean13Reader.decodeMiddle(l,u,m)}maybeReturnResult(l){let u=l.getText();if(u.charAt(0)==="0"){let m=new ie(u.substring(1),null,null,l.getResultPoints(),xe.UPC_A);return l.getResultMetadata()!=null&&m.putAllMetadata(l.getResultMetadata()),m}else throw new H}reset(){this.ean13Reader.reset()}}class St extends Oe{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(l,u,m){const g=this.decodeMiddleCounters.map(V=>V);g[0]=0,g[1]=0,g[2]=0,g[3]=0;const y=l.getSize();let j=u[1],S=0;for(let V=0;V<6&&j<y;V++){const K=St.decodeDigit(l,g,j,St.L_AND_G_PATTERNS);m+=String.fromCharCode(48+K%10);for(let se of g)j+=se;K>=10&&(S|=1<<5-V)}let P=St.determineNumSysAndCheckDigit(m,S);return{rowOffset:j,resultString:P}}decodeEnd(l,u){return St.findGuardPatternWithoutCounters(l,u,!0,St.MIDDLE_END_PATTERN)}checkChecksum(l){return Oe.checkChecksum(St.convertUPCEtoUPCA(l))}static determineNumSysAndCheckDigit(l,u){for(let m=0;m<=1;m++)for(let g=0;g<10;g++)if(u===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[m][g]){let y=String.fromCharCode(48+m),j=String.fromCharCode(48+g);return y+l+j}throw H.getNotFoundInstance()}getBarcodeFormat(){return xe.UPC_E}static convertUPCEtoUPCA(l){const u=l.slice(1,7).split("").map(y=>y.charCodeAt(0)),m=new ae;m.append(l.charAt(0));let g=u[5];switch(g){case 0:case 1:case 2:m.appendChars(u,0,2),m.append(g),m.append("0000"),m.appendChars(u,2,3);break;case 3:m.appendChars(u,0,3),m.append("00000"),m.appendChars(u,3,2);break;case 4:m.appendChars(u,0,4),m.append("00000"),m.append(u[4]);break;default:m.appendChars(u,0,5),m.append("0000"),m.append(g);break}return l.length>=8&&m.append(l.charAt(7)),m.toString()}}St.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),St.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class ls extends _t{constructor(l){super();let u=l==null?null:l.get(O.POSSIBLE_FORMATS),m=[];a(u)?(m.push(new Xe),m.push(new qt),m.push(new zt),m.push(new St)):(u.indexOf(xe.EAN_13)>-1&&m.push(new Xe),u.indexOf(xe.UPC_A)>-1&&m.push(new qt),u.indexOf(xe.EAN_8)>-1&&m.push(new zt),u.indexOf(xe.UPC_E)>-1&&m.push(new St)),this.readers=m}decodeRow(l,u,m){for(let g of this.readers)try{const y=g.decodeRow(l,u,m),j=y.getBarcodeFormat()===xe.EAN_13&&y.getText().charAt(0)==="0",S=m==null?null:m.get(O.POSSIBLE_FORMATS),P=S==null||S.includes(xe.UPC_A);if(j&&P){const V=y.getRawBytes(),K=new ie(y.getText().substring(1),V,V?V.length:null,y.getResultPoints(),xe.UPC_A);return K.putAllMetadata(y.getResultMetadata()),K}return y}catch{}throw new H}reset(){for(let l of this.readers)l.reset()}}class is extends _t{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(l,u){for(let m=0;m<u.length;m++)if(_t.patternMatchVariance(l,u[m],is.MAX_INDIVIDUAL_VARIANCE)<is.MAX_AVG_VARIANCE)return m;throw new H}static count(l){return Le.sum(new Int32Array(l))}static increment(l,u){let m=0,g=u[0];for(let y=1;y<l.length;y++)u[y]>g&&(g=u[y],m=y);l[m]++}static decrement(l,u){let m=0,g=u[0];for(let y=1;y<l.length;y++)u[y]<g&&(g=u[y],m=y);l[m]--}static isFinderPattern(l){let u=l[0]+l[1],m=u+l[2]+l[3],g=u/m;if(g>=is.MIN_FINDER_PATTERN_RATIO&&g<=is.MAX_FINDER_PATTERN_RATIO){let y=Number.MAX_SAFE_INTEGER,j=Number.MIN_SAFE_INTEGER;for(let S of l)S>j&&(j=S),S<y&&(y=S);return j<10*y}return!1}}is.MAX_AVG_VARIANCE=.2,is.MAX_INDIVIDUAL_VARIANCE=.45,is.MIN_FINDER_PATTERN_RATIO=9.5/12,is.MAX_FINDER_PATTERN_RATIO=12.5/14;class ws{constructor(l,u){this.value=l,this.checksumPortion=u}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(l){if(!(l instanceof ws))return!1;const u=l;return this.value===u.value&&this.checksumPortion===u.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class Bs{constructor(l,u,m,g,y){this.value=l,this.startEnd=u,this.value=l,this.startEnd=u,this.resultPoints=new Array,this.resultPoints.push(new Ge(m,y)),this.resultPoints.push(new Ge(g,y))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(l){if(!(l instanceof Bs))return!1;const u=l;return this.value===u.value}hashCode(){return this.value}}class js{constructor(){}static getRSSvalue(l,u,m){let g=0;for(let P of l)g+=P;let y=0,j=0,S=l.length;for(let P=0;P<S-1;P++){let V;for(V=1,j|=1<<P;V<l[P];V++,j&=~(1<<P)){let K=js.combins(g-V-1,S-P-2);if(m&&j===0&&g-V-(S-P-1)>=S-P-1&&(K-=js.combins(g-V-(S-P),S-P-2)),S-P-1>1){let se=0;for(let ue=g-V-(S-P-2);ue>u;ue--)se+=js.combins(g-V-ue-1,S-P-3);K-=se*(S-1-P)}else g-V>u&&K--;y+=K}g-=V}return y}static combins(l,u){let m,g;l-u>u?(g=u,m=l-u):(g=l-u,m=u);let y=1,j=1;for(let S=l;S>m;S--)y*=S,j<=g&&(y/=j,j++);for(;j<=g;)y/=j,j++;return y}}class ha{static buildBitArray(l){let u=l.length*2-1;l[l.length-1].getRightChar()==null&&(u-=1);let m=12*u,g=new I(m),y=0,S=l[0].getRightChar().getValue();for(let P=11;P>=0;--P)S&1<<P&&g.set(y),y++;for(let P=1;P<l.length;++P){let V=l[P],K=V.getLeftChar().getValue();for(let se=11;se>=0;--se)K&1<<se&&g.set(y),y++;if(V.getRightChar()!=null){let se=V.getRightChar().getValue();for(let ue=11;ue>=0;--ue)se&1<<ue&&g.set(y),y++}}return g}}class $r{constructor(l,u){u?this.decodedInformation=null:(this.finished=l,this.decodedInformation=u)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class _a{constructor(l){this.newPosition=l}getNewPosition(){return this.newPosition}}class Or extends _a{constructor(l,u){super(l),this.value=u}getValue(){return this.value}isFNC1(){return this.value===Or.FNC1}}Or.FNC1="$";class Gt extends _a{constructor(l,u,m){super(l),m?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=u}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class de extends _a{constructor(l,u,m){if(super(l),u<0||u>10||m<0||m>10)throw new D;this.firstDigit=u,this.secondDigit=m}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===de.FNC1}isSecondDigitFNC1(){return this.secondDigit===de.FNC1}isAnyFNC1(){return this.firstDigit===de.FNC1||this.secondDigit===de.FNC1}}de.FNC1=10;class pe{constructor(){}static parseFieldsInGeneralPurpose(l){if(!l)return null;if(l.length<2)throw new H;let u=l.substring(0,2);for(let y of pe.TWO_DIGIT_DATA_LENGTH)if(y[0]===u)return y[1]===pe.VARIABLE_LENGTH?pe.processVariableAI(2,y[2],l):pe.processFixedAI(2,y[1],l);if(l.length<3)throw new H;let m=l.substring(0,3);for(let y of pe.THREE_DIGIT_DATA_LENGTH)if(y[0]===m)return y[1]===pe.VARIABLE_LENGTH?pe.processVariableAI(3,y[2],l):pe.processFixedAI(3,y[1],l);for(let y of pe.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(y[0]===m)return y[1]===pe.VARIABLE_LENGTH?pe.processVariableAI(4,y[2],l):pe.processFixedAI(4,y[1],l);if(l.length<4)throw new H;let g=l.substring(0,4);for(let y of pe.FOUR_DIGIT_DATA_LENGTH)if(y[0]===g)return y[1]===pe.VARIABLE_LENGTH?pe.processVariableAI(4,y[2],l):pe.processFixedAI(4,y[1],l);throw new H}static processFixedAI(l,u,m){if(m.length<l)throw new H;let g=m.substring(0,l);if(m.length<l+u)throw new H;let y=m.substring(l,l+u),j=m.substring(l+u),S="("+g+")"+y,P=pe.parseFieldsInGeneralPurpose(j);return P==null?S:S+P}static processVariableAI(l,u,m){let g=m.substring(0,l),y;m.length<l+u?y=m.length:y=l+u;let j=m.substring(l,y),S=m.substring(y),P="("+g+")"+j,V=pe.parseFieldsInGeneralPurpose(S);return V==null?P:P+V}}pe.VARIABLE_LENGTH=[],pe.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",pe.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",pe.VARIABLE_LENGTH,20],["22",pe.VARIABLE_LENGTH,29],["30",pe.VARIABLE_LENGTH,8],["37",pe.VARIABLE_LENGTH,8],["90",pe.VARIABLE_LENGTH,30],["91",pe.VARIABLE_LENGTH,30],["92",pe.VARIABLE_LENGTH,30],["93",pe.VARIABLE_LENGTH,30],["94",pe.VARIABLE_LENGTH,30],["95",pe.VARIABLE_LENGTH,30],["96",pe.VARIABLE_LENGTH,30],["97",pe.VARIABLE_LENGTH,3],["98",pe.VARIABLE_LENGTH,30],["99",pe.VARIABLE_LENGTH,30]],pe.THREE_DIGIT_DATA_LENGTH=[["240",pe.VARIABLE_LENGTH,30],["241",pe.VARIABLE_LENGTH,30],["242",pe.VARIABLE_LENGTH,6],["250",pe.VARIABLE_LENGTH,30],["251",pe.VARIABLE_LENGTH,30],["253",pe.VARIABLE_LENGTH,17],["254",pe.VARIABLE_LENGTH,20],["400",pe.VARIABLE_LENGTH,30],["401",pe.VARIABLE_LENGTH,30],["402",17],["403",pe.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",pe.VARIABLE_LENGTH,20],["421",pe.VARIABLE_LENGTH,15],["422",3],["423",pe.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],pe.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",pe.VARIABLE_LENGTH,15],["391",pe.VARIABLE_LENGTH,18],["392",pe.VARIABLE_LENGTH,15],["393",pe.VARIABLE_LENGTH,18],["703",pe.VARIABLE_LENGTH,30]],pe.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",pe.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",pe.VARIABLE_LENGTH,20],["8003",pe.VARIABLE_LENGTH,30],["8004",pe.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",pe.VARIABLE_LENGTH,30],["8008",pe.VARIABLE_LENGTH,12],["8018",18],["8020",pe.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",pe.VARIABLE_LENGTH,70],["8200",pe.VARIABLE_LENGTH,70]];class ge{constructor(l){this.buffer=new ae,this.information=l}decodeAllCodes(l,u){let m=u,g=null;do{let y=this.decodeGeneralPurposeField(m,g),j=pe.parseFieldsInGeneralPurpose(y.getNewString());if(j!=null&&l.append(j),y.isRemaining()?g=""+y.getRemainingValue():g=null,m===y.getNewPosition())break;m=y.getNewPosition()}while(!0);return l.toString()}isStillNumeric(l){if(l+7>this.information.getSize())return l+4<=this.information.getSize();for(let u=l;u<l+3;++u)if(this.information.get(u))return!0;return this.information.get(l+3)}decodeNumeric(l){if(l+7>this.information.getSize()){let y=this.extractNumericValueFromBitArray(l,4);return y===0?new de(this.information.getSize(),de.FNC1,de.FNC1):new de(this.information.getSize(),y-1,de.FNC1)}let u=this.extractNumericValueFromBitArray(l,7),m=(u-8)/11,g=(u-8)%11;return new de(l+7,m,g)}extractNumericValueFromBitArray(l,u){return ge.extractNumericValueFromBitArray(this.information,l,u)}static extractNumericValueFromBitArray(l,u,m){let g=0;for(let y=0;y<m;++y)l.get(u+y)&&(g|=1<<m-y-1);return g}decodeGeneralPurposeField(l,u){this.buffer.setLengthToZero(),u!=null&&this.buffer.append(u),this.current.setPosition(l);let m=this.parseBlocks();return m!=null&&m.isRemaining()?new Gt(this.current.getPosition(),this.buffer.toString(),m.getRemainingValue()):new Gt(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let l,u;do{let m=this.current.getPosition();if(this.current.isAlpha()?(u=this.parseAlphaBlock(),l=u.isFinished()):this.current.isIsoIec646()?(u=this.parseIsoIec646Block(),l=u.isFinished()):(u=this.parseNumericBlock(),l=u.isFinished()),!(m!==this.current.getPosition())&&!l)break}while(!l);return u.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let l=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(l.getNewPosition()),l.isFirstDigitFNC1()){let u;return l.isSecondDigitFNC1()?u=new Gt(this.current.getPosition(),this.buffer.toString()):u=new Gt(this.current.getPosition(),this.buffer.toString(),l.getSecondDigit()),new $r(!0,u)}if(this.buffer.append(l.getFirstDigit()),l.isSecondDigitFNC1()){let u=new Gt(this.current.getPosition(),this.buffer.toString());return new $r(!0,u)}this.buffer.append(l.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new $r(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let l=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(l.getNewPosition()),l.isFNC1()){let u=new Gt(this.current.getPosition(),this.buffer.toString());return new $r(!0,u)}this.buffer.append(l.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new $r(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let l=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(l.getNewPosition()),l.isFNC1()){let u=new Gt(this.current.getPosition(),this.buffer.toString());return new $r(!0,u)}this.buffer.append(l.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new $r(!1)}isStillIsoIec646(l){if(l+5>this.information.getSize())return!1;let u=this.extractNumericValueFromBitArray(l,5);if(u>=5&&u<16)return!0;if(l+7>this.information.getSize())return!1;let m=this.extractNumericValueFromBitArray(l,7);if(m>=64&&m<116)return!0;if(l+8>this.information.getSize())return!1;let g=this.extractNumericValueFromBitArray(l,8);return g>=232&&g<253}decodeIsoIec646(l){let u=this.extractNumericValueFromBitArray(l,5);if(u===15)return new Or(l+5,Or.FNC1);if(u>=5&&u<15)return new Or(l+5,"0"+(u-5));let m=this.extractNumericValueFromBitArray(l,7);if(m>=64&&m<90)return new Or(l+7,""+(m+1));if(m>=90&&m<116)return new Or(l+7,""+(m+7));let g=this.extractNumericValueFromBitArray(l,8),y;switch(g){case 232:y="!";break;case 233:y='"';break;case 234:y="%";break;case 235:y="&";break;case 236:y="'";break;case 237:y="(";break;case 238:y=")";break;case 239:y="*";break;case 240:y="+";break;case 241:y=",";break;case 242:y="-";break;case 243:y=".";break;case 244:y="/";break;case 245:y=":";break;case 246:y=";";break;case 247:y="<";break;case 248:y="=";break;case 249:y=">";break;case 250:y="?";break;case 251:y="_";break;case 252:y=" ";break;default:throw new D}return new Or(l+8,y)}isStillAlpha(l){if(l+5>this.information.getSize())return!1;let u=this.extractNumericValueFromBitArray(l,5);if(u>=5&&u<16)return!0;if(l+6>this.information.getSize())return!1;let m=this.extractNumericValueFromBitArray(l,6);return m>=16&&m<63}decodeAlphanumeric(l){let u=this.extractNumericValueFromBitArray(l,5);if(u===15)return new Or(l+5,Or.FNC1);if(u>=5&&u<15)return new Or(l+5,"0"+(u-5));let m=this.extractNumericValueFromBitArray(l,6);if(m>=32&&m<58)return new Or(l+6,""+(m+33));let g;switch(m){case 58:g="*";break;case 59:g=",";break;case 60:g="-";break;case 61:g=".";break;case 62:g="/";break;default:throw new ot("Decoding invalid alphanumeric value: "+m)}return new Or(l+6,g)}isAlphaTo646ToAlphaLatch(l){if(l+1>this.information.getSize())return!1;for(let u=0;u<5&&u+l<this.information.getSize();++u)if(u===2){if(!this.information.get(l+2))return!1}else if(this.information.get(l+u))return!1;return!0}isAlphaOr646ToNumericLatch(l){if(l+3>this.information.getSize())return!1;for(let u=l;u<l+3;++u)if(this.information.get(u))return!1;return!0}isNumericToAlphaNumericLatch(l){if(l+1>this.information.getSize())return!1;for(let u=0;u<4&&u+l<this.information.getSize();++u)if(this.information.get(l+u))return!1;return!0}}class be{constructor(l){this.information=l,this.generalDecoder=new ge(l)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Te extends be{constructor(l){super(l)}encodeCompressedGtin(l,u){l.append("(01)");let m=l.length();l.append("9"),this.encodeCompressedGtinWithoutAI(l,u,m)}encodeCompressedGtinWithoutAI(l,u,m){for(let g=0;g<4;++g){let y=this.getGeneralDecoder().extractNumericValueFromBitArray(u+10*g,10);y/100===0&&l.append("0"),y/10===0&&l.append("0"),l.append(y)}Te.appendCheckDigit(l,m)}static appendCheckDigit(l,u){let m=0;for(let g=0;g<13;g++){let y=l.charAt(g+u).charCodeAt(0)-48;m+=g&1?y:3*y}m=10-m%10,m===10&&(m=0),l.append(m)}}Te.GTIN_SIZE=40;class Pe extends Te{constructor(l){super(l)}parseInformation(){let l=new ae;l.append("(01)");let u=l.length(),m=this.getGeneralDecoder().extractNumericValueFromBitArray(Pe.HEADER_SIZE,4);return l.append(m),this.encodeCompressedGtinWithoutAI(l,Pe.HEADER_SIZE+4,u),this.getGeneralDecoder().decodeAllCodes(l,Pe.HEADER_SIZE+44)}}Pe.HEADER_SIZE=4;class nt extends be{constructor(l){super(l)}parseInformation(){let l=new ae;return this.getGeneralDecoder().decodeAllCodes(l,nt.HEADER_SIZE)}}nt.HEADER_SIZE=5;class vt extends Te{constructor(l){super(l)}encodeCompressedWeight(l,u,m){let g=this.getGeneralDecoder().extractNumericValueFromBitArray(u,m);this.addWeightCode(l,g);let y=this.checkWeight(g),j=1e5;for(let S=0;S<5;++S)y/j===0&&l.append("0"),j/=10;l.append(y)}}class tt extends vt{constructor(l){super(l)}parseInformation(){if(this.getInformation().getSize()!=tt.HEADER_SIZE+vt.GTIN_SIZE+tt.WEIGHT_SIZE)throw new H;let l=new ae;return this.encodeCompressedGtin(l,tt.HEADER_SIZE),this.encodeCompressedWeight(l,tt.HEADER_SIZE+vt.GTIN_SIZE,tt.WEIGHT_SIZE),l.toString()}}tt.HEADER_SIZE=5,tt.WEIGHT_SIZE=15;class lt extends tt{constructor(l){super(l)}addWeightCode(l,u){l.append("(3103)")}checkWeight(l){return l}}class ut extends tt{constructor(l){super(l)}addWeightCode(l,u){u<1e4?l.append("(3202)"):l.append("(3203)")}checkWeight(l){return l<1e4?l:l-1e4}}class kt extends Te{constructor(l){super(l)}parseInformation(){if(this.getInformation().getSize()<kt.HEADER_SIZE+Te.GTIN_SIZE)throw new H;let l=new ae;this.encodeCompressedGtin(l,kt.HEADER_SIZE);let u=this.getGeneralDecoder().extractNumericValueFromBitArray(kt.HEADER_SIZE+Te.GTIN_SIZE,kt.LAST_DIGIT_SIZE);l.append("(392"),l.append(u),l.append(")");let m=this.getGeneralDecoder().decodeGeneralPurposeField(kt.HEADER_SIZE+Te.GTIN_SIZE+kt.LAST_DIGIT_SIZE,null);return l.append(m.getNewString()),l.toString()}}kt.HEADER_SIZE=8,kt.LAST_DIGIT_SIZE=2;class Ot extends Te{constructor(l){super(l)}parseInformation(){if(this.getInformation().getSize()<Ot.HEADER_SIZE+Te.GTIN_SIZE)throw new H;let l=new ae;this.encodeCompressedGtin(l,Ot.HEADER_SIZE);let u=this.getGeneralDecoder().extractNumericValueFromBitArray(Ot.HEADER_SIZE+Te.GTIN_SIZE,Ot.LAST_DIGIT_SIZE);l.append("(393"),l.append(u),l.append(")");let m=this.getGeneralDecoder().extractNumericValueFromBitArray(Ot.HEADER_SIZE+Te.GTIN_SIZE+Ot.LAST_DIGIT_SIZE,Ot.FIRST_THREE_DIGITS_SIZE);m/100==0&&l.append("0"),m/10==0&&l.append("0"),l.append(m);let g=this.getGeneralDecoder().decodeGeneralPurposeField(Ot.HEADER_SIZE+Te.GTIN_SIZE+Ot.LAST_DIGIT_SIZE+Ot.FIRST_THREE_DIGITS_SIZE,null);return l.append(g.getNewString()),l.toString()}}Ot.HEADER_SIZE=8,Ot.LAST_DIGIT_SIZE=2,Ot.FIRST_THREE_DIGITS_SIZE=10;class Ft extends vt{constructor(l,u,m){super(l),this.dateCode=m,this.firstAIdigits=u}parseInformation(){if(this.getInformation().getSize()!=Ft.HEADER_SIZE+Ft.GTIN_SIZE+Ft.WEIGHT_SIZE+Ft.DATE_SIZE)throw new H;let l=new ae;return this.encodeCompressedGtin(l,Ft.HEADER_SIZE),this.encodeCompressedWeight(l,Ft.HEADER_SIZE+Ft.GTIN_SIZE,Ft.WEIGHT_SIZE),this.encodeCompressedDate(l,Ft.HEADER_SIZE+Ft.GTIN_SIZE+Ft.WEIGHT_SIZE),l.toString()}encodeCompressedDate(l,u){let m=this.getGeneralDecoder().extractNumericValueFromBitArray(u,Ft.DATE_SIZE);if(m==38400)return;l.append("("),l.append(this.dateCode),l.append(")");let g=m%32;m/=32;let y=m%12+1;m/=12;let j=m;j/10==0&&l.append("0"),l.append(j),y/10==0&&l.append("0"),l.append(y),g/10==0&&l.append("0"),l.append(g)}addWeightCode(l,u){l.append("("),l.append(this.firstAIdigits),l.append(u/1e5),l.append(")")}checkWeight(l){return l%1e5}}Ft.HEADER_SIZE=8,Ft.WEIGHT_SIZE=20,Ft.DATE_SIZE=16;function Mt(te){try{if(te.get(1))return new Pe(te);if(!te.get(2))return new nt(te);switch(ge.extractNumericValueFromBitArray(te,1,4)){case 4:return new lt(te);case 5:return new ut(te)}switch(ge.extractNumericValueFromBitArray(te,1,5)){case 12:return new kt(te);case 13:return new Ot(te)}switch(ge.extractNumericValueFromBitArray(te,1,7)){case 56:return new Ft(te,"310","11");case 57:return new Ft(te,"320","11");case 58:return new Ft(te,"310","13");case 59:return new Ft(te,"320","13");case 60:return new Ft(te,"310","15");case 61:return new Ft(te,"320","15");case 62:return new Ft(te,"310","17");case 63:return new Ft(te,"320","17")}}catch(l){throw console.log(l),new ot("unknown decoder: "+te)}}class Xt{constructor(l,u,m,g){this.leftchar=l,this.rightchar=u,this.finderpattern=m,this.maybeLast=g}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(l,u){return l instanceof Xt?Xt.equalsOrNull(l.leftchar,u.leftchar)&&Xt.equalsOrNull(l.rightchar,u.rightchar)&&Xt.equalsOrNull(l.finderpattern,u.finderpattern):!1}static equalsOrNull(l,u){return l===null?u===null:Xt.equals(l,u)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class Ds{constructor(l,u,m){this.pairs=l,this.rowNumber=u,this.wasReversed=m}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(l){return this.checkEqualitity(this,l)}toString(){return"{ "+this.pairs+" }"}equals(l,u){return l instanceof Ds?this.checkEqualitity(l,u)&&l.wasReversed===u.wasReversed:!1}checkEqualitity(l,u){if(!l||!u)return;let m;return l.forEach((g,y)=>{u.forEach(j=>{g.getLeftChar().getValue()===j.getLeftChar().getValue()&&g.getRightChar().getValue()===j.getRightChar().getValue()&&g.getFinderPatter().getValue()===j.getFinderPatter().getValue()&&(m=!0)})}),m}}class gt extends is{constructor(l){super(...arguments),this.pairs=new Array(gt.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=l===!0}decodeRow(l,u,m){this.pairs.length=0,this.startFromEven=!1;try{return gt.constructResult(this.decodeRow2pairs(l,u))}catch(g){this.verbose&&console.log(g)}return this.pairs.length=0,this.startFromEven=!0,gt.constructResult(this.decodeRow2pairs(l,u))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(l,u){let m=!1;for(;!m;)try{this.pairs.push(this.retrieveNextPair(u,this.pairs,l))}catch(y){if(y instanceof H){if(!this.pairs.length)throw new H;m=!0}}if(this.checkChecksum())return this.pairs;let g;if(this.rows.length?g=!0:g=!1,this.storeRow(l,!1),g){let y=this.checkRowsBoolean(!1);if(y!=null||(y=this.checkRowsBoolean(!0),y!=null))return y}throw new H}checkRowsBoolean(l){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,l&&(this.rows=this.rows.reverse());let u=null;try{u=this.checkRows(new Array,0)}catch(m){this.verbose&&console.log(m)}return l&&(this.rows=this.rows.reverse()),u}checkRows(l,u){for(let m=u;m<this.rows.length;m++){let g=this.rows[m];this.pairs.length=0;for(let j of l)this.pairs.push(j.getPairs());if(this.pairs.push(g.getPairs()),!gt.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let y=new Array(l);y.push(g);try{return this.checkRows(y,m+1)}catch(j){this.verbose&&console.log(j)}}throw new H}static isValidSequence(l){for(let u of gt.FINDER_PATTERN_SEQUENCES){if(l.length>u.length)continue;let m=!0;for(let g=0;g<l.length;g++)if(l[g].getFinderPattern().getValue()!=u[g]){m=!1;break}if(m)return!0}return!1}storeRow(l,u){let m=0,g=!1,y=!1;for(;m<this.rows.length;){let j=this.rows[m];if(j.getRowNumber()>l){y=j.isEquivalent(this.pairs);break}g=j.isEquivalent(this.pairs),m++}y||g||gt.isPartialRow(this.pairs,this.rows)||(this.rows.push(m,new Ds(this.pairs,l,u)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(l,u){for(let m of u)if(m.getPairs().length!==l.length){for(let g of m.getPairs())for(let y of l)if(Xt.equals(g,y))break}}static isPartialRow(l,u){for(let m of u){let g=!0;for(let y of l){let j=!1;for(let S of m.getPairs())if(y.equals(S)){j=!0;break}if(!j){g=!1;break}}if(g)return!0}return!1}getRows(){return this.rows}static constructResult(l){let u=ha.buildBitArray(l),g=Mt(u).parseInformation(),y=l[0].getFinderPattern().getResultPoints(),j=l[l.length-1].getFinderPattern().getResultPoints(),S=[y[0],y[1],j[0],j[1]];return new ie(g,null,null,S,xe.RSS_EXPANDED,null)}checkChecksum(){let l=this.pairs.get(0),u=l.getLeftChar(),m=l.getRightChar();if(m==null)return!1;let g=m.getChecksumPortion(),y=2;for(let S=1;S<this.pairs.size();++S){let P=this.pairs.get(S);g+=P.getLeftChar().getChecksumPortion(),y++;let V=P.getRightChar();V!=null&&(g+=V.getChecksumPortion(),y++)}return g%=211,211*(y-4)+g==u.getValue()}static getNextSecondBar(l,u){let m;return l.get(u)?(m=l.getNextUnset(u),m=l.getNextSet(m)):(m=l.getNextSet(u),m=l.getNextUnset(m)),m}retrieveNextPair(l,u,m){let g=u.length%2==0;this.startFromEven&&(g=!g);let y,j=!0,S=-1;do this.findNextPair(l,u,S),y=this.parseFoundFinderPattern(l,m,g),y==null?S=gt.getNextSecondBar(l,this.startEnd[0]):j=!1;while(j);let P=this.decodeDataCharacter(l,y,g,!0);if(!this.isEmptyPair(u)&&u[u.length-1].mustBeLast())throw new H;let V;try{V=this.decodeDataCharacter(l,y,g,!1)}catch(K){V=null,this.verbose&&console.log(K)}return new Xt(P,V,y,!0)}isEmptyPair(l){return l.length===0}findNextPair(l,u,m){let g=this.getDecodeFinderCounters();g[0]=0,g[1]=0,g[2]=0,g[3]=0;let y=l.getSize(),j;m>=0?j=m:this.isEmptyPair(u)?j=0:j=u[u.length-1].getFinderPattern().getStartEnd()[1];let S=u.length%2!=0;this.startFromEven&&(S=!S);let P=!1;for(;j<y&&(P=!l.get(j),!!P);)j++;let V=0,K=j;for(let se=j;se<y;se++)if(l.get(se)!=P)g[V]++;else{if(V==3){if(S&&gt.reverseCounters(g),gt.isFinderPattern(g)){this.startEnd[0]=K,this.startEnd[1]=se;return}S&&gt.reverseCounters(g),K+=g[0]+g[1],g[0]=g[2],g[1]=g[3],g[2]=0,g[3]=0,V--}else V++;g[V]=1,P=!P}throw new H}static reverseCounters(l){let u=l.length;for(let m=0;m<u/2;++m){let g=l[m];l[m]=l[u-m-1],l[u-m-1]=g}}parseFoundFinderPattern(l,u,m){let g,y,j;if(m){let V=this.startEnd[0]-1;for(;V>=0&&!l.get(V);)V--;V++,g=this.startEnd[0]-V,y=V,j=this.startEnd[1]}else y=this.startEnd[0],j=l.getNextUnset(this.startEnd[1]+1),g=j-this.startEnd[1];let S=this.getDecodeFinderCounters();_.arraycopy(S,0,S,1,S.length-1),S[0]=g;let P;try{P=this.parseFinderValue(S,gt.FINDER_PATTERNS)}catch{return null}return new Bs(P,[y,j],y,j,u)}decodeDataCharacter(l,u,m,g){let y=this.getDataCharacterCounters();for(let kr=0;kr<y.length;kr++)y[kr]=0;if(g)gt.recordPatternInReverse(l,u.getStartEnd()[0],y);else{gt.recordPattern(l,u.getStartEnd()[1],y);for(let kr=0,rn=y.length-1;kr<rn;kr++,rn--){let Un=y[kr];y[kr]=y[rn],y[rn]=Un}}let j=17,S=Le.sum(new Int32Array(y))/j,P=(u.getStartEnd()[1]-u.getStartEnd()[0])/15;if(Math.abs(S-P)/P>.3)throw new H;let V=this.getOddCounts(),K=this.getEvenCounts(),se=this.getOddRoundingErrors(),ue=this.getEvenRoundingErrors();for(let kr=0;kr<y.length;kr++){let rn=1*y[kr]/S,Un=rn+.5;if(Un<1){if(rn<.3)throw new H;Un=1}else if(Un>8){if(rn>8.7)throw new H;Un=8}let Dc=kr/2;kr&1?(K[Dc]=Un,ue[Dc]=rn-Un):(V[Dc]=Un,se[Dc]=rn-Un)}this.adjustOddEvenCounts(j);let Ae=4*u.getValue()+(m?0:2)+(g?0:1)-1,Ve=0,$e=0;for(let kr=V.length-1;kr>=0;kr--){if(gt.isNotA1left(u,m,g)){let rn=gt.WEIGHTS[Ae][2*kr];$e+=V[kr]*rn}Ve+=V[kr]}let st=0;for(let kr=K.length-1;kr>=0;kr--)if(gt.isNotA1left(u,m,g)){let rn=gt.WEIGHTS[Ae][2*kr+1];st+=K[kr]*rn}let ht=$e+st;if(Ve&1||Ve>13||Ve<4)throw new H;let Bt=(13-Ve)/2,Vt=gt.SYMBOL_WIDEST[Bt],Pt=9-Vt,pr=js.getRSSvalue(V,Vt,!0),Ys=js.getRSSvalue(K,Pt,!1),ma=gt.EVEN_TOTAL_SUBSET[Bt],Bn=gt.GSUM[Bt],Vn=pr*ma+Ys+Bn;return new ws(Vn,ht)}static isNotA1left(l,u,m){return!(l.getValue()==0&&u&&m)}adjustOddEvenCounts(l){let u=Le.sum(new Int32Array(this.getOddCounts())),m=Le.sum(new Int32Array(this.getEvenCounts())),g=!1,y=!1;u>13?y=!0:u<4&&(g=!0);let j=!1,S=!1;m>13?S=!0:m<4&&(j=!0);let P=u+m-l,V=(u&1)==1,K=(m&1)==0;if(P==1)if(V){if(K)throw new H;y=!0}else{if(!K)throw new H;S=!0}else if(P==-1)if(V){if(K)throw new H;g=!0}else{if(!K)throw new H;j=!0}else if(P==0){if(V){if(!K)throw new H;u<m?(g=!0,S=!0):(y=!0,j=!0)}else if(K)throw new H}else throw new H;if(g){if(y)throw new H;gt.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(y&&gt.decrement(this.getOddCounts(),this.getOddRoundingErrors()),j){if(S)throw new H;gt.increment(this.getEvenCounts(),this.getOddRoundingErrors())}S&&gt.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}gt.SYMBOL_WIDEST=[7,5,4,3,1],gt.EVEN_TOTAL_SUBSET=[4,20,52,104,204],gt.GSUM=[0,348,1388,2948,3988],gt.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],gt.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],gt.FINDER_PAT_A=0,gt.FINDER_PAT_B=1,gt.FINDER_PAT_C=2,gt.FINDER_PAT_D=3,gt.FINDER_PAT_E=4,gt.FINDER_PAT_F=5,gt.FINDER_PATTERN_SEQUENCES=[[gt.FINDER_PAT_A,gt.FINDER_PAT_A],[gt.FINDER_PAT_A,gt.FINDER_PAT_B,gt.FINDER_PAT_B],[gt.FINDER_PAT_A,gt.FINDER_PAT_C,gt.FINDER_PAT_B,gt.FINDER_PAT_D],[gt.FINDER_PAT_A,gt.FINDER_PAT_E,gt.FINDER_PAT_B,gt.FINDER_PAT_D,gt.FINDER_PAT_C],[gt.FINDER_PAT_A,gt.FINDER_PAT_E,gt.FINDER_PAT_B,gt.FINDER_PAT_D,gt.FINDER_PAT_D,gt.FINDER_PAT_F],[gt.FINDER_PAT_A,gt.FINDER_PAT_E,gt.FINDER_PAT_B,gt.FINDER_PAT_D,gt.FINDER_PAT_E,gt.FINDER_PAT_F,gt.FINDER_PAT_F],[gt.FINDER_PAT_A,gt.FINDER_PAT_A,gt.FINDER_PAT_B,gt.FINDER_PAT_B,gt.FINDER_PAT_C,gt.FINDER_PAT_C,gt.FINDER_PAT_D,gt.FINDER_PAT_D],[gt.FINDER_PAT_A,gt.FINDER_PAT_A,gt.FINDER_PAT_B,gt.FINDER_PAT_B,gt.FINDER_PAT_C,gt.FINDER_PAT_C,gt.FINDER_PAT_D,gt.FINDER_PAT_E,gt.FINDER_PAT_E],[gt.FINDER_PAT_A,gt.FINDER_PAT_A,gt.FINDER_PAT_B,gt.FINDER_PAT_B,gt.FINDER_PAT_C,gt.FINDER_PAT_C,gt.FINDER_PAT_D,gt.FINDER_PAT_E,gt.FINDER_PAT_F,gt.FINDER_PAT_F],[gt.FINDER_PAT_A,gt.FINDER_PAT_A,gt.FINDER_PAT_B,gt.FINDER_PAT_B,gt.FINDER_PAT_C,gt.FINDER_PAT_D,gt.FINDER_PAT_D,gt.FINDER_PAT_E,gt.FINDER_PAT_E,gt.FINDER_PAT_F,gt.FINDER_PAT_F]],gt.MAX_PAIRS=11;class ea extends ws{constructor(l,u,m){super(l,u),this.count=0,this.finderPattern=m}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class or extends is{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(l,u,m){const g=this.decodePair(u,!1,l,m);or.addOrTally(this.possibleLeftPairs,g),u.reverse();let y=this.decodePair(u,!0,l,m);or.addOrTally(this.possibleRightPairs,y),u.reverse();for(let j of this.possibleLeftPairs)if(j.getCount()>1){for(let S of this.possibleRightPairs)if(S.getCount()>1&&or.checkChecksum(j,S))return or.constructResult(j,S)}throw new H}static addOrTally(l,u){if(u==null)return;let m=!1;for(let g of l)if(g.getValue()===u.getValue()){g.incrementCount(),m=!0;break}m||l.push(u)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(l,u){let m=4537077*l.getValue()+u.getValue(),g=new String(m).toString(),y=new ae;for(let V=13-g.length;V>0;V--)y.append("0");y.append(g);let j=0;for(let V=0;V<13;V++){let K=y.charAt(V).charCodeAt(0)-48;j+=V&1?K:3*K}j=10-j%10,j===10&&(j=0),y.append(j.toString());let S=l.getFinderPattern().getResultPoints(),P=u.getFinderPattern().getResultPoints();return new ie(y.toString(),null,0,[S[0],S[1],P[0],P[1]],xe.RSS_14,new Date().getTime())}static checkChecksum(l,u){let m=(l.getChecksumPortion()+16*u.getChecksumPortion())%79,g=9*l.getFinderPattern().getValue()+u.getFinderPattern().getValue();return g>72&&g--,g>8&&g--,m===g}decodePair(l,u,m,g){try{let y=this.findFinderPattern(l,u),j=this.parseFoundFinderPattern(l,m,u,y),S=g==null?null:g.get(O.NEED_RESULT_POINT_CALLBACK);if(S!=null){let K=(y[0]+y[1])/2;u&&(K=l.getSize()-1-K),S.foundPossibleResultPoint(new Ge(K,m))}let P=this.decodeDataCharacter(l,j,!0),V=this.decodeDataCharacter(l,j,!1);return new ea(1597*P.getValue()+V.getValue(),P.getChecksumPortion()+4*V.getChecksumPortion(),j)}catch{return null}}decodeDataCharacter(l,u,m){let g=this.getDataCharacterCounters();for(let st=0;st<g.length;st++)g[st]=0;if(m)_t.recordPatternInReverse(l,u.getStartEnd()[0],g);else{_t.recordPattern(l,u.getStartEnd()[1]+1,g);for(let st=0,ht=g.length-1;st<ht;st++,ht--){let Bt=g[st];g[st]=g[ht],g[ht]=Bt}}let y=m?16:15,j=Le.sum(new Int32Array(g))/y,S=this.getOddCounts(),P=this.getEvenCounts(),V=this.getOddRoundingErrors(),K=this.getEvenRoundingErrors();for(let st=0;st<g.length;st++){let ht=g[st]/j,Bt=Math.floor(ht+.5);Bt<1?Bt=1:Bt>8&&(Bt=8);let Vt=Math.floor(st/2);st&1?(P[Vt]=Bt,K[Vt]=ht-Bt):(S[Vt]=Bt,V[Vt]=ht-Bt)}this.adjustOddEvenCounts(m,y);let se=0,ue=0;for(let st=S.length-1;st>=0;st--)ue*=9,ue+=S[st],se+=S[st];let Ae=0,Ve=0;for(let st=P.length-1;st>=0;st--)Ae*=9,Ae+=P[st],Ve+=P[st];let $e=ue+3*Ae;if(m){if(se&1||se>12||se<4)throw new H;let st=(12-se)/2,ht=or.OUTSIDE_ODD_WIDEST[st],Bt=9-ht,Vt=js.getRSSvalue(S,ht,!1),Pt=js.getRSSvalue(P,Bt,!0),pr=or.OUTSIDE_EVEN_TOTAL_SUBSET[st],Ys=or.OUTSIDE_GSUM[st];return new ws(Vt*pr+Pt+Ys,$e)}else{if(Ve&1||Ve>10||Ve<4)throw new H;let st=(10-Ve)/2,ht=or.INSIDE_ODD_WIDEST[st],Bt=9-ht,Vt=js.getRSSvalue(S,ht,!0),Pt=js.getRSSvalue(P,Bt,!1),pr=or.INSIDE_ODD_TOTAL_SUBSET[st],Ys=or.INSIDE_GSUM[st];return new ws(Pt*pr+Vt+Ys,$e)}}findFinderPattern(l,u){let m=this.getDecodeFinderCounters();m[0]=0,m[1]=0,m[2]=0,m[3]=0;let g=l.getSize(),y=!1,j=0;for(;j<g&&(y=!l.get(j),u!==y);)j++;let S=0,P=j;for(let V=j;V<g;V++)if(l.get(V)!==y)m[S]++;else{if(S===3){if(is.isFinderPattern(m))return[P,V];P+=m[0]+m[1],m[0]=m[2],m[1]=m[3],m[2]=0,m[3]=0,S--}else S++;m[S]=1,y=!y}throw new H}parseFoundFinderPattern(l,u,m,g){let y=l.get(g[0]),j=g[0]-1;for(;j>=0&&y!==l.get(j);)j--;j++;const S=g[0]-j,P=this.getDecodeFinderCounters(),V=new Int32Array(P.length);_.arraycopy(P,0,V,1,P.length-1),V[0]=S;const K=this.parseFinderValue(V,or.FINDER_PATTERNS);let se=j,ue=g[1];return m&&(se=l.getSize()-1-se,ue=l.getSize()-1-ue),new Bs(K,[j,g[1]],se,ue,u)}adjustOddEvenCounts(l,u){let m=Le.sum(new Int32Array(this.getOddCounts())),g=Le.sum(new Int32Array(this.getEvenCounts())),y=!1,j=!1,S=!1,P=!1;l?(m>12?j=!0:m<4&&(y=!0),g>12?P=!0:g<4&&(S=!0)):(m>11?j=!0:m<5&&(y=!0),g>10?P=!0:g<4&&(S=!0));let V=m+g-u,K=(m&1)===(l?1:0),se=(g&1)===1;if(V===1)if(K){if(se)throw new H;j=!0}else{if(!se)throw new H;P=!0}else if(V===-1)if(K){if(se)throw new H;y=!0}else{if(!se)throw new H;S=!0}else if(V===0){if(K){if(!se)throw new H;m<g?(y=!0,P=!0):(j=!0,S=!0)}else if(se)throw new H}else throw new H;if(y){if(j)throw new H;is.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(j&&is.decrement(this.getOddCounts(),this.getOddRoundingErrors()),S){if(P)throw new H;is.increment(this.getEvenCounts(),this.getOddRoundingErrors())}P&&is.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}or.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],or.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],or.OUTSIDE_GSUM=[0,161,961,2015,2715],or.INSIDE_GSUM=[0,336,1036,1516],or.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],or.INSIDE_ODD_WIDEST=[2,4,6,8],or.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Ln extends _t{constructor(l,u){super(),this.readers=[],this.verbose=u===!0;const m=l?l.get(O.POSSIBLE_FORMATS):null,g=l&&l.get(O.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;m?((m.includes(xe.EAN_13)||m.includes(xe.UPC_A)||m.includes(xe.EAN_8)||m.includes(xe.UPC_E))&&this.readers.push(new ls(l)),m.includes(xe.CODE_39)&&this.readers.push(new et(g)),m.includes(xe.CODE_128)&&this.readers.push(new Re),m.includes(xe.ITF)&&this.readers.push(new Ct),m.includes(xe.RSS_14)&&this.readers.push(new or),m.includes(xe.RSS_EXPANDED)&&this.readers.push(new gt(this.verbose))):(this.readers.push(new ls(l)),this.readers.push(new et),this.readers.push(new ls(l)),this.readers.push(new Re),this.readers.push(new Ct),this.readers.push(new or),this.readers.push(new gt(this.verbose)))}decodeRow(l,u,m){for(let g=0;g<this.readers.length;g++)try{return this.readers[g].decodeRow(l,u,m)}catch{}throw new H}reset(){this.readers.forEach(l=>l.reset())}}class Mi extends ee{constructor(l=500,u){super(new Ln(u),l,u)}}class fr{constructor(l,u,m){this.ecCodewords=l,this.ecBlocks=[u],m&&this.ecBlocks.push(m)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class rr{constructor(l,u){this.count=l,this.dataCodewords=u}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Ks{constructor(l,u,m,g,y,j){this.versionNumber=l,this.symbolSizeRows=u,this.symbolSizeColumns=m,this.dataRegionSizeRows=g,this.dataRegionSizeColumns=y,this.ecBlocks=j;let S=0;const P=j.getECCodewords(),V=j.getECBlocks();for(let K of V)S+=K.getCount()*(K.getDataCodewords()+P);this.totalCodewords=S}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(l,u){if(l&1||u&1)throw new D;for(let m of Ks.VERSIONS)if(m.symbolSizeRows===l&&m.symbolSizeColumns===u)return m;throw new D}toString(){return""+this.versionNumber}static buildVersions(){return[new Ks(1,10,10,8,8,new fr(5,new rr(1,3))),new Ks(2,12,12,10,10,new fr(7,new rr(1,5))),new Ks(3,14,14,12,12,new fr(10,new rr(1,8))),new Ks(4,16,16,14,14,new fr(12,new rr(1,12))),new Ks(5,18,18,16,16,new fr(14,new rr(1,18))),new Ks(6,20,20,18,18,new fr(18,new rr(1,22))),new Ks(7,22,22,20,20,new fr(20,new rr(1,30))),new Ks(8,24,24,22,22,new fr(24,new rr(1,36))),new Ks(9,26,26,24,24,new fr(28,new rr(1,44))),new Ks(10,32,32,14,14,new fr(36,new rr(1,62))),new Ks(11,36,36,16,16,new fr(42,new rr(1,86))),new Ks(12,40,40,18,18,new fr(48,new rr(1,114))),new Ks(13,44,44,20,20,new fr(56,new rr(1,144))),new Ks(14,48,48,22,22,new fr(68,new rr(1,174))),new Ks(15,52,52,24,24,new fr(42,new rr(2,102))),new Ks(16,64,64,14,14,new fr(56,new rr(2,140))),new Ks(17,72,72,16,16,new fr(36,new rr(4,92))),new Ks(18,80,80,18,18,new fr(48,new rr(4,114))),new Ks(19,88,88,20,20,new fr(56,new rr(4,144))),new Ks(20,96,96,22,22,new fr(68,new rr(4,174))),new Ks(21,104,104,24,24,new fr(56,new rr(6,136))),new Ks(22,120,120,18,18,new fr(68,new rr(6,175))),new Ks(23,132,132,20,20,new fr(62,new rr(8,163))),new Ks(24,144,144,22,22,new fr(62,new rr(8,156),new rr(2,155))),new Ks(25,8,18,6,16,new fr(7,new rr(1,5))),new Ks(26,8,32,6,14,new fr(11,new rr(1,10))),new Ks(27,12,26,10,24,new fr(14,new rr(1,16))),new Ks(28,12,36,10,16,new fr(18,new rr(1,22))),new Ks(29,16,36,14,16,new fr(24,new rr(1,32))),new Ks(30,16,48,14,22,new fr(28,new rr(1,49)))]}}Ks.VERSIONS=Ks.buildVersions();class Hs{constructor(l){const u=l.getHeight();if(u<8||u>144||u&1)throw new D;this.version=Hs.readVersion(l),this.mappingBitMatrix=this.extractDataRegion(l),this.readMappingMatrix=new je(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(l){const u=l.getHeight(),m=l.getWidth();return Ks.getVersionForDimensions(u,m)}readCodewords(){const l=new Int8Array(this.version.getTotalCodewords());let u=0,m=4,g=0;const y=this.mappingBitMatrix.getHeight(),j=this.mappingBitMatrix.getWidth();let S=!1,P=!1,V=!1,K=!1;do if(m===y&&g===0&&!S)l[u++]=this.readCorner1(y,j)&255,m-=2,g+=2,S=!0;else if(m===y-2&&g===0&&j&3&&!P)l[u++]=this.readCorner2(y,j)&255,m-=2,g+=2,P=!0;else if(m===y+4&&g===2&&!(j&7)&&!V)l[u++]=this.readCorner3(y,j)&255,m-=2,g+=2,V=!0;else if(m===y-2&&g===0&&(j&7)===4&&!K)l[u++]=this.readCorner4(y,j)&255,m-=2,g+=2,K=!0;else{do m<y&&g>=0&&!this.readMappingMatrix.get(g,m)&&(l[u++]=this.readUtah(m,g,y,j)&255),m-=2,g+=2;while(m>=0&&g<j);m+=1,g+=3;do m>=0&&g<j&&!this.readMappingMatrix.get(g,m)&&(l[u++]=this.readUtah(m,g,y,j)&255),m+=2,g-=2;while(m<y&&g>=0);m+=3,g+=1}while(m<y||g<j);if(u!==this.version.getTotalCodewords())throw new D;return l}readModule(l,u,m,g){return l<0&&(l+=m,u+=4-(m+4&7)),u<0&&(u+=g,l+=4-(g+4&7)),this.readMappingMatrix.set(u,l),this.mappingBitMatrix.get(u,l)}readUtah(l,u,m,g){let y=0;return this.readModule(l-2,u-2,m,g)&&(y|=1),y<<=1,this.readModule(l-2,u-1,m,g)&&(y|=1),y<<=1,this.readModule(l-1,u-2,m,g)&&(y|=1),y<<=1,this.readModule(l-1,u-1,m,g)&&(y|=1),y<<=1,this.readModule(l-1,u,m,g)&&(y|=1),y<<=1,this.readModule(l,u-2,m,g)&&(y|=1),y<<=1,this.readModule(l,u-1,m,g)&&(y|=1),y<<=1,this.readModule(l,u,m,g)&&(y|=1),y}readCorner1(l,u){let m=0;return this.readModule(l-1,0,l,u)&&(m|=1),m<<=1,this.readModule(l-1,1,l,u)&&(m|=1),m<<=1,this.readModule(l-1,2,l,u)&&(m|=1),m<<=1,this.readModule(0,u-2,l,u)&&(m|=1),m<<=1,this.readModule(0,u-1,l,u)&&(m|=1),m<<=1,this.readModule(1,u-1,l,u)&&(m|=1),m<<=1,this.readModule(2,u-1,l,u)&&(m|=1),m<<=1,this.readModule(3,u-1,l,u)&&(m|=1),m}readCorner2(l,u){let m=0;return this.readModule(l-3,0,l,u)&&(m|=1),m<<=1,this.readModule(l-2,0,l,u)&&(m|=1),m<<=1,this.readModule(l-1,0,l,u)&&(m|=1),m<<=1,this.readModule(0,u-4,l,u)&&(m|=1),m<<=1,this.readModule(0,u-3,l,u)&&(m|=1),m<<=1,this.readModule(0,u-2,l,u)&&(m|=1),m<<=1,this.readModule(0,u-1,l,u)&&(m|=1),m<<=1,this.readModule(1,u-1,l,u)&&(m|=1),m}readCorner3(l,u){let m=0;return this.readModule(l-1,0,l,u)&&(m|=1),m<<=1,this.readModule(l-1,u-1,l,u)&&(m|=1),m<<=1,this.readModule(0,u-3,l,u)&&(m|=1),m<<=1,this.readModule(0,u-2,l,u)&&(m|=1),m<<=1,this.readModule(0,u-1,l,u)&&(m|=1),m<<=1,this.readModule(1,u-3,l,u)&&(m|=1),m<<=1,this.readModule(1,u-2,l,u)&&(m|=1),m<<=1,this.readModule(1,u-1,l,u)&&(m|=1),m}readCorner4(l,u){let m=0;return this.readModule(l-3,0,l,u)&&(m|=1),m<<=1,this.readModule(l-2,0,l,u)&&(m|=1),m<<=1,this.readModule(l-1,0,l,u)&&(m|=1),m<<=1,this.readModule(0,u-2,l,u)&&(m|=1),m<<=1,this.readModule(0,u-1,l,u)&&(m|=1),m<<=1,this.readModule(1,u-1,l,u)&&(m|=1),m<<=1,this.readModule(2,u-1,l,u)&&(m|=1),m<<=1,this.readModule(3,u-1,l,u)&&(m|=1),m}extractDataRegion(l){const u=this.version.getSymbolSizeRows(),m=this.version.getSymbolSizeColumns();if(l.getHeight()!==u)throw new x("Dimension of bitMatrix must match the version size");const g=this.version.getDataRegionSizeRows(),y=this.version.getDataRegionSizeColumns(),j=u/g|0,S=m/y|0,P=j*g,V=S*y,K=new je(V,P);for(let se=0;se<j;++se){const ue=se*g;for(let Ae=0;Ae<S;++Ae){const Ve=Ae*y;for(let $e=0;$e<g;++$e){const st=se*(g+2)+1+$e,ht=ue+$e;for(let Bt=0;Bt<y;++Bt){const Vt=Ae*(y+2)+1+Bt;if(l.get(Vt,st)){const Pt=Ve+Bt;K.set(Pt,ht)}}}}}return K}}class ta{constructor(l,u){this.numDataCodewords=l,this.codewords=u}static getDataBlocks(l,u){const m=u.getECBlocks();let g=0;const y=m.getECBlocks();for(let $e of y)g+=$e.getCount();const j=new Array(g);let S=0;for(let $e of y)for(let st=0;st<$e.getCount();st++){const ht=$e.getDataCodewords(),Bt=m.getECCodewords()+ht;j[S++]=new ta(ht,new Uint8Array(Bt))}const V=j[0].codewords.length-m.getECCodewords(),K=V-1;let se=0;for(let $e=0;$e<K;$e++)for(let st=0;st<S;st++)j[st].codewords[$e]=l[se++];const ue=u.getVersionNumber()===24,Ae=ue?8:S;for(let $e=0;$e<Ae;$e++)j[$e].codewords[V-1]=l[se++];const Ve=j[0].codewords.length;for(let $e=V;$e<Ve;$e++)for(let st=0;st<S;st++){const ht=ue?(st+8)%S:st,Bt=ue&&ht>7?$e-1:$e;j[ht].codewords[Bt]=l[se++]}if(se!==l.length)throw new x;return j}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class Tc{constructor(l){this.bytes=l,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(l){if(l<1||l>32||l>this.available())throw new x(""+l);let u=0,m=this.bitOffset,g=this.byteOffset;const y=this.bytes;if(m>0){const j=8-m,S=l<j?l:j,P=j-S,V=255>>8-S<<P;u=(y[g]&V)>>P,l-=S,m+=S,m===8&&(m=0,g++)}if(l>0){for(;l>=8;)u=u<<8|y[g]&255,g++,l-=8;if(l>0){const j=8-l,S=255>>j<<j;u=u<<l|(y[g]&S)>>j,m+=l}}return this.bitOffset=m,this.byteOffset=g,u}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var aa;(function(te){te[te.PAD_ENCODE=0]="PAD_ENCODE",te[te.ASCII_ENCODE=1]="ASCII_ENCODE",te[te.C40_ENCODE=2]="C40_ENCODE",te[te.TEXT_ENCODE=3]="TEXT_ENCODE",te[te.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",te[te.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",te[te.BASE256_ENCODE=6]="BASE256_ENCODE"})(aa||(aa={}));class si{static decode(l){const u=new Tc(l),m=new ae,g=new ae,y=new Array;let j=aa.ASCII_ENCODE;do if(j===aa.ASCII_ENCODE)j=this.decodeAsciiSegment(u,m,g);else{switch(j){case aa.C40_ENCODE:this.decodeC40Segment(u,m);break;case aa.TEXT_ENCODE:this.decodeTextSegment(u,m);break;case aa.ANSIX12_ENCODE:this.decodeAnsiX12Segment(u,m);break;case aa.EDIFACT_ENCODE:this.decodeEdifactSegment(u,m);break;case aa.BASE256_ENCODE:this.decodeBase256Segment(u,m,y);break;default:throw new D}j=aa.ASCII_ENCODE}while(j!==aa.PAD_ENCODE&&u.available()>0);return g.length()>0&&m.append(g.toString()),new fe(l,m.toString(),y.length===0?null:y,null)}static decodeAsciiSegment(l,u,m){let g=!1;do{let y=l.readBits(8);if(y===0)throw new D;if(y<=128)return g&&(y+=128),u.append(String.fromCharCode(y-1)),aa.ASCII_ENCODE;if(y===129)return aa.PAD_ENCODE;if(y<=229){const j=y-130;j<10&&u.append("0"),u.append(""+j)}else switch(y){case 230:return aa.C40_ENCODE;case 231:return aa.BASE256_ENCODE;case 232:u.append("");break;case 233:case 234:break;case 235:g=!0;break;case 236:u.append("[)>05"),m.insert(0,"");break;case 237:u.append("[)>06"),m.insert(0,"");break;case 238:return aa.ANSIX12_ENCODE;case 239:return aa.TEXT_ENCODE;case 240:return aa.EDIFACT_ENCODE;case 241:break;default:if(y!==254||l.available()!==0)throw new D;break}}while(l.available()>0);return aa.ASCII_ENCODE}static decodeC40Segment(l,u){let m=!1;const g=[];let y=0;do{if(l.available()===8)return;const j=l.readBits(8);if(j===254)return;this.parseTwoBytes(j,l.readBits(8),g);for(let S=0;S<3;S++){const P=g[S];switch(y){case 0:if(P<3)y=P+1;else if(P<this.C40_BASIC_SET_CHARS.length){const V=this.C40_BASIC_SET_CHARS[P];m?(u.append(String.fromCharCode(V.charCodeAt(0)+128)),m=!1):u.append(V)}else throw new D;break;case 1:m?(u.append(String.fromCharCode(P+128)),m=!1):u.append(String.fromCharCode(P)),y=0;break;case 2:if(P<this.C40_SHIFT2_SET_CHARS.length){const V=this.C40_SHIFT2_SET_CHARS[P];m?(u.append(String.fromCharCode(V.charCodeAt(0)+128)),m=!1):u.append(V)}else switch(P){case 27:u.append("");break;case 30:m=!0;break;default:throw new D}y=0;break;case 3:m?(u.append(String.fromCharCode(P+224)),m=!1):u.append(String.fromCharCode(P+96)),y=0;break;default:throw new D}}}while(l.available()>0)}static decodeTextSegment(l,u){let m=!1,g=[],y=0;do{if(l.available()===8)return;const j=l.readBits(8);if(j===254)return;this.parseTwoBytes(j,l.readBits(8),g);for(let S=0;S<3;S++){const P=g[S];switch(y){case 0:if(P<3)y=P+1;else if(P<this.TEXT_BASIC_SET_CHARS.length){const V=this.TEXT_BASIC_SET_CHARS[P];m?(u.append(String.fromCharCode(V.charCodeAt(0)+128)),m=!1):u.append(V)}else throw new D;break;case 1:m?(u.append(String.fromCharCode(P+128)),m=!1):u.append(String.fromCharCode(P)),y=0;break;case 2:if(P<this.TEXT_SHIFT2_SET_CHARS.length){const V=this.TEXT_SHIFT2_SET_CHARS[P];m?(u.append(String.fromCharCode(V.charCodeAt(0)+128)),m=!1):u.append(V)}else switch(P){case 27:u.append("");break;case 30:m=!0;break;default:throw new D}y=0;break;case 3:if(P<this.TEXT_SHIFT3_SET_CHARS.length){const V=this.TEXT_SHIFT3_SET_CHARS[P];m?(u.append(String.fromCharCode(V.charCodeAt(0)+128)),m=!1):u.append(V),y=0}else throw new D;break;default:throw new D}}}while(l.available()>0)}static decodeAnsiX12Segment(l,u){const m=[];do{if(l.available()===8)return;const g=l.readBits(8);if(g===254)return;this.parseTwoBytes(g,l.readBits(8),m);for(let y=0;y<3;y++){const j=m[y];switch(j){case 0:u.append("\r");break;case 1:u.append("*");break;case 2:u.append(">");break;case 3:u.append(" ");break;default:if(j<14)u.append(String.fromCharCode(j+44));else if(j<40)u.append(String.fromCharCode(j+51));else throw new D;break}}}while(l.available()>0)}static parseTwoBytes(l,u,m){let g=(l<<8)+u-1,y=Math.floor(g/1600);m[0]=y,g-=y*1600,y=Math.floor(g/40),m[1]=y,m[2]=g-y*40}static decodeEdifactSegment(l,u){do{if(l.available()<=16)return;for(let m=0;m<4;m++){let g=l.readBits(6);if(g===31){const y=8-l.getBitOffset();y!==8&&l.readBits(y);return}g&32||(g|=64),u.append(String.fromCharCode(g))}}while(l.available()>0)}static decodeBase256Segment(l,u,m){let g=1+l.getByteOffset();const y=this.unrandomize255State(l.readBits(8),g++);let j;if(y===0?j=l.available()/8|0:y<250?j=y:j=250*(y-249)+this.unrandomize255State(l.readBits(8),g++),j<0)throw new D;const S=new Uint8Array(j);for(let P=0;P<j;P++){if(l.available()<8)throw new D;S[P]=this.unrandomize255State(l.readBits(8),g++)}m.push(S);try{u.append(q.decode(S,Y.ISO88591))}catch(P){throw new ot("Platform does not support required encoding: "+P.message)}}static unrandomize255State(l,u){const m=149*u%255+1,g=l-m;return g>=0?g:g+256}}si.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],si.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],si.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],si.TEXT_SHIFT2_SET_CHARS=si.C40_SHIFT2_SET_CHARS,si.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class Zf{constructor(){this.rsDecoder=new Se(Ie.DATA_MATRIX_FIELD_256)}decode(l){const u=new Hs(l),m=u.getVersion(),g=u.readCodewords(),y=ta.getDataBlocks(g,m);let j=0;for(let V of y)j+=V.getNumDataCodewords();const S=new Uint8Array(j),P=y.length;for(let V=0;V<P;V++){const K=y[V],se=K.getCodewords(),ue=K.getNumDataCodewords();this.correctErrors(se,ue);for(let Ae=0;Ae<ue;Ae++)S[Ae*P+V]=se[Ae]}return si.decode(S)}correctErrors(l,u){const m=new Int32Array(l);try{this.rsDecoder.decode(m,l.length-u)}catch{throw new b}for(let g=0;g<u;g++)l[g]=m[g]}}class xs{constructor(l){this.image=l,this.rectangleDetector=new ns(this.image)}detect(){const l=this.rectangleDetector.detect();let u=this.detectSolid1(l);if(u=this.detectSolid2(u),u[3]=this.correctTopRight(u),!u[3])throw new H;u=this.shiftToModuleCenter(u);const m=u[0],g=u[1],y=u[2],j=u[3];let S=this.transitionsBetween(m,j)+1,P=this.transitionsBetween(y,j)+1;(S&1)===1&&(S+=1),(P&1)===1&&(P+=1),4*S<7*P&&4*P<7*S&&(S=P=Math.max(S,P));let V=xs.sampleGrid(this.image,m,g,y,j,S,P);return new Lt(V,[m,g,y,j])}static shiftPoint(l,u,m){let g=(u.getX()-l.getX())/(m+1),y=(u.getY()-l.getY())/(m+1);return new Ge(l.getX()+g,l.getY()+y)}static moveAway(l,u,m){let g=l.getX(),y=l.getY();return g<u?g-=1:g+=1,y<m?y-=1:y+=1,new Ge(g,y)}detectSolid1(l){let u=l[0],m=l[1],g=l[3],y=l[2],j=this.transitionsBetween(u,m),S=this.transitionsBetween(m,g),P=this.transitionsBetween(g,y),V=this.transitionsBetween(y,u),K=j,se=[y,u,m,g];return K>S&&(K=S,se[0]=u,se[1]=m,se[2]=g,se[3]=y),K>P&&(K=P,se[0]=m,se[1]=g,se[2]=y,se[3]=u),K>V&&(se[0]=g,se[1]=y,se[2]=u,se[3]=m),se}detectSolid2(l){let u=l[0],m=l[1],g=l[2],y=l[3],j=this.transitionsBetween(u,y),S=xs.shiftPoint(m,g,(j+1)*4),P=xs.shiftPoint(g,m,(j+1)*4),V=this.transitionsBetween(S,u),K=this.transitionsBetween(P,y);return V<K?(l[0]=u,l[1]=m,l[2]=g,l[3]=y):(l[0]=m,l[1]=g,l[2]=y,l[3]=u),l}correctTopRight(l){let u=l[0],m=l[1],g=l[2],y=l[3],j=this.transitionsBetween(u,y),S=this.transitionsBetween(m,y),P=xs.shiftPoint(u,m,(S+1)*4),V=xs.shiftPoint(g,m,(j+1)*4);j=this.transitionsBetween(P,y),S=this.transitionsBetween(V,y);let K=new Ge(y.getX()+(g.getX()-m.getX())/(j+1),y.getY()+(g.getY()-m.getY())/(j+1)),se=new Ge(y.getX()+(u.getX()-m.getX())/(S+1),y.getY()+(u.getY()-m.getY())/(S+1));if(!this.isValid(K))return this.isValid(se)?se:null;if(!this.isValid(se))return K;let ue=this.transitionsBetween(P,K)+this.transitionsBetween(V,K),Ae=this.transitionsBetween(P,se)+this.transitionsBetween(V,se);return ue>Ae?K:se}shiftToModuleCenter(l){let u=l[0],m=l[1],g=l[2],y=l[3],j=this.transitionsBetween(u,y)+1,S=this.transitionsBetween(g,y)+1,P=xs.shiftPoint(u,m,S*4),V=xs.shiftPoint(g,m,j*4);j=this.transitionsBetween(P,y)+1,S=this.transitionsBetween(V,y)+1,(j&1)===1&&(j+=1),(S&1)===1&&(S+=1);let K=(u.getX()+m.getX()+g.getX()+y.getX())/4,se=(u.getY()+m.getY()+g.getY()+y.getY())/4;u=xs.moveAway(u,K,se),m=xs.moveAway(m,K,se),g=xs.moveAway(g,K,se),y=xs.moveAway(y,K,se);let ue,Ae;return P=xs.shiftPoint(u,m,S*4),P=xs.shiftPoint(P,y,j*4),ue=xs.shiftPoint(m,u,S*4),ue=xs.shiftPoint(ue,g,j*4),V=xs.shiftPoint(g,y,S*4),V=xs.shiftPoint(V,m,j*4),Ae=xs.shiftPoint(y,g,S*4),Ae=xs.shiftPoint(Ae,u,j*4),[P,ue,V,Ae]}isValid(l){return l.getX()>=0&&l.getX()<this.image.getWidth()&&l.getY()>0&&l.getY()<this.image.getHeight()}static sampleGrid(l,u,m,g,y,j,S){return Ut.getInstance().sampleGrid(l,j,S,.5,.5,j-.5,.5,j-.5,S-.5,.5,S-.5,u.getX(),u.getY(),y.getX(),y.getY(),g.getX(),g.getY(),m.getX(),m.getY())}transitionsBetween(l,u){let m=Math.trunc(l.getX()),g=Math.trunc(l.getY()),y=Math.trunc(u.getX()),j=Math.trunc(u.getY()),S=Math.abs(j-g)>Math.abs(y-m);if(S){let $e=m;m=g,g=$e,$e=y,y=j,j=$e}let P=Math.abs(y-m),V=Math.abs(j-g),K=-P/2,se=g<j?1:-1,ue=m<y?1:-1,Ae=0,Ve=this.image.get(S?g:m,S?m:g);for(let $e=m,st=g;$e!==y;$e+=ue){let ht=this.image.get(S?st:$e,S?$e:st);if(ht!==Ve&&(Ae++,Ve=ht),K+=V,K>0){if(st===j)break;st+=se,K-=P}}return Ae}}class Mr{constructor(){this.decoder=new Zf}decode(l,u=null){let m,g;if(u!=null&&u.has(O.PURE_BARCODE)){const V=Mr.extractPureBits(l.getBlackMatrix());m=this.decoder.decode(V),g=Mr.NO_POINTS}else{const V=new xs(l.getBlackMatrix()).detect();m=this.decoder.decode(V.getBits()),g=V.getPoints()}const y=m.getRawBytes(),j=new ie(m.getText(),y,8*y.length,g,xe.DATA_MATRIX,_.currentTimeMillis()),S=m.getByteSegments();S!=null&&j.putMetadata(me.BYTE_SEGMENTS,S);const P=m.getECLevel();return P!=null&&j.putMetadata(me.ERROR_CORRECTION_LEVEL,P),j}reset(){}static extractPureBits(l){const u=l.getTopLeftOnBit(),m=l.getBottomRightOnBit();if(u==null||m==null)throw new H;const g=this.moduleSize(u,l);let y=u[1];const j=m[1];let S=u[0];const V=(m[0]-S+1)/g,K=(j-y+1)/g;if(V<=0||K<=0)throw new H;const se=g/2;y+=se,S+=se;const ue=new je(V,K);for(let Ae=0;Ae<K;Ae++){const Ve=y+Ae*g;for(let $e=0;$e<V;$e++)l.get(S+$e*g,Ve)&&ue.set($e,Ae)}return ue}static moduleSize(l,u){const m=u.getWidth();let g=l[0];const y=l[1];for(;g<m&&u.get(g,y);)g++;if(g===m)throw new H;const j=g-l[0];if(j===0)throw new H;return j}}Mr.NO_POINTS=[];class Qf extends ee{constructor(l=500){super(new Mr,l)}}var Po;(function(te){te[te.L=0]="L",te[te.M=1]="M",te[te.Q=2]="Q",te[te.H=3]="H"})(Po||(Po={}));class mr{constructor(l,u,m){this.value=l,this.stringValue=u,this.bits=m,mr.FOR_BITS.set(m,this),mr.FOR_VALUE.set(l,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(l){switch(l){case"L":return mr.L;case"M":return mr.M;case"Q":return mr.Q;case"H":return mr.H;default:throw new p(l+"not available")}}toString(){return this.stringValue}equals(l){if(!(l instanceof mr))return!1;const u=l;return this.value===u.value}static forBits(l){if(l<0||l>=mr.FOR_BITS.size)throw new x;return mr.FOR_BITS.get(l)}}mr.FOR_BITS=new Map,mr.FOR_VALUE=new Map,mr.L=new mr(Po.L,"L",1),mr.M=new mr(Po.M,"M",0),mr.Q=new mr(Po.Q,"Q",3),mr.H=new mr(Po.H,"H",2);class mn{constructor(l){this.errorCorrectionLevel=mr.forBits(l>>3&3),this.dataMask=l&7}static numBitsDiffering(l,u){return k.bitCount(l^u)}static decodeFormatInformation(l,u){const m=mn.doDecodeFormatInformation(l,u);return m!==null?m:mn.doDecodeFormatInformation(l^mn.FORMAT_INFO_MASK_QR,u^mn.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(l,u){let m=Number.MAX_SAFE_INTEGER,g=0;for(const y of mn.FORMAT_INFO_DECODE_LOOKUP){const j=y[0];if(j===l||j===u)return new mn(y[1]);let S=mn.numBitsDiffering(l,j);S<m&&(g=y[1],m=S),l!==u&&(S=mn.numBitsDiffering(u,j),S<m&&(g=y[1],m=S))}return m<=3?new mn(g):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(l){if(!(l instanceof mn))return!1;const u=l;return this.errorCorrectionLevel===u.errorCorrectionLevel&&this.dataMask===u.dataMask}}mn.FORMAT_INFO_MASK_QR=21522,mn.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class at{constructor(l,...u){this.ecCodewordsPerBlock=l,this.ecBlocks=u}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let l=0;const u=this.ecBlocks;for(const m of u)l+=m.getCount();return l}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class _e{constructor(l,u){this.count=l,this.dataCodewords=u}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Zt{constructor(l,u,...m){this.versionNumber=l,this.alignmentPatternCenters=u,this.ecBlocks=m;let g=0;const y=m[0].getECCodewordsPerBlock(),j=m[0].getECBlocks();for(const S of j)g+=S.getCount()*(S.getDataCodewords()+y);this.totalCodewords=g}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(l){return this.ecBlocks[l.getValue()]}static getProvisionalVersionForDimension(l){if(l%4!==1)throw new D;try{return this.getVersionForNumber((l-17)/4)}catch{throw new D}}static getVersionForNumber(l){if(l<1||l>40)throw new x;return Zt.VERSIONS[l-1]}static decodeVersionInformation(l){let u=Number.MAX_SAFE_INTEGER,m=0;for(let g=0;g<Zt.VERSION_DECODE_INFO.length;g++){const y=Zt.VERSION_DECODE_INFO[g];if(y===l)return Zt.getVersionForNumber(g+7);const j=mn.numBitsDiffering(l,y);j<u&&(m=g+7,u=j)}return u<=3?Zt.getVersionForNumber(m):null}buildFunctionPattern(){const l=this.getDimensionForVersion(),u=new je(l);u.setRegion(0,0,9,9),u.setRegion(l-8,0,8,9),u.setRegion(0,l-8,9,8);const m=this.alignmentPatternCenters.length;for(let g=0;g<m;g++){const y=this.alignmentPatternCenters[g]-2;for(let j=0;j<m;j++)g===0&&(j===0||j===m-1)||g===m-1&&j===0||u.setRegion(this.alignmentPatternCenters[j]-2,y,5,5)}return u.setRegion(6,9,1,l-17),u.setRegion(9,6,l-17,1),this.versionNumber>6&&(u.setRegion(l-11,0,3,6),u.setRegion(0,l-11,6,3)),u}toString(){return""+this.versionNumber}}Zt.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),Zt.VERSIONS=[new Zt(1,new Int32Array(0),new at(7,new _e(1,19)),new at(10,new _e(1,16)),new at(13,new _e(1,13)),new at(17,new _e(1,9))),new Zt(2,Int32Array.from([6,18]),new at(10,new _e(1,34)),new at(16,new _e(1,28)),new at(22,new _e(1,22)),new at(28,new _e(1,16))),new Zt(3,Int32Array.from([6,22]),new at(15,new _e(1,55)),new at(26,new _e(1,44)),new at(18,new _e(2,17)),new at(22,new _e(2,13))),new Zt(4,Int32Array.from([6,26]),new at(20,new _e(1,80)),new at(18,new _e(2,32)),new at(26,new _e(2,24)),new at(16,new _e(4,9))),new Zt(5,Int32Array.from([6,30]),new at(26,new _e(1,108)),new at(24,new _e(2,43)),new at(18,new _e(2,15),new _e(2,16)),new at(22,new _e(2,11),new _e(2,12))),new Zt(6,Int32Array.from([6,34]),new at(18,new _e(2,68)),new at(16,new _e(4,27)),new at(24,new _e(4,19)),new at(28,new _e(4,15))),new Zt(7,Int32Array.from([6,22,38]),new at(20,new _e(2,78)),new at(18,new _e(4,31)),new at(18,new _e(2,14),new _e(4,15)),new at(26,new _e(4,13),new _e(1,14))),new Zt(8,Int32Array.from([6,24,42]),new at(24,new _e(2,97)),new at(22,new _e(2,38),new _e(2,39)),new at(22,new _e(4,18),new _e(2,19)),new at(26,new _e(4,14),new _e(2,15))),new Zt(9,Int32Array.from([6,26,46]),new at(30,new _e(2,116)),new at(22,new _e(3,36),new _e(2,37)),new at(20,new _e(4,16),new _e(4,17)),new at(24,new _e(4,12),new _e(4,13))),new Zt(10,Int32Array.from([6,28,50]),new at(18,new _e(2,68),new _e(2,69)),new at(26,new _e(4,43),new _e(1,44)),new at(24,new _e(6,19),new _e(2,20)),new at(28,new _e(6,15),new _e(2,16))),new Zt(11,Int32Array.from([6,30,54]),new at(20,new _e(4,81)),new at(30,new _e(1,50),new _e(4,51)),new at(28,new _e(4,22),new _e(4,23)),new at(24,new _e(3,12),new _e(8,13))),new Zt(12,Int32Array.from([6,32,58]),new at(24,new _e(2,92),new _e(2,93)),new at(22,new _e(6,36),new _e(2,37)),new at(26,new _e(4,20),new _e(6,21)),new at(28,new _e(7,14),new _e(4,15))),new Zt(13,Int32Array.from([6,34,62]),new at(26,new _e(4,107)),new at(22,new _e(8,37),new _e(1,38)),new at(24,new _e(8,20),new _e(4,21)),new at(22,new _e(12,11),new _e(4,12))),new Zt(14,Int32Array.from([6,26,46,66]),new at(30,new _e(3,115),new _e(1,116)),new at(24,new _e(4,40),new _e(5,41)),new at(20,new _e(11,16),new _e(5,17)),new at(24,new _e(11,12),new _e(5,13))),new Zt(15,Int32Array.from([6,26,48,70]),new at(22,new _e(5,87),new _e(1,88)),new at(24,new _e(5,41),new _e(5,42)),new at(30,new _e(5,24),new _e(7,25)),new at(24,new _e(11,12),new _e(7,13))),new Zt(16,Int32Array.from([6,26,50,74]),new at(24,new _e(5,98),new _e(1,99)),new at(28,new _e(7,45),new _e(3,46)),new at(24,new _e(15,19),new _e(2,20)),new at(30,new _e(3,15),new _e(13,16))),new Zt(17,Int32Array.from([6,30,54,78]),new at(28,new _e(1,107),new _e(5,108)),new at(28,new _e(10,46),new _e(1,47)),new at(28,new _e(1,22),new _e(15,23)),new at(28,new _e(2,14),new _e(17,15))),new Zt(18,Int32Array.from([6,30,56,82]),new at(30,new _e(5,120),new _e(1,121)),new at(26,new _e(9,43),new _e(4,44)),new at(28,new _e(17,22),new _e(1,23)),new at(28,new _e(2,14),new _e(19,15))),new Zt(19,Int32Array.from([6,30,58,86]),new at(28,new _e(3,113),new _e(4,114)),new at(26,new _e(3,44),new _e(11,45)),new at(26,new _e(17,21),new _e(4,22)),new at(26,new _e(9,13),new _e(16,14))),new Zt(20,Int32Array.from([6,34,62,90]),new at(28,new _e(3,107),new _e(5,108)),new at(26,new _e(3,41),new _e(13,42)),new at(30,new _e(15,24),new _e(5,25)),new at(28,new _e(15,15),new _e(10,16))),new Zt(21,Int32Array.from([6,28,50,72,94]),new at(28,new _e(4,116),new _e(4,117)),new at(26,new _e(17,42)),new at(28,new _e(17,22),new _e(6,23)),new at(30,new _e(19,16),new _e(6,17))),new Zt(22,Int32Array.from([6,26,50,74,98]),new at(28,new _e(2,111),new _e(7,112)),new at(28,new _e(17,46)),new at(30,new _e(7,24),new _e(16,25)),new at(24,new _e(34,13))),new Zt(23,Int32Array.from([6,30,54,78,102]),new at(30,new _e(4,121),new _e(5,122)),new at(28,new _e(4,47),new _e(14,48)),new at(30,new _e(11,24),new _e(14,25)),new at(30,new _e(16,15),new _e(14,16))),new Zt(24,Int32Array.from([6,28,54,80,106]),new at(30,new _e(6,117),new _e(4,118)),new at(28,new _e(6,45),new _e(14,46)),new at(30,new _e(11,24),new _e(16,25)),new at(30,new _e(30,16),new _e(2,17))),new Zt(25,Int32Array.from([6,32,58,84,110]),new at(26,new _e(8,106),new _e(4,107)),new at(28,new _e(8,47),new _e(13,48)),new at(30,new _e(7,24),new _e(22,25)),new at(30,new _e(22,15),new _e(13,16))),new Zt(26,Int32Array.from([6,30,58,86,114]),new at(28,new _e(10,114),new _e(2,115)),new at(28,new _e(19,46),new _e(4,47)),new at(28,new _e(28,22),new _e(6,23)),new at(30,new _e(33,16),new _e(4,17))),new Zt(27,Int32Array.from([6,34,62,90,118]),new at(30,new _e(8,122),new _e(4,123)),new at(28,new _e(22,45),new _e(3,46)),new at(30,new _e(8,23),new _e(26,24)),new at(30,new _e(12,15),new _e(28,16))),new Zt(28,Int32Array.from([6,26,50,74,98,122]),new at(30,new _e(3,117),new _e(10,118)),new at(28,new _e(3,45),new _e(23,46)),new at(30,new _e(4,24),new _e(31,25)),new at(30,new _e(11,15),new _e(31,16))),new Zt(29,Int32Array.from([6,30,54,78,102,126]),new at(30,new _e(7,116),new _e(7,117)),new at(28,new _e(21,45),new _e(7,46)),new at(30,new _e(1,23),new _e(37,24)),new at(30,new _e(19,15),new _e(26,16))),new Zt(30,Int32Array.from([6,26,52,78,104,130]),new at(30,new _e(5,115),new _e(10,116)),new at(28,new _e(19,47),new _e(10,48)),new at(30,new _e(15,24),new _e(25,25)),new at(30,new _e(23,15),new _e(25,16))),new Zt(31,Int32Array.from([6,30,56,82,108,134]),new at(30,new _e(13,115),new _e(3,116)),new at(28,new _e(2,46),new _e(29,47)),new at(30,new _e(42,24),new _e(1,25)),new at(30,new _e(23,15),new _e(28,16))),new Zt(32,Int32Array.from([6,34,60,86,112,138]),new at(30,new _e(17,115)),new at(28,new _e(10,46),new _e(23,47)),new at(30,new _e(10,24),new _e(35,25)),new at(30,new _e(19,15),new _e(35,16))),new Zt(33,Int32Array.from([6,30,58,86,114,142]),new at(30,new _e(17,115),new _e(1,116)),new at(28,new _e(14,46),new _e(21,47)),new at(30,new _e(29,24),new _e(19,25)),new at(30,new _e(11,15),new _e(46,16))),new Zt(34,Int32Array.from([6,34,62,90,118,146]),new at(30,new _e(13,115),new _e(6,116)),new at(28,new _e(14,46),new _e(23,47)),new at(30,new _e(44,24),new _e(7,25)),new at(30,new _e(59,16),new _e(1,17))),new Zt(35,Int32Array.from([6,30,54,78,102,126,150]),new at(30,new _e(12,121),new _e(7,122)),new at(28,new _e(12,47),new _e(26,48)),new at(30,new _e(39,24),new _e(14,25)),new at(30,new _e(22,15),new _e(41,16))),new Zt(36,Int32Array.from([6,24,50,76,102,128,154]),new at(30,new _e(6,121),new _e(14,122)),new at(28,new _e(6,47),new _e(34,48)),new at(30,new _e(46,24),new _e(10,25)),new at(30,new _e(2,15),new _e(64,16))),new Zt(37,Int32Array.from([6,28,54,80,106,132,158]),new at(30,new _e(17,122),new _e(4,123)),new at(28,new _e(29,46),new _e(14,47)),new at(30,new _e(49,24),new _e(10,25)),new at(30,new _e(24,15),new _e(46,16))),new Zt(38,Int32Array.from([6,32,58,84,110,136,162]),new at(30,new _e(4,122),new _e(18,123)),new at(28,new _e(13,46),new _e(32,47)),new at(30,new _e(48,24),new _e(14,25)),new at(30,new _e(42,15),new _e(32,16))),new Zt(39,Int32Array.from([6,26,54,82,110,138,166]),new at(30,new _e(20,117),new _e(4,118)),new at(28,new _e(40,47),new _e(7,48)),new at(30,new _e(43,24),new _e(22,25)),new at(30,new _e(10,15),new _e(67,16))),new Zt(40,Int32Array.from([6,30,58,86,114,142,170]),new at(30,new _e(19,118),new _e(6,119)),new at(28,new _e(18,47),new _e(31,48)),new at(30,new _e(34,24),new _e(34,25)),new at(30,new _e(20,15),new _e(61,16)))];var na;(function(te){te[te.DATA_MASK_000=0]="DATA_MASK_000",te[te.DATA_MASK_001=1]="DATA_MASK_001",te[te.DATA_MASK_010=2]="DATA_MASK_010",te[te.DATA_MASK_011=3]="DATA_MASK_011",te[te.DATA_MASK_100=4]="DATA_MASK_100",te[te.DATA_MASK_101=5]="DATA_MASK_101",te[te.DATA_MASK_110=6]="DATA_MASK_110",te[te.DATA_MASK_111=7]="DATA_MASK_111"})(na||(na={}));class pn{constructor(l,u){this.value=l,this.isMasked=u}unmaskBitMatrix(l,u){for(let m=0;m<u;m++)for(let g=0;g<u;g++)this.isMasked(m,g)&&l.flip(g,m)}}pn.values=new Map([[na.DATA_MASK_000,new pn(na.DATA_MASK_000,(te,l)=>(te+l&1)===0)],[na.DATA_MASK_001,new pn(na.DATA_MASK_001,(te,l)=>(te&1)===0)],[na.DATA_MASK_010,new pn(na.DATA_MASK_010,(te,l)=>l%3===0)],[na.DATA_MASK_011,new pn(na.DATA_MASK_011,(te,l)=>(te+l)%3===0)],[na.DATA_MASK_100,new pn(na.DATA_MASK_100,(te,l)=>(Math.floor(te/2)+Math.floor(l/3)&1)===0)],[na.DATA_MASK_101,new pn(na.DATA_MASK_101,(te,l)=>te*l%6===0)],[na.DATA_MASK_110,new pn(na.DATA_MASK_110,(te,l)=>te*l%6<3)],[na.DATA_MASK_111,new pn(na.DATA_MASK_111,(te,l)=>(te+l+te*l%3&1)===0)]]);class $d{constructor(l){const u=l.getHeight();if(u<21||(u&3)!==1)throw new D;this.bitMatrix=l}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let l=0;for(let y=0;y<6;y++)l=this.copyBit(y,8,l);l=this.copyBit(7,8,l),l=this.copyBit(8,8,l),l=this.copyBit(8,7,l);for(let y=5;y>=0;y--)l=this.copyBit(8,y,l);const u=this.bitMatrix.getHeight();let m=0;const g=u-7;for(let y=u-1;y>=g;y--)m=this.copyBit(8,y,m);for(let y=u-8;y<u;y++)m=this.copyBit(y,8,m);if(this.parsedFormatInfo=mn.decodeFormatInformation(l,m),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new D}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const l=this.bitMatrix.getHeight(),u=Math.floor((l-17)/4);if(u<=6)return Zt.getVersionForNumber(u);let m=0;const g=l-11;for(let j=5;j>=0;j--)for(let S=l-9;S>=g;S--)m=this.copyBit(S,j,m);let y=Zt.decodeVersionInformation(m);if(y!==null&&y.getDimensionForVersion()===l)return this.parsedVersion=y,y;m=0;for(let j=5;j>=0;j--)for(let S=l-9;S>=g;S--)m=this.copyBit(j,S,m);if(y=Zt.decodeVersionInformation(m),y!==null&&y.getDimensionForVersion()===l)return this.parsedVersion=y,y;throw new D}copyBit(l,u,m){return(this.isMirror?this.bitMatrix.get(u,l):this.bitMatrix.get(l,u))?m<<1|1:m<<1}readCodewords(){const l=this.readFormatInformation(),u=this.readVersion(),m=pn.values.get(l.getDataMask()),g=this.bitMatrix.getHeight();m.unmaskBitMatrix(this.bitMatrix,g);const y=u.buildFunctionPattern();let j=!0;const S=new Uint8Array(u.getTotalCodewords());let P=0,V=0,K=0;for(let se=g-1;se>0;se-=2){se===6&&se--;for(let ue=0;ue<g;ue++){const Ae=j?g-1-ue:ue;for(let Ve=0;Ve<2;Ve++)y.get(se-Ve,Ae)||(K++,V<<=1,this.bitMatrix.get(se-Ve,Ae)&&(V|=1),K===8&&(S[P++]=V,K=0,V=0))}j=!j}if(P!==u.getTotalCodewords())throw new D;return S}remask(){if(this.parsedFormatInfo===null)return;const l=pn.values[this.parsedFormatInfo.getDataMask()],u=this.bitMatrix.getHeight();l.unmaskBitMatrix(this.bitMatrix,u)}setMirror(l){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=l}mirror(){const l=this.bitMatrix;for(let u=0,m=l.getWidth();u<m;u++)for(let g=u+1,y=l.getHeight();g<y;g++)l.get(u,g)!==l.get(g,u)&&(l.flip(g,u),l.flip(u,g))}}class qd{constructor(l,u){this.numDataCodewords=l,this.codewords=u}static getDataBlocks(l,u,m){if(l.length!==u.getTotalCodewords())throw new x;const g=u.getECBlocksForLevel(m);let y=0;const j=g.getECBlocks();for(const Ve of j)y+=Ve.getCount();const S=new Array(y);let P=0;for(const Ve of j)for(let $e=0;$e<Ve.getCount();$e++){const st=Ve.getDataCodewords(),ht=g.getECCodewordsPerBlock()+st;S[P++]=new qd(st,new Uint8Array(ht))}const V=S[0].codewords.length;let K=S.length-1;for(;K>=0&&S[K].codewords.length!==V;)K--;K++;const se=V-g.getECCodewordsPerBlock();let ue=0;for(let Ve=0;Ve<se;Ve++)for(let $e=0;$e<P;$e++)S[$e].codewords[Ve]=l[ue++];for(let Ve=K;Ve<P;Ve++)S[Ve].codewords[se]=l[ue++];const Ae=S[0].codewords.length;for(let Ve=se;Ve<Ae;Ve++)for(let $e=0;$e<P;$e++){const st=$e<K?Ve:Ve+1;S[$e].codewords[st]=l[ue++]}return S}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var xn;(function(te){te[te.TERMINATOR=0]="TERMINATOR",te[te.NUMERIC=1]="NUMERIC",te[te.ALPHANUMERIC=2]="ALPHANUMERIC",te[te.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",te[te.BYTE=4]="BYTE",te[te.ECI=5]="ECI",te[te.KANJI=6]="KANJI",te[te.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",te[te.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",te[te.HANZI=9]="HANZI"})(xn||(xn={}));class Ns{constructor(l,u,m,g){this.value=l,this.stringValue=u,this.characterCountBitsForVersions=m,this.bits=g,Ns.FOR_BITS.set(g,this),Ns.FOR_VALUE.set(l,this)}static forBits(l){const u=Ns.FOR_BITS.get(l);if(u===void 0)throw new x;return u}getCharacterCountBits(l){const u=l.getVersionNumber();let m;return u<=9?m=0:u<=26?m=1:m=2,this.characterCountBitsForVersions[m]}getValue(){return this.value}getBits(){return this.bits}equals(l){if(!(l instanceof Ns))return!1;const u=l;return this.value===u.value}toString(){return this.stringValue}}Ns.FOR_BITS=new Map,Ns.FOR_VALUE=new Map,Ns.TERMINATOR=new Ns(xn.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),Ns.NUMERIC=new Ns(xn.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),Ns.ALPHANUMERIC=new Ns(xn.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),Ns.STRUCTURED_APPEND=new Ns(xn.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),Ns.BYTE=new Ns(xn.BYTE,"BYTE",Int32Array.from([8,16,16]),4),Ns.ECI=new Ns(xn.ECI,"ECI",Int32Array.from([0,0,0]),7),Ns.KANJI=new Ns(xn.KANJI,"KANJI",Int32Array.from([8,10,12]),8),Ns.FNC1_FIRST_POSITION=new Ns(xn.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),Ns.FNC1_SECOND_POSITION=new Ns(xn.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),Ns.HANZI=new Ns(xn.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class sa{static decode(l,u,m,g){const y=new Tc(l);let j=new ae;const S=new Array;let P=-1,V=-1;try{let K=null,se=!1,ue;do{if(y.available()<4)ue=Ns.TERMINATOR;else{const Ae=y.readBits(4);ue=Ns.forBits(Ae)}switch(ue){case Ns.TERMINATOR:break;case Ns.FNC1_FIRST_POSITION:case Ns.FNC1_SECOND_POSITION:se=!0;break;case Ns.STRUCTURED_APPEND:if(y.available()<16)throw new D;P=y.readBits(8),V=y.readBits(8);break;case Ns.ECI:const Ae=sa.parseECIValue(y);if(K=M.getCharacterSetECIByValue(Ae),K===null)throw new D;break;case Ns.HANZI:const Ve=y.readBits(4),$e=y.readBits(ue.getCharacterCountBits(u));Ve===sa.GB2312_SUBSET&&sa.decodeHanziSegment(y,j,$e);break;default:const st=y.readBits(ue.getCharacterCountBits(u));switch(ue){case Ns.NUMERIC:sa.decodeNumericSegment(y,j,st);break;case Ns.ALPHANUMERIC:sa.decodeAlphanumericSegment(y,j,st,se);break;case Ns.BYTE:sa.decodeByteSegment(y,j,st,K,S,g);break;case Ns.KANJI:sa.decodeKanjiSegment(y,j,st);break;default:throw new D}break}}while(ue!==Ns.TERMINATOR)}catch{throw new D}return new fe(l,j.toString(),S.length===0?null:S,m===null?null:m.toString(),P,V)}static decodeHanziSegment(l,u,m){if(m*13>l.available())throw new D;const g=new Uint8Array(2*m);let y=0;for(;m>0;){const j=l.readBits(13);let S=j/96<<8&4294967295|j%96;S<959?S+=41377:S+=42657,g[y]=S>>8&255,g[y+1]=S&255,y+=2,m--}try{u.append(q.decode(g,Y.GB2312))}catch(j){throw new D(j)}}static decodeKanjiSegment(l,u,m){if(m*13>l.available())throw new D;const g=new Uint8Array(2*m);let y=0;for(;m>0;){const j=l.readBits(13);let S=j/192<<8&4294967295|j%192;S<7936?S+=33088:S+=49472,g[y]=S>>8,g[y+1]=S,y+=2,m--}try{u.append(q.decode(g,Y.SHIFT_JIS))}catch(j){throw new D(j)}}static decodeByteSegment(l,u,m,g,y,j){if(8*m>l.available())throw new D;const S=new Uint8Array(m);for(let V=0;V<m;V++)S[V]=l.readBits(8);let P;g===null?P=Y.guessEncoding(S,j):P=g.getName();try{u.append(q.decode(S,P))}catch(V){throw new D(V)}y.push(S)}static toAlphaNumericChar(l){if(l>=sa.ALPHANUMERIC_CHARS.length)throw new D;return sa.ALPHANUMERIC_CHARS[l]}static decodeAlphanumericSegment(l,u,m,g){const y=u.length();for(;m>1;){if(l.available()<11)throw new D;const j=l.readBits(11);u.append(sa.toAlphaNumericChar(Math.floor(j/45))),u.append(sa.toAlphaNumericChar(j%45)),m-=2}if(m===1){if(l.available()<6)throw new D;u.append(sa.toAlphaNumericChar(l.readBits(6)))}if(g)for(let j=y;j<u.length();j++)u.charAt(j)==="%"&&(j<u.length()-1&&u.charAt(j+1)==="%"?u.deleteCharAt(j+1):u.setCharAt(j,""))}static decodeNumericSegment(l,u,m){for(;m>=3;){if(l.available()<10)throw new D;const g=l.readBits(10);if(g>=1e3)throw new D;u.append(sa.toAlphaNumericChar(Math.floor(g/100))),u.append(sa.toAlphaNumericChar(Math.floor(g/10)%10)),u.append(sa.toAlphaNumericChar(g%10)),m-=3}if(m===2){if(l.available()<7)throw new D;const g=l.readBits(7);if(g>=100)throw new D;u.append(sa.toAlphaNumericChar(Math.floor(g/10))),u.append(sa.toAlphaNumericChar(g%10))}else if(m===1){if(l.available()<4)throw new D;const g=l.readBits(4);if(g>=10)throw new D;u.append(sa.toAlphaNumericChar(g))}}static parseECIValue(l){const u=l.readBits(8);if(!(u&128))return u&127;if((u&192)===128){const m=l.readBits(8);return(u&63)<<8&4294967295|m}if((u&224)===192){const m=l.readBits(16);return(u&31)<<16&4294967295|m}throw new D}}sa.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",sa.GB2312_SUBSET=1;class Wd{constructor(l){this.mirrored=l}isMirrored(){return this.mirrored}applyMirroredCorrection(l){if(!this.mirrored||l===null||l.length<3)return;const u=l[0];l[0]=l[2],l[2]=u}}class Jf{constructor(){this.rsDecoder=new Se(Ie.QR_CODE_FIELD_256)}decodeBooleanArray(l,u){return this.decodeBitMatrix(je.parseFromBooleanArray(l),u)}decodeBitMatrix(l,u){const m=new $d(l);let g=null;try{return this.decodeBitMatrixParser(m,u)}catch(y){g=y}try{m.remask(),m.setMirror(!0),m.readVersion(),m.readFormatInformation(),m.mirror();const y=this.decodeBitMatrixParser(m,u);return y.setOther(new Wd(!0)),y}catch(y){throw g!==null?g:y}}decodeBitMatrixParser(l,u){const m=l.readVersion(),g=l.readFormatInformation().getErrorCorrectionLevel(),y=l.readCodewords(),j=qd.getDataBlocks(y,m,g);let S=0;for(const K of j)S+=K.getNumDataCodewords();const P=new Uint8Array(S);let V=0;for(const K of j){const se=K.getCodewords(),ue=K.getNumDataCodewords();this.correctErrors(se,ue);for(let Ae=0;Ae<ue;Ae++)P[V++]=se[Ae]}return sa.decode(P,m,g,u)}correctErrors(l,u){const m=new Int32Array(l);try{this.rsDecoder.decode(m,l.length-u)}catch{throw new b}for(let g=0;g<u;g++)l[g]=m[g]}}class Hd extends Ge{constructor(l,u,m){super(l,u),this.estimatedModuleSize=m}aboutEquals(l,u,m){if(Math.abs(u-this.getY())<=l&&Math.abs(m-this.getX())<=l){const g=Math.abs(l-this.estimatedModuleSize);return g<=1||g<=this.estimatedModuleSize}return!1}combineEstimate(l,u,m){const g=(this.getX()+u)/2,y=(this.getY()+l)/2,j=(this.estimatedModuleSize+m)/2;return new Hd(g,y,j)}}class Gl{constructor(l,u,m,g,y,j,S){this.image=l,this.startX=u,this.startY=m,this.width=g,this.height=y,this.moduleSize=j,this.resultPointCallback=S,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const l=this.startX,u=this.height,m=this.width,g=l+m,y=this.startY+u/2,j=new Int32Array(3),S=this.image;for(let P=0;P<u;P++){const V=y+(P&1?-Math.floor((P+1)/2):Math.floor((P+1)/2));j[0]=0,j[1]=0,j[2]=0;let K=l;for(;K<g&&!S.get(K,V);)K++;let se=0;for(;K<g;){if(S.get(K,V))if(se===1)j[1]++;else if(se===2){if(this.foundPatternCross(j)){const ue=this.handlePossibleCenter(j,V,K);if(ue!==null)return ue}j[0]=j[2],j[1]=1,j[2]=0,se=1}else j[++se]++;else se===1&&se++,j[se]++;K++}if(this.foundPatternCross(j)){const ue=this.handlePossibleCenter(j,V,g);if(ue!==null)return ue}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new H}static centerFromEnd(l,u){return u-l[2]-l[1]/2}foundPatternCross(l){const u=this.moduleSize,m=u/2;for(let g=0;g<3;g++)if(Math.abs(u-l[g])>=m)return!1;return!0}crossCheckVertical(l,u,m,g){const y=this.image,j=y.getHeight(),S=this.crossCheckStateCount;S[0]=0,S[1]=0,S[2]=0;let P=l;for(;P>=0&&y.get(u,P)&&S[1]<=m;)S[1]++,P--;if(P<0||S[1]>m)return NaN;for(;P>=0&&!y.get(u,P)&&S[0]<=m;)S[0]++,P--;if(S[0]>m)return NaN;for(P=l+1;P<j&&y.get(u,P)&&S[1]<=m;)S[1]++,P++;if(P===j||S[1]>m)return NaN;for(;P<j&&!y.get(u,P)&&S[2]<=m;)S[2]++,P++;if(S[2]>m)return NaN;const V=S[0]+S[1]+S[2];return 5*Math.abs(V-g)>=2*g?NaN:this.foundPatternCross(S)?Gl.centerFromEnd(S,P):NaN}handlePossibleCenter(l,u,m){const g=l[0]+l[1]+l[2],y=Gl.centerFromEnd(l,m),j=this.crossCheckVertical(u,y,2*l[1],g);if(!isNaN(j)){const S=(l[0]+l[1]+l[2])/3;for(const V of this.possibleCenters)if(V.aboutEquals(S,j,y))return V.combineEstimate(j,y,S);const P=new Hd(y,j,S);this.possibleCenters.push(P),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(P)}return null}}class Qu extends Ge{constructor(l,u,m,g){super(l,u),this.estimatedModuleSize=m,this.count=g,g===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(l,u,m){if(Math.abs(u-this.getY())<=l&&Math.abs(m-this.getX())<=l){const g=Math.abs(l-this.estimatedModuleSize);return g<=1||g<=this.estimatedModuleSize}return!1}combineEstimate(l,u,m){const g=this.count+1,y=(this.count*this.getX()+u)/g,j=(this.count*this.getY()+l)/g,S=(this.count*this.estimatedModuleSize+m)/g;return new Qu(y,j,S,g)}}class em{constructor(l){this.bottomLeft=l[0],this.topLeft=l[1],this.topRight=l[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class za{constructor(l,u){this.image=l,this.resultPointCallback=u,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=u}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(l){const u=l!=null&&l.get(O.TRY_HARDER)!==void 0,m=l!=null&&l.get(O.PURE_BARCODE)!==void 0,g=this.image,y=g.getHeight(),j=g.getWidth();let S=Math.floor(3*y/(4*za.MAX_MODULES));(S<za.MIN_SKIP||u)&&(S=za.MIN_SKIP);let P=!1;const V=new Int32Array(5);for(let se=S-1;se<y&&!P;se+=S){V[0]=0,V[1]=0,V[2]=0,V[3]=0,V[4]=0;let ue=0;for(let Ae=0;Ae<j;Ae++)if(g.get(Ae,se))(ue&1)===1&&ue++,V[ue]++;else if(ue&1)V[ue]++;else if(ue===4)if(za.foundPatternCross(V)){if(this.handlePossibleCenter(V,se,Ae,m)===!0)if(S=2,this.hasSkipped===!0)P=this.haveMultiplyConfirmedCenters();else{const $e=this.findRowSkip();$e>V[2]&&(se+=$e-V[2]-S,Ae=j-1)}else{V[0]=V[2],V[1]=V[3],V[2]=V[4],V[3]=1,V[4]=0,ue=3;continue}ue=0,V[0]=0,V[1]=0,V[2]=0,V[3]=0,V[4]=0}else V[0]=V[2],V[1]=V[3],V[2]=V[4],V[3]=1,V[4]=0,ue=3;else V[++ue]++;za.foundPatternCross(V)&&this.handlePossibleCenter(V,se,j,m)===!0&&(S=V[0],this.hasSkipped&&(P=this.haveMultiplyConfirmedCenters()))}const K=this.selectBestPatterns();return Ge.orderBestPatterns(K),new em(K)}static centerFromEnd(l,u){return u-l[4]-l[3]-l[2]/2}static foundPatternCross(l){let u=0;for(let y=0;y<5;y++){const j=l[y];if(j===0)return!1;u+=j}if(u<7)return!1;const m=u/7,g=m/2;return Math.abs(m-l[0])<g&&Math.abs(m-l[1])<g&&Math.abs(3*m-l[2])<3*g&&Math.abs(m-l[3])<g&&Math.abs(m-l[4])<g}getCrossCheckStateCount(){const l=this.crossCheckStateCount;return l[0]=0,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l}crossCheckDiagonal(l,u,m,g){const y=this.getCrossCheckStateCount();let j=0;const S=this.image;for(;l>=j&&u>=j&&S.get(u-j,l-j);)y[2]++,j++;if(l<j||u<j)return!1;for(;l>=j&&u>=j&&!S.get(u-j,l-j)&&y[1]<=m;)y[1]++,j++;if(l<j||u<j||y[1]>m)return!1;for(;l>=j&&u>=j&&S.get(u-j,l-j)&&y[0]<=m;)y[0]++,j++;if(y[0]>m)return!1;const P=S.getHeight(),V=S.getWidth();for(j=1;l+j<P&&u+j<V&&S.get(u+j,l+j);)y[2]++,j++;if(l+j>=P||u+j>=V)return!1;for(;l+j<P&&u+j<V&&!S.get(u+j,l+j)&&y[3]<m;)y[3]++,j++;if(l+j>=P||u+j>=V||y[3]>=m)return!1;for(;l+j<P&&u+j<V&&S.get(u+j,l+j)&&y[4]<m;)y[4]++,j++;if(y[4]>=m)return!1;const K=y[0]+y[1]+y[2]+y[3]+y[4];return Math.abs(K-g)<2*g&&za.foundPatternCross(y)}crossCheckVertical(l,u,m,g){const y=this.image,j=y.getHeight(),S=this.getCrossCheckStateCount();let P=l;for(;P>=0&&y.get(u,P);)S[2]++,P--;if(P<0)return NaN;for(;P>=0&&!y.get(u,P)&&S[1]<=m;)S[1]++,P--;if(P<0||S[1]>m)return NaN;for(;P>=0&&y.get(u,P)&&S[0]<=m;)S[0]++,P--;if(S[0]>m)return NaN;for(P=l+1;P<j&&y.get(u,P);)S[2]++,P++;if(P===j)return NaN;for(;P<j&&!y.get(u,P)&&S[3]<m;)S[3]++,P++;if(P===j||S[3]>=m)return NaN;for(;P<j&&y.get(u,P)&&S[4]<m;)S[4]++,P++;if(S[4]>=m)return NaN;const V=S[0]+S[1]+S[2]+S[3]+S[4];return 5*Math.abs(V-g)>=2*g?NaN:za.foundPatternCross(S)?za.centerFromEnd(S,P):NaN}crossCheckHorizontal(l,u,m,g){const y=this.image,j=y.getWidth(),S=this.getCrossCheckStateCount();let P=l;for(;P>=0&&y.get(P,u);)S[2]++,P--;if(P<0)return NaN;for(;P>=0&&!y.get(P,u)&&S[1]<=m;)S[1]++,P--;if(P<0||S[1]>m)return NaN;for(;P>=0&&y.get(P,u)&&S[0]<=m;)S[0]++,P--;if(S[0]>m)return NaN;for(P=l+1;P<j&&y.get(P,u);)S[2]++,P++;if(P===j)return NaN;for(;P<j&&!y.get(P,u)&&S[3]<m;)S[3]++,P++;if(P===j||S[3]>=m)return NaN;for(;P<j&&y.get(P,u)&&S[4]<m;)S[4]++,P++;if(S[4]>=m)return NaN;const V=S[0]+S[1]+S[2]+S[3]+S[4];return 5*Math.abs(V-g)>=g?NaN:za.foundPatternCross(S)?za.centerFromEnd(S,P):NaN}handlePossibleCenter(l,u,m,g){const y=l[0]+l[1]+l[2]+l[3]+l[4];let j=za.centerFromEnd(l,m),S=this.crossCheckVertical(u,Math.floor(j),l[2],y);if(!isNaN(S)&&(j=this.crossCheckHorizontal(Math.floor(j),Math.floor(S),l[2],y),!isNaN(j)&&(!g||this.crossCheckDiagonal(Math.floor(S),Math.floor(j),l[2],y)))){const P=y/7;let V=!1;const K=this.possibleCenters;for(let se=0,ue=K.length;se<ue;se++){const Ae=K[se];if(Ae.aboutEquals(P,S,j)){K[se]=Ae.combineEstimate(S,j,P),V=!0;break}}if(!V){const se=new Qu(j,S,P);K.push(se),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(se)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let u=null;for(const m of this.possibleCenters)if(m.getCount()>=za.CENTER_QUORUM)if(u==null)u=m;else return this.hasSkipped=!0,Math.floor((Math.abs(u.getX()-m.getX())-Math.abs(u.getY()-m.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let l=0,u=0;const m=this.possibleCenters.length;for(const j of this.possibleCenters)j.getCount()>=za.CENTER_QUORUM&&(l++,u+=j.getEstimatedModuleSize());if(l<3)return!1;const g=u/m;let y=0;for(const j of this.possibleCenters)y+=Math.abs(j.getEstimatedModuleSize()-g);return y<=.05*u}selectBestPatterns(){const l=this.possibleCenters.length;if(l<3)throw new H;const u=this.possibleCenters;let m;if(l>3){let g=0,y=0;for(const P of this.possibleCenters){const V=P.getEstimatedModuleSize();g+=V,y+=V*V}m=g/l;let j=Math.sqrt(y/l-m*m);u.sort((P,V)=>{const K=Math.abs(V.getEstimatedModuleSize()-m),se=Math.abs(P.getEstimatedModuleSize()-m);return K<se?-1:K>se?1:0});const S=Math.max(.2*m,j);for(let P=0;P<u.length&&u.length>3;P++){const V=u[P];Math.abs(V.getEstimatedModuleSize()-m)>S&&(u.splice(P,1),P--)}}if(u.length>3){let g=0;for(const y of u)g+=y.getEstimatedModuleSize();m=g/u.length,u.sort((y,j)=>{if(j.getCount()===y.getCount()){const S=Math.abs(j.getEstimatedModuleSize()-m),P=Math.abs(y.getEstimatedModuleSize()-m);return S<P?1:S>P?-1:0}else return j.getCount()-y.getCount()}),u.splice(3)}return[u[0],u[1],u[2]]}}za.CENTER_QUORUM=2,za.MIN_SKIP=3,za.MAX_MODULES=57;class Vs{constructor(l){this.image=l}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(l){this.resultPointCallback=l==null?null:l.get(O.NEED_RESULT_POINT_CALLBACK);const m=new za(this.image,this.resultPointCallback).find(l);return this.processFinderPatternInfo(m)}processFinderPatternInfo(l){const u=l.getTopLeft(),m=l.getTopRight(),g=l.getBottomLeft(),y=this.calculateModuleSize(u,m,g);if(y<1)throw new H("No pattern found in proccess finder.");const j=Vs.computeDimension(u,m,g,y),S=Zt.getProvisionalVersionForDimension(j),P=S.getDimensionForVersion()-7;let V=null;if(S.getAlignmentPatternCenters().length>0){const Ae=m.getX()-u.getX()+g.getX(),Ve=m.getY()-u.getY()+g.getY(),$e=1-3/P,st=Math.floor(u.getX()+$e*(Ae-u.getX())),ht=Math.floor(u.getY()+$e*(Ve-u.getY()));for(let Bt=4;Bt<=16;Bt<<=1)try{V=this.findAlignmentInRegion(y,st,ht,Bt);break}catch(Vt){if(!(Vt instanceof H))throw Vt}}const K=Vs.createTransform(u,m,g,V,j),se=Vs.sampleGrid(this.image,K,j);let ue;return V===null?ue=[g,u,m]:ue=[g,u,m,V],new Lt(se,ue)}static createTransform(l,u,m,g,y){const j=y-3.5;let S,P,V,K;return g!==null?(S=g.getX(),P=g.getY(),V=j-3,K=V):(S=u.getX()-l.getX()+m.getX(),P=u.getY()-l.getY()+m.getY(),V=j,K=j),dt.quadrilateralToQuadrilateral(3.5,3.5,j,3.5,V,K,3.5,j,l.getX(),l.getY(),u.getX(),u.getY(),S,P,m.getX(),m.getY())}static sampleGrid(l,u,m){return Ut.getInstance().sampleGridWithTransform(l,m,m,u)}static computeDimension(l,u,m,g){const y=Le.round(Ge.distance(l,u)/g),j=Le.round(Ge.distance(l,m)/g);let S=Math.floor((y+j)/2)+7;switch(S&3){case 0:S++;break;case 2:S--;break;case 3:throw new H("Dimensions could be not found.")}return S}calculateModuleSize(l,u,m){return(this.calculateModuleSizeOneWay(l,u)+this.calculateModuleSizeOneWay(l,m))/2}calculateModuleSizeOneWay(l,u){const m=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(l.getX()),Math.floor(l.getY()),Math.floor(u.getX()),Math.floor(u.getY())),g=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(u.getX()),Math.floor(u.getY()),Math.floor(l.getX()),Math.floor(l.getY()));return isNaN(m)?g/7:isNaN(g)?m/7:(m+g)/14}sizeOfBlackWhiteBlackRunBothWays(l,u,m,g){let y=this.sizeOfBlackWhiteBlackRun(l,u,m,g),j=1,S=l-(m-l);S<0?(j=l/(l-S),S=0):S>=this.image.getWidth()&&(j=(this.image.getWidth()-1-l)/(S-l),S=this.image.getWidth()-1);let P=Math.floor(u-(g-u)*j);return j=1,P<0?(j=u/(u-P),P=0):P>=this.image.getHeight()&&(j=(this.image.getHeight()-1-u)/(P-u),P=this.image.getHeight()-1),S=Math.floor(l+(S-l)*j),y+=this.sizeOfBlackWhiteBlackRun(l,u,S,P),y-1}sizeOfBlackWhiteBlackRun(l,u,m,g){const y=Math.abs(g-u)>Math.abs(m-l);if(y){let Ae=l;l=u,u=Ae,Ae=m,m=g,g=Ae}const j=Math.abs(m-l),S=Math.abs(g-u);let P=-j/2;const V=l<m?1:-1,K=u<g?1:-1;let se=0;const ue=m+V;for(let Ae=l,Ve=u;Ae!==ue;Ae+=V){const $e=y?Ve:Ae,st=y?Ae:Ve;if(se===1===this.image.get($e,st)){if(se===2)return Le.distance(Ae,Ve,l,u);se++}if(P+=S,P>0){if(Ve===g)break;Ve+=K,P-=j}}return se===2?Le.distance(m+V,g,l,u):NaN}findAlignmentInRegion(l,u,m,g){const y=Math.floor(g*l),j=Math.max(0,u-y),S=Math.min(this.image.getWidth()-1,u+y);if(S-j<l*3)throw new H("Alignment top exceeds estimated module size.");const P=Math.max(0,m-y),V=Math.min(this.image.getHeight()-1,m+y);if(V-P<l*3)throw new H("Alignment bottom exceeds estimated module size.");return new Gl(this.image,j,P,S-j,V-P,l,this.resultPointCallback).find()}}class en{constructor(){this.decoder=new Jf}getDecoder(){return this.decoder}decode(l,u){let m,g;if(u!=null&&u.get(O.PURE_BARCODE)!==void 0){const P=en.extractPureBits(l.getBlackMatrix());m=this.decoder.decodeBitMatrix(P,u),g=en.NO_POINTS}else{const P=new Vs(l.getBlackMatrix()).detect(u);m=this.decoder.decodeBitMatrix(P.getBits(),u),g=P.getPoints()}m.getOther()instanceof Wd&&m.getOther().applyMirroredCorrection(g);const y=new ie(m.getText(),m.getRawBytes(),void 0,g,xe.QR_CODE,void 0),j=m.getByteSegments();j!==null&&y.putMetadata(me.BYTE_SEGMENTS,j);const S=m.getECLevel();return S!==null&&y.putMetadata(me.ERROR_CORRECTION_LEVEL,S),m.hasStructuredAppend()&&(y.putMetadata(me.STRUCTURED_APPEND_SEQUENCE,m.getStructuredAppendSequenceNumber()),y.putMetadata(me.STRUCTURED_APPEND_PARITY,m.getStructuredAppendParity())),y}reset(){}static extractPureBits(l){const u=l.getTopLeftOnBit(),m=l.getBottomRightOnBit();if(u===null||m===null)throw new H;const g=this.moduleSize(u,l);let y=u[1],j=m[1],S=u[0],P=m[0];if(S>=P||y>=j)throw new H;if(j-y!==P-S&&(P=S+(j-y),P>=l.getWidth()))throw new H;const V=Math.round((P-S+1)/g),K=Math.round((j-y+1)/g);if(V<=0||K<=0)throw new H;if(K!==V)throw new H;const se=Math.floor(g/2);y+=se,S+=se;const ue=S+Math.floor((V-1)*g)-P;if(ue>0){if(ue>se)throw new H;S-=ue}const Ae=y+Math.floor((K-1)*g)-j;if(Ae>0){if(Ae>se)throw new H;y-=Ae}const Ve=new je(V,K);for(let $e=0;$e<K;$e++){const st=y+Math.floor($e*g);for(let ht=0;ht<V;ht++)l.get(S+Math.floor(ht*g),st)&&Ve.set(ht,$e)}return Ve}static moduleSize(l,u){const m=u.getHeight(),g=u.getWidth();let y=l[0],j=l[1],S=!0,P=0;for(;y<g&&j<m;){if(S!==u.get(y,j)){if(++P===5)break;S=!S}y++,j++}if(y===g||j===m)throw new H;return(y-l[0])/7}}en.NO_POINTS=new Array;class Qt{PDF417Common(){}static getBitCountSum(l){return Le.sum(l)}static toIntArray(l){if(l==null||!l.length)return Qt.EMPTY_INT_ARRAY;const u=new Int32Array(l.length);let m=0;for(const g of l)u[m++]=g;return u}static getCodeword(l){const u=A.binarySearch(Qt.SYMBOL_TABLE,l&262143);return u<0?-1:(Qt.CODEWORD_TABLE[u]-1)%Qt.NUMBER_OF_CODEWORDS}}Qt.NUMBER_OF_CODEWORDS=929,Qt.MAX_CODEWORDS_IN_BARCODE=Qt.NUMBER_OF_CODEWORDS-1,Qt.MIN_ROWS_IN_BARCODE=3,Qt.MAX_ROWS_IN_BARCODE=90,Qt.MODULES_IN_CODEWORD=17,Qt.MODULES_IN_STOP_PATTERN=18,Qt.BARS_IN_MODULE=8,Qt.EMPTY_INT_ARRAY=new Int32Array([]),Qt.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Qt.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class y0{constructor(l,u){this.bits=l,this.points=u}getBits(){return this.bits}getPoints(){return this.points}}class Xs{static detectMultiple(l,u,m){let g=l.getBlackMatrix(),y=Xs.detect(m,g);return y.length||(g=g.clone(),g.rotate180(),y=Xs.detect(m,g)),new y0(g,y)}static detect(l,u){const m=new Array;let g=0,y=0,j=!1;for(;g<u.getHeight();){const S=Xs.findVertices(u,g,y);if(S[0]==null&&S[3]==null){if(!j)break;j=!1,y=0;for(const P of m)P[1]!=null&&(g=Math.trunc(Math.max(g,P[1].getY()))),P[3]!=null&&(g=Math.max(g,Math.trunc(P[3].getY())));g+=Xs.ROW_STEP;continue}if(j=!0,m.push(S),!l)break;S[2]!=null?(y=Math.trunc(S[2].getX()),g=Math.trunc(S[2].getY())):(y=Math.trunc(S[4].getX()),g=Math.trunc(S[4].getY()))}return m}static findVertices(l,u,m){const g=l.getHeight(),y=l.getWidth(),j=new Array(8);return Xs.copyToResult(j,Xs.findRowsWithPattern(l,g,y,u,m,Xs.START_PATTERN),Xs.INDEXES_START_PATTERN),j[4]!=null&&(m=Math.trunc(j[4].getX()),u=Math.trunc(j[4].getY())),Xs.copyToResult(j,Xs.findRowsWithPattern(l,g,y,u,m,Xs.STOP_PATTERN),Xs.INDEXES_STOP_PATTERN),j}static copyToResult(l,u,m){for(let g=0;g<m.length;g++)l[m[g]]=u[g]}static findRowsWithPattern(l,u,m,g,y,j){const S=new Array(4);let P=!1;const V=new Int32Array(j.length);for(;g<u;g+=Xs.ROW_STEP){let se=Xs.findGuardPattern(l,y,g,m,!1,j,V);if(se!=null){for(;g>0;){const ue=Xs.findGuardPattern(l,y,--g,m,!1,j,V);if(ue!=null)se=ue;else{g++;break}}S[0]=new Ge(se[0],g),S[1]=new Ge(se[1],g),P=!0;break}}let K=g+1;if(P){let se=0,ue=Int32Array.from([Math.trunc(S[0].getX()),Math.trunc(S[1].getX())]);for(;K<u;K++){const Ae=Xs.findGuardPattern(l,ue[0],K,m,!1,j,V);if(Ae!=null&&Math.abs(ue[0]-Ae[0])<Xs.MAX_PATTERN_DRIFT&&Math.abs(ue[1]-Ae[1])<Xs.MAX_PATTERN_DRIFT)ue=Ae,se=0;else{if(se>Xs.SKIPPED_ROW_COUNT_MAX)break;se++}}K-=se+1,S[2]=new Ge(ue[0],K),S[3]=new Ge(ue[1],K)}return K-g<Xs.BARCODE_MIN_HEIGHT&&A.fill(S,null),S}static findGuardPattern(l,u,m,g,y,j,S){A.fillWithin(S,0,S.length,0);let P=u,V=0;for(;l.get(P,m)&&P>0&&V++<Xs.MAX_PIXEL_DRIFT;)P--;let K=P,se=0,ue=j.length;for(let Ae=y;K<g;K++)if(l.get(K,m)!==Ae)S[se]++;else{if(se===ue-1){if(Xs.patternMatchVariance(S,j,Xs.MAX_INDIVIDUAL_VARIANCE)<Xs.MAX_AVG_VARIANCE)return new Int32Array([P,K]);P+=S[0]+S[1],_.arraycopy(S,2,S,0,se-1),S[se-1]=0,S[se]=0,se--}else se++;S[se]=1,Ae=!Ae}return se===ue-1&&Xs.patternMatchVariance(S,j,Xs.MAX_INDIVIDUAL_VARIANCE)<Xs.MAX_AVG_VARIANCE?new Int32Array([P,K-1]):null}static patternMatchVariance(l,u,m){let g=l.length,y=0,j=0;for(let V=0;V<g;V++)y+=l[V],j+=u[V];if(y<j)return 1/0;let S=y/j;m*=S;let P=0;for(let V=0;V<g;V++){let K=l[V],se=u[V]*S,ue=K>se?K-se:se-K;if(ue>m)return 1/0;P+=ue}return P/y}}Xs.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Xs.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Xs.MAX_AVG_VARIANCE=.42,Xs.MAX_INDIVIDUAL_VARIANCE=.8,Xs.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Xs.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Xs.MAX_PIXEL_DRIFT=3,Xs.MAX_PATTERN_DRIFT=5,Xs.SKIPPED_ROW_COUNT_MAX=25,Xs.ROW_STEP=5,Xs.BARCODE_MIN_HEIGHT=10;class La{constructor(l,u){if(u.length===0)throw new x;this.field=l;let m=u.length;if(m>1&&u[0]===0){let g=1;for(;g<m&&u[g]===0;)g++;g===m?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(m-g),_.arraycopy(u,g,this.coefficients,0,this.coefficients.length))}else this.coefficients=u}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(l){return this.coefficients[this.coefficients.length-1-l]}evaluateAt(l){if(l===0)return this.getCoefficient(0);if(l===1){let g=0;for(let y of this.coefficients)g=this.field.add(g,y);return g}let u=this.coefficients[0],m=this.coefficients.length;for(let g=1;g<m;g++)u=this.field.add(this.field.multiply(l,u),this.coefficients[g]);return u}add(l){if(!this.field.equals(l.field))throw new x("ModulusPolys do not have same ModulusGF field");if(this.isZero())return l;if(l.isZero())return this;let u=this.coefficients,m=l.coefficients;if(u.length>m.length){let j=u;u=m,m=j}let g=new Int32Array(m.length),y=m.length-u.length;_.arraycopy(m,0,g,0,y);for(let j=y;j<m.length;j++)g[j]=this.field.add(u[j-y],m[j]);return new La(this.field,g)}subtract(l){if(!this.field.equals(l.field))throw new x("ModulusPolys do not have same ModulusGF field");return l.isZero()?this:this.add(l.negative())}multiply(l){return l instanceof La?this.multiplyOther(l):this.multiplyScalar(l)}multiplyOther(l){if(!this.field.equals(l.field))throw new x("ModulusPolys do not have same ModulusGF field");if(this.isZero()||l.isZero())return new La(this.field,new Int32Array([0]));let u=this.coefficients,m=u.length,g=l.coefficients,y=g.length,j=new Int32Array(m+y-1);for(let S=0;S<m;S++){let P=u[S];for(let V=0;V<y;V++)j[S+V]=this.field.add(j[S+V],this.field.multiply(P,g[V]))}return new La(this.field,j)}negative(){let l=this.coefficients.length,u=new Int32Array(l);for(let m=0;m<l;m++)u[m]=this.field.subtract(0,this.coefficients[m]);return new La(this.field,u)}multiplyScalar(l){if(l===0)return new La(this.field,new Int32Array([0]));if(l===1)return this;let u=this.coefficients.length,m=new Int32Array(u);for(let g=0;g<u;g++)m[g]=this.field.multiply(this.coefficients[g],l);return new La(this.field,m)}multiplyByMonomial(l,u){if(l<0)throw new x;if(u===0)return new La(this.field,new Int32Array([0]));let m=this.coefficients.length,g=new Int32Array(m+l);for(let y=0;y<m;y++)g[y]=this.field.multiply(this.coefficients[y],u);return new La(this.field,g)}toString(){let l=new ae;for(let u=this.getDegree();u>=0;u--){let m=this.getCoefficient(u);m!==0&&(m<0?(l.append(" - "),m=-m):l.length()>0&&l.append(" + "),(u===0||m!==1)&&l.append(m),u!==0&&(u===1?l.append("x"):(l.append("x^"),l.append(u))))}return l.toString()}}class tm{add(l,u){return(l+u)%this.modulus}subtract(l,u){return(this.modulus+l-u)%this.modulus}exp(l){return this.expTable[l]}log(l){if(l===0)throw new x;return this.logTable[l]}inverse(l){if(l===0)throw new Me;return this.expTable[this.modulus-this.logTable[l]-1]}multiply(l,u){return l===0||u===0?0:this.expTable[(this.logTable[l]+this.logTable[u])%(this.modulus-1)]}getSize(){return this.modulus}equals(l){return l===this}}class Io extends tm{constructor(l,u){super(),this.modulus=l,this.expTable=new Int32Array(l),this.logTable=new Int32Array(l);let m=1;for(let g=0;g<l;g++)this.expTable[g]=m,m=m*u%l;for(let g=0;g<l-1;g++)this.logTable[this.expTable[g]]=g;this.zero=new La(this,new Int32Array([0])),this.one=new La(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(l,u){if(l<0)throw new x;if(u===0)return this.zero;let m=new Int32Array(l+1);return m[0]=u,new La(this,m)}}Io.PDF417_GF=new Io(Qt.NUMBER_OF_CODEWORDS,3);class Ju{constructor(){this.field=Io.PDF417_GF}decode(l,u,m){let g=new La(this.field,l),y=new Int32Array(u),j=!1;for(let Ve=u;Ve>0;Ve--){let $e=g.evaluateAt(this.field.exp(Ve));y[u-Ve]=$e,$e!==0&&(j=!0)}if(!j)return 0;let S=this.field.getOne();if(m!=null)for(const Ve of m){let $e=this.field.exp(l.length-1-Ve),st=new La(this.field,new Int32Array([this.field.subtract(0,$e),1]));S=S.multiply(st)}let P=new La(this.field,y),V=this.runEuclideanAlgorithm(this.field.buildMonomial(u,1),P,u),K=V[0],se=V[1],ue=this.findErrorLocations(K),Ae=this.findErrorMagnitudes(se,K,ue);for(let Ve=0;Ve<ue.length;Ve++){let $e=l.length-1-this.field.log(ue[Ve]);if($e<0)throw b.getChecksumInstance();l[$e]=this.field.subtract(l[$e],Ae[Ve])}return ue.length}runEuclideanAlgorithm(l,u,m){if(l.getDegree()<u.getDegree()){let ue=l;l=u,u=ue}let g=l,y=u,j=this.field.getZero(),S=this.field.getOne();for(;y.getDegree()>=Math.round(m/2);){let ue=g,Ae=j;if(g=y,j=S,g.isZero())throw b.getChecksumInstance();y=ue;let Ve=this.field.getZero(),$e=g.getCoefficient(g.getDegree()),st=this.field.inverse($e);for(;y.getDegree()>=g.getDegree()&&!y.isZero();){let ht=y.getDegree()-g.getDegree(),Bt=this.field.multiply(y.getCoefficient(y.getDegree()),st);Ve=Ve.add(this.field.buildMonomial(ht,Bt)),y=y.subtract(g.multiplyByMonomial(ht,Bt))}S=Ve.multiply(j).subtract(Ae).negative()}let P=S.getCoefficient(0);if(P===0)throw b.getChecksumInstance();let V=this.field.inverse(P),K=S.multiply(V),se=y.multiply(V);return[K,se]}findErrorLocations(l){let u=l.getDegree(),m=new Int32Array(u),g=0;for(let y=1;y<this.field.getSize()&&g<u;y++)l.evaluateAt(y)===0&&(m[g]=this.field.inverse(y),g++);if(g!==u)throw b.getChecksumInstance();return m}findErrorMagnitudes(l,u,m){let g=u.getDegree(),y=new Int32Array(g);for(let V=1;V<=g;V++)y[g-V]=this.field.multiply(V,u.getCoefficient(V));let j=new La(this.field,y),S=m.length,P=new Int32Array(S);for(let V=0;V<S;V++){let K=this.field.inverse(m[V]),se=this.field.subtract(0,l.evaluateAt(K)),ue=this.field.inverse(j.evaluateAt(K));P[V]=this.field.multiply(se,ue)}return P}}class Li{constructor(l,u,m,g,y){l instanceof Li?this.constructor_2(l):this.constructor_1(l,u,m,g,y)}constructor_1(l,u,m,g,y){const j=u==null||m==null,S=g==null||y==null;if(j&&S)throw new H;j?(u=new Ge(0,g.getY()),m=new Ge(0,y.getY())):S&&(g=new Ge(l.getWidth()-1,u.getY()),y=new Ge(l.getWidth()-1,m.getY())),this.image=l,this.topLeft=u,this.bottomLeft=m,this.topRight=g,this.bottomRight=y,this.minX=Math.trunc(Math.min(u.getX(),m.getX())),this.maxX=Math.trunc(Math.max(g.getX(),y.getX())),this.minY=Math.trunc(Math.min(u.getY(),g.getY())),this.maxY=Math.trunc(Math.max(m.getY(),y.getY()))}constructor_2(l){this.image=l.image,this.topLeft=l.getTopLeft(),this.bottomLeft=l.getBottomLeft(),this.topRight=l.getTopRight(),this.bottomRight=l.getBottomRight(),this.minX=l.getMinX(),this.maxX=l.getMaxX(),this.minY=l.getMinY(),this.maxY=l.getMaxY()}static merge(l,u){return l==null?u:u==null?l:new Li(l.image,l.topLeft,l.bottomLeft,u.topRight,u.bottomRight)}addMissingRows(l,u,m){let g=this.topLeft,y=this.bottomLeft,j=this.topRight,S=this.bottomRight;if(l>0){let P=m?this.topLeft:this.topRight,V=Math.trunc(P.getY()-l);V<0&&(V=0);let K=new Ge(P.getX(),V);m?g=K:j=K}if(u>0){let P=m?this.bottomLeft:this.bottomRight,V=Math.trunc(P.getY()+u);V>=this.image.getHeight()&&(V=this.image.getHeight()-1);let K=new Ge(P.getX(),V);m?y=K:S=K}return new Li(this.image,g,y,j,S)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class tn{constructor(l,u,m,g){this.columnCount=l,this.errorCorrectionLevel=g,this.rowCountUpperPart=u,this.rowCountLowerPart=m,this.rowCount=u+m}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class Fi{constructor(){this.buffer=""}static form(l,u){let m=-1;function g(j,S,P,V,K,se){if(j==="%%")return"%";if(u[++m]===void 0)return;j=V?parseInt(V.substr(1)):void 0;let ue=K?parseInt(K.substr(1)):void 0,Ae;switch(se){case"s":Ae=u[m];break;case"c":Ae=u[m][0];break;case"f":Ae=parseFloat(u[m]).toFixed(j);break;case"p":Ae=parseFloat(u[m]).toPrecision(j);break;case"e":Ae=parseFloat(u[m]).toExponential(j);break;case"x":Ae=parseInt(u[m]).toString(ue||16);break;case"d":Ae=parseFloat(parseInt(u[m],ue||10).toPrecision(j)).toFixed(0);break}Ae=typeof Ae=="object"?JSON.stringify(Ae):(+Ae).toString(ue);let Ve=parseInt(P),$e=P&&P[0]+""=="0"?"0":" ";for(;Ae.length<Ve;)Ae=S!==void 0?Ae+$e:$e+Ae;return Ae}let y=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return l.replace(y,g)}format(l,...u){this.buffer+=Fi.form(l,u)}toString(){return this.buffer}}class Ac{constructor(l){this.boundingBox=new Li(l),this.codewords=new Array(l.getMaxY()-l.getMinY()+1)}getCodewordNearby(l){let u=this.getCodeword(l);if(u!=null)return u;for(let m=1;m<Ac.MAX_NEARBY_DISTANCE;m++){let g=this.imageRowToCodewordIndex(l)-m;if(g>=0&&(u=this.codewords[g],u!=null)||(g=this.imageRowToCodewordIndex(l)+m,g<this.codewords.length&&(u=this.codewords[g],u!=null)))return u}return null}imageRowToCodewordIndex(l){return l-this.boundingBox.getMinY()}setCodeword(l,u){this.codewords[this.imageRowToCodewordIndex(l)]=u}getCodeword(l){return this.codewords[this.imageRowToCodewordIndex(l)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const l=new Fi;let u=0;for(const m of this.codewords){if(m==null){l.format("%3d:    |   %n",u++);continue}l.format("%3d: %3d|%3d%n",u++,m.getRowNumber(),m.getValue())}return l.toString()}}Ac.MAX_NEARBY_DISTANCE=5;class kc{constructor(){this.values=new Map}setValue(l){l=Math.trunc(l);let u=this.values.get(l);u==null&&(u=0),u++,this.values.set(l,u)}getValue(){let l=-1,u=new Array;for(const[m,g]of this.values.entries()){const y={getKey:()=>m,getValue:()=>g};y.getValue()>l?(l=y.getValue(),u=[],u.push(y.getKey())):y.getValue()===l&&u.push(y.getKey())}return Qt.toIntArray(u)}getConfidence(l){return this.values.get(l)}}class w0 extends Ac{constructor(l,u){super(l),this._isLeft=u}setRowNumbers(){for(let l of this.getCodewords())l!=null&&l.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(l){let u=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(u,l);let m=this.getBoundingBox(),g=this._isLeft?m.getTopLeft():m.getTopRight(),y=this._isLeft?m.getBottomLeft():m.getBottomRight(),j=this.imageRowToCodewordIndex(Math.trunc(g.getY())),S=this.imageRowToCodewordIndex(Math.trunc(y.getY())),P=-1,V=1,K=0;for(let se=j;se<S;se++){if(u[se]==null)continue;let ue=u[se],Ae=ue.getRowNumber()-P;if(Ae===0)K++;else if(Ae===1)V=Math.max(V,K),K=1,P=ue.getRowNumber();else if(Ae<0||ue.getRowNumber()>=l.getRowCount()||Ae>se)u[se]=null;else{let Ve;V>2?Ve=(V-2)*Ae:Ve=Ae;let $e=Ve>=se;for(let st=1;st<=Ve&&!$e;st++)$e=u[se-st]!=null;$e?u[se]=null:(P=ue.getRowNumber(),K=1)}}}getRowHeights(){let l=this.getBarcodeMetadata();if(l==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(l);let u=new Int32Array(l.getRowCount());for(let m of this.getCodewords())if(m!=null){let g=m.getRowNumber();if(g>=u.length)continue;u[g]++}return u}adjustIncompleteIndicatorColumnRowNumbers(l){let u=this.getBoundingBox(),m=this._isLeft?u.getTopLeft():u.getTopRight(),g=this._isLeft?u.getBottomLeft():u.getBottomRight(),y=this.imageRowToCodewordIndex(Math.trunc(m.getY())),j=this.imageRowToCodewordIndex(Math.trunc(g.getY())),S=this.getCodewords(),P=-1;for(let V=y;V<j;V++){if(S[V]==null)continue;let K=S[V];K.setRowNumberAsRowIndicatorColumn();let se=K.getRowNumber()-P;se===0||(se===1?P=K.getRowNumber():K.getRowNumber()>=l.getRowCount()?S[V]=null:P=K.getRowNumber())}}getBarcodeMetadata(){let l=this.getCodewords(),u=new kc,m=new kc,g=new kc,y=new kc;for(let S of l){if(S==null)continue;S.setRowNumberAsRowIndicatorColumn();let P=S.getValue()%30,V=S.getRowNumber();switch(this._isLeft||(V+=2),V%3){case 0:m.setValue(P*3+1);break;case 1:y.setValue(P/3),g.setValue(P%3);break;case 2:u.setValue(P+1);break}}if(u.getValue().length===0||m.getValue().length===0||g.getValue().length===0||y.getValue().length===0||u.getValue()[0]<1||m.getValue()[0]+g.getValue()[0]<Qt.MIN_ROWS_IN_BARCODE||m.getValue()[0]+g.getValue()[0]>Qt.MAX_ROWS_IN_BARCODE)return null;let j=new tn(u.getValue()[0],m.getValue()[0],g.getValue()[0],y.getValue()[0]);return this.removeIncorrectCodewords(l,j),j}removeIncorrectCodewords(l,u){for(let m=0;m<l.length;m++){let g=l[m];if(l[m]==null)continue;let y=g.getValue()%30,j=g.getRowNumber();if(j>u.getRowCount()){l[m]=null;continue}switch(this._isLeft||(j+=2),j%3){case 0:y*3+1!==u.getRowCountUpperPart()&&(l[m]=null);break;case 1:(Math.trunc(y/3)!==u.getErrorCorrectionLevel()||y%3!==u.getRowCountLowerPart())&&(l[m]=null);break;case 2:y+1!==u.getColumnCount()&&(l[m]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class Rc{constructor(l,u){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=l,this.barcodeColumnCount=l.getColumnCount(),this.boundingBox=u,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let l=Qt.MAX_CODEWORDS_IN_BARCODE,u;do u=l,l=this.adjustRowNumbersAndGetCount();while(l>0&&l<u);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(l){l!=null&&l.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let l=this.adjustRowNumbersByRow();if(l===0)return 0;for(let u=1;u<this.barcodeColumnCount+1;u++){let m=this.detectionResultColumns[u].getCodewords();for(let g=0;g<m.length;g++)m[g]!=null&&(m[g].hasValidRowNumber()||this.adjustRowNumbers(u,g,m))}return l}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let l=this.detectionResultColumns[0].getCodewords(),u=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let m=0;m<l.length;m++)if(l[m]!=null&&u[m]!=null&&l[m].getRowNumber()===u[m].getRowNumber())for(let g=1;g<=this.barcodeColumnCount;g++){let y=this.detectionResultColumns[g].getCodewords()[m];y!=null&&(y.setRowNumber(l[m].getRowNumber()),y.hasValidRowNumber()||(this.detectionResultColumns[g].getCodewords()[m]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let l=0,u=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let m=0;m<u.length;m++){if(u[m]==null)continue;let g=u[m].getRowNumber(),y=0;for(let j=this.barcodeColumnCount+1;j>0&&y<this.ADJUST_ROW_NUMBER_SKIP;j--){let S=this.detectionResultColumns[j].getCodewords()[m];S!=null&&(y=Rc.adjustRowNumberIfValid(g,y,S),S.hasValidRowNumber()||l++)}}return l}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let l=0,u=this.detectionResultColumns[0].getCodewords();for(let m=0;m<u.length;m++){if(u[m]==null)continue;let g=u[m].getRowNumber(),y=0;for(let j=1;j<this.barcodeColumnCount+1&&y<this.ADJUST_ROW_NUMBER_SKIP;j++){let S=this.detectionResultColumns[j].getCodewords()[m];S!=null&&(y=Rc.adjustRowNumberIfValid(g,y,S),S.hasValidRowNumber()||l++)}}return l}static adjustRowNumberIfValid(l,u,m){return m==null||m.hasValidRowNumber()||(m.isValidRowNumber(l)?(m.setRowNumber(l),u=0):++u),u}adjustRowNumbers(l,u,m){if(!this.detectionResultColumns[l-1])return;let g=m[u],y=this.detectionResultColumns[l-1].getCodewords(),j=y;this.detectionResultColumns[l+1]!=null&&(j=this.detectionResultColumns[l+1].getCodewords());let S=new Array(14);S[2]=y[u],S[3]=j[u],u>0&&(S[0]=m[u-1],S[4]=y[u-1],S[5]=j[u-1]),u>1&&(S[8]=m[u-2],S[10]=y[u-2],S[11]=j[u-2]),u<m.length-1&&(S[1]=m[u+1],S[6]=y[u+1],S[7]=j[u+1]),u<m.length-2&&(S[9]=m[u+2],S[12]=y[u+2],S[13]=j[u+2]);for(let P of S)if(Rc.adjustRowNumber(g,P))return}static adjustRowNumber(l,u){return u==null?!1:u.hasValidRowNumber()&&u.getBucket()===l.getBucket()?(l.setRowNumber(u.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(l){this.boundingBox=l}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(l,u){this.detectionResultColumns[l]=u}getDetectionResultColumn(l){return this.detectionResultColumns[l]}toString(){let l=this.detectionResultColumns[0];l==null&&(l=this.detectionResultColumns[this.barcodeColumnCount+1]);let u=new Fi;for(let m=0;m<l.getCodewords().length;m++){u.format("CW %3d:",m);for(let g=0;g<this.barcodeColumnCount+2;g++){if(this.detectionResultColumns[g]==null){u.format("    |   ");continue}let y=this.detectionResultColumns[g].getCodewords()[m];if(y==null){u.format("    |   ");continue}u.format(" %3d|%3d",y.getRowNumber(),y.getValue())}u.format("%n")}return u.toString()}}class Kl{constructor(l,u,m,g){this.rowNumber=Kl.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(l),this.endX=Math.trunc(u),this.bucket=Math.trunc(m),this.value=Math.trunc(g)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(l){return l!==Kl.BARCODE_ROW_UNKNOWN&&this.bucket===l%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(l){this.rowNumber=l}toString(){return this.rowNumber+"|"+this.value}}Kl.BARCODE_ROW_UNKNOWN=-1;class Fn{static initialize(){for(let l=0;l<Qt.SYMBOL_TABLE.length;l++){let u=Qt.SYMBOL_TABLE[l],m=u&1;for(let g=0;g<Qt.BARS_IN_MODULE;g++){let y=0;for(;(u&1)===m;)y+=1,u>>=1;m=u&1,Fn.RATIOS_TABLE[l]||(Fn.RATIOS_TABLE[l]=new Array(Qt.BARS_IN_MODULE)),Fn.RATIOS_TABLE[l][Qt.BARS_IN_MODULE-g-1]=Math.fround(y/Qt.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(l){let u=Fn.getDecodedCodewordValue(Fn.sampleBitCounts(l));return u!==-1?u:Fn.getClosestDecodedValue(l)}static sampleBitCounts(l){let u=Le.sum(l),m=new Int32Array(Qt.BARS_IN_MODULE),g=0,y=0;for(let j=0;j<Qt.MODULES_IN_CODEWORD;j++){let S=u/(2*Qt.MODULES_IN_CODEWORD)+j*u/Qt.MODULES_IN_CODEWORD;y+l[g]<=S&&(y+=l[g],g++),m[g]++}return m}static getDecodedCodewordValue(l){let u=Fn.getBitValue(l);return Qt.getCodeword(u)===-1?-1:u}static getBitValue(l){let u=0;for(let m=0;m<l.length;m++)for(let g=0;g<l[m];g++)u=u<<1|(m%2===0?1:0);return Math.trunc(u)}static getClosestDecodedValue(l){let u=Le.sum(l),m=new Array(Qt.BARS_IN_MODULE);if(u>1)for(let j=0;j<m.length;j++)m[j]=Math.fround(l[j]/u);let g=Nt.MAX_VALUE,y=-1;this.bSymbolTableReady||Fn.initialize();for(let j=0;j<Fn.RATIOS_TABLE.length;j++){let S=0,P=Fn.RATIOS_TABLE[j];for(let V=0;V<Qt.BARS_IN_MODULE;V++){let K=Math.fround(P[V]-m[V]);if(S+=Math.fround(K*K),S>=g)break}S<g&&(g=S,y=Qt.SYMBOL_TABLE[j])}return y}}Fn.bSymbolTableReady=!1,Fn.RATIOS_TABLE=new Array(Qt.SYMBOL_TABLE.length).map(te=>new Array(Qt.BARS_IN_MODULE));class sm{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(l){this.segmentIndex=l}getFileId(){return this.fileId}setFileId(l){this.fileId=l}getOptionalData(){return this.optionalData}setOptionalData(l){this.optionalData=l}isLastSegment(){return this.lastSegment}setLastSegment(l){this.lastSegment=l}getSegmentCount(){return this.segmentCount}setSegmentCount(l){this.segmentCount=l}getSender(){return this.sender||null}setSender(l){this.sender=l}getAddressee(){return this.addressee||null}setAddressee(l){this.addressee=l}getFileName(){return this.fileName}setFileName(l){this.fileName=l}getFileSize(){return this.fileSize}setFileSize(l){this.fileSize=l}getChecksum(){return this.checksum}setChecksum(l){this.checksum=l}getTimestamp(){return this.timestamp}setTimestamp(l){this.timestamp=l}}class wr{static parseLong(l,u=void 0){return parseInt(l,u)}}class b0 extends h{}b0.kind="NullPointerException";class Bi{writeBytes(l){this.writeBytesOffset(l,0,l.length)}writeBytesOffset(l,u,m){if(l==null)throw new b0;if(u<0||u>l.length||m<0||u+m>l.length||u+m<0)throw new C;if(m===0)return;for(let g=0;g<m;g++)this.write(l[u+g])}flush(){}close(){}}class Gd extends h{}class _0 extends Bi{constructor(l=32){if(super(),this.count=0,l<0)throw new x("Negative initial size: "+l);this.buf=new Uint8Array(l)}ensureCapacity(l){l-this.buf.length>0&&this.grow(l)}grow(l){let m=this.buf.length<<1;if(m-l<0&&(m=l),m<0){if(l<0)throw new Gd;m=k.MAX_VALUE}this.buf=A.copyOfUint8Array(this.buf,m)}write(l){this.ensureCapacity(this.count+1),this.buf[this.count]=l,this.count+=1}writeBytesOffset(l,u,m){if(u<0||u>l.length||m<0||u+m-l.length>0)throw new C;this.ensureCapacity(this.count+m),_.arraycopy(l,u,this.buf,this.count,m),this.count+=m}writeTo(l){l.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return A.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(l){return l?typeof l=="string"?this.toString_string(l):this.toString_number(l):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(l){return new String(this.buf).toString()}toString_number(l){return new String(this.buf).toString()}close(){}}var Lr;(function(te){te[te.ALPHA=0]="ALPHA",te[te.LOWER=1]="LOWER",te[te.MIXED=2]="MIXED",te[te.PUNCT=3]="PUNCT",te[te.ALPHA_SHIFT=4]="ALPHA_SHIFT",te[te.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Lr||(Lr={}));function eh(){if(typeof window<"u")return window.BigInt||null;if(typeof rd<"u")return rd.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let th;function Oo(te){if(typeof th>"u"&&(th=eh()),th===null)throw new Error("BigInt is not supported!");return th(te)}function f1(){let te=[];te[0]=Oo(1);let l=Oo(900);te[1]=l;for(let u=2;u<16;u++)te[u]=te[u-1]*l;return te}class ft{static decode(l,u){let m=new ae(""),g=M.ISO8859_1;m.enableDecoding(g);let y=1,j=l[y++],S=new sm;for(;y<l[0];){switch(j){case ft.TEXT_COMPACTION_MODE_LATCH:y=ft.textCompaction(l,y,m);break;case ft.BYTE_COMPACTION_MODE_LATCH:case ft.BYTE_COMPACTION_MODE_LATCH_6:y=ft.byteCompaction(j,l,g,y,m);break;case ft.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:m.append(l[y++]);break;case ft.NUMERIC_COMPACTION_MODE_LATCH:y=ft.numericCompaction(l,y,m);break;case ft.ECI_CHARSET:M.getCharacterSetECIByValue(l[y++]);break;case ft.ECI_GENERAL_PURPOSE:y+=2;break;case ft.ECI_USER_DEFINED:y++;break;case ft.BEGIN_MACRO_PDF417_CONTROL_BLOCK:y=ft.decodeMacroBlock(l,y,S);break;case ft.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ft.MACRO_PDF417_TERMINATOR:throw new D;default:y--,y=ft.textCompaction(l,y,m);break}if(y<l.length)j=l[y++];else throw D.getFormatInstance()}if(m.length()===0)throw D.getFormatInstance();let P=new fe(null,m.toString(),null,u);return P.setOther(S),P}static decodeMacroBlock(l,u,m){if(u+ft.NUMBER_OF_SEQUENCE_CODEWORDS>l[0])throw D.getFormatInstance();let g=new Int32Array(ft.NUMBER_OF_SEQUENCE_CODEWORDS);for(let S=0;S<ft.NUMBER_OF_SEQUENCE_CODEWORDS;S++,u++)g[S]=l[u];m.setSegmentIndex(k.parseInt(ft.decodeBase900toBase10(g,ft.NUMBER_OF_SEQUENCE_CODEWORDS)));let y=new ae;u=ft.textCompaction(l,u,y),m.setFileId(y.toString());let j=-1;for(l[u]===ft.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(j=u+1);u<l[0];)switch(l[u]){case ft.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(u++,l[u]){case ft.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let S=new ae;u=ft.textCompaction(l,u+1,S),m.setFileName(S.toString());break;case ft.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let P=new ae;u=ft.textCompaction(l,u+1,P),m.setSender(P.toString());break;case ft.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let V=new ae;u=ft.textCompaction(l,u+1,V),m.setAddressee(V.toString());break;case ft.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let K=new ae;u=ft.numericCompaction(l,u+1,K),m.setSegmentCount(k.parseInt(K.toString()));break;case ft.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let se=new ae;u=ft.numericCompaction(l,u+1,se),m.setTimestamp(wr.parseLong(se.toString()));break;case ft.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let ue=new ae;u=ft.numericCompaction(l,u+1,ue),m.setChecksum(k.parseInt(ue.toString()));break;case ft.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let Ae=new ae;u=ft.numericCompaction(l,u+1,Ae),m.setFileSize(wr.parseLong(Ae.toString()));break;default:throw D.getFormatInstance()}break;case ft.MACRO_PDF417_TERMINATOR:u++,m.setLastSegment(!0);break;default:throw D.getFormatInstance()}if(j!==-1){let S=u-j;m.isLastSegment()&&S--,m.setOptionalData(A.copyOfRange(l,j,j+S))}return u}static textCompaction(l,u,m){let g=new Int32Array((l[0]-u)*2),y=new Int32Array((l[0]-u)*2),j=0,S=!1;for(;u<l[0]&&!S;){let P=l[u++];if(P<ft.TEXT_COMPACTION_MODE_LATCH)g[j]=P/30,g[j+1]=P%30,j+=2;else switch(P){case ft.TEXT_COMPACTION_MODE_LATCH:g[j++]=ft.TEXT_COMPACTION_MODE_LATCH;break;case ft.BYTE_COMPACTION_MODE_LATCH:case ft.BYTE_COMPACTION_MODE_LATCH_6:case ft.NUMERIC_COMPACTION_MODE_LATCH:case ft.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ft.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ft.MACRO_PDF417_TERMINATOR:u--,S=!0;break;case ft.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:g[j]=ft.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,P=l[u++],y[j]=P,j++;break}}return ft.decodeTextCompaction(g,y,j,m),u}static decodeTextCompaction(l,u,m,g){let y=Lr.ALPHA,j=Lr.ALPHA,S=0;for(;S<m;){let P=l[S],V="";switch(y){case Lr.ALPHA:if(P<26)V=String.fromCharCode(65+P);else switch(P){case 26:V=" ";break;case ft.LL:y=Lr.LOWER;break;case ft.ML:y=Lr.MIXED;break;case ft.PS:j=y,y=Lr.PUNCT_SHIFT;break;case ft.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:g.append(u[S]);break;case ft.TEXT_COMPACTION_MODE_LATCH:y=Lr.ALPHA;break}break;case Lr.LOWER:if(P<26)V=String.fromCharCode(97+P);else switch(P){case 26:V=" ";break;case ft.AS:j=y,y=Lr.ALPHA_SHIFT;break;case ft.ML:y=Lr.MIXED;break;case ft.PS:j=y,y=Lr.PUNCT_SHIFT;break;case ft.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:g.append(u[S]);break;case ft.TEXT_COMPACTION_MODE_LATCH:y=Lr.ALPHA;break}break;case Lr.MIXED:if(P<ft.PL)V=ft.MIXED_CHARS[P];else switch(P){case ft.PL:y=Lr.PUNCT;break;case 26:V=" ";break;case ft.LL:y=Lr.LOWER;break;case ft.AL:y=Lr.ALPHA;break;case ft.PS:j=y,y=Lr.PUNCT_SHIFT;break;case ft.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:g.append(u[S]);break;case ft.TEXT_COMPACTION_MODE_LATCH:y=Lr.ALPHA;break}break;case Lr.PUNCT:if(P<ft.PAL)V=ft.PUNCT_CHARS[P];else switch(P){case ft.PAL:y=Lr.ALPHA;break;case ft.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:g.append(u[S]);break;case ft.TEXT_COMPACTION_MODE_LATCH:y=Lr.ALPHA;break}break;case Lr.ALPHA_SHIFT:if(y=j,P<26)V=String.fromCharCode(65+P);else switch(P){case 26:V=" ";break;case ft.TEXT_COMPACTION_MODE_LATCH:y=Lr.ALPHA;break}break;case Lr.PUNCT_SHIFT:if(y=j,P<ft.PAL)V=ft.PUNCT_CHARS[P];else switch(P){case ft.PAL:y=Lr.ALPHA;break;case ft.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:g.append(u[S]);break;case ft.TEXT_COMPACTION_MODE_LATCH:y=Lr.ALPHA;break}break}V!==""&&g.append(V),S++}}static byteCompaction(l,u,m,g,y){let j=new _0,S=0,P=0,V=!1;switch(l){case ft.BYTE_COMPACTION_MODE_LATCH:let K=new Int32Array(6),se=u[g++];for(;g<u[0]&&!V;)switch(K[S++]=se,P=900*P+se,se=u[g++],se){case ft.TEXT_COMPACTION_MODE_LATCH:case ft.BYTE_COMPACTION_MODE_LATCH:case ft.NUMERIC_COMPACTION_MODE_LATCH:case ft.BYTE_COMPACTION_MODE_LATCH_6:case ft.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ft.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ft.MACRO_PDF417_TERMINATOR:g--,V=!0;break;default:if(S%5===0&&S>0){for(let ue=0;ue<6;++ue)j.write(Number(Oo(P)>>Oo(8*(5-ue))));P=0,S=0}break}g===u[0]&&se<ft.TEXT_COMPACTION_MODE_LATCH&&(K[S++]=se);for(let ue=0;ue<S;ue++)j.write(K[ue]);break;case ft.BYTE_COMPACTION_MODE_LATCH_6:for(;g<u[0]&&!V;){let ue=u[g++];if(ue<ft.TEXT_COMPACTION_MODE_LATCH)S++,P=900*P+ue;else switch(ue){case ft.TEXT_COMPACTION_MODE_LATCH:case ft.BYTE_COMPACTION_MODE_LATCH:case ft.NUMERIC_COMPACTION_MODE_LATCH:case ft.BYTE_COMPACTION_MODE_LATCH_6:case ft.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ft.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ft.MACRO_PDF417_TERMINATOR:g--,V=!0;break}if(S%5===0&&S>0){for(let Ae=0;Ae<6;++Ae)j.write(Number(Oo(P)>>Oo(8*(5-Ae))));P=0,S=0}}break}return y.append(q.decode(j.toByteArray(),m)),g}static numericCompaction(l,u,m){let g=0,y=!1,j=new Int32Array(ft.MAX_NUMERIC_CODEWORDS);for(;u<l[0]&&!y;){let S=l[u++];if(u===l[0]&&(y=!0),S<ft.TEXT_COMPACTION_MODE_LATCH)j[g]=S,g++;else switch(S){case ft.TEXT_COMPACTION_MODE_LATCH:case ft.BYTE_COMPACTION_MODE_LATCH:case ft.BYTE_COMPACTION_MODE_LATCH_6:case ft.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ft.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ft.MACRO_PDF417_TERMINATOR:u--,y=!0;break}(g%ft.MAX_NUMERIC_CODEWORDS===0||S===ft.NUMERIC_COMPACTION_MODE_LATCH||y)&&g>0&&(m.append(ft.decodeBase900toBase10(j,g)),g=0)}return u}static decodeBase900toBase10(l,u){let m=Oo(0);for(let y=0;y<u;y++)m+=ft.EXP900[u-y-1]*Oo(l[y]);let g=m.toString();if(g.charAt(0)!=="1")throw new D;return g.substring(1)}}ft.TEXT_COMPACTION_MODE_LATCH=900,ft.BYTE_COMPACTION_MODE_LATCH=901,ft.NUMERIC_COMPACTION_MODE_LATCH=902,ft.BYTE_COMPACTION_MODE_LATCH_6=924,ft.ECI_USER_DEFINED=925,ft.ECI_GENERAL_PURPOSE=926,ft.ECI_CHARSET=927,ft.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,ft.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,ft.MACRO_PDF417_TERMINATOR=922,ft.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,ft.MAX_NUMERIC_CODEWORDS=15,ft.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,ft.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,ft.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,ft.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,ft.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,ft.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,ft.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,ft.PL=25,ft.LL=27,ft.AS=27,ft.ML=28,ft.AL=28,ft.PS=29,ft.PAL=29,ft.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,ft.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",ft.EXP900=eh()?f1():[],ft.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Js{constructor(){}static decode(l,u,m,g,y,j,S){let P=new Li(l,u,m,g,y),V=null,K=null,se;for(let Ve=!0;;Ve=!1){if(u!=null&&(V=Js.getRowIndicatorColumn(l,P,u,!0,j,S)),g!=null&&(K=Js.getRowIndicatorColumn(l,P,g,!1,j,S)),se=Js.merge(V,K),se==null)throw H.getNotFoundInstance();let $e=se.getBoundingBox();if(Ve&&$e!=null&&($e.getMinY()<P.getMinY()||$e.getMaxY()>P.getMaxY()))P=$e;else break}se.setBoundingBox(P);let ue=se.getBarcodeColumnCount()+1;se.setDetectionResultColumn(0,V),se.setDetectionResultColumn(ue,K);let Ae=V!=null;for(let Ve=1;Ve<=ue;Ve++){let $e=Ae?Ve:ue-Ve;if(se.getDetectionResultColumn($e)!==void 0)continue;let st;$e===0||$e===ue?st=new w0(P,$e===0):st=new Ac(P),se.setDetectionResultColumn($e,st);let ht=-1,Bt=ht;for(let Vt=P.getMinY();Vt<=P.getMaxY();Vt++){if(ht=Js.getStartColumn(se,$e,Vt,Ae),ht<0||ht>P.getMaxX()){if(Bt===-1)continue;ht=Bt}let Pt=Js.detectCodeword(l,P.getMinX(),P.getMaxX(),Ae,ht,Vt,j,S);Pt!=null&&(st.setCodeword(Vt,Pt),Bt=ht,j=Math.min(j,Pt.getWidth()),S=Math.max(S,Pt.getWidth()))}}return Js.createDecoderResult(se)}static merge(l,u){if(l==null&&u==null)return null;let m=Js.getBarcodeMetadata(l,u);if(m==null)return null;let g=Li.merge(Js.adjustBoundingBox(l),Js.adjustBoundingBox(u));return new Rc(m,g)}static adjustBoundingBox(l){if(l==null)return null;let u=l.getRowHeights();if(u==null)return null;let m=Js.getMax(u),g=0;for(let S of u)if(g+=m-S,S>0)break;let y=l.getCodewords();for(let S=0;g>0&&y[S]==null;S++)g--;let j=0;for(let S=u.length-1;S>=0&&(j+=m-u[S],!(u[S]>0));S--);for(let S=y.length-1;j>0&&y[S]==null;S--)j--;return l.getBoundingBox().addMissingRows(g,j,l.isLeft())}static getMax(l){let u=-1;for(let m of l)u=Math.max(u,m);return u}static getBarcodeMetadata(l,u){let m;if(l==null||(m=l.getBarcodeMetadata())==null)return u==null?null:u.getBarcodeMetadata();let g;return u==null||(g=u.getBarcodeMetadata())==null?m:m.getColumnCount()!==g.getColumnCount()&&m.getErrorCorrectionLevel()!==g.getErrorCorrectionLevel()&&m.getRowCount()!==g.getRowCount()?null:m}static getRowIndicatorColumn(l,u,m,g,y,j){let S=new w0(u,g);for(let P=0;P<2;P++){let V=P===0?1:-1,K=Math.trunc(Math.trunc(m.getX()));for(let se=Math.trunc(Math.trunc(m.getY()));se<=u.getMaxY()&&se>=u.getMinY();se+=V){let ue=Js.detectCodeword(l,0,l.getWidth(),g,K,se,y,j);ue!=null&&(S.setCodeword(se,ue),g?K=ue.getStartX():K=ue.getEndX())}}return S}static adjustCodewordCount(l,u){let m=u[0][1],g=m.getValue(),y=l.getBarcodeColumnCount()*l.getBarcodeRowCount()-Js.getNumberOfECCodeWords(l.getBarcodeECLevel());if(g.length===0){if(y<1||y>Qt.MAX_CODEWORDS_IN_BARCODE)throw H.getNotFoundInstance();m.setValue(y)}else g[0]!==y&&m.setValue(y)}static createDecoderResult(l){let u=Js.createBarcodeMatrix(l);Js.adjustCodewordCount(l,u);let m=new Array,g=new Int32Array(l.getBarcodeRowCount()*l.getBarcodeColumnCount()),y=[],j=new Array;for(let P=0;P<l.getBarcodeRowCount();P++)for(let V=0;V<l.getBarcodeColumnCount();V++){let K=u[P][V+1].getValue(),se=P*l.getBarcodeColumnCount()+V;K.length===0?m.push(se):K.length===1?g[se]=K[0]:(j.push(se),y.push(K))}let S=new Array(y.length);for(let P=0;P<S.length;P++)S[P]=y[P];return Js.createDecoderResultFromAmbiguousValues(l.getBarcodeECLevel(),g,Qt.toIntArray(m),Qt.toIntArray(j),S)}static createDecoderResultFromAmbiguousValues(l,u,m,g,y){let j=new Int32Array(g.length),S=100;for(;S-- >0;){for(let P=0;P<j.length;P++)u[g[P]]=y[P][j[P]];try{return Js.decodeCodewords(u,l,m)}catch(P){if(!(P instanceof b))throw P}if(j.length===0)throw b.getChecksumInstance();for(let P=0;P<j.length;P++)if(j[P]<y[P].length-1){j[P]++;break}else if(j[P]=0,P===j.length-1)throw b.getChecksumInstance()}throw b.getChecksumInstance()}static createBarcodeMatrix(l){let u=Array.from({length:l.getBarcodeRowCount()},()=>new Array(l.getBarcodeColumnCount()+2));for(let g=0;g<u.length;g++)for(let y=0;y<u[g].length;y++)u[g][y]=new kc;let m=0;for(let g of l.getDetectionResultColumns()){if(g!=null){for(let y of g.getCodewords())if(y!=null){let j=y.getRowNumber();if(j>=0){if(j>=u.length)continue;u[j][m].setValue(y.getValue())}}}m++}return u}static isValidBarcodeColumn(l,u){return u>=0&&u<=l.getBarcodeColumnCount()+1}static getStartColumn(l,u,m,g){let y=g?1:-1,j=null;if(Js.isValidBarcodeColumn(l,u-y)&&(j=l.getDetectionResultColumn(u-y).getCodeword(m)),j!=null)return g?j.getEndX():j.getStartX();if(j=l.getDetectionResultColumn(u).getCodewordNearby(m),j!=null)return g?j.getStartX():j.getEndX();if(Js.isValidBarcodeColumn(l,u-y)&&(j=l.getDetectionResultColumn(u-y).getCodewordNearby(m)),j!=null)return g?j.getEndX():j.getStartX();let S=0;for(;Js.isValidBarcodeColumn(l,u-y);){u-=y;for(let P of l.getDetectionResultColumn(u).getCodewords())if(P!=null)return(g?P.getEndX():P.getStartX())+y*S*(P.getEndX()-P.getStartX());S++}return g?l.getBoundingBox().getMinX():l.getBoundingBox().getMaxX()}static detectCodeword(l,u,m,g,y,j,S,P){y=Js.adjustCodewordStartColumn(l,u,m,g,y,j);let V=Js.getModuleBitCount(l,u,m,g,y,j);if(V==null)return null;let K,se=Le.sum(V);if(g)K=y+se;else{for(let Ve=0;Ve<V.length/2;Ve++){let $e=V[Ve];V[Ve]=V[V.length-1-Ve],V[V.length-1-Ve]=$e}K=y,y=K-se}if(!Js.checkCodewordSkew(se,S,P))return null;let ue=Fn.getDecodedValue(V),Ae=Qt.getCodeword(ue);return Ae===-1?null:new Kl(y,K,Js.getCodewordBucketNumber(ue),Ae)}static getModuleBitCount(l,u,m,g,y,j){let S=y,P=new Int32Array(8),V=0,K=g?1:-1,se=g;for(;(g?S<m:S>=u)&&V<P.length;)l.get(S,j)===se?(P[V]++,S+=K):(V++,se=!se);return V===P.length||S===(g?m:u)&&V===P.length-1?P:null}static getNumberOfECCodeWords(l){return 2<<l}static adjustCodewordStartColumn(l,u,m,g,y,j){let S=y,P=g?-1:1;for(let V=0;V<2;V++){for(;(g?S>=u:S<m)&&g===l.get(S,j);){if(Math.abs(y-S)>Js.CODEWORD_SKEW_SIZE)return y;S+=P}P=-P,g=!g}return S}static checkCodewordSkew(l,u,m){return u-Js.CODEWORD_SKEW_SIZE<=l&&l<=m+Js.CODEWORD_SKEW_SIZE}static decodeCodewords(l,u,m){if(l.length===0)throw D.getFormatInstance();let g=1<<u+1,y=Js.correctErrors(l,m,g);Js.verifyCodewordCount(l,g);let j=ft.decode(l,""+u);return j.setErrorsCorrected(y),j.setErasures(m.length),j}static correctErrors(l,u,m){if(u!=null&&u.length>m/2+Js.MAX_ERRORS||m<0||m>Js.MAX_EC_CODEWORDS)throw b.getChecksumInstance();return Js.errorCorrection.decode(l,m,u)}static verifyCodewordCount(l,u){if(l.length<4)throw D.getFormatInstance();let m=l[0];if(m>l.length)throw D.getFormatInstance();if(m===0)if(u<l.length)l[0]=l.length-u;else throw D.getFormatInstance()}static getBitCountForCodeword(l){let u=new Int32Array(8),m=0,g=u.length-1;for(;!((l&1)!==m&&(m=l&1,g--,g<0));)u[g]++,l>>=1;return u}static getCodewordBucketNumber(l){return l instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(l):this.getCodewordBucketNumber_number(l)}static getCodewordBucketNumber_number(l){return Js.getCodewordBucketNumber(Js.getBitCountForCodeword(l))}static getCodewordBucketNumber_Int32Array(l){return(l[0]-l[2]+l[4]-l[6]+9)%9}static toString(l){let u=new Fi;for(let m=0;m<l.length;m++){u.format("Row %2d: ",m);for(let g=0;g<l[m].length;g++){let y=l[m][g];y.getValue().length===0?u.format("        ",null):u.format("%4d(%2d)",y.getValue()[0],y.getConfidence(y.getValue()[0]))}u.format("%n")}return u.toString()}}Js.CODEWORD_SKEW_SIZE=2,Js.MAX_ERRORS=3,Js.MAX_EC_CODEWORDS=512,Js.errorCorrection=new Ju;class sn{decode(l,u=null){let m=sn.decode(l,u,!1);if(m==null||m.length===0||m[0]==null)throw H.getNotFoundInstance();return m[0]}decodeMultiple(l,u=null){try{return sn.decode(l,u,!0)}catch(m){throw m instanceof D||m instanceof b?H.getNotFoundInstance():m}}static decode(l,u,m){const g=new Array,y=Xs.detectMultiple(l,u,m);for(const j of y.getPoints()){const S=Js.decode(y.getBits(),j[4],j[5],j[6],j[7],sn.getMinCodewordWidth(j),sn.getMaxCodewordWidth(j)),P=new ie(S.getText(),S.getRawBytes(),void 0,j,xe.PDF_417);P.putMetadata(me.ERROR_CORRECTION_LEVEL,S.getECLevel());const V=S.getOther();V!=null&&P.putMetadata(me.PDF417_EXTRA_METADATA,V),g.push(P)}return g.map(j=>j)}static getMaxWidth(l,u){return l==null||u==null?0:Math.trunc(Math.abs(l.getX()-u.getX()))}static getMinWidth(l,u){return l==null||u==null?k.MAX_VALUE:Math.trunc(Math.abs(l.getX()-u.getX()))}static getMaxCodewordWidth(l){return Math.floor(Math.max(Math.max(sn.getMaxWidth(l[0],l[4]),sn.getMaxWidth(l[6],l[2])*Qt.MODULES_IN_CODEWORD/Qt.MODULES_IN_STOP_PATTERN),Math.max(sn.getMaxWidth(l[1],l[5]),sn.getMaxWidth(l[7],l[3])*Qt.MODULES_IN_CODEWORD/Qt.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(l){return Math.floor(Math.min(Math.min(sn.getMinWidth(l[0],l[4]),sn.getMinWidth(l[6],l[2])*Qt.MODULES_IN_CODEWORD/Qt.MODULES_IN_STOP_PATTERN),Math.min(sn.getMinWidth(l[1],l[5]),sn.getMinWidth(l[7],l[3])*Qt.MODULES_IN_CODEWORD/Qt.MODULES_IN_STOP_PATTERN)))}reset(){}}class ri extends h{}ri.kind="ReaderException";class j0{constructor(l,u){this.verbose=l===!0,u&&this.setHints(u)}decode(l,u){return u&&this.setHints(u),this.decodeInternal(l)}decodeWithState(l){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(l)}setHints(l){this.hints=l;const u=!a(l)&&l.get(O.TRY_HARDER)===!0,m=a(l)?null:l.get(O.POSSIBLE_FORMATS),g=new Array;if(!a(m)){const y=m.some(j=>j===xe.UPC_A||j===xe.UPC_E||j===xe.EAN_13||j===xe.EAN_8||j===xe.CODABAR||j===xe.CODE_39||j===xe.CODE_93||j===xe.CODE_128||j===xe.ITF||j===xe.RSS_14||j===xe.RSS_EXPANDED);y&&!u&&g.push(new Ln(l,this.verbose)),m.includes(xe.QR_CODE)&&g.push(new en),m.includes(xe.DATA_MATRIX)&&g.push(new Mr),m.includes(xe.AZTEC)&&g.push(new qe),m.includes(xe.PDF_417)&&g.push(new sn),y&&u&&g.push(new Ln(l,this.verbose))}g.length===0&&(u||g.push(new Ln(l,this.verbose)),g.push(new en),g.push(new Mr),g.push(new qe),g.push(new sn),u&&g.push(new Ln(l,this.verbose))),this.readers=g}reset(){if(this.readers!==null)for(const l of this.readers)l.reset()}decodeInternal(l){if(this.readers===null)throw new ri("No readers where selected, nothing can be read.");for(const u of this.readers)try{return u.decode(l,this.hints)}catch(m){if(m instanceof ri)continue}throw new H("No MultiFormat Readers were able to detect the code.")}}class N0 extends ee{constructor(l=null,u=500){const m=new j0;m.setHints(l),super(m,u)}decodeBitmap(l){return this.reader.decodeWithState(l)}}class dl extends ee{constructor(l=500){super(new sn,l)}}class C0 extends ee{constructor(l=500){super(new en,l)}}var sh;(function(te){te[te.ERROR_CORRECTION=0]="ERROR_CORRECTION",te[te.CHARACTER_SET=1]="CHARACTER_SET",te[te.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",te[te.MIN_SIZE=3]="MIN_SIZE",te[te.MAX_SIZE=4]="MAX_SIZE",te[te.MARGIN=5]="MARGIN",te[te.PDF417_COMPACT=6]="PDF417_COMPACT",te[te.PDF417_COMPACTION=7]="PDF417_COMPACTION",te[te.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",te[te.AZTEC_LAYERS=9]="AZTEC_LAYERS",te[te.QR_VERSION=10]="QR_VERSION"})(sh||(sh={}));var ja=sh;class rm{constructor(l){this.field=l,this.cachedGenerators=[],this.cachedGenerators.push(new ne(l,Int32Array.from([1])))}buildGenerator(l){const u=this.cachedGenerators;if(l>=u.length){let m=u[u.length-1];const g=this.field;for(let y=u.length;y<=l;y++){const j=m.multiply(new ne(g,Int32Array.from([1,g.exp(y-1+g.getGeneratorBase())])));u.push(j),m=j}}return u[l]}encode(l,u){if(u===0)throw new x("No error correction bytes");const m=l.length-u;if(m<=0)throw new x("No data bytes provided");const g=this.buildGenerator(u),y=new Int32Array(m);_.arraycopy(l,0,y,0,m);let j=new ne(this.field,y);j=j.multiplyByMonomial(u,1);const P=j.divide(g)[1].getCoefficients(),V=u-P.length;for(let K=0;K<V;K++)l[m+K]=0;_.arraycopy(P,0,l,m+V,P.length)}}class fa{constructor(){}static applyMaskPenaltyRule1(l){return fa.applyMaskPenaltyRule1Internal(l,!0)+fa.applyMaskPenaltyRule1Internal(l,!1)}static applyMaskPenaltyRule2(l){let u=0;const m=l.getArray(),g=l.getWidth(),y=l.getHeight();for(let j=0;j<y-1;j++){const S=m[j];for(let P=0;P<g-1;P++){const V=S[P];V===S[P+1]&&V===m[j+1][P]&&V===m[j+1][P+1]&&u++}}return fa.N2*u}static applyMaskPenaltyRule3(l){let u=0;const m=l.getArray(),g=l.getWidth(),y=l.getHeight();for(let j=0;j<y;j++)for(let S=0;S<g;S++){const P=m[j];S+6<g&&P[S]===1&&P[S+1]===0&&P[S+2]===1&&P[S+3]===1&&P[S+4]===1&&P[S+5]===0&&P[S+6]===1&&(fa.isWhiteHorizontal(P,S-4,S)||fa.isWhiteHorizontal(P,S+7,S+11))&&u++,j+6<y&&m[j][S]===1&&m[j+1][S]===0&&m[j+2][S]===1&&m[j+3][S]===1&&m[j+4][S]===1&&m[j+5][S]===0&&m[j+6][S]===1&&(fa.isWhiteVertical(m,S,j-4,j)||fa.isWhiteVertical(m,S,j+7,j+11))&&u++}return u*fa.N3}static isWhiteHorizontal(l,u,m){u=Math.max(u,0),m=Math.min(m,l.length);for(let g=u;g<m;g++)if(l[g]===1)return!1;return!0}static isWhiteVertical(l,u,m,g){m=Math.max(m,0),g=Math.min(g,l.length);for(let y=m;y<g;y++)if(l[y][u]===1)return!1;return!0}static applyMaskPenaltyRule4(l){let u=0;const m=l.getArray(),g=l.getWidth(),y=l.getHeight();for(let P=0;P<y;P++){const V=m[P];for(let K=0;K<g;K++)V[K]===1&&u++}const j=l.getHeight()*l.getWidth();return Math.floor(Math.abs(u*2-j)*10/j)*fa.N4}static getDataMaskBit(l,u,m){let g,y;switch(l){case 0:g=m+u&1;break;case 1:g=m&1;break;case 2:g=u%3;break;case 3:g=(m+u)%3;break;case 4:g=Math.floor(m/2)+Math.floor(u/3)&1;break;case 5:y=m*u,g=(y&1)+y%3;break;case 6:y=m*u,g=(y&1)+y%3&1;break;case 7:y=m*u,g=y%3+(m+u&1)&1;break;default:throw new x("Invalid mask pattern: "+l)}return g===0}static applyMaskPenaltyRule1Internal(l,u){let m=0;const g=u?l.getHeight():l.getWidth(),y=u?l.getWidth():l.getHeight(),j=l.getArray();for(let S=0;S<g;S++){let P=0,V=-1;for(let K=0;K<y;K++){const se=u?j[S][K]:j[K][S];se===V?P++:(P>=5&&(m+=fa.N1+(P-5)),P=1,V=se)}P>=5&&(m+=fa.N1+(P-5))}return m}}fa.N1=3,fa.N2=3,fa.N3=40,fa.N4=10;class Kd{constructor(l,u){this.width=l,this.height=u;const m=new Array(u);for(let g=0;g!==u;g++)m[g]=new Uint8Array(l);this.bytes=m}getHeight(){return this.height}getWidth(){return this.width}get(l,u){return this.bytes[u][l]}getArray(){return this.bytes}setNumber(l,u,m){this.bytes[u][l]=m}setBoolean(l,u,m){this.bytes[u][l]=m?1:0}clear(l){for(const u of this.bytes)A.fill(u,l)}equals(l){if(!(l instanceof Kd))return!1;const u=l;if(this.width!==u.width||this.height!==u.height)return!1;for(let m=0,g=this.height;m<g;++m){const y=this.bytes[m],j=u.bytes[m];for(let S=0,P=this.width;S<P;++S)if(y[S]!==j[S])return!1}return!0}toString(){const l=new ae;for(let u=0,m=this.height;u<m;++u){const g=this.bytes[u];for(let y=0,j=this.width;y<j;++y)switch(g[y]){case 0:l.append(" 0");break;case 1:l.append(" 1");break;default:l.append("  ");break}l.append(`
`)}return l.toString()}}class Xl{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const l=new ae;return l.append(`<<
`),l.append(" mode: "),l.append(this.mode?this.mode.toString():"null"),l.append(`
 ecLevel: `),l.append(this.ecLevel?this.ecLevel.toString():"null"),l.append(`
 version: `),l.append(this.version?this.version.toString():"null"),l.append(`
 maskPattern: `),l.append(this.maskPattern.toString()),this.matrix?(l.append(`
 matrix:
`),l.append(this.matrix.toString())):l.append(`
 matrix: null
`),l.append(`>>
`),l.toString()}setMode(l){this.mode=l}setECLevel(l){this.ecLevel=l}setVersion(l){this.version=l}setMaskPattern(l){this.maskPattern=l}setMatrix(l){this.matrix=l}static isValidMaskPattern(l){return l>=0&&l<Xl.NUM_MASK_PATTERNS}}Xl.NUM_MASK_PATTERNS=8;class qr extends h{}qr.kind="WriterException";class Es{constructor(){}static clearMatrix(l){l.clear(255)}static buildMatrix(l,u,m,g,y){Es.clearMatrix(y),Es.embedBasicPatterns(m,y),Es.embedTypeInfo(u,g,y),Es.maybeEmbedVersionInfo(m,y),Es.embedDataBits(l,g,y)}static embedBasicPatterns(l,u){Es.embedPositionDetectionPatternsAndSeparators(u),Es.embedDarkDotAtLeftBottomCorner(u),Es.maybeEmbedPositionAdjustmentPatterns(l,u),Es.embedTimingPatterns(u)}static embedTypeInfo(l,u,m){const g=new I;Es.makeTypeInfoBits(l,u,g);for(let y=0,j=g.getSize();y<j;++y){const S=g.get(g.getSize()-1-y),P=Es.TYPE_INFO_COORDINATES[y],V=P[0],K=P[1];if(m.setBoolean(V,K,S),y<8){const se=m.getWidth()-y-1;m.setBoolean(se,8,S)}else{const ue=m.getHeight()-7+(y-8);m.setBoolean(8,ue,S)}}}static maybeEmbedVersionInfo(l,u){if(l.getVersionNumber()<7)return;const m=new I;Es.makeVersionInfoBits(l,m);let g=6*3-1;for(let y=0;y<6;++y)for(let j=0;j<3;++j){const S=m.get(g);g--,u.setBoolean(y,u.getHeight()-11+j,S),u.setBoolean(u.getHeight()-11+j,y,S)}}static embedDataBits(l,u,m){let g=0,y=-1,j=m.getWidth()-1,S=m.getHeight()-1;for(;j>0;){for(j===6&&(j-=1);S>=0&&S<m.getHeight();){for(let P=0;P<2;++P){const V=j-P;if(!Es.isEmpty(m.get(V,S)))continue;let K;g<l.getSize()?(K=l.get(g),++g):K=!1,u!==255&&fa.getDataMaskBit(u,V,S)&&(K=!K),m.setBoolean(V,S,K)}S+=y}y=-y,S+=y,j-=2}if(g!==l.getSize())throw new qr("Not all bits consumed: "+g+"/"+l.getSize())}static findMSBSet(l){return 32-k.numberOfLeadingZeros(l)}static calculateBCHCode(l,u){if(u===0)throw new x("0 polynomial");const m=Es.findMSBSet(u);for(l<<=m-1;Es.findMSBSet(l)>=m;)l^=u<<Es.findMSBSet(l)-m;return l}static makeTypeInfoBits(l,u,m){if(!Xl.isValidMaskPattern(u))throw new qr("Invalid mask pattern");const g=l.getBits()<<3|u;m.appendBits(g,5);const y=Es.calculateBCHCode(g,Es.TYPE_INFO_POLY);m.appendBits(y,10);const j=new I;if(j.appendBits(Es.TYPE_INFO_MASK_PATTERN,15),m.xor(j),m.getSize()!==15)throw new qr("should not happen but we got: "+m.getSize())}static makeVersionInfoBits(l,u){u.appendBits(l.getVersionNumber(),6);const m=Es.calculateBCHCode(l.getVersionNumber(),Es.VERSION_INFO_POLY);if(u.appendBits(m,12),u.getSize()!==18)throw new qr("should not happen but we got: "+u.getSize())}static isEmpty(l){return l===255}static embedTimingPatterns(l){for(let u=8;u<l.getWidth()-8;++u){const m=(u+1)%2;Es.isEmpty(l.get(u,6))&&l.setNumber(u,6,m),Es.isEmpty(l.get(6,u))&&l.setNumber(6,u,m)}}static embedDarkDotAtLeftBottomCorner(l){if(l.get(8,l.getHeight()-8)===0)throw new qr;l.setNumber(8,l.getHeight()-8,1)}static embedHorizontalSeparationPattern(l,u,m){for(let g=0;g<8;++g){if(!Es.isEmpty(m.get(l+g,u)))throw new qr;m.setNumber(l+g,u,0)}}static embedVerticalSeparationPattern(l,u,m){for(let g=0;g<7;++g){if(!Es.isEmpty(m.get(l,u+g)))throw new qr;m.setNumber(l,u+g,0)}}static embedPositionAdjustmentPattern(l,u,m){for(let g=0;g<5;++g){const y=Es.POSITION_ADJUSTMENT_PATTERN[g];for(let j=0;j<5;++j)m.setNumber(l+j,u+g,y[j])}}static embedPositionDetectionPattern(l,u,m){for(let g=0;g<7;++g){const y=Es.POSITION_DETECTION_PATTERN[g];for(let j=0;j<7;++j)m.setNumber(l+j,u+g,y[j])}}static embedPositionDetectionPatternsAndSeparators(l){const u=Es.POSITION_DETECTION_PATTERN[0].length;Es.embedPositionDetectionPattern(0,0,l),Es.embedPositionDetectionPattern(l.getWidth()-u,0,l),Es.embedPositionDetectionPattern(0,l.getWidth()-u,l);const m=8;Es.embedHorizontalSeparationPattern(0,m-1,l),Es.embedHorizontalSeparationPattern(l.getWidth()-m,m-1,l),Es.embedHorizontalSeparationPattern(0,l.getWidth()-m,l);const g=7;Es.embedVerticalSeparationPattern(g,0,l),Es.embedVerticalSeparationPattern(l.getHeight()-g-1,0,l),Es.embedVerticalSeparationPattern(g,l.getHeight()-g,l)}static maybeEmbedPositionAdjustmentPatterns(l,u){if(l.getVersionNumber()<2)return;const m=l.getVersionNumber()-1,g=Es.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[m];for(let y=0,j=g.length;y!==j;y++){const S=g[y];if(S>=0)for(let P=0;P!==j;P++){const V=g[P];V>=0&&Es.isEmpty(u.get(V,S))&&Es.embedPositionAdjustmentPattern(V-2,S-2,u)}}}}Es.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),Es.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),Es.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),Es.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),Es.VERSION_INFO_POLY=7973,Es.TYPE_INFO_POLY=1335,Es.TYPE_INFO_MASK_PATTERN=21522;class m1{constructor(l,u){this.dataBytes=l,this.errorCorrectionBytes=u}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class Zr{constructor(){}static calculateMaskPenalty(l){return fa.applyMaskPenaltyRule1(l)+fa.applyMaskPenaltyRule2(l)+fa.applyMaskPenaltyRule3(l)+fa.applyMaskPenaltyRule4(l)}static encode(l,u,m=null){let g=Zr.DEFAULT_BYTE_MODE_ENCODING;const y=m!==null&&m.get(ja.CHARACTER_SET)!==void 0;y&&(g=m.get(ja.CHARACTER_SET).toString());const j=this.chooseMode(l,g),S=new I;if(j===Ns.BYTE&&(y||Zr.DEFAULT_BYTE_MODE_ENCODING!==g)){const Vt=M.getCharacterSetECIByName(g);Vt!==void 0&&this.appendECI(Vt,S)}this.appendModeInfo(j,S);const P=new I;this.appendBytes(l,j,P,g);let V;if(m!==null&&m.get(ja.QR_VERSION)!==void 0){const Vt=Number.parseInt(m.get(ja.QR_VERSION).toString(),10);V=Zt.getVersionForNumber(Vt);const Pt=this.calculateBitsNeeded(j,S,P,V);if(!this.willFit(Pt,V,u))throw new qr("Data too big for requested version")}else V=this.recommendVersion(u,j,S,P);const K=new I;K.appendBitArray(S);const se=j===Ns.BYTE?P.getSizeInBytes():l.length;this.appendLengthInfo(se,V,j,K),K.appendBitArray(P);const ue=V.getECBlocksForLevel(u),Ae=V.getTotalCodewords()-ue.getTotalECCodewords();this.terminateBits(Ae,K);const Ve=this.interleaveWithECBytes(K,V.getTotalCodewords(),Ae,ue.getNumBlocks()),$e=new Xl;$e.setECLevel(u),$e.setMode(j),$e.setVersion(V);const st=V.getDimensionForVersion(),ht=new Kd(st,st),Bt=this.chooseMaskPattern(Ve,u,V,ht);return $e.setMaskPattern(Bt),Es.buildMatrix(Ve,u,V,Bt,ht),$e.setMatrix(ht),$e}static recommendVersion(l,u,m,g){const y=this.calculateBitsNeeded(u,m,g,Zt.getVersionForNumber(1)),j=this.chooseVersion(y,l),S=this.calculateBitsNeeded(u,m,g,j);return this.chooseVersion(S,l)}static calculateBitsNeeded(l,u,m,g){return u.getSize()+l.getCharacterCountBits(g)+m.getSize()}static getAlphanumericCode(l){return l<Zr.ALPHANUMERIC_TABLE.length?Zr.ALPHANUMERIC_TABLE[l]:-1}static chooseMode(l,u=null){if(M.SJIS.getName()===u&&this.isOnlyDoubleByteKanji(l))return Ns.KANJI;let m=!1,g=!1;for(let y=0,j=l.length;y<j;++y){const S=l.charAt(y);if(Zr.isDigit(S))m=!0;else if(this.getAlphanumericCode(S.charCodeAt(0))!==-1)g=!0;else return Ns.BYTE}return g?Ns.ALPHANUMERIC:m?Ns.NUMERIC:Ns.BYTE}static isOnlyDoubleByteKanji(l){let u;try{u=q.encode(l,M.SJIS)}catch{return!1}const m=u.length;if(m%2!==0)return!1;for(let g=0;g<m;g+=2){const y=u[g]&255;if((y<129||y>159)&&(y<224||y>235))return!1}return!0}static chooseMaskPattern(l,u,m,g){let y=Number.MAX_SAFE_INTEGER,j=-1;for(let S=0;S<Xl.NUM_MASK_PATTERNS;S++){Es.buildMatrix(l,u,m,S,g);let P=this.calculateMaskPenalty(g);P<y&&(y=P,j=S)}return j}static chooseVersion(l,u){for(let m=1;m<=40;m++){const g=Zt.getVersionForNumber(m);if(Zr.willFit(l,g,u))return g}throw new qr("Data too big")}static willFit(l,u,m){const g=u.getTotalCodewords(),j=u.getECBlocksForLevel(m).getTotalECCodewords(),S=g-j,P=(l+7)/8;return S>=P}static terminateBits(l,u){const m=l*8;if(u.getSize()>m)throw new qr("data bits cannot fit in the QR Code"+u.getSize()+" > "+m);for(let j=0;j<4&&u.getSize()<m;++j)u.appendBit(!1);const g=u.getSize()&7;if(g>0)for(let j=g;j<8;j++)u.appendBit(!1);const y=l-u.getSizeInBytes();for(let j=0;j<y;++j)u.appendBits(j&1?17:236,8);if(u.getSize()!==m)throw new qr("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(l,u,m,g,y,j){if(g>=m)throw new qr("Block ID too large");const S=l%m,P=m-S,V=Math.floor(l/m),K=V+1,se=Math.floor(u/m),ue=se+1,Ae=V-se,Ve=K-ue;if(Ae!==Ve)throw new qr("EC bytes mismatch");if(m!==P+S)throw new qr("RS blocks mismatch");if(l!==(se+Ae)*P+(ue+Ve)*S)throw new qr("Total bytes mismatch");g<P?(y[0]=se,j[0]=Ae):(y[0]=ue,j[0]=Ve)}static interleaveWithECBytes(l,u,m,g){if(l.getSizeInBytes()!==m)throw new qr("Number of bits and data bytes does not match");let y=0,j=0,S=0;const P=new Array;for(let K=0;K<g;++K){const se=new Int32Array(1),ue=new Int32Array(1);Zr.getNumDataBytesAndNumECBytesForBlockID(u,m,g,K,se,ue);const Ae=se[0],Ve=new Uint8Array(Ae);l.toBytes(8*y,Ve,0,Ae);const $e=Zr.generateECBytes(Ve,ue[0]);P.push(new m1(Ve,$e)),j=Math.max(j,Ae),S=Math.max(S,$e.length),y+=se[0]}if(m!==y)throw new qr("Data bytes does not match offset");const V=new I;for(let K=0;K<j;++K)for(const se of P){const ue=se.getDataBytes();K<ue.length&&V.appendBits(ue[K],8)}for(let K=0;K<S;++K)for(const se of P){const ue=se.getErrorCorrectionBytes();K<ue.length&&V.appendBits(ue[K],8)}if(u!==V.getSizeInBytes())throw new qr("Interleaving error: "+u+" and "+V.getSizeInBytes()+" differ.");return V}static generateECBytes(l,u){const m=l.length,g=new Int32Array(m+u);for(let j=0;j<m;j++)g[j]=l[j]&255;new rm(Ie.QR_CODE_FIELD_256).encode(g,u);const y=new Uint8Array(u);for(let j=0;j<u;j++)y[j]=g[m+j];return y}static appendModeInfo(l,u){u.appendBits(l.getBits(),4)}static appendLengthInfo(l,u,m,g){const y=m.getCharacterCountBits(u);if(l>=1<<y)throw new qr(l+" is bigger than "+((1<<y)-1));g.appendBits(l,y)}static appendBytes(l,u,m,g){switch(u){case Ns.NUMERIC:Zr.appendNumericBytes(l,m);break;case Ns.ALPHANUMERIC:Zr.appendAlphanumericBytes(l,m);break;case Ns.BYTE:Zr.append8BitBytes(l,m,g);break;case Ns.KANJI:Zr.appendKanjiBytes(l,m);break;default:throw new qr("Invalid mode: "+u)}}static getDigit(l){return l.charCodeAt(0)-48}static isDigit(l){const u=Zr.getDigit(l);return u>=0&&u<=9}static appendNumericBytes(l,u){const m=l.length;let g=0;for(;g<m;){const y=Zr.getDigit(l.charAt(g));if(g+2<m){const j=Zr.getDigit(l.charAt(g+1)),S=Zr.getDigit(l.charAt(g+2));u.appendBits(y*100+j*10+S,10),g+=3}else if(g+1<m){const j=Zr.getDigit(l.charAt(g+1));u.appendBits(y*10+j,7),g+=2}else u.appendBits(y,4),g++}}static appendAlphanumericBytes(l,u){const m=l.length;let g=0;for(;g<m;){const y=Zr.getAlphanumericCode(l.charCodeAt(g));if(y===-1)throw new qr;if(g+1<m){const j=Zr.getAlphanumericCode(l.charCodeAt(g+1));if(j===-1)throw new qr;u.appendBits(y*45+j,11),g+=2}else u.appendBits(y,6),g++}}static append8BitBytes(l,u,m){let g;try{g=q.encode(l,m)}catch(y){throw new qr(y)}for(let y=0,j=g.length;y!==j;y++){const S=g[y];u.appendBits(S,8)}}static appendKanjiBytes(l,u){let m;try{m=q.encode(l,M.SJIS)}catch(y){throw new qr(y)}const g=m.length;for(let y=0;y<g;y+=2){const j=m[y]&255,S=m[y+1]&255,P=j<<8&4294967295|S;let V=-1;if(P>=33088&&P<=40956?V=P-33088:P>=57408&&P<=60351&&(V=P-49472),V===-1)throw new qr("Invalid byte sequence");const K=(V>>8)*192+(V&255);u.appendBits(K,13)}}static appendECI(l,u){u.appendBits(Ns.ECI.getBits(),4),u.appendBits(l.getValue(),8)}}Zr.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Zr.DEFAULT_BYTE_MODE_ENCODING=M.UTF8.getName();class ul{write(l,u,m,g=null){if(l.length===0)throw new x("Found empty contents");if(u<0||m<0)throw new x("Requested dimensions are too small: "+u+"x"+m);let y=mr.L,j=ul.QUIET_ZONE_SIZE;g!==null&&(g.get(ja.ERROR_CORRECTION)!==void 0&&(y=mr.fromString(g.get(ja.ERROR_CORRECTION).toString())),g.get(ja.MARGIN)!==void 0&&(j=Number.parseInt(g.get(ja.MARGIN).toString(),10)));const S=Zr.encode(l,y,g);return this.renderResult(S,u,m,j)}writeToDom(l,u,m,g,y=null){typeof l=="string"&&(l=document.querySelector(l));const j=this.write(u,m,g,y);l&&l.appendChild(j)}renderResult(l,u,m,g){const y=l.getMatrix();if(y===null)throw new ot;const j=y.getWidth(),S=y.getHeight(),P=j+g*2,V=S+g*2,K=Math.max(u,P),se=Math.max(m,V),ue=Math.min(Math.floor(K/P),Math.floor(se/V)),Ae=Math.floor((K-j*ue)/2),Ve=Math.floor((se-S*ue)/2),$e=this.createSVGElement(K,se);for(let st=0,ht=Ve;st<S;st++,ht+=ue)for(let Bt=0,Vt=Ae;Bt<j;Bt++,Vt+=ue)if(y.get(Bt,st)===1){const Pt=this.createSvgRectElement(Vt,ht,ue,ue);$e.appendChild(Pt)}return $e}createSVGElement(l,u){const m=document.createElementNS(ul.SVG_NS,"svg");return m.setAttributeNS(null,"height",l.toString()),m.setAttributeNS(null,"width",u.toString()),m}createSvgRectElement(l,u,m,g){const y=document.createElementNS(ul.SVG_NS,"rect");return y.setAttributeNS(null,"x",l.toString()),y.setAttributeNS(null,"y",u.toString()),y.setAttributeNS(null,"height",m.toString()),y.setAttributeNS(null,"width",g.toString()),y.setAttributeNS(null,"fill","#000000"),y}}ul.QUIET_ZONE_SIZE=4,ul.SVG_NS="http://www.w3.org/2000/svg";class Do{encode(l,u,m,g,y){if(l.length===0)throw new x("Found empty contents");if(u!==xe.QR_CODE)throw new x("Can only encode QR_CODE, but got "+u);if(m<0||g<0)throw new x(`Requested dimensions are too small: ${m}x${g}`);let j=mr.L,S=Do.QUIET_ZONE_SIZE;y!==null&&(y.get(ja.ERROR_CORRECTION)!==void 0&&(j=mr.fromString(y.get(ja.ERROR_CORRECTION).toString())),y.get(ja.MARGIN)!==void 0&&(S=Number.parseInt(y.get(ja.MARGIN).toString(),10)));const P=Zr.encode(l,j,y);return Do.renderResult(P,m,g,S)}static renderResult(l,u,m,g){const y=l.getMatrix();if(y===null)throw new ot;const j=y.getWidth(),S=y.getHeight(),P=j+g*2,V=S+g*2,K=Math.max(u,P),se=Math.max(m,V),ue=Math.min(Math.floor(K/P),Math.floor(se/V)),Ae=Math.floor((K-j*ue)/2),Ve=Math.floor((se-S*ue)/2),$e=new je(K,se);for(let st=0,ht=Ve;st<S;st++,ht+=ue)for(let Bt=0,Vt=Ae;Bt<j;Bt++,Vt+=ue)y.get(Bt,st)===1&&$e.setRegion(Vt,ht,ue,ue);return $e}}Do.QUIET_ZONE_SIZE=4;class Yl{encode(l,u,m,g,y){let j;switch(u){case xe.QR_CODE:j=new Do;break;default:throw new x("No encoder available for format "+u)}return j.encode(l,u,m,g,y)}}class ao extends Q{constructor(l,u,m,g,y,j,S,P){if(super(j,S),this.yuvData=l,this.dataWidth=u,this.dataHeight=m,this.left=g,this.top=y,g+j>u||y+S>m)throw new x("Crop rectangle does not fit within image data.");P&&this.reverseHorizontal(j,S)}getRow(l,u){if(l<0||l>=this.getHeight())throw new x("Requested row is outside the image: "+l);const m=this.getWidth();(u==null||u.length<m)&&(u=new Uint8ClampedArray(m));const g=(l+this.top)*this.dataWidth+this.left;return _.arraycopy(this.yuvData,g,u,0,m),u}getMatrix(){const l=this.getWidth(),u=this.getHeight();if(l===this.dataWidth&&u===this.dataHeight)return this.yuvData;const m=l*u,g=new Uint8ClampedArray(m);let y=this.top*this.dataWidth+this.left;if(l===this.dataWidth)return _.arraycopy(this.yuvData,y,g,0,m),g;for(let j=0;j<u;j++){const S=j*l;_.arraycopy(this.yuvData,y,g,S,l),y+=this.dataWidth}return g}isCropSupported(){return!0}crop(l,u,m,g){return new ao(this.yuvData,this.dataWidth,this.dataHeight,this.left+l,this.top+u,m,g,!1)}renderThumbnail(){const l=this.getWidth()/ao.THUMBNAIL_SCALE_FACTOR,u=this.getHeight()/ao.THUMBNAIL_SCALE_FACTOR,m=new Int32Array(l*u),g=this.yuvData;let y=this.top*this.dataWidth+this.left;for(let j=0;j<u;j++){const S=j*l;for(let P=0;P<l;P++){const V=g[y+P*ao.THUMBNAIL_SCALE_FACTOR]&255;m[S+P]=4278190080|V*65793}y+=this.dataWidth*ao.THUMBNAIL_SCALE_FACTOR}return m}getThumbnailWidth(){return this.getWidth()/ao.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/ao.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(l,u){const m=this.yuvData;for(let g=0,y=this.top*this.dataWidth+this.left;g<u;g++,y+=this.dataWidth){const j=y+l/2;for(let S=y,P=y+l-1;S<j;S++,P--){const V=m[S];m[S]=m[P],m[P]=V}}}invert(){return new re(this)}}ao.THUMBNAIL_SCALE_FACTOR=2;class Zl extends Q{constructor(l,u,m,g,y,j,S){if(super(u,m),this.dataWidth=g,this.dataHeight=y,this.left=j,this.top=S,l.BYTES_PER_ELEMENT===4){const P=u*m,V=new Uint8ClampedArray(P);for(let K=0;K<P;K++){const se=l[K],ue=se>>16&255,Ae=se>>7&510,Ve=se&255;V[K]=(ue+Ae+Ve)/4&255}this.luminances=V}else this.luminances=l;if(g===void 0&&(this.dataWidth=u),y===void 0&&(this.dataHeight=m),j===void 0&&(this.left=0),S===void 0&&(this.top=0),this.left+u>this.dataWidth||this.top+m>this.dataHeight)throw new x("Crop rectangle does not fit within image data.")}getRow(l,u){if(l<0||l>=this.getHeight())throw new x("Requested row is outside the image: "+l);const m=this.getWidth();(u==null||u.length<m)&&(u=new Uint8ClampedArray(m));const g=(l+this.top)*this.dataWidth+this.left;return _.arraycopy(this.luminances,g,u,0,m),u}getMatrix(){const l=this.getWidth(),u=this.getHeight();if(l===this.dataWidth&&u===this.dataHeight)return this.luminances;const m=l*u,g=new Uint8ClampedArray(m);let y=this.top*this.dataWidth+this.left;if(l===this.dataWidth)return _.arraycopy(this.luminances,y,g,0,m),g;for(let j=0;j<u;j++){const S=j*l;_.arraycopy(this.luminances,y,g,S,l),y+=this.dataWidth}return g}isCropSupported(){return!0}crop(l,u,m,g){return new Zl(this.luminances,m,g,this.dataWidth,this.dataHeight,this.left+l,this.top+u)}invert(){return new re(this)}}class ai extends M{static forName(l){return this.getCharacterSetECIByName(l)}}class rh{}rh.ISO_8859_1=M.ISO8859_1;class am{isCompact(){return this.compact}setCompact(l){this.compact=l}getSize(){return this.size}setSize(l){this.size=l}getLayers(){return this.layers}setLayers(l){this.layers=l}getCodeWords(){return this.codeWords}setCodeWords(l){this.codeWords=l}getMatrix(){return this.matrix}setMatrix(l){this.matrix=l}}class E0{static singletonList(l){return[l]}static min(l,u){return l.sort(u)[0]}}class nm{constructor(l){this.previous=l}getPrevious(){return this.previous}}class hl extends nm{constructor(l,u,m){super(l),this.value=u,this.bitCount=m}appendTo(l,u){l.appendBits(this.value,this.bitCount)}add(l,u){return new hl(this,l,u)}addBinaryShift(l,u){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new hl(this,l,u)}toString(){let l=this.value&(1<<this.bitCount)-1;return l|=1<<this.bitCount,"<"+k.toBinaryString(l|1<<this.bitCount).substring(1)+">"}}class im extends hl{constructor(l,u,m){super(l,0,0),this.binaryShiftStart=u,this.binaryShiftByteCount=m}appendTo(l,u){for(let m=0;m<this.binaryShiftByteCount;m++)(m===0||m===31&&this.binaryShiftByteCount<=62)&&(l.appendBits(31,5),this.binaryShiftByteCount>62?l.appendBits(this.binaryShiftByteCount-31,16):m===0?l.appendBits(Math.min(this.binaryShiftByteCount,31),5):l.appendBits(this.binaryShiftByteCount-31,5)),l.appendBits(u[this.binaryShiftStart+m],8)}addBinaryShift(l,u){return new im(this,l,u)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function p1(te,l,u){return new im(te,l,u)}function Pc(te,l,u){return new hl(te,l,u)}const x1=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],$a=0,Mo=1,_i=2,no=3,io=4,Ic=new hl(null,0,0),om=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function Xd(te){for(let l of te)A.fill(l,-1);return te[$a][io]=0,te[Mo][io]=0,te[Mo][$a]=28,te[no][io]=0,te[_i][io]=0,te[_i][$a]=15,te}const lm=Xd(A.createInt32Array(6,6));class ni{constructor(l,u,m,g){this.token=l,this.mode=u,this.binaryShiftByteCount=m,this.bitCount=g}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(l,u){let m=this.bitCount,g=this.token;if(l!==this.mode){let j=om[this.mode][l];g=Pc(g,j&65535,j>>16),m+=j>>16}let y=l===_i?4:5;return g=Pc(g,u,y),new ni(g,l,0,m+y)}shiftAndAppend(l,u){let m=this.token,g=this.mode===_i?4:5;return m=Pc(m,lm[this.mode][l],g),m=Pc(m,u,5),new ni(m,this.mode,0,this.bitCount+g+5)}addBinaryShiftChar(l){let u=this.token,m=this.mode,g=this.bitCount;if(this.mode===io||this.mode===_i){let S=om[m][$a];u=Pc(u,S&65535,S>>16),g+=S>>16,m=$a}let y=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,j=new ni(u,m,this.binaryShiftByteCount+1,g+y);return j.binaryShiftByteCount===2078&&(j=j.endBinaryShift(l+1)),j}endBinaryShift(l){if(this.binaryShiftByteCount===0)return this;let u=this.token;return u=p1(u,l-this.binaryShiftByteCount,this.binaryShiftByteCount),new ni(u,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(l){let u=this.bitCount+(om[this.mode][l.mode]>>16);return this.binaryShiftByteCount<l.binaryShiftByteCount?u+=ni.calculateBinaryShiftCost(l)-ni.calculateBinaryShiftCost(this):this.binaryShiftByteCount>l.binaryShiftByteCount&&l.binaryShiftByteCount>0&&(u+=10),u<=l.bitCount}toBitArray(l){let u=[];for(let g=this.endBinaryShift(l.length).token;g!==null;g=g.getPrevious())u.unshift(g);let m=new I;for(const g of u)g.appendTo(m,l);return m}toString(){return Y.format("%s bits=%d bytes=%d",x1[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(l){return l.binaryShiftByteCount>62?21:l.binaryShiftByteCount>31?20:l.binaryShiftByteCount>0?10:0}}ni.INITIAL_STATE=new ni(Ic,$a,0,0);function g1(te){const l=Y.getCharCode(" "),u=Y.getCharCode("."),m=Y.getCharCode(",");te[$a][l]=1;const g=Y.getCharCode("Z"),y=Y.getCharCode("A");for(let ue=y;ue<=g;ue++)te[$a][ue]=ue-y+2;te[Mo][l]=1;const j=Y.getCharCode("z"),S=Y.getCharCode("a");for(let ue=S;ue<=j;ue++)te[Mo][ue]=ue-S+2;te[_i][l]=1;const P=Y.getCharCode("9"),V=Y.getCharCode("0");for(let ue=V;ue<=P;ue++)te[_i][ue]=ue-V+2;te[_i][m]=12,te[_i][u]=13;const K=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let ue=0;ue<K.length;ue++)te[no][Y.getCharCode(K[ue])]=ue;const se=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let ue=0;ue<se.length;ue++)Y.getCharCode(se[ue])>0&&(te[io][Y.getCharCode(se[ue])]=ue);return te}const oo=g1(A.createInt32Array(5,256));class fl{constructor(l){this.text=l}encode(){const l=Y.getCharCode(" "),u=Y.getCharCode(`
`);let m=E0.singletonList(ni.INITIAL_STATE);for(let y=0;y<this.text.length;y++){let j,S=y+1<this.text.length?this.text[y+1]:0;switch(this.text[y]){case Y.getCharCode("\r"):j=S===u?2:0;break;case Y.getCharCode("."):j=S===l?3:0;break;case Y.getCharCode(","):j=S===l?4:0;break;case Y.getCharCode(":"):j=S===l?5:0;break;default:j=0}j>0?(m=fl.updateStateListForPair(m,y,j),y++):m=this.updateStateListForChar(m,y)}return E0.min(m,(y,j)=>y.getBitCount()-j.getBitCount()).toBitArray(this.text)}updateStateListForChar(l,u){const m=[];for(let g of l)this.updateStateForChar(g,u,m);return fl.simplifyStates(m)}updateStateForChar(l,u,m){let g=this.text[u]&255,y=oo[l.getMode()][g]>0,j=null;for(let S=0;S<=io;S++){let P=oo[S][g];if(P>0){if(j==null&&(j=l.endBinaryShift(u)),!y||S===l.getMode()||S===_i){const V=j.latchAndAppend(S,P);m.push(V)}if(!y&&lm[l.getMode()][S]>=0){const V=j.shiftAndAppend(S,P);m.push(V)}}}if(l.getBinaryShiftByteCount()>0||oo[l.getMode()][g]===0){let S=l.addBinaryShiftChar(u);m.push(S)}}static updateStateListForPair(l,u,m){const g=[];for(let y of l)this.updateStateForPair(y,u,m,g);return this.simplifyStates(g)}static updateStateForPair(l,u,m,g){let y=l.endBinaryShift(u);if(g.push(y.latchAndAppend(io,m)),l.getMode()!==io&&g.push(y.shiftAndAppend(io,m)),m===3||m===4){let j=y.latchAndAppend(_i,16-m).latchAndAppend(_i,1);g.push(j)}if(l.getBinaryShiftByteCount()>0){let j=l.addBinaryShiftChar(u).addBinaryShiftChar(u+1);g.push(j)}}static simplifyStates(l){let u=[];for(const m of l){let g=!0;for(const y of u){if(y.isBetterThanOrEqualTo(m)){g=!1;break}m.isBetterThanOrEqualTo(y)&&(u=u.filter(j=>j!==y))}g&&u.push(m)}return u}}class jr{constructor(){}static encodeBytes(l){return jr.encode(l,jr.DEFAULT_EC_PERCENT,jr.DEFAULT_AZTEC_LAYERS)}static encode(l,u,m){let g=new fl(l).encode(),y=k.truncDivision(g.getSize()*u,100)+11,j=g.getSize()+y,S,P,V,K,se;if(m!==jr.DEFAULT_AZTEC_LAYERS){if(S=m<0,P=Math.abs(m),P>(S?jr.MAX_NB_BITS_COMPACT:jr.MAX_NB_BITS))throw new x(Y.format("Illegal value %s for layers",m));V=jr.totalBitsInLayer(P,S),K=jr.WORD_SIZE[P];let Pt=V-V%K;if(se=jr.stuffBits(g,K),se.getSize()+y>Pt)throw new x("Data to large for user specified layer");if(S&&se.getSize()>K*64)throw new x("Data to large for user specified layer")}else{K=0,se=null;for(let Pt=0;;Pt++){if(Pt>jr.MAX_NB_BITS)throw new x("Data too large for an Aztec code");if(S=Pt<=3,P=S?Pt+1:Pt,V=jr.totalBitsInLayer(P,S),j>V)continue;(se==null||K!==jr.WORD_SIZE[P])&&(K=jr.WORD_SIZE[P],se=jr.stuffBits(g,K));let pr=V-V%K;if(!(S&&se.getSize()>K*64)&&se.getSize()+y<=pr)break}}let ue=jr.generateCheckWords(se,V,K),Ae=se.getSize()/K,Ve=jr.generateModeMessage(S,P,Ae),$e=(S?11:14)+P*4,st=new Int32Array($e),ht;if(S){ht=$e;for(let Pt=0;Pt<st.length;Pt++)st[Pt]=Pt}else{ht=$e+1+2*k.truncDivision(k.truncDivision($e,2)-1,15);let Pt=k.truncDivision($e,2),pr=k.truncDivision(ht,2);for(let Ys=0;Ys<Pt;Ys++){let ma=Ys+k.truncDivision(Ys,15);st[Pt-Ys-1]=pr-ma-1,st[Pt+Ys]=pr+ma+1}}let Bt=new je(ht);for(let Pt=0,pr=0;Pt<P;Pt++){let Ys=(P-Pt)*4+(S?9:12);for(let ma=0;ma<Ys;ma++){let Bn=ma*2;for(let Vn=0;Vn<2;Vn++)ue.get(pr+Bn+Vn)&&Bt.set(st[Pt*2+Vn],st[Pt*2+ma]),ue.get(pr+Ys*2+Bn+Vn)&&Bt.set(st[Pt*2+ma],st[$e-1-Pt*2-Vn]),ue.get(pr+Ys*4+Bn+Vn)&&Bt.set(st[$e-1-Pt*2-Vn],st[$e-1-Pt*2-ma]),ue.get(pr+Ys*6+Bn+Vn)&&Bt.set(st[$e-1-Pt*2-ma],st[Pt*2+Vn])}pr+=Ys*8}if(jr.drawModeMessage(Bt,S,ht,Ve),S)jr.drawBullsEye(Bt,k.truncDivision(ht,2),5);else{jr.drawBullsEye(Bt,k.truncDivision(ht,2),7);for(let Pt=0,pr=0;Pt<k.truncDivision($e,2)-1;Pt+=15,pr+=16)for(let Ys=k.truncDivision(ht,2)&1;Ys<ht;Ys+=2)Bt.set(k.truncDivision(ht,2)-pr,Ys),Bt.set(k.truncDivision(ht,2)+pr,Ys),Bt.set(Ys,k.truncDivision(ht,2)-pr),Bt.set(Ys,k.truncDivision(ht,2)+pr)}let Vt=new am;return Vt.setCompact(S),Vt.setSize(ht),Vt.setLayers(P),Vt.setCodeWords(Ae),Vt.setMatrix(Bt),Vt}static drawBullsEye(l,u,m){for(let g=0;g<m;g+=2)for(let y=u-g;y<=u+g;y++)l.set(y,u-g),l.set(y,u+g),l.set(u-g,y),l.set(u+g,y);l.set(u-m,u-m),l.set(u-m+1,u-m),l.set(u-m,u-m+1),l.set(u+m,u-m),l.set(u+m,u-m+1),l.set(u+m,u+m-1)}static generateModeMessage(l,u,m){let g=new I;return l?(g.appendBits(u-1,2),g.appendBits(m-1,6),g=jr.generateCheckWords(g,28,4)):(g.appendBits(u-1,5),g.appendBits(m-1,11),g=jr.generateCheckWords(g,40,4)),g}static drawModeMessage(l,u,m,g){let y=k.truncDivision(m,2);if(u)for(let j=0;j<7;j++){let S=y-3+j;g.get(j)&&l.set(S,y-5),g.get(j+7)&&l.set(y+5,S),g.get(20-j)&&l.set(S,y+5),g.get(27-j)&&l.set(y-5,S)}else for(let j=0;j<10;j++){let S=y-5+j+k.truncDivision(j,5);g.get(j)&&l.set(S,y-7),g.get(j+10)&&l.set(y+7,S),g.get(29-j)&&l.set(S,y+7),g.get(39-j)&&l.set(y-7,S)}}static generateCheckWords(l,u,m){let g=l.getSize()/m,y=new rm(jr.getGF(m)),j=k.truncDivision(u,m),S=jr.bitsToWords(l,m,j);y.encode(S,j-g);let P=u%m,V=new I;V.appendBits(0,P);for(const K of Array.from(S))V.appendBits(K,m);return V}static bitsToWords(l,u,m){let g=new Int32Array(m),y,j;for(y=0,j=l.getSize()/u;y<j;y++){let S=0;for(let P=0;P<u;P++)S|=l.get(y*u+P)?1<<u-P-1:0;g[y]=S}return g}static getGF(l){switch(l){case 4:return Ie.AZTEC_PARAM;case 6:return Ie.AZTEC_DATA_6;case 8:return Ie.AZTEC_DATA_8;case 10:return Ie.AZTEC_DATA_10;case 12:return Ie.AZTEC_DATA_12;default:throw new x("Unsupported word size "+l)}}static stuffBits(l,u){let m=new I,g=l.getSize(),y=(1<<u)-2;for(let j=0;j<g;j+=u){let S=0;for(let P=0;P<u;P++)(j+P>=g||l.get(j+P))&&(S|=1<<u-1-P);(S&y)===y?(m.appendBits(S&y,u),j--):S&y?m.appendBits(S,u):(m.appendBits(S|1,u),j--)}return m}static totalBitsInLayer(l,u){return((u?88:112)+16*l)*l}}jr.DEFAULT_EC_PERCENT=33,jr.DEFAULT_AZTEC_LAYERS=0,jr.MAX_NB_BITS=32,jr.MAX_NB_BITS_COMPACT=4,jr.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Oc{encode(l,u,m,g){return this.encodeWithHints(l,u,m,g,null)}encodeWithHints(l,u,m,g,y){let j=rh.ISO_8859_1,S=jr.DEFAULT_EC_PERCENT,P=jr.DEFAULT_AZTEC_LAYERS;return y!=null&&(y.has(ja.CHARACTER_SET)&&(j=ai.forName(y.get(ja.CHARACTER_SET).toString())),y.has(ja.ERROR_CORRECTION)&&(S=k.parseInt(y.get(ja.ERROR_CORRECTION).toString())),y.has(ja.AZTEC_LAYERS)&&(P=k.parseInt(y.get(ja.AZTEC_LAYERS).toString()))),Oc.encodeLayers(l,u,m,g,j,S,P)}static encodeLayers(l,u,m,g,y,j,S){if(u!==xe.AZTEC)throw new x("Can only encode AZTEC, but got "+u);let P=jr.encode(Y.getBytes(l,y),j,S);return Oc.renderResult(P,m,g)}static renderResult(l,u,m){let g=l.getMatrix();if(g==null)throw new ot;let y=g.getWidth(),j=g.getHeight(),S=Math.max(u,y),P=Math.max(m,j),V=Math.min(S/y,P/j),K=(S-y*V)/2,se=(P-j*V)/2,ue=new je(S,P);for(let Ae=0,Ve=se;Ae<j;Ae++,Ve+=V)for(let $e=0,st=K;$e<y;$e++,st+=V)g.get($e,Ae)&&ue.setRegion(st,Ve,V,V);return ue}}r.AbstractExpandedDecoder=be,r.ArgumentException=p,r.ArithmeticException=Me,r.AztecCode=am,r.AztecCodeReader=qe,r.AztecCodeWriter=Oc,r.AztecDecoder=we,r.AztecDetector=us,r.AztecDetectorResult=ps,r.AztecEncoder=jr,r.AztecHighLevelEncoder=fl,r.AztecPoint=ts,r.BarcodeFormat=xe,r.Binarizer=N,r.BinaryBitmap=v,r.BitArray=I,r.BitMatrix=je,r.BitSource=Tc,r.BrowserAztecCodeReader=jt,r.BrowserBarcodeReader=Mi,r.BrowserCodeReader=ee,r.BrowserDatamatrixCodeReader=Qf,r.BrowserMultiFormatReader=N0,r.BrowserPDF417Reader=dl,r.BrowserQRCodeReader=C0,r.BrowserQRCodeSvgWriter=ul,r.CharacterSetECI=M,r.ChecksumException=b,r.Code128Reader=Re,r.Code39Reader=et,r.DataMatrixDecodedBitStreamParser=si,r.DataMatrixReader=Mr,r.DecodeHintType=O,r.DecoderResult=fe,r.DefaultGridSampler=It,r.DetectorResult=Lt,r.EAN13Reader=Xe,r.EncodeHintType=ja,r.Exception=h,r.FormatException=D,r.GenericGF=Ie,r.GenericGFPoly=ne,r.GlobalHistogramBinarizer=Z,r.GridSampler=Ke,r.GridSamplerInstance=Ut,r.HTMLCanvasElementLuminanceSource=le,r.HybridBinarizer=G,r.ITFReader=Ct,r.IllegalArgumentException=x,r.IllegalStateException=ot,r.InvertedLuminanceSource=re,r.LuminanceSource=Q,r.MathUtils=Le,r.MultiFormatOneDReader=Ln,r.MultiFormatReader=j0,r.MultiFormatWriter=Yl,r.NotFoundException=H,r.OneDReader=_t,r.PDF417DecodedBitStreamParser=ft,r.PDF417DecoderErrorCorrection=Ju,r.PDF417Reader=sn,r.PDF417ResultMetadata=sm,r.PerspectiveTransform=dt,r.PlanarYUVLuminanceSource=ao,r.QRCodeByteMatrix=Kd,r.QRCodeDataMask=pn,r.QRCodeDecodedBitStreamParser=sa,r.QRCodeDecoderErrorCorrectionLevel=mr,r.QRCodeDecoderFormatInformation=mn,r.QRCodeEncoder=Zr,r.QRCodeEncoderQRCode=Xl,r.QRCodeMaskUtil=fa,r.QRCodeMatrixUtil=Es,r.QRCodeMode=Ns,r.QRCodeReader=en,r.QRCodeVersion=Zt,r.QRCodeWriter=Do,r.RGBLuminanceSource=Zl,r.RSS14Reader=or,r.RSSExpandedReader=gt,r.ReaderException=ri,r.ReedSolomonDecoder=Se,r.ReedSolomonEncoder=rm,r.ReedSolomonException=Be,r.Result=ie,r.ResultMetadataType=me,r.ResultPoint=Ge,r.StringUtils=Y,r.UnsupportedOperationException=z,r.VideoInputDevice=ye,r.WhiteRectangleDetector=ns,r.WriterException=qr,r.ZXingArrays=A,r.ZXingCharset=ai,r.ZXingInteger=k,r.ZXingStandardCharsets=rh,r.ZXingStringBuilder=ae,r.ZXingStringEncoding=q,r.ZXingSystem=_,r.createAbstractExpandedDecoder=Mt,Object.defineProperty(r,"__esModule",{value:!0})})})(nw,nw.exports);var xa=nw.exports;const CY=qu(xa),EY=t6({__proto__:null,default:CY},[xa]);var rE=function(){function e(t,r,a){if(this.formatMap=new Map([[es.QR_CODE,xa.BarcodeFormat.QR_CODE],[es.AZTEC,xa.BarcodeFormat.AZTEC],[es.CODABAR,xa.BarcodeFormat.CODABAR],[es.CODE_39,xa.BarcodeFormat.CODE_39],[es.CODE_93,xa.BarcodeFormat.CODE_93],[es.CODE_128,xa.BarcodeFormat.CODE_128],[es.DATA_MATRIX,xa.BarcodeFormat.DATA_MATRIX],[es.MAXICODE,xa.BarcodeFormat.MAXICODE],[es.ITF,xa.BarcodeFormat.ITF],[es.EAN_13,xa.BarcodeFormat.EAN_13],[es.EAN_8,xa.BarcodeFormat.EAN_8],[es.PDF_417,xa.BarcodeFormat.PDF_417],[es.RSS_14,xa.BarcodeFormat.RSS_14],[es.RSS_EXPANDED,xa.BarcodeFormat.RSS_EXPANDED],[es.UPC_A,xa.BarcodeFormat.UPC_A],[es.UPC_E,xa.BarcodeFormat.UPC_E],[es.UPC_EAN_EXTENSION,xa.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!EY)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=r,this.logger=a;var n=this.createZXingFormats(t),i=new Map;i.set(xa.DecodeHintType.POSSIBLE_FORMATS,n),i.set(xa.DecodeHintType.TRY_HARDER,!1),this.hints=i}return e.prototype.decodeAsync=function(t){var r=this;return new Promise(function(a,n){try{a(r.decode(t))}catch(i){n(i)}})},e.prototype.decode=function(t){var r=new xa.MultiFormatReader(this.verbose,this.hints),a=new xa.HTMLCanvasElementLuminanceSource(t),n=new xa.BinaryBitmap(new xa.HybridBinarizer(a)),i=r.decode(n);return{text:i.text,format:sP.create(this.toHtml5QrcodeSupportedFormats(i.format)),debugData:this.createDebugData()}},e.prototype.createReverseFormatMap=function(){var t=new Map;return this.formatMap.forEach(function(r,a,n){t.set(r,a)}),t},e.prototype.toHtml5QrcodeSupportedFormats=function(t){if(!this.reverseFormatMap.has(t))throw"reverseFormatMap doesn't have ".concat(t);return this.reverseFormatMap.get(t)},e.prototype.createZXingFormats=function(t){for(var r=[],a=0,n=t;a<n.length;a++){var i=n[a];this.formatMap.has(i)?r.push(this.formatMap.get(i)):this.logger.logError("".concat(i," is not supported by")+"ZXingHtml5QrcodeShim")}return r},e.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},e}(),SY=function(e,t,r,a){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function c(p){try{h(a.next(p))}catch(x){o(x)}}function d(p){try{h(a.throw(p))}catch(x){o(x)}}function h(p){p.done?i(p.value):n(p.value).then(c,d)}h((a=a.apply(e,t||[])).next())})},TY=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},a,n,i,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(h){return function(p){return d([h,p])}}function d(h){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,h[0]&&(r=0)),r;)try{if(a=1,n&&(i=h[0]&2?n.return:h[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,h[1])).done)return i;switch(n=0,i&&(h=[h[0]&2,i.value]),h[0]){case 0:case 1:i=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,n=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!i||h[1]>i[0]&&h[1]<i[3])){r.label=h[1];break}if(h[0]===6&&r.label<i[1]){r.label=i[1],i=h;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(h);break}i[2]&&r.ops.pop(),r.trys.pop();continue}h=t.call(e,r)}catch(p){h=[6,p],n=0}finally{a=i=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},aE=function(){function e(t,r,a){if(this.formatMap=new Map([[es.QR_CODE,"qr_code"],[es.AZTEC,"aztec"],[es.CODABAR,"codabar"],[es.CODE_39,"code_39"],[es.CODE_93,"code_93"],[es.CODE_128,"code_128"],[es.DATA_MATRIX,"data_matrix"],[es.ITF,"itf"],[es.EAN_13,"ean_13"],[es.EAN_8,"ean_8"],[es.PDF_417,"pdf417"],[es.UPC_A,"upc_a"],[es.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!e.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=r,this.logger=a;var n=this.createBarcodeDetectorFormats(t);if(this.detector=new BarcodeDetector(n),!this.detector)throw"BarcodeDetector detector not supported"}return e.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var t=new BarcodeDetector({formats:["qr_code"]});return typeof t<"u"},e.prototype.decodeAsync=function(t){return SY(this,void 0,void 0,function(){var r,a;return TY(this,function(n){switch(n.label){case 0:return[4,this.detector.detect(t)];case 1:if(r=n.sent(),!r||r.length===0)throw"No barcode or QR code detected.";return a=this.selectLargestBarcode(r),[2,{text:a.rawValue,format:sP.create(this.toHtml5QrcodeSupportedFormats(a.format)),debugData:this.createDebugData()}]}})})},e.prototype.selectLargestBarcode=function(t){for(var r=null,a=0,n=0,i=t;n<i.length;n++){var o=i[n],c=o.boundingBox.width*o.boundingBox.height;c>a&&(a=c,r=o)}if(!r)throw"No largest barcode found";return r},e.prototype.createBarcodeDetectorFormats=function(t){for(var r=[],a=0,n=t;a<n.length;a++){var i=n[a];this.formatMap.has(i)?r.push(this.formatMap.get(i)):this.logger.warn("".concat(i," is not supported by")+"BarcodeDetectorDelegate")}return{formats:r}},e.prototype.toHtml5QrcodeSupportedFormats=function(t){if(!this.reverseFormatMap.has(t))throw"reverseFormatMap doesn't have ".concat(t);return this.reverseFormatMap.get(t)},e.prototype.createReverseFormatMap=function(){var t=new Map;return this.formatMap.forEach(function(r,a,n){t.set(r,a)}),t},e.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},e}(),nE=function(e,t,r,a){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function c(p){try{h(a.next(p))}catch(x){o(x)}}function d(p){try{h(a.throw(p))}catch(x){o(x)}}function h(p){p.done?i(p.value):n(p.value).then(c,d)}h((a=a.apply(e,t||[])).next())})},iE=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},a,n,i,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(h){return function(p){return d([h,p])}}function d(h){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,h[0]&&(r=0)),r;)try{if(a=1,n&&(i=h[0]&2?n.return:h[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,h[1])).done)return i;switch(n=0,i&&(h=[h[0]&2,i.value]),h[0]){case 0:case 1:i=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,n=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!i||h[1]>i[0]&&h[1]<i[3])){r.label=h[1];break}if(h[0]===6&&r.label<i[1]){r.label=i[1],i=h;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(h);break}i[2]&&r.ops.pop(),r.trys.pop();continue}h=t.call(e,r)}catch(p){h=[6,p],n=0}finally{a=i=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},AY=function(){function e(t,r,a,n){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=a,r&&aE.isSupported()?(this.primaryDecoder=new aE(t,a,n),this.secondaryDecoder=new rE(t,a,n)):this.primaryDecoder=new rE(t,a,n)}return e.prototype.decodeAsync=function(t){return nE(this,void 0,void 0,function(){var r;return iE(this,function(a){switch(a.label){case 0:r=performance.now(),a.label=1;case 1:return a.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(t)];case 2:return[2,a.sent()];case 3:return this.possiblyLogPerformance(r),[7];case 4:return[2]}})})},e.prototype.decodeRobustlyAsync=function(t){return nE(this,void 0,void 0,function(){var r,a;return iE(this,function(n){switch(n.label){case 0:r=performance.now(),n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(t)];case 2:return[2,n.sent()];case 3:if(a=n.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(t)];throw a;case 4:return this.possiblyLogPerformance(r),[7];case 5:return[2]}})})},e.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},e.prototype.possiblyLogPerformance=function(t){if(this.verbose){var r=performance.now()-t;this.executionResults.push(r),this.executions++,this.possiblyFlushPerformanceReport()}},e.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var t=0,r=0,a=this.executionResults;r<a.length;r++){var n=a[r];t+=n}var i=t/this.executionResults.length;console.log("".concat(i," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},e}(),j_=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,n){a.__proto__=n}||function(a,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(a[i]=n[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function a(){this.constructor=t}t.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)}}(),Qx=function(e,t,r,a){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function c(p){try{h(a.next(p))}catch(x){o(x)}}function d(p){try{h(a.throw(p))}catch(x){o(x)}}function h(p){p.done?i(p.value):n(p.value).then(c,d)}h((a=a.apply(e,t||[])).next())})},Jx=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},a,n,i,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(h){return function(p){return d([h,p])}}function d(h){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,h[0]&&(r=0)),r;)try{if(a=1,n&&(i=h[0]&2?n.return:h[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,h[1])).done)return i;switch(n=0,i&&(h=[h[0]&2,i.value]),h[0]){case 0:case 1:i=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,n=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!i||h[1]>i[0]&&h[1]<i[3])){r.label=h[1];break}if(h[0]===6&&r.label<i[1]){r.label=i[1],i=h;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(h);break}i[2]&&r.ops.pop(),r.trys.pop();continue}h=t.call(e,r)}catch(p){h=[6,p],n=0}finally{a=i=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},aP=function(){function e(t,r){this.name=t,this.track=r}return e.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},e.prototype.apply=function(t){var r={};r[this.name]=t;var a={advanced:[r]};return this.track.applyConstraints(a)},e.prototype.value=function(){var t=this.track.getSettings();if(this.name in t){var r=t[this.name];return r}return null},e}(),kY=function(e){j_(t,e);function t(r,a){return e.call(this,r,a)||this}return t.prototype.min=function(){return this.getCapabilities().min},t.prototype.max=function(){return this.getCapabilities().max},t.prototype.step=function(){return this.getCapabilities().step},t.prototype.apply=function(r){var a={};a[this.name]=r;var n={advanced:[a]};return this.track.applyConstraints(n)},t.prototype.getCapabilities=function(){this.failIfNotSupported();var r=this.track.getCapabilities(),a=r[this.name];return{min:a.min,max:a.max,step:a.step}},t.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},t}(aP),RY=function(e){j_(t,e);function t(r){return e.call(this,"zoom",r)||this}return t}(kY),PY=function(e){j_(t,e);function t(r){return e.call(this,"torch",r)||this}return t}(aP),IY=function(){function e(t){this.track=t}return e.prototype.zoomFeature=function(){return new RY(this.track)},e.prototype.torchFeature=function(){return new PY(this.track)},e}(),OY=function(){function e(t,r,a){this.isClosed=!1,this.parentElement=t,this.mediaStream=r,this.callbacks=a,this.surface=this.createVideoElement(this.parentElement.clientWidth),t.append(this.surface)}return e.prototype.createVideoElement=function(t){var r=document.createElement("video");return r.style.width="".concat(t,"px"),r.style.display="block",r.muted=!0,r.setAttribute("muted","true"),r.playsInline=!0,r},e.prototype.setupSurface=function(){var t=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var r=function(){var a=t.surface.clientWidth,n=t.surface.clientHeight;t.callbacks.onRenderSurfaceReady(a,n),t.surface.removeEventListener("playing",r)};this.surface.addEventListener("playing",r),this.surface.srcObject=this.mediaStream,this.surface.play()},e.create=function(t,r,a,n){return Qx(this,void 0,void 0,function(){var i,o;return Jx(this,function(c){switch(c.label){case 0:return i=new e(t,r,n),a.aspectRatio?(o={aspectRatio:a.aspectRatio},[4,i.getFirstTrackOrFail().applyConstraints(o)]):[3,2];case 1:c.sent(),c.label=2;case 2:return i.setupSurface(),[2,i]}})})},e.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},e.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},e.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},e.prototype.resume=function(t){this.failIfClosed();var r=this,a=function(){setTimeout(t,200),r.surface.removeEventListener("playing",a)};this.surface.addEventListener("playing",a),this.surface.play()},e.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},e.prototype.getSurface=function(){return this.failIfClosed(),this.surface},e.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},e.prototype.applyVideoConstraints=function(t){return Qx(this,void 0,void 0,function(){return Jx(this,function(r){if("aspectRatio"in t)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(t)]})})},e.prototype.close=function(){if(this.isClosed)return Promise.resolve();var t=this;return new Promise(function(r,a){var n=t.mediaStream.getVideoTracks(),i=n.length,o=0;t.mediaStream.getVideoTracks().forEach(function(c){t.mediaStream.removeTrack(c),c.stop(),++o,o>=i&&(t.isClosed=!0,t.parentElement.removeChild(t.surface),r())})})},e.prototype.getCapabilities=function(){return new IY(this.getFirstTrackOrFail())},e}(),DY=function(){function e(t){this.mediaStream=t}return e.prototype.render=function(t,r,a){return Qx(this,void 0,void 0,function(){return Jx(this,function(n){return[2,OY.create(t,this.mediaStream,r,a)]})})},e.create=function(t){return Qx(this,void 0,void 0,function(){var r,a;return Jx(this,function(n){switch(n.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return r={audio:!1,video:t},[4,navigator.mediaDevices.getUserMedia(r)];case 1:return a=n.sent(),[2,new e(a)]}})})},e}(),oE=function(e,t,r,a){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function c(p){try{h(a.next(p))}catch(x){o(x)}}function d(p){try{h(a.throw(p))}catch(x){o(x)}}function h(p){p.done?i(p.value):n(p.value).then(c,d)}h((a=a.apply(e,t||[])).next())})},lE=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},a,n,i,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(h){return function(p){return d([h,p])}}function d(h){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,h[0]&&(r=0)),r;)try{if(a=1,n&&(i=h[0]&2?n.return:h[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,h[1])).done)return i;switch(n=0,i&&(h=[h[0]&2,i.value]),h[0]){case 0:case 1:i=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,n=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!i||h[1]>i[0]&&h[1]<i[3])){r.label=h[1];break}if(h[0]===6&&r.label<i[1]){r.label=i[1],i=h;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(h);break}i[2]&&r.ops.pop(),r.trys.pop();continue}h=t.call(e,r)}catch(p){h=[6,p],n=0}finally{a=i=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},MY=function(){function e(){}return e.failIfNotSupported=function(){return oE(this,void 0,void 0,function(){return lE(this,function(t){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new e]})})},e.prototype.create=function(t){return oE(this,void 0,void 0,function(){return lE(this,function(r){return[2,DY.create(t)]})})},e}(),LY=function(e,t,r,a){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function c(p){try{h(a.next(p))}catch(x){o(x)}}function d(p){try{h(a.throw(p))}catch(x){o(x)}}function h(p){p.done?i(p.value):n(p.value).then(c,d)}h((a=a.apply(e,t||[])).next())})},FY=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},a,n,i,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(h){return function(p){return d([h,p])}}function d(h){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,h[0]&&(r=0)),r;)try{if(a=1,n&&(i=h[0]&2?n.return:h[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,h[1])).done)return i;switch(n=0,i&&(h=[h[0]&2,i.value]),h[0]){case 0:case 1:i=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,n=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!i||h[1]>i[0]&&h[1]<i[3])){r.label=h[1];break}if(h[0]===6&&r.label<i[1]){r.label=i[1],i=h;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(h);break}i[2]&&r.ops.pop(),r.trys.pop();continue}h=t.call(e,r)}catch(p){h=[6,p],n=0}finally{a=i=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},BY=function(){function e(){}return e.retrieve=function(){if(navigator.mediaDevices)return e.getCamerasFromMediaDevices();var t=MediaStreamTrack;return MediaStreamTrack&&t.getSources?e.getCamerasFromMediaStreamTrack():e.rejectWithError()},e.rejectWithError=function(){var t=Ih.unableToQuerySupportedDevices();return e.isHttpsOrLocalhost()||(t=Ih.insecureContextCameraQueryError()),Promise.reject(t)},e.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var t=location.host.split(":")[0];return t==="127.0.0.1"||t==="localhost"},e.getCamerasFromMediaDevices=function(){return LY(this,void 0,void 0,function(){var t,r,a,n,i,o,c;return FY(this,function(d){switch(d.label){case 0:return t=function(h){for(var p=h.getVideoTracks(),x=0,v=p;x<v.length;x++){var b=v[x];b.enabled=!1,b.stop(),h.removeTrack(b)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return r=d.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(a=d.sent(),n=[],i=0,o=a;i<o.length;i++)c=o[i],c.kind==="videoinput"&&n.push({id:c.deviceId,label:c.label});return t(r),[2,n]}})})},e.getCamerasFromMediaStreamTrack=function(){return new Promise(function(t,r){var a=function(i){for(var o=[],c=0,d=i;c<d.length;c++){var h=d[c];h.kind==="video"&&o.push({id:h.id,label:h.label})}t(o)},n=MediaStreamTrack;n.getSources(a)})},e}(),wa;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.NOT_STARTED=1]="NOT_STARTED",e[e.SCANNING=2]="SCANNING",e[e.PAUSED=3]="PAUSED"})(wa||(wa={}));var VY=function(){function e(){this.state=wa.NOT_STARTED,this.onGoingTransactionNewState=wa.UNKNOWN}return e.prototype.directTransition=function(t){this.failIfTransitionOngoing(),this.validateTransition(t),this.state=t},e.prototype.startTransition=function(t){return this.failIfTransitionOngoing(),this.validateTransition(t),this.onGoingTransactionNewState=t,this},e.prototype.execute=function(){if(this.onGoingTransactionNewState===wa.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var t=this.onGoingTransactionNewState;this.onGoingTransactionNewState=wa.UNKNOWN,this.directTransition(t)},e.prototype.cancel=function(){if(this.onGoingTransactionNewState===wa.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=wa.UNKNOWN},e.prototype.getState=function(){return this.state},e.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==wa.UNKNOWN)throw"Cannot transition to a new state, already under transition"},e.prototype.validateTransition=function(t){switch(this.state){case wa.UNKNOWN:throw"Transition from unknown is not allowed";case wa.NOT_STARTED:this.failIfNewStateIs(t,[wa.PAUSED]);break;case wa.SCANNING:break;case wa.PAUSED:break}},e.prototype.failIfNewStateIs=function(t,r){for(var a=0,n=r;a<n.length;a++){var i=n[a];if(t===i)throw"Cannot transition from ".concat(this.state," to ").concat(t)}},e}(),UY=function(){function e(t){this.stateManager=t}return e.prototype.startTransition=function(t){return this.stateManager.startTransition(t)},e.prototype.directTransition=function(t){this.stateManager.directTransition(t)},e.prototype.getState=function(){return this.stateManager.getState()},e.prototype.canScanFile=function(){return this.stateManager.getState()===wa.NOT_STARTED},e.prototype.isScanning=function(){return this.stateManager.getState()!==wa.NOT_STARTED},e.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===wa.SCANNING},e.prototype.isPaused=function(){return this.stateManager.getState()===wa.PAUSED},e}(),zY=function(){function e(){}return e.create=function(){return new UY(new VY)},e}(),$Y=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,n){a.__proto__=n}||function(a,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(a[i]=n[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function a(){this.constructor=t}t.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)}}(),Ui=function(e){$Y(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.DEFAULT_WIDTH=300,t.DEFAULT_WIDTH_OFFSET=2,t.FILE_SCAN_MIN_HEIGHT=300,t.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,t.MIN_QR_BOX_SIZE=50,t.SHADED_LEFT=1,t.SHADED_RIGHT=2,t.SHADED_TOP=3,t.SHADED_BOTTOM=4,t.SHADED_REGION_ELEMENT_ID="qr-shaded-region",t.VERBOSE=!1,t.BORDER_SHADER_DEFAULT_COLOR="#ffffff",t.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",t}(_Y),qY=function(){function e(t,r){this.logger=r,this.fps=Ui.SCAN_DEFAULT_FPS,t?(t.fps&&(this.fps=t.fps),this.disableFlip=t.disableFlip===!0,this.qrbox=t.qrbox,this.aspectRatio=t.aspectRatio,this.videoConstraints=t.videoConstraints):this.disableFlip=Ui.DEFAULT_DISABLE_FLIP}return e.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?rP.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},e.prototype.isShadedBoxEnabled=function(){return!ac(this.qrbox)},e.create=function(t,r){return new e(t,r)},e}(),nP=function(){function e(t,r){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(t))throw"HTML Element with id=".concat(t," not found");this.elementId=t,this.verbose=!1;var a;typeof r=="boolean"?this.verbose=r===!0:r&&(a=r,this.verbose=a.verbose===!0,a.experimentalFeatures),this.logger=new NY(this.verbose),this.qrcode=new AY(this.getSupportedFormats(r),this.getUseBarCodeDetectorIfSupported(a),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=zY.create()}return e.prototype.start=function(t,r,a,n){var i=this;if(!t)throw"cameraIdOrConfig is required";if(!a||typeof a!="function")throw"qrCodeSuccessCallback is required and should be a function.";var o;n?o=n:o=this.verbose?this.logger.log:function(){};var c=qY.create(r,this.logger);this.clearElement();var d=!1;c.videoConstraints&&(c.isMediaStreamConstraintsValid()?d=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var h=d,p=document.getElementById(this.elementId);p.clientWidth?p.clientWidth:Ui.DEFAULT_WIDTH,p.style.position="relative",this.shouldScan=!0,this.element=p;var x=this,v=this.stateManagerProxy.startTransition(wa.SCANNING);return new Promise(function(b,N){var _=h?c.videoConstraints:x.createVideoConstraints(t);if(!_){v.cancel(),N("videoConstraints should be defined");return}var C={};(!h||c.aspectRatio)&&(C.aspectRatio=c.aspectRatio);var T={onRenderSurfaceReady:function(A,k){x.setupUi(A,k,c),x.isScanning=!0,x.foreverScan(c,a,o)}};MY.failIfNotSupported().then(function(A){A.create(_).then(function(k){return k.render(i.element,C,T).then(function(I){x.renderedCamera=I,v.execute(),b(null)}).catch(function(I){v.cancel(),N(I)})}).catch(function(k){v.cancel(),N(Ih.errorGettingUserMedia(k))})}).catch(function(A){v.cancel(),N(Ih.cameraStreamingNotSupported())})})},e.prototype.pause=function(t){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(wa.PAUSED),this.showPausedState(),(ac(t)||t!==!0)&&(t=!1),t&&this.renderedCamera&&this.renderedCamera.pause()},e.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var t=this,r=function(){t.stateManagerProxy.directTransition(wa.SCANNING),t.hidePausedState()};if(!this.renderedCamera.isPaused()){r();return}this.renderedCamera.resume(function(){r()})},e.prototype.getState=function(){return this.stateManagerProxy.getState()},e.prototype.stop=function(){var t=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var r=this.stateManagerProxy.startTransition(wa.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var a=function(){if(t.element){var i=document.getElementById(Ui.SHADED_REGION_ELEMENT_ID);i&&t.element.removeChild(i)}},n=this;return this.renderedCamera.close().then(function(){return n.renderedCamera=null,n.element&&(n.element.removeChild(n.canvasElement),n.canvasElement=null),a(),n.qrRegion&&(n.qrRegion=null),n.context&&(n.context=null),r.execute(),n.hidePausedState(),n.isScanning=!1,Promise.resolve()})},e.prototype.scanFile=function(t,r){return this.scanFileV2(t,r).then(function(a){return a.decodedText})},e.prototype.scanFileV2=function(t,r){var a=this;if(!t||!(t instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(ac(r)&&(r=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(n,i){a.possiblyCloseLastScanImageFile(),a.clearElement(),a.lastScanImageFile=URL.createObjectURL(t);var o=new Image;o.onload=function(){var c=o.width,d=o.height,h=document.getElementById(a.elementId),p=h.clientWidth?h.clientWidth:Ui.DEFAULT_WIDTH,x=Math.max(h.clientHeight?h.clientHeight:d,Ui.FILE_SCAN_MIN_HEIGHT),v=a.computeCanvasDrawConfig(c,d,p,x);if(r){var b=a.createCanvasElement(p,x,"qr-canvas-visible");b.style.display="inline-block",h.appendChild(b);var N=b.getContext("2d");if(!N)throw"Unable to get 2d context from canvas";N.canvas.width=p,N.canvas.height=x,N.drawImage(o,0,0,c,d,v.x,v.y,v.width,v.height)}var _=Ui.FILE_SCAN_HIDDEN_CANVAS_PADDING,C=Math.max(o.width,v.width),T=Math.max(o.height,v.height),A=C+2*_,k=T+2*_,I=a.createCanvasElement(A,k);h.appendChild(I);var B=I.getContext("2d");if(!B)throw"Unable to get 2d context from canvas";B.canvas.width=A,B.canvas.height=k,B.drawImage(o,0,0,c,d,_,_,C,T);try{a.qrcode.decodeRobustlyAsync(I).then(function(O){n(sE.createFromQrcodeResult(O))}).catch(i)}catch(O){i("QR code parse error, error = ".concat(O))}},o.onerror=i,o.onabort=i,o.onstalled=i,o.onsuspend=i,o.src=URL.createObjectURL(t)})},e.prototype.clear=function(){this.clearElement()},e.getCameras=function(){return BY.retrieve()},e.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},e.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},e.prototype.applyVideoConstraints=function(t){if(t){if(!rP.isMediaStreamConstraintsValid(t,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(t)},e.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},e.prototype.getSupportedFormats=function(t){var r=[es.QR_CODE,es.AZTEC,es.CODABAR,es.CODE_39,es.CODE_93,es.CODE_128,es.DATA_MATRIX,es.MAXICODE,es.ITF,es.EAN_13,es.EAN_8,es.PDF_417,es.RSS_14,es.RSS_EXPANDED,es.UPC_A,es.UPC_E,es.UPC_EAN_EXTENSION];if(!t||typeof t=="boolean"||!t.formatsToSupport)return r;if(!Array.isArray(t.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(t.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var a=[],n=0,i=t.formatsToSupport;n<i.length;n++){var o=i[n];bY(o)?a.push(o):this.logger.warn("Invalid format: ".concat(o," passed in config, ignoring."))}if(a.length===0)throw"None of formatsToSupport match supported values.";return a},e.prototype.getUseBarCodeDetectorIfSupported=function(t){if(ac(t))return!0;if(!ac(t.useBarCodeDetectorIfSupported))return t.useBarCodeDetectorIfSupported!==!1;if(ac(t.experimentalFeatures))return!0;var r=t.experimentalFeatures;return ac(r.useBarCodeDetectorIfSupported)?!0:r.useBarCodeDetectorIfSupported!==!1},e.prototype.validateQrboxSize=function(t,r,a){var n=this,i=a.qrbox;this.validateQrboxConfig(i);var o=this.toQrdimensions(t,r,i),c=function(h){if(h<Ui.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(Ui.MIN_QR_BOX_SIZE,"px.")},d=function(h){return h>t&&(n.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),h=t),h};c(o.width),c(o.height),o.width=d(o.width)},e.prototype.validateQrboxConfig=function(t){if(typeof t!="number"&&typeof t!="function"&&(t.width===void 0||t.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},e.prototype.toQrdimensions=function(t,r,a){if(typeof a=="number")return{width:a,height:a};if(typeof a=="function")try{return a(t,r)}catch(n){throw new Error("qrbox config was passed as a function but it failed with unknown error"+n)}return a},e.prototype.setupUi=function(t,r,a){a.isShadedBoxEnabled()&&this.validateQrboxSize(t,r,a);var n=ac(a.qrbox)?{width:t,height:r}:a.qrbox;this.validateQrboxConfig(n);var i=this.toQrdimensions(t,r,n);i.height>r&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var o=a.isShadedBoxEnabled()&&i.height<=r,c={x:0,y:0,width:t,height:r},d=o?this.getShadedRegionBounds(t,r,i):c,h=this.createCanvasElement(d.width,d.height),p={willReadFrequently:!0},x=h.getContext("2d",p);x.canvas.width=d.width,x.canvas.height=d.height,this.element.append(h),o&&this.possiblyInsertShadingElement(this.element,t,r,i),this.createScannerPausedUiElement(this.element),this.qrRegion=d,this.context=x,this.canvasElement=h},e.prototype.createScannerPausedUiElement=function(t){var r=document.createElement("div");r.innerText=Ih.scannerPaused(),r.style.display="none",r.style.position="absolute",r.style.top="0px",r.style.zIndex="1",r.style.background="rgba(9, 9, 9, 0.46)",r.style.color="#FFECEC",r.style.textAlign="center",r.style.width="100%",t.appendChild(r),this.scannerPausedUiElement=r},e.prototype.scanContext=function(t,r){var a=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(n){return t(n.text,sE.createFromQrcodeResult(n)),a.possiblyUpdateShaders(!0),!0}).catch(function(n){a.possiblyUpdateShaders(!1);var i=Ih.codeParseError(n);return r(i,jY.createFrom(i)),!1})},e.prototype.foreverScan=function(t,r,a){var n=this;if(this.shouldScan&&this.renderedCamera){var i=this.renderedCamera.getSurface(),o=i.videoWidth/i.clientWidth,c=i.videoHeight/i.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var d=this.qrRegion.width*o,h=this.qrRegion.height*c,p=this.qrRegion.x*o,x=this.qrRegion.y*c;this.context.drawImage(i,p,x,d,h,0,0,this.qrRegion.width,this.qrRegion.height);var v=function(){n.foreverScanTimeout=setTimeout(function(){n.foreverScan(t,r,a)},n.getTimeoutFps(t.fps))};this.scanContext(r,a).then(function(b){!b&&t.disableFlip!==!0?(n.context.translate(n.context.canvas.width,0),n.context.scale(-1,1),n.scanContext(r,a).finally(function(){v()})):v()}).catch(function(b){n.logger.logError("Error happend while scanning context",b),v()})}},e.prototype.createVideoConstraints=function(t){if(typeof t=="string")return{deviceId:{exact:t}};if(typeof t=="object"){var r="facingMode",a="deviceId",n={user:!0,environment:!0},i="exact",o=function(N){if(N in n)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(N,"'")},c=Object.keys(t);if(c.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(c.length," keys");var d=Object.keys(t)[0];if(d!==r&&d!==a)throw"Only '".concat(r,"' and '").concat(a,"' ")+" are supported for 'cameraIdOrConfig'";if(d===r){var h=t.facingMode;if(typeof h=="string"){if(o(h))return{facingMode:h}}else if(typeof h=="object")if(i in h){if(o(h["".concat(i)]))return{facingMode:{exact:h["".concat(i)]}}}else throw"'facingMode' should be string or object with"+" ".concat(i," as key.");else{var p=typeof h;throw"Invalid type of 'facingMode' = ".concat(p)}}else{var x=t.deviceId;if(typeof x=="string")return{deviceId:x};if(typeof x=="object"){if(i in x)return{deviceId:{exact:x["".concat(i)]}};throw"'deviceId' should be string or object with"+" ".concat(i," as key.")}else{var v=typeof x;throw"Invalid type of 'deviceId' = ".concat(v)}}}var b=typeof t;throw"Invalid type of 'cameraIdOrConfig' = ".concat(b)},e.prototype.computeCanvasDrawConfig=function(t,r,a,n){if(t<=a&&r<=n){var i=(a-t)/2,o=(n-r)/2;return{x:i,y:o,width:t,height:r}}else{var c=t,d=r;return t>a&&(r=a/t*r,t=a),r>n&&(t=n/r*t,r=n),this.logger.log("Image downsampled from "+"".concat(c,"X").concat(d)+" to ".concat(t,"X").concat(r,".")),this.computeCanvasDrawConfig(t,r,a,n)}},e.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var t=document.getElementById(this.elementId);t&&(t.innerHTML="")},e.prototype.possiblyUpdateShaders=function(t){this.qrMatch!==t&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(r){r.style.backgroundColor=t?Ui.BORDER_SHADER_MATCH_COLOR:Ui.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=t)},e.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},e.prototype.createCanvasElement=function(t,r,a){var n=t,i=r,o=document.createElement("canvas");return o.style.width="".concat(n,"px"),o.style.height="".concat(i,"px"),o.style.display="none",o.id=ac(a)?"qr-canvas":a,o},e.prototype.getShadedRegionBounds=function(t,r,a){if(a.width>t||a.height>r)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(t-a.width)/2,y:(r-a.height)/2,width:a.width,height:a.height}},e.prototype.possiblyInsertShadingElement=function(t,r,a,n){if(!(r-n.width<1||a-n.height<1)){var i=document.createElement("div");i.style.position="absolute";var o=(r-n.width)/2,c=(a-n.height)/2;if(i.style.borderLeft="".concat(o,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderRight="".concat(o,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderTop="".concat(c,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderBottom="".concat(c,"px solid rgba(0, 0, 0, 0.48)"),i.style.boxSizing="border-box",i.style.top="0px",i.style.bottom="0px",i.style.left="0px",i.style.right="0px",i.id="".concat(Ui.SHADED_REGION_ELEMENT_ID),r-n.width<11||a-n.height<11)this.hasBorderShaders=!1;else{var d=5,h=40;this.insertShaderBorders(i,h,d,-d,null,0,!0),this.insertShaderBorders(i,h,d,-d,null,0,!1),this.insertShaderBorders(i,h,d,null,-d,0,!0),this.insertShaderBorders(i,h,d,null,-d,0,!1),this.insertShaderBorders(i,d,h+d,-d,null,-d,!0),this.insertShaderBorders(i,d,h+d,null,-d,-d,!0),this.insertShaderBorders(i,d,h+d,-d,null,-d,!1),this.insertShaderBorders(i,d,h+d,null,-d,-d,!1),this.hasBorderShaders=!0}t.append(i)}},e.prototype.insertShaderBorders=function(t,r,a,n,i,o,c){var d=document.createElement("div");d.style.position="absolute",d.style.backgroundColor=Ui.BORDER_SHADER_DEFAULT_COLOR,d.style.width="".concat(r,"px"),d.style.height="".concat(a,"px"),n!==null&&(d.style.top="".concat(n,"px")),i!==null&&(d.style.bottom="".concat(i,"px")),c?d.style.left="".concat(o,"px"):d.style.right="".concat(o,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(d),t.appendChild(d)},e.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},e.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},e.prototype.getTimeoutFps=function(t){return 1e3/t},e}(),cE;(function(e){e[e.STATUS_DEFAULT=0]="STATUS_DEFAULT",e[e.STATUS_SUCCESS=1]="STATUS_SUCCESS",e[e.STATUS_WARNING=2]="STATUS_WARNING",e[e.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(cE||(cE={}));function dE({onScan:e,onCancel:t,mode:r}){const a=E.useRef(null),[n,i]=E.useState(!1),[o,c]=E.useState(!1),d=async()=>{try{const x=new nP("scanner-container");a.current=x;const v=r==="qrcode"?{fps:10,qrbox:{width:300,height:300},formatsToSupport:[es.QR_CODE,es.DATA_MATRIX]}:{fps:10,qrbox:{width:400,height:200},formatsToSupport:[es.CODE_128,es.CODE_39,es.EAN_13,es.ITF,es.CODE_93]};await x.start({facingMode:"environment"},v,b=>{p(),e(b)},b=>{})}catch(x){console.error("[BarcodeScanner] Erro ao iniciar scanner:",x),i(!1),c(!1)}},h=()=>{i(!0),c(!0)},p=async()=>{if(a.current)try{a.current.getState()===2&&await a.current.stop(),a.current.clear()}catch{}i(!1)};return E.useEffect(()=>{o&&n&&(d(),c(!1))},[o,n]),E.useEffect(()=>()=>{p()},[]),s.jsx("div",{className:"space-y-4",children:n?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-center p-4 bg-muted/50 rounded-lg",children:[s.jsx(_s,{className:"h-5 w-5 animate-spin mr-2"}),s.jsxs("span",{className:"text-sm text-muted-foreground",children:["Procurando ",r==="qrcode"?"QR Code":"cdigo de barras","..."]})]}),s.jsx("div",{id:"scanner-container",className:"w-full rounded-lg overflow-hidden border-2 border-primary/20"})]}),s.jsx(oe,{variant:"outline",onClick:()=>{p(),t()},className:"w-full",children:"Cancelar Scan"})]}):s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(oe,{onClick:h,className:"flex-1",children:[s.jsx(M6,{className:"mr-2 h-4 w-4"}),r==="qrcode"?"Escanear QR Code":"Escanear Cdigo de Barras"]}),s.jsx(oe,{variant:"outline",onClick:t,children:s.jsx(Jr,{className:"h-4 w-4"})})]})})}var Kg="Switch",[WY,Hue]=bi(Kg),[HY,GY]=WY(Kg),iP=E.forwardRef((e,t)=>{const{__scopeSwitch:r,name:a,checked:n,defaultChecked:i,required:o,disabled:c,value:d="on",onCheckedChange:h,form:p,...x}=e,[v,b]=E.useState(null),N=br(t,k=>b(k)),_=E.useRef(!1),C=v?p||!!v.closest("form"):!0,[T,A]=No({prop:n,defaultProp:i??!1,onChange:h,caller:Kg});return s.jsxs(HY,{scope:r,checked:T,disabled:c,children:[s.jsx(ys.button,{type:"button",role:"switch","aria-checked":T,"aria-required":o,"data-state":dP(T),"data-disabled":c?"":void 0,disabled:c,value:d,...x,ref:N,onClick:Ts(e.onClick,k=>{A(I=>!I),C&&(_.current=k.isPropagationStopped(),_.current||k.stopPropagation())})}),C&&s.jsx(cP,{control:v,bubbles:!_.current,name:a,value:d,checked:T,required:o,disabled:c,form:p,style:{transform:"translateX(-100%)"}})]})});iP.displayName=Kg;var oP="SwitchThumb",lP=E.forwardRef((e,t)=>{const{__scopeSwitch:r,...a}=e,n=GY(oP,r);return s.jsx(ys.span,{"data-state":dP(n.checked),"data-disabled":n.disabled?"":void 0,...a,ref:t})});lP.displayName=oP;var KY="SwitchBubbleInput",cP=E.forwardRef(({__scopeSwitch:e,control:t,checked:r,bubbles:a=!0,...n},i)=>{const o=E.useRef(null),c=br(o,i),d=Gp(r),h=_g(t);return E.useEffect(()=>{const p=o.current;if(!p)return;const x=window.HTMLInputElement.prototype,b=Object.getOwnPropertyDescriptor(x,"checked").set;if(d!==r&&b){const N=new Event("click",{bubbles:a});b.call(p,r),p.dispatchEvent(N)}},[d,r,a]),s.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...n,tabIndex:-1,ref:c,style:{...n.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});cP.displayName=KY;function dP(e){return e?"checked":"unchecked"}var uP=iP,XY=lP;const fi=E.forwardRef(({className:e,...t},r)=>s.jsx(uP,{className:pt("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",e),...t,ref:r,children:s.jsx(XY,{className:pt("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));fi.displayName=uP.displayName;async function Rm(e){if(!e||e.trim()===""||e.trim()==="SEM GTIN")return{found:!1};try{const{data:t,error:r}=await J.from("produtos_ciclik").select("*").eq("gtin",e.trim()).maybeSingle();return r?{found:!1}:t?{found:!0,produto:t}:{found:!1}}catch{return{found:!1}}}const qi={vidro:"Vidro",plastico:"Plstico",papel:"Papel",papelao:"Papelo",aluminio:"Alumnio",laminado:"Laminado",misto:"Misto"};function YY({items:e,onChange:t,numeroNota:r,onNumeroNotaChange:a,cnpj:n,onCnpjChange:i,dataCompra:o,onDataCompraChange:c}){const[d,h]=E.useState(""),p=C=>{const T=C.replace(/\D/g,"");return T.length<=2?T:T.length<=5?`${T.slice(0,2)}.${T.slice(2)}`:T.length<=8?`${T.slice(0,2)}.${T.slice(2,5)}.${T.slice(5)}`:T.length<=12?`${T.slice(0,2)}.${T.slice(2,5)}.${T.slice(5,8)}/${T.slice(8)}`:`${T.slice(0,2)}.${T.slice(2,5)}.${T.slice(5,8)}/${T.slice(8,12)}-${T.slice(12,14)}`},x=C=>{const T=C.replace(/\D/g,"");if(T.length!==14||/^(\d)\1+$/.test(T))return!1;let A=0,k=5;for(let O=0;O<12;O++)A+=parseInt(T.charAt(O))*k,k=k===2?9:k-1;if((A%11<2?0:11-A%11)!==parseInt(T.charAt(12)))return!1;A=0,k=6;for(let O=0;O<13;O++)A+=parseInt(T.charAt(O))*k,k=k===2?9:k-1;return(A%11<2?0:11-A%11)===parseInt(T.charAt(13))},v=C=>{const T=p(C);i==null||i(T),T.replace(/\D/g,"").length===14?x(T)?h(""):h("CNPJ invlido"):h("")},b=()=>{t([...e,{nome:"",quantidade:1,preco_unitario:0,preco_total:0,reciclavel:!1,gtin:"",produto_cadastrado:!1}])},N=C=>{t(e.filter((T,A)=>A!==C))},_=async(C,T,A)=>{const k=[...e];if(k[C]={...k[C],[T]:A},(T==="quantidade"||T==="preco_unitario")&&(k[C].preco_total=k[C].quantidade*k[C].preco_unitario),T==="gtin"&&A&&A.length>=8){const I=await Rm(A);I.found&&I.produto?(k[C].produto_cadastrado=!0,k[C].produto_ciclik=I.produto,k[C].nome=I.produto.descricao,k[C].reciclavel=I.produto.reciclavel):(k[C].produto_cadastrado=!1,k[C].produto_ciclik=void 0)}t(k)};return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(ke,{className:"text-base font-semibold",children:"Dados da Nota Fiscal"}),s.jsxs(oe,{type:"button",variant:"outline",size:"sm",onClick:b,children:[s.jsx(ra,{className:"h-4 w-4 mr-2"}),"Adicionar Item"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 border rounded-lg bg-muted/30",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"product-list-numero",children:"Nmero da Nota"}),s.jsx(We,{id:"product-list-numero",value:r||"",onChange:C=>a==null?void 0:a(C.target.value),placeholder:"000000"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"product-list-cnpj",children:"CNPJ do Estabelecimento"}),s.jsx(We,{id:"product-list-cnpj",value:n||"",onChange:C=>v(C.target.value),placeholder:"00.000.000/0000-00",maxLength:18,className:d?"border-destructive":""}),d&&s.jsx("p",{className:"text-xs text-destructive",children:d})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"product-list-data",children:"Data da Compra"}),s.jsx(We,{id:"product-list-data",type:"date",value:o||"",onChange:C=>c==null?void 0:c(C.target.value)})]})]}),s.jsx(ke,{className:"text-sm font-semibold",children:"Produtos"}),e.length===0?s.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"Nenhum produto adicionado. Use o OCR para extrair automaticamente ou adicione manualmente."}):s.jsx("div",{className:"border rounded-lg overflow-x-auto",children:s.jsx("div",{className:"min-w-full",children:s.jsx("div",{className:"space-y-2 p-4",children:e.map((C,T)=>s.jsxs("div",{className:"space-y-2 p-3 border rounded-lg bg-card",children:[s.jsx("div",{className:"flex items-center gap-2 mb-2",children:C.produto_cadastrado&&C.produto_ciclik?s.jsxs(s.Fragment,{children:[s.jsxs(Je,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[s.jsx(fs,{className:"h-3 w-3 mr-1"}),"Produto Cadastrado"]}),s.jsx(Je,{variant:"secondary",children:qi[C.produto_ciclik.tipo_embalagem]}),C.produto_ciclik.reciclavel&&s.jsxs(Je,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[s.jsx(Ur,{className:"h-3 w-3 mr-1"}),C.produto_ciclik.percentual_reciclabilidade,"%"]})]}):C.gtin&&C.gtin.toUpperCase()==="SEM GTIN"?s.jsxs(Je,{variant:"outline",className:"bg-red-50 text-red-700 border-red-200",children:[s.jsx(Kr,{className:"h-3 w-3 mr-1"}),"Material sem viabilidade de reciclagem"]}):C.gtin&&C.gtin.length>=8?s.jsxs(Je,{variant:"outline",className:"bg-yellow-50 text-yellow-700 border-yellow-200",children:[s.jsx(Kr,{className:"h-3 w-3 mr-1"}),"Produto No Cadastrado"]}):null}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-2",children:[s.jsxs("div",{className:"md:col-span-9",children:[s.jsx(ke,{className:"text-xs mb-1 block",children:"Produto"}),s.jsx(We,{value:C.nome,onChange:A=>_(T,"nome",A.target.value),placeholder:"Nome do produto",className:"w-full",disabled:C.produto_cadastrado})]}),s.jsxs("div",{className:"md:col-span-1",children:[s.jsx(ke,{className:"text-xs mb-1 block",children:"Qtd"}),s.jsx(We,{type:"number",min:"1",value:C.quantidade,onChange:A=>_(T,"quantidade",parseFloat(A.target.value)||1),placeholder:"1",className:"w-full"})]}),s.jsxs("div",{className:"md:col-span-1",children:[s.jsx(ke,{className:"text-xs mb-1 block",children:"Recicl."}),s.jsx("div",{className:"flex items-center gap-2 h-10",children:s.jsx(fi,{checked:C.reciclavel,onCheckedChange:A=>_(T,"reciclavel",A),disabled:!0})})]}),s.jsx("div",{className:"md:col-span-1 flex items-end",children:s.jsx(oe,{type:"button",variant:"ghost",size:"sm",onClick:()=>N(T),className:"w-full md:w-auto",children:s.jsx(Ba,{className:"h-4 w-4 text-destructive"})})})]}),C.produto_ciclik&&s.jsx("div",{className:"text-xs text-muted-foreground pt-2 border-t",children:s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("span",{children:[s.jsx("strong",{children:"NCM:"})," ",C.produto_ciclik.ncm]}),C.produto_ciclik.observacoes&&s.jsxs("span",{children:[s.jsx("strong",{children:"Obs:"})," ",C.produto_ciclik.observacoes]})]})})]},T))})})})]})}function ZY({isOpen:e,stage:t,itemCount:r=0}){const a=[{id:"scanning",label:"Lendo QR Code",icon:Da,description:"Decodificando informaes..."},{id:"validating",label:"Validando Nota",icon:_n,description:"Verificando autenticidade..."},{id:"fetching",label:"Buscando Itens",icon:fs,description:r>0?`${r} produtos encontrados`:"Carregando produtos..."}],i=(()=>{const o=a.findIndex(c=>c.id===t);return o===-1?0:o})();return s.jsx(Qi,{children:e&&s.jsx(Ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",onClick:o=>o.stopPropagation(),children:s.jsxs(Ee.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",duration:.5},className:"bg-card border border-border rounded-2xl shadow-2xl p-8 max-w-md w-full mx-4",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx(Ee.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"inline-block",children:s.jsx(_s,{className:"h-12 w-12 text-primary mx-auto mb-4"})}),s.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:"Processando Nota Fiscal"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Aguarde enquanto processamos os dados..."})]}),s.jsx("div",{className:"space-y-4",children:a.map((o,c)=>{const d=c<i,h=c===i,p=o.icon;return s.jsxs(Ee.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:c*.1},className:`flex items-start gap-4 p-4 rounded-lg transition-all ${h?"bg-primary/10 border-2 border-primary":d?"bg-green-500/10 border border-green-500/30":"bg-muted/30 border border-transparent"}`,children:[s.jsx("div",{className:"flex-shrink-0",children:d?s.jsx(Ee.div,{initial:{scale:0},animate:{scale:1},className:"w-10 h-10 rounded-full bg-green-500 flex items-center justify-center",children:s.jsx(_n,{className:"h-5 w-5 text-white"})}):h?s.jsx(Ee.div,{animate:{rotate:360},transition:{duration:1.5,repeat:1/0,ease:"linear"},className:"w-10 h-10 rounded-full bg-primary flex items-center justify-center",children:s.jsx(p,{className:"h-5 w-5 text-primary-foreground"})}):s.jsx("div",{className:"w-10 h-10 rounded-full bg-muted flex items-center justify-center",children:s.jsx(p,{className:"h-5 w-5 text-muted-foreground"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:`font-semibold text-sm mb-1 ${h?"text-primary":d?"text-green-600 dark:text-green-400":"text-muted-foreground"}`,children:o.label}),s.jsx("p",{className:`text-xs ${h?"text-foreground/80":"text-muted-foreground"}`,children:o.description})]}),h&&s.jsx(Ee.div,{initial:{opacity:0},animate:{opacity:1},className:"flex-shrink-0",children:s.jsx("div",{className:"flex gap-1",children:[0,1,2].map(x=>s.jsx(Ee.div,{animate:{scale:[1,1.2,1],opacity:[.5,1,.5]},transition:{duration:1,repeat:1/0,delay:x*.2},className:"w-1.5 h-1.5 rounded-full bg-primary"},x))})})]},o.id)})}),s.jsx(Ee.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"mt-6 text-center",children:s.jsx("p",{className:"text-xs text-muted-foreground",children:"Este processo pode levar alguns segundos..."})})]})})})}const QY="https://ciclik-backend.onrender.com";async function JY(e,t=6e4){if(!e||typeof e!="string")throw new Error("URL do QR Code invlida.");const r=/^https?:\/\//i.test(e)?e:`https://${e}`,a=new AbortController,n=setTimeout(()=>a.abort(),t);try{const i=await fetch(`${QY}/produtos`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({qr_url:r}),signal:a.signal});if(!i.ok){const c=await i.text().catch(()=>"");throw new Error(`Falha ao consultar backend (${i.status}): ${c||i.statusText}`)}const o=await i.json();if(!Array.isArray(o))throw new Error("Resposta do backend inesperada (esperado um array).");return o.filter(c=>c&&typeof c=="object").map(c=>({nome:String(c.nome??""),ean:String(c.ean??"")}))}catch(i){throw i instanceof Error&&i.name==="AbortError"?new Error("Tempo excedido ao consultar o backend (60s). A API pode estar em modo sleep no Render."):i}finally{clearTimeout(n)}}function eZ(){const{user:e}=sr(),[t,r]=E.useState(!1),[a,n]=E.useState(!1),[i,o]=E.useState(!1),[c,d]=E.useState("scanning"),[h,p]=E.useState(0),[x,v]=E.useState(null),[b,N]=E.useState(""),[_,C]=E.useState(""),[T,A]=E.useState(""),[k,I]=E.useState(""),[B,O]=E.useState(""),[D,F]=E.useState([]),[M,z]=E.useState("select"),[q,Y]=E.useState("automatic"),[ae,je]=E.useState(""),[H,Z]=E.useState(""),[G,Q]=E.useState(""),[re,le]=E.useState(""),[ye,W]=E.useState(""),[ee,ie]=E.useState(!1),[ce,xe]=E.useState(!1),[Ce,me]=E.useState(null),[fe,ve]=E.useState(null),[ne,Me]=E.useState({valorTotal:"",cnpj:"",dataCompra:"",itens:""}),Ie=ds(),{toast:Be}=_r();E.useEffect(()=>{(async()=>{const{data:{session:et}}=await J.auth.getSession();(!et||!et.access_token)&&(Be({title:"Autenticao Necessria",description:"Voc precisa estar logado para enviar notas fiscais.",variant:"destructive"}),Ie("/auth"))})()},[Ie,Be]),E.useEffect(()=>{if(q==="manual"&&D.length>0&&!ce){const Re=D.reduce((et,Ct)=>Ct.quantidade&&Ct.valor_unitario?et+Ct.quantidade*Ct.valor_unitario:et,0);if(Re>0){const et=Re.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2});C(et)}}},[D,q,ce]);const ot=E.useMemo(()=>{if(D.length===0)return!1;const Re=D.filter(et=>et.gtin&&et.gtin.trim()!==""&&et.gtin.toUpperCase()!=="SEM GTIN");return Re.length===0?!0:Re.every(et=>et.produto_cadastrado===!0)},[D]),Se=Re=>{const et=Re.replace(/\D/g,""),Ct=parseFloat(et)/100;return isNaN(Ct)?"":Ct.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})},ze=Re=>{const et=Se(Re);C(et),xe(!0)},we=()=>D.reduce((Re,et)=>et.quantidade&&et.valor_unitario?Re+et.quantidade*et.valor_unitario:Re,0),Le=Re=>{const et=Re.replace(/\./g,"").replace(",",".");return parseFloat(et)||0},Nt=Re=>{const et=Re.replace(/\D/g,""),Ct=parseFloat(et)/100;return isNaN(Ct)?"":Ct.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})},Ge=Re=>{v(Re);const et=new FileReader;et.onloadend=()=>{N(et.result)},et.readAsDataURL(Re),z("file")},Lt=Re=>{var Ct;const et=(Ct=Re.target.files)==null?void 0:Ct[0];et&&Ge(et)},ps=Re=>{const et=Re.substring(0,2),Ct=Re.substring(2,6),Yt=Re.substring(6,20),bt=Re.substring(20,22),Dt=Re.substring(22,25),Jt=Re.substring(25,34),Oe=Yt.replace(/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})$/,"$1.$2.$3/$4-$5"),Xe=parseInt(Ct.substring(0,2))+2e3,zt=Ct.substring(2,4);return{uf:et,ano:Xe,mes:zt,cnpj:Oe,modelo:bt,serie:Dt,numeroNota:Jt.replace(/^0+/,""),chaveAcesso:Re}},ns=async(Re,et)=>{try{n(!0);const{data:Ct,error:Yt}=await J.functions.invoke("consultar-sefaz",{body:{chaveAcesso:Re,uf:et}});if(Yt)throw Yt;if(Ct.success&&Ct.data){const bt=Ct.data;if(bt.numero&&O(bt.numero),bt.cnpj&&A(bt.cnpj),bt.dataEmissao&&I(bt.dataEmissao),bt.valorTotal&&bt.valorTotal>0&&C(bt.valorTotal.toString()),bt.itens&&bt.itens.length>0){const Dt=await Promise.all(bt.itens.map(async Jt=>{var Oe;if(Jt.gtin){const Xe=await Rm(Jt.gtin);if(Xe.found&&Xe.produto){const zt=Jt.quantidade||1,qt=Xe.produto.peso_medio_gramas||null,St=zt&&qt?zt*qt:null;return{...Jt,nome:Xe.produto.descricao,reciclavel:Xe.produto.reciclavel,tipo_embalagem:Xe.produto.tipo_embalagem,peso_unitario_gramas:qt,peso_total_estimado_gramas:St,produto_cadastrado:!0,produto_ciclik:Xe.produto}}else try{const{data:zt,error:qt}=await J.rpc("registrar_produto_em_analise",{p_ean_gtin:Jt.gtin.trim(),p_descricao:Jt.descricao||"Produto sem descrio",p_origem:"qrcode",p_usuario_id:(e==null?void 0:e.id)||null,p_usuario_nome:((Oe=e==null?void 0:e.user_metadata)==null?void 0:Oe.nome_completo)||(e==null?void 0:e.email)||"Usurio desconhecido"});qt?console.error(" Erro ao registrar produto em anlise (SEFAZ):",qt):console.log(" Produto SEFAZ registrado para anlise:",Jt.gtin,zt)}catch(zt){console.error(" EXCEO ao registrar produto em anlise (SEFAZ):",zt)}}return{...Jt,nome:Jt.descricao,produto_cadastrado:!1,reciclavel:!1,tipo_embalagem:"misto"}}));F(Dt)}}}catch{Be({title:"Consulta SEFAZ indisponvel",description:"No foi possvel consultar a SEFAZ no momento. Os dados bsicos foram extrados da chave de acesso.",variant:"destructive"})}finally{n(!1)}},Ke=async Re=>{o(!0),d("scanning");const{data:{session:et},error:Ct}=await J.auth.getSession();if(!et||!et.access_token){Be({title:"Sesso Expirada",description:"Sua sesso expirou. Por favor, faa login novamente.",variant:"destructive"}),z("select"),o(!1),Ie("/auth");return}try{d("validating");const{data:Yt,error:bt}=await J.functions.invoke("processar-codigo-nota",{body:{codigo:Re,origem_leitura:M==="barcode"?"barcode":"qrcode"}});if(bt){Be({title:"Erro ao Processar Cdigo",description:"No foi possvel processar o cdigo. Tente novamente.",variant:"destructive"}),z("select"),o(!1);return}if(!Yt.valida){Be({title:"Cdigo Invlido",description:Yt.motivo_invalidez,variant:"destructive"}),z("select"),o(!1);return}if(Yt.modelo!=="65"&&Yt.modelo!=="59"){Be({title:"Modelo no suportado",description:`Este sistema s aceita notas fiscais modelo 65 (NFC-e) ou 59 (CF-e-SAT). Modelo detectado: ${Yt.modelo}`,variant:"destructive"}),z("select"),o(!1);return}d("fetching");const Dt=Yt.chave_acesso,Jt=ps(Dt);if(!Jt)throw new Error("No foi possvel extrair dados da chave de acesso");A(Jt.cnpj),O(Jt.numeroNota);const Oe=`${Jt.ano}-${Jt.mes}-01`;I(Oe),Be({title:"Chave de Acesso Lida!",description:`Nota Fiscal Modelo ${Yt.modelo} detectada. Buscando itens...`,variant:"default"}),z("select");try{const Xe=await JY(Re,6e4);if(Xe&&Xe.length>0){const zt=await Promise.all(Xe.map(async qt=>{var ls,is;const St=qt.ean&&qt.ean.toUpperCase()==="SEM GTIN";if(qt.ean&&qt.ean.length>0&&!St){const ws=await Rm(qt.ean);if(ws.found&&ws.produto){const Bs=ws.produto.peso_medio_gramas||0,js=Bs*1;return{nome:qt.nome||ws.produto.descricao,gtin:qt.ean,quantidade:1,valor_unitario:0,reciclavel:ws.produto.reciclavel,tipo_embalagem:ws.produto.tipo_embalagem,peso_unitario_gramas:Bs,peso_total_estimado_gramas:js,produto_cadastrado:!0,produto_ciclik:ws.produto}}else try{const{data:Bs,error:js}=await J.rpc("registrar_produto_em_analise",{p_ean_gtin:qt.ean.trim(),p_descricao:qt.nome||"Produto sem descrio",p_origem:"qrcode",p_usuario_id:(e==null?void 0:e.id)||null,p_usuario_nome:((ls=e==null?void 0:e.user_metadata)==null?void 0:ls.nome_completo)||(e==null?void 0:e.email)||"Usurio desconhecido"});js?(console.error(" Erro ao registrar produto em anlise (QR Code):",js),console.log(" Produto:",{ean:qt.ean,nome:qt.nome})):console.log(" Produto registrado para anlise:",qt.ean,Bs)}catch(Bs){console.error(" EXCEO ao registrar produto em anlise (QR Code):",Bs),console.log(" Produto:",{ean:qt.ean,nome:qt.nome})}}else if(St||!qt.ean)try{const{data:ws,error:Bs}=await J.rpc("registrar_produto_em_analise",{p_ean_gtin:qt.ean||"SEM GTIN",p_descricao:qt.nome||"Produto sem descrio",p_origem:"qrcode",p_usuario_id:(e==null?void 0:e.id)||null,p_usuario_nome:((is=e==null?void 0:e.user_metadata)==null?void 0:is.nome_completo)||(e==null?void 0:e.email)||"Usurio desconhecido"});Bs?(console.error(" Erro ao registrar produto SEM GTIN:",Bs),console.log(" Produto SEM GTIN:",qt.nome)):console.log(" Produto SEM GTIN registrado para anlise:",qt.nome,ws)}catch(ws){console.error(" EXCEO ao registrar produto SEM GTIN:",ws),console.log(" Produto:",qt.nome)}return{nome:qt.nome,gtin:qt.ean,quantidade:1,valor_unitario:0,produto_cadastrado:!1,reciclavel:!1,tipo_embalagem:"misto"}}));F(zt)}else Be({title:"Ateno",description:"No foi possvel buscar os itens. Verifique e corrija os dados manualmente.",variant:"default"})}catch{Be({title:"Itens no disponveis",description:"No foi possvel buscar os itens automaticamente. Adicione manualmente.",variant:"default"})}ns(Dt,Jt.uf).catch(Xe=>{})}catch(Yt){Be({title:"Erro ao processar chave",description:Yt instanceof Error?Yt.message:"Tente novamente ou insira os dados manualmente.",variant:"destructive"}),z("select")}finally{o(!1)}},dt=async()=>{if(!x){Be({title:"Erro",description:"Selecione uma imagem primeiro",variant:"destructive"});return}n(!0);try{const{data:Re,error:et}=await J.functions.invoke("ocr-nota-fiscal",{body:{imageBase64:b}});if(et)throw et;if(Re.success){const Ct=Re.data;if(Ct.valor_total){const Yt=Ct.valor_total.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2});C(Yt)}if(Ct.cnpj_estabelecimento&&A(Ct.cnpj_estabelecimento),Ct.data_compra&&I(Ct.data_compra),Ct.numero_nota&&O(Ct.numero_nota),Ct.itens&&Ct.itens.length>0){const Yt=await Promise.all(Ct.itens.map(async bt=>{var Dt;if(bt.gtin){const Jt=await Rm(bt.gtin);if(Jt.found&&Jt.produto){const Oe=bt.quantidade||1,Xe=Jt.produto.peso_medio_gramas||null,zt=Oe&&Xe?Oe*Xe:null;return{...bt,nome:Jt.produto.descricao,reciclavel:Jt.produto.reciclavel,peso_unitario_gramas:Xe,peso_total_estimado_gramas:zt,produto_cadastrado:!0,produto_ciclik:Jt.produto}}else try{await J.rpc("registrar_produto_em_analise",{p_ean_gtin:bt.gtin.trim(),p_descricao:bt.nome||bt.descricao||"Produto sem descrio",p_origem:"qrcode",p_usuario_id:(e==null?void 0:e.id)||null,p_usuario_nome:((Dt=e==null?void 0:e.user_metadata)==null?void 0:Dt.nome_completo)||(e==null?void 0:e.email)||"Usurio desconhecido"})}catch{}}return{...bt,produto_cadastrado:!1,reciclavel:!1}}));F(Yt)}Be({title:"OCR Concludo!",description:"Dados extrados da nota fiscal com sucesso"})}else throw new Error(Re.error||"Erro ao processar OCR")}catch(Re){Be({title:"Erro no OCR",description:Re instanceof Error?Re.message:"Erro ao processar imagem",variant:"destructive"})}finally{n(!1)}},It=()=>{if(!ae.trim()||!H){Be({title:"Erro",description:"Preencha a descrio e o tipo do material",variant:"destructive"});return}const Re=window._tempProductData,et=Re==null?void 0:Re.produto_ciclik,Ct=re&&parseInt(re,10)||null,Yt=(et==null?void 0:et.peso_medio_gramas)||null,bt=Ct&&Yt?Ct*Yt:null,Dt={nome:ae,descricao:ae,tipo_embalagem:H,gtin:G||null,quantidade:Ct,valor_unitario:ye?Le(ye):null,peso_unitario_gramas:Yt,peso_total_estimado_gramas:bt,reciclavel:(et==null?void 0:et.reciclavel)||!1,produto_cadastrado:(Re==null?void 0:Re.produto_cadastrado)||!1,produto_ciclik:et,origem_manual:!0};F([...D,Dt]),je(""),Z(""),Q(""),le(""),W(""),delete window._tempProductData;const Jt=bt?` | Peso estimado: ${bt.toLocaleString("pt-BR")}g`:"";Be({title:"Item adicionado!",description:`Material adicionado  lista${Jt}`})},Ut=Re=>{F(D.filter((et,Ct)=>Ct!==Re))},ts=Re=>{me(Re),ve({...D[Re]})},us=()=>{me(null),ve(null)},qe=()=>{if(!fe.descricao&&!fe.nome){Be({title:"Erro",description:"A descrio do material no pode estar vazia",variant:"destructive"});return}if(!fe.tipo_embalagem){Be({title:"Erro",description:"Selecione o tipo de embalagem",variant:"destructive"});return}const Re=[...D];Re[Ce]=fe,F(Re),me(null),ve(null),Be({title:"Material atualizado!",description:"As alteraes foram salvas"})},jt=()=>{const Re={valorTotal:"",cnpj:"",dataCompra:"",itens:""};let et=!1;return(!_||Le(_)===0)&&(Re.valorTotal="Valor total  obrigatrio",et=!0),k||(Re.dataCompra="Data da compra  obrigatria",et=!0),D.length===0&&(Re.itens="Adicione pelo menos um material reciclvel",et=!0),Me(Re),et&&Be({title:"Campos obrigatrios",description:"Preencha todos os campos obrigatrios antes de enviar",variant:"destructive"}),!et},_t=async()=>{if(e){if(q==="manual"){if(!jt())return}else if(D.length===0){Be({title:"Erro",description:"Escaneie um QR Code ou adicione itens primeiro",variant:"destructive"});return}Me({valorTotal:"",cnpj:"",dataCompra:"",itens:""}),r(!0);try{const Re=D.filter(Dt=>!Dt.produto_cadastrado).length,{data:et,error:Ct}=await J.from("notas_fiscais").insert({id_usuario:e.id,imagem_nf:b||"manual-entry",valor_total:_?Le(_):null,cnpj_estabelecimento:T||null,data_compra:k||null,numero_nota:B||null,itens:D.length>0?D:null,itens_enriquecidos:D.length>0?D:null,produtos_nao_cadastrados:Re,status_validacao:"pendente"}).select().single();if(Ct)throw Ct;const Yt=D.filter(Dt=>Dt.reciclavel!==!1).map(Dt=>{var zt,qt,St,ls;const Jt=Dt.quantidade||1,Oe=Dt.peso_unitario_gramas||((zt=Dt.produto_ciclik)==null?void 0:zt.peso_medio_gramas)||null,Xe=Dt.peso_total_estimado_gramas||(Jt&&Oe?Jt*Oe:null);return{id_usuario:e.id,id_nota_fiscal:et.id,gtin:Dt.gtin||null,descricao:Dt.nome||Dt.descricao,tipo_embalagem:Dt.tipo_embalagem||((qt=Dt.produto_ciclik)==null?void 0:qt.tipo_embalagem),reciclavel:Dt.reciclavel??((St=Dt.produto_ciclik)==null?void 0:St.reciclavel)??!0,percentual_reciclabilidade:Dt.percentual_reciclabilidade||((ls=Dt.produto_ciclik)==null?void 0:ls.percentual_reciclabilidade)||0,quantidade:Jt,peso_unitario_gramas:Oe,peso_total_estimado_gramas:Xe,origem_cadastro:q==="manual"?"manual":"nota_fiscal"}});if(Yt.length>0){const{error:Dt}=await J.from("materiais_reciclaveis_usuario").insert(Yt)}const bt=D.filter(Dt=>Dt.produto_cadastrado&&Dt.gtin).map(Dt=>{var Jt,Oe,Xe;return{gtin:Dt.gtin,nome_produto:Dt.nome||Dt.descricao,id_produto:((Jt=Dt.produto_ciclik)==null?void 0:Jt.id)||null,tipo_embalagem:Dt.tipo_embalagem||((Oe=Dt.produto_ciclik)==null?void 0:Oe.tipo_embalagem)||null,reciclabilidade:Dt.percentual_reciclabilidade||((Xe=Dt.produto_ciclik)==null?void 0:Xe.percentual_reciclabilidade)||0,data:new Date().toISOString(),status:"disponivel"}});if(bt.length>0){const{error:Dt}=await J.from("estoque_embalagens").insert(bt);Dt&&console.error("Erro ao inserir embalagens no estoque CDV:",Dt)}Be({title:"Nota fiscal enviada!",description:`Sua nota fiscal est em anlise. ${Yt.length} materiais reciclveis cadastrados!`}),Ie("/user")}catch(Re){Be({title:"Erro no upload",description:Re.message,variant:"destructive"})}finally{r(!1)}}};return s.jsxs("div",{className:"min-h-screen bg-background p-4 md:p-8",children:[s.jsxs("div",{className:"mx-auto max-w-2xl space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>Ie("/user"),children:s.jsx(As,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Enviar Nota Fiscal"}),s.jsx("p",{className:"text-muted-foreground",children:"Registre suas compras sustentveis"})]})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Registrar Nota Fiscal"}),s.jsx(Tt,{children:"Escolha entre entrada automtica (com foto e OCR) ou manual"})]}),s.jsxs(De,{className:"space-y-6",children:[s.jsxs(Mn,{value:"automatic",onValueChange:Re=>Y(Re),children:[s.jsx(Nn,{className:"grid w-full grid-cols-1",children:s.jsx(Gs,{value:"automatic",children:"Escanear QR Code da Nota Fiscal"})}),s.jsxs(hr,{value:"automatic",className:"space-y-6 mt-6",children:[M==="select"&&!x&&s.jsx("div",{className:"grid grid-cols-1 gap-4 max-w-md mx-auto",children:s.jsxs(oe,{variant:"outline",className:"h-32 flex flex-col gap-2",onClick:()=>z("qrcode"),children:[s.jsx(Da,{className:"h-8 w-8"}),s.jsx("span",{className:"text-sm",children:"Escanear QR Code"})]})}),M==="file"&&!x&&s.jsxs("div",{className:"space-y-4",children:[s.jsx(ke,{htmlFor:"receipt",children:"Selecione a imagem"}),s.jsxs("div",{className:"border-2 border-dashed rounded-lg p-8 text-center cursor-pointer hover:bg-muted/50 transition-colors",children:[s.jsx(We,{id:"receipt",type:"file",accept:"image/*",onChange:Lt,className:"hidden"}),s.jsx("label",{htmlFor:"receipt",className:"cursor-pointer",children:s.jsxs("div",{className:"space-y-2",children:[s.jsx(wd,{className:"h-12 w-12 mx-auto text-muted-foreground"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Clique para selecionar uma imagem"})]})})]}),s.jsx(oe,{variant:"outline",onClick:()=>z("select"),className:"w-full",children:"Voltar"})]}),M==="camera"&&!x&&s.jsx(wY,{onCapture:Ge,onCancel:()=>z("select")}),M==="barcode"&&s.jsxs("div",{className:"space-y-4",children:[s.jsx(dE,{mode:"barcode",onScan:Ke,onCancel:()=>z("select")}),i&&s.jsxs("div",{className:"flex items-center justify-center p-4 bg-primary/10 rounded-lg",children:[s.jsx(_s,{className:"h-5 w-5 animate-spin mr-2"}),s.jsx("span",{className:"text-sm",children:"Processando cdigo..."})]})]}),M==="qrcode"&&s.jsxs("div",{className:"space-y-4",children:[s.jsx(dE,{mode:"qrcode",onScan:Ke,onCancel:()=>z("select")}),i&&s.jsxs("div",{className:"flex items-center justify-center p-4 bg-primary/10 rounded-lg",children:[s.jsx(_s,{className:"h-5 w-5 animate-spin mr-2"}),s.jsx("span",{className:"text-sm",children:"Processando QR Code..."})]})]}),x&&b&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:b,alt:"Preview",className:"w-full rounded-lg border"}),s.jsx(oe,{variant:"destructive",size:"icon",className:"absolute top-2 right-2",onClick:()=>{v(null),N(""),z("select")},children:s.jsx(Jr,{className:"h-4 w-4"})})]}),s.jsx(oe,{onClick:dt,disabled:a,className:"w-full",children:a?s.jsxs(s.Fragment,{children:[s.jsx(_s,{className:"mr-2 h-4 w-4 animate-spin"}),"Processando..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Md,{className:"mr-2 h-4 w-4"}),"Extrair Dados com OCR"]})})]}),D.length>0&&s.jsxs("div",{children:[s.jsx(ke,{className:"mb-2 block",children:"Produtos Identificados"}),s.jsx(YY,{items:D,onChange:F,numeroNota:B,onNumeroNotaChange:O,cnpj:T,onCnpjChange:A,dataCompra:k,onDataCompraChange:I})]})]}),s.jsxs(hr,{value:"manual",className:"space-y-6 mt-6",children:[s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs(ke,{htmlFor:"valor-manual",className:"flex items-center gap-1",children:["Valor Total (R$)",s.jsx("span",{className:"text-destructive",children:"*"}),!ce&&we()>0&&s.jsxs("span",{className:"text-xs text-muted-foreground font-normal ml-2 flex items-center gap-1",children:[s.jsx(p6,{className:"h-3 w-3"}),"(calculado automaticamente)"]})]}),s.jsxs("div",{className:"relative",children:[s.jsx(We,{id:"valor-manual",placeholder:"0,00",value:_,onChange:Re=>{ze(Re.target.value),ne.valorTotal&&Me({...ne,valorTotal:""})},className:ne.valorTotal?"border-destructive":""}),ce&&s.jsx(oe,{type:"button",variant:"ghost",size:"sm",className:"absolute right-1 top-1 h-7 text-xs",onClick:()=>{xe(!1),C("")},children:"Recalcular"})]}),ne.valorTotal&&s.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1",children:[s.jsx(Kr,{className:"h-3 w-3"}),ne.valorTotal]}),!ce&&we()>0&&s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Soma dos itens: R$ ",we().toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})}),s.jsxs("div",{className:`border rounded-lg p-4 space-y-4 bg-muted/50 ${ne.itens?"border-destructive":""}`,children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[s.jsx(ra,{className:"h-4 w-4"}),"Adicionar Materiais Reciclveis",s.jsx("span",{className:"text-destructive",children:"*"})]}),ne.itens&&s.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1",children:[s.jsx(Kr,{className:"h-3 w-3"}),ne.itens]})]}),s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2 md:col-span-2",children:[s.jsx(ke,{htmlFor:"item-descricao",children:"Descrio do Material"}),s.jsx(We,{id:"item-descricao",placeholder:"Ex: Garrafa PET 2L",value:ae,onChange:Re=>je(Re.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"item-tipo",children:"Tipo de Embalagem"}),s.jsxs(qs,{value:H,onValueChange:Z,children:[s.jsx(Ls,{id:"item-tipo",children:s.jsx(Ws,{placeholder:"Selecione"})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"plastico",children:"Plstico"}),s.jsx(xt,{value:"papel",children:"Papel"}),s.jsx(xt,{value:"papelao",children:"Papelo"}),s.jsx(xt,{value:"vidro",children:"Vidro"}),s.jsx(xt,{value:"aluminio",children:"Alumnio"}),s.jsx(xt,{value:"laminado",children:"Laminado"}),s.jsx(xt,{value:"misto",children:"Misto"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(ke,{htmlFor:"item-quantidade",children:["Quantidade",s.jsx("span",{className:"text-muted-foreground text-xs ml-1",children:"(unidades, opcional)"})]}),s.jsx(We,{id:"item-quantidade",type:"number",min:"0",step:"1",placeholder:"0",value:re,onChange:Re=>le(Re.target.value)})]}),s.jsxs("div",{className:"space-y-2 md:col-span-2",children:[s.jsxs(ke,{htmlFor:"item-valor",children:["Valor Unitrio (R$)",s.jsx("span",{className:"text-muted-foreground text-xs ml-1",children:"(opcional)"})]}),s.jsx(We,{id:"item-valor",placeholder:"0,00",value:ye,onChange:Re=>W(Nt(Re.target.value))})]})]})}),s.jsxs(oe,{type:"button",onClick:()=>{It(),ne.itens&&Me({...ne,itens:""})},className:"w-full",variant:"outline",children:[s.jsx(ra,{className:"mr-2 h-4 w-4"}),"Adicionar  Lista"]})]}),D.length===0&&ne.itens&&s.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-3",children:s.jsxs("p",{className:"text-sm text-destructive flex items-center gap-2",children:[s.jsx(Kr,{className:"h-4 w-4"})," necessrio adicionar pelo menos um material para registrar a nota fiscal"]})}),D.length>0&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(ke,{children:["Materiais Adicionados (",D.length,")"]}),s.jsx("div",{className:"flex flex-col items-end gap-1",children:(()=>{const Re=D.reduce((et,Ct)=>et+(Ct.peso_total_estimado_gramas||0),0);return Re>0?s.jsxs("span",{className:"text-sm font-medium text-primary",children:["Peso estimado: ",Re.toLocaleString("pt-BR"),"g (",(Re/1e3).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}),"kg)"]}):null})()})]}),s.jsx("div",{className:"space-y-2",children:D.map((Re,et)=>{var Ct;return s.jsx("div",{className:"border rounded-lg bg-card",children:Ce===et?s.jsxs("div",{className:"p-4 space-y-3",children:[s.jsx("div",{className:"flex items-center justify-between mb-2",children:s.jsxs("h4",{className:"font-medium text-sm flex items-center gap-2",children:[s.jsx(U2,{className:"h-4 w-4"}),"Editando Material"]})}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(ke,{htmlFor:`edit-gtin-${et}`,className:"text-xs",children:["GTIN (Cdigo de Barras)",s.jsx("span",{className:"text-muted-foreground text-xs ml-1",children:"(opcional)"})]}),s.jsx(We,{id:`edit-gtin-${et}`,placeholder:"7891234567890",value:fe.gtin||"",onChange:Yt=>ve({...fe,gtin:Yt.target.value}),onBlur:async()=>{var Yt;if(fe.gtin&&fe.gtin.length>=8){ie(!0);try{const bt=await Rm(fe.gtin);if(bt.found&&bt.produto)ve({...fe,descricao:bt.produto.descricao,nome:bt.produto.descricao,tipo_embalagem:bt.produto.tipo_embalagem}),Be({title:"Produto encontrado!",description:"Os campos foram atualizados automaticamente."});else try{await J.rpc("registrar_produto_em_analise",{p_ean_gtin:fe.gtin.trim(),p_descricao:fe.descricao||fe.nome||"Produto sem descrio",p_origem:"manual",p_usuario_id:(e==null?void 0:e.id)||null,p_usuario_nome:((Yt=e==null?void 0:e.user_metadata)==null?void 0:Yt.nome_completo)||(e==null?void 0:e.email)||"Usurio desconhecido"}),Be({title:"Produto no cadastrado",description:"Este produto foi enviado para anlise administrativa.",variant:"destructive"})}catch(Dt){console.error("Erro ao registrar produto em anlise:",Dt)}}finally{ie(!1)}}}})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:`edit-desc-${et}`,className:"text-xs",children:"Descrio do Material"}),s.jsx(We,{id:`edit-desc-${et}`,placeholder:"Ex: Garrafa PET 2L",value:fe.descricao||fe.nome||"",onChange:Yt=>ve({...fe,descricao:Yt.target.value,nome:Yt.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:`edit-tipo-${et}`,className:"text-xs",children:"Tipo de Embalagem"}),s.jsxs(qs,{value:fe.tipo_embalagem||"",onValueChange:Yt=>ve({...fe,tipo_embalagem:Yt}),children:[s.jsx(Ls,{id:`edit-tipo-${et}`,children:s.jsx(Ws,{placeholder:"Selecione"})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"plastico",children:"Plstico"}),s.jsx(xt,{value:"papel",children:"Papel"}),s.jsx(xt,{value:"papelao",children:"Papelo"}),s.jsx(xt,{value:"vidro",children:"Vidro"}),s.jsx(xt,{value:"aluminio",children:"Alumnio"}),s.jsx(xt,{value:"laminado",children:"Laminado"}),s.jsx(xt,{value:"misto",children:"Misto"})]})]})]}),s.jsx("div",{className:"grid grid-cols-2 gap-3",children:s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:`edit-qtd-${et}`,className:"text-xs",children:"Quantidade"}),s.jsx(We,{id:`edit-qtd-${et}`,type:"number",min:"0",step:"1",placeholder:"0",value:fe.quantidade||"",onChange:Yt=>ve({...fe,quantidade:parseInt(Yt.target.value,10)||0})})]})})]}),s.jsxs("div",{className:"flex gap-2 pt-2",children:[s.jsxs(oe,{type:"button",onClick:qe,className:"flex-1",size:"sm",children:[s.jsx(Ea,{className:"h-4 w-4 mr-1"}),"Salvar"]}),s.jsxs(oe,{type:"button",variant:"outline",onClick:us,className:"flex-1",size:"sm",children:[s.jsx(Jr,{className:"h-4 w-4 mr-1"}),"Cancelar"]})]})]}):s.jsxs("div",{className:"flex items-center justify-between p-3",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-medium",children:Re.nome||Re.descricao}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-1",children:[s.jsx("p",{className:"text-sm text-muted-foreground capitalize",children:(Ct=Re.tipo_embalagem)==null?void 0:Ct.replace("_"," ")}),Re.gtin&&s.jsxs("span",{className:"text-xs text-muted-foreground",children:[" GTIN: ",Re.gtin]}),Re.quantidade&&s.jsxs("span",{className:"text-xs text-muted-foreground",children:[" Qtd: ",Re.quantidade.toLocaleString("pt-BR")]}),Re.peso_total_estimado_gramas&&s.jsxs("span",{className:"text-xs font-medium text-primary",children:[" Peso: ",Re.peso_total_estimado_gramas.toLocaleString("pt-BR"),"g"]}),Re.produto_cadastrado&&s.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded",children:"Cadastrado"})]})]}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx(oe,{type:"button",variant:"ghost",size:"icon",onClick:()=>ts(et),disabled:Ce!==null,children:s.jsx(U2,{className:"h-4 w-4 text-primary"})}),s.jsx(oe,{type:"button",variant:"ghost",size:"icon",onClick:()=>Ut(et),disabled:Ce!==null,children:s.jsx(Ba,{className:"h-4 w-4 text-destructive"})})]})]})},et)})})]})]})]}),s.jsxs("div",{className:"space-y-3",children:[q==="manual"&&s.jsxs("div",{className:"text-xs text-muted-foreground bg-muted/50 rounded-lg p-3",children:[s.jsx("p",{className:"font-medium mb-1",children:"Campos obrigatrios:"}),s.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[s.jsx("li",{children:"Escanear QR Code da Nota Fiscal"}),s.jsx("li",{children:"Data da Compra"}),s.jsx("li",{children:"Pelo menos um Material Reciclvel"})]})]}),D.length>0&&!ot&&s.jsx("div",{className:"text-xs text-blue-700 bg-blue-50 border border-blue-200 rounded-lg p-3",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Kr,{className:"h-4 w-4 mt-0.5 flex-shrink-0 text-blue-600"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium mb-1",children:"Produtos em avaliao"}),s.jsx("p",{children:"Os produtos que aparecem como no cadastrados sero avaliados pela nossa equipe em at 72 horas. Voc pode enviar a nota fiscal normalmente!"})]})]})}),s.jsx(oe,{onClick:_t,disabled:t||D.length===0,className:"w-full",size:"lg",children:t?s.jsxs(s.Fragment,{children:[s.jsx(_s,{className:"mr-2 h-4 w-4 animate-spin"}),"Enviando..."]}):s.jsxs(s.Fragment,{children:[s.jsx(wd,{className:"mr-2 h-4 w-4"}),"Enviar Nota Fiscal"]})})]})]})]})]}),s.jsx(ZY,{isOpen:i,stage:c,itemCount:h})]})}function tZ(){const{user:e}=sr(),[t,r]=E.useState([]),[a,n]=E.useState(!1),[i,o]=E.useState(""),[c,d]=E.useState(""),h=ds(),{toast:p}=_r(),[x,v]=E.useState({id_cooperativa:""});E.useEffect(()=>{b()},[]);const b=async()=>{const{data:T}=await J.from("cooperativas").select("*").eq("status","aprovada");T&&r(T)},N=T=>({cooperativa:"Cooperativa",rota_ciclik:"Rota Ciclik",operador_parceiro:"Operador Parceiro"})[T]||T,_=async()=>{if(!x.id_cooperativa||!e){p({title:"Campo obrigatrio",description:"Selecione um operador logstico",variant:"destructive"});return}n(!0);try{const T=`CICLIK-${Date.now()}-${Math.random().toString(36).substring(7)}`,{data:A,error:k}=await J.from("entregas_reciclaveis").insert({id_usuario:e.id,id_cooperativa:x.id_cooperativa,tipo_material:"No especificado",peso_estimado:null,qrcode_id:T,status:"gerada",data_geracao:new Date().toISOString()}).select().single();if(k)throw k;const I=await kd({data:T,width:400,margin:2});o(I),d(T),p({title:"QR Code gerado!",description:"Apresente este cdigo na cooperativa"})}catch(T){p({title:"Erro",description:T.message,variant:"destructive"})}finally{n(!1)}},C=()=>{const T=document.createElement("a");T.href=i,T.download=`qrcode-${c}.png`,T.click()};return s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-8",children:s.jsxs("div",{className:"mx-auto max-w-2xl space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>h("/user"),children:s.jsx(As,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Entregar Reciclveis"}),s.jsx("p",{className:"text-muted-foreground",children:"Selecione o operador e gere seu QR Code"})]})]}),i?s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"QR Code Gerado"}),s.jsx(Tt,{children:"Apresente este cdigo no operador logstico selecionado"})]}),s.jsxs(De,{className:"space-y-6",children:[s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:s.jsx("img",{src:i,alt:"QR Code",className:"w-full max-w-sm"})}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Cdigo da entrega:"}),s.jsx("p",{className:"font-mono font-bold",children:c})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(oe,{onClick:C,className:"flex-1",variant:"outline",children:"Baixar QR Code"}),s.jsx(oe,{onClick:()=>{o(""),d(""),v({id_cooperativa:""})},className:"flex-1",children:"Nova Entrega"})]})]})]}):s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Informaes da Entrega"}),s.jsx(Tt,{children:"Selecione o operador logstico para gerar o QR Code de entrega"})]}),s.jsxs(De,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"cooperativa",children:"Operador Logstico *"}),s.jsxs(qs,{value:x.id_cooperativa,onValueChange:T=>v({id_cooperativa:T}),children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Selecione o operador"})}),s.jsx(Fs,{children:t.map(T=>s.jsxs(xt,{value:T.id,children:[T.nome_fantasia," - ",N(T.tipo_operador)]},T.id))})]})]}),s.jsx("div",{className:"rounded-lg bg-muted p-4 text-sm text-muted-foreground",children:s.jsxs("p",{children:[" O QR Code gerado ter validade de ",s.jsx("strong",{children:"24 horas"})," para que a entrega seja realizada no operador selecionado."]})}),s.jsx(oe,{onClick:_,disabled:a,size:"sm",className:"w-full",children:a?s.jsxs(s.Fragment,{children:[s.jsx(_s,{className:"mr-2 h-4 w-4 animate-spin"}),"Gerando..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Da,{className:"mr-2 h-4 w-4"}),"Gerar QR Code"]})})]})]})]})})}function sZ(){const{user:e}=sr(),t=ds(),[r,a]=E.useState([]),[n,i]=E.useState(!0),[o,c]=E.useState("todos");E.useEffect(()=>{d()},[]);const d=async()=>{if(e){i(!0);try{const{data:C,error:T}=await J.from("entregas_reciclaveis").select(`
          *,
          cooperativas:id_cooperativa(nome_fantasia)
        `).eq("id_usuario",e.id).order("data_geracao",{ascending:!1});if(T)throw T;a(C||[])}catch(C){console.error("Erro ao carregar entregas:",C)}finally{i(!1)}}},h=(C,T,A)=>{if(T!=="ativa"&&A!=="gerada")return!1;const k=new Date(C);return k.setHours(k.getHours()+24),new Date>k},p=C=>h(C.data_geracao,C.status_promessa,C.status)?"expirada":C.status_promessa||C.status,x=E.useMemo(()=>{const C={ativa:0,em_coleta:0,finalizada:0,expirada:0};let T=0;return r.forEach(A=>{const k=p(A);k in C&&C[k]++,(k==="finalizada"||k==="validada")&&A.peso_validado&&(T+=A.peso_validado)}),{...C,totalKg:T,total:r.length}},[r]),v=E.useMemo(()=>{const C=new Date,T=Wm(C,3);let A=0,k=0;r.forEach(B=>{const O=new Date(B.data_geracao),D=p(B);O>=T&&(D==="finalizada"||D==="validada")&&B.peso_validado&&(A+=B.peso_validado)});for(let B=0;B<3;B++){const O=In(Wm(C,B)),D=Lu(Wm(C,B));r.some(M=>{const z=new Date(M.data_geracao);return z>=O&&z<=D})&&k++}if(k===0)return 15;const I=A/k;return Math.max(I*1.2,10)},[r]),b=({value:C})=>{const T=uk(0),A=D$(T,k=>k.toFixed(1));return E.useEffect(()=>tq(T,C,{duration:2,ease:"easeOut"}).stop,[C]),s.jsx(Ee.span,{children:A})},N=E.useMemo(()=>{const C=["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],T={};r.forEach(k=>{const I=new Date(k.data_geracao),B=uK(I),O=oK(I);T[B]||(T[B]=C.map(F=>({month:F,prometidas:0,finalizadas:0,expiradas:0}))),T[B][O].prometidas++;const D=p(k);D==="finalizada"||D==="validada"?T[B][O].finalizadas++:D==="expirada"&&T[B][O].expiradas++});const A=Object.keys(T).map(Number).sort((k,I)=>I-k);return{yearlyData:T,years:A}},[r]),_=r.filter(C=>o==="todos"?!0:p(C)===o);return E.useMemo(()=>{const C={};return _.forEach(T=>{const A=new Date(T.data_geracao);let k;xR(A)?k="Hoje":gR(A)?k="Ontem":k=Os(A,"dd 'de' MMMM",{locale:$s}),C[k]||(C[k]=[]),C[k].push(T)}),C},[_]),s.jsxs("div",{className:"min-h-screen bg-background pb-8",children:[s.jsx(Rd,{showBackButton:!0,backTo:"/user",title:"Histrico de Entregas"}),s.jsxs(Ee.div,{initial:{opacity:0},animate:{opacity:1},className:"relative bg-gradient-to-br from-primary via-primary to-primary/80 text-primary-foreground overflow-hidden",children:[s.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[s.jsx("div",{className:"absolute -top-24 -right-24 w-48 h-48 bg-white/10 rounded-full blur-3xl"}),s.jsx("div",{className:"absolute -bottom-12 -left-12 w-32 h-32 bg-white/10 rounded-full blur-2xl"})]}),s.jsx("div",{className:"relative mx-auto max-w-lg px-4 py-6",children:s.jsxs(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white/10 backdrop-blur-xl rounded-2xl p-4 border border-white/20",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-xl bg-white/20 flex items-center justify-center",children:s.jsx(Ur,{className:"h-6 w-6 text-white"})}),s.jsxs("div",{children:[s.jsx(Ee.p,{initial:{scale:1.2,opacity:0},animate:{scale:1,opacity:1},className:"text-3xl font-bold",children:x.total},x.total),s.jsx("p",{className:"text-sm text-white/70",children:"entregas prometidas"})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"flex items-center gap-1.5 justify-end",children:[s.jsx(Zi,{className:"h-4 w-4 text-white/70"}),s.jsx(Ee.span,{initial:{scale:1.2,opacity:0},animate:{scale:1,opacity:1},className:"text-2xl font-bold",children:x.totalKg.toLocaleString("pt-BR",{minimumFractionDigits:1,maximumFractionDigits:1})},x.totalKg),s.jsx("span",{className:"text-sm text-white/70",children:"kg"})]}),s.jsx("p",{className:"text-xs text-white/60",children:"material entregue"})]})]}),s.jsx("div",{className:"grid grid-cols-4 gap-2",children:[{key:"ativa",label:"Aguardando",color:"from-blue-400/30 to-blue-500/30",count:x.ativa},{key:"em_coleta",label:"Em Coleta",color:"from-amber-400/30 to-amber-500/30",count:x.em_coleta},{key:"finalizada",label:"Finalizadas",color:"from-emerald-400/30 to-emerald-500/30",count:x.finalizada},{key:"expirada",label:"Expiradas",color:"from-red-400/30 to-red-500/30",count:x.expirada}].map((C,T)=>s.jsxs(Ee.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.15+T*.05},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>c(C.key),className:`
                    relative p-2 rounded-xl bg-gradient-to-br ${C.color} backdrop-blur-sm
                    border border-white/10 transition-all
                    ${o===C.key?"ring-2 ring-white/50":""}
                  `,children:[s.jsx("p",{className:"text-xl font-bold",children:C.count}),s.jsx("p",{className:"text-[10px] text-white/70 truncate",children:C.label})]},C.key))})]})})]}),s.jsxs("div",{className:"mx-auto max-w-lg px-4 pt-4 space-y-4",children:[!n&&N.years.length>0&&s.jsxs(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-card rounded-2xl p-4 border border-border/40",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ir,{className:"h-5 w-5 text-primary"}),s.jsx("h3",{className:"font-semibold text-foreground",children:"Evoluo por Ano"})]}),N.years.length>1&&s.jsx("div",{className:"flex gap-1",children:N.years.map(C=>s.jsx(oe,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs",onClick:()=>{const T=document.getElementById(`chart-${C}`);T==null||T.scrollIntoView({behavior:"smooth",block:"nearest"})},children:C},C))})]}),s.jsx("div",{className:"space-y-6",children:N.years.map(C=>s.jsxs("div",{id:`chart-${C}`,children:[s.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:C}),s.jsx("div",{className:"h-56",children:s.jsx(mi,{width:"100%",height:"100%",children:s.jsxs(Y8,{data:N.yearlyData[C],margin:{top:5,right:10,left:-15,bottom:5},children:[s.jsx(go,{strokeDasharray:"3 3",className:"stroke-muted"}),s.jsx(vo,{dataKey:"month",tick:{fontSize:10,fill:"hsl(var(--muted-foreground))"},axisLine:{stroke:"hsl(var(--border))"}}),s.jsx(yo,{yAxisId:"left",tick:{fontSize:10,fill:"hsl(var(--muted-foreground))"},axisLine:{stroke:"hsl(var(--border))"}}),s.jsx(pi,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"8px",fontSize:"12px"},labelStyle:{color:"hsl(var(--foreground))"}}),s.jsx(Yo,{wrapperStyle:{fontSize:"11px"}}),s.jsx(Rl,{yAxisId:"left",dataKey:"prometidas",name:"Prometidas",fill:"hsl(var(--primary))",opacity:.7,radius:[4,4,0,0]}),s.jsx(El,{yAxisId:"left",type:"monotone",dataKey:"finalizadas",name:"Finalizadas",stroke:"#10b981",strokeWidth:2.5,dot:{r:4,fill:"#10b981",strokeWidth:2,stroke:"#fff"},activeDot:{r:6}}),s.jsx(El,{yAxisId:"left",type:"monotone",dataKey:"expiradas",name:"Expiradas",stroke:"#ef4444",strokeWidth:2.5,strokeDasharray:"5 5",dot:{r:4,fill:"#ef4444",strokeWidth:2,stroke:"#fff"},activeDot:{r:6}})]})})})]},C))})]}),s.jsxs(Ee.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.4,type:"spring",stiffness:100},className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-primary via-primary to-emerald-600 p-6 text-primary-foreground",children:[s.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[s.jsx(Ee.div,{animate:{rotate:360,scale:[1,1.1,1]},transition:{rotate:{duration:20,repeat:1/0,ease:"linear"},scale:{duration:4,repeat:1/0,ease:"easeInOut"}},className:"absolute -top-8 -right-8 w-32 h-32 bg-white/10 rounded-full blur-2xl"}),s.jsx(Ee.div,{animate:{rotate:-360,x:[0,20,0],y:[0,-10,0]},transition:{rotate:{duration:25,repeat:1/0,ease:"linear"},x:{duration:5,repeat:1/0,ease:"easeInOut"},y:{duration:6,repeat:1/0,ease:"easeInOut"}},className:"absolute -bottom-4 -left-4 w-24 h-24 bg-white/10 rounded-full blur-xl"}),s.jsx(Ee.div,{animate:{y:[0,-8,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},className:"absolute top-1/2 right-1/4 w-3 h-3 bg-white/30 rounded-full"}),s.jsx(Ee.div,{animate:{y:[0,8,0]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut",delay:.5},className:"absolute bottom-1/3 left-1/3 w-2 h-2 bg-white/20 rounded-full"})]}),s.jsx("div",{className:"relative z-10",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx(Ee.div,{animate:{rotate:[0,10,-10,0],scale:[1,1.05,1]},transition:{duration:4,repeat:1/0,ease:"easeInOut"},className:"w-14 h-14 rounded-2xl bg-white/20 backdrop-blur-sm flex items-center justify-center shrink-0",children:s.jsx(Ur,{className:"h-7 w-7 text-white"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-bold mb-1",children:"Continue reciclando!"}),s.jsx("p",{className:"text-sm text-white/80 leading-relaxed mb-3",children:"Cada entrega faz a diferena para o planeta e gera pontos para voc trocar por benefcios."}),s.jsx(Ee.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.6,type:"spring"},className:"bg-white/15 backdrop-blur-sm rounded-xl p-3 mb-4 border border-white/20",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ee.div,{animate:{scale:[1,1.1,1],rotate:[0,5,-5,0]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},className:"w-10 h-10 rounded-lg bg-white/20 flex items-center justify-center",children:s.jsx(Eo,{className:"h-5 w-5 text-white"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xs text-white/70 mb-0.5",children:"Meta para prximo ms"}),s.jsxs("div",{className:"flex items-baseline gap-1",children:[s.jsx("span",{className:"text-2xl font-bold text-white",children:s.jsx(b,{value:v})}),s.jsx("span",{className:"text-sm text-white/80",children:"kg"}),s.jsx(Ee.span,{animate:{y:[0,-3,0]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},className:"ml-1 text-xs text-emerald-200",children:" +20%"})]})]})]})}),s.jsx(Ee.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:s.jsxs(oe,{onClick:()=>t("/deliver-recyclables"),className:"w-full sm:w-auto bg-white text-primary hover:bg-white/90 rounded-xl px-6 py-2.5 font-semibold shadow-lg shadow-black/10 gap-2",children:[s.jsx(Ee.span,{animate:{rotate:[0,360]},transition:{duration:3,repeat:1/0,ease:"linear"},children:s.jsx(Md,{className:"h-4 w-4"})}),"Nova entrega",s.jsx(Ee.span,{animate:{x:[0,4,0]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},children:""})]})})]})]})})]})]})]})}const rZ={todos:{label:"Todos os Materiais",icon:fs},disponivel:{label:"Disponveis",icon:fs},em_entrega:{label:"Em Entrega",icon:tl},entregue:{label:"Entregues",icon:Tr}};function aZ(){const{user:e}=sr(),t=ds(),[r,a]=E.useState([]),[n,i]=E.useState(!0),[o,c]=E.useState("todos");E.useEffect(()=>{e&&d()},[e]);const d=async()=>{if(e)try{const{data:I,error:B}=await J.from("materiais_reciclaveis_usuario").select("*").eq("id_usuario",e.id).order("data_cadastro",{ascending:!1});if(B)throw B;a(I||[])}catch(I){console.error("Erro ao carregar materiais:",I)}finally{i(!1)}},h=I=>r.filter(B=>B.status===I),p=()=>o==="todos"?r:h(o),x={disponivel:h("disponivel").length,em_entrega:h("em_entrega").length,entregue:h("entregue").length,total:r.length},b=r.filter(I=>I.status==="entregue").reduce((I,B)=>{const O=B.tipo_embalagem||"outros",D=(B.peso_total_estimado_gramas||0)/1e3;return I[O]||(I[O]={tipo:O,peso:0,quantidade:0}),I[O].peso+=D,I[O].quantidade+=1,I},{}),N=Object.values(b).map((I,B)=>({name:qi[I.tipo]||I.tipo,peso:I.peso,quantidade:I.quantidade,fill:`hsl(var(--chart-${B%5+1}))`})),_=N.reduce((I,B)=>I+B.peso,0),C=I=>{switch(I){case"disponivel":return s.jsx(Je,{className:"bg-blue-500/10 text-blue-600 border-blue-500/20 text-[10px]",children:"Disponvel"});case"em_entrega":return s.jsx(Je,{className:"bg-amber-500/10 text-amber-600 border-amber-500/20 text-[10px]",children:"Em Entrega"});case"entregue":return s.jsx(Je,{className:"bg-emerald-500/10 text-emerald-600 border-emerald-500/20 text-[10px]",children:"Entregue"});default:return null}},T=(I,B)=>s.jsx(Ee.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{delay:B*.03},children:s.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl bg-muted/30 hover:bg-muted/50 transition-colors border border-transparent hover:border-border/50",children:[s.jsx("div",{className:`p-2 rounded-lg ${I.status==="entregue"?"bg-emerald-500/10":I.status==="em_entrega"?"bg-amber-500/10":"bg-blue-500/10"}`,children:I.status==="entregue"?s.jsx(Tr,{className:"w-4 h-4 text-emerald-600"}):I.status==="em_entrega"?s.jsx(tl,{className:"w-4 h-4 text-amber-600"}):s.jsx(fs,{className:"w-4 h-4 text-blue-600"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsx("p",{className:"font-medium text-sm text-foreground truncate",children:I.descricao}),C(I.status)]}),s.jsxs("div",{className:"flex items-center gap-2 mt-1 flex-wrap",children:[s.jsx(Je,{variant:"outline",className:"text-[10px] h-5",children:qi[I.tipo_embalagem]}),s.jsxs("span",{className:"text-[10px] text-muted-foreground",children:[I.percentual_reciclabilidade,"% reciclvel"]})]}),s.jsxs("div",{className:"flex items-center justify-between mt-2",children:[s.jsx("span",{className:"text-[10px] text-muted-foreground",children:I.data_entrega?`Entregue em ${new Date(I.data_entrega).toLocaleDateString("pt-BR")}`:new Date(I.data_cadastro).toLocaleDateString("pt-BR")}),s.jsxs(Je,{className:"bg-primary/10 text-primary border-primary/20 text-[10px]",children:["+",I.pontos_ganhos," pts"]})]})]})]})},I.id),A=({active:I,payload:B})=>I&&B&&B.length?s.jsxs("div",{className:"bg-background border border-border rounded-lg p-3 shadow-lg",children:[s.jsx("p",{className:"font-semibold text-foreground",children:B[0].name}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Peso: ",gr(B[0].value)]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Itens: ",B[0].payload.quantidade]})]}):null,k=p();return s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-8",children:s.jsxs("div",{className:"mx-auto max-w-4xl space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>t("/user"),children:s.jsx(As,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Meus Materiais Reciclveis"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Histrico completo de materiais cadastrados"})]})]}),n?s.jsx(Ne,{children:s.jsx(De,{className:"p-6",children:s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[s.jsxs(Ee.button,{whileTap:{scale:.98},onClick:()=>c("disponivel"),className:`p-4 rounded-xl text-center transition-all ${o==="disponivel"?"bg-blue-500/20 ring-2 ring-blue-500/50":"bg-blue-500/10 hover:bg-blue-500/15"}`,children:[s.jsx(fs,{className:"w-6 h-6 mx-auto text-blue-600 mb-1"}),s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:x.disponivel}),s.jsx("p",{className:"text-xs text-blue-600/80",children:"Disponveis"})]}),s.jsxs(Ee.button,{whileTap:{scale:.98},onClick:()=>c("em_entrega"),className:`p-4 rounded-xl text-center transition-all ${o==="em_entrega"?"bg-amber-500/20 ring-2 ring-amber-500/50":"bg-amber-500/10 hover:bg-amber-500/15"}`,children:[s.jsx(tl,{className:"w-6 h-6 mx-auto text-amber-600 mb-1"}),s.jsx("p",{className:"text-2xl font-bold text-amber-600",children:x.em_entrega}),s.jsx("p",{className:"text-xs text-amber-600/80",children:"Em Entrega"})]}),s.jsxs(Ee.button,{whileTap:{scale:.98},onClick:()=>c("entregue"),className:`p-4 rounded-xl text-center transition-all ${o==="entregue"?"bg-emerald-500/20 ring-2 ring-emerald-500/50":"bg-emerald-500/10 hover:bg-emerald-500/15"}`,children:[s.jsx(Tr,{className:"w-6 h-6 mx-auto text-emerald-600 mb-1"}),s.jsx("p",{className:"text-2xl font-bold text-emerald-600",children:x.entregue}),s.jsx("p",{className:"text-xs text-emerald-600/80",children:"Entregues"})]})]}),N.length>0&&s.jsx(Ne,{children:s.jsxs(De,{className:"p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold mb-3 text-foreground flex items-center gap-2",children:[s.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-primary"}),"Materiais Entregues por Tipo"]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(mi,{width:140,height:140,children:s.jsxs(Pw,{children:[s.jsx(Iw,{data:N,cx:"50%",cy:"50%",innerRadius:40,outerRadius:65,paddingAngle:2,dataKey:"peso",children:N.map((I,B)=>s.jsx(Ow,{fill:I.fill},`cell-${B}`))}),s.jsx(pi,{content:s.jsx(A,{})})]})}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-sm font-bold text-foreground",children:gr(_)}),s.jsx("p",{className:"text-[10px] text-muted-foreground",children:"total"})]})})]}),s.jsx("div",{className:"flex-1 space-y-2",children:N.map((I,B)=>s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:I.fill}}),s.jsx("span",{className:"text-muted-foreground",children:I.name})]}),s.jsx("span",{className:"font-medium text-foreground",children:gr(I.peso)})]},B))})]})]})}),s.jsx(Ne,{children:s.jsxs(De,{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Of,{className:"w-4 h-4 text-muted-foreground"}),s.jsxs(qs,{value:o,onValueChange:I=>c(I),children:[s.jsx(Ls,{className:"w-[180px] h-9 text-sm",children:s.jsx(Ws,{})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"todos",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(fs,{className:"w-4 h-4"}),s.jsxs("span",{children:["Todos (",x.total,")"]})]})}),s.jsx(xt,{value:"disponivel",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(fs,{className:"w-4 h-4 text-blue-600"}),s.jsxs("span",{children:["Disponveis (",x.disponivel,")"]})]})}),s.jsx(xt,{value:"em_entrega",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(tl,{className:"w-4 h-4 text-amber-600"}),s.jsxs("span",{children:["Em Entrega (",x.em_entrega,")"]})]})}),s.jsx(xt,{value:"entregue",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Tr,{className:"w-4 h-4 text-emerald-600"}),s.jsxs("span",{children:["Entregues (",x.entregue,")"]})]})})]})]})]}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:[k.length," ",k.length===1?"item":"itens"]})]}),s.jsx("div",{className:"space-y-2",children:s.jsx(Qi,{mode:"popLayout",children:k.length===0?s.jsxs(Ee.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-8",children:[s.jsx(fs,{className:"w-12 h-12 mx-auto text-muted-foreground/30 mb-3"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:o==="todos"?"Nenhum material cadastrado ainda":`Nenhum material ${rZ[o].label.toLowerCase()}`})]}):k.map((I,B)=>T(I,B))})})]})})]})]})})}function nZ(){const{user:e}=sr(),[t,r]=E.useState([]),a=ds(),{toast:n}=_r();E.useEffect(()=>{i()},[e]);const i=async()=>{if(!e)return;const{data:c}=await J.from("cupons").select("*").eq("id_usuario_resgatou",e.id).order("data_resgate",{ascending:!1});c&&r(c)},o=c=>{navigator.clipboard.writeText(c),n({title:"Cdigo copiado!",description:"O cdigo do cupom foi copiado"})};return s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-8",children:s.jsxs("div",{className:"mx-auto max-w-4xl space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>a("/user"),children:s.jsx(As,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Meus Cupons"}),s.jsx("p",{className:"text-muted-foreground",children:"Seus cupons resgatados"})]})]}),s.jsxs("div",{className:"space-y-4",children:[t.map(c=>s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(Jn,{className:"h-5 w-5 text-primary"}),c.marketplace]}),s.jsxs(Tt,{children:["Valor: R$ ",c.valor.toFixed(2)," | Mnimo: R$ ",c.minimo_compra.toFixed(2)]})]}),s.jsx(Je,{variant:c.status==="usado"?"secondary":"default",children:c.status==="usado"?"Usado":"Disponvel"})]})}),s.jsx(De,{children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("code",{className:"flex-1 bg-muted px-4 py-2 rounded font-mono",children:c.codigo}),s.jsx(oe,{size:"icon",variant:"outline",onClick:()=>o(c.codigo),children:s.jsx(ep,{className:"h-4 w-4"})})]})})]},c.id)),t.length===0&&s.jsx(Ne,{children:s.jsxs(De,{className:"py-12 text-center",children:[s.jsx(Jn,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Voc ainda no resgatou cupons"})]})})]})]})})}function iZ({codigoIndicacao:e,userId:t}){const{toast:r}=_r(),[a,n]=E.useState([]),[i,o]=E.useState(!0);E.useEffect(()=>{c()},[t]);const c=async()=>{const{data:N}=await J.from("indicacoes").select(`
        id,
        data_indicacao,
        pontos_primeira_missao_concedidos,
        id_indicado
      `).eq("id_indicador",t).order("data_indicacao",{ascending:!1});if(N){const _=await Promise.all(N.map(async C=>{const{data:T}=await J.from("profiles").select("nome, email").eq("id",C.id_indicado).single();return{...C,profiles:T||{nome:"Usurio",email:""}}}));n(_)}o(!1)},d=Il(`/auth?ref=${e}`),h=encodeURIComponent(` Junte-se a mim no Ciclik - Digital Verde!

Use meu cdigo de indicao: ${e}

Voc ganha pontos ao se cadastrar e eu tambm ganho quando voc completar sua primeira misso! 

${d}`),p=()=>{navigator.clipboard.writeText(e),r({title:"Cdigo copiado!",description:"Seu cdigo de indicao foi copiado"})},x=()=>{navigator.clipboard.writeText(d),r({title:"Link copiado!",description:"Link de indicao copiado para rea de transferncia"})},v=()=>{window.open(`https://wa.me/?text=${h}`,"_blank")},b=a.reduce((N,_)=>N+40+(_.pontos_primeira_missao_concedidos?20:0),0);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs(Ne,{className:"border-green-500/20 bg-gradient-to-br from-green-500/5 to-emerald-500/5",children:[s.jsxs(Ye,{children:[s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(Ex,{className:"h-5 w-5 text-green-600"}),"Indique Amigos e Ganhe Pontos!"]}),s.jsx(Tt,{children:"Ganhe +40 pontos quando um amigo se cadastrar com seu cdigo, e mais +20 pontos quando ele completar a primeira misso"})]}),s.jsxs(De,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(oZ,{className:"text-sm font-medium",children:"Seu Cdigo de Indicao"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(We,{value:e,readOnly:!0,className:"font-mono text-lg font-bold text-center"}),s.jsx(oe,{onClick:p,variant:"outline",size:"icon",children:s.jsx(ep,{className:"h-4 w-4"})})]})]}),s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsxs(oe,{onClick:v,className:"w-full",variant:"default",children:[s.jsx(Ex,{className:"mr-2 h-4 w-4"}),"Compartilhar via WhatsApp"]}),s.jsxs(oe,{onClick:x,variant:"outline",className:"w-full",children:[s.jsx(ep,{className:"mr-2 h-4 w-4"}),"Copiar Link de Indicao"]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t",children:[s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"flex items-center justify-center gap-1 text-2xl font-bold text-green-600",children:[s.jsx(oa,{className:"h-5 w-5"}),a.length]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Amigos Indicados"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"flex items-center justify-center gap-1 text-2xl font-bold text-green-600",children:[s.jsx(Jn,{className:"h-5 w-5"}),b]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Pontos Ganhos"})]})]})]})]}),a.length>0&&s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsx(Qe,{className:"text-lg",children:"Minhas Indicaes"})}),s.jsx(De,{children:s.jsx("div",{className:"space-y-3",children:a.map(N=>s.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:N.profiles.nome}),s.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(N.data_indicacao).toLocaleDateString("pt-BR")})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(Je,{variant:"default",children:"+40pts"}),N.pontos_primeira_missao_concedidos&&s.jsxs(Je,{variant:"secondary",className:"gap-1",children:[s.jsx(_n,{className:"h-3 w-3"}),"+20pts"]})]})]},N.id))})})]})]})}function oZ({children:e,className:t}){return s.jsx("label",{className:t,children:e})}var hP={exports:{}},fP={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jf=E;function lZ(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var cZ=typeof Object.is=="function"?Object.is:lZ,dZ=jf.useState,uZ=jf.useEffect,hZ=jf.useLayoutEffect,fZ=jf.useDebugValue;function mZ(e,t){var r=t(),a=dZ({inst:{value:r,getSnapshot:t}}),n=a[0].inst,i=a[1];return hZ(function(){n.value=r,n.getSnapshot=t,uv(n)&&i({inst:n})},[e,r,t]),uZ(function(){return uv(n)&&i({inst:n}),e(function(){uv(n)&&i({inst:n})})},[e]),fZ(r),r}function uv(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!cZ(e,r)}catch{return!0}}function pZ(e,t){return t()}var xZ=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?pZ:mZ;fP.useSyncExternalStore=jf.useSyncExternalStore!==void 0?jf.useSyncExternalStore:xZ;hP.exports=fP;var gZ=hP.exports;function vZ(){return gZ.useSyncExternalStore(yZ,()=>!0,()=>!1)}function yZ(){return()=>{}}var N_="Avatar",[wZ,Gue]=bi(N_),[bZ,mP]=wZ(N_),pP=E.forwardRef((e,t)=>{const{__scopeAvatar:r,...a}=e,[n,i]=E.useState("idle");return s.jsx(bZ,{scope:r,imageLoadingStatus:n,onImageLoadingStatusChange:i,children:s.jsx(ys.span,{...a,ref:t})})});pP.displayName=N_;var xP="AvatarImage",gP=E.forwardRef((e,t)=>{const{__scopeAvatar:r,src:a,onLoadingStatusChange:n=()=>{},...i}=e,o=mP(xP,r),c=_Z(a,i),d=dc(h=>{n(h),o.onImageLoadingStatusChange(h)});return Ji(()=>{c!=="idle"&&d(c)},[c,d]),c==="loaded"?s.jsx(ys.img,{...i,ref:t,src:a}):null});gP.displayName=xP;var vP="AvatarFallback",yP=E.forwardRef((e,t)=>{const{__scopeAvatar:r,delayMs:a,...n}=e,i=mP(vP,r),[o,c]=E.useState(a===void 0);return E.useEffect(()=>{if(a!==void 0){const d=window.setTimeout(()=>c(!0),a);return()=>window.clearTimeout(d)}},[a]),o&&i.imageLoadingStatus!=="loaded"?s.jsx(ys.span,{...n,ref:t}):null});yP.displayName=vP;function uE(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function _Z(e,{referrerPolicy:t,crossOrigin:r}){const a=vZ(),n=E.useRef(null),i=a?(n.current||(n.current=new window.Image),n.current):null,[o,c]=E.useState(()=>uE(i,e));return Ji(()=>{c(uE(i,e))},[i,e]),Ji(()=>{const d=x=>()=>{c(x)};if(!i)return;const h=d("loaded"),p=d("error");return i.addEventListener("load",h),i.addEventListener("error",p),t&&(i.referrerPolicy=t),typeof r=="string"&&(i.crossOrigin=r),()=>{i.removeEventListener("load",h),i.removeEventListener("error",p)}},[i,r,t]),o}var wP=pP,bP=gP,_P=yP;const C_=E.forwardRef(({className:e,...t},r)=>s.jsx(wP,{ref:r,className:pt("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));C_.displayName=wP.displayName;const jP=E.forwardRef(({className:e,...t},r)=>s.jsx(bP,{ref:r,className:pt("aspect-square h-full w-full",e),...t}));jP.displayName=bP.displayName;const E_=E.forwardRef(({className:e,...t},r)=>s.jsx(_P,{ref:r,className:pt("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));E_.displayName=_P.displayName;function jZ(){const{user:e,profile:t,refreshProfile:r}=sr(),[a,n]=E.useState(!1),i=E.useRef(null),{toast:o}=_r(),c=async p=>{try{if(n(!0),!p.target.files||p.target.files.length===0)return;const x=p.target.files[0],v=x.name.split(".").pop(),b=`${e==null?void 0:e.id}/${Date.now()}.${v}`;if(!x.type.startsWith("image/")){o({title:"Arquivo invlido",description:"Por favor, selecione uma imagem",variant:"destructive"});return}if(x.size>5*1024*1024){o({title:"Arquivo muito grande",description:"A imagem deve ter no mximo 5MB",variant:"destructive"});return}const{error:N}=await J.storage.from("avatars").upload(b,x,{upsert:!0});if(N)throw N;const{data:{publicUrl:_}}=J.storage.from("avatars").getPublicUrl(b),{error:C}=await J.from("profiles").update({avatar_url:_}).eq("id",e==null?void 0:e.id);if(C)throw C;await r(),o({title:"Foto atualizada!",description:"Sua foto de perfil foi atualizada com sucesso"})}catch(x){o({title:"Erro no upload",description:x.message,variant:"destructive"})}finally{n(!1)}},d=async()=>{try{if(n(!0),t!=null&&t.avatar_url){const x=t.avatar_url.split("/avatars/");if(x.length>1){const v=x[1];await J.storage.from("avatars").remove([v])}}const{error:p}=await J.from("profiles").update({avatar_url:null}).eq("id",e==null?void 0:e.id);if(p)throw p;await r(),o({title:"Foto removida!",description:"Sua foto de perfil foi removida"})}catch(p){o({title:"Erro ao remover foto",description:p.message,variant:"destructive"})}finally{n(!1)}},h=p=>p.split(" ").map(x=>x[0]).join("").toUpperCase().slice(0,2);return s.jsxs("div",{className:"flex flex-col items-center gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsxs(C_,{className:"h-32 w-32",children:[s.jsx(jP,{src:(t==null?void 0:t.avatar_url)||void 0}),s.jsx(E_,{className:"text-2xl",children:t!=null&&t.nome?h(t.nome):s.jsx(Ri,{className:"h-12 w-12"})})]}),s.jsx(oe,{type:"button",size:"icon",className:"absolute bottom-0 right-0 rounded-full h-10 w-10",onClick:()=>{var p;return(p=i.current)==null?void 0:p.click()},disabled:a,children:a?s.jsx(_s,{className:"h-4 w-4 animate-spin"}):s.jsx(jx,{className:"h-4 w-4"})})]}),s.jsx("input",{ref:i,type:"file",accept:"image/*",onChange:c,className:"hidden",disabled:a}),s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsxs("p",{className:"text-sm text-muted-foreground text-center",children:["Clique no cone de cmera para alterar sua foto",s.jsx("br",{}),s.jsx("span",{className:"text-xs",children:"Mximo 5MB - JPG, PNG ou WEBP"})]}),(t==null?void 0:t.avatar_url)&&s.jsxs(oe,{type:"button",variant:"outline",size:"sm",onClick:d,disabled:a,className:"text-destructive hover:text-destructive",children:[s.jsx(Ba,{className:"h-4 w-4 mr-2"}),"Remover foto"]})]})]})}const NZ={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},mh={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4}}};function CZ(){var b;const{profile:e,user:t,refreshProfile:r}=sr(),[a,n]=E.useState(!1),i=ds(),{toast:o}=_r(),[c,d]=E.useState({nome:(e==null?void 0:e.nome)||"",telefone:(e==null?void 0:e.telefone)||"",cep:(e==null?void 0:e.cep)||"",numero:(e==null?void 0:e.numero)||"",complemento:(e==null?void 0:e.complemento)||"",linkedin_profile:(e==null?void 0:e.linkedin_profile)||"",instagram_handle:(e==null?void 0:e.instagram_handle)||""}),[h,p]=E.useState({}),x=()=>{const N={};if(c.linkedin_profile&&c.linkedin_profile.trim()){const C=qn().url({message:"URL do LinkedIn invlida"}).refine(T=>T.includes("linkedin.com/"),{message:"Deve ser uma URL do LinkedIn"}).safeParse(c.linkedin_profile.trim());C.success||(N.linkedin_profile=C.error.errors[0].message)}if(c.instagram_handle&&c.instagram_handle.trim()){const C=qn().trim().min(1,{message:"Handle vazio"}).max(30,{message:"Mximo 30 caracteres"}).regex(/^@?[a-zA-Z0-9._]+$/,{message:"Use apenas letras, nmeros, . e _"}).safeParse(c.instagram_handle.trim());C.success||(N.instagram_handle=C.error.errors[0].message)}return p(N),Object.keys(N).length===0},v=async N=>{var _,C;if(N.preventDefault(),!x()){o({title:"Erro de validao",description:"Corrija os erros no formulrio",variant:"destructive"});return}n(!0);try{const T={...c,linkedin_profile:((_=c.linkedin_profile)==null?void 0:_.trim())||null,instagram_handle:(C=c.instagram_handle)!=null&&C.trim()?c.instagram_handle.trim().startsWith("@")?c.instagram_handle.trim():`@${c.instagram_handle.trim()}`:null},{error:A}=await J.from("profiles").update(T).eq("id",t==null?void 0:t.id);if(A)throw A;await r(),o({title:"Perfil atualizado!",description:"Suas informaes foram salvas"}),i("/user")}catch(T){o({title:"Erro",description:T.message,variant:"destructive"})}finally{n(!1)}};return s.jsx(Nc,{children:s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-background to-muted/30",children:[s.jsx("div",{className:"bg-card/80 backdrop-blur-md border-b border-border/50 sticky top-0 z-40",children:s.jsx("div",{className:"mx-auto max-w-lg px-4 py-3",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ee.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>i("/user"),className:"p-2 rounded-xl bg-muted/50 hover:bg-muted transition-colors",children:s.jsx(As,{className:"h-5 w-5 text-foreground"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h1",{className:"text-lg font-semibold text-foreground",children:"Meu Perfil"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Edite suas informaes"})]}),s.jsx(Ee.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:v,disabled:a,className:"p-2.5 rounded-xl bg-primary text-primary-foreground hover:bg-primary/90 transition-colors disabled:opacity-50",children:a?s.jsx(_s,{className:"h-5 w-5 animate-spin"}):s.jsx(Ea,{className:"h-5 w-5"})})]})})}),s.jsxs(Ee.div,{variants:NZ,initial:"hidden",animate:"visible",className:"mx-auto max-w-lg px-4 py-6 space-y-4",children:[s.jsx(Ee.div,{variants:mh,children:s.jsx(Ne,{className:"border-0 shadow-lg bg-card/50 backdrop-blur-sm rounded-2xl overflow-hidden",children:s.jsxs(De,{className:"p-6 flex flex-col items-center",children:[s.jsx(jZ,{}),s.jsx("p",{className:"mt-3 text-sm font-medium text-foreground",children:e==null?void 0:e.nome}),s.jsx("p",{className:"text-xs text-muted-foreground",children:e==null?void 0:e.email})]})})}),s.jsx(Ee.div,{variants:mh,children:s.jsx(Ne,{className:"border-0 shadow-lg bg-card/50 backdrop-blur-sm rounded-2xl overflow-hidden",children:s.jsxs(De,{className:"p-5 space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:s.jsx(Ri,{className:"h-4 w-4 text-primary"})}),s.jsx("span",{className:"text-sm font-medium text-foreground",children:"Dados Pessoais"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"relative",children:[s.jsx(ke,{className:"text-xs text-muted-foreground mb-1.5 block",children:"Nome"}),s.jsx(We,{value:c.nome,onChange:N=>d({...c,nome:N.target.value}),className:"h-11 rounded-xl bg-muted/50 border-0 focus:ring-2 focus:ring-primary/20",required:!0})]}),s.jsxs("div",{className:"relative",children:[s.jsxs(ke,{className:"text-xs text-muted-foreground mb-1.5 flex items-center gap-1.5",children:[s.jsx(Bw,{className:"h-3 w-3"}),"Telefone"]}),s.jsx(We,{value:c.telefone,onChange:N=>d({...c,telefone:N.target.value}),className:"h-11 rounded-xl bg-muted/50 border-0 focus:ring-2 focus:ring-primary/20",placeholder:"(00) 00000-0000"})]})]})]})})}),s.jsx(Ee.div,{variants:mh,children:s.jsx(Ne,{className:"border-0 shadow-lg bg-card/50 backdrop-blur-sm rounded-2xl overflow-hidden",children:s.jsxs(De,{className:"p-5 space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:s.jsx(Co,{className:"h-4 w-4 text-primary"})}),s.jsx("span",{className:"text-sm font-medium text-foreground",children:"Endereo"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx(ke,{className:"text-xs text-muted-foreground mb-1.5 block",children:"CEP"}),s.jsx(We,{value:c.cep,onChange:N=>d({...c,cep:N.target.value}),className:"h-11 rounded-xl bg-muted/50 border-0 focus:ring-2 focus:ring-primary/20",placeholder:"00000-000"})]}),s.jsxs("div",{children:[s.jsxs(ke,{className:"text-xs text-muted-foreground mb-1.5 flex items-center gap-1",children:[s.jsx(_6,{className:"h-3 w-3"}),"Nmero"]}),s.jsx(We,{value:c.numero,onChange:N=>d({...c,numero:N.target.value}),className:"h-11 rounded-xl bg-muted/50 border-0 focus:ring-2 focus:ring-primary/20"})]})]}),s.jsxs("div",{children:[s.jsxs(ke,{className:"text-xs text-muted-foreground mb-1.5 flex items-center gap-1",children:[s.jsx(hn,{className:"h-3 w-3"}),"Complemento"]}),s.jsx(We,{value:c.complemento,onChange:N=>d({...c,complemento:N.target.value}),className:"h-11 rounded-xl bg-muted/50 border-0 focus:ring-2 focus:ring-primary/20",placeholder:"Apto, Bloco, etc."})]})]})})}),s.jsx(Ee.div,{variants:mh,children:s.jsx(Ne,{className:"border-0 shadow-lg bg-card/50 backdrop-blur-sm rounded-2xl overflow-hidden",children:s.jsxs(De,{className:"p-5 space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:s.jsx(Ex,{className:"h-4 w-4 text-primary"})}),s.jsx("span",{className:"text-sm font-medium text-foreground",children:"Redes Sociais"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsxs(ke,{className:"text-xs text-muted-foreground mb-1.5 flex items-center gap-1.5",children:[s.jsx(C6,{className:"h-3 w-3 text-[#0A66C2]"}),"LinkedIn"]}),s.jsx(We,{type:"url",placeholder:"https://linkedin.com/in/seu-perfil",value:c.linkedin_profile,onChange:N=>{d({...c,linkedin_profile:N.target.value}),h.linkedin_profile&&p({...h,linkedin_profile:""})},className:`h-11 rounded-xl bg-muted/50 border-0 focus:ring-2 focus:ring-primary/20 ${h.linkedin_profile?"ring-2 ring-destructive/50":""}`}),h.linkedin_profile&&s.jsx("p",{className:"text-xs text-destructive mt-1",children:h.linkedin_profile})]}),s.jsxs("div",{children:[s.jsxs(ke,{className:"text-xs text-muted-foreground mb-1.5 flex items-center gap-1.5",children:[s.jsx(N6,{className:"h-3 w-3 text-[#E4405F]"}),"Instagram"]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("div",{className:"flex items-center justify-center px-3 h-11 bg-muted/50 rounded-xl",children:s.jsx("span",{className:"text-sm text-muted-foreground",children:"@"})}),s.jsx(We,{type:"text",placeholder:"seu_usuario",value:((b=c.instagram_handle)==null?void 0:b.replace("@",""))||"",onChange:N=>{d({...c,instagram_handle:N.target.value.replace("@","")}),h.instagram_handle&&p({...h,instagram_handle:""})},className:`h-11 rounded-xl bg-muted/50 border-0 focus:ring-2 focus:ring-primary/20 ${h.instagram_handle?"ring-2 ring-destructive/50":""}`,maxLength:30})]}),h.instagram_handle&&s.jsx("p",{className:"text-xs text-destructive mt-1",children:h.instagram_handle})]})]})]})})}),(e==null?void 0:e.codigo_indicacao)&&(t==null?void 0:t.id)&&s.jsx(Ee.div,{variants:mh,children:s.jsx(iZ,{codigoIndicacao:e.codigo_indicacao,userId:t.id})}),s.jsx(Ee.div,{variants:mh,className:"pb-6",children:s.jsxs(oe,{onClick:v,disabled:a,className:"w-full h-12 rounded-xl font-medium shadow-lg",children:[a?s.jsx(_s,{className:"mr-2 h-4 w-4 animate-spin"}):s.jsx(Ea,{className:"mr-2 h-4 w-4"}),"Salvar Alteraes"]})})]})]})})}function EZ({entrega:e,onScanQR:t}){const r=o=>{const d={ativa:{variant:"default",label:"Aguardando"},em_coleta:{variant:"secondary",label:"Em Coleta"},finalizada:{variant:"default",label:"Finalizada"},expirada:{variant:"destructive",label:"Expirada"}}[o]||{variant:"outline",label:o};return s.jsx(Je,{variant:d.variant,children:d.label})},a=()=>{const o=new Date(e.data_geracao),c=new Date(o.getTime()+24*60*60*1e3);return new Date>c?"Expirado":Ad(c,{locale:$s,addSuffix:!0})},n=()=>{const o=new Date(e.data_geracao),c=new Date(o.getTime()+24*60*60*1e3),d=new Date,h=(c.getTime()-d.getTime())/(1e3*60*60);return h<=2&&h>0},i=()=>{var h;if(!((h=e.profiles)!=null&&h.nome))return"Entregador no identificado";const o=e.profiles.cpf||e.profiles.cnpj;if(!o)return"Entregador no identificado";const c=o.replace(/\D/g,"");if(c.length===14)return`${c.substring(0,3)} - ${e.profiles.nome}`;{const p=c.substring(0,3),x=e.profiles.nome.split(" ")[0];return`${p} - ${x}`}};return s.jsx(Ne,{className:`transition-all hover:shadow-lg ${n()?"border-warning":""}`,children:s.jsx(De,{className:"pt-6",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ri,{className:"h-4 w-4 text-muted-foreground"}),s.jsx("span",{className:"font-medium",children:i()})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(fs,{className:"h-3 w-3"}),s.jsx("span",{children:e.tipo_material}),s.jsx("span",{children:""}),s.jsx("span",{children:gr(e.peso_estimado||0)})]})]}),r(e.status_promessa)]}),s.jsxs("div",{className:`flex items-center gap-2 text-sm ${n()?"text-warning":"text-muted-foreground"}`,children:[s.jsx(Gn,{className:"h-4 w-4"}),s.jsx("span",{children:a()})]}),s.jsxs("div",{className:"bg-muted/50 p-2 rounded text-xs font-mono",children:["ID: ",e.id.substring(0,8),"..."]})]})})})}function SZ(){const{user:e,profile:t,signOut:r}=sr(),[a,n]=E.useState(null),[i,o]=E.useState([]),[c,d]=E.useState([]),[h,p]=E.useState([]),[x,v]=E.useState([]),[b,N]=E.useState("all"),[_,C]=E.useState("all"),[T,A]=E.useState({totalEntregas:0,entregasPendentes:0,entregasEmColeta:0,entregasEmTriagem:0,pesoTotal:0,pontuacao:100,entregasMes:0}),k=ds(),{run:I,completeTour:B,startTour:O}=f_({tourKey:"cooperative-welcome",autoStart:!1}),D=[{target:"body",content:"Bem-vindo ao seu Painel do Operador! Vamos fazer um tour rpido para voc conhecer todas as funcionalidades.",placement:"center",disableBeacon:!0},{target:'[data-tour="header"]',content:"Este  o cabealho com o nome do seu operador logstico. Use o boto de sair quando quiser encerrar a sesso.",disableBeacon:!0},{target:'[data-tour="status"]',content:"Aqui voc v o status do seu operador e a pontuao de confiabilidade. Quanto maior a pontuao, melhor!",disableBeacon:!0},{target:'[data-tour="stats"]',content:"Estas so suas estatsticas principais: promessas ativas, entregas do ms, total geral e peso total coletado.",disableBeacon:!0},{target:'[data-tour="tabs"]',content:"Use estas abas para alternar entre entregas previstas (promessas ativas) e entregas j realizadas.",disableBeacon:!0},{target:'[data-tour="scan-action"]',content:"Quando um usurio chegar para entregar materiais, clique aqui para escanear o QR Code dele e iniciar a coleta!",disableBeacon:!0}];E.useEffect(()=>{if(!e)return;F(),M(),Y(),ae(),je(),H();const Z=setInterval(()=>{document.hidden||(M(),Y(),ae(),je(),H())},3e4);return()=>{clearInterval(Z)}},[e==null?void 0:e.id,b,_]),E.useEffect(()=>{if(a&&!localStorage.getItem("tour_completed_cooperative-welcome")){const G=setTimeout(()=>{O()},500);return()=>clearTimeout(G)}},[a,O]);const F=async()=>{if(e)try{const{data:Z}=await J.from("cooperativas").select("*").eq("id_user",e.id).single();Z&&n(Z)}catch(Z){console.error("Erro ao carregar cooperativa:",Z)}},M=async()=>{if(!e)return;const{data:Z}=await J.from("cooperativas").select("id, pontuacao_confiabilidade").eq("id_user",e.id).single();if(!Z)return;const{data:G,error:Q}=await J.from("entregas_reciclaveis").select("*").eq("id_cooperativa",Z.id);if(Q){console.error("Erro ao carregar estatsticas:",Q);return}const re=(G==null?void 0:G.filter(ce=>ce.status_promessa==="ativa").length)||0,le=(G==null?void 0:G.filter(ce=>ce.status_promessa==="em_coleta").length)||0,ye=(G==null?void 0:G.filter(ce=>ce.status_promessa==="em_triagem").length)||0,W=(G==null?void 0:G.reduce((ce,xe)=>ce+(xe.peso_validado||0),0))||0,ee=new Date;ee.setDate(1),ee.setHours(0,0,0,0);const ie=(G==null?void 0:G.filter(ce=>ce.data_validacao&&new Date(ce.data_validacao)>=ee).length)||0;A({totalEntregas:(G==null?void 0:G.length)||0,entregasPendentes:re,entregasEmColeta:le,entregasEmTriagem:ye,pesoTotal:W,pontuacao:Z.pontuacao_confiabilidade,entregasMes:ie})},z=async()=>{ct.promise(Promise.all([M(),Y(),ae(),je(),H()]),{loading:"Atualizando dados...",success:"Dados atualizados!",error:"Erro ao atualizar"})},q=Z=>{if(!(Z!=null&&Z.nome))return"Entregador no identificado";const G=Z.cpf||Z.cnpj;if(!G)return"Entregador no identificado";const Q=G.replace(/\D/g,"");if(Q.length===14)return`${Q.substring(0,3)} - ${Z.nome}`;{const le=Q.substring(0,3),ye=Z.nome.split(" ")[0];return`${le} - ${ye}`}},Y=async()=>{if(!e)return;const{data:Z}=await J.from("cooperativas").select("id").eq("id_user",e.id).maybeSingle();if(!Z)return;const{data:G,error:Q}=await J.from("entregas_reciclaveis").select("*").eq("id_cooperativa",Z.id).eq("status_promessa","ativa").order("data_geracao",{ascending:!1,nullsFirst:!1}).limit(100);if(Q){console.error("Erro ao carregar entregas previstas:",Q);return}if(G){const re=[...new Set(G.map(W=>W.id_usuario))],{data:le}=await J.from("profiles").select("id, nome, cpf, cnpj").in("id",re),ye=G.map(W=>({...W,profiles:(le==null?void 0:le.find(ee=>ee.id===W.id_usuario))||null}));o(ye)}},ae=async()=>{if(!e)return;const{data:Z}=await J.from("cooperativas").select("id").eq("id_user",e.id).maybeSingle();if(!Z)return;const{data:G,error:Q}=await J.from("entregas_reciclaveis").select("*").eq("id_cooperativa",Z.id).eq("status_promessa","em_coleta").order("data_recebimento",{ascending:!1,nullsFirst:!1}).limit(100);if(Q){console.error("Erro ao carregar entregas em coleta:",Q);return}if(G){const re=[...new Set(G.map(W=>W.id_usuario))],{data:le}=await J.from("profiles").select("id, nome, cpf, cnpj").in("id",re),ye=G.map(W=>({...W,profiles:(le==null?void 0:le.find(ee=>ee.id===W.id_usuario))||null}));d(ye)}},je=async()=>{if(!e)return;const{data:Z}=await J.from("cooperativas").select("id").eq("id_user",e.id).maybeSingle();if(!Z)return;const{data:G,error:Q}=await J.from("entregas_reciclaveis").select("*").eq("id_cooperativa",Z.id).eq("status_promessa","em_triagem").order("data_envio_triagem",{ascending:!1,nullsFirst:!1}).limit(100);if(Q){console.error("Erro ao carregar entregas em triagem:",Q);return}if(G){const re=[...new Set(G.map(W=>W.id_usuario))],{data:le}=await J.from("profiles").select("id, nome, cpf, cnpj").in("id",re),ye=G.map(W=>({...W,profiles:(le==null?void 0:le.find(ee=>ee.id===W.id_usuario))||null}));p(ye)}},H=async()=>{if(!e)return;const{data:Z}=await J.from("cooperativas").select("id").eq("id_user",e.id).single();if(!Z)return;let G=J.from("entregas_reciclaveis").select("*").eq("id_cooperativa",Z.id).eq("status_promessa","finalizada");if(b!=="all"){const re=new Date;let le=new Date;b==="week"?le.setDate(re.getDate()-7):b==="month"?le.setMonth(re.getMonth()-1):b==="year"&&le.setFullYear(re.getFullYear()-1),G=G.gte("data_validacao",le.toISOString())}_!=="all"&&(G=G.eq("tipo_material",_));const{data:Q}=await G.order("data_validacao",{ascending:!1}).limit(50);if(Q){const re=[...new Set(Q.map(W=>W.id_usuario))],{data:le}=await J.from("profiles").select("id, nome, cpf, cnpj").in("id",re),ye=Q.map(W=>({...W,profiles:(le==null?void 0:le.find(ee=>ee.id===W.id_usuario))||null}));v(ye)}};return a?s.jsxs("div",{className:"min-h-screen bg-background p-4 md:p-8",children:[s.jsx(e_,{steps:D,run:I,onComplete:B,onSkip:B}),s.jsxs("div",{className:"mx-auto max-w-6xl space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between","data-tour":"header",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"rounded-full bg-primary p-2",children:s.jsx(Ur,{className:"h-6 w-6 text-primary-foreground"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:(a==null?void 0:a.nome_fantasia)||"Carregando..."}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Painel do Operador"})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(oe,{variant:"outline",size:"icon",onClick:z,title:"Atualizar dados",children:s.jsx(Kn,{className:"h-5 w-5"})}),s.jsx(oe,{variant:"ghost",size:"icon",onClick:O,title:"Ver tour guiado",children:s.jsx(Yi,{className:"h-5 w-5"})}),s.jsx(oe,{variant:"ghost",size:"icon",onClick:r,title:"Sair",children:s.jsx(gc,{className:"h-5 w-5"})})]})]}),a&&s.jsx(Ne,{"data-tour":"status",className:`border-2 ${a.status==="aprovada"?"border-success bg-success/5":a.status==="pendente_aprovacao"?"border-warning bg-warning/5":"border-destructive bg-destructive/5"}`,children:s.jsx(De,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Status do Operador"}),s.jsx(Je,{className:`mt-1 ${a.status==="aprovada"?"bg-success text-white":a.status==="pendente_aprovacao"?"bg-warning text-white":"bg-destructive text-white"}`,children:a.status==="aprovada"?"Aprovada":a.status==="pendente_aprovacao"?"Pendente Aprovao":"Suspensa"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(sp,{className:"h-5 w-5 text-warning"}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-2xl font-bold",children:T.pontuacao}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Confiabilidade"})]})]})]})})}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-5","data-tour":"stats",children:[s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-3",children:[s.jsx(Tt,{children:"Promessas Ativas"}),s.jsxs(Qe,{className:"text-3xl flex items-center gap-2",children:[s.jsx(Gn,{className:"h-6 w-6 text-warning"}),T.entregasPendentes]})]})}),s.jsx(Ne,{className:"border-2 border-primary/20 bg-primary/5",children:s.jsxs(Ye,{className:"pb-3",children:[s.jsx(Tt,{children:"Em Coleta"}),s.jsxs(Qe,{className:"text-3xl flex items-center gap-2",children:[s.jsx(fs,{className:"h-6 w-6 text-primary"}),T.entregasEmColeta]})]})}),s.jsx(Ne,{className:"border-2 border-amber-500/20 bg-amber-50",children:s.jsxs(Ye,{className:"pb-3",children:[s.jsx(Tt,{children:"Em Triagem"}),s.jsxs(Qe,{className:"text-3xl flex items-center gap-2",children:[s.jsx(Zi,{className:"h-6 w-6 text-amber-600"}),T.entregasEmTriagem]})]})}),s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-3",children:[s.jsx(Tt,{children:"Entregas no Ms"}),s.jsxs(Qe,{className:"text-3xl flex items-center gap-2",children:[s.jsx(Tr,{className:"h-6 w-6 text-success"}),T.entregasMes]})]})}),s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-3",children:[s.jsx(Tt,{children:"Peso Total"}),s.jsxs(Qe,{className:"text-3xl flex items-center gap-2",children:[s.jsx(Ir,{className:"h-6 w-6 text-success"}),gr(T.pesoTotal,1)]})]})})]}),s.jsxs(Mn,{defaultValue:"previstas",className:"w-full","data-tour":"tabs",children:[s.jsxs(Nn,{className:"grid w-full grid-cols-4",children:[s.jsxs(Gs,{value:"previstas",children:["Previstas (",i.length,")"]}),s.jsxs(Gs,{value:"em_coleta",children:["Em Coleta (",c.length,")"]}),s.jsxs(Gs,{value:"em_triagem",children:["Em Triagem (",h.length,")"]}),s.jsxs(Gs,{value:"realizadas",children:["Finalizadas (",x.length,")"]})]}),s.jsx(hr,{value:"previstas",className:"space-y-4",children:i.length===0?s.jsx(Ne,{children:s.jsx(De,{className:"pt-6",children:s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Kr,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Nenhuma entrega prevista no momento"})]})})}):s.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:i.map(Z=>s.jsx(EZ,{entrega:Z,onScanQR:()=>k("/cooperative/scan-qrcode")},Z.id))})}),s.jsx(hr,{value:"em_coleta",className:"space-y-4",children:c.length===0?s.jsx(Ne,{children:s.jsx(De,{className:"pt-6",children:s.jsxs("div",{className:"text-center py-8",children:[s.jsx(fs,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Nenhuma entrega em processo de coleta"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Entregas escaneadas aguardando registro de materiais"})]})})}):s.jsx("div",{className:"space-y-3",children:c.map(Z=>s.jsx(Ne,{className:"border-2 border-primary/30",children:s.jsx(De,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(fs,{className:"h-5 w-5 text-primary"}),s.jsxs("p",{className:"font-medium",children:["Entrega #",Z.id.slice(0,8)]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Ri,{className:"h-4 w-4 text-muted-foreground"}),s.jsx("span",{className:"font-medium text-foreground",children:q(Z.profiles)})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsxs("span",{children:["Recebido: ",new Date(Z.data_recebimento).toLocaleString("pt-BR")]}),s.jsx("span",{children:""}),s.jsx(Je,{variant:"outline",className:"text-xs",children:Z.tipo_material})]}),Z.peso_estimado&&s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Peso estimado: ",Z.peso_estimado.toFixed(2)," kg"]})]}),s.jsxs(oe,{onClick:()=>k(`/cooperative/register-materials/${Z.id}`),size:"lg",children:[s.jsx(Qa,{className:"mr-2 h-4 w-4"}),"Continuar Registro"]})]})})},Z.id))})}),s.jsx(hr,{value:"em_triagem",className:"space-y-4",children:h.length===0?s.jsx(Ne,{children:s.jsx(De,{className:"pt-6",children:s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Zi,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Nenhuma entrega aguardando triagem"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Entregas enviadas para triagem aparecero aqui"})]})})}):s.jsx("div",{className:"space-y-3",children:h.map(Z=>s.jsx(Ne,{className:"border-2 border-amber-500/30 hover:border-amber-500/50 transition-colors",children:s.jsx(De,{className:"pt-6",children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Zi,{className:"h-5 w-5 text-amber-600"}),s.jsxs("p",{className:"font-medium",children:["Entrega #",Z.id.slice(0,8)]}),s.jsx(Je,{variant:"outline",className:"ml-auto bg-amber-100 text-amber-900 border-amber-300",children:"Aguardando Triagem"})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Ri,{className:"h-4 w-4 text-muted-foreground"}),s.jsx("span",{className:"font-medium text-foreground",children:q(Z.profiles)})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsxs("span",{children:["Enviado: ",new Date(Z.data_envio_triagem).toLocaleString("pt-BR")]}),s.jsx("span",{children:""}),s.jsx(Je,{variant:"outline",className:"text-xs",children:Z.tipo_material})]}),Z.peso_validado&&s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Peso registrado: ",Z.peso_validado.toFixed(2)," kg"]}),s.jsxs(Er,{className:"bg-amber-50 border-amber-200",children:[s.jsx(Da,{className:"h-4 w-4 text-amber-600"}),s.jsxs(Sr,{className:"text-sm",children:["Use o ",s.jsx("strong",{children:"Scanner de QR Code"})," com o cdigo de triagem para iniciar o processo"]})]})]})})},Z.id))})}),s.jsxs(hr,{value:"realizadas",className:"space-y-4",children:[s.jsx(Ne,{children:s.jsx(De,{className:"pt-6",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("label",{className:"text-sm font-medium mb-2 flex items-center gap-2",children:[s.jsx(Of,{className:"h-4 w-4"}),"Perodo"]}),s.jsxs(qs,{value:b,onValueChange:N,children:[s.jsx(Ls,{children:s.jsx(Ws,{})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"all",children:"Todas as entregas"}),s.jsx(xt,{value:"week",children:"ltima semana"}),s.jsx(xt,{value:"month",children:"ltimo ms"}),s.jsx(xt,{value:"year",children:"ltimo ano"})]})]})]}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("label",{className:"text-sm font-medium mb-2 flex items-center gap-2",children:[s.jsx(fs,{className:"h-4 w-4"}),"Tipo de Material"]}),s.jsxs(qs,{value:_,onValueChange:C,children:[s.jsx(Ls,{children:s.jsx(Ws,{})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"all",children:"Todos os materiais"}),s.jsx(xt,{value:"Plstico",children:"Plstico"}),s.jsx(xt,{value:"Papel",children:"Papel"}),s.jsx(xt,{value:"Vidro",children:"Vidro"}),s.jsx(xt,{value:"Metal",children:"Metal"}),s.jsx(xt,{value:"Alumnio",children:"Alumnio"}),s.jsx(xt,{value:"Laminado",children:"Laminado"})]})]})]})]})})}),x.length===0?s.jsx(Ne,{children:s.jsx(De,{className:"pt-6",children:s.jsxs("div",{className:"text-center py-8",children:[s.jsx(fs,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:b!=="all"||_!=="all"?"Nenhuma entrega encontrada com os filtros selecionados":"Nenhuma entrega realizada"})]})})}):s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsxs(Tt,{children:[x.length," ",x.length===1?"entrega encontrada":"entregas encontradas"]})}),s.jsx(De,{children:s.jsx("div",{className:"space-y-3",children:x.map(Z=>{var G,Q;return s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50 transition-colors",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("p",{className:"font-medium",children:["Entrega #",Z.id.slice(0,8)]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Ri,{className:"h-4 w-4 text-muted-foreground"}),s.jsx("span",{className:"font-medium text-foreground",children:q(Z.profiles)})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx("span",{children:new Date(Z.data_validacao).toLocaleDateString("pt-BR")}),s.jsx("span",{children:""}),s.jsx(Je,{variant:"outline",className:"text-xs",children:Z.tipo_material})]})]}),s.jsxs("div",{className:"text-right space-y-1",children:[s.jsxs("p",{className:"font-bold text-success",children:[(G=Z.peso_validado)==null?void 0:G.toFixed(2)," kg"]}),Z.peso_rejeito_kg>0&&s.jsxs("p",{className:"text-xs text-destructive",children:["Rejeito: ",(Q=Z.peso_rejeito_kg)==null?void 0:Q.toFixed(2)," kg"]})]})]},Z.id)})})})]})]})]}),s.jsxs(Ne,{className:"bg-primary text-primary-foreground","data-tour":"scan-action",children:[s.jsx(Ye,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(Qe,{children:"Pronto para coletar!"}),s.jsx(Tt,{className:"text-primary-foreground/80",children:"Escaneie o QR Code do usurio para iniciar"})]}),s.jsx(Da,{className:"h-12 w-12"})]})}),s.jsx(De,{children:s.jsx(oe,{onClick:()=>k("/cooperative/scan-qrcode"),variant:"secondary",size:"lg",className:"w-full",children:"Escanear QR Code"})})]})]})]}):s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:s.jsx(Ne,{className:"max-w-md w-full",children:s.jsx(De,{className:"pt-6",children:s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ur,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Carregando cooperativa..."})]})})})})}const hv="qr-code-reader-container";function TZ(){const e=ds(),{user:t}=sr(),[r,a]=E.useState("idle"),[n,i]=E.useState(null),[o,c]=E.useState([]),[d,h]=E.useState([]),[p,x]=E.useState([]),[v,b]=E.useState(!0),N=E.useRef(null),_=E.useRef(!1),C=E.useRef(!0),T=E.useCallback(async()=>{const H=N.current;if(H){try{const Z=H.getState();(Z===wa.SCANNING||Z===wa.PAUSED)&&await H.stop()}catch{}try{H.clear()}catch{}N.current=null}},[]);E.useEffect(()=>(C.current=!0,()=>{C.current=!1,T()}),[T]),E.useEffect(()=>{A(),k(),I()},[t]);const A=async()=>{if(t)try{const{data:H}=await J.from("cooperativas").select("id").eq("id_user",t.id).single();if(!H)return;const{data:Z,error:G}=await J.from("entregas_reciclaveis").select("*").eq("id_cooperativa",H.id).eq("status_promessa","ativa").order("data_geracao",{ascending:!1}).limit(10);if(G)throw console.error("Erro na query de entregas:",G),G;if(Z&&Z.length>0){const Q=[...new Set(Z.map(ye=>ye.id_usuario))],{data:re}=await J.from("profiles").select("id, nome, telefone").in("id",Q),le=Z.map(ye=>({...ye,usuario:(re==null?void 0:re.find(W=>W.id===ye.id_usuario))||null}));c(le)}else c([])}catch(H){console.error("Erro ao carregar entregas:",H)}finally{b(!1)}},k=async()=>{if(t)try{const{data:H}=await J.from("cooperativas").select("id").eq("id_user",t.id).single();if(!H)return;const{data:Z,error:G}=await J.from("entregas_reciclaveis").select("*").eq("id_cooperativa",H.id).eq("status_promessa","em_triagem").order("data_envio_triagem",{ascending:!1}).limit(10);if(G)throw console.error("Erro ao carregar entregas em triagem:",G),G;if(Z&&Z.length>0){const Q=[...new Set(Z.map(ye=>ye.id_usuario))],{data:re}=await J.from("profiles").select("id, nome, telefone").in("id",Q),le=Z.map(ye=>({...ye,usuario:(re==null?void 0:re.find(W=>W.id===ye.id_usuario))||null}));h(le)}else h([])}catch(H){console.error("Erro ao carregar entregas em triagem:",H)}},I=async()=>{if(t)try{const{data:H}=await J.from("cooperativas").select("id").eq("id_user",t.id).single();if(!H)return;const{data:Z,error:G}=await J.from("rotas_coleta").select("*, adesoes_ativas:usuarios_rotas(count)").eq("id_operador",H.id).eq("status","ativa");if(G)throw console.error("Erro na query de rotas:",G),G;Z&&x(Z)}catch(H){console.error("Erro ao carregar rotas:",H)}},B=async()=>{try{if(a("requesting"),i(null),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Seu navegador no suporta acesso  cmera");return(await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}})).getTracks().forEach(Z=>Z.stop()),C.current&&a("granted"),!0}catch(H){return console.error("Erro ao solicitar permisso:",H),C.current&&(H.name==="NotAllowedError"||H.name==="PermissionDeniedError"?(a("denied"),i("Voc negou o acesso  cmera. Permita o acesso nas configuraes do navegador.")):H.name==="NotFoundError"||H.name==="DevicesNotFoundError"?(a("error"),i("Nenhuma cmera foi encontrada no dispositivo.")):H.name==="NotReadableError"||H.name==="TrackStartError"?(a("error"),i("A cmera est sendo usada por outro aplicativo.")):(a("error"),i(H.message||"Erro ao acessar a cmera"))),!1}},O=async()=>{if(!_.current)try{if(await new Promise(G=>requestAnimationFrame(G)),!document.getElementById(hv)){console.error("Elemento reader no encontrado"),ct.error("Erro interno",{description:"Elemento do scanner no encontrado"}),a("idle");return}await T();const Z=new nP(hv,{verbose:!1});N.current=Z,a("scanning"),await Z.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250},aspectRatio:1},F,()=>{})}catch(H){if(console.error("Erro ao iniciar scanner:",H),await T(),C.current){const Z=(H==null?void 0:H.message)||String(H);Z.includes("NotAllowed")||Z.includes("Permission")?(a("denied"),i("Permisso de cmera negada")):(a("error"),i("No foi possvel iniciar o scanner")),ct.error("Erro ao iniciar scanner",{description:"Verifique as permisses e tente novamente"})}}},D=async()=>{await T(),C.current&&a("idle")},F=async H=>{if(_.current){console.log("[Scanner] J est processando, ignorando leitura duplicada");return}console.log("[Scanner] QR Code lido com sucesso, iniciando processamento..."),_.current=!0,C.current&&a("processing"),await T(),await M(H),_.current=!1},M=async H=>{try{if(console.log(""),console.log("[QRCode]  INICIANDO PROCESSAMENTO DE QR CODE"),console.log("[QRCode] Dados brutos:",H),console.log("[QRCode] Tipo de dado:",typeof H),console.log("[QRCode] Tamanho:",H.length,"caracteres"),console.log(""),H.startsWith("TRIAGEM_")){console.log(" [TIPO 1] QR Code de TRIAGEM detectado"),console.log("[QRCode]  Encaminhando para processTriagemQRCode()"),await z(H);return}if(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(H.trim())){console.log(" [TIPO 2] UUID de ENTREGA detectado"),console.log("[QRCode] UUID validado:",H.trim()),console.log("[QRCode]  Encaminhando para processEntregaSimples()"),await Y(H.trim());return}let G;try{G=JSON.parse(H),console.log(" [TIPO 3] JSON parseado com sucesso"),console.log("[QRCode] Dados parseados:",G),console.log("[QRCode] Tipo identificado:",G.tipo)}catch(Q){console.error(" [ERRO] No foi possvel fazer parse do JSON:",Q),console.error("[QRCode] Formato no reconhecido. Dados recebidos:",H),ct.error("QR Code invlido",{description:"Formato no reconhecido. Certifique-se de estar usando um QR Code vlido da Ciclik."}),C.current&&a("idle");return}console.log("[QRCode] Validando subtipo do JSON..."),G.tipo==="promessa_entrega_ciclik"?(console.log(" [TIPO 3A] JSON de ENTREGA detectado"),console.log("[QRCode]  Encaminhando para processEntregaQRCode()"),await ae(G)):G.tipo==="adesao_rota_ciclik"?(console.log(" [TIPO 3B] JSON de ADESO  ROTA detectado"),console.log("[QRCode]  Encaminhando para processAdesaoRotaQRCode()"),await q(G)):(console.warn(" [AVISO] Tipo no suportado:",G.tipo),console.warn("[QRCode] Tipos suportados: promessa_entrega_ciclik, adesao_rota_ciclik"),ct.error("QR Code no suportado",{description:`Este tipo de QR Code (${G.tipo||"indefinido"}) no pode ser processado aqui.`}),C.current&&a("idle"))}catch(Z){console.error(" [ERRO FATAL] Erro ao processar QR Code:",Z),console.error("[QRCode] Stack trace:",Z.stack),ct.error("Erro ao processar QR Code",{description:Z.message||"Ocorreu um erro inesperado. Tente novamente."}),C.current&&a("idle")}},z=async H=>{try{console.log("[Triagem] Processando QR Code de triagem:",H);const{data:Z,error:G}=await J.from("entregas_reciclaveis").select("id, status_promessa, id_cooperativa, tipo_material").eq("qrcode_triagem",H).single();if(G||!Z){console.error("[Triagem] Erro ao buscar entrega:",G),ct.error("QR Code invlido",{description:"Entrega no encontrada para este cdigo de triagem"}),C.current&&a("idle");return}if(console.log("[Triagem] Entrega encontrada:",Z),Z.status_promessa!=="em_triagem"){ct.error("Status incorreto",{description:`Esta entrega est ${Z.status_promessa}, no em triagem`}),C.current&&a("idle");return}const{data:Q,error:re}=await J.from("cooperativas").select("id").eq("id_user",t==null?void 0:t.id).single();if(re||!Q){console.error("[Triagem] Erro ao buscar cooperativa:",re),ct.error("Cooperativa no encontrada"),C.current&&a("idle");return}if(Z.id_cooperativa!==Q.id){ct.error("Entrega de outra cooperativa",{description:"Esta entrega no pertence  sua cooperativa"}),C.current&&a("idle");return}await J.from("entregas_reciclaveis").update({data_inicio_triagem:new Date().toISOString()}).eq("id",Z.id),ct.success("Triagem iniciada!",{description:`Material: ${Z.tipo_material}`}),e(`/cooperative/triagem/${Z.id}`)}catch(Z){console.error("[Triagem] Erro ao processar triagem:",Z),ct.error("Erro ao processar triagem",{description:Z.message}),C.current&&a("idle")}},q=async H=>{var Z,G,Q,re;try{console.log("[QRCode] Processando adeso a rota:",H),console.log("[QRCode] Buscando cooperativa do usurio:",t==null?void 0:t.id);const{data:le,error:ye}=await J.from("cooperativas").select("id").eq("id_user",t==null?void 0:t.id).single();if(ye||!le){console.error("[QRCode] Erro ao buscar cooperativa:",ye),ct.error("Cooperativa no encontrada"),C.current&&a("idle");return}console.log("[QRCode] Cooperativa encontrada:",le.id),console.log("[QRCode] Buscando adeso - QRCode:",H.qrcode,"Hash:",H.hash);const{data:W,error:ee}=await J.from("usuarios_rotas").select(`
          *,
          rota:rotas_coleta!id_rota (
            id,
            nome,
            id_operador
          ),
          usuario:profiles!id_usuario (
            id,
            nome
          )
        `).eq("qrcode_adesao",H.qrcode).eq("hash_qrcode",H.hash).eq("status","ativa").single();if(ee||!W){console.error("[QRCode] Erro ao buscar adeso:",ee),ct.error("QR Code invlido",{description:"Adeso no encontrada ou inativa"}),C.current&&a("idle");return}if(console.log("[QRCode] Adeso encontrada:",W),console.log("[QRCode] Verificando operador - Rota:",(Z=W.rota)==null?void 0:Z.id_operador,"Cooperativa:",le.id),((G=W.rota)==null?void 0:G.id_operador)!==le.id){ct.error("QR Code de outra rota",{description:"Esta rota no  operada por sua cooperativa"}),C.current&&a("idle");return}console.log("[QRCode] Criando nova entrega automtica para coleta de rota..."),console.log("[QRCode] ID Usurio Adeso:",W.id_usuario),console.log("[QRCode] ID Cooperativa:",le.id),console.log("[QRCode] User Auth:",t==null?void 0:t.id);const ie=crypto.randomUUID(),ce=crypto.randomUUID(),xe=`${W.id_usuario}-${Date.now()}-${Math.random().toString(36).substring(7)}`;console.log("[QRCode] Dados do INSERT:",{id:ie,id_usuario:W.id_usuario,id_cooperativa:le.id,qrcode_id:ce,hash_qrcode:xe});const{data:Ce,error:me}=await J.from("entregas_reciclaveis").insert({id:ie,id_usuario:W.id_usuario,id_cooperativa:le.id,qrcode_id:ce,hash_qrcode:xe,tipo_material:"Rota de Coleta",status:"recebida",status_promessa:"em_coleta",data_geracao:new Date().toISOString(),data_recebimento:new Date().toISOString(),peso_estimado:0,itens_vinculados:{tipo:"rota",id_rota:W.id_rota,nome_rota:(Q=W.rota)==null?void 0:Q.nome,id_adesao:W.id}}).select().single();if(me){console.error("[QRCode] Erro ao criar entrega:",me),ct.error("Erro ao criar entrega",{description:me.message}),C.current&&a("idle");return}console.log("[QRCode] Entrega criada com sucesso:",Ce.id),ct.success("QR Code de Rota validado!",{description:`Usurio: ${((re=W.usuario)==null?void 0:re.nome)||"N/A"}. Iniciando registro de coleta...`}),console.log("[QRCode] Redirecionando para registro de materiais:",Ce.id),C.current&&e(`/cooperative/register-materials/${Ce.id}`)}catch(le){console.error("[QRCode] Erro ao processar adeso a rota:",le),ct.error("Erro ao processar QR Code de rota",{description:le.message||"Tente novamente"}),C.current&&a("idle")}},Y=async H=>{try{console.log("[QRCode]  Processando entrega simples (UUID)"),console.log("[QRCode] UUID:",H),console.log("[QRCode] Buscando cooperativa do usurio:",t==null?void 0:t.id);const{data:Z,error:G}=await J.from("cooperativas").select("id").eq("id_user",t==null?void 0:t.id).single();if(G||!Z){console.error("[QRCode]  Erro ao buscar cooperativa:",G),ct.error("Cooperativa no encontrada"),C.current&&a("idle");return}console.log("[QRCode]  Cooperativa encontrada:",Z.id),console.log("[QRCode] Buscando entrega pela coluna qrcode_id:",H);const{data:Q,error:re}=await J.from("entregas_reciclaveis").select("*").eq("qrcode_id",H).single();if(re||!Q){console.error("[QRCode]  Erro ao buscar entrega:",re),ct.error("QR Code invlido",{description:"Entrega no encontrada no sistema."}),C.current&&a("idle");return}if(console.log("[QRCode]  Entrega encontrada:",Q.id,"Status:",Q.status_promessa),Q.id_cooperativa!==Z.id){console.warn("[QRCode]  Cooperativa diferente detectada"),console.warn("[QRCode] Cooperativa do QR:",Q.id_cooperativa),console.warn("[QRCode] Cooperativa atual:",Z.id),ct.error("Entrega de outra cooperativa",{description:"Esta entrega no pertence  sua cooperativa."}),C.current&&a("idle");return}if(Q.status_promessa==="concluida"){console.warn("[QRCode]  Entrega j foi coletada anteriormente"),ct.error("Entrega j coletada",{description:"Esta entrega j foi registrada como coletada."}),C.current&&a("idle");return}const le=new Date(Q.data_geracao),W=a_(new Date,le);if(W>24){console.warn("[QRCode]  Entrega expirada"),console.warn("[QRCode] Horas decorridas:",W),ct.error("QR Code expirado",{description:"Esta entrega ultrapassou o prazo de 24 horas."}),C.current&&a("idle");return}console.log("[QRCode]  Entrega vlida! Horas decorridas:",W),console.log("[QRCode] Atualizando status para em_coleta...");const{error:ee}=await J.from("entregas_reciclaveis").update({status_promessa:"em_coleta"}).eq("id",Q.id);if(ee){console.error("[QRCode]  Erro ao atualizar status:",ee),ct.error("Erro ao atualizar status"),C.current&&a("idle");return}console.log("[QRCode]  Status atualizado com sucesso!"),ct.success("Entrega validada!",{description:"Aguarde, voc ser redirecionado..."}),setTimeout(()=>{C.current&&e(`/cooperative/register-materials/${Q.id}`)},2e3)}catch(Z){console.error("[QRCode]  Erro fatal ao processar entrega simples:",Z),console.error("[QRCode] Stack trace:",Z.stack),ct.error("Erro ao processar",{description:Z.message||"Tente novamente"}),C.current&&a("idle")}},ae=async H=>{try{console.log("[QRCode] Buscando cooperativa do usurio:",t==null?void 0:t.id);const{data:Z,error:G}=await J.from("cooperativas").select("id").eq("id_user",t==null?void 0:t.id).single();if(G||!Z){console.error("[QRCode] Erro ao buscar cooperativa:",G),ct.error("Cooperativa no encontrada"),C.current&&a("idle");return}console.log("[QRCode] Cooperativa encontrada:",Z.id),console.log("[QRCode] Buscando entrega com id:",H.id_entrega,"hash:",H.hash);const{data:Q,error:re}=await J.from("entregas_reciclaveis").select("*").eq("id",H.id_entrega).eq("hash_qrcode",H.hash).single();if(re||!Q){console.error("[QRCode] Erro ao buscar entrega:",re),console.log("[QRCode] Entrega encontrada:",Q);const{data:ee}=await J.from("entregas_reciclaveis").select("id, hash_qrcode, id_cooperativa, status_promessa").eq("id",H.id_entrega).single();ee&&ee.hash_qrcode!==H.hash?ct.error("QR Code invlido",{description:"Hash de segurana no corresponde. O QR Code pode ter sido adulterado."}):ct.error("QR Code invlido",{description:"Entrega no encontrada no sistema."}),C.current&&a("idle");return}if(console.log("[QRCode] Entrega encontrada:",Q.id,"Status:",Q.status_promessa),console.log("[QRCode] Verificando cooperativa - Entrega:",Q.id_cooperativa,"Usurio:",Z.id),Q.id_cooperativa!==Z.id){ct.error("QR Code de outra cooperativa",{description:"Esta entrega no  destinada  sua cooperativa"}),C.current&&a("idle");return}const le=new Date(Q.data_geracao),ye=new Date,W=(ye.getTime()-le.getTime())/(1e3*60*60);if(console.log("[QRCode] Verificando validade - Gerao:",le,"Agora:",ye,"Horas:",W),W>24){ct.error("QR Code expirado",{description:"Vlido por apenas 24 horas"}),await J.from("entregas_reciclaveis").update({status_promessa:"expirada",status:"expirada"}).eq("id",Q.id),C.current&&a("idle");return}if(console.log("[QRCode] Status da promessa:",Q.status_promessa),Q.status_promessa==="finalizada"){ct.error("Entrega j finalizada"),C.current&&a("idle");return}if(Q.status_promessa==="expirada"||Q.status_promessa==="cancelada"){ct.error(`Entrega ${Q.status_promessa}`),C.current&&a("idle");return}Q.status_promessa==="ativa"?(console.log("[QRCode] Atualizando status para em_coleta"),await J.from("entregas_reciclaveis").update({status_promessa:"em_coleta",status:"recebida",data_recebimento:new Date().toISOString()}).eq("id",Q.id),ct.success("QR Code validado!",{description:"Iniciando registro..."})):ct.success("Continuando registro..."),console.log("[QRCode] Preparando redirecionamento para:",Q.id),console.log("[QRCode] isMountedRef.current:",C.current),C.current?(console.log("[QRCode] Navegando para /cooperative/register-materials/"+Q.id),e(`/cooperative/register-materials/${Q.id}`)):console.warn("[QRCode] Componente foi desmontado, cancelando navegao")}catch(Z){console.error("[QRCode] Erro ao processar entrega:",Z),ct.error("Erro ao processar entrega",{description:Z.message||"Tente novamente"}),C.current&&a("idle")}},je=async()=>{await B()&&await O()};return E.useEffect(()=>{v||je()},[v]),s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-8",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsxs(oe,{onClick:()=>e("/cooperative"),variant:"ghost",className:"mb-4",children:[s.jsx(As,{className:"mr-2 h-4 w-4"}),"Voltar"]}),s.jsxs(Ne,{className:"border-l-4 border-l-primary",children:[s.jsx(Ye,{children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Da,{className:"h-6 w-6 text-primary"}),s.jsxs("div",{className:"flex-1",children:[s.jsx(Qe,{children:"Scanner Universal de QR Code"}),s.jsx(Tt,{children:"Escaneie qualquer QR Code da Ciclik - o sistema detecta automaticamente o tipo"})]})]})}),s.jsxs(De,{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[!v&&o.length>0&&s.jsxs(Er,{className:"bg-primary/5",children:[s.jsx(fs,{className:"h-4 w-4 text-primary"}),s.jsx(Sr,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium",children:"Entregas Diretas"}),s.jsx(Je,{variant:"secondary",children:o.length})]})})]}),!v&&p.length>0&&s.jsxs(Er,{className:"bg-accent/5",children:[s.jsx(Sl,{className:"h-4 w-4 text-accent"}),s.jsx(Sr,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium",children:"Rotas Ativas"}),s.jsx(Je,{variant:"secondary",children:p.length})]})})]}),!v&&d.length>0&&s.jsxs(Er,{className:"bg-amber-50 border-amber-200",children:[s.jsx(Zi,{className:"h-4 w-4 text-amber-600"}),s.jsx(Sr,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium",children:"Aguardando Triagem"}),s.jsx(Je,{variant:"secondary",className:"bg-amber-100 text-amber-900",children:d.length})]})})]})]}),s.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg space-y-3",children:[s.jsxs("p",{className:"font-medium text-sm flex items-center gap-2",children:[s.jsx(V2,{className:"h-4 w-4"}),"Tipos de QR Code Aceitos"]}),s.jsxs("div",{className:"space-y-2 text-sm text-muted-foreground",children:[s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(fs,{className:"h-4 w-4 mt-0.5 text-primary"}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-foreground",children:"Entrega Direta:"})," Usurios que vm entregar na cooperativa"]})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Sl,{className:"h-4 w-4 mt-0.5 text-accent"}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-foreground",children:"Coleta de Rota:"})," QR Code de adeso a rotas programadas"]})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Zi,{className:"h-4 w-4 mt-0.5 text-amber-600"}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-foreground",children:"Triagem:"})," Validao de materiais na estao de triagem"]})]})]})]}),s.jsx("div",{id:hv,className:`w-full rounded-lg overflow-hidden bg-muted/30 ${r==="scanning"?"min-h-[300px]":"h-0 overflow-hidden"}`,style:{transition:"height 0.3s ease-in-out",visibility:r==="scanning"?"visible":"hidden"}}),r==="idle"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs(Er,{children:[s.jsx(V2,{className:"h-4 w-4"}),s.jsx(Sr,{children:"Para escanear QR Codes, precisamos acessar a cmera do seu dispositivo."})]}),s.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg space-y-2",children:[s.jsx("p",{className:"font-medium text-sm",children:"Validaes Automticas:"}),s.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1",children:[s.jsx("li",{children:" Detecta automaticamente o tipo de QR Code"}),s.jsx("li",{children:" Verifica se pertence  sua cooperativa"}),s.jsx("li",{children:" Valida prazo de validade (24h para entregas diretas)"}),s.jsx("li",{children:" Confirma se ainda no foi usado"})]})]}),s.jsxs(oe,{onClick:je,className:"w-full",size:"lg",children:[s.jsx(jx,{className:"mr-2 h-5 w-5"}),"Iniciar Scanner"]})]}),r==="requesting"&&s.jsxs("div",{className:"text-center py-8 space-y-4",children:[s.jsx(_s,{className:"h-12 w-12 text-primary animate-spin mx-auto"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-lg",children:"Solicitando permisso..."}),s.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Aguardando autorizao para acessar a cmera"})]})]}),r==="granted"&&s.jsxs("div",{className:"text-center py-8 space-y-4",children:[s.jsx(_n,{className:"h-12 w-12 text-success mx-auto"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-lg",children:"Permisso concedida!"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Iniciando cmera..."})]})]}),r==="denied"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs(Er,{variant:"destructive",children:[s.jsx(Kr,{className:"h-4 w-4"}),s.jsxs(Sr,{children:[s.jsx("strong",{children:"Permisso negada!"}),s.jsx("br",{}),"Voc precisa permitir o acesso  cmera nas configuraes do navegador."]})]}),s.jsxs(oe,{onClick:je,variant:"outline",className:"w-full",children:[s.jsx(jx,{className:"mr-2 h-5 w-5"}),"Tentar Novamente"]})]}),r==="scanning"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs(Er,{className:"bg-primary/5",children:[s.jsx(Da,{className:"h-4 w-4 text-primary"}),s.jsxs(Sr,{children:[s.jsx("strong",{children:"Aponte a cmera para qualquer QR Code Ciclik"}),s.jsx("br",{}),"O sistema identificar automaticamente o tipo"]})]}),s.jsx(oe,{onClick:D,variant:"outline",className:"w-full",children:"Parar Scanner"})]}),r==="processing"&&s.jsxs("div",{className:"text-center py-8 space-y-4",children:[s.jsx(_s,{className:"h-12 w-12 text-primary animate-spin mx-auto"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-lg",children:"Processando QR Code..."}),s.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Identificando tipo e validando informaes..."})]})]}),r==="error"&&n&&s.jsxs(Er,{variant:"destructive",children:[s.jsx(Kr,{className:"h-4 w-4"}),s.jsx(Sr,{children:n})]})]})]}),!v&&o.length>0&&s.jsxs(Ne,{className:"mt-4",children:[s.jsx(Ye,{children:s.jsxs(Qe,{className:"text-base flex items-center gap-2",children:[s.jsx(fs,{className:"h-5 w-5 text-primary"}),"Entregas Diretas Esperando (",o.length,")"]})}),s.jsx(De,{children:s.jsx("div",{className:"max-h-[300px] overflow-y-auto space-y-2 pr-2",children:o.map(H=>s.jsxs(Er,{className:"bg-primary/5",children:[s.jsx(Ri,{className:"h-4 w-4 text-primary"}),s.jsx(Sr,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:H.usuario_nome||"Usurio"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:Ad(new Date(H.data_geracao),{locale:$s,addSuffix:!0})})]}),s.jsx(Je,{variant:"secondary",children:H.tipo_material||"Diversos"})]})})]},H.id))})})]}),!v&&d.length>0&&s.jsxs(Ne,{className:"mt-4 border-l-4 border-l-amber-600",children:[s.jsx(Ye,{children:s.jsxs(Qe,{className:"text-base flex items-center gap-2",children:[s.jsx(Zi,{className:"h-5 w-5 text-amber-600"}),"Aguardando Triagem (",d.length,")"]})}),s.jsx(De,{children:s.jsx("div",{className:"max-h-[300px] overflow-y-auto space-y-2 pr-2",children:d.map(H=>s.jsxs(Er,{className:"bg-amber-50 border-amber-200",children:[s.jsx(Ri,{className:"h-4 w-4 text-amber-600"}),s.jsx(Sr,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:H.usuario_nome||"Usurio"}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Enviado ",Ad(new Date(H.data_envio_triagem),{locale:$s,addSuffix:!0})]})]}),s.jsx(Je,{variant:"secondary",className:"bg-amber-100 text-amber-900",children:H.tipo_material||"Diversos"})]})})]},H.id))})})]})]})})}const la=E.forwardRef(({className:e,...t},r)=>s.jsx("div",{className:"relative w-full overflow-auto",children:s.jsx("table",{ref:r,className:pt("w-full caption-bottom text-sm",e),...t})}));la.displayName="Table";const ca=E.forwardRef(({className:e,...t},r)=>s.jsx("thead",{ref:r,className:pt("[&_tr]:border-b",e),...t}));ca.displayName="TableHeader";const da=E.forwardRef(({className:e,...t},r)=>s.jsx("tbody",{ref:r,className:pt("[&_tr:last-child]:border-0",e),...t}));da.displayName="TableBody";const AZ=E.forwardRef(({className:e,...t},r)=>s.jsx("tfoot",{ref:r,className:pt("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));AZ.displayName="TableFooter";const Cs=E.forwardRef(({className:e,...t},r)=>s.jsx("tr",{ref:r,className:pt("border-b transition-colors data-[state=selected]:bg-muted hover:bg-muted/50",e),...t}));Cs.displayName="TableRow";const rt=E.forwardRef(({className:e,...t},r)=>s.jsx("th",{ref:r,className:pt("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));rt.displayName="TableHead";const Ze=E.forwardRef(({className:e,...t},r)=>s.jsx("td",{ref:r,className:pt("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));Ze.displayName="TableCell";const kZ=E.forwardRef(({className:e,...t},r)=>s.jsx("caption",{ref:r,className:pt("mt-4 text-sm text-muted-foreground",e),...t}));kZ.displayName="TableCaption";var NP="AlertDialog",[RZ,Kue]=bi(NP,[QS]),Cc=QS(),CP=e=>{const{__scopeAlertDialog:t,...r}=e,a=Cc(t);return s.jsx(Wp,{...a,...r,modal:!0})};CP.displayName=NP;var PZ="AlertDialogTrigger",EP=E.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...a}=e,n=Cc(r);return s.jsx(bg,{...n,...a,ref:t})});EP.displayName=PZ;var IZ="AlertDialogPortal",SP=e=>{const{__scopeAlertDialog:t,...r}=e,a=Cc(t);return s.jsx(qp,{...a,...r})};SP.displayName=IZ;var OZ="AlertDialogOverlay",TP=E.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...a}=e,n=Cc(r);return s.jsx(zu,{...n,...a,ref:t})});TP.displayName=OZ;var Bh="AlertDialogContent",[DZ,MZ]=RZ(Bh),LZ=$S("AlertDialogContent"),AP=E.forwardRef((e,t)=>{const{__scopeAlertDialog:r,children:a,...n}=e,i=Cc(r),o=E.useRef(null),c=br(t,o),d=E.useRef(null);return s.jsx(q8,{contentName:Bh,titleName:kP,docsSlug:"alert-dialog",children:s.jsx(DZ,{scope:r,cancelRef:d,children:s.jsxs($u,{role:"alertdialog",...i,...n,ref:c,onOpenAutoFocus:Ts(n.onOpenAutoFocus,h=>{var p;h.preventDefault(),(p=d.current)==null||p.focus({preventScroll:!0})}),onPointerDownOutside:h=>h.preventDefault(),onInteractOutside:h=>h.preventDefault(),children:[s.jsx(LZ,{children:a}),s.jsx(BZ,{contentRef:o})]})})})});AP.displayName=Bh;var kP="AlertDialogTitle",RP=E.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...a}=e,n=Cc(r);return s.jsx(kf,{...n,...a,ref:t})});RP.displayName=kP;var PP="AlertDialogDescription",IP=E.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...a}=e,n=Cc(r);return s.jsx(Rf,{...n,...a,ref:t})});IP.displayName=PP;var FZ="AlertDialogAction",OP=E.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...a}=e,n=Cc(r);return s.jsx($p,{...n,...a,ref:t})});OP.displayName=FZ;var DP="AlertDialogCancel",MP=E.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...a}=e,{cancelRef:n}=MZ(DP,r),i=Cc(r),o=br(t,n);return s.jsx($p,{...i,...a,ref:o})});MP.displayName=DP;var BZ=({contentRef:e})=>{const t=`\`${Bh}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Bh}\` by passing a \`${PP}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Bh}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return E.useEffect(()=>{var a;document.getElementById((a=e.current)==null?void 0:a.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},VZ=CP,UZ=EP,zZ=SP,LP=TP,FP=AP,BP=OP,VP=MP,UP=RP,zP=IP;const hc=VZ,$Z=UZ,qZ=zZ,$P=E.forwardRef(({className:e,...t},r)=>s.jsx(LP,{className:pt("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));$P.displayName=LP.displayName;const Dl=E.forwardRef(({className:e,...t},r)=>s.jsxs(qZ,{children:[s.jsx($P,{}),s.jsx(FP,{ref:r,className:pt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));Dl.displayName=FP.displayName;const Ml=({className:e,...t})=>s.jsx("div",{className:pt("flex flex-col space-y-2 text-center sm:text-left",e),...t});Ml.displayName="AlertDialogHeader";const Ll=({className:e,...t})=>s.jsx("div",{className:pt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Ll.displayName="AlertDialogFooter";const Fl=E.forwardRef(({className:e,...t},r)=>s.jsx(UP,{ref:r,className:pt("text-lg font-semibold",e),...t}));Fl.displayName=UP.displayName;const Bl=E.forwardRef(({className:e,...t},r)=>s.jsx(zP,{ref:r,className:pt("text-sm text-muted-foreground",e),...t}));Bl.displayName=zP.displayName;const Vl=E.forwardRef(({className:e,...t},r)=>s.jsx(BP,{ref:r,className:pt(up(),e),...t}));Vl.displayName=BP.displayName;const Ul=E.forwardRef(({className:e,...t},r)=>s.jsx(VP,{ref:r,className:pt(up({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));Ul.displayName=VP.displayName;const hE={Plstico:["PET","PP","PEAD","PEBD","PVC","PS","OUTROS_PLASTICOS"],Papel:["PAPEL_BRANCO","PAPEL_MISTO","PAPELAO","PAPELAO_ONDULADO","JORNAL","REVISTA"],Vidro:["VIDRO_INCOLOR","VIDRO_VERDE","VIDRO_AMBAR"],Metal:["ALUMINIO","ACO","COBRE","OUTROS_METAIS"],Laminado:["TETRAPACK"]},fE={PET:"PET (Garrafas)",PP:"PP (Potes)",PEAD:"PEAD (Embalagens rgidas)",PEBD:"PEBD (Sacolas)",PVC:"PVC",PS:"PS (Isopor)",OUTROS_PLASTICOS:"Outros Plsticos",PAPEL_BRANCO:"Papel Branco",PAPEL_MISTO:"Papel Misto",PAPELAO:"Papelo",PAPELAO_ONDULADO:"Papelo Ondulado",JORNAL:"Jornal",REVISTA:"Revista",VIDRO_INCOLOR:"Vidro Incolor",VIDRO_VERDE:"Vidro Verde",VIDRO_AMBAR:"Vidro mbar",ALUMINIO:"Alumnio",ACO:"Ao",COBRE:"Cobre",OUTROS_METAIS:"Outros Metais",TETRAPACK:"Tetra Pak (Caixa de Leite)",REJEITO:"Rejeito (No Reciclvel)"};function WZ(){var me,fe;const e=ds(),{entregaId:t}=To(),{user:r}=sr(),[a,n]=E.useState(null),[i,o]=E.useState(""),[c,d]=E.useState([]),[h,p]=E.useState(""),[x,v]=E.useState(""),[b,N]=E.useState(""),[_,C]=E.useState(!0),[T,A]=E.useState(!1),[k,I]=E.useState(!1),[B,O]=E.useState(!1),[D,F]=E.useState(!1),[M,z]=E.useState(!1),[q,Y]=E.useState(!1),[ae,je]=E.useState(""),[H,Z]=E.useState("");E.useEffect(()=>{if(c.length>0&&!_){const ve=setTimeout(()=>{A(!0),setTimeout(()=>A(!1),1e3)},500);return()=>clearTimeout(ve)}},[c,_]),E.useEffect(()=>{G(),Q()},[t]);const G=async()=>{try{const{data:ve,error:ne}=await J.from("cooperativas").select("id").eq("id_user",r==null?void 0:r.id).maybeSingle();if(ne)throw ne;if(!ve)throw new Error("Cooperativa no encontrada");o(ve.id);const{data:Me,error:Ie}=await J.from("entregas_reciclaveis").select("*").eq("id",t).maybeSingle();if(Ie)throw Ie;if(!Me)throw new Error("Entrega no encontrada");n(Me)}catch(ve){ct.error("Erro ao carregar entrega",{description:ve.message}),e("/cooperative")}finally{C(!1)}},Q=async()=>{const{data:ve,error:ne}=await J.from("materiais_coletados_detalhado").select("*").eq("id_entrega",t);!ne&&ve&&d(ve)},re=async()=>{if(k){console.log(" J existe uma operao em andamento");return}if(!h||!b){ct.error("Preencha tipo e peso");return}if(h!=="Rejeito"&&!x){ct.error("Selecione o submaterial");return}const ve=parseFloat(b);if(isNaN(ve)||ve<=0){ct.error("Peso invlido");return}if(!i||!t){console.error(" IDs no carregados:",{cooperativaId:i,entregaId:t}),ct.error("Aguarde o carregamento completo da pgina");return}I(!0);try{const ne={id_entrega:t,id_cooperativa:i,tipo_material:h,subtipo_material:h==="Rejeito"?"REJEITO":x,peso_kg:ve};console.log(" Inserindo material:",ne);const{data:Me,error:Ie}=await J.from("materiais_coletados_detalhado").insert(ne).select().single();if(Ie)throw console.error(" Erro ao inserir material:",{error:Ie,code:Ie.code,details:Ie.details,hint:Ie.hint,message:Ie.message,payload:ne}),Ie;console.log(" Material inserido com sucesso:",Me),d([...c,Me]),p(""),v(""),N(""),ct.success(" Salvo",{duration:1500})}catch(ne){ct.error("Erro ao registrar",{description:ne.message||"Tente novamente"})}finally{I(!1)}},le=async ve=>{try{const{error:ne}=await J.from("materiais_coletados_detalhado").delete().eq("id",ve);if(ne)throw ne;d(c.filter(Me=>Me.id!==ve)),ct.success(" Removido",{duration:1500})}catch(ne){ct.error("Erro ao remover",{description:ne.message})}},ye=async()=>{if(c.length===0){ct.error("Adicione pelo menos um material antes de enviar para triagem");return}O(!0);try{const{data:ve,error:ne}=await J.from("entregas_reciclaveis").select("status_promessa, status").eq("id",t).single();if(ne)throw ne;if(ve.status_promessa==="finalizada"){ct.error("Esta entrega j foi finalizada anteriormente"),setTimeout(()=>e("/cooperative"),1500);return}const Me=c.reduce((ot,Se)=>ot+Se.peso_kg,0),Ie=`TRIAGEM_${t}_${Date.now()}`,{error:Be}=await J.from("entregas_reciclaveis").update({status_promessa:"em_triagem",peso_validado:Me,qrcode_triagem:Ie,data_envio_triagem:new Date().toISOString()}).eq("id",t).eq("status_promessa","em_coleta");if(Be)throw Be;await J.from("notificacoes").insert({id_usuario:a.id_usuario,tipo:"entrega_enviada_triagem",mensagem:`Sua entrega foi registrada! Peso: ${gr(Me)} | Aguardando triagem`}),je(Ie);try{const ot=await kd({data:Ie,width:400,margin:2});Z(ot)}catch(ot){console.error("Erro ao gerar QR Code com logo:",ot)}Y(!0),ct.success("Materiais enviados para triagem!",{description:"QR Code gerado com sucesso"})}catch(ve){ct.error("Erro ao enviar para triagem",{description:ve.message})}finally{O(!1)}},W=async()=>{F(!0);try{if(c.length>0){const{error:ne}=await J.from("materiais_coletados_detalhado").delete().eq("id_entrega",t);if(ne)throw ne}const{error:ve}=await J.from("entregas_reciclaveis").update({status_promessa:"ativa",status:"gerada",data_recebimento:null}).eq("id",t);if(ve)throw ve;ct.success("Coleta cancelada com sucesso",{description:"A entrega voltou ao status de promessa ativa"}),setTimeout(()=>{e("/cooperative")},1500)}catch(ve){ct.error("Erro ao cancelar coleta",{description:ve.message}),F(!1)}},ee=()=>{if(!H)return;const ve=window.open("","_blank");if(!ve){ct.error("Bloqueador de pop-up impediu a impresso");return}ve.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>QR Code - Triagem</title>
          <style>
            body {
              margin: 0;
              padding: 40px;
              display: flex;
              flex-direction: column;
              align-items: center;
              justify-content: center;
              min-height: 100vh;
              font-family: Arial, sans-serif;
            }
            .container {
              text-align: center;
              border: 2px solid #000;
              padding: 30px;
              border-radius: 10px;
            }
            h1 { margin: 0 0 20px 0; font-size: 24px; }
            .qrcode { margin: 20px 0; }
            .qrcode img { width: 400px; height: 400px; }
            .code { 
              font-family: monospace; 
              font-size: 14px; 
              margin-top: 20px;
              padding: 10px;
              background: #f0f0f0;
              border-radius: 5px;
            }
            .info { margin-top: 20px; font-size: 12px; color: #666; }
            @media print {
              body { margin: 0; }
              .container { border: none; }
            }
          </style>
        </head>
        <body>
          <div class="container">
            <h1> TRIAGEM - CICLIK</h1>
            <div class="qrcode">
              <img src="${H}" alt="QR Code" />
            </div>
            <div class="code">
              <strong>Cdigo:</strong><br/>
              ${ae}
            </div>
            <div class="info">
              Entrega ID: ${t==null?void 0:t.slice(0,8)}<br/>
              Data: ${new Date().toLocaleString("pt-BR")}
            </div>
          </div>
          <script>
            window.onload = function() {
              window.print();
              setTimeout(function() { window.close(); }, 100);
            }
          <\/script>
        </body>
      </html>
    `),ve.document.close()},ie=()=>{if(!H)return;const ve=document.createElement("a");ve.href=H,ve.download=`qrcode-triagem-${t==null?void 0:t.slice(0,8)}.png`,ve.click(),ct.success("QR Code baixado com sucesso!")},ce=()=>{Y(!1),e("/cooperative")};if(_)return s.jsx("div",{className:"min-h-screen bg-background p-4 flex items-center justify-center",children:s.jsx("p",{children:"Carregando..."})});const xe=c.reduce((ve,ne)=>ve+ne.peso_kg,0),Ce=c.filter(ve=>ve.subtipo_material==="REJEITO").reduce((ve,ne)=>ve+ne.peso_kg,0);return s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-8",children:s.jsxs("div",{className:"max-w-5xl mx-auto space-y-6",children:[s.jsxs(oe,{onClick:()=>e("/cooperative"),variant:"ghost",children:[s.jsx(As,{className:"mr-2 h-4 w-4"}),"Voltar"]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(fs,{className:"h-6 w-6 text-primary"}),"Registrar Materiais Coletados",T&&s.jsxs(Je,{variant:"outline",className:"ml-auto",children:[s.jsx(Wu,{className:"h-3 w-3 mr-1"}),"Salvando..."]})]}),s.jsxs(Tt,{children:["Entrega #",(me=a==null?void 0:a.id)==null?void 0:me.slice(0,8)," | Peso estimado: ",gr((a==null?void 0:a.peso_estimado)||0)]})]}),s.jsxs(De,{className:"space-y-6",children:[s.jsxs(Er,{children:[s.jsx(Kr,{className:"h-4 w-4"}),s.jsxs(Sr,{children:[" Adicione todos os materiais coletados (mesmo alm dos prometidos)",s.jsx("br",{})," Os dados so salvos automaticamente",s.jsx("br",{}),' Use "Rejeito" para materiais no reciclveis']})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsx(Ne,{className:"bg-primary/5",children:s.jsxs(De,{className:"pt-6",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Registrado"}),s.jsx("p",{className:"text-2xl font-bold text-primary",children:gr(xe)})]})}),s.jsx(Ne,{className:"bg-success/5",children:s.jsxs(De,{className:"pt-6",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Reciclvel"}),s.jsx("p",{className:"text-2xl font-bold text-success",children:gr(xe-Ce)})]})}),s.jsx(Ne,{className:"bg-destructive/5",children:s.jsxs(De,{className:"pt-6",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Rejeito"}),s.jsx("p",{className:"text-2xl font-bold text-destructive",children:gr(Ce)})]})})]}),s.jsxs(Ne,{className:"border-2 border-dashed",children:[s.jsx(Ye,{children:s.jsx(Qe,{className:"text-lg",children:"Adicionar Material"})}),s.jsxs(De,{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{children:"Tipo de Material"}),s.jsxs(qs,{value:h,onValueChange:ve=>{p(ve),v("")},children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Selecione"})}),s.jsxs(Fs,{children:[Object.keys(hE).map(ve=>s.jsx(xt,{value:ve,children:ve},ve)),s.jsx(xt,{value:"Rejeito",children:"Rejeito (No Reciclvel)"})]})]})]}),h&&h!=="Rejeito"&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{children:"Submaterial"}),s.jsxs(qs,{value:x,onValueChange:v,children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Selecione"})}),s.jsx(Fs,{children:(fe=hE[h])==null?void 0:fe.map(ve=>s.jsx(xt,{value:ve,children:fE[ve]},ve))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{children:"Peso (kg)"}),s.jsx(We,{type:"number",step:"0.01",min:"0.01",placeholder:"Ex: 1.5",value:b,onChange:ve=>N(ve.target.value),onKeyPress:ve=>{ve.key==="Enter"&&re()}})]})]}),s.jsxs(oe,{onClick:re,className:"w-full",disabled:k||!i||!t,children:[s.jsx(ra,{className:"mr-2 h-4 w-4"}),k?"Salvando...":"Adicionar Material"]})]})]}),c.length>0&&s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsx(Qe,{className:"text-lg",children:"Materiais Registrados"})}),s.jsx(De,{children:s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{children:"Tipo"}),s.jsx(rt,{children:"Submaterial"}),s.jsx(rt,{className:"text-right",children:"Peso (kg)"}),s.jsx(rt,{className:"text-right",children:"Aes"})]})}),s.jsx(da,{children:c.map(ve=>s.jsxs(Cs,{children:[s.jsx(Ze,{className:"font-medium",children:ve.tipo_material}),s.jsx(Ze,{children:s.jsx(Je,{variant:ve.subtipo_material==="REJEITO"?"destructive":"secondary",children:fE[ve.subtipo_material]})}),s.jsx(Ze,{className:"text-right font-mono",children:gr(ve.peso_kg)}),s.jsx(Ze,{className:"text-right",children:s.jsx(oe,{variant:"ghost",size:"sm",onClick:()=>le(ve.id),children:s.jsx(Ba,{className:"h-4 w-4 text-destructive"})})})]},ve.id))})]})})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[s.jsxs(oe,{onClick:()=>z(!0),disabled:D||B,variant:"outline",className:"flex-1 border-destructive text-destructive hover:bg-destructive hover:text-destructive-foreground",size:"lg",children:[s.jsx(Jr,{className:"mr-2 h-5 w-5"}),D?"Cancelando...":"Cancelar Coleta"]}),s.jsxs(oe,{onClick:ye,disabled:B||c.length===0||D,className:"flex-1",size:"lg",children:[s.jsx(Tr,{className:"mr-2 h-5 w-5"}),B?"Enviando...":"Enviar para Triagem"]})]})]})]}),s.jsx(hc,{open:M,onOpenChange:z,children:s.jsxs(Dl,{children:[s.jsxs(Ml,{children:[s.jsxs(Fl,{className:"flex items-center gap-2",children:[s.jsx(un,{className:"h-5 w-5 text-destructive"}),"Cancelar Coleta?"]}),s.jsx(Bl,{asChild:!0,children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:["Esta ao ir cancelar completamente o processo de coleta e reverter a entrega para o status de ",s.jsx("strong",{children:"promessa ativa"}),"."]}),c.length>0&&s.jsxs(Er,{variant:"destructive",children:[s.jsx(Kr,{className:"h-4 w-4"}),s.jsxs(Sr,{children:[s.jsx("strong",{children:c.length})," ",c.length===1?"material registrado":"materiais registrados"," ",c.length===1?"ser removido":"sero removidos",s.jsx("br",{}),s.jsxs("span",{className:"text-sm",children:["Peso total: ",gr(c.reduce((ve,ne)=>ve+ne.peso_kg,0))]})]})]}),s.jsx("div",{className:"text-sm",children:"Tem certeza que deseja continuar?"})]})})]}),s.jsxs(Ll,{children:[s.jsx(Ul,{disabled:D,children:"No, voltar"}),s.jsx(Vl,{onClick:ve=>{ve.preventDefault(),z(!1),W()},disabled:D,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:D?"Cancelando...":"Sim, cancelar coleta"})]})]})}),s.jsx(ar,{open:q,onOpenChange:Y,children:s.jsxs(tr,{className:"sm:max-w-md",children:[s.jsxs(nr,{children:[s.jsxs(ir,{className:"flex items-center gap-2",children:[s.jsx(fs,{className:"h-5 w-5 text-green-600"}),"QR Code Gerado com Sucesso!"]}),s.jsx(Vr,{children:"Escaneie este QR Code na estao de triagem para validar os materiais"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"flex justify-center p-6 bg-white rounded-lg border-2 border-dashed",id:"qrcode-triagem",children:H?s.jsx("img",{src:H,alt:"QR Code de Triagem",className:"w-64 h-64"}):s.jsx("div",{className:"w-64 h-64 flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}),s.jsxs("div",{className:"p-3 bg-muted rounded-md",children:[s.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Cdigo de Triagem:"}),s.jsx("p",{className:"font-mono text-sm font-medium break-all",children:ae})]}),s.jsxs(Er,{children:[s.jsx(Kr,{className:"h-4 w-4"}),s.jsxs(Sr,{className:"text-sm",children:[s.jsx("strong",{children:"Prximo passo:"})," Leve os materiais para a estao de triagem e escaneie este QR Code para iniciar a validao."]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(oe,{variant:"outline",className:"flex-1",onClick:ee,children:[s.jsx(v4,{className:"mr-2 h-4 w-4"}),"Imprimir"]}),s.jsxs(oe,{variant:"outline",className:"flex-1",onClick:ie,children:[s.jsx(Ua,{className:"mr-2 h-4 w-4"}),"Baixar"]})]}),s.jsxs(oe,{onClick:ce,className:"w-full",size:"lg",children:[s.jsx(Tr,{className:"mr-2 h-5 w-5"}),"Concluir e Voltar"]})]})]})})]})})}const mE={Plstico:["PET","PP","PEAD","PEBD","PVC","PS","OUTROS_PLASTICOS"],Papel:["PAPEL_BRANCO","PAPEL_MISTO","PAPELAO","PAPELAO_ONDULADO","JORNAL","REVISTA"],Vidro:["VIDRO_INCOLOR","VIDRO_VERDE","VIDRO_AMBAR"],Metal:["ALUMINIO","ACO","COBRE","OUTROS_METAIS"],Laminado:["TETRAPACK"]},ph={PET:"PET (Garrafas)",PP:"PP (Potes)",PEAD:"PEAD (Embalagens rgidas)",PEBD:"PEBD (Sacolas)",PVC:"PVC",PS:"PS (Isopor)",OUTROS_PLASTICOS:"Outros Plsticos",PAPEL_BRANCO:"Papel Branco",PAPEL_MISTO:"Papel Misto",PAPELAO:"Papelo",PAPELAO_ONDULADO:"Papelo Ondulado",JORNAL:"Jornal",REVISTA:"Revista",VIDRO_INCOLOR:"Vidro Incolor",VIDRO_VERDE:"Vidro Verde",VIDRO_AMBAR:"Vidro mbar",ALUMINIO:"Alumnio",ACO:"Ao",COBRE:"Cobre",OUTROS_METAIS:"Outros Metais",TETRAPACK:"Tetra Pak",REJEITO:"Rejeito"};function HZ(){var ve;const e=ds(),{entregaId:t}=To(),{user:r}=sr(),[a,n]=E.useState(null),[i,o]=E.useState([]),[c,d]=E.useState([]),[h,p]=E.useState(""),[x,v]=E.useState(!0),[b,N]=E.useState(!1),[_,C]=E.useState(null),[T,A]=E.useState(""),[k,I]=E.useState(!1),[B,O]=E.useState([]),[D,F]=E.useState(!1),[M,z]=E.useState(""),[q,Y]=E.useState(""),[ae,je]=E.useState(""),[H,Z]=E.useState(!1),[G,Q]=E.useState(20);E.useEffect(()=>{le(),re()},[t]);const re=async()=>{try{const{data:ne,error:Me}=await J.from("configuracoes_sistema").select("valor").eq("chave","pontos_base_entrega_6kg").single();if(Me){console.warn("Erro ao buscar configurao de pontos, usando valor padro:",Me);return}ne!=null&&ne.valor&&Q(parseInt(ne.valor))}catch(ne){console.warn("Erro ao buscar configurao de pontos:",ne)}},le=async()=>{try{v(!0);const{data:ne,error:Me}=await J.from("entregas_reciclaveis").select("*").eq("id",t).single();if(Me)throw console.error("Erro ao buscar entrega:",Me),new Error(`Erro ao buscar entrega: ${Me.message}`);if(!ne)throw new Error("Entrega no encontrada");if(ne.id_usuario){const{data:Se}=await J.from("profiles").select("nome, cpf, cnpj").eq("id",ne.id_usuario).single();Se&&(ne.profiles=Se)}if(ne.status_promessa!=="em_triagem"){ct.error("Esta entrega no est em triagem"),e("/cooperative");return}n(ne),p(ne.observacoes_triagem||"");const{data:Ie,error:Be}=await J.from("materiais_coletados_detalhado").select("*").eq("id_entrega",t).order("created_at",{ascending:!0});if(Be)throw Be;const ot=(Ie||[]).map(Se=>({...Se,peso_original:Se.peso_kg,foi_alterado:!1}));o(ot),d(JSON.parse(JSON.stringify(ot))),ne.data_inicio_triagem||await J.from("entregas_reciclaveis").update({data_inicio_triagem:new Date().toISOString()}).eq("id",t)}catch(ne){console.error("Erro ao carregar dados:",ne),ct.error("Erro ao carregar dados da triagem",{description:ne.message}),e("/cooperative")}finally{v(!1)}},ye=()=>{var ot;if(!((ot=a==null?void 0:a.profiles)!=null&&ot.nome))return"Entregador no identificado";const ne=a.profiles.cpf||a.profiles.cnpj;if(!ne)return"Entregador no identificado";const Me=ne.replace(/\D/g,""),Ie=Me.length===14,Be=Me.substring(0,3);if(Ie)return`${Be} - ${a.profiles.nome}`;{const Se=a.profiles.nome.split(" ")[0];return`${Be} - ${Se}`}},W=ne=>{C(ne.id),A(ne.peso_kg.toString())},ee=()=>{C(null),A("")},ie=async ne=>{const Me=parseFloat(T);if(isNaN(Me)||Me<0){ct.error("Peso invlido");return}const Ie=i.find(Se=>Se.id===ne);if(!Ie)return;const Be=Ie.peso_kg,ot=Be-Me;if(ot>0){const Se={id:`temp_${Date.now()}`,tipo_material:"Rejeito",subtipo_material:"REJEITO",peso_kg:ot,peso_original:0,foi_alterado:!1};o(ze=>[...ze.map(we=>we.id===ne?{...we,peso_kg:Me,foi_alterado:Me!==we.peso_original}:we),Se]),O(ze=>[...ze,{tipo_alteracao:"rejeicao",material:`${Ie.tipo_material} - ${ph[Ie.subtipo_material]}`,peso_anterior:Be,peso_novo:Me,motivo:`Criado ${gr(ot)} de rejeito automaticamente`}]),ct.success("Peso atualizado e rejeito criado!",{description:`${gr(ot)} identificado como rejeito`})}else o(Se=>Se.map(ze=>ze.id===ne?{...ze,peso_kg:Me,foi_alterado:Me!==ze.peso_original}:ze)),Me!==Be&&O(Se=>[...Se,{tipo_alteracao:"ajuste_peso",material:`${Ie.tipo_material} - ${ph[Ie.subtipo_material]}`,peso_anterior:Be,peso_novo:Me}]),ct.success("Peso atualizado");C(null),A("")},ce=async()=>{if(!M){ct.error("Selecione o tipo de material");return}if(M!=="Rejeito"&&!q){ct.error("Selecione o subtipo do material");return}const ne=parseFloat(ae);if(isNaN(ne)||ne<=0){ct.error("Peso invlido");return}Z(!0);try{const Me={id:`temp_add_${Date.now()}`,tipo_material:M,subtipo_material:M==="Rejeito"?"REJEITO":q,peso_kg:ne,peso_original:0,foi_alterado:!1};o(Ie=>[...Ie,Me]),O(Ie=>[...Ie,{tipo_alteracao:"adicao",material:`${M} - ${ph[Me.subtipo_material]||Me.subtipo_material}`,peso_novo:ne,motivo:"Material adicionado durante triagem"}]),ct.success("Material adicionado com sucesso!"),z(""),Y(""),je(""),F(!1)}catch(Me){console.error("Erro ao adicionar material:",Me),ct.error("Erro ao adicionar material",{description:Me.message})}finally{Z(!1)}},xe=ne=>{const Me=i.find(Ie=>Ie.id===ne);Me&&(o(Ie=>Ie.filter(Be=>Be.id!==ne)),O(Ie=>[...Ie,{tipo_alteracao:"remocao",material:`${Me.tipo_material} - ${ph[Me.subtipo_material]}`,peso_anterior:Me.peso_kg}]),ct.success("Material removido"))},Ce=()=>{const ne=c.reduce((Ge,Lt)=>Ge+Lt.peso_kg,0),Me=i.reduce((Ge,Lt)=>Ge+Lt.peso_kg,0),Ie=i.filter(Ge=>Ge.tipo_material==="Rejeito").reduce((Ge,Lt)=>Ge+Lt.peso_kg,0),Be=Me-Ie,ot=Me-ne,Se=i.filter(Ge=>Ge.foi_alterado).length,ze=c.filter(Ge=>!i.find(Lt=>Lt.id===Ge.id)).length,we=i.filter(Ge=>Ge.id.startsWith("temp_")&&!Ge.id.startsWith("temp_add_")&&Ge.tipo_material==="Rejeito").length,Le=i.filter(Ge=>Ge.id.startsWith("temp_add_")).length,Nt=Be/6*G;return{pesoColeta:ne,pesoTriagem:Me,pesoRejeito:Ie,pesoValido:Be,diferenca:ot,materiaisAlterados:Se,materiaisRemovidos:ze,rejeitosCriados:we,materiaisIncluidos:Le,pontosCalculados:Nt,temDiferencas:Se>0||ze>0||we>0||Le>0}},me=async()=>{try{N(!0);const ne=Ce();for(const Be of i)if(Be.id.startsWith("temp_")){const{error:ot}=await J.from("materiais_coletados_detalhado").insert({id_entrega:t,id_cooperativa:a.id_cooperativa,tipo_material:Be.tipo_material,subtipo_material:Be.subtipo_material,peso_kg:Be.peso_kg});if(ot)throw console.error("Erro ao inserir rejeito:",ot),ot}else{const{error:ot}=await J.from("materiais_coletados_detalhado").update({peso_kg:Be.peso_kg}).eq("id",Be.id);if(ot)throw console.error("Erro ao atualizar material:",ot),ot}const Me=c.filter(Be=>!i.find(ot=>ot.id===Be.id));for(const Be of Me)await J.from("materiais_coletados_detalhado").delete().eq("id",Be.id);if(B.length>0){const Be=B.map(ot=>({id_entrega:t,tipo_alteracao:ot.tipo_alteracao,peso_anterior:ot.peso_anterior,peso_novo:ot.peso_novo,motivo:`${ot.material}${ot.motivo?": "+ot.motivo:""}`,realizado_por:r==null?void 0:r.id}));await J.from("triagem_alteracoes").insert(Be)}const{error:Ie}=await J.from("entregas_reciclaveis").update({status:"validada",status_promessa:"finalizada",peso_validado:ne.pesoValido,observacoes_triagem:h,data_validacao:new Date().toISOString()}).eq("id",t);if(Ie)throw Ie;await J.from("notificacoes").insert({id_usuario:a.id_usuario,tipo:"entrega_validada",mensagem:` Entrega validada! Peso vlido: ${gr(ne.pesoValido)} | +${ne.pontosCalculados} pontos creditados`}),ct.success("Triagem finalizada com sucesso!",{description:`Peso vlido: ${gr(ne.pesoValido)} | +${ne.pontosCalculados} pontos creditados`}),e("/cooperative")}catch(ne){console.error("Erro ao finalizar triagem:",ne),ct.error("Erro ao finalizar triagem",{description:ne.message})}finally{N(!1),I(!1)}};if(x)return s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:s.jsx(Ne,{className:"max-w-md w-full",children:s.jsx(De,{className:"pt-6",children:s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Zi,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4 animate-pulse"}),s.jsx("p",{className:"text-muted-foreground",children:"Carregando dados da triagem..."})]})})})});if(!a)return s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:s.jsx(Ne,{className:"max-w-md w-full",children:s.jsx(De,{className:"pt-6",children:s.jsxs("div",{className:"text-center py-8",children:[s.jsx(un,{className:"h-12 w-12 mx-auto text-destructive mb-4"}),s.jsx("p",{className:"text-destructive font-medium mb-2",children:"Entrega no encontrada"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:"No foi possvel carregar os dados da entrega."}),s.jsx(oe,{onClick:()=>e("/cooperative"),children:"Voltar para Dashboard"})]})})})});const fe=Ce();return s.jsxs("div",{className:"min-h-screen bg-background p-4 md:p-8",children:[s.jsxs("div",{className:"mx-auto max-w-5xl space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>e("/cooperative"),children:s.jsx(As,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[s.jsx(Zi,{className:"h-6 w-6 text-purple-500"}),"Triagem e Conferncia"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Validao final dos materiais coletados"})]})]}),s.jsx(Je,{className:"bg-purple-500 text-white",children:"Em Triagem"})]}),s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsx(Qe,{className:"text-lg",children:"Informaes da Entrega"})}),s.jsxs(De,{className:"grid gap-4 md:grid-cols-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ri,{className:"h-4 w-4 text-muted-foreground"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Entregador"}),s.jsx("p",{className:"font-medium",children:ye()})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Fa,{className:"h-4 w-4 text-muted-foreground"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Data da Coleta"}),s.jsx("p",{className:"font-medium",children:new Date(a.data_recebimento||a.data_geracao||a.created_at).toLocaleString("pt-BR")})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Qa,{className:"h-4 w-4 text-muted-foreground"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"ID da Entrega"}),s.jsx("p",{className:"font-mono text-sm",children:t==null?void 0:t.slice(0,8)})]})]})]})]}),fe.temDiferencas&&s.jsxs(Er,{className:"border-warning bg-warning/10",children:[s.jsx(un,{className:"h-4 w-4 text-warning"}),s.jsxs(Sr,{children:[s.jsx("strong",{children:"Diferenas detectadas:"}),fe.materiaisAlterados>0&&` ${fe.materiaisAlterados} material(is) ajustado(s)`,fe.rejeitosCriados>0&&`  ${fe.rejeitosCriados} rejeito(s) criado(s)`,fe.materiaisRemovidos>0&&`  ${fe.materiaisRemovidos} material(is) removido(s)`]})]}),s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(Qe,{children:"Materiais Registrados"}),s.jsx(Tt,{children:"Confira e ajuste as quantidades se necessrio"})]}),s.jsxs(oe,{onClick:()=>F(!0),variant:"outline",size:"sm",className:"gap-2",children:[s.jsx(ra,{className:"h-4 w-4"}),"Adicionar Material"]})]})}),s.jsx(De,{children:s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{children:"Material"}),s.jsx(rt,{children:"Subtipo"}),s.jsx(rt,{children:"Peso Coleta"}),s.jsx(rt,{children:"Peso Triagem"}),s.jsx(rt,{className:"text-right",children:"Aes"})]})}),s.jsx(da,{children:i.length===0?s.jsx(Cs,{children:s.jsx(Ze,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"Nenhum material registrado"})}):i.map(ne=>s.jsxs(Cs,{className:ne.foi_alterado?"bg-warning/5":"",children:[s.jsxs(Ze,{className:"font-medium",children:[ne.tipo_material,ne.foi_alterado&&s.jsx(Je,{variant:"outline",className:"ml-2 text-xs",children:"Ajustado"}),ne.id.startsWith("temp_add_")&&s.jsx(Je,{variant:"default",className:"ml-2 text-xs bg-blue-500",children:"NOVO"})]}),s.jsx(Ze,{children:ph[ne.subtipo_material]}),s.jsx(Ze,{className:"text-muted-foreground",children:gr(ne.peso_original||0)}),s.jsx(Ze,{children:_===ne.id?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(We,{type:"number",step:"0.01",min:"0",value:T,onChange:Me=>A(Me.target.value),className:"w-24",autoFocus:!0,onKeyDown:Me=>{Me.key==="Enter"&&ie(ne.id),Me.key==="Escape"&&ee()}}),s.jsx("span",{className:"text-sm text-muted-foreground",children:"kg"})]}):s.jsx("span",{className:ne.foi_alterado?"font-bold text-warning":"",children:gr(ne.peso_kg)})}),s.jsx(Ze,{className:"text-right",children:_===ne.id?s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsx(oe,{size:"sm",variant:"default",onClick:()=>ie(ne.id),children:s.jsx(Wu,{className:"h-4 w-4"})}),s.jsx(oe,{size:"sm",variant:"ghost",onClick:ee,children:s.jsx(Jr,{className:"h-4 w-4"})})]}):s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsx(oe,{size:"sm",variant:"ghost",onClick:()=>W(ne),children:s.jsx(O6,{className:"h-4 w-4"})}),s.jsx(oe,{size:"sm",variant:"ghost",className:"text-destructive hover:text-destructive",onClick:()=>xe(ne.id),children:s.jsx(Ba,{className:"h-4 w-4"})})]})})]},ne.id))})]})})]}),s.jsxs(Ne,{className:"border-2 border-purple-200 bg-purple-50/50",children:[s.jsx(Ye,{children:s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(fs,{className:"h-5 w-5 text-purple-600"}),"Resumo da Triagem"]})}),s.jsxs(De,{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Peso Total Coleta"}),s.jsx("p",{className:"text-2xl font-bold",children:gr(fe.pesoColeta)})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Peso Total Vlido"}),s.jsx("p",{className:"text-2xl font-bold text-success",children:gr(fe.pesoValido)})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Peso Total Rejeito"}),s.jsx("p",{className:"text-2xl font-bold text-destructive",children:gr(fe.pesoRejeito)})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Diferena Coleta x Triagem"}),s.jsxs("p",{className:`text-2xl font-bold ${Math.abs(fe.diferenca)<.01?"text-success":fe.diferenca<0?"text-destructive":"text-warning"}`,children:[Math.abs(fe.diferenca)<.01?" ":"",fe.diferenca>0?"+":"",gr(Math.abs(fe.diferenca))]})]})]})]}),Math.abs(fe.diferenca)>.01&&s.jsxs(Er,{className:"border-destructive bg-destructive/10",children:[s.jsx(un,{className:"h-4 w-4 text-destructive"}),s.jsxs(Sr,{children:[s.jsx("strong",{className:"text-destructive",children:" Ateno: Diferena Detectada!"}),s.jsx("br",{}),"Para finalizar a triagem, a diferena entre coleta e triagem deve ser ",s.jsx("strong",{children:"0 kg"}),".",s.jsx("br",{}),"Ajuste os pesos dos materiais ou adicione/remova materiais para corrigir."]})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Observaes da Triagem"}),s.jsx(Tt,{children:"Registre aqui qualquer observao importante sobre a triagem"})]}),s.jsx(De,{children:s.jsx(jn,{placeholder:"Ex: Material PET estava contaminado com resduos, Papelo estava mido, etc.",value:h,onChange:ne=>p(ne.target.value),rows:4})})]}),s.jsx(Ne,{children:s.jsx(De,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(oe,{variant:"outline",onClick:()=>e("/cooperative"),disabled:b,children:[s.jsx(As,{className:"mr-2 h-4 w-4"}),"Voltar"]}),s.jsxs(oe,{size:"lg",onClick:()=>I(!0),disabled:b||i.length===0,className:"bg-purple-600 hover:bg-purple-700",children:[s.jsx(Tr,{className:"mr-2 h-5 w-5"}),"Finalizar Triagem"]})]})})})]}),s.jsx(hc,{open:D,onOpenChange:F,children:s.jsxs(Dl,{className:"max-w-2xl",children:[s.jsxs(Ml,{children:[s.jsx(Fl,{children:"Adicionar Novo Material"}),s.jsx(Bl,{children:"Adicione um material que no foi registrado inicialmente na coleta"})]}),s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"tipo_material",children:"Tipo de Material"}),s.jsxs(qs,{value:M,onValueChange:ne=>{z(ne),Y("")},children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Selecione"})}),s.jsxs(Fs,{children:[Object.keys(mE).map(ne=>s.jsx(xt,{value:ne,children:ne},ne)),s.jsx(xt,{value:"Rejeito",children:"Rejeito"})]})]})]}),M&&M!=="Rejeito"&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"subtipo_material",children:"Subtipo"}),s.jsxs(qs,{value:q,onValueChange:Y,children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Selecione"})}),s.jsx(Fs,{children:(ve=mE[M])==null?void 0:ve.map(ne=>s.jsx(xt,{value:ne,children:ph[ne]},ne))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"peso_material",children:"Peso (kg)"}),s.jsx(We,{id:"peso_material",type:"number",step:"0.01",min:"0",placeholder:"0.00",value:ae,onChange:ne=>je(ne.target.value)})]})]}),s.jsx(Er,{className:"border-blue-200 bg-blue-50/50",children:s.jsxs(Sr,{className:"text-sm",children:[" ",s.jsx("strong",{children:"Dica:"})," Use esta funo para adicionar materiais encontrados durante a triagem que no foram registrados na coleta inicial."]})})]}),s.jsxs(Ll,{children:[s.jsx(Ul,{disabled:H,children:"Cancelar"}),s.jsx(Vl,{onClick:ce,disabled:H,className:"bg-blue-600 hover:bg-blue-700",children:H?"Adicionando...":"Adicionar Material"})]})]})}),s.jsx(hc,{open:k,onOpenChange:I,children:s.jsxs(Dl,{children:[s.jsxs(Ml,{children:[s.jsx(Fl,{children:"Confirmar Finalizao da Triagem"}),s.jsx(Bl,{asChild:!0,children:s.jsxs("div",{className:"space-y-3",children:[s.jsx("p",{children:"Voc est prestes a finalizar a triagem desta entrega."}),s.jsxs("div",{className:"bg-muted p-4 rounded-md space-y-3 text-sm",children:[s.jsxs("div",{className:"space-y-1.5",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Peso Total Coleta:"})," ",gr(fe.pesoColeta)]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Peso Total Vlido:"})," ",gr(fe.pesoValido)]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Peso Total Rejeito:"})," ",gr(fe.pesoRejeito)]}),s.jsxs("p",{className:Math.abs(fe.diferenca)>.01?"text-destructive font-bold":"",children:[s.jsx("strong",{children:"Diferena Coleta x Triagem:"})," ",gr(Math.abs(fe.diferenca))]})]}),s.jsxs("div",{className:"border-t border-border pt-3",children:[s.jsxs("div",{className:"flex items-center gap-2 text-base font-semibold text-green-600",children:[s.jsx("span",{children:""}),s.jsxs("span",{children:["Pontos a Creditar: ",fe.pontosCalculados.toFixed(2)," pontos"]})]}),s.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Baseado em ",gr(fe.pesoValido)," de materiais vlidos (sem rejeitos)"]})]}),fe.temDiferencas&&s.jsxs("div",{className:"border-t border-border pt-3 space-y-1",children:[fe.materiaisIncluidos>0&&s.jsxs("p",{children:[s.jsx("strong",{children:"Materiais Includos:"})," ",fe.materiaisIncluidos]}),fe.materiaisAlterados>0&&s.jsxs("p",{children:[s.jsx("strong",{children:"Materiais Ajustados:"})," ",fe.materiaisAlterados]}),fe.rejeitosCriados>0&&s.jsxs("p",{children:[s.jsx("strong",{children:"Rejeitos Criados:"})," ",fe.rejeitosCriados]})]})]}),Math.abs(fe.diferenca)>.01?s.jsxs(Er,{className:"border-destructive bg-destructive/10",children:[s.jsx(un,{className:"h-4 w-4 text-destructive"}),s.jsxs(Sr,{className:"text-destructive font-medium",children:[s.jsx("strong",{children:" No  possvel finalizar!"}),s.jsx("br",{}),"A diferena entre coleta e triagem deve ser 0 kg. Por favor, ajuste os pesos dos materiais para que a soma total seja igual ao peso da coleta."]})]}):s.jsx("p",{className:"text-warning font-medium",children:"Esta ao no poder ser desfeita e a entrega ser marcada como finalizada."})]})})]}),s.jsxs(Ll,{children:[s.jsx(Ul,{disabled:b,children:"Cancelar"}),s.jsx(Vl,{onClick:me,disabled:b||Math.abs(fe.diferenca)>.01,className:"bg-purple-600 hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed",children:b?"Finalizando...":Math.abs(fe.diferenca)>.01?"Ajuste os pesos primeiro":"Confirmar Finalizao"})]})]})})]})}function GZ(){var M,z;const{user:e}=sr(),[t,r]=E.useState(!1),[a,n]=E.useState(!1),[i,o]=E.useState(""),[c,d]=E.useState(null),[h,p]=E.useState(""),[x,v]=E.useState(!1),[b,N]=E.useState(null),[_,C]=E.useState([]),[T,A]=E.useState(null),k=ds(),{toast:I}=_r(),B=async()=>{var q;if(!i.trim()){I({title:"Campo obrigatrio",description:"Digite o cdigo QR",variant:"destructive"});return}n(!0);try{const{data:Y}=await J.from("cooperativas").select("id").eq("id_user",e==null?void 0:e.id).single();if(!Y)throw new Error("Cooperativa no encontrada");const{data:ae,error:je}=await J.from("entregas_reciclaveis").select(`
          *,
          profiles:id_usuario (nome, telefone)
        `).eq("qrcode_id",i).eq("id_cooperativa",Y.id).single();if(je)throw new Error("Entrega no encontrada");const H=new Date(ae.data_geracao),Z=new Date(H);Z.setHours(Z.getHours()+24);const G=new Date;if(ae.status==="gerada"&&G>Z)throw await J.from("entregas_reciclaveis").update({status:"expirada"}).eq("id",ae.id),new Error("Este QR code expirou aps 24 horas. O usurio deve gerar um novo cdigo.");if(ae.status==="expirada")throw new Error("Este QR code j expirou. O usurio deve gerar um novo cdigo.");if(ae.itens_vinculados&&ae.itens_vinculados.length>0){const{data:Q,error:re}=await J.from("materiais_reciclaveis_usuario").select("*").in("id",ae.itens_vinculados);!re&&Q&&C(Q)}d(ae),p(((q=ae.peso_estimado)==null?void 0:q.toString())||"")}catch(Y){I({title:"Erro",description:Y.message,variant:"destructive"}),d(null)}finally{n(!1)}},O=async()=>{if(!h||!c){I({title:"Peso obrigatrio",description:"Informe o peso validado",variant:"destructive"});return}r(!0);try{const q=c.status==="gerada"?"recebida":"validada",Y={peso_validado:parseFloat(h),status:q};q==="recebida"?Y.data_recebimento=new Date().toISOString():q==="validada"&&(Y.data_validacao=new Date().toISOString());const{error:ae}=await J.from("entregas_reciclaveis").update(Y).eq("id",c.id);if(ae)throw ae;if(q==="validada"){const{error:je}=await J.functions.invoke("processar-entrega-validada",{body:{entrega_id:c.id,peso_validado:parseFloat(h)}});je&&console.error("Erro ao processar entrega:",je)}I({title:"Entrega validada!",description:`Peso de ${h}kg registrado com sucesso`}),q==="validada"&&(N({tipo_material:c.tipo_material,peso_validado:parseFloat(h)}),v(!0)),o(""),d(null),p("")}catch(q){I({title:"Erro",description:q.message,variant:"destructive"})}finally{r(!1)}},D=async(q,Y)=>{if(!q||!Y){A(null);return}try{const{data:ae}=await J.from("materiais_pontuacao").select("pontos_por_6kg").eq("tipo_material",(c==null?void 0:c.tipo_material)||"misto").single(),je=(ae==null?void 0:ae.pontos_por_6kg)||20,H=Y*je/6,Z=Math.abs((Y-q)/q)*100,G=Math.abs(Y-q),Q=Z<=10;let re=1,le=H;Q||(re=Math.max(0,1-(Z-10)/100),le=H*re),A({variacao_percentual:Z,variacao_absoluta:G,dentro_margem:Q,fator_pontuacao:re,pontos_base:H,pontos_finais:le})}catch(ae){console.error("Erro ao calcular variao:",ae)}};E.useEffect(()=>{c!=null&&c.peso_estimado&&h?D(c.peso_estimado,parseFloat(h)):A(null)},[h,c]);const F=q=>({gerada:s.jsx(Je,{variant:"secondary",children:"Aguardando Recebimento"}),recebida:s.jsx(Je,{className:"bg-warning",children:"Recebida"}),validada:s.jsx(Je,{className:"bg-success",children:"Validada"}),fechada:s.jsx(Je,{children:"Fechada"})})[q]||s.jsx(Je,{children:q});return s.jsxs("div",{className:"min-h-screen bg-background p-4 md:p-8",children:[s.jsxs("div",{className:"mx-auto max-w-2xl space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>k("/cooperative"),children:s.jsx(As,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Validar Entrega"}),s.jsx("p",{className:"text-muted-foreground",children:"Busque pelo cdigo QR e registre o peso"})]})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Buscar Entrega"}),s.jsx(Tt,{children:"Digite ou escaneie o cdigo QR da entrega"})]}),s.jsxs(De,{className:"space-y-4",children:[s.jsx("div",{className:"flex gap-2",children:s.jsxs("div",{className:"flex-1",children:[s.jsx(ke,{htmlFor:"qrcode",children:"Cdigo QR"}),s.jsx(We,{id:"qrcode",placeholder:"CICLIK-...",value:i,onChange:q=>o(q.target.value),onKeyDown:q=>q.key==="Enter"&&B()})]})}),s.jsxs(oe,{onClick:B,disabled:a,className:"w-full",children:[a?s.jsx(_s,{className:"mr-2 h-4 w-4 animate-spin"}):s.jsx(eo,{className:"mr-2 h-4 w-4"}),"Buscar Entrega"]})]})]}),c&&s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(Qe,{children:"Detalhes da Entrega"}),F(c.status)]})}),s.jsxs(De,{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-muted-foreground",children:"Usurio"}),s.jsx("p",{className:"font-medium",children:(M=c.profiles)==null?void 0:M.nome})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-muted-foreground",children:"Telefone"}),s.jsx("p",{className:"font-medium",children:((z=c.profiles)==null?void 0:z.telefone)||"N/A"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-muted-foreground",children:"Material"}),s.jsx("p",{className:"font-medium",children:c.tipo_material})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-muted-foreground",children:"Peso Estimado"}),s.jsxs("p",{className:"font-medium",children:[c.peso_estimado||"N/A"," kg"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-muted-foreground",children:"Data Gerao"}),s.jsx("p",{className:"font-medium",children:new Date(c.data_geracao).toLocaleDateString("pt-BR")})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-muted-foreground",children:"Cdigo"}),s.jsx("p",{className:"font-mono text-xs",children:c.qrcode_id})]})]}),_.length>0&&s.jsxs("div",{className:"mt-4 pt-4 border-t space-y-2",children:[s.jsxs("p",{className:"font-medium text-sm",children:["Materiais para Entrega (",_.length,"):"]}),s.jsx("div",{className:"space-y-1 max-h-48 overflow-y-auto",children:_.map(q=>s.jsxs("div",{className:"text-sm p-2 bg-muted rounded",children:[" ",q.descricao," (",q.tipo_embalagem," - ",q.percentual_reciclabilidade,"% reciclvel)"]},q.id))})]}),c.status!=="fechada"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2 pt-4 border-t",children:[s.jsx(ke,{htmlFor:"peso",children:"Peso Validado (kg)"}),s.jsx(We,{id:"peso",type:"number",step:"0.001",placeholder:"Ex: 5.5",value:h,onChange:q=>p(q.target.value)})]}),T&&c.peso_estimado&&s.jsx(Ne,{className:`border-2 ${T.dentro_margem?"border-green-500 bg-green-50 dark:bg-green-950/20":"border-amber-500 bg-amber-50 dark:bg-amber-950/20"}`,children:s.jsxs(De,{className:"pt-6 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Zi,{className:`h-5 w-5 ${T.dentro_margem?"text-green-600":"text-amber-600"}`}),s.jsx("span",{className:"font-semibold",children:"Anlise de Variao"})]}),s.jsx(Je,{className:T.dentro_margem?"bg-green-600 hover:bg-green-700":"bg-amber-600 hover:bg-amber-700",children:T.dentro_margem?"Conforme":"Fora da Margem"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-xs text-muted-foreground",children:"Peso Estimado"}),s.jsxs("p",{className:"text-lg font-bold",children:[c.peso_estimado.toFixed(3)," kg"]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-xs text-muted-foreground",children:"Peso Validado"}),s.jsxs("p",{className:"text-lg font-bold",children:[parseFloat(h).toFixed(3)," kg"]})]})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-background rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[T.variacao_percentual===0?s.jsx(Zi,{className:"h-4 w-4 text-green-600"}):parseFloat(h)>c.peso_estimado?s.jsx(Ir,{className:"h-4 w-4 text-amber-600"}):s.jsx(Vw,{className:"h-4 w-4 text-amber-600"}),s.jsx("span",{className:"text-sm font-medium",children:"Variao:"})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:`text-lg font-bold ${T.dentro_margem?"text-green-600":"text-amber-600"}`,children:[T.variacao_percentual.toFixed(2),"%"]}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["(",T.variacao_absoluta>0?"+":"",T.variacao_absoluta.toFixed(3)," kg)"]})]})]}),s.jsxs("div",{className:"border-t pt-3 space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Pontos Base:"}),s.jsxs("span",{className:"font-medium",children:[T.pontos_base," pts"]})]}),!T.dentro_margem&&s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Fator de Reduo:"}),s.jsxs("span",{className:"font-medium text-amber-600",children:[(T.fator_pontuacao*100).toFixed(0),"%"]})]}),s.jsxs("div",{className:"flex items-center justify-between text-lg font-bold border-t pt-2",children:[s.jsx("span",{children:"Pontos Finais:"}),s.jsxs("span",{className:T.dentro_margem?"text-green-600":"text-amber-600",children:[T.pontos_finais," pts"]})]})]}),!T.dentro_margem&&s.jsxs(Er,{className:"border-amber-600",children:[s.jsx(un,{className:"h-4 w-4 text-amber-600"}),s.jsxs(Sr,{className:"text-sm",children:["A variao de ",T.variacao_percentual.toFixed(2),"% excede a margem de 10%. Os pontos foram reduzidos proporcionalmente."]})]})]})}),s.jsxs(oe,{onClick:O,disabled:t,className:"w-full",size:"lg",children:[t?s.jsx(_s,{className:"mr-2 h-5 w-5 animate-spin"}):s.jsx(Tr,{className:"mr-2 h-5 w-5"}),"Confirmar Validao",T&&` (+${T.pontos_finais} pts)`]})]})]})]})]}),s.jsx(ar,{open:x,onOpenChange:v,children:s.jsxs(tr,{className:"sm:max-w-md",children:[s.jsx(nr,{children:s.jsx(ir,{children:"Entrega Validada com Sucesso! "})}),s.jsxs("div",{className:"space-y-4",children:[b&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"p-4 bg-muted rounded-lg text-center",children:[s.jsx("p",{className:"text-lg font-semibold",children:b.tipo_material}),s.jsxs("p",{className:"text-2xl font-bold text-primary mt-2",children:[b.peso_validado.toFixed(1)," kg"]}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"validados pela cooperativa"})]}),s.jsx(__,{shareData:{type:"entrega_validada",tipo_material:b.tipo_material,peso_validado:b.peso_validado}})]}),s.jsx(oe,{onClick:()=>v(!1),className:"w-full",variant:"outline",children:"Fechar"})]})]})})]})}function KZ(){const{user:e}=sr(),[t,r]=E.useState([]),a=ds();E.useEffect(()=>{n()},[e]);const n=async()=>{if(!e)return;const{data:c}=await J.from("cooperativas").select("id").eq("id_user",e.id).single();if(!c)return;const{data:d}=await J.from("entregas_reciclaveis").select(`
        *,
        profiles:id_usuario (nome)
      `).eq("id_cooperativa",c.id).order("data_geracao",{ascending:!1});d&&r(d)},i=c=>({gerada:s.jsx(Je,{variant:"secondary",children:"Aguardando"}),recebida:s.jsx(Je,{className:"bg-warning",children:"Recebida"}),validada:s.jsx(Je,{className:"bg-success",children:"Validada"}),fechada:s.jsx(Je,{children:"Fechada"})})[c]||s.jsx(Je,{children:c}),o=c=>c==="all"?t:t.filter(d=>d.status===c);return s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-8",children:s.jsxs("div",{className:"mx-auto max-w-4xl space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>a("/cooperative"),children:s.jsx(As,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Entregas Recebidas"}),s.jsx("p",{className:"text-muted-foreground",children:"Histrico de todas as entregas"})]})]}),s.jsxs(Mn,{defaultValue:"all",children:[s.jsxs(Nn,{className:"grid w-full grid-cols-4",children:[s.jsx(Gs,{value:"all",children:"Todas"}),s.jsx(Gs,{value:"gerada",children:"Pendentes"}),s.jsx(Gs,{value:"recebida",children:"Recebidas"}),s.jsx(Gs,{value:"validada",children:"Validadas"})]}),["all","gerada","recebida","validada"].map(c=>s.jsxs(hr,{value:c,className:"space-y-4",children:[o(c).map(d=>{var h;return s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[s.jsx(fs,{className:"h-5 w-5 text-primary mt-1"}),s.jsxs("div",{className:"flex-1",children:[s.jsx(Qe,{className:"text-lg",children:d.tipo_material}),s.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Usurio: ",(h=d.profiles)==null?void 0:h.nome]})]})]}),i(d.status)]})}),s.jsx(De,{children:s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-muted-foreground",children:"Peso Estimado"}),s.jsxs("p",{className:"font-medium",children:[d.peso_estimado||"N/A"," kg"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-muted-foreground",children:"Peso Validado"}),s.jsxs("p",{className:"font-medium",children:[d.peso_validado||"N/A"," kg"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-muted-foreground",children:"Data Gerao"}),s.jsx("p",{className:"font-medium",children:new Date(d.data_geracao).toLocaleDateString("pt-BR")})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-muted-foreground",children:"Cdigo QR"}),s.jsx("p",{className:"font-mono text-xs",children:d.qrcode_id})]})]})})]},d.id)}),o(c).length===0&&s.jsx(Ne,{children:s.jsxs(De,{className:"py-12 text-center",children:[s.jsx(fs,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Nenhuma entrega encontrada"})]})})]},c))]})]})})}function XZ(){const{signOut:e}=sr(),[t,r]=E.useState({usuarios:0,missoes:0,cupons:0,cooperativas:0,empresas:0,entregas:0}),a=ds(),{run:n,completeTour:i,setRun:o}=f_({tourKey:"admin_dashboard",autoStart:!0}),c=[{target:".tour-admin-header",content:"Bem-vindo ao Painel Administrativo! Aqui voc tem controle total do sistema ReciclaA.",disableBeacon:!0},{target:".tour-admin-stats",content:"Veja estatsticas gerais: total de usurios, misses, cupons, cooperativas, empresas e entregas registradas."},{target:".tour-admin-docs",content:"Gere documentao completa em PDF com todas as funcionalidades do sistema para referncia."},{target:".tour-admin-missions",content:"Crie e gerencie misses educativas que os usurios podem completar para ganhar pontos."},{target:".tour-admin-users",content:"Visualize e edite informaes dos usurios, incluindo pontuao e nvel."},{target:".tour-admin-kpis",content:"Acesse relatrios detalhados e KPIs do sistema com anlises comparativas e filtros geogrficos."}],d=()=>{i()};E.useEffect(()=>{h()},[]);const h=async()=>{const{data:v}=await J.from("profiles").select("id, tipo_pessoa, cpf, cnpj, email, created_at, data_cadastro").not("email","is",null).not("nome","is",null),N=((v==null?void 0:v.filter(I=>I.tipo_pessoa==="PF"&&I.cpf&&I.cpf.length>=11||I.tipo_pessoa==="PJ"&&I.cnpj&&I.cnpj.length>=14))||[]).reduce((I,B)=>{const O=B.tipo_pessoa==="PF"?B.cpf:B.cnpj,D=I.findIndex(F=>(F.tipo_pessoa==="PF"?F.cpf:F.cnpj)===O||F.email===B.email);if(D===-1)I.push(B);else{const F=I[D],M=new Date(F.created_at||F.data_cadastro);new Date(B.created_at||B.data_cadastro)>M&&(I[D]=B)}return I},[]),[_,C,T,A,k]=await Promise.all([J.from("missoes").select("id",{count:"exact",head:!0}),J.from("cupons").select("id",{count:"exact",head:!0}),J.from("cooperativas").select("id",{count:"exact",head:!0}),J.from("empresas").select("id",{count:"exact",head:!0}),J.from("entregas_reciclaveis").select("id",{count:"exact",head:!0})]);r({usuarios:N.length,missoes:_.count||0,cupons:C.count||0,cooperativas:T.count||0,empresas:A.count||0,entregas:k.count||0})},p={primary:{bg:"bg-primary/10",text:"text-primary"},accent:{bg:"bg-accent/10",text:"text-accent"},success:{bg:"bg-success/10",text:"text-success"},warning:{bg:"bg-warning/10",text:"text-warning"},secondary:{bg:"bg-secondary/10",text:"text-secondary-foreground"},muted:{bg:"bg-muted/50",text:"text-muted-foreground"}},x=[{title:"Documentao do Sistema",description:"Gerar e visualizar documentao completa",icon:Qa,color:"warning",path:"/admin/documentation"},{title:"Gesto de Termos de Uso",description:"Gerenciar termos, polticas e aceites",icon:jl,color:"primary",path:"/admin/termos"},{title:"Gesto de Misses",description:"Criar e gerenciar misses",icon:wo,color:"primary",path:"/admin/missions"},{title:"Gesto de Cupons",description:"Importar e gerenciar cupons",icon:Jn,color:"accent",path:"/admin/coupons"},{title:"Gesto de Operadores Logsticos",description:"Cooperativas, Rotas Ciclik e Operadores",icon:Ur,color:"success",path:"/admin/operadores-logisticos"},{title:"Gesto de Rotas de Coleta",description:"Configurar rotas, reas e adeses",icon:Sl,color:"primary",path:"/admin/rotas"},{title:"Interesses por Funcionalidade",description:"Demanda de usurios por localidade",icon:Eo,color:"warning",path:"/admin/interesses"},{title:"Gesto de Empresas",description:"Gerenciar empresas parceiras e mtricas",icon:hn,color:"secondary",path:"/admin/companies"},{title:"Gesto CDV",description:"Certificados Digitais Verdes e reconciliao",icon:wo,color:"success",path:"/admin/cdv"},{title:"Gesto de Produtos",description:"Cadastro de produtos Ciclik com GTIN e NCM",icon:fs,color:"primary",path:"/admin/products"},{title:"Relatrio de Produtos",description:"Produtos no cadastrados nas notas fiscais",icon:Ir,color:"warning",path:"/admin/products/report"},{title:"Gesto de Usurios",description:"Ver e editar usurios",icon:oa,color:"muted",path:"/admin/users"},{title:"KPIs e Relatrios",description:"Visualizar mtricas gerais",icon:Su,color:"warning",path:"/admin/kpis"},{title:"Configuraes do Sistema",description:"Gerenciar configuraes globais",icon:Cx,color:"secondary",path:"/admin/settings"},{title:"Gesto de Gamificao",description:"Configurar pontos de atividades",icon:wo,color:"primary",path:"/admin/gamification"},{title:"Auditoria de Pontos",description:"Relatrio de discrepncias e reclculo",icon:Su,color:"warning",path:"/admin/points-audit"},{title:"Promessas de Entrega",description:"Rastreamento de entregas via QR Code",icon:fs,color:"primary",path:"/admin/delivery-promises"}];return s.jsxs(Nc,{children:[s.jsx(e_,{steps:c,run:n,onComplete:d,onSkip:d}),s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-8",children:s.jsxs("div",{className:"mx-auto max-w-7xl space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between tour-admin-header",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"rounded-full bg-primary p-2",children:s.jsx(Cx,{className:"h-6 w-6 text-primary-foreground"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Painel Administrativo"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Ciclik Digital Verde"})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>o(!0),className:"hidden md:flex gap-2",children:[s.jsx(Yi,{className:"h-4 w-4"}),"Tour Guiado"]}),s.jsx(oe,{variant:"ghost",size:"icon",onClick:e,children:s.jsx(gc,{className:"h-5 w-5"})})]})]}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-3 lg:grid-cols-6 tour-admin-stats",children:[s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-2",children:[s.jsx(Tt,{className:"text-xs",children:"Usurios"}),s.jsxs(Qe,{className:"text-2xl flex items-center gap-2",children:[s.jsx("div",{className:"rounded-lg bg-primary/10 p-2",children:s.jsx(oa,{className:"h-5 w-5 text-primary"})}),t.usuarios]})]})}),s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-2",children:[s.jsx(Tt,{className:"text-xs",children:"Misses"}),s.jsxs(Qe,{className:"text-2xl flex items-center gap-2",children:[s.jsx("div",{className:"rounded-lg bg-primary/10 p-2",children:s.jsx(wo,{className:"h-5 w-5 text-primary"})}),t.missoes]})]})}),s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-2",children:[s.jsx(Tt,{className:"text-xs",children:"Cupons"}),s.jsxs(Qe,{className:"text-2xl flex items-center gap-2",children:[s.jsx("div",{className:"rounded-lg bg-accent/10 p-2",children:s.jsx(Jn,{className:"h-5 w-5 text-accent"})}),t.cupons]})]})}),s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-2",children:[s.jsx(Tt,{className:"text-xs",children:"Operadores"}),s.jsxs(Qe,{className:"text-2xl flex items-center gap-2",children:[s.jsx("div",{className:"rounded-lg bg-success/10 p-2",children:s.jsx(Ur,{className:"h-5 w-5 text-success"})}),t.cooperativas]})]})}),s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-2",children:[s.jsx(Tt,{className:"text-xs",children:"Empresas"}),s.jsxs(Qe,{className:"text-2xl flex items-center gap-2",children:[s.jsx("div",{className:"rounded-lg bg-secondary/10 p-2",children:s.jsx(hn,{className:"h-5 w-5 text-secondary-foreground"})}),t.empresas]})]})}),s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-2",children:[s.jsx(Tt,{className:"text-xs",children:"Entregas"}),s.jsxs(Qe,{className:"text-2xl flex items-center gap-2",children:[s.jsx("div",{className:"rounded-lg bg-warning/10 p-2",children:s.jsx(Ir,{className:"h-5 w-5 text-warning"})}),t.entregas]})]})})]}),s.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:x.map((v,b)=>{const N=p[v.color];return s.jsx(Ne,{className:`cursor-pointer transition-all hover:shadow-lg hover:scale-105 ${b===0?"tour-admin-docs":b===2?"tour-admin-missions":b===5?"tour-admin-users":b===6?"tour-admin-kpis":""}`,onClick:()=>a(v.path),children:s.jsx(Ye,{children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`rounded-lg ${N.bg} p-3`,children:s.jsx(v.icon,{className:`h-8 w-8 ${N.text}`})}),s.jsxs("div",{children:[s.jsx(Qe,{className:"text-lg",children:v.title}),s.jsx(Tt,{children:v.description})]})]})})},v.path)})})]})})]})}function YZ(){const[e,t]=E.useState([]),r=ds(),{toast:a}=_r();E.useEffect(()=>{n()},[]);const n=async()=>{const{data:o}=await J.from("missoes").select("*, questoes_missao(*)").order("ordem",{ascending:!0});o&&t(o)},i=async o=>{if(confirm("Tem certeza que deseja excluir esta misso?"))try{const{error:c}=await J.from("missoes").delete().eq("id",o);if(c)throw c;a({title:"Misso excluda!"}),n()}catch(c){a({title:"Erro",description:c.message,variant:"destructive"})}};return s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-8",children:s.jsxs("div",{className:"mx-auto max-w-6xl space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>r("/admin"),className:"gap-2",children:[s.jsx(As,{className:"h-4 w-4"}),"Voltar"]}),s.jsx("h1",{className:"text-3xl font-bold",children:"Gerenciar Misses Educacionais"})]}),s.jsxs(oe,{onClick:()=>r("/admin/missions/edit/new"),children:[s.jsx(ra,{className:"mr-2 h-4 w-4"}),"Nova Misso"]})]}),s.jsx("div",{className:"grid gap-4",children:e.length===0?s.jsx(Ne,{children:s.jsx(De,{className:"pt-6",children:s.jsx("p",{className:"text-center text-muted-foreground",children:"Nenhuma misso cadastrada"})})}):e.map(o=>{var c;return s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"space-y-2 flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Qe,{children:o.titulo}),s.jsx(Je,{variant:o.status==="ativa"?"default":"secondary",children:o.status})]}),s.jsx(Tt,{children:o.descricao}),s.jsxs("div",{className:"flex gap-4 text-sm text-muted-foreground",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Qa,{className:"h-4 w-4"}),o.apostila_pdf_url?"Com apostila":"Sem apostila"]}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Sx,{className:"h-4 w-4"}),o.video_url?"Com vdeo":"Sem vdeo"]}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Yi,{className:"h-4 w-4"}),((c=o.questoes_missao)==null?void 0:c.length)||0," questes"]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>r(`/admin/missions/edit/${o.id}`),children:s.jsx(Nd,{className:"h-4 w-4"})}),s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>i(o.id),children:s.jsx(Ba,{className:"h-4 w-4"})})]})]})}),s.jsx(De,{children:s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("span",{children:["Ordem: ",o.ordem]}),s.jsxs("span",{children:[o.pontos," pontos"]})]})})]},o.id)})})]})})}function ZZ(){const{id:e}=To(),t=ds(),{toast:r}=_r(),a=e==="new",[n,i]=E.useState(!a),[o,c]=E.useState(!1),[d,h]=E.useState({titulo:"",descricao:"",pontos:0,valor_credito:0,status:"ativa",video_url:"",ordem:0}),[p,x]=E.useState([]),[v,b]=E.useState({pergunta:"",alternativa_a:"",alternativa_b:"",alternativa_c:"",alternativa_d:"",resposta_correta:"A",explicacao:"",ordem:0});E.useEffect(()=>{!a&&e&&N(e)},[e,a]);const N=async A=>{try{const{data:k,error:I}=await J.from("missoes").select("*").eq("id",A).single();if(I)throw I;if(k){h({titulo:k.titulo,descricao:k.descricao,pontos:k.pontos,valor_credito:k.valor_credito||0,status:k.status||"ativa",video_url:k.video_url||"",ordem:k.ordem});const{data:B}=await J.from("questoes_missao").select("*").eq("id_missao",A).order("ordem",{ascending:!0});B&&x(B)}}catch(k){r({title:"Erro ao carregar misso",description:k.message,variant:"destructive"}),t("/admin/missions")}finally{i(!1)}},_=async A=>{A.preventDefault(),c(!0);try{let k=e;if(a){const{data:I,error:B}=await J.from("missoes").insert({...d,tipo:"educacao"}).select().single();if(B)throw B;k=I.id}else{const{error:I}=await J.from("missoes").update(d).eq("id",e);if(I)throw I}if(k&&(a||await J.from("questoes_missao").delete().eq("id_missao",k),p.length>0)){const I=p.map((O,D)=>({pergunta:O.pergunta,alternativa_a:O.alternativa_a,alternativa_b:O.alternativa_b,alternativa_c:O.alternativa_c,alternativa_d:O.alternativa_d,resposta_correta:O.resposta_correta,explicacao:O.explicacao,ordem:D,id_missao:k})),{error:B}=await J.from("questoes_missao").insert(I);if(B)throw B}r({title:a?"Misso criada!":"Misso atualizada!"}),t("/admin/missions")}catch(k){r({title:"Erro",description:k.message,variant:"destructive"})}finally{c(!1)}},C=()=>{if(!v.pergunta){r({title:"Preencha a pergunta",variant:"destructive"});return}x([...p,{...v,ordem:p.length}]),b({pergunta:"",alternativa_a:"",alternativa_b:"",alternativa_c:"",alternativa_d:"",resposta_correta:"A",explicacao:"",ordem:0})},T=A=>{x(p.filter((k,I)=>I!==A))};return n?s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-8 flex items-center justify-center",children:s.jsx("p",{children:"Carregando..."})}):s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-8",children:s.jsxs("div",{className:"mx-auto max-w-4xl space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>t("/admin/missions"),children:s.jsx(As,{className:"h-5 w-5"})}),s.jsx("h1",{className:"text-3xl font-bold",children:a?"Nova Misso":"Editar Misso"})]}),s.jsxs("form",{onSubmit:_,className:"space-y-6",children:[s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsx(Qe,{children:"Informaes da Misso"})}),s.jsxs(De,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"titulo",children:"Ttulo"}),s.jsx(We,{id:"titulo",value:d.titulo,onChange:A=>h({...d,titulo:A.target.value}),required:!0})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"descricao",children:"Descrio"}),s.jsx(jn,{id:"descricao",value:d.descricao,onChange:A=>h({...d,descricao:A.target.value}),required:!0})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"pontos",children:"Pontos"}),s.jsx(We,{id:"pontos",type:"number",value:d.pontos,onChange:A=>h({...d,pontos:parseInt(A.target.value)||0}),required:!0})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"valor_credito",children:"Valor de Crdito (R$)"}),s.jsx(We,{id:"valor_credito",type:"number",step:"0.01",value:d.valor_credito,onChange:A=>h({...d,valor_credito:parseFloat(A.target.value)||0}),placeholder:"20.00"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Crditos concedidos ao completar esta misso"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"ordem",children:"Ordem"}),s.jsx(We,{id:"ordem",type:"number",value:d.ordem,onChange:A=>h({...d,ordem:parseInt(A.target.value)||0}),required:!0})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"status",children:"Status"}),s.jsxs(qs,{value:d.status,onValueChange:A=>h({...d,status:A}),children:[s.jsx(Ls,{children:s.jsx(Ws,{})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"ativa",children:"Ativa"}),s.jsx(xt,{value:"inativa",children:"Inativa"})]})]})]})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"video_url",children:"URL do Vdeo"}),s.jsx(We,{id:"video_url",value:d.video_url,onChange:A=>h({...d,video_url:A.target.value}),placeholder:"https://youtube.com/embed/..."}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Voc pode abrir o YouTube em outra aba para copiar o link"})]})]})]}),s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsxs(Qe,{children:["Questes do Quiz (",p.length,")"]})}),s.jsxs(De,{className:"space-y-4",children:[p.length>0&&s.jsx("div",{className:"space-y-2",children:p.map((A,k)=>s.jsxs("div",{className:"flex items-start justify-between p-3 border rounded-lg",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("p",{className:"font-medium",children:[k+1,". ",A.pergunta]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Resposta: ",A.resposta_correta]})]}),s.jsx(oe,{type:"button",variant:"ghost",size:"sm",onClick:()=>T(k),children:s.jsx(Ba,{className:"h-4 w-4"})})]},k))}),s.jsxs("div",{className:"space-y-3 p-4 border rounded-lg bg-muted/50",children:[s.jsxs("div",{children:[s.jsx(ke,{children:"Pergunta"}),s.jsx(We,{value:v.pergunta,onChange:A=>b({...v,pergunta:A.target.value}),placeholder:"Digite a pergunta"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx(ke,{children:"Alternativa A"}),s.jsx(We,{value:v.alternativa_a,onChange:A=>b({...v,alternativa_a:A.target.value})})]}),s.jsxs("div",{children:[s.jsx(ke,{children:"Alternativa B"}),s.jsx(We,{value:v.alternativa_b,onChange:A=>b({...v,alternativa_b:A.target.value})})]}),s.jsxs("div",{children:[s.jsx(ke,{children:"Alternativa C"}),s.jsx(We,{value:v.alternativa_c,onChange:A=>b({...v,alternativa_c:A.target.value})})]}),s.jsxs("div",{children:[s.jsx(ke,{children:"Alternativa D"}),s.jsx(We,{value:v.alternativa_d,onChange:A=>b({...v,alternativa_d:A.target.value})})]})]}),s.jsxs("div",{children:[s.jsx(ke,{children:"Resposta Correta"}),s.jsxs(qs,{value:v.resposta_correta,onValueChange:A=>b({...v,resposta_correta:A}),children:[s.jsx(Ls,{children:s.jsx(Ws,{})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"A",children:"A"}),s.jsx(xt,{value:"B",children:"B"}),s.jsx(xt,{value:"C",children:"C"}),s.jsx(xt,{value:"D",children:"D"})]})]})]}),s.jsxs("div",{children:[s.jsx(ke,{children:"Explicao da Resposta (opcional)"}),s.jsx(jn,{value:v.explicacao,onChange:A=>b({...v,explicacao:A.target.value}),placeholder:"Explique por que esta  a resposta correta...",rows:3})]}),s.jsxs(oe,{type:"button",onClick:C,variant:"outline",className:"w-full",children:[s.jsx(ra,{className:"mr-2 h-4 w-4"}),"Adicionar Questo"]})]})]})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx(oe,{type:"button",variant:"outline",onClick:()=>t("/admin/missions"),className:"flex-1",children:"Cancelar"}),s.jsxs(oe,{type:"submit",className:"flex-1",disabled:o,children:[s.jsx(Wu,{className:"mr-2 h-4 w-4"}),o?"Salvando...":a?"Criar Misso":"Salvar Alteraes"]})]})]})]})})}function QZ(){const[e,t]=E.useState([]),[r,a]=E.useState(!1),[n,i]=E.useState(!1),[o,c]=E.useState(""),d=ds(),{toast:h}=_r(),[p,x]=E.useState({marketplace:"",codigo:"",valor:"",minimo_compra:"",data_validade:"",quantidade_total:"1"});E.useEffect(()=>{v()},[]);const v=async()=>{const{data:B}=await J.from("cupons").select("*").order("data_resgate",{ascending:!1,nullsFirst:!1});B&&t(B)},b=()=>{x({marketplace:"",codigo:"",valor:"",minimo_compra:"",data_validade:"",quantidade_total:"1"})},N=async B=>{B.preventDefault();try{const{error:O}=await J.from("cupons").insert({marketplace:p.marketplace,codigo:p.codigo,valor_reais:parseFloat(p.valor),minimo_compra:parseFloat(p.minimo_compra),data_validade:p.data_validade||null,quantidade_total:parseInt(p.quantidade_total),quantidade_disponivel:parseInt(p.quantidade_total),status:"disponivel"});if(O)throw O;h({title:"Cupom criado!"}),a(!1),b(),v()}catch(O){h({title:"Erro",description:O.message,variant:"destructive"})}},_=async()=>{try{const O=o.trim().split(`
`).filter(F=>F.trim()&&!F.startsWith("Marketplace")).map(F=>{const[M,z,q,Y,ae,je]=F.split(","),H=parseInt((je==null?void 0:je.trim())||"1");return{marketplace:M.trim(),codigo:z.trim(),valor_reais:parseFloat(q.trim()),minimo_compra:parseFloat(Y.trim()),data_validade:(ae==null?void 0:ae.trim())||null,quantidade_total:H,quantidade_disponivel:H,status:"disponivel"}}),{error:D}=await J.from("cupons").insert(O);if(D)throw D;h({title:"Importao concluda!",description:`${O.length} cupons importados`}),i(!1),c(""),v()}catch(B){h({title:"Erro na importao",description:B.message,variant:"destructive"})}},C=()=>{const B=`Marketplace,Codigo,Valor,Minimo_Compra,Data_Validade,Quantidade
Amazon,VERDE50,50.00,200.00,2025-12-31,10
iFood,ECO30,30.00,150.00,2025-12-31,5
Rappi,SUSTENTA25,25.00,100.00,2025-06-30,15`,O=new Blob([B],{type:"text/csv;charset=utf-8;"}),D=document.createElement("a"),F=URL.createObjectURL(O);D.setAttribute("href",F),D.setAttribute("download","modelo_importacao_cupons.csv"),D.style.visibility="hidden",document.body.appendChild(D),D.click(),document.body.removeChild(D),h({title:"Template baixado!",description:"Preencha a planilha e importe de volta"})},T=async B=>{if(confirm("Tem certeza que deseja excluir este cupom?"))try{const{error:O}=await J.from("cupons").delete().eq("id",B);if(O)throw O;h({title:"Cupom excludo!"}),v()}catch(O){h({title:"Erro",description:O.message,variant:"destructive"})}},A=B=>({disponivel:s.jsx(Je,{className:"bg-success text-white",children:"Disponvel"}),reservado:s.jsx(Je,{className:"bg-warning text-white",children:"Reservado"}),usado:s.jsx(Je,{variant:"secondary",className:"text-white",children:"Usado"})})[B]||s.jsx(Je,{className:"text-white",children:B}),k=B=>B==="all"?e:e.filter(O=>O.status===B),I=()=>{const B={};return e.forEach(O=>{B[O.marketplace]||(B[O.marketplace]={total:0,disponivel:0,usado:0}),B[O.marketplace].total++,O.status==="disponivel"&&B[O.marketplace].disponivel++,O.status==="usado"&&B[O.marketplace].usado++}),B};return s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-8",children:s.jsxs("div",{className:"mx-auto max-w-6xl space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>d("/admin"),className:"gap-2",children:[s.jsx(As,{className:"h-4 w-4"}),"Voltar"]}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Gesto de Cupons"}),s.jsx("p",{className:"text-muted-foreground",children:"Criar e importar cupons em lote"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(ar,{open:n,onOpenChange:i,children:[s.jsx(kp,{asChild:!0,children:s.jsxs(oe,{variant:"outline",children:[s.jsx(wd,{className:"mr-2 h-4 w-4"}),"Importar em Lote"]})}),s.jsxs(tr,{className:"max-w-2xl",children:[s.jsx(nr,{children:s.jsx(ir,{children:"Importao em Lote"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx(ke,{children:"Formato CSV"}),s.jsxs(oe,{type:"button",variant:"outline",size:"sm",onClick:C,children:[s.jsx(Ua,{className:"mr-2 h-4 w-4"}),"Baixar Modelo"]})]}),s.jsx("div",{className:"space-y-2",children:s.jsx(jn,{value:o,onChange:B=>c(B.target.value),placeholder:`Marketplace,Codigo,Valor,Minimo_Compra,Data_Validade,Quantidade
Amazon,VERDE50,50.00,200.00,2025-12-31,10`,rows:10,className:"font-mono text-sm"})}),s.jsxs("div",{className:"bg-muted p-3 rounded-lg text-sm",children:[s.jsx("p",{className:"font-semibold mb-2",children:"Formato:"}),s.jsxs("code",{className:"text-xs",children:["Marketplace,Codigo,Valor,Minimo_Compra,Data_Validade,Quantidade",s.jsx("br",{}),"Amazon,VERDE50,50.00,200.00,2025-12-31,10",s.jsx("br",{}),"iFood,ECO30,30.00,150.00,2025-12-31,5"]}),s.jsxs("p",{className:"mt-2 text-muted-foreground",children:[s.jsx("strong",{children:"Dica:"})," Baixe o modelo, preencha no Excel/Google Sheets e cole aqui."]})]}),s.jsx(oe,{onClick:_,className:"w-full",children:"Importar Cupons"})]})]})]}),s.jsxs(ar,{open:r,onOpenChange:a,children:[s.jsx(kp,{asChild:!0,children:s.jsxs(oe,{onClick:b,children:[s.jsx(ra,{className:"mr-2 h-4 w-4"}),"Novo Cupom"]})}),s.jsxs(tr,{children:[s.jsx(nr,{children:s.jsx(ir,{children:"Novo Cupom"})}),s.jsxs("form",{onSubmit:N,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{children:"Marketplace"}),s.jsx(We,{value:p.marketplace,onChange:B=>x({...p,marketplace:B.target.value}),placeholder:"Amazon, iFood, Rappi...",required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{children:"Cdigo do Cupom"}),s.jsx(We,{value:p.codigo,onChange:B=>x({...p,codigo:B.target.value}),placeholder:"VERDE50OFF",required:!0})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{children:"Valor (R$)"}),s.jsx(We,{type:"number",step:"0.01",value:p.valor,onChange:B=>x({...p,valor:B.target.value}),required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{children:"Mnimo (R$)"}),s.jsx(We,{type:"number",step:"0.01",value:p.minimo_compra,onChange:B=>x({...p,minimo_compra:B.target.value}),required:!0})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{children:"Data de Validade"}),s.jsx(We,{type:"date",value:p.data_validade,onChange:B=>x({...p,data_validade:B.target.value}),min:new Date().toISOString().split("T")[0]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Deixe em branco para sem validade"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{children:"Quantidade"}),s.jsx(We,{type:"number",min:"1",value:p.quantidade_total,onChange:B=>x({...p,quantidade_total:B.target.value}),required:!0})]})]}),s.jsx(oe,{type:"submit",className:"w-full",children:"Criar Cupom"})]})]})]})]})]}),s.jsx("div",{className:"grid gap-4 md:grid-cols-3 lg:grid-cols-5",children:Object.entries(I()).map(([B,O])=>s.jsxs(Ne,{children:[s.jsx(Ye,{className:"pb-3",children:s.jsx(Qe,{className:"text-sm font-medium",children:B})}),s.jsx(De,{children:s.jsxs("div",{className:"space-y-1 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Total:"}),s.jsx("span",{className:"font-bold",children:O.total})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-success",children:"Disponvel:"}),s.jsx("span",{className:"font-bold",children:O.disponivel})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Usados:"}),s.jsx("span",{children:O.usado})]})]})})]},B))}),s.jsxs(Mn,{defaultValue:"all",children:[s.jsxs(Nn,{className:"grid w-full grid-cols-4",children:[s.jsxs(Gs,{value:"all",children:["Todos (",e.length,")"]}),s.jsx(Gs,{value:"disponivel",children:"Disponveis"}),s.jsx(Gs,{value:"reservado",children:"Reservados"}),s.jsx(Gs,{value:"usado",children:"Usados"})]}),["all","disponivel","reservado","usado"].map(B=>s.jsx(hr,{value:B,className:"space-y-4",children:k(B).length===0?s.jsx(Ne,{children:s.jsxs(De,{className:"py-12 text-center",children:[s.jsx(Jn,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Nenhum cupom nesta categoria"})]})}):s.jsx("div",{className:"rounded-md border",children:s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{children:"Marketplace"}),s.jsx(rt,{children:"Cdigo"}),s.jsx(rt,{className:"text-right",children:"Valor"}),s.jsx(rt,{className:"text-center",children:"Estoque"}),s.jsx(rt,{children:"Validade"}),s.jsx(rt,{children:"Status"}),s.jsx(rt,{className:"text-center",children:"Aes"})]})}),s.jsx(da,{children:k(B).map(O=>{var D;return s.jsxs(Cs,{children:[s.jsx(Ze,{className:"font-medium",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Jn,{className:"h-4 w-4 text-primary"}),O.marketplace]})}),s.jsx(Ze,{children:s.jsx("code",{className:"bg-muted px-2 py-1 rounded text-xs",children:O.codigo})}),s.jsxs(Ze,{className:"text-right font-semibold",children:["R$ ",((D=O.valor_reais)==null?void 0:D.toFixed(2))||"0,00"]}),s.jsx(Ze,{className:"text-center",children:s.jsxs("span",{className:"text-sm",children:[O.quantidade_disponivel||0,"/",O.quantidade_total||1]})}),s.jsx(Ze,{children:O.data_validade?s.jsx("span",{className:"text-sm",children:new Date(O.data_validade).toLocaleDateString("pt-BR")}):s.jsx("span",{className:"text-xs text-muted-foreground",children:"Sem validade"})}),s.jsx(Ze,{children:A(O.status)}),s.jsx(Ze,{className:"text-center",children:O.status==="disponivel"&&s.jsx(oe,{size:"icon",variant:"ghost",onClick:()=>T(O.id),children:s.jsx(Ba,{className:"h-4 w-4"})})})]},O.id)})})]})})},B))]})]})})}const S_=H8,T_=G8,JZ=E.forwardRef(({className:e,inset:t,children:r,...a},n)=>s.jsxs(JS,{ref:n,className:pt("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",t&&"pl-8",e),...a,children:[r,s.jsx(Xi,{className:"ml-auto h-4 w-4"})]}));JZ.displayName=JS.displayName;const eQ=E.forwardRef(({className:e,...t},r)=>s.jsx(e4,{ref:r,className:pt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));eQ.displayName=e4.displayName;const Xg=E.forwardRef(({className:e,sideOffset:t=4,...r},a)=>s.jsx(W8,{children:s.jsx(t4,{ref:a,sideOffset:t,className:pt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));Xg.displayName=t4.displayName;const Ka=E.forwardRef(({className:e,inset:t,...r},a)=>s.jsx(s4,{ref:a,className:pt("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t&&"pl-8",e),...r}));Ka.displayName=s4.displayName;const tQ=E.forwardRef(({className:e,children:t,checked:r,...a},n)=>s.jsxs(r4,{ref:n,className:pt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),checked:r,...a,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(a4,{children:s.jsx(Ea,{className:"h-4 w-4"})})}),t]}));tQ.displayName=r4.displayName;const sQ=E.forwardRef(({className:e,children:t,...r},a)=>s.jsxs(n4,{ref:a,className:pt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),...r,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(a4,{children:s.jsx(p4,{className:"h-2 w-2 fill-current"})})}),t]}));sQ.displayName=n4.displayName;const qP=E.forwardRef(({className:e,inset:t,...r},a)=>s.jsx(i4,{ref:a,className:pt("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));qP.displayName=i4.displayName;const iw=E.forwardRef(({className:e,...t},r)=>s.jsx(o4,{ref:r,className:pt("-mx-1 my-1 h-px bg-muted",e),...t}));iw.displayName=o4.displayName;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var eg={};eg.version="0.18.5";var WP=1252,rQ=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],HP=function(e){rQ.indexOf(e)!=-1&&(WP=e)};function aQ(){HP(1252)}var Pp=function(e){HP(e)};function nQ(){Pp(1200),aQ()}var G0=function(t){return String.fromCharCode(t)},pE=function(t){return String.fromCharCode(t)},iu,vd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ip(e){for(var t="",r=0,a=0,n=0,i=0,o=0,c=0,d=0,h=0;h<e.length;)r=e.charCodeAt(h++),i=r>>2,a=e.charCodeAt(h++),o=(r&3)<<4|a>>4,n=e.charCodeAt(h++),c=(a&15)<<2|n>>6,d=n&63,isNaN(a)?c=d=64:isNaN(n)&&(d=64),t+=vd.charAt(i)+vd.charAt(o)+vd.charAt(c)+vd.charAt(d);return t}function bc(e){var t="",r=0,a=0,n=0,i=0,o=0,c=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)i=vd.indexOf(e.charAt(h++)),o=vd.indexOf(e.charAt(h++)),r=i<<2|o>>4,t+=String.fromCharCode(r),c=vd.indexOf(e.charAt(h++)),a=(o&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(a)),d=vd.indexOf(e.charAt(h++)),n=(c&3)<<6|d,d!==64&&(t+=String.fromCharCode(n));return t}var Dr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ec=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Fu(e){return Dr?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function xE(e){return Dr?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Qo=function(t){return Dr?Ec(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Yg(e){if(typeof ArrayBuffer>"u")return Qo(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function l0(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function iQ(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Rn=Dr?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ec(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function oQ(e){for(var t=[],r=0,a=e.length+250,n=Fu(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)n[r++]=o;else if(o<2048)n[r++]=192|o>>6&31,n[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var c=e.charCodeAt(++i)&1023;n[r++]=240|o>>8&7,n[r++]=128|o>>2&63,n[r++]=128|c>>6&15|(o&3)<<4,n[r++]=128|c&63}else n[r++]=224|o>>12&15,n[r++]=128|o>>6&63,n[r++]=128|o&63;r>a&&(t.push(n.slice(0,r)),r=0,n=Fu(65535),a=65530)}return t.push(n.slice(0,r)),Rn(t)}var Gm=/\u0000/g,K0=/[\u0001-\u0006]/g;function Vh(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function el(e,t){var r=""+e;return r.length>=t?r:Oa("0",t-r.length)+r}function A_(e,t){var r=""+e;return r.length>=t?r:Oa(" ",t-r.length)+r}function tg(e,t){var r=""+e;return r.length>=t?r:r+Oa(" ",t-r.length)}function lQ(e,t){var r=""+Math.round(e);return r.length>=t?r:Oa("0",t-r.length)+r}function cQ(e,t){var r=""+e;return r.length>=t?r:Oa("0",t-r.length)+r}var gE=Math.pow(2,32);function xh(e,t){if(e>gE||e<-gE)return lQ(e,t);var r=Math.round(e);return cQ(r,t)}function sg(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var vE=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],fv=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function dQ(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Ma={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},yE={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},uQ={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function rg(e,t,r){for(var a=e<0?-1:1,n=e*a,i=0,o=1,c=0,d=1,h=0,p=0,x=Math.floor(n);h<t&&(x=Math.floor(n),c=x*o+i,p=x*h+d,!(n-x<5e-8));)n=1/(n-x),i=o,o=c,d=h,h=p;if(p>t&&(h>t?(p=d,c=i):(p=h,c=o)),!r)return[0,a*c,p];var v=Math.floor(a*c/p);return[v,a*c-v*p,p]}function X0(e,t,r){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),i=0,o=[],c={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(a+=1462),c.u>.9999&&(c.u=0,++n==86400&&(c.T=n=0,++a,++c.D)),a===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(a===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var d=new Date(1900,0,1);d.setDate(d.getDate()+a-1),o=[d.getFullYear(),d.getMonth()+1,d.getDate()],i=d.getDay(),a<60&&(i=(i+6)%7),r&&(i=vQ(d,o))}return c.y=o[0],c.m=o[1],c.d=o[2],c.S=n%60,n=Math.floor(n/60),c.M=n%60,n=Math.floor(n/60),c.H=n,c.q=i,c}var GP=new Date(1899,11,31,0,0,0),hQ=GP.getTime(),fQ=new Date(1900,2,1,0,0,0);function KP(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=fQ&&(r+=24*60*60*1e3),(r-(hQ+(e.getTimezoneOffset()-GP.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function k_(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function mQ(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function pQ(e){var t=e<0?12:11,r=k_(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function xQ(e){var t=k_(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function gQ(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=pQ(e):t===10?r=e.toFixed(10).substr(0,12):r=xQ(e),k_(mQ(r.toUpperCase()))}function ow(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):gQ(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Pd(14,KP(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function vQ(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function yQ(e,t,r,a){var n="",i=0,o=0,c=r.y,d,h=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:d=c%100,h=2;break;default:d=c%1e4,h=4;break}break;case 109:switch(t.length){case 1:case 2:d=r.m,h=t.length;break;case 3:return fv[r.m-1][1];case 5:return fv[r.m-1][0];default:return fv[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:d=r.d,h=t.length;break;case 3:return vE[r.q][0];default:return vE[r.q][1]}break;case 104:switch(t.length){case 1:case 2:d=1+(r.H+11)%12,h=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:d=r.H,h=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:d=r.M,h=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?el(r.S,t.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(n=el(i,2+a),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":d=r.D*24+r.H;break;case"[m]":case"[mm]":d=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":d=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}h=t.length===3?1:2;break;case 101:d=c,h=1;break}var p=h>0?el(d,h):"";return p}function yd(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var XP=/%/g;function wQ(e,t,r){var a=t.replace(XP,""),n=t.length-a.length;return fc(e,a,r*Math.pow(10,2*n))+Oa("%",n)}function bQ(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return fc(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function YP(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+YP(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,h,p){return d+h+p.substr(0,(n+i)%n)+"."+p.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var ZP=/# (\?+)( ?)\/( ?)(\d+)/;function _Q(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),i=Math.floor(n/a),o=n-i*a,c=a;return r+(i===0?"":""+i)+" "+(o===0?Oa(" ",e[1].length+1+e[4].length):A_(o,e[1].length)+e[2]+"/"+e[3]+el(c,e[4].length))}function jQ(e,t,r){return r+(t===0?"":""+t)+Oa(" ",e[1].length+2+e[4].length)}var QP=/^#*0*\.([0#]+)/,JP=/\).*[0#]/,eI=/\(###\) ###\\?-####/;function ui(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function wE(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function bE(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function NQ(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function CQ(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ho(e,t,r){if(e.charCodeAt(0)===40&&!t.match(JP)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ho("n",a,r):"("+ho("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return bQ(e,t,r);if(t.indexOf("%")!==-1)return wQ(e,t,r);if(t.indexOf("E")!==-1)return YP(t,r);if(t.charCodeAt(0)===36)return"$"+ho(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,o,c,d=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+xh(d,t.length);if(t.match(/^[#?]+$/))return n=xh(r,0),n==="0"&&(n=""),n.length>t.length?n:ui(t.substr(0,t.length-n.length))+n;if(i=t.match(ZP))return _Q(i,d,h);if(t.match(/^#+0+$/))return h+xh(d,t.length-t.indexOf("0"));if(i=t.match(QP))return n=wE(r,i[1].length).replace(/^([^\.]+)$/,"$1."+ui(i[1])).replace(/\.$/,"."+ui(i[1])).replace(/\.(\d*)$/,function(N,_){return"."+_+Oa("0",ui(i[1]).length-_.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return h+wE(d,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return h+yd(xh(d,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ho(e,t,-r):yd(""+(Math.floor(r)+NQ(r,i[1].length)))+"."+el(bE(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return ho(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Vh(ho(e,t.replace(/[\\-]/g,""),r)),o=0,Vh(Vh(t.replace(/\\/g,"")).replace(/[0#]/g,function(N){return o<n.length?n.charAt(o++):N==="0"?"0":""}));if(t.match(eI))return n=ho(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var p="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),c=rg(d,Math.pow(10,o)-1,!1),n=""+h,p=fc("n",i[1],c[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),n+=p+i[2]+"/"+i[3],p=tg(c[2],o),p.length<i[4].length&&(p=ui(i[4].substr(i[4].length-p.length))+p),n+=p,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c=rg(d,Math.pow(10,o)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?A_(c[1],o)+i[2]+"/"+i[3]+tg(c[2],o):Oa(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=xh(r,0),t.length<=n.length?n:ui(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var x=t.indexOf(".")-o,v=t.length-n.length-x;return ui(t.substr(0,x)+n+t.substr(t.length-v))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=bE(r,i[1].length),r<0?"-"+ho(e,t,-r):yd(CQ(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(N){return"00,"+(N.length<3?el(0,3-N.length):"")+N})+"."+el(o,i[1].length);switch(t){case"###,##0.00":return ho(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var b=yd(xh(d,0));return b!=="0"?h+b:"";case"###,###.00":return ho(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ho(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function EQ(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return fc(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function SQ(e,t,r){var a=t.replace(XP,""),n=t.length-a.length;return fc(e,a,r*Math.pow(10,2*n))+Oa("%",n)}function tI(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+tI(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,h,p){return d+h+p.substr(0,(n+i)%n)+"."+p.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ml(e,t,r){if(e.charCodeAt(0)===40&&!t.match(JP)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ml("n",a,r):"("+ml("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return EQ(e,t,r);if(t.indexOf("%")!==-1)return SQ(e,t,r);if(t.indexOf("E")!==-1)return tI(t,r);if(t.charCodeAt(0)===36)return"$"+ml(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,o,c,d=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+el(d,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:ui(t.substr(0,t.length-n.length))+n;if(i=t.match(ZP))return jQ(i,d,h);if(t.match(/^#+0+$/))return h+el(d,t.length-t.indexOf("0"));if(i=t.match(QP))return n=(""+r).replace(/^([^\.]+)$/,"$1."+ui(i[1])).replace(/\.$/,"."+ui(i[1])),n=n.replace(/\.(\d*)$/,function(N,_){return"."+_+Oa("0",ui(i[1]).length-_.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return h+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return h+yd(""+d);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ml(e,t,-r):yd(""+r)+"."+Oa("0",i[1].length);if(i=t.match(/^#,#*,#0/))return ml(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Vh(ml(e,t.replace(/[\\-]/g,""),r)),o=0,Vh(Vh(t.replace(/\\/g,"")).replace(/[0#]/g,function(N){return o<n.length?n.charAt(o++):N==="0"?"0":""}));if(t.match(eI))return n=ml(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var p="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),c=rg(d,Math.pow(10,o)-1,!1),n=""+h,p=fc("n",i[1],c[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),n+=p+i[2]+"/"+i[3],p=tg(c[2],o),p.length<i[4].length&&(p=ui(i[4].substr(i[4].length-p.length))+p),n+=p,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c=rg(d,Math.pow(10,o)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?A_(c[1],o)+i[2]+"/"+i[3]+tg(c[2],o):Oa(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:ui(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var x=t.indexOf(".")-o,v=t.length-n.length-x;return ui(t.substr(0,x)+n+t.substr(t.length-v))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ml(e,t,-r):yd(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(N){return"00,"+(N.length<3?el(0,3-N.length):"")+N})+"."+el(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var b=yd(""+d);return b!=="0"?h+b:"";default:if(t.match(/\.[0#?]*$/))return ml(e,t.slice(0,t.lastIndexOf(".")),r)+ui(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function fc(e,t,r){return(r|0)===r?ml(e,t,r):ho(e,t,r)}function TQ(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var sI=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function rI(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":sg(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(sI))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function AQ(e,t,r,a){for(var n=[],i="",o=0,c="",d="t",h,p,x,v="H";o<e.length;)switch(c=e.charAt(o)){case"G":if(!sg(e,o))throw new Error("unrecognized character "+c+" in "+e);n[n.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(x=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(x);n[n.length]={t:"t",v:i},++o;break;case"\\":var b=e.charAt(++o),N=b==="("||b===")"?b:"t";n[n.length]={t:N,v:b},++o;break;case"_":n[n.length]={t:"t",v:" "},o+=2;break;case"@":n[n.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(h==null&&(h=X0(t,r,e.charAt(o+1)==="2"),h==null))return"";n[n.length]={t:"X",v:e.substr(o,2)},d=c,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||h==null&&(h=X0(t,r),h==null))return"";for(i=c;++o<e.length&&e.charAt(o).toLowerCase()===c;)i+=c;c==="m"&&d.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=v),n[n.length]={t:c,v:i},d=c;break;case"A":case"a":case"":var _={t:c,v:c};if(h==null&&(h=X0(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(h!=null&&(_.v=h.H>=12?"P":"A"),_.t="T",v="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(h!=null&&(_.v=h.H>=12?"PM":"AM"),_.t="T",o+=5,v="h"):e.substr(o,5).toUpperCase()==="/"?(h!=null&&(_.v=h.H>=12?"":""),_.t="T",o+=5,v="h"):(_.t="t",++o),h==null&&_.t==="T")return"";n[n.length]=_,d=c;break;case"[":for(i=c;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(sI)){if(h==null&&(h=X0(t,r),h==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},d=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",rI(e)||(n[n.length]={t:"t",v:i}));break;case".":if(h!=null){for(i=c;++o<e.length&&(c=e.charAt(o))==="0";)i+=c;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++o<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(o))>-1;)i+=c;n[n.length]={t:"n",v:i};break;case"?":for(i=c;e.charAt(++o)===c;)i+=c;n[n.length]={t:c,v:i},d=c;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":n[n.length]={t:a===1?"t":c,v:c},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:c,v:c},++o;break;case"$":n[n.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);n[n.length]={t:"t",v:c},++o;break}var C=0,T=0,A;for(o=n.length-1,d="t";o>=0;--o)switch(n[o].t){case"h":case"H":n[o].t=v,d="h",C<1&&(C=1);break;case"s":(A=n[o].v.match(/\.0+$/))&&(T=Math.max(T,A[0].length-1)),C<3&&(C=3);case"d":case"y":case"M":case"e":d=n[o].t;break;case"m":d==="s"&&(n[o].t="M",C<2&&(C=2));break;case"X":break;case"Z":C<1&&n[o].v.match(/[Hh]/)&&(C=1),C<2&&n[o].v.match(/[Mm]/)&&(C=2),C<3&&n[o].v.match(/[Ss]/)&&(C=3)}switch(C){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var k="",I;for(o=0;o<n.length;++o)switch(n[o].t){case"t":case"T":case" ":case"D":break;case"X":n[o].v="",n[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[o].v=yQ(n[o].t.charCodeAt(0),n[o].v,h,T),n[o].t="t";break;case"n":case"?":for(I=o+1;n[I]!=null&&((c=n[I].t)==="?"||c==="D"||(c===" "||c==="t")&&n[I+1]!=null&&(n[I+1].t==="?"||n[I+1].t==="t"&&n[I+1].v==="/")||n[o].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(n[I].v==="/"||n[I].v===" "&&n[I+1]!=null&&n[I+1].t=="?"));)n[o].v+=n[I].v,n[I]={v:"",t:";"},++I;k+=n[o].v,o=I-1;break;case"G":n[o].t="t",n[o].v=ow(t,r);break}var B="",O,D;if(k.length>0){k.charCodeAt(0)==40?(O=t<0&&k.charCodeAt(0)===45?-t:t,D=fc("n",k,O)):(O=t<0&&a>1?-t:t,D=fc("n",k,O),O<0&&n[0]&&n[0].t=="t"&&(D=D.substr(1),n[0].v="-"+n[0].v)),I=D.length-1;var F=n.length;for(o=0;o<n.length;++o)if(n[o]!=null&&n[o].t!="t"&&n[o].v.indexOf(".")>-1){F=o;break}var M=n.length;if(F===n.length&&D.indexOf("E")===-1){for(o=n.length-1;o>=0;--o)n[o]==null||"n?".indexOf(n[o].t)===-1||(I>=n[o].v.length-1?(I-=n[o].v.length,n[o].v=D.substr(I+1,n[o].v.length)):I<0?n[o].v="":(n[o].v=D.substr(0,I+1),I=-1),n[o].t="t",M=o);I>=0&&M<n.length&&(n[M].v=D.substr(0,I+1)+n[M].v)}else if(F!==n.length&&D.indexOf("E")===-1){for(I=D.indexOf(".")-1,o=F;o>=0;--o)if(!(n[o]==null||"n?".indexOf(n[o].t)===-1)){for(p=n[o].v.indexOf(".")>-1&&o===F?n[o].v.indexOf(".")-1:n[o].v.length-1,B=n[o].v.substr(p+1);p>=0;--p)I>=0&&(n[o].v.charAt(p)==="0"||n[o].v.charAt(p)==="#")&&(B=D.charAt(I--)+B);n[o].v=B,n[o].t="t",M=o}for(I>=0&&M<n.length&&(n[M].v=D.substr(0,I+1)+n[M].v),I=D.indexOf(".")+1,o=F;o<n.length;++o)if(!(n[o]==null||"n?(".indexOf(n[o].t)===-1&&o!==F)){for(p=n[o].v.indexOf(".")>-1&&o===F?n[o].v.indexOf(".")+1:0,B=n[o].v.substr(0,p);p<n[o].v.length;++p)I<D.length&&(B+=D.charAt(I++));n[o].v=B,n[o].t="t",M=o}}}for(o=0;o<n.length;++o)n[o]!=null&&"n?".indexOf(n[o].t)>-1&&(O=a>1&&t<0&&o>0&&n[o-1].v==="-"?-t:t,n[o].v=fc(n[o].t,n[o].v,O),n[o].t="t");var z="";for(o=0;o!==n.length;++o)n[o]!=null&&(z+=n[o].v);return z}var _E=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function jE(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function kQ(e,t){var r=TQ(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(_E),c=r[1].match(_E);return jE(t,o)?[a,r[0]]:jE(t,c)?[a,r[1]]:[a,r[o!=null&&c!=null?2:1]]}return[a,i]}function Pd(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:Ma)[e],a==null&&(a=r.table&&r.table[yE[e]]||Ma[yE[e]]),a==null&&(a=uQ[e]||"General");break}if(sg(a,0))return ow(t,r);t instanceof Date&&(t=KP(t,r.date1904));var n=kQ(a,t);if(sg(n[1]))return ow(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return AQ(n[1],t,r,n[0])}function aI(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ma[r]==null){t<0&&(t=r);continue}if(Ma[r]==e){t=r;break}}t<0&&(t=391)}return Ma[t]=e,t}function Zg(e){for(var t=0;t!=392;++t)e[t]!==void 0&&aI(e[t],t)}function Qg(){Ma=dQ()}var nI=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function RQ(e){var t=typeof e=="number"?Ma[e]:e;return t=t.replace(nI,"(\\d+)"),new RegExp("^"+t+"$")}function PQ(e,t,r){var a=-1,n=-1,i=-1,o=-1,c=-1,d=-1;(t.match(nI)||[]).forEach(function(x,v){var b=parseInt(r[v+1],10);switch(x.toLowerCase().charAt(0)){case"y":a=b;break;case"d":i=b;break;case"h":o=b;break;case"s":d=b;break;case"m":o>=0?c=b:n=b;break}}),d>=0&&c==-1&&n>=0&&(c=n,n=-1);var h=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var p=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return o==-1&&c==-1&&d==-1?h:a==-1&&n==-1&&i==-1?p:h+"T"+p}var IQ=function(){var e={};e.version="1.2.0";function t(){for(var D=0,F=new Array(256),M=0;M!=256;++M)D=M,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,F[M]=D;return typeof Int32Array<"u"?new Int32Array(F):F}var r=t();function a(D){var F=0,M=0,z=0,q=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(z=0;z!=256;++z)q[z]=D[z];for(z=0;z!=256;++z)for(M=D[z],F=256+z;F<4096;F+=256)M=q[F]=M>>>8^D[M&255];var Y=[];for(z=1;z!=16;++z)Y[z-1]=typeof Int32Array<"u"?q.subarray(z*256,z*256+256):q.slice(z*256,z*256+256);return Y}var n=a(r),i=n[0],o=n[1],c=n[2],d=n[3],h=n[4],p=n[5],x=n[6],v=n[7],b=n[8],N=n[9],_=n[10],C=n[11],T=n[12],A=n[13],k=n[14];function I(D,F){for(var M=F^-1,z=0,q=D.length;z<q;)M=M>>>8^r[(M^D.charCodeAt(z++))&255];return~M}function B(D,F){for(var M=F^-1,z=D.length-15,q=0;q<z;)M=k[D[q++]^M&255]^A[D[q++]^M>>8&255]^T[D[q++]^M>>16&255]^C[D[q++]^M>>>24]^_[D[q++]]^N[D[q++]]^b[D[q++]]^v[D[q++]]^x[D[q++]]^p[D[q++]]^h[D[q++]]^d[D[q++]]^c[D[q++]]^o[D[q++]]^i[D[q++]]^r[D[q++]];for(z+=15;q<z;)M=M>>>8^r[(M^D[q++])&255];return~M}function O(D,F){for(var M=F^-1,z=0,q=D.length,Y=0,ae=0;z<q;)Y=D.charCodeAt(z++),Y<128?M=M>>>8^r[(M^Y)&255]:Y<2048?(M=M>>>8^r[(M^(192|Y>>6&31))&255],M=M>>>8^r[(M^(128|Y&63))&255]):Y>=55296&&Y<57344?(Y=(Y&1023)+64,ae=D.charCodeAt(z++)&1023,M=M>>>8^r[(M^(240|Y>>8&7))&255],M=M>>>8^r[(M^(128|Y>>2&63))&255],M=M>>>8^r[(M^(128|ae>>6&15|(Y&3)<<4))&255],M=M>>>8^r[(M^(128|ae&63))&255]):(M=M>>>8^r[(M^(224|Y>>12&15))&255],M=M>>>8^r[(M^(128|Y>>6&63))&255],M=M>>>8^r[(M^(128|Y&63))&255]);return~M}return e.table=r,e.bstr=I,e.buf=B,e.str=O,e}(),Qr=function(){var t={};t.version="1.2.1";function r(de,pe){for(var ge=de.split("/"),be=pe.split("/"),Te=0,Pe=0,nt=Math.min(ge.length,be.length);Te<nt;++Te){if(Pe=ge[Te].length-be[Te].length)return Pe;if(ge[Te]!=be[Te])return ge[Te]<be[Te]?-1:1}return ge.length-be.length}function a(de){if(de.charAt(de.length-1)=="/")return de.slice(0,-1).indexOf("/")===-1?de:a(de.slice(0,-1));var pe=de.lastIndexOf("/");return pe===-1?de:de.slice(0,pe+1)}function n(de){if(de.charAt(de.length-1)=="/")return n(de.slice(0,-1));var pe=de.lastIndexOf("/");return pe===-1?de:de.slice(pe+1)}function i(de,pe){typeof pe=="string"&&(pe=new Date(pe));var ge=pe.getHours();ge=ge<<6|pe.getMinutes(),ge=ge<<5|pe.getSeconds()>>>1,de.write_shift(2,ge);var be=pe.getFullYear()-1980;be=be<<4|pe.getMonth()+1,be=be<<5|pe.getDate(),de.write_shift(2,be)}function o(de){var pe=de.read_shift(2)&65535,ge=de.read_shift(2)&65535,be=new Date,Te=ge&31;ge>>>=5;var Pe=ge&15;ge>>>=4,be.setMilliseconds(0),be.setFullYear(ge+1980),be.setMonth(Pe-1),be.setDate(Te);var nt=pe&31;pe>>>=5;var vt=pe&63;return pe>>>=6,be.setHours(pe),be.setMinutes(vt),be.setSeconds(nt<<1),be}function c(de){$i(de,0);for(var pe={},ge=0;de.l<=de.length-4;){var be=de.read_shift(2),Te=de.read_shift(2),Pe=de.l+Te,nt={};switch(be){case 21589:ge=de.read_shift(1),ge&1&&(nt.mtime=de.read_shift(4)),Te>5&&(ge&2&&(nt.atime=de.read_shift(4)),ge&4&&(nt.ctime=de.read_shift(4))),nt.mtime&&(nt.mt=new Date(nt.mtime*1e3));break}de.l=Pe,pe[be]=nt}return pe}var d;function h(){return d||(d={})}function p(de,pe){if(de[0]==80&&de[1]==75)return Jt(de,pe);if((de[0]|32)==109&&(de[1]|32)==105)return Bs(de,pe);if(de.length<512)throw new Error("CFB file size "+de.length+" < 512");var ge=3,be=512,Te=0,Pe=0,nt=0,vt=0,tt=0,lt=[],ut=de.slice(0,512);$i(ut,0);var kt=x(ut);switch(ge=kt[0],ge){case 3:be=512;break;case 4:be=4096;break;case 0:if(kt[1]==0)return Jt(de,pe);default:throw new Error("Major Version: Expected 3 or 4 saw "+ge)}be!==512&&(ut=de.slice(0,be),$i(ut,28));var Ot=de.slice(0,be);v(ut,ge);var Ft=ut.read_shift(4,"i");if(ge===3&&Ft!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ft);ut.l+=4,nt=ut.read_shift(4,"i"),ut.l+=4,ut.chk("00100000","Mini Stream Cutoff Size: "),vt=ut.read_shift(4,"i"),Te=ut.read_shift(4,"i"),tt=ut.read_shift(4,"i"),Pe=ut.read_shift(4,"i");for(var Mt=-1,Xt=0;Xt<109&&(Mt=ut.read_shift(4,"i"),!(Mt<0));++Xt)lt[Xt]=Mt;var Ds=b(de,be);C(tt,Pe,Ds,be,lt);var gt=A(Ds,nt,lt,be);gt[nt].name="!Directory",Te>0&&vt!==ae&&(gt[vt].name="!MiniFAT"),gt[lt[0]].name="!FAT",gt.fat_addrs=lt,gt.ssz=be;var ea={},or=[],Ln=[],Mi=[];k(nt,gt,Ds,or,Te,ea,Ln,vt),N(Ln,Mi,or),or.shift();var fr={FileIndex:Ln,FullPaths:Mi};return pe&&pe.raw&&(fr.raw={header:Ot,sectors:Ds}),fr}function x(de){if(de[de.l]==80&&de[de.l+1]==75)return[0,0];de.chk(je,"Header Signature: "),de.l+=16;var pe=de.read_shift(2,"u");return[de.read_shift(2,"u"),pe]}function v(de,pe){var ge=9;switch(de.l+=2,ge=de.read_shift(2)){case 9:if(pe!=3)throw new Error("Sector Shift: Expected 9 saw "+ge);break;case 12:if(pe!=4)throw new Error("Sector Shift: Expected 12 saw "+ge);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ge)}de.chk("0600","Mini Sector Shift: "),de.chk("000000000000","Reserved: ")}function b(de,pe){for(var ge=Math.ceil(de.length/pe)-1,be=[],Te=1;Te<ge;++Te)be[Te-1]=de.slice(Te*pe,(Te+1)*pe);return be[ge-1]=de.slice(ge*pe),be}function N(de,pe,ge){for(var be=0,Te=0,Pe=0,nt=0,vt=0,tt=ge.length,lt=[],ut=[];be<tt;++be)lt[be]=ut[be]=be,pe[be]=ge[be];for(;vt<ut.length;++vt)be=ut[vt],Te=de[be].L,Pe=de[be].R,nt=de[be].C,lt[be]===be&&(Te!==-1&&lt[Te]!==Te&&(lt[be]=lt[Te]),Pe!==-1&&lt[Pe]!==Pe&&(lt[be]=lt[Pe])),nt!==-1&&(lt[nt]=be),Te!==-1&&be!=lt[be]&&(lt[Te]=lt[be],ut.lastIndexOf(Te)<vt&&ut.push(Te)),Pe!==-1&&be!=lt[be]&&(lt[Pe]=lt[be],ut.lastIndexOf(Pe)<vt&&ut.push(Pe));for(be=1;be<tt;++be)lt[be]===be&&(Pe!==-1&&lt[Pe]!==Pe?lt[be]=lt[Pe]:Te!==-1&&lt[Te]!==Te&&(lt[be]=lt[Te]));for(be=1;be<tt;++be)if(de[be].type!==0){if(vt=be,vt!=lt[vt])do vt=lt[vt],pe[be]=pe[vt]+"/"+pe[be];while(vt!==0&&lt[vt]!==-1&&vt!=lt[vt]);lt[be]=-1}for(pe[0]+="/",be=1;be<tt;++be)de[be].type!==2&&(pe[be]+="/")}function _(de,pe,ge){for(var be=de.start,Te=de.size,Pe=[],nt=be;ge&&Te>0&&nt>=0;)Pe.push(pe.slice(nt*Y,nt*Y+Y)),Te-=Y,nt=ou(ge,nt*4);return Pe.length===0?yt(0):Rn(Pe).slice(0,de.size)}function C(de,pe,ge,be,Te){var Pe=ae;if(de===ae){if(pe!==0)throw new Error("DIFAT chain shorter than expected")}else if(de!==-1){var nt=ge[de],vt=(be>>>2)-1;if(!nt)return;for(var tt=0;tt<vt&&(Pe=ou(nt,tt*4))!==ae;++tt)Te.push(Pe);C(ou(nt,be-4),pe-1,ge,be,Te)}}function T(de,pe,ge,be,Te){var Pe=[],nt=[];Te||(Te=[]);var vt=be-1,tt=0,lt=0;for(tt=pe;tt>=0;){Te[tt]=!0,Pe[Pe.length]=tt,nt.push(de[tt]);var ut=ge[Math.floor(tt*4/be)];if(lt=tt*4&vt,be<4+lt)throw new Error("FAT boundary crossed: "+tt+" 4 "+be);if(!de[ut])break;tt=ou(de[ut],lt)}return{nodes:Pe,data:RE([nt])}}function A(de,pe,ge,be){var Te=de.length,Pe=[],nt=[],vt=[],tt=[],lt=be-1,ut=0,kt=0,Ot=0,Ft=0;for(ut=0;ut<Te;++ut)if(vt=[],Ot=ut+pe,Ot>=Te&&(Ot-=Te),!nt[Ot]){tt=[];var Mt=[];for(kt=Ot;kt>=0;){Mt[kt]=!0,nt[kt]=!0,vt[vt.length]=kt,tt.push(de[kt]);var Xt=ge[Math.floor(kt*4/be)];if(Ft=kt*4&lt,be<4+Ft)throw new Error("FAT boundary crossed: "+kt+" 4 "+be);if(!de[Xt]||(kt=ou(de[Xt],Ft),Mt[kt]))break}Pe[Ot]={nodes:vt,data:RE([tt])}}return Pe}function k(de,pe,ge,be,Te,Pe,nt,vt){for(var tt=0,lt=be.length?2:0,ut=pe[de].data,kt=0,Ot=0,Ft;kt<ut.length;kt+=128){var Mt=ut.slice(kt,kt+128);$i(Mt,64),Ot=Mt.read_shift(2),Ft=D_(Mt,0,Ot-lt),be.push(Ft);var Xt={name:Ft,type:Mt.read_shift(1),color:Mt.read_shift(1),L:Mt.read_shift(4,"i"),R:Mt.read_shift(4,"i"),C:Mt.read_shift(4,"i"),clsid:Mt.read_shift(16),state:Mt.read_shift(4,"i"),start:0,size:0},Ds=Mt.read_shift(2)+Mt.read_shift(2)+Mt.read_shift(2)+Mt.read_shift(2);Ds!==0&&(Xt.ct=I(Mt,Mt.l-8));var gt=Mt.read_shift(2)+Mt.read_shift(2)+Mt.read_shift(2)+Mt.read_shift(2);gt!==0&&(Xt.mt=I(Mt,Mt.l-8)),Xt.start=Mt.read_shift(4,"i"),Xt.size=Mt.read_shift(4,"i"),Xt.size<0&&Xt.start<0&&(Xt.size=Xt.type=0,Xt.start=ae,Xt.name=""),Xt.type===5?(tt=Xt.start,Te>0&&tt!==ae&&(pe[tt].name="!StreamData")):Xt.size>=4096?(Xt.storage="fat",pe[Xt.start]===void 0&&(pe[Xt.start]=T(ge,Xt.start,pe.fat_addrs,pe.ssz)),pe[Xt.start].name=Xt.name,Xt.content=pe[Xt.start].data.slice(0,Xt.size)):(Xt.storage="minifat",Xt.size<0?Xt.size=0:tt!==ae&&Xt.start!==ae&&pe[tt]&&(Xt.content=_(Xt,pe[tt].data,(pe[vt]||{}).data))),Xt.content&&$i(Xt.content,0),Pe[Ft]=Xt,nt.push(Xt)}}function I(de,pe){return new Date((Hi(de,pe+4)/1e7*Math.pow(2,32)+Hi(de,pe)/1e7-11644473600)*1e3)}function B(de,pe){return h(),p(d.readFileSync(de),pe)}function O(de,pe){var ge=pe&&pe.type;switch(ge||Dr&&Buffer.isBuffer(de)&&(ge="buffer"),ge||"base64"){case"file":return B(de,pe);case"base64":return p(Qo(bc(de)),pe);case"binary":return p(Qo(de),pe)}return p(de,pe)}function D(de,pe){var ge=pe||{},be=ge.root||"Root Entry";if(de.FullPaths||(de.FullPaths=[]),de.FileIndex||(de.FileIndex=[]),de.FullPaths.length!==de.FileIndex.length)throw new Error("inconsistent CFB structure");de.FullPaths.length===0&&(de.FullPaths[0]=be+"/",de.FileIndex[0]={name:be,type:5}),ge.CLSID&&(de.FileIndex[0].clsid=ge.CLSID),F(de)}function F(de){var pe="Sh33tJ5";if(!Qr.find(de,"/"+pe)){var ge=yt(4);ge[0]=55,ge[1]=ge[3]=50,ge[2]=54,de.FileIndex.push({name:pe,type:2,content:ge,size:4,L:69,R:69,C:69}),de.FullPaths.push(de.FullPaths[0]+pe),M(de)}}function M(de,pe){D(de);for(var ge=!1,be=!1,Te=de.FullPaths.length-1;Te>=0;--Te){var Pe=de.FileIndex[Te];switch(Pe.type){case 0:be?ge=!0:(de.FileIndex.pop(),de.FullPaths.pop());break;case 1:case 2:case 5:be=!0,isNaN(Pe.R*Pe.L*Pe.C)&&(ge=!0),Pe.R>-1&&Pe.L>-1&&Pe.R==Pe.L&&(ge=!0);break;default:ge=!0;break}}if(!(!ge&&!pe)){var nt=new Date(1987,1,19),vt=0,tt=Object.create?Object.create(null):{},lt=[];for(Te=0;Te<de.FullPaths.length;++Te)tt[de.FullPaths[Te]]=!0,de.FileIndex[Te].type!==0&&lt.push([de.FullPaths[Te],de.FileIndex[Te]]);for(Te=0;Te<lt.length;++Te){var ut=a(lt[Te][0]);be=tt[ut],be||(lt.push([ut,{name:n(ut).replace("/",""),type:1,clsid:Z,ct:nt,mt:nt,content:null}]),tt[ut]=!0)}for(lt.sort(function(Ft,Mt){return r(Ft[0],Mt[0])}),de.FullPaths=[],de.FileIndex=[],Te=0;Te<lt.length;++Te)de.FullPaths[Te]=lt[Te][0],de.FileIndex[Te]=lt[Te][1];for(Te=0;Te<lt.length;++Te){var kt=de.FileIndex[Te],Ot=de.FullPaths[Te];if(kt.name=n(Ot).replace("/",""),kt.L=kt.R=kt.C=-(kt.color=1),kt.size=kt.content?kt.content.length:0,kt.start=0,kt.clsid=kt.clsid||Z,Te===0)kt.C=lt.length>1?1:-1,kt.size=0,kt.type=5;else if(Ot.slice(-1)=="/"){for(vt=Te+1;vt<lt.length&&a(de.FullPaths[vt])!=Ot;++vt);for(kt.C=vt>=lt.length?-1:vt,vt=Te+1;vt<lt.length&&a(de.FullPaths[vt])!=a(Ot);++vt);kt.R=vt>=lt.length?-1:vt,kt.type=1}else a(de.FullPaths[Te+1]||"")==a(Ot)&&(kt.R=Te+1),kt.type=2}}}function z(de,pe){var ge=pe||{};if(ge.fileType=="mad")return js(de,ge);switch(M(de),ge.fileType){case"zip":return Xe(de,ge)}var be=function(Ft){for(var Mt=0,Xt=0,Ds=0;Ds<Ft.FileIndex.length;++Ds){var gt=Ft.FileIndex[Ds];if(gt.content){var ea=gt.content.length;ea>0&&(ea<4096?Mt+=ea+63>>6:Xt+=ea+511>>9)}}for(var or=Ft.FullPaths.length+3>>2,Ln=Mt+7>>3,Mi=Mt+127>>7,fr=Ln+Xt+or+Mi,rr=fr+127>>7,Ks=rr<=109?0:Math.ceil((rr-109)/127);fr+rr+Ks+127>>7>rr;)Ks=++rr<=109?0:Math.ceil((rr-109)/127);var Hs=[1,Ks,rr,Mi,or,Xt,Mt,0];return Ft.FileIndex[0].size=Mt<<6,Hs[7]=(Ft.FileIndex[0].start=Hs[0]+Hs[1]+Hs[2]+Hs[3]+Hs[4]+Hs[5])+(Hs[6]+7>>3),Hs}(de),Te=yt(be[7]<<9),Pe=0,nt=0;{for(Pe=0;Pe<8;++Pe)Te.write_shift(1,H[Pe]);for(Pe=0;Pe<8;++Pe)Te.write_shift(2,0);for(Te.write_shift(2,62),Te.write_shift(2,3),Te.write_shift(2,65534),Te.write_shift(2,9),Te.write_shift(2,6),Pe=0;Pe<3;++Pe)Te.write_shift(2,0);for(Te.write_shift(4,0),Te.write_shift(4,be[2]),Te.write_shift(4,be[0]+be[1]+be[2]+be[3]-1),Te.write_shift(4,0),Te.write_shift(4,4096),Te.write_shift(4,be[3]?be[0]+be[1]+be[2]-1:ae),Te.write_shift(4,be[3]),Te.write_shift(-4,be[1]?be[0]-1:ae),Te.write_shift(4,be[1]),Pe=0;Pe<109;++Pe)Te.write_shift(-4,Pe<be[2]?be[1]+Pe:-1)}if(be[1])for(nt=0;nt<be[1];++nt){for(;Pe<236+nt*127;++Pe)Te.write_shift(-4,Pe<be[2]?be[1]+Pe:-1);Te.write_shift(-4,nt===be[1]-1?ae:nt+1)}var vt=function(Ft){for(nt+=Ft;Pe<nt-1;++Pe)Te.write_shift(-4,Pe+1);Ft&&(++Pe,Te.write_shift(-4,ae))};for(nt=Pe=0,nt+=be[1];Pe<nt;++Pe)Te.write_shift(-4,G.DIFSECT);for(nt+=be[2];Pe<nt;++Pe)Te.write_shift(-4,G.FATSECT);vt(be[3]),vt(be[4]);for(var tt=0,lt=0,ut=de.FileIndex[0];tt<de.FileIndex.length;++tt)ut=de.FileIndex[tt],ut.content&&(lt=ut.content.length,!(lt<4096)&&(ut.start=nt,vt(lt+511>>9)));for(vt(be[6]+7>>3);Te.l&511;)Te.write_shift(-4,G.ENDOFCHAIN);for(nt=Pe=0,tt=0;tt<de.FileIndex.length;++tt)ut=de.FileIndex[tt],ut.content&&(lt=ut.content.length,!(!lt||lt>=4096)&&(ut.start=nt,vt(lt+63>>6)));for(;Te.l&511;)Te.write_shift(-4,G.ENDOFCHAIN);for(Pe=0;Pe<be[4]<<2;++Pe){var kt=de.FullPaths[Pe];if(!kt||kt.length===0){for(tt=0;tt<17;++tt)Te.write_shift(4,0);for(tt=0;tt<3;++tt)Te.write_shift(4,-1);for(tt=0;tt<12;++tt)Te.write_shift(4,0);continue}ut=de.FileIndex[Pe],Pe===0&&(ut.start=ut.size?ut.start-1:ae);var Ot=Pe===0&&ge.root||ut.name;if(lt=2*(Ot.length+1),Te.write_shift(64,Ot,"utf16le"),Te.write_shift(2,lt),Te.write_shift(1,ut.type),Te.write_shift(1,ut.color),Te.write_shift(-4,ut.L),Te.write_shift(-4,ut.R),Te.write_shift(-4,ut.C),ut.clsid)Te.write_shift(16,ut.clsid,"hex");else for(tt=0;tt<4;++tt)Te.write_shift(4,0);Te.write_shift(4,ut.state||0),Te.write_shift(4,0),Te.write_shift(4,0),Te.write_shift(4,0),Te.write_shift(4,0),Te.write_shift(4,ut.start),Te.write_shift(4,ut.size),Te.write_shift(4,0)}for(Pe=1;Pe<de.FileIndex.length;++Pe)if(ut=de.FileIndex[Pe],ut.size>=4096)if(Te.l=ut.start+1<<9,Dr&&Buffer.isBuffer(ut.content))ut.content.copy(Te,Te.l,0,ut.size),Te.l+=ut.size+511&-512;else{for(tt=0;tt<ut.size;++tt)Te.write_shift(1,ut.content[tt]);for(;tt&511;++tt)Te.write_shift(1,0)}for(Pe=1;Pe<de.FileIndex.length;++Pe)if(ut=de.FileIndex[Pe],ut.size>0&&ut.size<4096)if(Dr&&Buffer.isBuffer(ut.content))ut.content.copy(Te,Te.l,0,ut.size),Te.l+=ut.size+63&-64;else{for(tt=0;tt<ut.size;++tt)Te.write_shift(1,ut.content[tt]);for(;tt&63;++tt)Te.write_shift(1,0)}if(Dr)Te.l=Te.length;else for(;Te.l<Te.length;)Te.write_shift(1,0);return Te}function q(de,pe){var ge=de.FullPaths.map(function(tt){return tt.toUpperCase()}),be=ge.map(function(tt){var lt=tt.split("/");return lt[lt.length-(tt.slice(-1)=="/"?2:1)]}),Te=!1;pe.charCodeAt(0)===47?(Te=!0,pe=ge[0].slice(0,-1)+pe):Te=pe.indexOf("/")!==-1;var Pe=pe.toUpperCase(),nt=Te===!0?ge.indexOf(Pe):be.indexOf(Pe);if(nt!==-1)return de.FileIndex[nt];var vt=!Pe.match(K0);for(Pe=Pe.replace(Gm,""),vt&&(Pe=Pe.replace(K0,"!")),nt=0;nt<ge.length;++nt)if((vt?ge[nt].replace(K0,"!"):ge[nt]).replace(Gm,"")==Pe||(vt?be[nt].replace(K0,"!"):be[nt]).replace(Gm,"")==Pe)return de.FileIndex[nt];return null}var Y=64,ae=-2,je="d0cf11e0a1b11ae1",H=[208,207,17,224,161,177,26,225],Z="00000000000000000000000000000000",G={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ae,FREESECT:-1,HEADER_SIGNATURE:je,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Q(de,pe,ge){h();var be=z(de,ge);d.writeFileSync(pe,be)}function re(de){for(var pe=new Array(de.length),ge=0;ge<de.length;++ge)pe[ge]=String.fromCharCode(de[ge]);return pe.join("")}function le(de,pe){var ge=z(de,pe);switch(pe&&pe.type||"buffer"){case"file":return h(),d.writeFileSync(pe.filename,ge),ge;case"binary":return typeof ge=="string"?ge:re(ge);case"base64":return Ip(typeof ge=="string"?ge:re(ge));case"buffer":if(Dr)return Buffer.isBuffer(ge)?ge:Ec(ge);case"array":return typeof ge=="string"?Qo(ge):ge}return ge}var ye;function W(de){try{var pe=de.InflateRaw,ge=new pe;if(ge._processChunk(new Uint8Array([3,0]),ge._finishFlushFlag),ge.bytesRead)ye=de;else throw new Error("zlib does not expose bytesRead")}catch(be){console.error("cannot use native zlib: "+(be.message||be))}}function ee(de,pe){if(!ye)return bt(de,pe);var ge=ye.InflateRaw,be=new ge,Te=be._processChunk(de.slice(de.l),be._finishFlushFlag);return de.l+=be.bytesRead,Te}function ie(de){return ye?ye.deflateRawSync(de):us(de)}var ce=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],xe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ce=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function me(de){var pe=(de<<1|de<<11)&139536|(de<<5|de<<15)&558144;return(pe>>16|pe>>8|pe)&255}for(var fe=typeof Uint8Array<"u",ve=fe?new Uint8Array(256):[],ne=0;ne<256;++ne)ve[ne]=me(ne);function Me(de,pe){var ge=ve[de&255];return pe<=8?ge>>>8-pe:(ge=ge<<8|ve[de>>8&255],pe<=16?ge>>>16-pe:(ge=ge<<8|ve[de>>16&255],ge>>>24-pe))}function Ie(de,pe){var ge=pe&7,be=pe>>>3;return(de[be]|(ge<=6?0:de[be+1]<<8))>>>ge&3}function Be(de,pe){var ge=pe&7,be=pe>>>3;return(de[be]|(ge<=5?0:de[be+1]<<8))>>>ge&7}function ot(de,pe){var ge=pe&7,be=pe>>>3;return(de[be]|(ge<=4?0:de[be+1]<<8))>>>ge&15}function Se(de,pe){var ge=pe&7,be=pe>>>3;return(de[be]|(ge<=3?0:de[be+1]<<8))>>>ge&31}function ze(de,pe){var ge=pe&7,be=pe>>>3;return(de[be]|(ge<=1?0:de[be+1]<<8))>>>ge&127}function we(de,pe,ge){var be=pe&7,Te=pe>>>3,Pe=(1<<ge)-1,nt=de[Te]>>>be;return ge<8-be||(nt|=de[Te+1]<<8-be,ge<16-be)||(nt|=de[Te+2]<<16-be,ge<24-be)||(nt|=de[Te+3]<<24-be),nt&Pe}function Le(de,pe,ge){var be=pe&7,Te=pe>>>3;return be<=5?de[Te]|=(ge&7)<<be:(de[Te]|=ge<<be&255,de[Te+1]=(ge&7)>>8-be),pe+3}function Nt(de,pe,ge){var be=pe&7,Te=pe>>>3;return ge=(ge&1)<<be,de[Te]|=ge,pe+1}function Ge(de,pe,ge){var be=pe&7,Te=pe>>>3;return ge<<=be,de[Te]|=ge&255,ge>>>=8,de[Te+1]=ge,pe+8}function Lt(de,pe,ge){var be=pe&7,Te=pe>>>3;return ge<<=be,de[Te]|=ge&255,ge>>>=8,de[Te+1]=ge&255,de[Te+2]=ge>>>8,pe+16}function ps(de,pe){var ge=de.length,be=2*ge>pe?2*ge:pe+5,Te=0;if(ge>=pe)return de;if(Dr){var Pe=xE(be);if(de.copy)de.copy(Pe);else for(;Te<de.length;++Te)Pe[Te]=de[Te];return Pe}else if(fe){var nt=new Uint8Array(be);if(nt.set)nt.set(de);else for(;Te<ge;++Te)nt[Te]=de[Te];return nt}return de.length=be,de}function ns(de){for(var pe=new Array(de),ge=0;ge<de;++ge)pe[ge]=0;return pe}function Ke(de,pe,ge){var be=1,Te=0,Pe=0,nt=0,vt=0,tt=de.length,lt=fe?new Uint16Array(32):ns(32);for(Pe=0;Pe<32;++Pe)lt[Pe]=0;for(Pe=tt;Pe<ge;++Pe)de[Pe]=0;tt=de.length;var ut=fe?new Uint16Array(tt):ns(tt);for(Pe=0;Pe<tt;++Pe)lt[Te=de[Pe]]++,be<Te&&(be=Te),ut[Pe]=0;for(lt[0]=0,Pe=1;Pe<=be;++Pe)lt[Pe+16]=vt=vt+lt[Pe-1]<<1;for(Pe=0;Pe<tt;++Pe)vt=de[Pe],vt!=0&&(ut[Pe]=lt[vt+16]++);var kt=0;for(Pe=0;Pe<tt;++Pe)if(kt=de[Pe],kt!=0)for(vt=Me(ut[Pe],be)>>be-kt,nt=(1<<be+4-kt)-1;nt>=0;--nt)pe[vt|nt<<kt]=kt&15|Pe<<4;return be}var dt=fe?new Uint16Array(512):ns(512),It=fe?new Uint16Array(32):ns(32);if(!fe){for(var Ut=0;Ut<512;++Ut)dt[Ut]=0;for(Ut=0;Ut<32;++Ut)It[Ut]=0}(function(){for(var de=[],pe=0;pe<32;pe++)de.push(5);Ke(de,It,32);var ge=[];for(pe=0;pe<=143;pe++)ge.push(8);for(;pe<=255;pe++)ge.push(9);for(;pe<=279;pe++)ge.push(7);for(;pe<=287;pe++)ge.push(8);Ke(ge,dt,288)})();var ts=function(){for(var pe=fe?new Uint8Array(32768):[],ge=0,be=0;ge<Ce.length-1;++ge)for(;be<Ce[ge+1];++be)pe[be]=ge;for(;be<32768;++be)pe[be]=29;var Te=fe?new Uint8Array(259):[];for(ge=0,be=0;ge<xe.length-1;++ge)for(;be<xe[ge+1];++be)Te[be]=ge;function Pe(vt,tt){for(var lt=0;lt<vt.length;){var ut=Math.min(65535,vt.length-lt),kt=lt+ut==vt.length;for(tt.write_shift(1,+kt),tt.write_shift(2,ut),tt.write_shift(2,~ut&65535);ut-- >0;)tt[tt.l++]=vt[lt++]}return tt.l}function nt(vt,tt){for(var lt=0,ut=0,kt=fe?new Uint16Array(32768):[];ut<vt.length;){var Ot=Math.min(65535,vt.length-ut);if(Ot<10){for(lt=Le(tt,lt,+(ut+Ot==vt.length)),lt&7&&(lt+=8-(lt&7)),tt.l=lt/8|0,tt.write_shift(2,Ot),tt.write_shift(2,~Ot&65535);Ot-- >0;)tt[tt.l++]=vt[ut++];lt=tt.l*8;continue}lt=Le(tt,lt,+(ut+Ot==vt.length)+2);for(var Ft=0;Ot-- >0;){var Mt=vt[ut];Ft=(Ft<<5^Mt)&32767;var Xt=-1,Ds=0;if((Xt=kt[Ft])&&(Xt|=ut&-32768,Xt>ut&&(Xt-=32768),Xt<ut))for(;vt[Xt+Ds]==vt[ut+Ds]&&Ds<250;)++Ds;if(Ds>2){Mt=Te[Ds],Mt<=22?lt=Ge(tt,lt,ve[Mt+1]>>1)-1:(Ge(tt,lt,3),lt+=5,Ge(tt,lt,ve[Mt-23]>>5),lt+=3);var gt=Mt<8?0:Mt-4>>2;gt>0&&(Lt(tt,lt,Ds-xe[Mt]),lt+=gt),Mt=pe[ut-Xt],lt=Ge(tt,lt,ve[Mt]>>3),lt-=3;var ea=Mt<4?0:Mt-2>>1;ea>0&&(Lt(tt,lt,ut-Xt-Ce[Mt]),lt+=ea);for(var or=0;or<Ds;++or)kt[Ft]=ut&32767,Ft=(Ft<<5^vt[ut])&32767,++ut;Ot-=Ds-1}else Mt<=143?Mt=Mt+48:lt=Nt(tt,lt,1),lt=Ge(tt,lt,ve[Mt]),kt[Ft]=ut&32767,++ut}lt=Ge(tt,lt,0)-1}return tt.l=(lt+7)/8|0,tt.l}return function(tt,lt){return tt.length<8?Pe(tt,lt):nt(tt,lt)}}();function us(de){var pe=yt(50+Math.floor(de.length*1.1)),ge=ts(de,pe);return pe.slice(0,ge)}var qe=fe?new Uint16Array(32768):ns(32768),jt=fe?new Uint16Array(32768):ns(32768),_t=fe?new Uint16Array(128):ns(128),Re=1,et=1;function Ct(de,pe){var ge=Se(de,pe)+257;pe+=5;var be=Se(de,pe)+1;pe+=5;var Te=ot(de,pe)+4;pe+=4;for(var Pe=0,nt=fe?new Uint8Array(19):ns(19),vt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],tt=1,lt=fe?new Uint8Array(8):ns(8),ut=fe?new Uint8Array(8):ns(8),kt=nt.length,Ot=0;Ot<Te;++Ot)nt[ce[Ot]]=Pe=Be(de,pe),tt<Pe&&(tt=Pe),lt[Pe]++,pe+=3;var Ft=0;for(lt[0]=0,Ot=1;Ot<=tt;++Ot)ut[Ot]=Ft=Ft+lt[Ot-1]<<1;for(Ot=0;Ot<kt;++Ot)(Ft=nt[Ot])!=0&&(vt[Ot]=ut[Ft]++);var Mt=0;for(Ot=0;Ot<kt;++Ot)if(Mt=nt[Ot],Mt!=0){Ft=ve[vt[Ot]]>>8-Mt;for(var Xt=(1<<7-Mt)-1;Xt>=0;--Xt)_t[Ft|Xt<<Mt]=Mt&7|Ot<<3}var Ds=[];for(tt=1;Ds.length<ge+be;)switch(Ft=_t[ze(de,pe)],pe+=Ft&7,Ft>>>=3){case 16:for(Pe=3+Ie(de,pe),pe+=2,Ft=Ds[Ds.length-1];Pe-- >0;)Ds.push(Ft);break;case 17:for(Pe=3+Be(de,pe),pe+=3;Pe-- >0;)Ds.push(0);break;case 18:for(Pe=11+ze(de,pe),pe+=7;Pe-- >0;)Ds.push(0);break;default:Ds.push(Ft),tt<Ft&&(tt=Ft);break}var gt=Ds.slice(0,ge),ea=Ds.slice(ge);for(Ot=ge;Ot<286;++Ot)gt[Ot]=0;for(Ot=be;Ot<30;++Ot)ea[Ot]=0;return Re=Ke(gt,qe,286),et=Ke(ea,jt,30),pe}function Yt(de,pe){if(de[0]==3&&!(de[1]&3))return[Fu(pe),2];for(var ge=0,be=0,Te=xE(pe||1<<18),Pe=0,nt=Te.length>>>0,vt=0,tt=0;!(be&1);){if(be=Be(de,ge),ge+=3,be>>>1)be>>1==1?(vt=9,tt=5):(ge=Ct(de,ge),vt=Re,tt=et);else{ge&7&&(ge+=8-(ge&7));var lt=de[ge>>>3]|de[(ge>>>3)+1]<<8;if(ge+=32,lt>0)for(!pe&&nt<Pe+lt&&(Te=ps(Te,Pe+lt),nt=Te.length);lt-- >0;)Te[Pe++]=de[ge>>>3],ge+=8;continue}for(;;){!pe&&nt<Pe+32767&&(Te=ps(Te,Pe+32767),nt=Te.length);var ut=we(de,ge,vt),kt=be>>>1==1?dt[ut]:qe[ut];if(ge+=kt&15,kt>>>=4,!(kt>>>8&255))Te[Pe++]=kt;else{if(kt==256)break;kt-=257;var Ot=kt<8?0:kt-4>>2;Ot>5&&(Ot=0);var Ft=Pe+xe[kt];Ot>0&&(Ft+=we(de,ge,Ot),ge+=Ot),ut=we(de,ge,tt),kt=be>>>1==1?It[ut]:jt[ut],ge+=kt&15,kt>>>=4;var Mt=kt<4?0:kt-2>>1,Xt=Ce[kt];for(Mt>0&&(Xt+=we(de,ge,Mt),ge+=Mt),!pe&&nt<Ft&&(Te=ps(Te,Ft+100),nt=Te.length);Pe<Ft;)Te[Pe]=Te[Pe-Xt],++Pe}}}return pe?[Te,ge+7>>>3]:[Te.slice(0,Pe),ge+7>>>3]}function bt(de,pe){var ge=de.slice(de.l||0),be=Yt(ge,pe);return de.l+=be[1],be[0]}function Dt(de,pe){if(de)typeof console<"u"&&console.error(pe);else throw new Error(pe)}function Jt(de,pe){var ge=de;$i(ge,0);var be=[],Te=[],Pe={FileIndex:be,FullPaths:Te};D(Pe,{root:pe.root});for(var nt=ge.length-4;(ge[nt]!=80||ge[nt+1]!=75||ge[nt+2]!=5||ge[nt+3]!=6)&&nt>=0;)--nt;ge.l=nt+4,ge.l+=4;var vt=ge.read_shift(2);ge.l+=6;var tt=ge.read_shift(4);for(ge.l=tt,nt=0;nt<vt;++nt){ge.l+=20;var lt=ge.read_shift(4),ut=ge.read_shift(4),kt=ge.read_shift(2),Ot=ge.read_shift(2),Ft=ge.read_shift(2);ge.l+=8;var Mt=ge.read_shift(4),Xt=c(ge.slice(ge.l+kt,ge.l+kt+Ot));ge.l+=kt+Ot+Ft;var Ds=ge.l;ge.l=Mt+4,Oe(ge,lt,ut,Pe,Xt),ge.l=Ds}return Pe}function Oe(de,pe,ge,be,Te){de.l+=2;var Pe=de.read_shift(2),nt=de.read_shift(2),vt=o(de);if(Pe&8257)throw new Error("Unsupported ZIP encryption");for(var tt=de.read_shift(4),lt=de.read_shift(4),ut=de.read_shift(4),kt=de.read_shift(2),Ot=de.read_shift(2),Ft="",Mt=0;Mt<kt;++Mt)Ft+=String.fromCharCode(de[de.l++]);if(Ot){var Xt=c(de.slice(de.l,de.l+Ot));(Xt[21589]||{}).mt&&(vt=Xt[21589].mt),((Te||{})[21589]||{}).mt&&(vt=Te[21589].mt)}de.l+=Ot;var Ds=de.slice(de.l,de.l+lt);switch(nt){case 8:Ds=ee(de,ut);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+nt)}var gt=!1;Pe&8&&(tt=de.read_shift(4),tt==134695760&&(tt=de.read_shift(4),gt=!0),lt=de.read_shift(4),ut=de.read_shift(4)),lt!=pe&&Dt(gt,"Bad compressed size: "+pe+" != "+lt),ut!=ge&&Dt(gt,"Bad uncompressed size: "+ge+" != "+ut),$r(be,Ft,Ds,{unsafe:!0,mt:vt})}function Xe(de,pe){var ge=pe||{},be=[],Te=[],Pe=yt(1),nt=ge.compression?8:0,vt=0,tt=0,lt=0,ut=0,kt=0,Ot=de.FullPaths[0],Ft=Ot,Mt=de.FileIndex[0],Xt=[],Ds=0;for(tt=1;tt<de.FullPaths.length;++tt)if(Ft=de.FullPaths[tt].slice(Ot.length),Mt=de.FileIndex[tt],!(!Mt.size||!Mt.content||Ft=="Sh33tJ5")){var gt=ut,ea=yt(Ft.length);for(lt=0;lt<Ft.length;++lt)ea.write_shift(1,Ft.charCodeAt(lt)&127);ea=ea.slice(0,ea.l),Xt[kt]=IQ.buf(Mt.content,0);var or=Mt.content;nt==8&&(or=ie(or)),Pe=yt(30),Pe.write_shift(4,67324752),Pe.write_shift(2,20),Pe.write_shift(2,vt),Pe.write_shift(2,nt),Mt.mt?i(Pe,Mt.mt):Pe.write_shift(4,0),Pe.write_shift(-4,Xt[kt]),Pe.write_shift(4,or.length),Pe.write_shift(4,Mt.content.length),Pe.write_shift(2,ea.length),Pe.write_shift(2,0),ut+=Pe.length,be.push(Pe),ut+=ea.length,be.push(ea),ut+=or.length,be.push(or),Pe=yt(46),Pe.write_shift(4,33639248),Pe.write_shift(2,0),Pe.write_shift(2,20),Pe.write_shift(2,vt),Pe.write_shift(2,nt),Pe.write_shift(4,0),Pe.write_shift(-4,Xt[kt]),Pe.write_shift(4,or.length),Pe.write_shift(4,Mt.content.length),Pe.write_shift(2,ea.length),Pe.write_shift(2,0),Pe.write_shift(2,0),Pe.write_shift(2,0),Pe.write_shift(2,0),Pe.write_shift(4,0),Pe.write_shift(4,gt),Ds+=Pe.l,Te.push(Pe),Ds+=ea.length,Te.push(ea),++kt}return Pe=yt(22),Pe.write_shift(4,101010256),Pe.write_shift(2,0),Pe.write_shift(2,0),Pe.write_shift(2,kt),Pe.write_shift(2,kt),Pe.write_shift(4,Ds),Pe.write_shift(4,ut),Pe.write_shift(2,0),Rn([Rn(be),Rn(Te),Pe])}var zt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function qt(de,pe){if(de.ctype)return de.ctype;var ge=de.name||"",be=ge.match(/\.([^\.]+)$/);return be&&zt[be[1]]||pe&&(be=(ge=pe).match(/[\.\\]([^\.\\])+$/),be&&zt[be[1]])?zt[be[1]]:"application/octet-stream"}function St(de){for(var pe=Ip(de),ge=[],be=0;be<pe.length;be+=76)ge.push(pe.slice(be,be+76));return ge.join(`\r
`)+`\r
`}function ls(de){var pe=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(lt){var ut=lt.charCodeAt(0).toString(16).toUpperCase();return"="+(ut.length==1?"0"+ut:ut)});pe=pe.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),pe.charAt(0)==`
`&&(pe="=0D"+pe.slice(1)),pe=pe.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ge=[],be=pe.split(`\r
`),Te=0;Te<be.length;++Te){var Pe=be[Te];if(Pe.length==0){ge.push("");continue}for(var nt=0;nt<Pe.length;){var vt=76,tt=Pe.slice(nt,nt+vt);tt.charAt(vt-1)=="="?vt--:tt.charAt(vt-2)=="="?vt-=2:tt.charAt(vt-3)=="="&&(vt-=3),tt=Pe.slice(nt,nt+vt),nt+=vt,nt<Pe.length&&(tt+="="),ge.push(tt)}}return ge.join(`\r
`)}function is(de){for(var pe=[],ge=0;ge<de.length;++ge){for(var be=de[ge];ge<=de.length&&be.charAt(be.length-1)=="=";)be=be.slice(0,be.length-1)+de[++ge];pe.push(be)}for(var Te=0;Te<pe.length;++Te)pe[Te]=pe[Te].replace(/[=][0-9A-Fa-f]{2}/g,function(Pe){return String.fromCharCode(parseInt(Pe.slice(1),16))});return Qo(pe.join(`\r
`))}function ws(de,pe,ge){for(var be="",Te="",Pe="",nt,vt=0;vt<10;++vt){var tt=pe[vt];if(!tt||tt.match(/^\s*$/))break;var lt=tt.match(/^(.*?):\s*([^\s].*)$/);if(lt)switch(lt[1].toLowerCase()){case"content-location":be=lt[2].trim();break;case"content-type":Pe=lt[2].trim();break;case"content-transfer-encoding":Te=lt[2].trim();break}}switch(++vt,Te.toLowerCase()){case"base64":nt=Qo(bc(pe.slice(vt).join("")));break;case"quoted-printable":nt=is(pe.slice(vt));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Te)}var ut=$r(de,be.slice(ge.length),nt,{unsafe:!0});Pe&&(ut.ctype=Pe)}function Bs(de,pe){if(re(de.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ge=pe&&pe.root||"",be=(Dr&&Buffer.isBuffer(de)?de.toString("binary"):re(de)).split(`\r
`),Te=0,Pe="";for(Te=0;Te<be.length;++Te)if(Pe=be[Te],!!/^Content-Location:/i.test(Pe)&&(Pe=Pe.slice(Pe.indexOf("file")),ge||(ge=Pe.slice(0,Pe.lastIndexOf("/")+1)),Pe.slice(0,ge.length)!=ge))for(;ge.length>0&&(ge=ge.slice(0,ge.length-1),ge=ge.slice(0,ge.lastIndexOf("/")+1),Pe.slice(0,ge.length)!=ge););var nt=(be[1]||"").match(/boundary="(.*?)"/);if(!nt)throw new Error("MAD cannot find boundary");var vt="--"+(nt[1]||""),tt=[],lt=[],ut={FileIndex:tt,FullPaths:lt};D(ut);var kt,Ot=0;for(Te=0;Te<be.length;++Te){var Ft=be[Te];Ft!==vt&&Ft!==vt+"--"||(Ot++&&ws(ut,be.slice(kt,Te),ge),kt=Te)}return ut}function js(de,pe){var ge=pe||{},be=ge.boundary||"SheetJS";be="------="+be;for(var Te=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+be.slice(2)+'"',"","",""],Pe=de.FullPaths[0],nt=Pe,vt=de.FileIndex[0],tt=1;tt<de.FullPaths.length;++tt)if(nt=de.FullPaths[tt].slice(Pe.length),vt=de.FileIndex[tt],!(!vt.size||!vt.content||nt=="Sh33tJ5")){nt=nt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ds){return"_x"+Ds.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ds){return"_u"+Ds.charCodeAt(0).toString(16)+"_"});for(var lt=vt.content,ut=Dr&&Buffer.isBuffer(lt)?lt.toString("binary"):re(lt),kt=0,Ot=Math.min(1024,ut.length),Ft=0,Mt=0;Mt<=Ot;++Mt)(Ft=ut.charCodeAt(Mt))>=32&&Ft<128&&++kt;var Xt=kt>=Ot*4/5;Te.push(be),Te.push("Content-Location: "+(ge.root||"file:///C:/SheetJS/")+nt),Te.push("Content-Transfer-Encoding: "+(Xt?"quoted-printable":"base64")),Te.push("Content-Type: "+qt(vt,nt)),Te.push(""),Te.push(Xt?ls(ut):St(ut))}return Te.push(be+`--\r
`),Te.join(`\r
`)}function ha(de){var pe={};return D(pe,de),pe}function $r(de,pe,ge,be){var Te=be&&be.unsafe;Te||D(de);var Pe=!Te&&Qr.find(de,pe);if(!Pe){var nt=de.FullPaths[0];pe.slice(0,nt.length)==nt?nt=pe:(nt.slice(-1)!="/"&&(nt+="/"),nt=(nt+pe).replace("//","/")),Pe={name:n(pe),type:2},de.FileIndex.push(Pe),de.FullPaths.push(nt),Te||Qr.utils.cfb_gc(de)}return Pe.content=ge,Pe.size=ge?ge.length:0,be&&(be.CLSID&&(Pe.clsid=be.CLSID),be.mt&&(Pe.mt=be.mt),be.ct&&(Pe.ct=be.ct)),Pe}function _a(de,pe){D(de);var ge=Qr.find(de,pe);if(ge){for(var be=0;be<de.FileIndex.length;++be)if(de.FileIndex[be]==ge)return de.FileIndex.splice(be,1),de.FullPaths.splice(be,1),!0}return!1}function Or(de,pe,ge){D(de);var be=Qr.find(de,pe);if(be){for(var Te=0;Te<de.FileIndex.length;++Te)if(de.FileIndex[Te]==be)return de.FileIndex[Te].name=n(ge),de.FullPaths[Te]=ge,!0}return!1}function Gt(de){M(de,!0)}return t.find=q,t.read=O,t.parse=p,t.write=le,t.writeFile=Q,t.utils={cfb_new:ha,cfb_add:$r,cfb_del:_a,cfb_mov:Or,cfb_gc:Gt,ReadShift:Xm,CheckField:jI,prep_blob:$i,bconcat:Rn,use_zlib:W,_deflateRaw:us,_inflateRaw:bt,consts:G},t}();function OQ(e){return typeof e=="string"?Yg(e):Array.isArray(e)?iQ(e):e}function c0(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Yg(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?Dp(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var n=new Blob([OQ(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(e);return c.open("w"),c.encoding="binary",Array.isArray(t)&&(t=l0(t)),c.write(t),c.close(),t}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+e)}function Dn(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function NE(e,t){for(var r=[],a=Dn(e),n=0;n!==a.length;++n)r[e[a[n]][t]]==null&&(r[e[a[n]][t]]=a[n]);return r}function R_(e){for(var t=[],r=Dn(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function Jg(e){for(var t=[],r=Dn(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function DQ(e){for(var t=[],r=Dn(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var ag=new Date(1899,11,30,0,0,0);function Ii(e,t){var r=e.getTime(),a=ag.getTime()+(e.getTimezoneOffset()-ag.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var iI=new Date,MQ=ag.getTime()+(iI.getTimezoneOffset()-ag.getTimezoneOffset())*6e4,CE=iI.getTimezoneOffset();function oI(e){var t=new Date;return t.setTime(e*24*60*60*1e3+MQ),t.getTimezoneOffset()!==CE&&t.setTime(t.getTime()+(t.getTimezoneOffset()-CE)*6e4),t}var EE=new Date("2017-02-19T19:06:09.000Z"),lI=isNaN(EE.getFullYear())?new Date("2/19/17"):EE,LQ=lI.getFullYear()==2017;function yi(e,t){var r=new Date(e);if(LQ)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(lI.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function e1(e,t){if(Dr&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function Oi(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Oi(e[r]));return t}function Oa(e,t){for(var r="";r.length<t;)r+=e;return r}function mc(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,i){return r=-r,i}),!isNaN(t=Number(a)))?t/r:t}var FQ=["january","february","march","april","may","june","july","august","september","october","november","december"];function Op(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&FQ.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||i>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function ur(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return Dr?a=Ec(r):a=oQ(r),Qr.utils.cfb_add(e,t,a)}Qr.utils.cfb_add(e,t,r)}else e.file(t,r)}function P_(){return Qr.utils.cfb_new()}var Ja=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,BQ={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},I_=R_(BQ),O_=/[&<>'"]/g,VQ=/[\u0000-\u0008\u000b-\u001f]/g;function Xr(e){var t=e+"";return t.replace(O_,function(r){return I_[r]}).replace(VQ,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function SE(e){return Xr(e).replace(/ /g,"_x0020_")}var cI=/[\u0000-\u001f]/g;function UQ(e){var t=e+"";return t.replace(O_,function(r){return I_[r]}).replace(/\n/g,"<br/>").replace(cI,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function zQ(e){var t=e+"";return t.replace(O_,function(r){return I_[r]}).replace(cI,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function $Q(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function qQ(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function mv(e){for(var t="",r=0,a=0,n=0,i=0,o=0,c=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),a>191&&a<224){o=(a&31)<<6,o|=n&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(n&63)<<6|i&63);continue}o=e.charCodeAt(r++),c=((a&7)<<18|(n&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function TE(e){var t=Fu(2*e.length),r,a,n=1,i=0,o=0,c;for(a=0;a<e.length;a+=n)n=1,(c=e.charCodeAt(a))<128?r=c:c<224?(r=(c&31)*64+(e.charCodeAt(a+1)&63),n=2):c<240?(r=(c&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,r=(c&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function AE(e){return Ec(e,"binary").toString("utf8")}var Y0="foo bar baz",Km=Dr&&(AE(Y0)==mv(Y0)&&AE||TE(Y0)==mv(Y0)&&TE)||mv,Dp=Dr?function(e){return Ec(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},WQ=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}}(),dI=/(^\s|\s$|\n)/;function Pn(e,t){return"<"+e+(t.match(dI)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Mp(e){return Dn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ht(e,t,r){return"<"+e+(r!=null?Mp(r):"")+(t!=null?(t.match(dI)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function lw(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function HQ(e,t){switch(typeof e){case"string":var r=Ht("vt:lpwstr",Xr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ht((e|0)==e?"vt:i4":"vt:r8",Xr(String(e)));case"boolean":return Ht("vt:bool",e?"true":"false")}if(e instanceof Date)return Ht("vt:filetime",lw(e));throw new Error("Unable to serialize "+e)}var vn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Wf=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Wi={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function GQ(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,i=5;i>=0;--i)n=n*256+e[t+i];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function KQ(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,i=0,o=a?-t:t;isFinite(o)?o==0?n=i=0:(n=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(t)?26985:0);for(var c=0;c<=5;++c,i/=256)e[r+c]=i&255;e[r+6]=(n&15)<<4|i&15,e[r+7]=n>>4|a}var kE=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,i=e[0][a].length;n<i;n+=r)t.push.apply(t,e[0][a].slice(n,n+r));return t},RE=Dr?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ec(t)})):kE(e)}:kE,PE=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(Pm(e,n)));return a.join("").replace(Gm,"")},D_=Dr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Gm,""):PE(e,t,r)}:PE,IE=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},uI=Dr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):IE(e,t,r)}:IE,OE=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(jh(e,n)));return a.join("")},d0=Dr?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):OE(t,r,a)}:OE,hI=function(e,t){var r=Hi(e,t);return r>0?d0(e,t+4,t+4+r-1):""},fI=hI,mI=function(e,t){var r=Hi(e,t);return r>0?d0(e,t+4,t+4+r-1):""},pI=mI,xI=function(e,t){var r=2*Hi(e,t);return r>0?d0(e,t+4,t+4+r-1):""},gI=xI,vI=function(t,r){var a=Hi(t,r);return a>0?D_(t,r+4,r+4+a):""},yI=vI,wI=function(e,t){var r=Hi(e,t);return r>0?d0(e,t+4,t+4+r):""},bI=wI,_I=function(e,t){return GQ(e,t)},ng=_I,M_=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Dr&&(fI=function(t,r){if(!Buffer.isBuffer(t))return hI(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},pI=function(t,r){if(!Buffer.isBuffer(t))return mI(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},gI=function(t,r){if(!Buffer.isBuffer(t))return xI(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},yI=function(t,r){if(!Buffer.isBuffer(t))return vI(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},bI=function(t,r){if(!Buffer.isBuffer(t))return wI(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},ng=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):_I(t,r)},M_=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var jh=function(e,t){return e[t]},Pm=function(e,t){return e[t+1]*256+e[t]},XQ=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Hi=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ou=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},YQ=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Xm(e,t){var r="",a,n,i=[],o,c,d,h;switch(t){case"dbcs":if(h=this.l,Dr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)r+=String.fromCharCode(Pm(this,h)),h+=2;e*=2;break;case"utf8":r=d0(this,this.l,this.l+e);break;case"utf16le":e*=2,r=D_(this,this.l,this.l+e);break;case"wstr":return Xm.call(this,e,"dbcs");case"lpstr-ansi":r=fI(this,this.l),e=4+Hi(this,this.l);break;case"lpstr-cp":r=pI(this,this.l),e=4+Hi(this,this.l);break;case"lpwstr":r=gI(this,this.l),e=4+2*Hi(this,this.l);break;case"lpp4":e=4+Hi(this,this.l),r=yI(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Hi(this,this.l),r=bI(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=jh(this,this.l+e++))!==0;)i.push(G0(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=Pm(this,this.l+e))!==0;)i.push(G0(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",h=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return o=jh(this,h),this.l=h+1,c=Xm.call(this,e-d,o?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(G0(Pm(this,h))),h+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return o=jh(this,h),this.l=h+1,c=Xm.call(this,e-d,o?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(G0(jh(this,h))),h+=1}r=i.join("");break;default:switch(e){case 1:return a=jh(this,this.l),this.l++,a;case 2:return a=(t==="i"?XQ:Pm)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(a=(e>0?ou:YQ)(this,this.l),this.l+=4,a):(n=Hi(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=ng(this,this.l):n=ng([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=uI(this,this.l,e);break}}return this.l+=e,r}var ZQ=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},QQ=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},JQ=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function eJ(e,t,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)JQ(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;a=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var o=t.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,ZQ(this,t,this.l);break;case 8:if(a=8,r==="f"){KQ(this,t,this.l);break}case 16:break;case-4:a=4,QQ(this,t,this.l);break}return this.l+=a,this}function jI(e,t){var r=uI(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function $i(e,t){e.l=t,e.read_shift=Xm,e.chk=jI,e.write_shift=eJ}function ql(e,t){e.l+=t}function yt(e){var t=Fu(e);return $i(t,0),t}function Pi(){var e=[],t=Dr?256:2048,r=function(h){var p=yt(h);return $i(p,0),p},a=r(t),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},i=function(h){return a&&h<a.length-a.l?a:(n(),a=r(Math.max(h+1,t)))},o=function(){return n(),Rn(e)},c=function(h){n(),a=h,a.l==null&&(a.l=a.length),i(t)};return{next:i,push:c,end:o,_bufs:e}}function At(e,t,r,a){var n=+t,i;if(!isNaN(n)){a||(a=Gae[n].p||(r||[]).length||0),i=1+(n>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var o=e.next(i);n<=127?o.write_shift(1,n):(o.write_shift(1,(n&127)+128),o.write_shift(1,n>>7));for(var c=0;c!=4;++c)if(a>=128)o.write_shift(1,(a&127)+128),a>>=7;else{o.write_shift(1,a);break}a>0&&M_(r)&&e.push(r)}}function Ym(e,t,r){var a=Oi(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function DE(e,t,r){var a=Oi(e);return a.s=Ym(a.s,t.s,r),a.e=Ym(a.e,t.s,r),a}function Zm(e,t){if(e.cRel&&e.c<0)for(e=Oi(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Oi(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Yr(e);return!e.cRel&&e.cRel!=null&&(r=rJ(r)),!e.rRel&&e.rRel!=null&&(r=tJ(r)),r}function pv(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+ei(e.s.c)+":"+(e.e.cRel?"":"$")+ei(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+On(e.s.r)+":"+(e.e.rRel?"":"$")+On(e.e.r):Zm(e.s,t.biff)+":"+Zm(e.e,t.biff)}function L_(e){return parseInt(sJ(e),10)-1}function On(e){return""+(e+1)}function tJ(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function sJ(e){return e.replace(/\$(\d+)$/,"$1")}function F_(e){for(var t=aJ(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function ei(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function rJ(e){return e.replace(/^([A-Z])/,"$$$1")}function aJ(e){return e.replace(/^\$([A-Z])/,"$1")}function nJ(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function wn(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function Yr(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function so(e){var t=e.indexOf(":");return t==-1?{s:wn(e),e:wn(e)}:{s:wn(e.slice(0,t)),e:wn(e.slice(t+1))}}function Za(e,t){return typeof t>"u"||typeof t=="number"?Za(e.s,e.e):(typeof e!="string"&&(e=Yr(e)),typeof t!="string"&&(t=Yr(t)),e==t?e:e+":"+t)}function va(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,i=e.length;for(r=0;a<i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===i||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function ME(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Pd(e.z,r?Ii(t):t)}catch{}try{return e.w=Pd((e.XF||{}).numFmtId||(r?14:0),r?Ii(t):t)}catch{return""+t}}function _c(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?u0[e.v]||e.v:t==null?ME(e,e.v):ME(e,t))}function Gu(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function NI(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense,i=e||(n?[]:{}),o=0,c=0;if(i&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var d=typeof a.origin=="string"?wn(a.origin):a.origin;o=d.r,c=d.c}i["!ref"]||(i["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var p=va(i["!ref"]);h.s.c=p.s.c,h.s.r=p.s.r,h.e.c=Math.max(h.e.c,p.e.c),h.e.r=Math.max(h.e.r,p.e.r),o==-1&&(h.e.r=o=p.e.r+1)}for(var x=0;x!=t.length;++x)if(t[x]){if(!Array.isArray(t[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=t[x].length;++v)if(!(typeof t[x][v]>"u")){var b={v:t[x][v]},N=o+x,_=c+v;if(h.s.r>N&&(h.s.r=N),h.s.c>_&&(h.s.c=_),h.e.r<N&&(h.e.r=N),h.e.c<_&&(h.e.c=_),t[x][v]&&typeof t[x][v]=="object"&&!Array.isArray(t[x][v])&&!(t[x][v]instanceof Date))b=t[x][v];else if(Array.isArray(b.v)&&(b.f=t[x][v][1],b.v=b.v[0]),b.v===null)if(b.f)b.t="n";else if(a.nullError)b.t="e",b.v=0;else if(a.sheetStubs)b.t="z";else continue;else typeof b.v=="number"?b.t="n":typeof b.v=="boolean"?b.t="b":b.v instanceof Date?(b.z=a.dateNF||Ma[14],a.cellDates?(b.t="d",b.w=Pd(b.z,Ii(b.v))):(b.t="n",b.v=Ii(b.v),b.w=Pd(b.z,b.v))):b.t="s";if(n)i[N]||(i[N]=[]),i[N][_]&&i[N][_].z&&(b.z=i[N][_].z),i[N][_]=b;else{var C=Yr({c:_,r:N});i[C]&&i[C].z&&(b.z=i[C].z),i[C]=b}}}return h.s.c<1e7&&(i["!ref"]=Za(h)),i}function Hf(e,t){return NI(null,e,t)}function iJ(e){return e.read_shift(4,"i")}function rl(e,t){return t||(t=yt(4)),t.write_shift(4,e),t}function ti(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function bn(e,t){var r=!1;return t==null&&(r=!0,t=yt(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function oJ(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function lJ(e,t){return t||(t=yt(4)),t.write_shift(2,0),t.write_shift(2,0),t}function B_(e,t){var r=e.l,a=e.read_shift(1),n=ti(e),i=[],o={t:n,h:n};if(a&1){for(var c=e.read_shift(4),d=0;d!=c;++d)i.push(oJ(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function cJ(e,t){var r=!1;return t==null&&(r=!0,t=yt(15+4*e.t.length)),t.write_shift(1,0),bn(e.t,t),r?t.slice(0,t.l):t}var dJ=B_;function uJ(e,t){var r=!1;return t==null&&(r=!0,t=yt(23+4*e.t.length)),t.write_shift(1,1),bn(e.t,t),t.write_shift(4,1),lJ({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function ko(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ku(e,t){return t==null&&(t=yt(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Xu(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Yu(e,t){return t==null&&(t=yt(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var hJ=ti,CI=bn;function V_(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function ig(e,t){var r=!1;return t==null&&(r=!0,t=yt(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var fJ=ti,cw=V_,U_=ig;function EI(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var n=a===0?ng([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ou(t,0)>>2;return r?n/100:n}function SI(e,t){t==null&&(t=yt(4));var r=0,a=0,n=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?a=1:n==(n|0)&&n>=-(1<<29)&&n<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function TI(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function mJ(e,t){return t||(t=yt(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Zu=TI,Gf=mJ;function Kf(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Bu(e,t){return(t||yt(8)).write_shift(8,e,"f")}function pJ(e){var t={},r=e.read_shift(1),a=r>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),c=e.read_shift(1),d=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=n;var h=NJ[n];h&&(t.rgb=GE(h));break;case 2:t.rgb=GE([o,c,d]);break;case 3:t.theme=n;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function og(e,t){if(t||(t=yt(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function xJ(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function gJ(e,t){t||(t=yt(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var AI=2,zi=3,Z0=11,lg=19,Q0=64,vJ=65,yJ=71,wJ=4108,bJ=4126,An=80,LE={1:{n:"CodePage",t:AI},2:{n:"Category",t:An},3:{n:"PresentationFormat",t:An},4:{n:"ByteCount",t:zi},5:{n:"LineCount",t:zi},6:{n:"ParagraphCount",t:zi},7:{n:"SlideCount",t:zi},8:{n:"NoteCount",t:zi},9:{n:"HiddenCount",t:zi},10:{n:"MultimediaClipCount",t:zi},11:{n:"ScaleCrop",t:Z0},12:{n:"HeadingPairs",t:wJ},13:{n:"TitlesOfParts",t:bJ},14:{n:"Manager",t:An},15:{n:"Company",t:An},16:{n:"LinksUpToDate",t:Z0},17:{n:"CharacterCount",t:zi},19:{n:"SharedDoc",t:Z0},22:{n:"HyperlinksChanged",t:Z0},23:{n:"AppVersion",t:zi,p:"version"},24:{n:"DigSig",t:vJ},26:{n:"ContentType",t:An},27:{n:"ContentStatus",t:An},28:{n:"Language",t:An},29:{n:"Version",t:An},255:{},2147483648:{n:"Locale",t:lg},2147483651:{n:"Behavior",t:lg},1919054434:{}},FE={1:{n:"CodePage",t:AI},2:{n:"Title",t:An},3:{n:"Subject",t:An},4:{n:"Author",t:An},5:{n:"Keywords",t:An},6:{n:"Comments",t:An},7:{n:"Template",t:An},8:{n:"LastAuthor",t:An},9:{n:"RevNumber",t:An},10:{n:"EditTime",t:Q0},11:{n:"LastPrinted",t:Q0},12:{n:"CreatedDate",t:Q0},13:{n:"ModifiedDate",t:Q0},14:{n:"PageCount",t:zi},15:{n:"WordCount",t:zi},16:{n:"CharCount",t:zi},17:{n:"Thumbnail",t:yJ},18:{n:"Application",t:An},19:{n:"DocSecurity",t:zi},255:{},2147483648:{n:"Locale",t:lg},2147483651:{n:"Behavior",t:lg},1919054434:{}};function _J(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var jJ=_J([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),NJ=Oi(jJ),u0={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},CJ={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},J0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function kI(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function RI(e,t){var r=DQ(CJ),a=[],n;a[a.length]=Ja,a[a.length]=Ht("Types",null,{xmlns:vn.CT,"xmlns:xsd":vn.xsd,"xmlns:xsi":vn.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return Ht("Default",null,{Extension:d[0],ContentType:d[1]})}));var i=function(d){e[d]&&e[d].length>0&&(n=e[d][0],a[a.length]=Ht("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:J0[d][t.bookType]||J0[d].xlsx}))},o=function(d){(e[d]||[]).forEach(function(h){a[a.length]=Ht("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:J0[d][t.bookType]||J0[d].xlsx})})},c=function(d){(e[d]||[]).forEach(function(h){a[a.length]=Ht("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:r[d][0]})})};return i("workbooks"),o("sheets"),o("charts"),c("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),o("metadata"),c("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Rr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function PI(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Uh(e){var t=[Ja,Ht("Relationships",null,{xmlns:vn.RELS})];return Dn(e["!id"]).forEach(function(r){t[t.length]=Ht("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Gr(e,t,r,a,n,i){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=a,n.Target=r,[Rr.HLINK,Rr.XPATH,Rr.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}function EJ(e){var t=[Ja];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function BE(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function SJ(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function TJ(e){var t=[Ja];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(BE(e[r][0],e[r][1])),t.push(SJ("",e[r][0]));return t.push(BE("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function II(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+eg.version+"</meta:generator></office:meta></office:document-meta>"}var Eu=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function xv(e,t,r,a,n){n[e]!=null||t==null||t===""||(n[e]=t,t=Xr(t),a[a.length]=r?Ht(e,t,r):Pn(e,t))}function OI(e,t){var r=t||{},a=[Ja,Ht("cp:coreProperties",null,{"xmlns:cp":vn.CORE_PROPS,"xmlns:dc":vn.dc,"xmlns:dcterms":vn.dcterms,"xmlns:dcmitype":vn.dcmitype,"xmlns:xsi":vn.xsi})],n={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&xv("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:lw(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),e.ModifiedDate!=null&&xv("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:lw(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var i=0;i!=Eu.length;++i){var o=Eu[i],c=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&xv(o[0],c,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var zh=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],DI=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function MI(e){var t=[],r=Ht;return e||(e={}),e.Application="SheetJS",t[t.length]=Ja,t[t.length]=Ht("Properties",null,{xmlns:vn.EXT_PROPS,"xmlns:vt":vn.vt}),zh.forEach(function(a){if(e[a[1]]!==void 0){var n;switch(a[2]){case"string":n=Xr(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(a[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+Xr(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function LI(e){var t=[Ja,Ht("Properties",null,{xmlns:vn.CUST_PROPS,"xmlns:vt":vn.vt})];if(!e)return t.join("");var r=1;return Dn(e).forEach(function(n){++r,t[t.length]=Ht("property",HQ(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Xr(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var VE={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function AJ(e,t){var r=[];return Dn(VE).map(function(a){for(var n=0;n<Eu.length;++n)if(Eu[n][1]==a)return Eu[n];for(n=0;n<zh.length;++n)if(zh[n][1]==a)return zh[n];throw a}).forEach(function(a){if(e[a[1]]!=null){var n=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(Pn(VE[a[1]]||a[1],n))}}),Ht("DocumentProperties",r.join(""),{xmlns:Wi.o})}function kJ(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&Dn(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<Eu.length;++o)if(i==Eu[o][1])return;for(o=0;o<zh.length;++o)if(i==zh[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var c=e[i],d="string";typeof c=="number"?(d="float",c=String(c)):c===!0||c===!1?(d="boolean",c=c?"1":"0"):c=String(c),n.push(Ht(SE(i),c,{"dt:dt":d}))}}),t&&Dn(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=t[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o instanceof Date?(c="dateTime.tz",o=o.toISOString()):o=String(o),n.push(Ht(SE(i),o,{"dt:dt":c}))}}),"<"+a+' xmlns="'+Wi.o+'">'+n.join("")+"</"+a+">"}function RJ(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),n+=i);var o=yt(8);return o.write_shift(4,a),o.write_shift(4,n),o}function UE(e,t){var r=yt(4),a=yt(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=yt(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=RJ(t);break;case 31:case 80:for(a=yt(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Rn([r,a])}var FI=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function PJ(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function zE(e,t,r){var a=yt(8),n=[],i=[],o=8,c=0,d=yt(8),h=yt(8);if(d.write_shift(4,2),d.write_shift(4,1200),h.write_shift(4,1),i.push(d),n.push(h),o+=8+d.length,!t){h=yt(8),h.write_shift(4,0),n.unshift(h);var p=[yt(4)];for(p[0].write_shift(4,e.length),c=0;c<e.length;++c){var x=e[c][0];for(d=yt(8+2*(x.length+1)+(x.length%2?0:2)),d.write_shift(4,c+2),d.write_shift(4,x.length+1),d.write_shift(0,x,"dbcs");d.l!=d.length;)d.write_shift(1,0);p.push(d)}d=Rn(p),i.unshift(d),o+=8+d.length}for(c=0;c<e.length;++c)if(!(t&&!t[e[c][0]])&&!(FI.indexOf(e[c][0])>-1||DI.indexOf(e[c][0])>-1)&&e[c][1]!=null){var v=e[c][1],b=0;if(t){b=+t[e[c][0]];var N=r[b];if(N.p=="version"&&typeof v=="string"){var _=v.split(".");v=(+_[0]<<16)+(+_[1]||0)}d=UE(N.t,v)}else{var C=PJ(v);C==-1&&(C=31,v=String(v)),d=UE(C,v)}i.push(d),h=yt(8),h.write_shift(4,t?b:2+c),n.push(h),o+=8+d.length}var T=8*(i.length+1);for(c=0;c<i.length;++c)n[c].write_shift(4,T),T+=i[c].length;return a.write_shift(4,o),a.write_shift(4,i.length),Rn([a].concat(n).concat(i))}function $E(e,t,r,a,n,i){var o=yt(n?68:48),c=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Qr.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,n?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,n?68:48);var d=zE(e,r,a);if(c.push(d),n){var h=zE(n,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+d.length),c.push(h)}return Rn(c)}function IJ(e,t){t||(t=yt(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function OJ(e,t){return e.read_shift(t)===1}function hi(e,t){return t||(t=yt(2)),t.write_shift(2,+!!e),t}function BI(e){return e.read_shift(2,"u")}function po(e,t){return t||(t=yt(2)),t.write_shift(2,e),t}function VI(e,t,r){return r||(r=yt(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function UI(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var o=a?e.read_shift(a,n):"";return o}function DJ(e){var t=e.t||"",r=yt(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=yt(2*t.length);a.write_shift(2*t.length,t,"utf16le");var n=[r,a];return Rn(n)}function MJ(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function LJ(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):MJ(e,a,r)}function FJ(e,t,r){if(r.biff>5)return LJ(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function zI(e,t,r){return r||(r=yt(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function qE(e,t){t||(t=yt(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function BJ(e){var t=yt(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),i=n>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(i==28)a=a.slice(1),qE(a,t);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var c=n>-1?a.slice(0,n):a;for(t.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)t.write_shift(2,c.charCodeAt(r));t.write_shift(2,0),i&8&&qE(n>-1?a.slice(n+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var d=0;a.slice(d*3,d*3+3)=="../"||a.slice(d*3,d*3+3)=="..\\";)++d;for(t.write_shift(2,d),t.write_shift(4,a.length-3*d+1),r=0;r<a.length-3*d;++r)t.write_shift(1,a.charCodeAt(r+3*d)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Vu(e,t,r,a){return a||(a=yt(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function VJ(e,t,r){var a=r.biff>8?4:2,n=e.read_shift(a),i=e.read_shift(a,"i"),o=e.read_shift(a,"i");return[n,i,o]}function UJ(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r:t},e:{c:n,r}}}function $I(e,t){return t||(t=yt(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function z_(e,t,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=yt(n);return i.write_shift(2,a),i.write_shift(2,t),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function zJ(e,t){var r=!t||t.biff==8,a=yt(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function $J(e,t){var r=!t||t.biff>=8?2:1,a=yt(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function qJ(e,t){var r=yt(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=DJ(e[n]);var i=Rn([r].concat(a));return i.parts=[r.length].concat(a.map(function(o){return o.length})),i}function WJ(){var e=yt(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function HJ(e){var t=yt(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function GJ(e,t){var r=e.name||"Arial",a=t&&t.biff==5,n=a?15+r.length:16+2*r.length,i=yt(n);return i.write_shift(2,(e.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),i}function KJ(e,t,r,a){var n=yt(10);return Vu(e,t,a,n),n.write_shift(4,r),n}function XJ(e,t,r,a,n){var i=!n||n.biff==8,o=yt(8+ +i+(1+i)*r.length);return Vu(e,t,a,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function YJ(e,t,r,a){var n=r&&r.biff==5;a||(a=yt(n?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(n?1:2,t.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}function ZJ(e,t){var r=t.biff==8||!t.biff?4:2,a=yt(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function WE(e,t,r,a){var n=r&&r.biff==5;a||(a=yt(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&n&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function QJ(e){var t=yt(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function JJ(e,t,r,a,n,i){var o=yt(8);return Vu(e,t,a,o),VI(r,i,o),o}function eee(e,t,r,a){var n=yt(14);return Vu(e,t,a,n),Bu(r,n),n}function tee(e,t,r){if(r.biff<8)return see(e,t,r);for(var a=[],n=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)a.push(VJ(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function see(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=UI(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function ree(e){var t=yt(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)$I(e[r],t);return t}function aee(e){var t=yt(24),r=wn(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(a[n],16));return Rn([t,BJ(e[1])])}function nee(e){var t=e[1].Tooltip,r=yt(10+2*(t.length+1));r.write_shift(2,2048);var a=wn(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function iee(e){return e||(e=yt(4)),e.write_shift(2,1),e.write_shift(2,1),e}function oee(e,t,r){if(!r.cellStyles)return ql(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(a),c=e.read_shift(a),d=e.read_shift(2);a==2&&(e.l+=2);var h={s:n,e:i,w:o,ixfe:c,flags:d};return(r.biff>=5||!r.biff)&&(h.level=d>>8&7),h}function lee(e,t){var r=yt(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function cee(e){for(var t=yt(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function dee(e,t,r){var a=yt(15);return f0(a,e,t),a.write_shift(8,r,"f"),a}function uee(e,t,r){var a=yt(9);return f0(a,e,t),a.write_shift(2,r),a}var hee=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=R_({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,d){var h=[],p=Fu(1);switch(d.type){case"base64":p=Qo(bc(c));break;case"binary":p=Qo(c);break;case"buffer":case"array":p=c;break}$i(p,0);var x=p.read_shift(1),v=!!(x&136),b=!1,N=!1;switch(x){case 2:break;case 3:break;case 48:b=!0,v=!0;break;case 49:b=!0,v=!0;break;case 131:break;case 139:break;case 140:N=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var _=0,C=521;x==2&&(_=p.read_shift(2)),p.l+=3,x!=2&&(_=p.read_shift(4)),_>1048576&&(_=1e6),x!=2&&(C=p.read_shift(2));var T=p.read_shift(2),A=d.codepage||1252;x!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(A=e[p[p.l]]),p.l+=1,p.l+=2),N&&(p.l+=36);for(var k=[],I={},B=Math.min(p.length,x==2?521:C-10-(b?264:0)),O=N?32:11;p.l<B&&p[p.l]!=13;)switch(I={},I.name=iu.utils.decode(A,p.slice(p.l,p.l+O)).replace(/[\u0000\r\n].*$/g,""),p.l+=O,I.type=String.fromCharCode(p.read_shift(1)),x!=2&&!N&&(I.offset=p.read_shift(4)),I.len=p.read_shift(1),x==2&&(I.offset=p.read_shift(2)),I.dec=p.read_shift(1),I.name.length&&k.push(I),x!=2&&(p.l+=N?13:14),I.type){case"B":(!b||I.len!=8)&&d.WTF&&console.log("Skipping "+I.name+":"+I.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+I.name+":"+I.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+I.type)}if(p[p.l]!==13&&(p.l=C-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=C;var D=0,F=0;for(h[0]=[],F=0;F!=k.length;++F)h[0][F]=k[F].name;for(;_-- >0;){if(p[p.l]===42){p.l+=T;continue}for(++p.l,h[++D]=[],F=0,F=0;F!=k.length;++F){var M=p.slice(p.l,p.l+k[F].len);p.l+=k[F].len,$i(M,0);var z=iu.utils.decode(A,M);switch(k[F].type){case"C":z.trim().length&&(h[D][F]=z.replace(/\s+$/,""));break;case"D":z.length===8?h[D][F]=new Date(+z.slice(0,4),+z.slice(4,6)-1,+z.slice(6,8)):h[D][F]=z;break;case"F":h[D][F]=parseFloat(z.trim());break;case"+":case"I":h[D][F]=N?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(z.trim().toUpperCase()){case"Y":case"T":h[D][F]=!0;break;case"N":case"F":h[D][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+z+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));h[D][F]="##MEMO##"+(N?parseInt(z.trim(),10):M.read_shift(4));break;case"N":z=z.replace(/\u0000/g,"").trim(),z&&z!="."&&(h[D][F]=+z||0);break;case"@":h[D][F]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":h[D][F]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":h[D][F]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[D][F]=-M.read_shift(-8,"f");break;case"B":if(b&&k[F].len==8){h[D][F]=M.read_shift(8,"f");break}case"G":case"P":M.l+=k[F].len;break;case"0":if(k[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+k[F].type)}}}if(x!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return d&&d.sheetRows&&(h=h.slice(0,d.sheetRows)),d.DBF=k,h}function a(c,d){var h=d||{};h.dateNF||(h.dateNF="yyyymmdd");var p=Hf(r(c,h),h);return p["!cols"]=h.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete h.DBF,p}function n(c,d){try{return Gu(a(c,d),d)}catch(h){if(d&&d.WTF)throw h}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(c,d){var h=d||{};if(+h.codepage>=0&&Pp(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var p=Pi(),x=fg(c,{header:1,raw:!0,cellDates:!0}),v=x[0],b=x.slice(1),N=c["!cols"]||[],_=0,C=0,T=0,A=1;for(_=0;_<v.length;++_){if(((N[_]||{}).DBF||{}).name){v[_]=N[_].DBF.name,++T;continue}if(v[_]!=null){if(++T,typeof v[_]=="number"&&(v[_]=v[_].toString(10)),typeof v[_]!="string")throw new Error("DBF Invalid column name "+v[_]+" |"+typeof v[_]+"|");if(v.indexOf(v[_])!==_){for(C=0;C<1024;++C)if(v.indexOf(v[_]+"_"+C)==-1){v[_]+="_"+C;break}}}}var k=va(c["!ref"]),I=[],B=[],O=[];for(_=0;_<=k.e.c-k.s.c;++_){var D="",F="",M=0,z=[];for(C=0;C<b.length;++C)b[C][_]!=null&&z.push(b[C][_]);if(z.length==0||v[_]==null){I[_]="?";continue}for(C=0;C<z.length;++C){switch(typeof z[C]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=z[C]instanceof Date?"D":"C";break;default:F="C"}M=Math.max(M,String(z[C]).length),D=D&&D!=F?"C":F}M>250&&(M=250),F=((N[_]||{}).DBF||{}).type,F=="C"&&N[_].DBF.len>M&&(M=N[_].DBF.len),D=="B"&&F=="N"&&(D="N",O[_]=N[_].DBF.dec,M=N[_].DBF.len),B[_]=D=="C"||F=="N"?M:i[D]||0,A+=B[_],I[_]=D}var q=p.next(32);for(q.write_shift(4,318902576),q.write_shift(4,b.length),q.write_shift(2,296+32*T),q.write_shift(2,A),_=0;_<4;++_)q.write_shift(4,0);for(q.write_shift(4,0|(+t[WP]||3)<<8),_=0,C=0;_<v.length;++_)if(v[_]!=null){var Y=p.next(32),ae=(v[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Y.write_shift(1,ae,"sbcs"),Y.write_shift(1,I[_]=="?"?"C":I[_],"sbcs"),Y.write_shift(4,C),Y.write_shift(1,B[_]||i[I[_]]||0),Y.write_shift(1,O[_]||0),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(1,0),Y.write_shift(4,0),Y.write_shift(4,0),C+=B[_]||i[I[_]]||0}var je=p.next(264);for(je.write_shift(4,13),_=0;_<65;++_)je.write_shift(4,0);for(_=0;_<b.length;++_){var H=p.next(A);for(H.write_shift(1,0),C=0;C<v.length;++C)if(v[C]!=null)switch(I[C]){case"L":H.write_shift(1,b[_][C]==null?63:b[_][C]?84:70);break;case"B":H.write_shift(8,b[_][C]||0,"f");break;case"N":var Z="0";for(typeof b[_][C]=="number"&&(Z=b[_][C].toFixed(O[C]||0)),T=0;T<B[C]-Z.length;++T)H.write_shift(1,32);H.write_shift(1,Z,"sbcs");break;case"D":b[_][C]?(H.write_shift(4,("0000"+b[_][C].getFullYear()).slice(-4),"sbcs"),H.write_shift(2,("00"+(b[_][C].getMonth()+1)).slice(-2),"sbcs"),H.write_shift(2,("00"+b[_][C].getDate()).slice(-2),"sbcs")):H.write_shift(8,"00000000","sbcs");break;case"C":var G=String(b[_][C]!=null?b[_][C]:"").slice(0,B[C]);for(H.write_shift(1,G,"sbcs"),T=0;T<B[C]-G.length;++T)H.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:n,to_sheet:a,from_sheet:o}}(),fee=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Dn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(v,b){var N=e[b];return typeof N=="number"?pE(N):N},a=function(v,b,N){var _=b.charCodeAt(0)-32<<4|N.charCodeAt(0)-48;return _==59?v:pE(_)};e["|"]=254;function n(v,b){switch(b.type){case"base64":return i(bc(v),b);case"binary":return i(v,b);case"buffer":return i(Dr&&Buffer.isBuffer(v)?v.toString("binary"):l0(v),b);case"array":return i(e1(v),b)}throw new Error("Unrecognized type "+b.type)}function i(v,b){var N=v.split(/[\n\r]+/),_=-1,C=-1,T=0,A=0,k=[],I=[],B=null,O={},D=[],F=[],M=[],z=0,q;for(+b.codepage>=0&&Pp(+b.codepage);T!==N.length;++T){z=0;var Y=N[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),ae=Y.replace(/;;/g,"\0").split(";").map(function(ce){return ce.replace(/\u0000/g,";")}),je=ae[0],H;if(Y.length>0)switch(je){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ae[1].charAt(0)=="P"&&I.push(Y.slice(3).replace(/;;/g,";"));break;case"C":var Z=!1,G=!1,Q=!1,re=!1,le=-1,ye=-1;for(A=1;A<ae.length;++A)switch(ae[A].charAt(0)){case"A":break;case"X":C=parseInt(ae[A].slice(1))-1,G=!0;break;case"Y":for(_=parseInt(ae[A].slice(1))-1,G||(C=0),q=k.length;q<=_;++q)k[q]=[];break;case"K":H=ae[A].slice(1),H.charAt(0)==='"'?H=H.slice(1,H.length-1):H==="TRUE"?H=!0:H==="FALSE"?H=!1:isNaN(mc(H))?isNaN(Op(H).getDate())||(H=yi(H)):(H=mc(H),B!==null&&rI(B)&&(H=oI(H))),Z=!0;break;case"E":re=!0;var W=ute(ae[A].slice(1),{r:_,c:C});k[_][C]=[k[_][C],W];break;case"S":Q=!0,k[_][C]=[k[_][C],"S5S"];break;case"G":break;case"R":le=parseInt(ae[A].slice(1))-1;break;case"C":ye=parseInt(ae[A].slice(1))-1;break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+Y)}if(Z&&(k[_][C]&&k[_][C].length==2?k[_][C][0]=H:k[_][C]=H,B=null),Q){if(re)throw new Error("SYLK shared formula cannot have own formula");var ee=le>-1&&k[le][ye];if(!ee||!ee[1])throw new Error("SYLK shared formula cannot find base");k[_][C][1]=hte(ee[1],{r:_-le,c:C-ye})}break;case"F":var ie=0;for(A=1;A<ae.length;++A)switch(ae[A].charAt(0)){case"X":C=parseInt(ae[A].slice(1))-1,++ie;break;case"Y":for(_=parseInt(ae[A].slice(1))-1,q=k.length;q<=_;++q)k[q]=[];break;case"M":z=parseInt(ae[A].slice(1))/20;break;case"F":break;case"G":break;case"P":B=I[parseInt(ae[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=ae[A].slice(1).split(" "),q=parseInt(M[0],10);q<=parseInt(M[1],10);++q)z=parseInt(M[2],10),F[q-1]=z===0?{hidden:!0}:{wch:z},$_(F[q-1]);break;case"C":C=parseInt(ae[A].slice(1))-1,F[C]||(F[C]={});break;case"R":_=parseInt(ae[A].slice(1))-1,D[_]||(D[_]={}),z>0?(D[_].hpt=z,D[_].hpx=KI(z)):z===0&&(D[_].hidden=!0);break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+Y)}ie<1&&(B=null);break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+Y)}}return D.length>0&&(O["!rows"]=D),F.length>0&&(O["!cols"]=F),b&&b.sheetRows&&(k=k.slice(0,b.sheetRows)),[k,O]}function o(v,b){var N=n(v,b),_=N[0],C=N[1],T=Hf(_,b);return Dn(C).forEach(function(A){T[A]=C[A]}),T}function c(v,b){return Gu(o(v,b),b)}function d(v,b,N,_){var C="C;Y"+(N+1)+";X"+(_+1)+";K";switch(v.t){case"n":C+=v.v||0,v.f&&!v.F&&(C+=";E"+W_(v.f,{r:N,c:_}));break;case"b":C+=v.v?"TRUE":"FALSE";break;case"e":C+=v.w||v.v;break;case"d":C+='"'+(v.w||v.v)+'"';break;case"s":C+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return C}function h(v,b){b.forEach(function(N,_){var C="F;W"+(_+1)+" "+(_+1)+" ";N.hidden?C+="0":(typeof N.width=="number"&&!N.wpx&&(N.wpx=cg(N.width)),typeof N.wpx=="number"&&!N.wch&&(N.wch=dg(N.wpx)),typeof N.wch=="number"&&(C+=Math.round(N.wch))),C.charAt(C.length-1)!=" "&&v.push(C)})}function p(v,b){b.forEach(function(N,_){var C="F;";N.hidden?C+="M0;":N.hpt?C+="M"+20*N.hpt+";":N.hpx&&(C+="M"+20*ug(N.hpx)+";"),C.length>2&&v.push(C+"R"+(_+1))})}function x(v,b){var N=["ID;PWXL;N;E"],_=[],C=va(v["!ref"]),T,A=Array.isArray(v),k=`\r
`;N.push("P;PGeneral"),N.push("F;P0;DG0G8;M255"),v["!cols"]&&h(N,v["!cols"]),v["!rows"]&&p(N,v["!rows"]),N.push("B;Y"+(C.e.r-C.s.r+1)+";X"+(C.e.c-C.s.c+1)+";D"+[C.s.c,C.s.r,C.e.c,C.e.r].join(" "));for(var I=C.s.r;I<=C.e.r;++I)for(var B=C.s.c;B<=C.e.c;++B){var O=Yr({r:I,c:B});T=A?(v[I]||[])[B]:v[O],!(!T||T.v==null&&(!T.f||T.F))&&_.push(d(T,v,I,B))}return N.join(k)+k+_.join(k)+k+"E"+k}return{to_workbook:c,to_sheet:o,from_sheet:x}}(),mee=function(){function e(i,o){switch(o.type){case"base64":return t(bc(i),o);case"binary":return t(i,o);case"buffer":return t(Dr&&Buffer.isBuffer(i)?i.toString("binary"):l0(i),o);case"array":return t(e1(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var c=i.split(`
`),d=-1,h=-1,p=0,x=[];p!==c.length;++p){if(c[p].trim()==="BOT"){x[++d]=[],h=0;continue}if(!(d<0)){var v=c[p].trim().split(","),b=v[0],N=v[1];++p;for(var _=c[p]||"";(_.match(/["]/g)||[]).length&1&&p<c.length-1;)_+=`
`+c[++p];switch(_=_.trim(),+b){case-1:if(_==="BOT"){x[++d]=[],h=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?x[d][h]=!0:_==="FALSE"?x[d][h]=!1:isNaN(mc(N))?isNaN(Op(N).getDate())?x[d][h]=N:x[d][h]=yi(N):x[d][h]=mc(N),++h;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),x[d][h++]=_!==""?_:null;break}if(_==="EOD")break}}return o&&o.sheetRows&&(x=x.slice(0,o.sheetRows)),x}function r(i,o){return Hf(e(i,o),o)}function a(i,o){return Gu(r(i,o),o)}var n=function(){var i=function(d,h,p,x,v){d.push(h),d.push(p+","+x),d.push('"'+v.replace(/"/g,'""')+'"')},o=function(d,h,p,x){d.push(h+","+p),d.push(h==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(d){var h=[],p=va(d["!ref"]),x,v=Array.isArray(d);i(h,"TABLE",0,1,"sheetjs"),i(h,"VECTORS",0,p.e.r-p.s.r+1,""),i(h,"TUPLES",0,p.e.c-p.s.c+1,""),i(h,"DATA",0,0,"");for(var b=p.s.r;b<=p.e.r;++b){o(h,-1,0,"BOT");for(var N=p.s.c;N<=p.e.c;++N){var _=Yr({r:b,c:N});if(x=v?(d[b]||[])[N]:d[_],!x){o(h,1,0,"");continue}switch(x.t){case"n":var C=x.w;!C&&x.v!=null&&(C=x.v),C==null?x.f&&!x.F?o(h,1,0,"="+x.f):o(h,1,0,""):o(h,0,C,"V");break;case"b":o(h,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":o(h,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=Pd(x.z||Ma[14],Ii(yi(x.v)))),o(h,0,x.w,"V");break;default:o(h,1,0,"")}}}o(h,-1,0,"EOD");var T=`\r
`,A=h.join(T);return A}}();return{to_workbook:a,to_sheet:r,from_sheet:n}}(),qI=function(){function e(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(x,v){for(var b=x.split(`
`),N=-1,_=-1,C=0,T=[];C!==b.length;++C){var A=b[C].trim().split(":");if(A[0]==="cell"){var k=wn(A[1]);if(T.length<=k.r)for(N=T.length;N<=k.r;++N)T[N]||(T[N]=[]);switch(N=k.r,_=k.c,A[2]){case"t":T[N][_]=e(A[3]);break;case"v":T[N][_]=+A[3];break;case"vtf":var I=A[A.length-1];case"vtc":switch(A[3]){case"nl":T[N][_]=!!+A[4];break;default:T[N][_]=+A[4];break}A[2]=="vtf"&&(T[N][_]=[T[N][_],I])}}}return v&&v.sheetRows&&(T=T.slice(0,v.sheetRows)),T}function a(x,v){return Hf(r(x,v),v)}function n(x,v){return Gu(a(x,v),v)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function h(x){if(!x||!x["!ref"])return"";for(var v=[],b=[],N,_="",C=so(x["!ref"]),T=Array.isArray(x),A=C.s.r;A<=C.e.r;++A)for(var k=C.s.c;k<=C.e.c;++k)if(_=Yr({r:A,c:k}),N=T?(x[A]||[])[k]:x[_],!(!N||N.v==null||N.t==="z")){switch(b=["cell",_,"t"],N.t){case"s":case"str":b.push(t(N.v));break;case"n":N.f?(b[2]="vtf",b[3]="n",b[4]=N.v,b[5]=t(N.f)):(b[2]="v",b[3]=N.v);break;case"b":b[2]="vt"+(N.f?"f":"c"),b[3]="nl",b[4]=N.v?"1":"0",b[5]=t(N.f||(N.v?"TRUE":"FALSE"));break;case"d":var I=Ii(yi(N.v));b[2]="vtc",b[3]="nd",b[4]=""+I,b[5]=N.w||Pd(N.z||Ma[14],I);break;case"e":continue}v.push(b.join(":"))}return v.push("sheet:c:"+(C.e.c-C.s.c+1)+":r:"+(C.e.r-C.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function p(x){return[i,o,c,o,h(x),d].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:p}}(),pee=function(){function e(p,x,v,b,N){N.raw?x[v][b]=p:p===""||(p==="TRUE"?x[v][b]=!0:p==="FALSE"?x[v][b]=!1:isNaN(mc(p))?isNaN(Op(p).getDate())?x[v][b]=p:x[v][b]=yi(p):x[v][b]=mc(p))}function t(p,x){var v=x||{},b=[];if(!p||p.length===0)return b;for(var N=p.split(/[\r\n]/),_=N.length-1;_>=0&&N[_].length===0;)--_;for(var C=10,T=0,A=0;A<=_;++A)T=N[A].indexOf(" "),T==-1?T=N[A].length:T++,C=Math.max(C,T);for(A=0;A<=_;++A){b[A]=[];var k=0;for(e(N[A].slice(0,C).trim(),b,A,k,v),k=1;k<=(N[A].length-C)/10+1;++k)e(N[A].slice(C+(k-1)*10,C+k*10).trim(),b,A,k,v)}return v.sheetRows&&(b=b.slice(0,v.sheetRows)),b}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(p){for(var x={},v=!1,b=0,N=0;b<p.length;++b)(N=p.charCodeAt(b))==34?v=!v:!v&&N in r&&(x[N]=(x[N]||0)+1);N=[];for(b in x)Object.prototype.hasOwnProperty.call(x,b)&&N.push([x[b],b]);if(!N.length){x=a;for(b in x)Object.prototype.hasOwnProperty.call(x,b)&&N.push([x[b],b])}return N.sort(function(_,C){return _[0]-C[0]||a[_[1]]-a[C[1]]}),r[N.pop()[1]]||44}function i(p,x){var v=x||{},b="",N=v.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(b=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(b=p.charAt(4),p=p.slice(6)):b=n(p.slice(0,1024)):v&&v.FS?b=v.FS:b=n(p.slice(0,1024));var C=0,T=0,A=0,k=0,I=0,B=b.charCodeAt(0),O=!1,D=0,F=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var M=v.dateNF!=null?RQ(v.dateNF):null;function z(){var q=p.slice(k,I),Y={};if(q.charAt(0)=='"'&&q.charAt(q.length-1)=='"'&&(q=q.slice(1,-1).replace(/""/g,'"')),q.length===0)Y.t="z";else if(v.raw)Y.t="s",Y.v=q;else if(q.trim().length===0)Y.t="s",Y.v=q;else if(q.charCodeAt(0)==61)q.charCodeAt(1)==34&&q.charCodeAt(q.length-1)==34?(Y.t="s",Y.v=q.slice(2,-1).replace(/""/g,'"')):fte(q)?(Y.t="n",Y.f=q.slice(1)):(Y.t="s",Y.v=q);else if(q=="TRUE")Y.t="b",Y.v=!0;else if(q=="FALSE")Y.t="b",Y.v=!1;else if(!isNaN(A=mc(q)))Y.t="n",v.cellText!==!1&&(Y.w=q),Y.v=A;else if(!isNaN(Op(q).getDate())||M&&q.match(M)){Y.z=v.dateNF||Ma[14];var ae=0;M&&q.match(M)&&(q=PQ(q,v.dateNF,q.match(M)||[]),ae=1),v.cellDates?(Y.t="d",Y.v=yi(q,ae)):(Y.t="n",Y.v=Ii(yi(q,ae))),v.cellText!==!1&&(Y.w=Pd(Y.z,Y.v instanceof Date?Ii(Y.v):Y.v)),v.cellNF||delete Y.z}else Y.t="s",Y.v=q;if(Y.t=="z"||(v.dense?(N[C]||(N[C]=[]),N[C][T]=Y):N[Yr({c:T,r:C})]=Y),k=I+1,F=p.charCodeAt(k),_.e.c<T&&(_.e.c=T),_.e.r<C&&(_.e.r=C),D==B)++T;else if(T=0,++C,v.sheetRows&&v.sheetRows<=C)return!0}e:for(;I<p.length;++I)switch(D=p.charCodeAt(I)){case 34:F===34&&(O=!O);break;case B:case 10:case 13:if(!O&&z())break e;break}return I-k>0&&z(),N["!ref"]=Za(_),N}function o(p,x){return!(x&&x.PRN)||x.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?i(p,x):Hf(t(p,x),x)}function c(p,x){var v="",b=x.type=="string"?[0,0,0,0]:Sne(p,x);switch(x.type){case"base64":v=bc(p);break;case"binary":v=p;break;case"buffer":x.codepage==65001?v=p.toString("utf8"):x.codepage&&typeof iu<"u"?v=iu.utils.decode(x.codepage,p):v=Dr&&Buffer.isBuffer(p)?p.toString("binary"):l0(p);break;case"array":v=e1(p);break;case"string":v=p;break;default:throw new Error("Unrecognized type "+x.type)}return b[0]==239&&b[1]==187&&b[2]==191?v=Km(v.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?v=Km(v):x.type=="binary"&&typeof iu<"u"&&x.codepage&&(v=iu.utils.decode(x.codepage,iu.utils.encode(28591,v))),v.slice(0,19)=="socialcalc:version:"?qI.to_sheet(x.type=="string"?v:Km(v),x):o(v,x)}function d(p,x){return Gu(c(p,x),x)}function h(p){for(var x=[],v=va(p["!ref"]),b,N=Array.isArray(p),_=v.s.r;_<=v.e.r;++_){for(var C=[],T=v.s.c;T<=v.e.c;++T){var A=Yr({r:_,c:T});if(b=N?(p[_]||[])[T]:p[A],!b||b.v==null){C.push("          ");continue}for(var k=(b.w||(_c(b),b.w)||"").slice(0,10);k.length<10;)k+=" ";C.push(k+(T===0?" ":""))}x.push(C.join(""))}return x.join(`
`)}return{to_workbook:d,to_sheet:c,from_sheet:h}}(),HE=function(){function e(W,ee,ie){if(W){$i(W,W.l||0);for(var ce=ie.Enum||le;W.l<W.length;){var xe=W.read_shift(2),Ce=ce[xe]||ce[65535],me=W.read_shift(2),fe=W.l+me,ve=Ce.f&&Ce.f(W,me,ie);if(W.l=fe,ee(ve,Ce,xe))return}}}function t(W,ee){switch(ee.type){case"base64":return r(Qo(bc(W)),ee);case"binary":return r(Qo(W),ee);case"buffer":case"array":return r(W,ee)}throw"Unsupported type "+ee.type}function r(W,ee){if(!W)return W;var ie=ee||{},ce=ie.dense?[]:{},xe="Sheet1",Ce="",me=0,fe={},ve=[],ne=[],Me={s:{r:0,c:0},e:{r:0,c:0}},Ie=ie.sheetRows||0;if(W[2]==0&&(W[3]==8||W[3]==9)&&W.length>=16&&W[14]==5&&W[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(W[2]==2)ie.Enum=le,e(W,function(ze,we,Le){switch(Le){case 0:ie.vers=ze,ze>=4096&&(ie.qpro=!0);break;case 6:Me=ze;break;case 204:ze&&(Ce=ze);break;case 222:Ce=ze;break;case 15:case 51:ie.qpro||(ze[1].v=ze[1].v.slice(1));case 13:case 14:case 16:Le==14&&(ze[2]&112)==112&&(ze[2]&15)>1&&(ze[2]&15)<15&&(ze[1].z=ie.dateNF||Ma[14],ie.cellDates&&(ze[1].t="d",ze[1].v=oI(ze[1].v))),ie.qpro&&ze[3]>me&&(ce["!ref"]=Za(Me),fe[xe]=ce,ve.push(xe),ce=ie.dense?[]:{},Me={s:{r:0,c:0},e:{r:0,c:0}},me=ze[3],xe=Ce||"Sheet"+(me+1),Ce="");var Nt=ie.dense?(ce[ze[0].r]||[])[ze[0].c]:ce[Yr(ze[0])];if(Nt){Nt.t=ze[1].t,Nt.v=ze[1].v,ze[1].z!=null&&(Nt.z=ze[1].z),ze[1].f!=null&&(Nt.f=ze[1].f);break}ie.dense?(ce[ze[0].r]||(ce[ze[0].r]=[]),ce[ze[0].r][ze[0].c]=ze[1]):ce[Yr(ze[0])]=ze[1];break}},ie);else if(W[2]==26||W[2]==14)ie.Enum=ye,W[2]==14&&(ie.qpro=!0,W.l=0),e(W,function(ze,we,Le){switch(Le){case 204:xe=ze;break;case 22:ze[1].v=ze[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ze[3]>me&&(ce["!ref"]=Za(Me),fe[xe]=ce,ve.push(xe),ce=ie.dense?[]:{},Me={s:{r:0,c:0},e:{r:0,c:0}},me=ze[3],xe="Sheet"+(me+1)),Ie>0&&ze[0].r>=Ie)break;ie.dense?(ce[ze[0].r]||(ce[ze[0].r]=[]),ce[ze[0].r][ze[0].c]=ze[1]):ce[Yr(ze[0])]=ze[1],Me.e.c<ze[0].c&&(Me.e.c=ze[0].c),Me.e.r<ze[0].r&&(Me.e.r=ze[0].r);break;case 27:ze[14e3]&&(ne[ze[14e3][0]]=ze[14e3][1]);break;case 1537:ne[ze[0]]=ze[1],ze[0]==me&&(xe=ze[1]);break}},ie);else throw new Error("Unrecognized LOTUS BOF "+W[2]);if(ce["!ref"]=Za(Me),fe[Ce||xe]=ce,ve.push(Ce||xe),!ne.length)return{SheetNames:ve,Sheets:fe};for(var Be={},ot=[],Se=0;Se<ne.length;++Se)fe[ve[Se]]?(ot.push(ne[Se]||ve[Se]),Be[ne[Se]]=fe[ne[Se]]||fe[ve[Se]]):(ot.push(ne[Se]),Be[ne[Se]]={"!ref":"A1"});return{SheetNames:ot,Sheets:Be}}function a(W,ee){var ie=ee||{};if(+ie.codepage>=0&&Pp(+ie.codepage),ie.type=="string")throw new Error("Cannot write WK1 to JS string");var ce=Pi(),xe=va(W["!ref"]),Ce=Array.isArray(W),me=[];Kt(ce,0,i(1030)),Kt(ce,6,d(xe));for(var fe=Math.min(xe.e.r,8191),ve=xe.s.r;ve<=fe;++ve)for(var ne=On(ve),Me=xe.s.c;Me<=xe.e.c;++Me){ve===xe.s.r&&(me[Me]=ei(Me));var Ie=me[Me]+ne,Be=Ce?(W[ve]||[])[Me]:W[Ie];if(!(!Be||Be.t=="z"))if(Be.t=="n")(Be.v|0)==Be.v&&Be.v>=-32768&&Be.v<=32767?Kt(ce,13,b(ve,Me,Be.v)):Kt(ce,14,_(ve,Me,Be.v));else{var ot=_c(Be);Kt(ce,15,x(ve,Me,ot.slice(0,239)))}}return Kt(ce,1),ce.end()}function n(W,ee){var ie=ee||{};if(+ie.codepage>=0&&Pp(+ie.codepage),ie.type=="string")throw new Error("Cannot write WK3 to JS string");var ce=Pi();Kt(ce,0,o(W));for(var xe=0,Ce=0;xe<W.SheetNames.length;++xe)(W.Sheets[W.SheetNames[xe]]||{})["!ref"]&&Kt(ce,27,re(W.SheetNames[xe],Ce++));var me=0;for(xe=0;xe<W.SheetNames.length;++xe){var fe=W.Sheets[W.SheetNames[xe]];if(!(!fe||!fe["!ref"])){for(var ve=va(fe["!ref"]),ne=Array.isArray(fe),Me=[],Ie=Math.min(ve.e.r,8191),Be=ve.s.r;Be<=Ie;++Be)for(var ot=On(Be),Se=ve.s.c;Se<=ve.e.c;++Se){Be===ve.s.r&&(Me[Se]=ei(Se));var ze=Me[Se]+ot,we=ne?(fe[Be]||[])[Se]:fe[ze];if(!(!we||we.t=="z"))if(we.t=="n")Kt(ce,23,z(Be,Se,me,we.v));else{var Le=_c(we);Kt(ce,22,D(Be,Se,me,Le.slice(0,239)))}}++me}}return Kt(ce,1),ce.end()}function i(W){var ee=yt(2);return ee.write_shift(2,W),ee}function o(W){var ee=yt(26);ee.write_shift(2,4096),ee.write_shift(2,4),ee.write_shift(4,0);for(var ie=0,ce=0,xe=0,Ce=0;Ce<W.SheetNames.length;++Ce){var me=W.SheetNames[Ce],fe=W.Sheets[me];if(!(!fe||!fe["!ref"])){++xe;var ve=so(fe["!ref"]);ie<ve.e.r&&(ie=ve.e.r),ce<ve.e.c&&(ce=ve.e.c)}}return ie>8191&&(ie=8191),ee.write_shift(2,ie),ee.write_shift(1,xe),ee.write_shift(1,ce),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(1,1),ee.write_shift(1,2),ee.write_shift(4,0),ee.write_shift(4,0),ee}function c(W,ee,ie){var ce={s:{c:0,r:0},e:{c:0,r:0}};return ee==8&&ie.qpro?(ce.s.c=W.read_shift(1),W.l++,ce.s.r=W.read_shift(2),ce.e.c=W.read_shift(1),W.l++,ce.e.r=W.read_shift(2),ce):(ce.s.c=W.read_shift(2),ce.s.r=W.read_shift(2),ee==12&&ie.qpro&&(W.l+=2),ce.e.c=W.read_shift(2),ce.e.r=W.read_shift(2),ee==12&&ie.qpro&&(W.l+=2),ce.s.c==65535&&(ce.s.c=ce.e.c=ce.s.r=ce.e.r=0),ce)}function d(W){var ee=yt(8);return ee.write_shift(2,W.s.c),ee.write_shift(2,W.s.r),ee.write_shift(2,W.e.c),ee.write_shift(2,W.e.r),ee}function h(W,ee,ie){var ce=[{c:0,r:0},{t:"n",v:0},0,0];return ie.qpro&&ie.vers!=20768?(ce[0].c=W.read_shift(1),ce[3]=W.read_shift(1),ce[0].r=W.read_shift(2),W.l+=2):(ce[2]=W.read_shift(1),ce[0].c=W.read_shift(2),ce[0].r=W.read_shift(2)),ce}function p(W,ee,ie){var ce=W.l+ee,xe=h(W,ee,ie);if(xe[1].t="s",ie.vers==20768){W.l++;var Ce=W.read_shift(1);return xe[1].v=W.read_shift(Ce,"utf8"),xe}return ie.qpro&&W.l++,xe[1].v=W.read_shift(ce-W.l,"cstr"),xe}function x(W,ee,ie){var ce=yt(7+ie.length);ce.write_shift(1,255),ce.write_shift(2,ee),ce.write_shift(2,W),ce.write_shift(1,39);for(var xe=0;xe<ce.length;++xe){var Ce=ie.charCodeAt(xe);ce.write_shift(1,Ce>=128?95:Ce)}return ce.write_shift(1,0),ce}function v(W,ee,ie){var ce=h(W,ee,ie);return ce[1].v=W.read_shift(2,"i"),ce}function b(W,ee,ie){var ce=yt(7);return ce.write_shift(1,255),ce.write_shift(2,ee),ce.write_shift(2,W),ce.write_shift(2,ie,"i"),ce}function N(W,ee,ie){var ce=h(W,ee,ie);return ce[1].v=W.read_shift(8,"f"),ce}function _(W,ee,ie){var ce=yt(13);return ce.write_shift(1,255),ce.write_shift(2,ee),ce.write_shift(2,W),ce.write_shift(8,ie,"f"),ce}function C(W,ee,ie){var ce=W.l+ee,xe=h(W,ee,ie);if(xe[1].v=W.read_shift(8,"f"),ie.qpro)W.l=ce;else{var Ce=W.read_shift(2);I(W.slice(W.l,W.l+Ce),xe),W.l+=Ce}return xe}function T(W,ee,ie){var ce=ee&32768;return ee&=-32769,ee=(ce?W:0)+(ee>=8192?ee-16384:ee),(ce?"":"$")+(ie?ei(ee):On(ee))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},k=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function I(W,ee){$i(W,0);for(var ie=[],ce=0,xe="",Ce="",me="",fe="";W.l<W.length;){var ve=W[W.l++];switch(ve){case 0:ie.push(W.read_shift(8,"f"));break;case 1:Ce=T(ee[0].c,W.read_shift(2),!0),xe=T(ee[0].r,W.read_shift(2),!1),ie.push(Ce+xe);break;case 2:{var ne=T(ee[0].c,W.read_shift(2),!0),Me=T(ee[0].r,W.read_shift(2),!1);Ce=T(ee[0].c,W.read_shift(2),!0),xe=T(ee[0].r,W.read_shift(2),!1),ie.push(ne+Me+":"+Ce+xe)}break;case 3:if(W.l<W.length){console.error("WK1 premature formula end");return}break;case 4:ie.push("("+ie.pop()+")");break;case 5:ie.push(W.read_shift(2));break;case 6:{for(var Ie="";ve=W[W.l++];)Ie+=String.fromCharCode(ve);ie.push('"'+Ie.replace(/"/g,'""')+'"')}break;case 8:ie.push("-"+ie.pop());break;case 23:ie.push("+"+ie.pop());break;case 22:ie.push("NOT("+ie.pop()+")");break;case 20:case 21:fe=ie.pop(),me=ie.pop(),ie.push(["AND","OR"][ve-20]+"("+me+","+fe+")");break;default:if(ve<32&&k[ve])fe=ie.pop(),me=ie.pop(),ie.push(me+k[ve]+fe);else if(A[ve]){if(ce=A[ve][1],ce==69&&(ce=W[W.l++]),ce>ie.length){console.error("WK1 bad formula parse 0x"+ve.toString(16)+":|"+ie.join("|")+"|");return}var Be=ie.slice(-ce);ie.length-=ce,ie.push(A[ve][0]+"("+Be.join(",")+")")}else return ve<=7?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=24?console.error("WK1 unsupported op "+ve.toString(16)):ve<=30?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=115?console.error("WK1 unsupported function opcode "+ve.toString(16)):console.error("WK1 unrecognized opcode "+ve.toString(16))}}ie.length==1?ee[1].f=""+ie[0]:console.error("WK1 bad formula parse |"+ie.join("|")+"|")}function B(W){var ee=[{c:0,r:0},{t:"n",v:0},0];return ee[0].r=W.read_shift(2),ee[3]=W[W.l++],ee[0].c=W[W.l++],ee}function O(W,ee){var ie=B(W);return ie[1].t="s",ie[1].v=W.read_shift(ee-4,"cstr"),ie}function D(W,ee,ie,ce){var xe=yt(6+ce.length);xe.write_shift(2,W),xe.write_shift(1,ie),xe.write_shift(1,ee),xe.write_shift(1,39);for(var Ce=0;Ce<ce.length;++Ce){var me=ce.charCodeAt(Ce);xe.write_shift(1,me>=128?95:me)}return xe.write_shift(1,0),xe}function F(W,ee){var ie=B(W);ie[1].v=W.read_shift(2);var ce=ie[1].v>>1;if(ie[1].v&1)switch(ce&7){case 0:ce=(ce>>3)*5e3;break;case 1:ce=(ce>>3)*500;break;case 2:ce=(ce>>3)/20;break;case 3:ce=(ce>>3)/200;break;case 4:ce=(ce>>3)/2e3;break;case 5:ce=(ce>>3)/2e4;break;case 6:ce=(ce>>3)/16;break;case 7:ce=(ce>>3)/64;break}return ie[1].v=ce,ie}function M(W,ee){var ie=B(W),ce=W.read_shift(4),xe=W.read_shift(4),Ce=W.read_shift(2);if(Ce==65535)return ce===0&&xe===3221225472?(ie[1].t="e",ie[1].v=15):ce===0&&xe===3489660928?(ie[1].t="e",ie[1].v=42):ie[1].v=0,ie;var me=Ce&32768;return Ce=(Ce&32767)-16446,ie[1].v=(1-me*2)*(xe*Math.pow(2,Ce+32)+ce*Math.pow(2,Ce)),ie}function z(W,ee,ie,ce){var xe=yt(14);if(xe.write_shift(2,W),xe.write_shift(1,ie),xe.write_shift(1,ee),ce==0)return xe.write_shift(4,0),xe.write_shift(4,0),xe.write_shift(2,65535),xe;var Ce=0,me=0,fe=0,ve=0;return ce<0&&(Ce=1,ce=-ce),me=Math.log2(ce)|0,ce/=Math.pow(2,me-31),ve=ce>>>0,ve&2147483648||(ce/=2,++me,ve=ce>>>0),ce-=ve,ve|=2147483648,ve>>>=0,ce*=Math.pow(2,32),fe=ce>>>0,xe.write_shift(4,fe),xe.write_shift(4,ve),me+=16383+(Ce?32768:0),xe.write_shift(2,me),xe}function q(W,ee){var ie=M(W);return W.l+=ee-14,ie}function Y(W,ee){var ie=B(W),ce=W.read_shift(4);return ie[1].v=ce>>6,ie}function ae(W,ee){var ie=B(W),ce=W.read_shift(8,"f");return ie[1].v=ce,ie}function je(W,ee){var ie=ae(W);return W.l+=ee-10,ie}function H(W,ee){return W[W.l+ee-1]==0?W.read_shift(ee,"cstr"):""}function Z(W,ee){var ie=W[W.l++];ie>ee-1&&(ie=ee-1);for(var ce="";ce.length<ie;)ce+=String.fromCharCode(W[W.l++]);return ce}function G(W,ee,ie){if(!(!ie.qpro||ee<21)){var ce=W.read_shift(1);W.l+=17,W.l+=1,W.l+=2;var xe=W.read_shift(ee-21,"cstr");return[ce,xe]}}function Q(W,ee){for(var ie={},ce=W.l+ee;W.l<ce;){var xe=W.read_shift(2);if(xe==14e3){for(ie[xe]=[0,""],ie[xe][0]=W.read_shift(2);W[W.l];)ie[xe][1]+=String.fromCharCode(W[W.l]),W.l++;W.l++}}return ie}function re(W,ee){var ie=yt(5+W.length);ie.write_shift(2,14e3),ie.write_shift(2,ee);for(var ce=0;ce<W.length;++ce){var xe=W.charCodeAt(ce);ie[ie.l++]=xe>127?95:xe}return ie[ie.l++]=0,ie}var le={0:{n:"BOF",f:BI},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:N},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:C},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:H},222:{n:"SHEETNAMELP",f:Z},65535:{n:""}},ye={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:O},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:q},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Y},38:{n:"??"},39:{n:"NUMBER27",f:ae},40:{n:"FORMULA28",f:je},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:H},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:G},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:t}}(),xee=/^\s|\s$|[\t\n\r]/;function WI(e,t){if(!t.bookSST)return"";var r=[Ja];r[r.length]=Ht("sst",null,{xmlns:Wf[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var n=e[a],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(xee)&&(i+=' xml:space="preserve"'),i+=">"+Xr(n.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function gee(e){return[e.read_shift(4),e.read_shift(4)]}function vee(e,t){return t||(t=yt(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var yee=cJ;function wee(e){var t=Pi();At(t,159,vee(e));for(var r=0;r<e.length;++r)At(t,19,yee(e[r]));return At(t,160),t.end()}function bee(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function HI(e){var t=0,r,a=bee(e),n=a.length+1,i,o,c,d,h;for(r=Fu(n),r[0]=a.length,i=1;i!=n;++i)r[i]=a[i-1];for(i=n-1;i>=0;--i)o=r[i],c=t&16384?1:0,d=t<<1&32767,h=c|d,t=h^o;return t^52811}var _ee=function(){function e(n,i){switch(i.type){case"base64":return t(bc(n),i);case"binary":return t(n,i);case"buffer":return t(Dr&&Buffer.isBuffer(n)?n.toString("binary"):l0(n),i);case"array":return t(e1(n),i)}throw new Error("Unrecognized type "+i.type)}function t(n,i){var o=i||{},c=o.dense?[]:{},d=n.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(p,x){Array.isArray(c)&&(c[x]=[]);for(var v=/\\\w+\b/g,b=0,N,_=-1;N=v.exec(p);){switch(N[0]){case"\\cell":var C=p.slice(b,v.lastIndex-N[0].length);if(C[0]==" "&&(C=C.slice(1)),++_,C.length){var T={v:C,t:"s"};Array.isArray(c)?c[x][_]=T:c[Yr({r:x,c:_})]=T}break}b=v.lastIndex}_>h.e.c&&(h.e.c=_)}),c["!ref"]=Za(h),c}function r(n,i){return Gu(e(n,i),i)}function a(n){for(var i=["{\\rtf1\\ansi"],o=va(n["!ref"]),c,d=Array.isArray(n),h=o.s.r;h<=o.e.r;++h){i.push("\\trowd\\trautofit1");for(var p=o.s.c;p<=o.e.c;++p)i.push("\\cellx"+(p+1));for(i.push("\\pard\\intbl"),p=o.s.c;p<=o.e.c;++p){var x=Yr({r:h,c:p});c=d?(n[h]||[])[p]:n[x],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(_c(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function GE(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var jee=6,pc=jee;function cg(e){return Math.floor((e+Math.round(128/pc)/256)*pc)}function dg(e){return Math.floor((e-5)/pc*100+.5)/100}function dw(e){return Math.round((e*pc+5)/pc*256)/256}function $_(e){e.width?(e.wpx=cg(e.width),e.wch=dg(e.wpx),e.MDW=pc):e.wpx?(e.wch=dg(e.wpx),e.width=dw(e.wch),e.MDW=pc):typeof e.wch=="number"&&(e.width=dw(e.wch),e.wpx=cg(e.width),e.MDW=pc),e.customWidth&&delete e.customWidth}var Nee=96,GI=Nee;function ug(e){return e*96/GI}function KI(e){return e*GI/96}function Cee(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=Ht("numFmt",null,{numFmtId:a,formatCode:Xr(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ht("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Eee(e){var t=[];return t[t.length]=Ht("cellXfs",null),e.forEach(function(r){t[t.length]=Ht("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ht("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function XI(e,t){var r=[Ja,Ht("styleSheet",null,{xmlns:Wf[0],"xmlns:vt":vn.vt})],a;return e.SSF&&(a=Cee(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=Eee(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function See(e,t){var r=e.read_shift(2),a=ti(e);return[r,a]}function Tee(e,t,r){r||(r=yt(6+4*t.length)),r.write_shift(2,e),bn(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function Aee(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=xJ(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var i=e.read_shift(2);switch(i===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(a.underline=o);var c=e.read_shift(1);c>0&&(a.family=c);var d=e.read_shift(1);switch(d>0&&(a.charset=d),e.l++,a.color=pJ(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=ti(e),a}function kee(e,t){t||(t=yt(25+4*32)),t.write_shift(2,e.sz*20),gJ(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),og(e.color,t);var a=0;return e.scheme=="major"&&(a=1),e.scheme=="minor"&&(a=2),t.write_shift(1,a),bn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Ree=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],gv,Pee=ql;function KE(e,t){t||(t=yt(4*3+8*7+16*1)),gv||(gv=R_(Ree));var r=gv[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(og({auto:1},t),og({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Iee(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}function YI(e,t,r){r||(r=yt(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function bm(e,t){return t||(t=yt(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Oee=ql;function Dee(e,t){return t||(t=yt(51)),t.write_shift(1,0),bm(null,t),bm(null,t),bm(null,t),bm(null,t),bm(null,t),t.length>t.l?t.slice(0,t.l):t}function Mee(e,t){return t||(t=yt(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),ig(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Lee(e,t,r){var a=yt(2052);return a.write_shift(4,e),ig(t,a),ig(r,a),a.length>a.l?a.slice(0,a.l):a}function Fee(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&++r}),r!=0&&(At(e,615,rl(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&At(e,44,Tee(n,t[n]))}),At(e,616))}}function Bee(e){var t=1;At(e,611,rl(t)),At(e,43,kee({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),At(e,612)}function Vee(e){var t=2;At(e,603,rl(t)),At(e,45,KE({patternType:"none"})),At(e,45,KE({patternType:"gray125"})),At(e,604)}function Uee(e){var t=1;At(e,613,rl(t)),At(e,46,Dee()),At(e,614)}function zee(e){var t=1;At(e,626,rl(t)),At(e,47,YI({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),At(e,627)}function $ee(e,t){At(e,617,rl(t.length)),t.forEach(function(r){At(e,47,YI(r,0))}),At(e,618)}function qee(e){var t=1;At(e,619,rl(t)),At(e,48,Mee({xfId:0,builtinId:0,name:"Normal"})),At(e,620)}function Wee(e){var t=0;At(e,505,rl(t)),At(e,506)}function Hee(e){var t=0;At(e,508,Lee(t,"TableStyleMedium9","PivotStyleMedium4")),At(e,509)}function Gee(e,t){var r=Pi();return At(r,278),Fee(r,e.SSF),Bee(r),Vee(r),Uee(r),zee(r),$ee(r,t.cellXfs),qee(r),Wee(r),Hee(r),At(r,279),r.end()}function ZI(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Ja];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Kee(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ti(e)}}function Xee(e){var t=yt(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),bn(e.name,t),t.slice(0,t.l)}function Yee(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Zee(e){var t=yt(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Qee(e,t){var r=yt(8+2*t.length);return r.write_shift(4,e),bn(t,r),r.slice(0,r.l)}function Jee(e){return e.l+=4,e.read_shift(4)!=0}function ete(e,t){var r=yt(8);return r.write_shift(4,e),r.write_shift(4,1),r}function tte(){var e=Pi();return At(e,332),At(e,334,rl(1)),At(e,335,Xee({name:"XLDAPR",version:12e4,flags:3496657072})),At(e,336),At(e,339,Qee(1,"XLDAPR")),At(e,52),At(e,35,rl(514)),At(e,4096,rl(0)),At(e,4097,po(1)),At(e,36),At(e,53),At(e,340),At(e,337,ete(1)),At(e,51,Zee([[1,0]])),At(e,338),At(e,333),e.end()}function QI(){var e=[Ja];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function ste(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Yr(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}var Oh=1024;function JI(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[Ht("xml",null,{"xmlns:v":Wi.v,"xmlns:o":Wi.o,"xmlns:x":Wi.x,"xmlns:mv":Wi.mv}).replace(/\/>/,">"),Ht("o:shapelayout",Ht("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ht("v:shapetype",[Ht("v:stroke",null,{joinstyle:"miter"}),Ht("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];Oh<e*1e3;)Oh+=1e3;return t.forEach(function(i){var o=wn(i[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var d=c.type=="gradient"?Ht("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=Ht("v:fill",d,c),p={on:"t",obscured:"t"};++Oh,n=n.concat(["<v:shape"+Mp({id:"_x0000_s"+Oh,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,Ht("v:shadow",null,p),Ht("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Pn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Pn("x:AutoFill","False"),Pn("x:Row",String(o.r)),Pn("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function e5(e){var t=[Ja,Ht("comments",null,{xmlns:Wf[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(n){var i=Xr(n.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var n=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(d){d.a&&(n=r.indexOf(Xr(d.a))),i.push(d.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),i.length<=1)t.push(Pn("t",Xr(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,c=1;c<i.length;++c)o+=`Reply:
    `+i[c]+`
`;t.push(Pn("t",Xr(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function rte(e,t,r){var a=[Ja,Ht("ThreadedComments",null,{xmlns:vn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var i="";(n[1]||[]).forEach(function(o,c){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var d={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?i=d.id:d.parentId=i,o.ID=d.id,o.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),a.push(Ht("threadedComment",Pn("text",o.t||""),d))})}),a.push("</ThreadedComments>"),a.join("")}function ate(e){var t=[Ja,Ht("personList",null,{xmlns:vn.TCMNT,"xmlns:x":Wf[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(Ht("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function nte(e){var t={};t.iauthor=e.read_shift(4);var r=Zu(e);return t.rfx=r.s,t.ref=Yr(r.s),e.l+=16,t}function ite(e,t){return t==null&&(t=yt(36)),t.write_shift(4,e[1].iauthor),Gf(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var ote=ti;function lte(e){return bn(e.slice(0,54))}function cte(e){var t=Pi(),r=[];return At(t,628),At(t,630),e.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),At(t,632,lte(n.a)))})}),At(t,631),At(t,633),e.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var i={s:wn(a[0]),e:wn(a[0])};At(t,635,ite([i,n])),n.t&&n.t.length>0&&At(t,637,uJ(n)),At(t,636),delete n.iauthor})}),At(t,634),At(t,629),t.end()}function dte(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&Qr.utils.cfb_add(e,n,t.FileIndex[a].content)}})}var t5=["xlsb","xlsm","xlam","biff8","xla"],ute=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,n,i,o){var c=!1,d=!1;i.length==0?d=!0:i.charAt(0)=="["&&(d=!0,i=i.slice(1,-1)),o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1));var h=i.length>0?parseInt(i,10)|0:0,p=o.length>0?parseInt(o,10)|0:0;return c?p+=t.c:--p,d?h+=t.r:--h,n+(c?"":"$")+ei(p)+(d?"":"$")+On(h)}return function(n,i){return t=i,n.replace(e,r)}}(),q_=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,W_=function(){return function(t,r){return t.replace(q_,function(a,n,i,o,c,d){var h=F_(o)-(i?0:r.c),p=L_(d)-(c?0:r.r),x=p==0?"":c?p+1:"["+p+"]",v=h==0?"":i?h+1:"["+h+"]";return n+"R"+x+"C"+v})}}();function hte(e,t){return e.replace(q_,function(r,a,n,i,o,c){return a+(n=="$"?n+i:ei(F_(i)+t.c))+(o=="$"?o+c:On(L_(c)+t.r))})}function fte(e){return e.length!=1}function Wa(e){e.l+=1}function Id(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function s5(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return r5(e);r.biff==12&&(a=4)}var n=e.read_shift(a),i=e.read_shift(a),o=Id(e),c=Id(e);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function r5(e){var t=Id(e),r=Id(e),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function mte(e,t,r){if(r.biff<8)return r5(e);var a=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),i=Id(e),o=Id(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function a5(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return pte(e);var a=e.read_shift(r&&r.biff==12?4:2),n=Id(e);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function pte(e){var t=Id(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function xte(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function gte(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return vte(e);var n=e.read_shift(a>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;n>524287;)n-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:o,rRel:c}}function vte(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:a}}function yte(e,t,r){var a=(e[e.l++]&96)>>5,n=s5(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function wte(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=s5(e,i,r);return[a,n,o]}function bte(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function _te(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[a,n]}function jte(e,t,r){var a=(e[e.l++]&96)>>5,n=mte(e,t-1,r);return[a,n]}function Nte(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function XE(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Cte(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),n=[],i=0;i<=a;++i)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function Ete(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function Ste(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function Tte(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Ate(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function n5(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function kte(e){return e.read_shift(2),n5(e)}function Rte(e){return e.read_shift(2),n5(e)}function Pte(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=a5(e,0,r);return[a,n]}function Ite(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=gte(e,0,r);return[a,n]}function Ote(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=a5(e,0,r);return[a,n,i]}function Dte(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[Dse[n],l5[n],a]}function Mte(e,t,r){var a=e[e.l++],n=e.read_shift(1),i=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:Lte(e);return[n,(i[0]===0?l5:Ose)[i[1]]]}function Lte(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Fte(e,t,r){e.l+=r&&r.biff==2?3:4}function Bte(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function Vte(e){return e.l++,u0[e.read_shift(1)]}function Ute(e){return e.l++,e.read_shift(2)}function zte(e){return e.l++,e.read_shift(1)!==0}function $te(e){return e.l++,Kf(e)}function qte(e,t,r){return e.l++,UI(e,t-1,r)}function Wte(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=OJ(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=u0[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Kf(e);break;case 2:r[1]=FJ(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Hte(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),n=[],i=0;i!=a;++i)n.push((r.biff==12?Zu:UJ)(e));return n}function Gte(e,t,r){var a=0,n=0;r.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var i=0,o=[];i!=a&&(o[i]=[]);++i)for(var c=0;c!=n;++c)o[i][c]=Wte(e,r.biff);return o}function Kte(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,i=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,i]}function Xte(e,t,r){if(r.biff==5)return Yte(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),i=e.read_shift(4);return[a,n,i]}function Yte(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function Zte(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function Qte(e,t,r){var a=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function Jte(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function ese(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[a,n]}var tse=ql,sse=ql,rse=ql;function h0(e,t,r){return e.l+=2,[xte(e)]}function H_(e){return e.l+=6,[]}var ase=h0,nse=H_,ise=H_,ose=h0;function i5(e){return e.l+=2,[BI(e),e.read_shift(2)&1]}var lse=h0,cse=i5,dse=H_,use=h0,hse=h0,fse=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function mse(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),i=e.read_shift(2),o=fse[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:a,c:n,C:i}}function pse(e){return e.l+=2,[e.read_shift(4)]}function xse(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function gse(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function vse(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function yse(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function wse(e){return e.l+=4,[0,0]}var YE={1:{n:"PtgExp",f:Bte},2:{n:"PtgTbl",f:rse},3:{n:"PtgAdd",f:Wa},4:{n:"PtgSub",f:Wa},5:{n:"PtgMul",f:Wa},6:{n:"PtgDiv",f:Wa},7:{n:"PtgPower",f:Wa},8:{n:"PtgConcat",f:Wa},9:{n:"PtgLt",f:Wa},10:{n:"PtgLe",f:Wa},11:{n:"PtgEq",f:Wa},12:{n:"PtgGe",f:Wa},13:{n:"PtgGt",f:Wa},14:{n:"PtgNe",f:Wa},15:{n:"PtgIsect",f:Wa},16:{n:"PtgUnion",f:Wa},17:{n:"PtgRange",f:Wa},18:{n:"PtgUplus",f:Wa},19:{n:"PtgUminus",f:Wa},20:{n:"PtgPercent",f:Wa},21:{n:"PtgParen",f:Wa},22:{n:"PtgMissArg",f:Wa},23:{n:"PtgStr",f:qte},26:{n:"PtgSheet",f:xse},27:{n:"PtgEndSheet",f:gse},28:{n:"PtgErr",f:Vte},29:{n:"PtgBool",f:zte},30:{n:"PtgInt",f:Ute},31:{n:"PtgNum",f:$te},32:{n:"PtgArray",f:Nte},33:{n:"PtgFunc",f:Dte},34:{n:"PtgFuncVar",f:Mte},35:{n:"PtgName",f:Kte},36:{n:"PtgRef",f:Pte},37:{n:"PtgArea",f:yte},38:{n:"PtgMemArea",f:Zte},39:{n:"PtgMemErr",f:tse},40:{n:"PtgMemNoMem",f:sse},41:{n:"PtgMemFunc",f:Qte},42:{n:"PtgRefErr",f:Jte},43:{n:"PtgAreaErr",f:bte},44:{n:"PtgRefN",f:Ite},45:{n:"PtgAreaN",f:jte},46:{n:"PtgMemAreaN",f:vse},47:{n:"PtgMemNoMemN",f:yse},57:{n:"PtgNameX",f:Xte},58:{n:"PtgRef3d",f:Ote},59:{n:"PtgArea3d",f:wte},60:{n:"PtgRefErr3d",f:ese},61:{n:"PtgAreaErr3d",f:_te},255:{}},bse={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},_se={1:{n:"PtgElfLel",f:i5},2:{n:"PtgElfRw",f:use},3:{n:"PtgElfCol",f:ase},6:{n:"PtgElfRwV",f:hse},7:{n:"PtgElfColV",f:ose},10:{n:"PtgElfRadical",f:lse},11:{n:"PtgElfRadicalS",f:dse},13:{n:"PtgElfColS",f:nse},15:{n:"PtgElfColSV",f:ise},16:{n:"PtgElfRadicalLel",f:cse},25:{n:"PtgList",f:mse},29:{n:"PtgSxName",f:pse},255:{}},jse={0:{n:"PtgAttrNoop",f:wse},1:{n:"PtgAttrSemi",f:Ate},2:{n:"PtgAttrIf",f:Ste},4:{n:"PtgAttrChoose",f:Cte},8:{n:"PtgAttrGoto",f:Ete},16:{n:"PtgAttrSum",f:Fte},32:{n:"PtgAttrBaxcel",f:XE},33:{n:"PtgAttrBaxcel",f:XE},64:{n:"PtgAttrSpace",f:kte},65:{n:"PtgAttrSpaceSemi",f:Rte},128:{n:"PtgAttrIfError",f:Tte},255:{}};function Nse(e,t,r,a){if(a.biff<8)return ql(e,t);for(var n=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=Gte(e,0,a),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=Hte(e,r[o][1],a),i.push(r[o][2]);break;case"PtgExp":a&&a.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=n-e.l,t!==0&&i.push(ql(e,t)),i}function Cse(e,t,r){for(var a=e.l+t,n,i,o=[];a!=e.l;)t=a-e.l,i=e[e.l],n=YE[i]||YE[bse[i]],(i===24||i===25)&&(n=(i===24?_se:jse)[e[e.l+1]]),!n||!n.f?ql(e,t):o.push([n.n,n.f(e,t,r)]);return o}function Ese(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],i=0;i<a.length;++i){var o=a[i];if(o)switch(o[0]){case 2:n.push('"'+o[1].replace(/"/g,'""')+'"');break;default:n.push(o[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var Sse={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Tse(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function o5(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function ZE(e,t,r){var a=o5(e,t,r);return a=="#REF"?a:Tse(a,r)}function Nf(e,t,r,a,n){var i=n&&n.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},c=[],d,h,p,x=0,v=0,b,N="";if(!e[0]||!e[0][0])return"";for(var _=-1,C="",T=0,A=e[0].length;T<A;++T){var k=e[0][T];switch(k[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=c.pop(),h=c.pop(),_>=0){switch(e[0][_][1][0]){case 0:C=Oa(" ",e[0][_][1][1]);break;case 1:C=Oa("\r",e[0][_][1][1]);break;default:if(C="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}h=h+C,_=-1}c.push(h+Sse[k[0]]+d);break;case"PtgIsect":d=c.pop(),h=c.pop(),c.push(h+" "+d);break;case"PtgUnion":d=c.pop(),h=c.pop(),c.push(h+","+d);break;case"PtgRange":d=c.pop(),h=c.pop(),c.push(h+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=Ym(k[1][1],o,n),c.push(Zm(p,i));break;case"PtgRefN":p=r?Ym(k[1][1],r,n):k[1][1],c.push(Zm(p,i));break;case"PtgRef3d":x=k[1][1],p=Ym(k[1][2],o,n),N=ZE(a,x,n),c.push(N+"!"+Zm(p,i));break;case"PtgFunc":case"PtgFuncVar":var I=k[1][0],B=k[1][1];I||(I=0),I&=127;var O=I==0?[]:c.slice(-I);c.length-=I,B==="User"&&(B=O.shift()),c.push(B+"("+O.join(",")+")");break;case"PtgBool":c.push(k[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(k[1]);break;case"PtgNum":c.push(String(k[1]));break;case"PtgStr":c.push('"'+k[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(k[1]);break;case"PtgAreaN":b=DE(k[1][1],r?{s:r}:o,n),c.push(pv(b,n));break;case"PtgArea":b=DE(k[1][1],o,n),c.push(pv(b,n));break;case"PtgArea3d":x=k[1][1],b=k[1][2],N=ZE(a,x,n),c.push(N+"!"+pv(b,n));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=k[1][2];var D=(a.names||[])[v-1]||(a[0]||[])[v],F=D?D.Name:"SH33TJSNAME"+String(v);F&&F.slice(0,6)=="_xlfn."&&!n.xlfn&&(F=F.slice(6)),c.push(F);break;case"PtgNameX":var M=k[1][1];v=k[1][2];var z;if(n.biff<=5)M<0&&(M=-M),a[M]&&(z=a[M][v]);else{var q="";if(((a[M]||[])[0]||[])[0]==14849||(((a[M]||[])[0]||[])[0]==1025?a[M][v]&&a[M][v].itab>0&&(q=a.SheetNames[a[M][v].itab-1]+"!"):q=a.SheetNames[v-1]+"!"),a[M]&&a[M][v])q+=a[M][v].Name;else if(a[0]&&a[0][v])q+=a[0][v].Name;else{var Y=(o5(a,M,n)||"").split(";;");Y[v-1]?q=Y[v-1]:q+="SH33TJSERRX"}c.push(q);break}z||(z={Name:"SH33TJSERRY"}),c.push(z.Name);break;case"PtgParen":var ae="(",je=")";if(_>=0){switch(C="",e[0][_][1][0]){case 2:ae=Oa(" ",e[0][_][1][1])+ae;break;case 3:ae=Oa("\r",e[0][_][1][1])+ae;break;case 4:je=Oa(" ",e[0][_][1][1])+je;break;case 5:je=Oa("\r",e[0][_][1][1])+je;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}_=-1}c.push(ae+c.pop()+je);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":p={c:k[1][1],r:k[1][0]};var H={c:r.c,r:r.r};if(a.sharedf[Yr(p)]){var Z=a.sharedf[Yr(p)];c.push(Nf(Z,o,H,a,n))}else{var G=!1;for(d=0;d!=a.arrayf.length;++d)if(h=a.arrayf[d],!(p.c<h[0].s.c||p.c>h[0].e.c)&&!(p.r<h[0].s.r||p.r>h[0].e.r)){c.push(Nf(h[1],o,H,a,n)),G=!0;break}G||c.push(k[1])}break;case"PtgArray":c.push("{"+Ese(k[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+k[1].idx+"[#"+k[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(k));default:throw new Error("Unrecognized Formula Token: "+String(k))}var Q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&_>=0&&Q.indexOf(e[0][T][0])==-1){k=e[0][_];var re=!0;switch(k[1][0]){case 4:re=!1;case 0:C=Oa(" ",k[1][1]);break;case 5:re=!1;case 1:C=Oa("\r",k[1][1]);break;default:if(C="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+k[1][0])}c.push((re?C:"")+c.pop()+(re?"":C)),_=-1}}if(c.length>1&&n.WTF)throw new Error("bad formula stack");return c[0]}function Ase(e){if(e==null){var t=yt(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Bu(e);return Bu(0)}function kse(e,t,r,a,n){var i=Vu(t,r,n),o=Ase(e.v),c=yt(6),d=33;c.write_shift(2,d),c.write_shift(4,0);for(var h=yt(e.bf.length),p=0;p<e.bf.length;++p)h[p]=e.bf[p];var x=Rn([i,o,c,h]);return x}function t1(e,t,r){var a=e.read_shift(4),n=Cse(e,a,r),i=e.read_shift(4),o=i>0?Nse(e,i,n,r):null;return[n,o]}var Rse=t1,s1=t1,Pse=t1,Ise=t1,Ose={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},l5={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Dse={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Mse(e){var t="of:="+e.replace(q_,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Lse(e){return e.replace(/\./,"!")}var Qm=typeof Map<"u";function G_(e,t,r){var a=0,n=e.length;if(r){if(Qm?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Qm?r.get(t):r[t];a<i.length;++a)if(e[i[a]].t===t)return e.Count++,i[a]}}else for(;a<n;++a)if(e[a].t===t)return e.Count++,a;return e[n]={t},e.Count++,e.Unique++,r&&(Qm?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function r1(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(pc=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=dg(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=dw(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function c5(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ud(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],n=60,i=e.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){aI(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=a=n;break}}for(n=0;n!=i;++n)if(e[n].numFmtId===a)return n;return e[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function Fse(e,t,r){if(e&&e["!ref"]){var a=va(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Bse(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Za(e[r])+'"/>';return t+"</mergeCells>"}function Vse(e,t,r,a,n){var i=!1,o={},c=null;if(a.bookType!=="xlsx"&&t.vbaraw){var d=t.SheetNames[r];try{t.Workbook&&(d=t.Workbook.Sheets[r].CodeName||d)}catch{}i=!0,o.codeName=Dp(Xr(d))}if(e&&e["!outline"]){var h={summaryBelow:1,summaryRight:1};e["!outline"].above&&(h.summaryBelow=0),e["!outline"].left&&(h.summaryRight=0),c=(c||"")+Ht("outlinePr",null,h)}!i&&!c||(n[n.length]=Ht("sheetPr",c,o))}var Use=["objects","scenarios","selectLockedCells","selectUnlockedCells"],zse=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function $se(e){var t={sheet:1};return Use.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),zse.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=HI(e.password).toString(16).toUpperCase()),Ht("sheetProtection",null,t)}function qse(e){return c5(e),Ht("pageMargins",null,e)}function Wse(e,t){for(var r=["<cols>"],a,n=0;n!=t.length;++n)(a=t[n])&&(r[r.length]=Ht("col",null,r1(n,a)));return r[r.length]="</cols>",r.join("")}function Hse(e,t,r,a){var n=typeof e.ref=="string"?e.ref:Za(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=so(n);o.s.r==o.e.r&&(o.e.r=so(t["!ref"]).e.r,n=Za(o));for(var c=0;c<i.length;++c){var d=i[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),Ht("autoFilter",null,{ref:n})}function Gse(e,t,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Ht("sheetViews",Ht("sheetView",null,n),{})}function Kse(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",i=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=u0[e.v];break;case"d":a&&a.cellDates?n=yi(e.v,-1).toISOString():(e=Oi(e),e.t="n",n=""+(e.v=Ii(yi(e.v)))),typeof e.z>"u"&&(e.z=Ma[14]);break;default:n=e.v;break}var c=Pn("v",Xr(n)),d={r:t},h=Ud(a.cellXfs,e,a);switch(h!==0&&(d.s=h),e.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){c=Pn("v",""+G_(a.Strings,e.v,a.revStrings)),d.t="s";break}d.t="str";break}if(e.t!=i&&(e.t=i,e.v=o),typeof e.f=="string"&&e.f){var p=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;c=Ht("f",Xr(e.f),p)+(e.v!=null?c:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(d.cm=1),Ht("c",c,d)}function Xse(e,t,r,a){var n=[],i=[],o=va(e["!ref"]),c="",d,h="",p=[],x=0,v=0,b=e["!rows"],N=Array.isArray(e),_={r:h},C,T=-1;for(v=o.s.c;v<=o.e.c;++v)p[v]=ei(v);for(x=o.s.r;x<=o.e.r;++x){for(i=[],h=On(x),v=o.s.c;v<=o.e.c;++v){d=p[v]+h;var A=N?(e[x]||[])[v]:e[d];A!==void 0&&(c=Kse(A,d,e,t))!=null&&i.push(c)}(i.length>0||b&&b[x])&&(_={r:h},b&&b[x]&&(C=b[x],C.hidden&&(_.hidden=1),T=-1,C.hpx?T=ug(C.hpx):C.hpt&&(T=C.hpt),T>-1&&(_.ht=T,_.customHeight=1),C.level&&(_.outlineLevel=C.level)),n[n.length]=Ht("row",i.join(""),_))}if(b)for(;x<b.length;++x)b&&b[x]&&(_={r:x+1},C=b[x],C.hidden&&(_.hidden=1),T=-1,C.hpx?T=ug(C.hpx):C.hpt&&(T=C.hpt),T>-1&&(_.ht=T,_.customHeight=1),C.level&&(_.outlineLevel=C.level),n[n.length]=Ht("row","",_));return n.join("")}function d5(e,t,r,a){var n=[Ja,Ht("worksheet",null,{xmlns:Wf[0],"xmlns:r":vn.r})],i=r.SheetNames[e],o=0,c="",d=r.Sheets[i];d==null&&(d={});var h=d["!ref"]||"A1",p=va(h);if(p.e.c>16383||p.e.r>1048575){if(t.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),h=Za(p)}a||(a={}),d["!comments"]=[];var x=[];Vse(d,r,e,t,n),n[n.length]=Ht("dimension",null,{ref:h}),n[n.length]=Gse(d,t,e,r),t.sheetFormat&&(n[n.length]=Ht("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(n[n.length]=Wse(d,d["!cols"])),n[o=n.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(c=Xse(d,t),c.length>0&&(n[n.length]=c)),n.length>o+1&&(n[n.length]="</sheetData>",n[o]=n[o].replace("/>",">")),d["!protect"]&&(n[n.length]=$se(d["!protect"])),d["!autofilter"]!=null&&(n[n.length]=Hse(d["!autofilter"],d,r,e)),d["!merges"]!=null&&d["!merges"].length>0&&(n[n.length]=Bse(d["!merges"]));var v=-1,b,N=-1;return d["!links"].length>0&&(n[n.length]="<hyperlinks>",d["!links"].forEach(function(_){_[1].Target&&(b={ref:_[0]},_[1].Target.charAt(0)!="#"&&(N=Gr(a,-1,Xr(_[1].Target).replace(/#.*$/,""),Rr.HLINK),b["r:id"]="rId"+N),(v=_[1].Target.indexOf("#"))>-1&&(b.location=Xr(_[1].Target.slice(v+1))),_[1].Tooltip&&(b.tooltip=Xr(_[1].Tooltip)),n[n.length]=Ht("hyperlink",null,b))}),n[n.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(n[n.length]=qse(d["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=Pn("ignoredErrors",Ht("ignoredError",null,{numberStoredAsText:1,sqref:h}))),x.length>0&&(N=Gr(a,-1,"../drawings/drawing"+(e+1)+".xml",Rr.DRAW),n[n.length]=Ht("drawing",null,{"r:id":"rId"+N}),d["!drawing"]=x),d["!comments"].length>0&&(N=Gr(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Rr.VML),n[n.length]=Ht("legacyDrawing",null,{"r:id":"rId"+N}),d["!legacy"]=N),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function Yse(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=a,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=n/20),r}function Zse(e,t,r){var a=yt(145),n=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var i=320;n.hpx?i=ug(n.hpx)*20:n.hpt&&(i=n.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var o=0;n.level&&(o|=n.level),n.hidden&&(o|=16),(n.hpx||n.hpt)&&(o|=32),a.write_shift(1,o),a.write_shift(1,0);var c=0,d=a.l;a.l+=4;for(var h={r:e,c:0},p=0;p<16;++p)if(!(t.s.c>p+1<<10||t.e.c<p<<10)){for(var x=-1,v=-1,b=p<<10;b<p+1<<10;++b){h.c=b;var N=Array.isArray(r)?(r[h.r]||[])[h.c]:r[Yr(h)];N&&(x<0&&(x=b),v=b)}x<0||(++c,a.write_shift(4,x),a.write_shift(4,v))}var _=a.l;return a.l=d,a.write_shift(4,c),a.l=_,a.length>a.l?a.slice(0,a.l):a}function Qse(e,t,r,a){var n=Zse(a,r,t);(n.length>17||(t["!rows"]||[])[a])&&At(e,0,n)}var Jse=Zu,ere=Gf;function tre(){}function sre(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=hJ(e),r}function rre(e,t,r){r==null&&(r=yt(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return og({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),CI(e,r),r.slice(0,r.l)}function are(e){var t=ko(e);return[t]}function nre(e,t,r){return r==null&&(r=yt(8)),Ku(t,r)}function ire(e){var t=Xu(e);return[t]}function ore(e,t,r){return r==null&&(r=yt(4)),Yu(t,r)}function lre(e){var t=ko(e),r=e.read_shift(1);return[t,r,"b"]}function cre(e,t,r){return r==null&&(r=yt(9)),Ku(t,r),r.write_shift(1,e.v?1:0),r}function dre(e){var t=Xu(e),r=e.read_shift(1);return[t,r,"b"]}function ure(e,t,r){return r==null&&(r=yt(5)),Yu(t,r),r.write_shift(1,e.v?1:0),r}function hre(e){var t=ko(e),r=e.read_shift(1);return[t,r,"e"]}function fre(e,t,r){return r==null&&(r=yt(9)),Ku(t,r),r.write_shift(1,e.v),r}function mre(e){var t=Xu(e),r=e.read_shift(1);return[t,r,"e"]}function pre(e,t,r){return r==null&&(r=yt(8)),Yu(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function xre(e){var t=ko(e),r=e.read_shift(4);return[t,r,"s"]}function gre(e,t,r){return r==null&&(r=yt(12)),Ku(t,r),r.write_shift(4,t.v),r}function vre(e){var t=Xu(e),r=e.read_shift(4);return[t,r,"s"]}function yre(e,t,r){return r==null&&(r=yt(8)),Yu(t,r),r.write_shift(4,t.v),r}function wre(e){var t=ko(e),r=Kf(e);return[t,r,"n"]}function bre(e,t,r){return r==null&&(r=yt(16)),Ku(t,r),Bu(e.v,r),r}function _re(e){var t=Xu(e),r=Kf(e);return[t,r,"n"]}function jre(e,t,r){return r==null&&(r=yt(12)),Yu(t,r),Bu(e.v,r),r}function Nre(e){var t=ko(e),r=EI(e);return[t,r,"n"]}function Cre(e,t,r){return r==null&&(r=yt(12)),Ku(t,r),SI(e.v,r),r}function Ere(e){var t=Xu(e),r=EI(e);return[t,r,"n"]}function Sre(e,t,r){return r==null&&(r=yt(8)),Yu(t,r),SI(e.v,r),r}function Tre(e){var t=ko(e),r=B_(e);return[t,r,"is"]}function Are(e){var t=ko(e),r=ti(e);return[t,r,"str"]}function kre(e,t,r){return r==null&&(r=yt(12+4*e.v.length)),Ku(t,r),bn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Rre(e){var t=Xu(e),r=ti(e);return[t,r,"str"]}function Pre(e,t,r){return r==null&&(r=yt(8+4*e.v.length)),Yu(t,r),bn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Ire(e,t,r){var a=e.l+t,n=ko(e);n.r=r["!row"];var i=e.read_shift(1),o=[n,i,"b"];if(r.cellFormula){e.l+=2;var c=s1(e,a-e.l,r);o[3]=Nf(c,null,n,r.supbooks,r)}else e.l=a;return o}function Ore(e,t,r){var a=e.l+t,n=ko(e);n.r=r["!row"];var i=e.read_shift(1),o=[n,i,"e"];if(r.cellFormula){e.l+=2;var c=s1(e,a-e.l,r);o[3]=Nf(c,null,n,r.supbooks,r)}else e.l=a;return o}function Dre(e,t,r){var a=e.l+t,n=ko(e);n.r=r["!row"];var i=Kf(e),o=[n,i,"n"];if(r.cellFormula){e.l+=2;var c=s1(e,a-e.l,r);o[3]=Nf(c,null,n,r.supbooks,r)}else e.l=a;return o}function Mre(e,t,r){var a=e.l+t,n=ko(e);n.r=r["!row"];var i=ti(e),o=[n,i,"str"];if(r.cellFormula){e.l+=2;var c=s1(e,a-e.l,r);o[3]=Nf(c,null,n,r.supbooks,r)}else e.l=a;return o}var Lre=Zu,Fre=Gf;function Bre(e,t){return t==null&&(t=yt(4)),t.write_shift(4,e),t}function Vre(e,t){var r=e.l+t,a=Zu(e),n=V_(e),i=ti(e),o=ti(e),c=ti(e);e.l=r;var d={rfx:a,relId:n,loc:i,display:c};return o&&(d.Tooltip=o),d}function Ure(e,t){var r=yt(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Gf({s:wn(e[0]),e:wn(e[0])},r),U_("rId"+t,r);var a=e[1].Target.indexOf("#"),n=a==-1?"":e[1].Target.slice(a+1);return bn(n||"",r),bn(e[1].Tooltip||"",r),bn("",r),r.slice(0,r.l)}function zre(){}function $re(e,t,r){var a=e.l+t,n=TI(e),i=e.read_shift(1),o=[n];if(o[2]=i,r.cellFormula){var c=Rse(e,a-e.l,r);o[1]=c}else e.l=a;return o}function qre(e,t,r){var a=e.l+t,n=Zu(e),i=[n];if(r.cellFormula){var o=Ise(e,a-e.l,r);i[1]=o,e.l=a}else e.l=a;return i}function Wre(e,t,r){r==null&&(r=yt(18));var a=r1(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var u5=["left","right","top","bottom","header","footer"];function Hre(e){var t={};return u5.forEach(function(r){t[r]=Kf(e)}),t}function Gre(e,t){return t==null&&(t=yt(6*8)),c5(e),u5.forEach(function(r){Bu(e[r],t)}),t}function Kre(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Xre(e,t,r){r==null&&(r=yt(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Yre(e){var t=yt(24);return t.write_shift(4,4),t.write_shift(4,1),Gf(e,t),t}function Zre(e,t){return t==null&&(t=yt(16*4+2)),t.write_shift(2,e.password?HI(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Qre(){}function Jre(){}function eae(e,t,r,a,n,i,o){if(t.v===void 0)return!1;var c="";switch(t.t){case"b":c=t.v?"1":"0";break;case"d":t=Oi(t),t.z=t.z||Ma[14],t.v=Ii(yi(t.v)),t.t="n";break;case"n":case"e":c=""+t.v;break;default:c=t.v;break}var d={r,c:a};switch(d.s=Ud(n.cellXfs,t,n),t.l&&i["!links"].push([Yr(d),t.l]),t.c&&i["!comments"].push([Yr(d),t.c]),t.t){case"s":case"str":return n.bookSST?(c=G_(n.Strings,t.v,n.revStrings),d.t="s",d.v=c,o?At(e,18,yre(t,d)):At(e,7,gre(t,d))):(d.t="str",o?At(e,17,Pre(t,d)):At(e,6,kre(t,d))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?At(e,13,Sre(t,d)):At(e,2,Cre(t,d)):o?At(e,16,jre(t,d)):At(e,5,bre(t,d)),!0;case"b":return d.t="b",o?At(e,15,ure(t,d)):At(e,4,cre(t,d)),!0;case"e":return d.t="e",o?At(e,14,pre(t,d)):At(e,3,fre(t,d)),!0}return o?At(e,12,ore(t,d)):At(e,1,nre(t,d)),!0}function tae(e,t,r,a){var n=va(t["!ref"]||"A1"),i,o="",c=[];At(e,145);var d=Array.isArray(t),h=n.e.r;t["!rows"]&&(h=Math.max(n.e.r,t["!rows"].length-1));for(var p=n.s.r;p<=h;++p){o=On(p),Qse(e,t,n,p);var x=!1;if(p<=n.e.r)for(var v=n.s.c;v<=n.e.c;++v){p===n.s.r&&(c[v]=ei(v)),i=c[v]+o;var b=d?(t[p]||[])[v]:t[i];if(!b){x=!1;continue}x=eae(e,b,p,v,a,t,x)}}At(e,146)}function sae(e,t){!t||!t["!merges"]||(At(e,177,Bre(t["!merges"].length)),t["!merges"].forEach(function(r){At(e,176,Fre(r))}),At(e,178))}function rae(e,t){!t||!t["!cols"]||(At(e,390),t["!cols"].forEach(function(r,a){r&&At(e,60,Wre(a,r))}),At(e,391))}function aae(e,t){!t||!t["!ref"]||(At(e,648),At(e,649,Yre(va(t["!ref"]))),At(e,650))}function nae(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var n=Gr(r,-1,a[1].Target.replace(/#.*$/,""),Rr.HLINK);At(e,494,Ure(a,n))}}),delete t["!links"]}function iae(e,t,r,a){if(t["!comments"].length>0){var n=Gr(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Rr.VML);At(e,551,U_("rId"+n)),t["!legacy"]=n}}function oae(e,t,r,a){if(t["!autofilter"]){var n=t["!autofilter"],i=typeof n.ref=="string"?n.ref:Za(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,c=so(i);c.s.r==c.e.r&&(c.e.r=so(t["!ref"]).e.r,i=Za(c));for(var d=0;d<o.length;++d){var h=o[d];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==a){h.Ref="'"+r.SheetNames[a]+"'!"+i;break}}d==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+i}),At(e,161,Gf(va(i))),At(e,162)}}function lae(e,t,r){At(e,133),At(e,137,Xre(t,r)),At(e,138),At(e,134)}function cae(e,t){t["!protect"]&&At(e,535,Zre(t["!protect"]))}function dae(e,t,r,a){var n=Pi(),i=r.SheetNames[e],o=r.Sheets[i]||{},c=i;try{r&&r.Workbook&&(c=r.Workbook.Sheets[e].CodeName||c)}catch{}var d=va(o["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],At(n,129),(r.vbaraw||o["!outline"])&&At(n,147,rre(c,o["!outline"])),At(n,148,ere(d)),lae(n,o,r.Workbook),rae(n,o),tae(n,o,e,t),cae(n,o),oae(n,o,r,e),sae(n,o),nae(n,o,a),o["!margins"]&&At(n,476,Gre(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&aae(n,o),iae(n,o,e,a),At(n,130),n.end()}function uae(e,t){e.l+=10;var r=ti(e);return{name:r}}var hae=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function fae(e){return!e.Workbook||!e.Workbook.WBProps?"false":qQ(e.Workbook.WBProps.date1904)?"true":"false"}var mae="][*?/\\".split("");function h5(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return mae.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function pae(e,t,r){e.forEach(function(a,n){h5(a);for(var i=0;i<n;++i)if(a==e[i])throw new Error("Duplicate Sheet Name: "+a);if(r){var o=t&&t[n]&&t[n].CodeName||a;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function xae(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];pae(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Fse(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function f5(e){var t=[Ja];t[t.length]=Ht("workbook",null,{xmlns:Wf[0],"xmlns:r":vn.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(hae.forEach(function(c){e.Workbook.WBProps[c[0]]!=null&&e.Workbook.WBProps[c[0]]!=c[1]&&(a[c[0]]=e.Workbook.WBProps[c[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Ht("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!n[i]||!n[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:Xr(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Ht("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(c){var d={name:c.Name};c.Comment&&(d.comment=c.Comment),c.Sheet!=null&&(d.localSheetId=""+c.Sheet),c.Hidden&&(d.hidden="1"),c.Ref&&(t[t.length]=Ht("definedName",Xr(c.Ref),d))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function gae(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=cw(e),r.name=ti(e),r}function vae(e,t){return t||(t=yt(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),U_(e.strRelID,t),bn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function yae(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?ti(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function wae(e,t){t||(t=yt(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),CI(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function bae(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),i=fJ(e),o=Pse(e,0,r),c=V_(e);e.l=a;var d={Name:i,Ptg:o};return n<268435455&&(d.Sheet=n),c&&(d.Comment=c),d}function _ae(e,t){At(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};At(e,156,vae(n))}At(e,144)}function jae(e,t){t||(t=yt(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return bn("SheetJS",t),bn(eg.version,t),bn(eg.version,t),bn("7262",t),t.length>t.l?t.slice(0,t.l):t}function Nae(e,t){t||(t=yt(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Cae(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,n=-1,i=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&i==-1&&(i=a);i>n||(At(e,135),At(e,158,Nae(n)),At(e,136))}}function Eae(e,t){var r=Pi();return At(r,131),At(r,128,jae()),At(r,153,wae(e.Workbook&&e.Workbook.WBProps||null)),Cae(r,e),_ae(r,e),At(r,132),r.end()}function Sae(e,t,r){return(t.slice(-4)===".bin"?Eae:f5)(e)}function Tae(e,t,r,a,n){return(t.slice(-4)===".bin"?dae:d5)(e,r,a,n)}function Aae(e,t,r){return(t.slice(-4)===".bin"?Gee:XI)(e,r)}function kae(e,t,r){return(t.slice(-4)===".bin"?wee:WI)(e,r)}function Rae(e,t,r){return(t.slice(-4)===".bin"?cte:e5)(e)}function Pae(e){return(e.slice(-4)===".bin"?tte:QI)()}function Iae(e,t){var r=[];return e.Props&&r.push(AJ(e.Props,t)),e.Custprops&&r.push(kJ(e.Props,e.Custprops)),r.join("")}function Oae(){return""}function Dae(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,n){var i=[];i.push(Ht("NumberFormat",null,{"ss:Format":Xr(Ma[a.numFmtId])}));var o={"ss:ID":"s"+(21+n)};r.push(Ht("Style",i.join(""),o))}),Ht("Styles",r.join(""))}function m5(e){return Ht("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+W_(e.Ref,{r:0,c:0})})}function Mae(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var n=t[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(m5(n)))}return Ht("Names",r.join(""))}function Lae(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,i=[],o=0;o<n.length;++o){var c=n[o];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||i.push(m5(c)))}return i.join("")}function Fae(e,t,r,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(Ht("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(Ht("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(Ht("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(Ht("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(Pn("ProtectContents","True")),e["!protect"].objects&&n.push(Pn("ProtectObjects","True")),e["!protect"].scenarios&&n.push(Pn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(Pn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(Pn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&n.push("<"+o[1]+"/>")})),n.length==0?"":Ht("WorksheetOptions",n.join(""),{xmlns:Wi.x})}function Bae(e){return e.map(function(t){var r=$Q(t.t||""),a=Ht("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ht("Comment",a,{"ss:Author":t.a})}).join("")}function Vae(e,t,r,a,n,i,o){if(!e||e.v==null&&e.f==null)return"";var c={};if(e.f&&(c["ss:Formula"]="="+Xr(W_(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var d=wn(e.F.slice(t.length+1));c["ss:ArrayRange"]="RC:R"+(d.r==o.r?"":"["+(d.r-o.r)+"]")+"C"+(d.c==o.c?"":"["+(d.c-o.c)+"]")}if(e.l&&e.l.Target&&(c["ss:HRef"]=Xr(e.l.Target),e.l.Tooltip&&(c["x:HRefScreenTip"]=Xr(e.l.Tooltip))),r["!merges"])for(var h=r["!merges"],p=0;p!=h.length;++p)h[p].s.c!=o.c||h[p].s.r!=o.r||(h[p].e.c>h[p].s.c&&(c["ss:MergeAcross"]=h[p].e.c-h[p].s.c),h[p].e.r>h[p].s.r&&(c["ss:MergeDown"]=h[p].e.r-h[p].s.r));var x="",v="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":x="Number",v=String(e.v);break;case"b":x="Boolean",v=e.v?"1":"0";break;case"e":x="Error",v=u0[e.v];break;case"d":x="DateTime",v=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ma[14]);break;case"s":x="String",v=zQ(e.v||"");break}var b=Ud(a.cellXfs,e,a);c["ss:StyleID"]="s"+(21+b),c["ss:Index"]=o.c+1;var N=e.v!=null?v:"",_=e.t=="z"?"":'<Data ss:Type="'+x+'">'+N+"</Data>";return(e.c||[]).length>0&&(_+=Bae(e.c)),Ht("Cell",_,c)}function Uae(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=KI(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function zae(e,t,r,a){if(!e["!ref"])return"";var n=va(e["!ref"]),i=e["!merges"]||[],o=0,c=[];e["!cols"]&&e["!cols"].forEach(function(C,T){$_(C);var A=!!C.width,k=r1(T,C),I={"ss:Index":T+1};A&&(I["ss:Width"]=cg(k.width)),C.hidden&&(I["ss:Hidden"]="1"),c.push(Ht("Column",null,I))});for(var d=Array.isArray(e),h=n.s.r;h<=n.e.r;++h){for(var p=[Uae(h,(e["!rows"]||[])[h])],x=n.s.c;x<=n.e.c;++x){var v=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>x)&&!(i[o].s.r>h)&&!(i[o].e.c<x)&&!(i[o].e.r<h)){(i[o].s.c!=x||i[o].s.r!=h)&&(v=!0);break}if(!v){var b={r:h,c:x},N=Yr(b),_=d?(e[h]||[])[x]:e[N];p.push(Vae(_,N,e,t,r,a,b))}}p.push("</Row>"),p.length>2&&c.push(p.join(""))}return c.join("")}function $ae(e,t,r){var a=[],n=r.SheetNames[e],i=r.Sheets[n],o=i?Lae(i,t,e,r):"";return o.length>0&&a.push("<Names>"+o+"</Names>"),o=i?zae(i,t,e,r):"",o.length>0&&a.push("<Table>"+o+"</Table>"),a.push(Fae(i,t,e,r)),a.join("")}function qae(e,t){t||(t={}),e.SSF||(e.SSF=Oi(Ma)),e.SSF&&(Qg(),Zg(e.SSF),t.revssf=Jg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ud(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Iae(e,t)),r.push(Oae()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Ht("Worksheet",$ae(a,t,e),{"ss:Name":Xr(e.SheetNames[a])}));return r[2]=Dae(e,t),r[3]=Mae(e),Ja+Ht("Workbook",r.join(""),{xmlns:Wi.ss,"xmlns:o":Wi.o,"xmlns:x":Wi.x,"xmlns:ss":Wi.ss,"xmlns:dt":Wi.dt,"xmlns:html":Wi.html})}var vv={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Wae(e,t){var r=[],a=[],n=[],i=0,o,c=NE(LE,"n"),d=NE(FE,"n");if(e.Props)for(o=Dn(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(c,o[i])?r:Object.prototype.hasOwnProperty.call(d,o[i])?a:n).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=Dn(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(c,o[i])?r:Object.prototype.hasOwnProperty.call(d,o[i])?a:n).push([o[i],e.Custprops[o[i]]]);var h=[];for(i=0;i<n.length;++i)FI.indexOf(n[i][0])>-1||DI.indexOf(n[i][0])>-1||n[i][1]!=null&&h.push(n[i]);a.length&&Qr.utils.cfb_add(t,"/SummaryInformation",$E(a,vv.SI,d,FE)),(r.length||h.length)&&Qr.utils.cfb_add(t,"/DocumentSummaryInformation",$E(r,vv.DSI,c,LE,h.length?h:null,vv.UDI))}function Hae(e,t){var r=t||{},a=Qr.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Qr.utils.cfb_add(a,n,p5(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Wae(e,a),r.biff==8&&e.vbaraw&&dte(a,Qr.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var Gae={0:{f:Yse},1:{f:are},2:{f:Nre},3:{f:hre},4:{f:lre},5:{f:wre},6:{f:Are},7:{f:xre},8:{f:Mre},9:{f:Dre},10:{f:Ire},11:{f:Ore},12:{f:ire},13:{f:Ere},14:{f:mre},15:{f:dre},16:{f:_re},17:{f:Rre},18:{f:vre},19:{f:B_},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:bae},40:{},42:{},43:{f:Aee},44:{f:See},45:{f:Pee},46:{f:Oee},47:{f:Iee},48:{},49:{f:iJ},50:{},51:{f:Yee},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:oee},62:{f:Tre},63:{f:ste},64:{f:Qre},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ql,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Kre},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:sre},148:{f:Jse,p:16},151:{f:zre},152:{},153:{f:yae},154:{},155:{},156:{f:gae},157:{},158:{},159:{T:1,f:gee},160:{T:-1},161:{T:1,f:Zu},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Lre},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Kee},336:{T:-1},337:{f:Jee,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:cw},357:{},358:{},359:{},360:{T:1},361:{},362:{f:tee},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:$re},427:{f:qre},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Hre},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:tre},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Vre},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:cw},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ote},633:{T:1},634:{T:-1},635:{T:1,f:nte},636:{T:-1},637:{f:dJ},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:uae},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Jre},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Kt(e,t,r,a){var n=t;if(!isNaN(n)){var i=a||(r||[]).length||0,o=e.next(4);o.write_shift(2,n),o.write_shift(2,i),i>0&&M_(r)&&e.push(r)}}function Kae(e,t,r,a){var n=(r||[]).length||0;if(n<=8224)return Kt(e,t,r,n);var i=t;if(!isNaN(i)){for(var o=r.parts||[],c=0,d=0,h=0;h+(o[c]||8224)<=8224;)h+=o[c]||8224,c++;var p=e.next(4);for(p.write_shift(2,i),p.write_shift(2,h),e.push(r.slice(d,d+h)),d+=h;d<n;){for(p=e.next(4),p.write_shift(2,60),h=0;h+(o[c]||8224)<=8224;)h+=o[c]||8224,c++;p.write_shift(2,h),e.push(r.slice(d,d+h)),d+=h}}}function f0(e,t,r){return e||(e=yt(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Xae(e,t,r,a){var n=yt(9);return f0(n,e,t),VI(r,a||"b",n),n}function Yae(e,t,r){var a=yt(8+2*r.length);return f0(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function Zae(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?Ii(yi(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?Kt(e,2,uee(r,a,n)):Kt(e,3,dee(r,a,n));return;case"b":case"e":Kt(e,5,Xae(r,a,t.v,t.t));return;case"s":case"str":Kt(e,4,Yae(r,a,(t.v||"").slice(0,255)));return}Kt(e,1,f0(null,r,a))}function Qae(e,t,r,a){var n=Array.isArray(t),i=va(t["!ref"]||"A1"),o,c="",d=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=Za(i)}for(var h=i.s.r;h<=i.e.r;++h){c=On(h);for(var p=i.s.c;p<=i.e.c;++p){h===i.s.r&&(d[p]=ei(p)),o=d[p]+c;var x=n?(t[h]||[])[p]:t[o];x&&Zae(e,x,h,p)}}}function Jae(e,t){for(var r=t||{},a=Pi(),n=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(n=i);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Kt(a,r.biff==4?1033:r.biff==3?521:9,z_(e,16,r)),Qae(a,e.Sheets[e.SheetNames[n]],n,r),Kt(a,10),a.end()}function ene(e,t,r){Kt(e,49,GJ({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function tne(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&Kt(e,1054,YJ(n,t[n],r))})}function sne(e,t){var r=yt(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Kt(e,2151,r),r=yt(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),$I(va(t["!ref"]||"A1"),r),r.write_shift(4,4),Kt(e,2152,r)}function rne(e,t){for(var r=0;r<16;++r)Kt(e,224,WE({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){Kt(e,224,WE(a,0,t))})}function ane(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];Kt(e,440,aee(a)),a[1].Tooltip&&Kt(e,2048,nee(a))}delete t["!links"]}function nne(e,t){if(t){var r=0;t.forEach(function(a,n){++r<=256&&a&&Kt(e,125,lee(r1(n,a),n))})}}function ine(e,t,r,a,n){var i=16+Ud(n.cellXfs,t,n);if(t.v==null&&!t.bf){Kt(e,513,Vu(r,a,i));return}if(t.bf)Kt(e,6,kse(t,r,a,n,i));else switch(t.t){case"d":case"n":var o=t.t=="d"?Ii(yi(t.v)):t.v;Kt(e,515,eee(r,a,o,i));break;case"b":case"e":Kt(e,517,JJ(r,a,t.v,i,n,t.t));break;case"s":case"str":if(n.bookSST){var c=G_(n.Strings,t.v,n.revStrings);Kt(e,253,KJ(r,a,c,i))}else Kt(e,516,XJ(r,a,(t.v||"").slice(0,255),i,n));break;default:Kt(e,513,Vu(r,a,i))}}function one(e,t,r){var a=Pi(),n=r.SheetNames[e],i=r.Sheets[n]||{},o=(r||{}).Workbook||{},c=(o.Sheets||[])[e]||{},d=Array.isArray(i),h=t.biff==8,p,x="",v=[],b=va(i["!ref"]||"A1"),N=h?65536:16384;if(b.e.c>255||b.e.r>=N){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");b.e.c=Math.min(b.e.c,255),b.e.r=Math.min(b.e.c,N-1)}Kt(a,2057,z_(r,16,t)),Kt(a,13,po(1)),Kt(a,12,po(100)),Kt(a,15,hi(!0)),Kt(a,17,hi(!1)),Kt(a,16,Bu(.001)),Kt(a,95,hi(!0)),Kt(a,42,hi(!1)),Kt(a,43,hi(!1)),Kt(a,130,po(1)),Kt(a,128,QJ()),Kt(a,131,hi(!1)),Kt(a,132,hi(!1)),h&&nne(a,i["!cols"]),Kt(a,512,ZJ(b,t)),h&&(i["!links"]=[]);for(var _=b.s.r;_<=b.e.r;++_){x=On(_);for(var C=b.s.c;C<=b.e.c;++C){_===b.s.r&&(v[C]=ei(C)),p=v[C]+x;var T=d?(i[_]||[])[C]:i[p];T&&(ine(a,T,_,C,t),h&&T.l&&i["!links"].push([p,T.l]))}}var A=c.CodeName||c.name||n;return h&&Kt(a,574,HJ((o.Views||[])[0])),h&&(i["!merges"]||[]).length&&Kt(a,229,ree(i["!merges"])),h&&ane(a,i),Kt(a,442,zI(A)),h&&sne(a,i),Kt(a,10),a.end()}function lne(e,t,r){var a=Pi(),n=(e||{}).Workbook||{},i=n.Sheets||[],o=n.WBProps||{},c=r.biff==8,d=r.biff==5;if(Kt(a,2057,z_(e,5,r)),r.bookType=="xla"&&Kt(a,135),Kt(a,225,c?po(1200):null),Kt(a,193,IJ(2)),d&&Kt(a,191),d&&Kt(a,192),Kt(a,226),Kt(a,92,zJ("SheetJS",r)),Kt(a,66,po(c?1200:1252)),c&&Kt(a,353,po(0)),c&&Kt(a,448),Kt(a,317,cee(e.SheetNames.length)),c&&e.vbaraw&&Kt(a,211),c&&e.vbaraw){var h=o.CodeName||"ThisWorkbook";Kt(a,442,zI(h))}Kt(a,156,po(17)),Kt(a,25,hi(!1)),Kt(a,18,hi(!1)),Kt(a,19,po(0)),c&&Kt(a,431,hi(!1)),c&&Kt(a,444,po(0)),Kt(a,61,WJ()),Kt(a,64,hi(!1)),Kt(a,141,po(0)),Kt(a,34,hi(fae(e)=="true")),Kt(a,14,hi(!0)),c&&Kt(a,439,hi(!1)),Kt(a,218,po(0)),ene(a,e,r),tne(a,e.SSF,r),rne(a,r),c&&Kt(a,352,hi(!1));var p=a.end(),x=Pi();c&&Kt(x,140,iee()),c&&r.Strings&&Kae(x,252,qJ(r.Strings)),Kt(x,10);var v=x.end(),b=Pi(),N=0,_=0;for(_=0;_<e.SheetNames.length;++_)N+=(c?12:11)+(c?2:1)*e.SheetNames[_].length;var C=p.length+N+v.length;for(_=0;_<e.SheetNames.length;++_){var T=i[_]||{};Kt(b,133,$J({pos:C,hs:T.Hidden||0,dt:0,name:e.SheetNames[_]},r)),C+=t[_].length}var A=b.end();if(N!=A.length)throw new Error("BS8 "+N+" != "+A.length);var k=[];return p.length&&k.push(p),A.length&&k.push(A),v.length&&k.push(v),Rn(k)}function cne(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=Oi(Ma)),e&&e.SSF&&(Qg(),Zg(e.SSF),r.revssf=Jg(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,K_(r),r.cellXfs=[],Ud(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=one(n,r,e);return a.unshift(lne(e,a,r)),Rn(a)}function p5(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var n=so(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return cne(e,t);case 4:case 3:case 2:return Jae(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function dne(e,t,r,a){for(var n=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var c=0,d=0,h=0;h<n.length;++h)if(!(n[h].s.r>r||n[h].s.c>o)&&!(n[h].e.r<r||n[h].e.c<o)){if(n[h].s.r<r||n[h].s.c<o){c=-1;break}c=n[h].e.r-n[h].s.r+1,d=n[h].e.c-n[h].s.c+1;break}if(!(c<0)){var p=Yr({r,c:o}),x=a.dense?(e[r]||[])[o]:e[p],v=x&&x.v!=null&&(x.h||UQ(x.w||(_c(x),x.w)||""))||"",b={};c>1&&(b.rowspan=c),d>1&&(b.colspan=d),a.editable?v='<span contenteditable="true">'+v+"</span>":x&&(b["data-t"]=x&&x.t||"z",x.v!=null&&(b["data-v"]=x.v),x.z!=null&&(b["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+x.l.Target+'">'+v+"</a>")),b.id=(a.id||"sjs")+"-"+p,i.push(Ht("td",v,b))}}var N="<tr>";return N+i.join("")+"</tr>"}var une='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',hne="</body></html>";function fne(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function x5(e,t){var r=t||{},a=r.header!=null?r.header:une,n=r.footer!=null?r.footer:hne,i=[a],o=so(e["!ref"]);r.dense=Array.isArray(e),i.push(fne(e,o,r));for(var c=o.s.r;c<=o.e.r;++c)i.push(dne(e,o,c,r));return i.push("</table>"+n),i.join("")}function g5(e,t,r){var a=r||{},n=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var o=typeof a.origin=="string"?wn(a.origin):a.origin;n=o.r,i=o.c}var c=t.getElementsByTagName("tr"),d=Math.min(a.sheetRows||1e7,c.length),h={s:{r:0,c:0},e:{r:n,c:i}};if(e["!ref"]){var p=so(e["!ref"]);h.s.r=Math.min(h.s.r,p.s.r),h.s.c=Math.min(h.s.c,p.s.c),h.e.r=Math.max(h.e.r,p.e.r),h.e.c=Math.max(h.e.c,p.e.c),n==-1&&(h.e.r=n=p.e.r+1)}var x=[],v=0,b=e["!rows"]||(e["!rows"]=[]),N=0,_=0,C=0,T=0,A=0,k=0;for(e["!cols"]||(e["!cols"]=[]);N<c.length&&_<d;++N){var I=c[N];if(QE(I)){if(a.display)continue;b[_]={hidden:!0}}var B=I.children;for(C=T=0;C<B.length;++C){var O=B[C];if(!(a.display&&QE(O))){var D=O.hasAttribute("data-v")?O.getAttribute("data-v"):O.hasAttribute("v")?O.getAttribute("v"):WQ(O.innerHTML),F=O.getAttribute("data-z")||O.getAttribute("z");for(v=0;v<x.length;++v){var M=x[v];M.s.c==T+i&&M.s.r<_+n&&_+n<=M.e.r&&(T=M.e.c+1-i,v=-1)}k=+O.getAttribute("colspan")||1,((A=+O.getAttribute("rowspan")||1)>1||k>1)&&x.push({s:{r:_+n,c:T+i},e:{r:_+n+(A||1)-1,c:T+i+(k||1)-1}});var z={t:"s",v:D},q=O.getAttribute("data-t")||O.getAttribute("t")||"";D!=null&&(D.length==0?z.t=q||"z":a.raw||D.trim().length==0||q=="s"||(D==="TRUE"?z={t:"b",v:!0}:D==="FALSE"?z={t:"b",v:!1}:isNaN(mc(D))?isNaN(Op(D).getDate())||(z={t:"d",v:yi(D)},a.cellDates||(z={t:"n",v:Ii(z.v)}),z.z=a.dateNF||Ma[14]):z={t:"n",v:mc(D)})),z.z===void 0&&F!=null&&(z.z=F);var Y="",ae=O.getElementsByTagName("A");if(ae&&ae.length)for(var je=0;je<ae.length&&!(ae[je].hasAttribute("href")&&(Y=ae[je].getAttribute("href"),Y.charAt(0)!="#"));++je);Y&&Y.charAt(0)!="#"&&(z.l={Target:Y}),a.dense?(e[_+n]||(e[_+n]=[]),e[_+n][T+i]=z):e[Yr({c:T+i,r:_+n})]=z,h.e.c<T+i&&(h.e.c=T+i),T+=k}}++_}return x.length&&(e["!merges"]=(e["!merges"]||[]).concat(x)),h.e.r=Math.max(h.e.r,_-1+n),e["!ref"]=Za(h),_>=d&&(e["!fullref"]=Za((h.e.r=c.length-N+_-1+n,h))),e}function v5(e,t){var r=t||{},a=r.dense?[]:{};return g5(a,e,t)}function mne(e,t){return Gu(v5(e,t),t)}function QE(e){var t="",r=pne(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function pne(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var xne=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Mp({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Ja+t}}(),JE=function(){var e=function(i){return Xr(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(i,o,c){var d=[];d.push('      <table:table table:name="'+Xr(o.SheetNames[c])+`" table:style-name="ta1">
`);var h=0,p=0,x=so(i["!ref"]||"A1"),v=i["!merges"]||[],b=0,N=Array.isArray(i);if(i["!cols"])for(p=0;p<=x.e.c;++p)d.push("        <table:table-column"+(i["!cols"][p]?' table:style-name="co'+i["!cols"][p].ods+'"':"")+`></table:table-column>
`);var _="",C=i["!rows"]||[];for(h=0;h<x.s.r;++h)_=C[h]?' table:style-name="ro'+C[h].ods+'"':"",d.push("        <table:table-row"+_+`></table:table-row>
`);for(;h<=x.e.r;++h){for(_=C[h]?' table:style-name="ro'+C[h].ods+'"':"",d.push("        <table:table-row"+_+`>
`),p=0;p<x.s.c;++p)d.push(t);for(;p<=x.e.c;++p){var T=!1,A={},k="";for(b=0;b!=v.length;++b)if(!(v[b].s.c>p)&&!(v[b].s.r>h)&&!(v[b].e.c<p)&&!(v[b].e.r<h)){(v[b].s.c!=p||v[b].s.r!=h)&&(T=!0),A["table:number-columns-spanned"]=v[b].e.c-v[b].s.c+1,A["table:number-rows-spanned"]=v[b].e.r-v[b].s.r+1;break}if(T){d.push(r);continue}var I=Yr({r:h,c:p}),B=N?(i[h]||[])[p]:i[I];if(B&&B.f&&(A["table:formula"]=Xr(Mse(B.f)),B.F&&B.F.slice(0,I.length)==I)){var O=so(B.F);A["table:number-matrix-columns-spanned"]=O.e.c-O.s.c+1,A["table:number-matrix-rows-spanned"]=O.e.r-O.s.r+1}if(!B){d.push(t);continue}switch(B.t){case"b":k=B.v?"TRUE":"FALSE",A["office:value-type"]="boolean",A["office:boolean-value"]=B.v?"true":"false";break;case"n":k=B.w||String(B.v||0),A["office:value-type"]="float",A["office:value"]=B.v||0;break;case"s":case"str":k=B.v==null?"":B.v,A["office:value-type"]="string";break;case"d":k=B.w||yi(B.v).toISOString(),A["office:value-type"]="date",A["office:date-value"]=yi(B.v).toISOString(),A["table:style-name"]="ce1";break;default:d.push(t);continue}var D=e(k);if(B.l&&B.l.Target){var F=B.l.Target;F=F.charAt(0)=="#"?"#"+Lse(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),D=Ht("text:a",D,{"xlink:href":F.replace(/&/g,"&amp;")})}d.push("          "+Ht("table:table-cell",Ht("text:p",D,{}),A)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},n=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var c=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var p=0;p<h["!cols"].length;++p)if(h["!cols"][p]){var x=h["!cols"][p];if(x.width==null&&x.wpx==null&&x.wch==null)continue;$_(x),x.ods=c;var v=h["!cols"][p].wpx+"px";i.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),i.push(`  </style:style>
`),++c}}});var d=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var p=0;p<h["!rows"].length;++p)if(h["!rows"][p]){h["!rows"][p].ods=d;var x=h["!rows"][p].hpx+"px";i.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),i.push(`  </style:style>
`),++d}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,c){var d=[Ja],h=Mp({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=Mp({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(d.push("<office:document"+h+p+`>
`),d.push(II().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+h+`>
`),n(d,o),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var x=0;x!=o.SheetNames.length;++x)d.push(a(o.Sheets[o.SheetNames[x]],o,x));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),c.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}}();function y5(e,t){if(t.bookType=="fods")return JE(e,t);var r=P_(),a="",n=[],i=[];return a="mimetype",ur(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",ur(r,a,JE(e,t)),n.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",ur(r,a,xne(e,t)),n.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",ur(r,a,Ja+II()),n.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",ur(r,a,TJ(i)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",ur(r,a,EJ(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function hg(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function gne(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Qo(Dp(e))}function vne(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function Od(e){var t=e.reduce(function(n,i){return n+i.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(n){r.set(n,a),a+=n.length}),r}function yne(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var i=0;n>=1;++i,n/=256)e[t+i]=n&255;e[t+15]|=r>=0?0:128}function Lp(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Wr(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function $h(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function nn(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],n=Lp(e,r),i=n&7;n=Math.floor(n/8);var o=0,c;if(n==0)break;switch(i){case 0:{for(var d=r[0];e[r[0]++]>=128;);c=e.slice(d,r[0])}break;case 5:o=4,c=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,c=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Lp(e,r),c=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(a))}var h={data:c,type:i};t[n]==null?t[n]=[h]:t[n].push(h)}return t}function Sn(e){var t=[];return e.forEach(function(r,a){r.forEach(function(n){n.data&&(t.push(Wr(a*8+n.type)),n.type==2&&t.push(Wr(n.data.length)),t.push(n.data))})}),Od(t)}function Fo(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=Lp(e,a),i=nn(e.slice(a[0],a[0]+n));a[0]+=n;var o={id:$h(i[1][0].data),messages:[]};i[2].forEach(function(c){var d=nn(c.data),h=$h(d[3][0].data);o.messages.push({meta:d,data:e.slice(a[0],a[0]+h)}),a[0]+=h}),(t=i[3])!=null&&t[0]&&(o.merge=$h(i[3][0].data)>>>0>0),r.push(o)}return r}function gh(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:Wr(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Wr(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(o){n.push(o.data),o.meta[3]=[{type:0,data:Wr(o.data.length)}],a[2].push({data:Sn(o.meta),type:2})});var i=Sn(a);t.push(Wr(i.length)),t.push(i),n.forEach(function(o){return t.push(o)})}),Od(t)}function wne(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=Lp(t,r),n=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var c=o-59;o=t[r[0]],c>1&&(o|=t[r[0]+1]<<8),c>2&&(o|=t[r[0]+2]<<16),c>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=c}n.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var d=0,h=0;if(i==1?(h=(t[r[0]]>>2&7)+4,d=(t[r[0]++]&224)<<3,d|=t[r[0]++]):(h=(t[r[0]++]>>2)+1,i==2?(d=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(d=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[Od(n)],d==0)throw new Error("Invalid offset 0");if(d>n[0].length)throw new Error("Invalid offset beyond length");if(h>=d)for(n.push(n[0].slice(-d)),h-=d;h>=n[n.length-1].length;)n.push(n[n.length-1]),h-=n[n.length-1].length;n.push(n[0].slice(-d,-d+h))}}var p=Od(n);if(p.length!=a)throw new Error("Unexpected length: ".concat(p.length," != ").concat(a));return p}function Bo(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(wne(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Od(t)}function vh(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var i=Wr(a),o=i.length;t.push(i),a<=60?(o++,t.push(new Uint8Array([a-1<<2]))):a<=256?(o+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(o+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(o+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(o+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),o+=a,n[0]=0,n[1]=o&255,n[2]=o>>8&255,n[3]=o>>16&255,r+=a}return Od(t)}function yv(e,t){var r=new Uint8Array(32),a=hg(r),n=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,yne(r,n,e.v),i|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,e.v?1:0,!0),i|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(n,t.indexOf(e.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,i,!0),r.slice(0,n)}function wv(e,t){var r=new Uint8Array(32),a=hg(r),n=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(n,e.v,!0),i|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,e.v?1:0,!0),i|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(n,t.indexOf(e.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,i,!0),r.slice(0,n)}function Uc(e){var t=nn(e);return Lp(t[1][0].data)}function bne(e,t,r){var a,n,i,o;if(!((a=e[6])!=null&&a[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var c=((o=(i=e[8])==null?void 0:i[0])==null?void 0:o.data)&&$h(e[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var d=0,h=hg(e[7][0].data),p=0,x=[],v=hg(e[4][0].data),b=0,N=[],_=0;_<t.length;++_){if(t[_]==null){h.setUint16(_*2,65535,!0),v.setUint16(_*2,65535);continue}h.setUint16(_*2,p,!0),v.setUint16(_*2,b,!0);var C,T;switch(typeof t[_]){case"string":C=yv({t:"s",v:t[_]},r),T=wv({t:"s",v:t[_]},r);break;case"number":C=yv({t:"n",v:t[_]},r),T=wv({t:"n",v:t[_]},r);break;case"boolean":C=yv({t:"b",v:t[_]},r),T=wv({t:"b",v:t[_]},r);break;default:throw new Error("Unsupported value "+t[_])}x.push(C),p+=C.length,N.push(T),b+=T.length,++d}for(e[2][0].data=Wr(d);_<e[7][0].data.length/2;++_)h.setUint16(_*2,65535,!0),v.setUint16(_*2,65535,!0);return e[6][0].data=Od(x),e[3][0].data=Od(N),d}function _ne(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=so(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Za(a)));var i=fg(r,{range:a,header:1}),o=["~Sh33tJ5~"];i.forEach(function(ee){return ee.forEach(function(ie){typeof ie=="string"&&o.push(ie)})});var c={},d=[],h=Qr.read(t.numbers,{type:"base64"});h.FileIndex.map(function(ee,ie){return[ee,h.FullPaths[ie]]}).forEach(function(ee){var ie=ee[0],ce=ee[1];if(ie.type==2&&ie.name.match(/\.iwa/)){var xe=ie.content,Ce=Bo(xe),me=Fo(Ce);me.forEach(function(fe){d.push(fe.id),c[fe.id]={deps:[],location:ce,type:$h(fe.messages[0].meta[1][0].data)}})}}),d.sort(function(ee,ie){return ee-ie});var p=d.filter(function(ee){return ee>1}).map(function(ee){return[ee,Wr(ee)]});h.FileIndex.map(function(ee,ie){return[ee,h.FullPaths[ie]]}).forEach(function(ee){var ie=ee[0];if(ee[1],!!ie.name.match(/\.iwa/)){var ce=Fo(Bo(ie.content));ce.forEach(function(xe){xe.messages.forEach(function(Ce){p.forEach(function(me){xe.messages.some(function(fe){return $h(fe.meta[1][0].data)!=11006&&vne(fe.data,me[1])})&&c[me[0]].deps.push(xe.id)})})})}});for(var x=Qr.find(h,c[1].location),v=Fo(Bo(x.content)),b,N=0;N<v.length;++N){var _=v[N];_.id==1&&(b=_)}var C=Uc(nn(b.messages[0].data)[1][0].data);for(x=Qr.find(h,c[C].location),v=Fo(Bo(x.content)),N=0;N<v.length;++N)_=v[N],_.id==C&&(b=_);for(C=Uc(nn(b.messages[0].data)[2][0].data),x=Qr.find(h,c[C].location),v=Fo(Bo(x.content)),N=0;N<v.length;++N)_=v[N],_.id==C&&(b=_);for(C=Uc(nn(b.messages[0].data)[2][0].data),x=Qr.find(h,c[C].location),v=Fo(Bo(x.content)),N=0;N<v.length;++N)_=v[N],_.id==C&&(b=_);var T=nn(b.messages[0].data);{T[6][0].data=Wr(a.e.r+1),T[7][0].data=Wr(a.e.c+1);var A=Uc(T[46][0].data),k=Qr.find(h,c[A].location),I=Fo(Bo(k.content));{for(var B=0;B<I.length&&I[B].id!=A;++B);if(I[B].id!=A)throw"Bad ColumnRowUIDMapArchive";var O=nn(I[B].messages[0].data);O[1]=[],O[2]=[],O[3]=[];for(var D=0;D<=a.e.c;++D){var F=[];F[1]=F[2]=[{type:0,data:Wr(D+420690)}],O[1].push({type:2,data:Sn(F)}),O[2].push({type:0,data:Wr(D)}),O[3].push({type:0,data:Wr(D)})}O[4]=[],O[5]=[],O[6]=[];for(var M=0;M<=a.e.r;++M)F=[],F[1]=F[2]=[{type:0,data:Wr(M+726270)}],O[4].push({type:2,data:Sn(F)}),O[5].push({type:0,data:Wr(M)}),O[6].push({type:0,data:Wr(M)});I[B].messages[0].data=Sn(O)}k.content=vh(gh(I)),k.size=k.content.length,delete T[46];var z=nn(T[4][0].data);{z[7][0].data=Wr(a.e.r+1);var q=nn(z[1][0].data),Y=Uc(q[2][0].data);k=Qr.find(h,c[Y].location),I=Fo(Bo(k.content));{if(I[0].id!=Y)throw"Bad HeaderStorageBucket";var ae=nn(I[0].messages[0].data);for(M=0;M<i.length;++M){var je=nn(ae[2][0].data);je[1][0].data=Wr(M),je[4][0].data=Wr(i[M].length),ae[2][M]={type:ae[2][0].type,data:Sn(je)}}I[0].messages[0].data=Sn(ae)}k.content=vh(gh(I)),k.size=k.content.length;var H=Uc(z[2][0].data);k=Qr.find(h,c[H].location),I=Fo(Bo(k.content));{if(I[0].id!=H)throw"Bad HeaderStorageBucket";for(ae=nn(I[0].messages[0].data),D=0;D<=a.e.c;++D)je=nn(ae[2][0].data),je[1][0].data=Wr(D),je[4][0].data=Wr(a.e.r+1),ae[2][D]={type:ae[2][0].type,data:Sn(je)};I[0].messages[0].data=Sn(ae)}k.content=vh(gh(I)),k.size=k.content.length;var Z=Uc(z[4][0].data);(function(){for(var ee=Qr.find(h,c[Z].location),ie=Fo(Bo(ee.content)),ce,xe=0;xe<ie.length;++xe){var Ce=ie[xe];Ce.id==Z&&(ce=Ce)}var me=nn(ce.messages[0].data);{me[3]=[];var fe=[];o.forEach(function(Me,Ie){fe[1]=[{type:0,data:Wr(Ie)}],fe[2]=[{type:0,data:Wr(1)}],fe[3]=[{type:2,data:gne(Me)}],me[3].push({type:2,data:Sn(fe)})})}ce.messages[0].data=Sn(me);var ve=gh(ie),ne=vh(ve);ee.content=ne,ee.size=ee.content.length})();var G=nn(z[3][0].data);{var Q=G[1][0];delete G[2];var re=nn(Q.data);{var le=Uc(re[2][0].data);(function(){for(var ee=Qr.find(h,c[le].location),ie=Fo(Bo(ee.content)),ce,xe=0;xe<ie.length;++xe){var Ce=ie[xe];Ce.id==le&&(ce=Ce)}var me=nn(ce.messages[0].data);{delete me[6],delete G[7];var fe=new Uint8Array(me[5][0].data);me[5]=[];for(var ve=0,ne=0;ne<=a.e.r;++ne){var Me=nn(fe);ve+=bne(Me,i[ne],o),Me[1][0].data=Wr(ne),me[5].push({data:Sn(Me),type:2})}me[1]=[{type:0,data:Wr(a.e.c+1)}],me[2]=[{type:0,data:Wr(a.e.r+1)}],me[3]=[{type:0,data:Wr(ve)}],me[4]=[{type:0,data:Wr(a.e.r+1)}]}ce.messages[0].data=Sn(me);var Ie=gh(ie),Be=vh(Ie);ee.content=Be,ee.size=ee.content.length})()}Q.data=Sn(re)}z[3][0].data=Sn(G)}T[4][0].data=Sn(z)}b.messages[0].data=Sn(T);var ye=gh(v),W=vh(ye);return x.content=W,x.size=x.content.length,h}function jne(e){return function(r){for(var a=0;a!=e.length;++a){var n=e[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function K_(e){jne([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Nne(e,t){return t.bookType=="ods"?y5(e,t):t.bookType=="numbers"?_ne(e,t):t.bookType=="xlsb"?Cne(e,t):Ene(e,t)}function Cne(e,t){Oh=1024,e&&!e.SSF&&(e.SSF=Oi(Ma)),e&&e.SSF&&(Qg(),Zg(e.SSF),t.revssf=Jg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Qm?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=t5.indexOf(t.bookType)>-1,n=kI();K_(t=t||{});var i=P_(),o="",c=0;if(t.cellXfs=[],Ud(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",ur(i,o,OI(e.Props,t)),n.coreprops.push(o),Gr(t.rels,2,o,Rr.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&d.push(e.SheetNames[h]);e.Props.SheetNames=d}for(e.Props.Worksheets=e.Props.SheetNames.length,ur(i,o,MI(e.Props)),n.extprops.push(o),Gr(t.rels,3,o,Rr.EXT_PROPS),e.Custprops!==e.Props&&Dn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",ur(i,o,LI(e.Custprops)),n.custprops.push(o),Gr(t.rels,4,o,Rr.CUST_PROPS)),c=1;c<=e.SheetNames.length;++c){var p={"!id":{}},x=e.Sheets[e.SheetNames[c-1]],v=(x||{})["!type"]||"sheet";switch(v){case"chart":default:o="xl/worksheets/sheet"+c+"."+r,ur(i,o,Tae(c-1,o,t,e,p)),n.sheets.push(o),Gr(t.wbrels,-1,"worksheets/sheet"+c+"."+r,Rr.WS[0])}if(x){var b=x["!comments"],N=!1,_="";b&&b.length>0&&(_="xl/comments"+c+"."+r,ur(i,_,Rae(b,_)),n.comments.push(_),Gr(p,-1,"../comments"+c+"."+r,Rr.CMNT),N=!0),x["!legacy"]&&N&&ur(i,"xl/drawings/vmlDrawing"+c+".vml",JI(c,x["!comments"])),delete x["!comments"],delete x["!legacy"]}p["!id"].rId1&&ur(i,PI(o),Uh(p))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,ur(i,o,kae(t.Strings,o,t)),n.strs.push(o),Gr(t.wbrels,-1,"sharedStrings."+r,Rr.SST)),o="xl/workbook."+r,ur(i,o,Sae(e,o)),n.workbooks.push(o),Gr(t.rels,1,o,Rr.WB),o="xl/theme/theme1.xml",ur(i,o,ZI(e.Themes,t)),n.themes.push(o),Gr(t.wbrels,-1,"theme/theme1.xml",Rr.THEME),o="xl/styles."+r,ur(i,o,Aae(e,o,t)),n.styles.push(o),Gr(t.wbrels,-1,"styles."+r,Rr.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",ur(i,o,e.vbaraw),n.vba.push(o),Gr(t.wbrels,-1,"vbaProject.bin",Rr.VBA)),o="xl/metadata."+r,ur(i,o,Pae(o)),n.metadata.push(o),Gr(t.wbrels,-1,"metadata."+r,Rr.XLMETA),ur(i,"[Content_Types].xml",RI(n,t)),ur(i,"_rels/.rels",Uh(t.rels)),ur(i,"xl/_rels/workbook."+r+".rels",Uh(t.wbrels)),delete t.revssf,delete t.ssf,i}function Ene(e,t){Oh=1024,e&&!e.SSF&&(e.SSF=Oi(Ma)),e&&e.SSF&&(Qg(),Zg(e.SSF),t.revssf=Jg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Qm?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=t5.indexOf(t.bookType)>-1,n=kI();K_(t=t||{});var i=P_(),o="",c=0;if(t.cellXfs=[],Ud(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",ur(i,o,OI(e.Props,t)),n.coreprops.push(o),Gr(t.rels,2,o,Rr.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&d.push(e.SheetNames[h]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,ur(i,o,MI(e.Props)),n.extprops.push(o),Gr(t.rels,3,o,Rr.EXT_PROPS),e.Custprops!==e.Props&&Dn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",ur(i,o,LI(e.Custprops)),n.custprops.push(o),Gr(t.rels,4,o,Rr.CUST_PROPS));var p=["SheetJ5"];for(t.tcid=0,c=1;c<=e.SheetNames.length;++c){var x={"!id":{}},v=e.Sheets[e.SheetNames[c-1]],b=(v||{})["!type"]||"sheet";switch(b){case"chart":default:o="xl/worksheets/sheet"+c+"."+r,ur(i,o,d5(c-1,t,e,x)),n.sheets.push(o),Gr(t.wbrels,-1,"worksheets/sheet"+c+"."+r,Rr.WS[0])}if(v){var N=v["!comments"],_=!1,C="";if(N&&N.length>0){var T=!1;N.forEach(function(A){A[1].forEach(function(k){k.T==!0&&(T=!0)})}),T&&(C="xl/threadedComments/threadedComment"+c+"."+r,ur(i,C,rte(N,p,t)),n.threadedcomments.push(C),Gr(x,-1,"../threadedComments/threadedComment"+c+"."+r,Rr.TCMNT)),C="xl/comments"+c+"."+r,ur(i,C,e5(N)),n.comments.push(C),Gr(x,-1,"../comments"+c+"."+r,Rr.CMNT),_=!0}v["!legacy"]&&_&&ur(i,"xl/drawings/vmlDrawing"+c+".vml",JI(c,v["!comments"])),delete v["!comments"],delete v["!legacy"]}x["!id"].rId1&&ur(i,PI(o),Uh(x))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,ur(i,o,WI(t.Strings,t)),n.strs.push(o),Gr(t.wbrels,-1,"sharedStrings."+r,Rr.SST)),o="xl/workbook."+r,ur(i,o,f5(e)),n.workbooks.push(o),Gr(t.rels,1,o,Rr.WB),o="xl/theme/theme1.xml",ur(i,o,ZI(e.Themes,t)),n.themes.push(o),Gr(t.wbrels,-1,"theme/theme1.xml",Rr.THEME),o="xl/styles."+r,ur(i,o,XI(e,t)),n.styles.push(o),Gr(t.wbrels,-1,"styles."+r,Rr.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",ur(i,o,e.vbaraw),n.vba.push(o),Gr(t.wbrels,-1,"vbaProject.bin",Rr.VBA)),o="xl/metadata."+r,ur(i,o,QI()),n.metadata.push(o),Gr(t.wbrels,-1,"metadata."+r,Rr.XLMETA),p.length>1&&(o="xl/persons/person.xml",ur(i,o,ate(p)),n.people.push(o),Gr(t.wbrels,-1,"persons/person.xml",Rr.PEOPLE)),ur(i,"[Content_Types].xml",RI(n,t)),ur(i,"_rels/.rels",Uh(t.rels)),ur(i,"xl/_rels/workbook."+r+".rels",Uh(t.wbrels)),delete t.revssf,delete t.ssf,i}function Sne(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=bc(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function w5(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return c0(t.file,Qr.write(e,{type:Dr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Qr.write(e,t)}function Tne(e,t){var r=Oi(t||{}),a=Nne(e,r);return Ane(a,r)}function Ane(e,t){var r={},a=Dr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?Qr.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(Yg(n))}return t.password&&typeof encrypt_agile<"u"?w5(encrypt_agile(n,t.password),t):t.type==="file"?c0(t.file,n):t.type=="string"?Km(n):n}function kne(e,t){var r=t||{},a=Hae(e,r);return w5(a,r)}function pl(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return Ip(Dp(a));case"binary":return Dp(a);case"string":return e;case"file":return c0(t.file,a,"utf8");case"buffer":return Dr?Ec(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):pl(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Rne(e,t){switch(t.type){case"base64":return Ip(e);case"binary":return e;case"string":return e;case"file":return c0(t.file,e,"binary");case"buffer":return Dr?Ec(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ex(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?Ip(r):t.type=="string"?Km(r):r;case"file":return c0(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function b5(e,t){nQ(),xae(e);var r=Oi(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=b5(e,r);return r.type="array",Yg(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return pl(qae(e,r),r);case"slk":case"sylk":return pl(fee.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return pl(x5(e.Sheets[e.SheetNames[n]],r),r);case"txt":return Rne(_5(e.Sheets[e.SheetNames[n]],r),r);case"csv":return pl(X_(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return pl(mee.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return ex(hee.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return pl(pee.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return pl(_ee.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return pl(qI.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return pl(y5(e,r),r);case"wk1":return ex(HE.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return ex(HE.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ex(p5(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),kne(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Tne(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Pne(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Ine(e,t,r){var a={};return a.type="file",a.file=t,Pne(a),b5(e,a)}function One(e,t,r,a,n,i,o,c){var d=On(r),h=c.defval,p=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),x=!0,v=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:r,enumerable:!1})}catch{v.__rowNum__=r}else v.__rowNum__=r;if(!o||e[r])for(var b=t.s.c;b<=t.e.c;++b){var N=o?e[r][b]:e[a[b]+d];if(N===void 0||N.t===void 0){if(h===void 0)continue;i[b]!=null&&(v[i[b]]=h);continue}var _=N.v;switch(N.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+N.t)}if(i[b]!=null){if(_==null)if(N.t=="e"&&_===null)v[i[b]]=null;else if(h!==void 0)v[i[b]]=h;else if(p&&_===null)v[i[b]]=null;else continue;else v[i[b]]=p&&(N.t!=="n"||N.t==="n"&&c.rawNumbers!==!1)?_:_c(N,_,c);_!=null&&(x=!1)}}return{row:v,isempty:x}}function fg(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,i=[],o=0,c="",d={s:{r:0,c:0},e:{r:0,c:0}},h=t||{},p=h.range!=null?h.range:e["!ref"];switch(h.header===1?a=1:h.header==="A"?a=2:Array.isArray(h.header)?a=3:h.header==null&&(a=0),typeof p){case"string":d=va(p);break;case"number":d=va(e["!ref"]),d.s.r=p;break;default:d=p}a>0&&(n=0);var x=On(d.s.r),v=[],b=[],N=0,_=0,C=Array.isArray(e),T=d.s.r,A=0,k={};C&&!e[T]&&(e[T]=[]);var I=h.skipHidden&&e["!cols"]||[],B=h.skipHidden&&e["!rows"]||[];for(A=d.s.c;A<=d.e.c;++A)if(!(I[A]||{}).hidden)switch(v[A]=ei(A),r=C?e[T][A]:e[v[A]+x],a){case 1:i[A]=A-d.s.c;break;case 2:i[A]=v[A];break;case 3:i[A]=h.header[A-d.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=o=_c(r,null,h),_=k[o]||0,!_)k[o]=1;else{do c=o+"_"+_++;while(k[c]);k[o]=_,k[c]=1}i[A]=c}for(T=d.s.r+n;T<=d.e.r;++T)if(!(B[T]||{}).hidden){var O=One(e,d,T,v,a,i,C,h);(O.isempty===!1||(a===1?h.blankrows!==!1:h.blankrows))&&(b[N++]=O.row)}return b.length=N,b}var eS=/"/g;function Dne(e,t,r,a,n,i,o,c){for(var d=!0,h=[],p="",x=On(r),v=t.s.c;v<=t.e.c;++v)if(a[v]){var b=c.dense?(e[r]||[])[v]:e[a[v]+x];if(b==null)p="";else if(b.v!=null){d=!1,p=""+(c.rawNumbers&&b.t=="n"?b.v:_c(b,null,c));for(var N=0,_=0;N!==p.length;++N)if((_=p.charCodeAt(N))===n||_===i||_===34||c.forceQuotes){p='"'+p.replace(eS,'""')+'"';break}p=="ID"&&(p='"ID"')}else b.f!=null&&!b.F?(d=!1,p="="+b.f,p.indexOf(",")>=0&&(p='"'+p.replace(eS,'""')+'"')):p="";h.push(p)}return c.blankrows===!1&&d?null:h.join(o)}function X_(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var n=va(e["!ref"]),i=a.FS!==void 0?a.FS:",",o=i.charCodeAt(0),c=a.RS!==void 0?a.RS:`
`,d=c.charCodeAt(0),h=new RegExp((i=="|"?"\\|":i)+"+$"),p="",x=[];a.dense=Array.isArray(e);for(var v=a.skipHidden&&e["!cols"]||[],b=a.skipHidden&&e["!rows"]||[],N=n.s.c;N<=n.e.c;++N)(v[N]||{}).hidden||(x[N]=ei(N));for(var _=0,C=n.s.r;C<=n.e.r;++C)(b[C]||{}).hidden||(p=Dne(e,n,C,x,o,d,i,a),p!=null&&(a.strip&&(p=p.replace(h,"")),(p||a.blankrows!==!1)&&r.push((_++?c:"")+p)));return delete a.dense,r.join("")}function _5(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=X_(e,t);return r}function Mne(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var n=va(e["!ref"]),i="",o=[],c,d=[],h=Array.isArray(e);for(c=n.s.c;c<=n.e.c;++c)o[c]=ei(c);for(var p=n.s.r;p<=n.e.r;++p)for(i=On(p),c=n.s.c;c<=n.e.c;++c)if(t=o[c]+i,r=h?(e[p]||[])[c]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}d[d.length]=t+"="+a}return d}function j5(e,t,r){var a=r||{},n=+!a.skipHeader,i=e||{},o=0,c=0;if(i&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var d=typeof a.origin=="string"?wn(a.origin):a.origin;o=d.r,c=d.c}var h,p={s:{c:0,r:0},e:{c,r:o+t.length-1+n}};if(i["!ref"]){var x=va(i["!ref"]);p.e.c=Math.max(p.e.c,x.e.c),p.e.r=Math.max(p.e.r,x.e.r),o==-1&&(o=x.e.r+1,p.e.r=o+t.length-1+n)}else o==-1&&(o=0,p.e.r=t.length-1+n);var v=a.header||[],b=0;t.forEach(function(_,C){Dn(_).forEach(function(T){(b=v.indexOf(T))==-1&&(v[b=v.length]=T);var A=_[T],k="z",I="",B=Yr({c:c+b,r:o+C+n});h=Fp(i,B),A&&typeof A=="object"&&!(A instanceof Date)?i[B]=A:(typeof A=="number"?k="n":typeof A=="boolean"?k="b":typeof A=="string"?k="s":A instanceof Date?(k="d",a.cellDates||(k="n",A=Ii(A)),I=a.dateNF||Ma[14]):A===null&&a.nullError&&(k="e",A=0),h?(h.t=k,h.v=A,delete h.w,delete h.R,I&&(h.z=I)):i[B]=h={t:k,v:A},I&&(h.z=I))})}),p.e.c=Math.max(p.e.c,c+v.length-1);var N=On(o);if(n)for(b=0;b<v.length;++b)i[ei(b+c)+N]={t:"s",v:v[b]};return i["!ref"]=Za(p),i}function Lne(e,t){return j5(null,e,t)}function Fp(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=wn(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Fp(e,Yr(t)):Fp(e,Yr({r:t,c:r||0}))}function Fne(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Bne(){return{SheetNames:[],Sheets:{}}}function Vne(e,t,r,a){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var o=i&&i[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=o+n)!=-1;++n);}if(h5(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Une(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=Fne(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function zne(e,t){return e.z=t,e}function N5(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function $ne(e,t,r){return N5(e,"#"+t,r)}function qne(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Wne(e,t,r,a){for(var n=typeof t!="string"?t:va(t),i=typeof t=="string"?t:Za(t),o=n.s.r;o<=n.e.r;++o)for(var c=n.s.c;c<=n.e.c;++c){var d=Fp(e,o,c);d.t="n",d.F=i,delete d.v,o==n.s.r&&c==n.s.c&&(d.f=r,a&&(d.D=!0))}return e}var bv={encode_col:ei,encode_row:On,encode_cell:Yr,encode_range:Za,decode_col:F_,decode_row:L_,split_cell:nJ,decode_cell:wn,decode_range:so,format_cell:_c,sheet_add_aoa:NI,sheet_add_json:j5,sheet_add_dom:g5,aoa_to_sheet:Hf,json_to_sheet:Lne,table_to_sheet:v5,table_to_book:mne,sheet_to_csv:X_,sheet_to_txt:_5,sheet_to_json:fg,sheet_to_html:x5,sheet_to_formulae:Mne,sheet_to_row_object_array:fg,sheet_get_cell:Fp,book_new:Bne,book_append_sheet:Vne,book_set_sheet_visibility:Une,cell_set_number_format:zne,cell_set_hyperlink:N5,cell_set_internal_link:$ne,cell_add_comment:qne,sheet_set_array_formula:Wne,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};async function C5(e,t=!1){try{console.log(` Iniciando geocodificao para cooperativa ${e}`);const{data:r,error:a}=await J.from("cooperativas").select("id, nome_fantasia, logradouro, numero, bairro, cidade, uf, cep, latitude, longitude").eq("id",e).single();if(a||!r)throw new Error("Cooperativa no encontrada");if(!t&&r.latitude&&r.longitude)return console.log(` Cooperativa j tem coordenadas: ${r.latitude}, ${r.longitude}`),{success:!0,latitude:r.latitude,longitude:r.longitude,precision:"cached",cached:!0,message:"Cooperativa j possui coordenadas"};const n={latitude:r.latitude,longitude:r.longitude};t&&r.latitude&&r.longitude&&console.log(` Forando atualizao de coordenadas existentes: ${r.latitude}, ${r.longitude}`);const o=[r.logradouro,r.numero,r.bairro,r.cidade,r.uf,r.cep,"Brasil"].filter(Boolean).join(", ");console.log(` Buscando coordenadas para: ${o}`);let c=null,d=null,h="unknown";const p="pk.be1a87c6f8f1ceb800977d7c8842a3ab";try{console.log(" Tentativa 0: LocationIQ com endereo completo...");const v=`https://us1.locationiq.com/v1/search?key=${p}&q=${encodeURIComponent(o)}&format=json&countrycodes=br&limit=1&addressdetails=1`,b=await fetch(v,{headers:{Accept:"application/json"}});if(b.ok){const N=await b.json();if(N.length>0){c=parseFloat(N[0].lat),d=parseFloat(N[0].lon);const _=N[0].display_name||"";_.includes(r.logradouro||"")&&_.includes(r.numero||"")?(h="address",console.log(` Coordenadas encontradas via LocationIQ (endereo completo): ${c}, ${d}`)):_.includes(r.cep||"")?(h="postal_code",console.log(` Coordenadas encontradas via LocationIQ (CEP): ${c}, ${d}`)):(h="street",console.log(` Coordenadas encontradas via LocationIQ (rua): ${c}, ${d}`))}}}catch(v){console.log(" LocationIQ no disponvel, tentando outras fontes...",v)}if((!c||!d)&&r.cep)try{const v=r.cep.replace(/\D/g,"");console.log(` Tentando AwesomeAPI com CEP: ${v}`);const b=`https://cep.awesomeapi.com.br/json/${v}`,N=await fetch(b,{headers:{Accept:"application/json"}});if(N.ok){const _=await N.json();_.lat&&_.lng&&(c=parseFloat(_.lat),d=parseFloat(_.lng),h="postal_code",console.log(` Coordenadas encontradas via AwesomeAPI (CEP): ${c}, ${d}`),console.log(` Endereo: ${_.address}, ${_.district} - ${_.city}/${_.state}`))}}catch{console.log(" AwesomeAPI no disponvel ou CEP sem coordenadas, tentando outras fontes...")}if(!c||!d){const v=`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(o)}&countrycodes=br&limit=1`,N=await(await fetch(v,{headers:{"User-Agent":"Ciclik-App/1.0",Accept:"application/json"}})).json();N.length>0&&(c=parseFloat(N[0].lat),d=parseFloat(N[0].lon),h="address",console.log(` Coordenadas encontradas (endereo completo): ${c}, ${d}`))}if(!c||!d){console.log(" Endereo completo no encontrado, tentando rua + bairro + cidade");const v=[r.logradouro,r.bairro,r.cidade,r.uf,"Brasil"].filter(Boolean).join(", "),b=`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(v)}&countrycodes=br&limit=1`;await new Promise(C=>setTimeout(C,1e3));const _=await(await fetch(b,{headers:{"User-Agent":"Ciclik-App/1.0",Accept:"application/json"}})).json();if(_.length>0)c=parseFloat(_[0].lat),d=parseFloat(_[0].lon),h="street",console.log(` Coordenadas encontradas (rua + bairro): ${c}, ${d}`);else{if(r.cep&&h!=="postal_code"){console.log(" Rua + bairro no encontrado, tentando CEP + cidade via Nominatim");const C=`${r.cep}, ${r.cidade}, ${r.uf}, Brasil`,T=`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(C)}&countrycodes=br&limit=1`;await new Promise(I=>setTimeout(I,1e3));const k=await(await fetch(T,{headers:{"User-Agent":"Ciclik-App/1.0",Accept:"application/json"}})).json();k.length>0&&(c=parseFloat(k[0].lat),d=parseFloat(k[0].lon),h="postal_code",console.log(` Coordenadas encontradas (CEP): ${c}, ${d}`))}if(!c||!d){console.log(" Todas as tentativas anteriores falharam, tentando apenas cidade + UF (ltimo recurso)");const C=`${r.cidade}, ${r.uf}, Brasil`,T=`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(C)}&countrycodes=br&limit=1`;await new Promise(I=>setTimeout(I,1e3));const k=await(await fetch(T,{headers:{"User-Agent":"Ciclik-App/1.0",Accept:"application/json"}})).json();if(k.length>0){if(c=parseFloat(k[0].lat),d=parseFloat(k[0].lon),h="city",console.log(` Coordenadas encontradas (cidade - genrico): ${c}, ${d}`),n.latitude&&n.longitude)return console.warn(" Coordenadas genricas (centro da cidade). Mantendo coordenadas existentes."),{success:!0,latitude:n.latitude,longitude:n.longitude,precision:"cached",cached:!0,message:"Endereo no encontrado com preciso. Coordenadas anteriores mantidas."}}else throw new Error(`No foi possvel encontrar coordenadas para: ${r.cidade}, ${r.uf}`)}}}if(c&&d){if(!(c>=-34&&c<=6&&d>=-75&&d<=-28)){if(console.error(` ERRO: Coordenadas fora do Brasil! [${c}, ${d}]`),n.latitude&&n.longitude)return console.warn(" Mantendo coordenadas anteriores por segurana."),{success:!0,latitude:n.latitude,longitude:n.longitude,precision:"cached",cached:!0,message:"Coordenadas encontradas esto fora do Brasil. Coordenadas anteriores mantidas."};throw new Error(`Coordenadas encontradas esto fora do Brasil (${c}, ${d}). Verifique o endereo.`)}console.log(" Coordenadas validadas: dentro do territrio brasileiro")}console.log(` Salvando coordenadas no banco: [${c}, ${d}]`);const{error:x}=await J.from("cooperativas").update({latitude:c,longitude:d}).eq("id",e).select().single();if(x)throw console.error(" Erro ao atualizar coordenadas no banco:",x),x.code==="P0001"&&t?(console.warn(" Erro de duplicatas ao atualizar a mesma cooperativa. Isso indica um problema na trigger/policy do banco."),new Error("Erro ao atualizar coordenadas: A validao de duplicatas no est considerando que  a mesma cooperativa sendo atualizada. Por favor, ajuste a trigger/policy no Supabase para excluir a prpria cooperativa (NEW.id ou id atual) da verificao durante UPDATE.")):new Error(`Erro ao atualizar coordenadas: ${x.message}`);return console.log(` Cooperativa atualizada com sucesso! Nova localizao: [${c}, ${d}]`),{success:!0,latitude:c,longitude:d,precision:h,cached:!1,message:"Coordenadas adicionadas com sucesso"}}catch(r){throw console.error(" Erro na geocodificao:",r),new Error(r.message||"Erro ao geocodificar cooperativa")}}async function Hne(e){try{ct.loading("Buscando localizao...",{id:"geocoding"});const t=await C5(e);if(ct.dismiss("geocoding"),t.cached)ct.info("Cooperativa j possui coordenadas");else{let r="desconhecido",a="";t.precision==="address"?(r="endereo completo (alta preciso)",a=""):t.precision==="street"?(r="rua + bairro (preciso mdia)",a=""):t.precision==="postal_code"?(r="CEP brasileiro (preciso boa) ",a=""):t.precision==="city"?(r="centro da cidade (preciso baixa)",a=""):t.precision==="cached"&&(r="coordenadas anteriores mantidas",a=""),ct.success("Localizao encontrada!",{description:`${a} Coordenadas baseadas em: ${r}`,duration:t.precision==="city"?8e3:4e3})}return t}catch(t){throw ct.dismiss("geocoding"),ct.error("Erro ao buscar localizao",{description:t.message}),t}}async function Gne(e){try{ct.loading("Atualizando localizao no mapa...",{id:"geocoding"});const t=await C5(e,!0);ct.dismiss("geocoding");let r="desconhecido",a="";t.precision==="address"?(r="endereo completo (alta preciso)",a=""):t.precision==="street"?(r="rua + bairro (preciso mdia)",a=""):t.precision==="postal_code"?(r="CEP brasileiro (preciso boa) ",a=""):t.precision==="city"?(r="centro da cidade (preciso baixa)",a=""):t.precision==="cached"&&(r="coordenadas anteriores mantidas (endereo no encontrado)",a="");const n=t.precision==="city"||t.precision==="cached";return ct[n?"warning":"success"]("Localizao atualizada!",{description:`${a} ${r}`,duration:n?8e3:4e3}),t}catch(t){throw ct.dismiss("geocoding"),ct.error("Erro ao atualizar localizao",{description:t.message}),t}}const tx=e=>{let t=e.replace(/[^\d,]/g,"");const r=t.split(",");r.length>2&&(t=r[0]+","+r.slice(1).join(""));const[a,n]=t.split(","),i=a.replace(/\B(?=(\d{3})+(?!\d))/g,".");return n!==void 0?`${i},${n.substring(0,2)}`:i},tS=e=>e.replace(/\./g,"").replace(",",".");function Kne(){const[e,t]=E.useState([]),[r,a]=E.useState(null),[n,i]=E.useState(!1),[o,c]=E.useState(!1),[d,h]=E.useState(!1),[p,x]=E.useState(!1),[v,b]=E.useState(!1),[N,_]=E.useState([]),[C,T]=E.useState(""),[A,k]=E.useState({}),[I,B]=E.useState(!1),[O,D]=E.useState({cnpj:"",razao_social:"",nome_fantasia:"",email:"",cep:"",logradouro:"",numero:"",complemento:"",bairro:"",cidade:"",uf:"",whatsapp:"",capacidade_mensal_ton:"",tipo_operador:"cooperativa",tipo_pj:"Outro"}),[F,M]=E.useState(null),[z,q]=E.useState(null),[Y,ae]=E.useState(""),[je,H]=E.useState("all"),[Z,G]=E.useState("all"),Q=ds(),{toast:re}=_r();E.useEffect(()=>{le()},[]);const le=async()=>{const{data:we}=await J.from("cooperativas").select("*").order("data_cadastro",{ascending:!1});we&&(t(we),we.forEach(W))},ye=async we=>{const Le=we.replace(/\D/g,"");if(Le.length===8){B(!0);try{const Ge=await(await fetch(`https://viacep.com.br/ws/${Le}/json/`)).json();if(Ge.erro){re({title:"CEP no encontrado",description:"Verifique o CEP informado",variant:"destructive"});return}D(Lt=>({...Lt,logradouro:Ge.logradouro||"",bairro:Ge.bairro||"",cidade:Ge.localidade||"",uf:Ge.uf||"",complemento:Ge.complemento||""})),re({title:"Endereo encontrado! ",description:`${Ge.logradouro}, ${Ge.bairro} - ${Ge.localidade}/${Ge.uf}`})}catch{re({title:"Erro ao buscar CEP",description:"No foi possvel consultar o CEP. Preencha manualmente.",variant:"destructive"})}finally{B(!1)}}},W=async we=>{const{data:Le}=await J.from("entregas_reciclaveis").select("peso_validado, status").eq("id_cooperativa",we.id),Nt=(Le==null?void 0:Le.length)||0,Ge=(Le==null?void 0:Le.reduce((ps,ns)=>ps+(ns.peso_validado||0),0))||0,Lt=(Le==null?void 0:Le.filter(ps=>ps.status==="validada").length)||0;k(ps=>({...ps,[we.id]:{totalEntregas:Nt,pesoTotal:Ge,validadas:Lt}}))},ee=async(we,Le)=>{try{const{error:Nt}=await J.from("cooperativas").update({status:Le}).eq("id",we);if(Nt)throw Nt;re({title:"Status atualizado!",description:`Operador ${Le==="aprovada"?"aprovado":Le==="suspensa"?"bloqueado":"atualizado"} com sucesso`}),le()}catch(Nt){re({title:"Erro",description:Nt.message,variant:"destructive"})}},ie=async(we,Le)=>{try{const{error:Nt}=await J.from("cooperativas").update({pontuacao_confiabilidade:Le}).eq("id",we);if(Nt)throw Nt;re({title:"Pontuao atualizada!"}),le(),i(!1)}catch(Nt){re({title:"Erro",description:Nt.message,variant:"destructive"})}},ce=async we=>{if(confirm("Tem certeza que deseja excluir este operador? Esta ao no pode ser desfeita."))try{const{error:Le}=await J.from("cooperativas").delete().eq("id",we);if(Le)throw Le;re({title:"Operador excludo!",description:"O operador foi removido do sistema"}),le()}catch(Le){re({title:"Erro ao excluir",description:Le.message,variant:"destructive"})}},xe=async we=>{try{const{data:Le,error:Nt}=await J.from("emails_cooperativas").select("*").eq("id_cooperativa",we).order("data_envio",{ascending:!1});if(Nt)throw Nt;_(Le||[])}catch(Le){re({title:"Erro ao carregar histrico",description:Le.message,variant:"destructive"})}},Ce=async()=>{if(!r||!C){re({title:"Email obrigatrio",description:"Por favor, informe um email vlido",variant:"destructive"});return}if(!C.includes("@")){re({title:"Email invlido",description:"Por favor, informe um email vlido",variant:"destructive"});return}B(!0);try{const{error:we}=await J.from("cooperativas").update({email:C}).eq("id",r.id);if(we)throw we;const{error:Le}=await J.auth.resetPasswordForEmail(C,{redirectTo:Il("/reset-password")});if(Le)throw Le;re({title:"Sucesso! ",description:`Email atualizado para ${C} e link de reset enviado.`}),b(!1),T(""),le()}catch(we){re({title:"Erro",description:we.message,variant:"destructive"})}finally{B(!1)}},me=async()=>{var we,Le;if(!cf(O.cnpj)){re({title:"CNPJ invlido",description:"Por favor, verifique o CNPJ informado",variant:"destructive"});return}if(!O.razao_social||!O.nome_fantasia||!O.cep||!O.whatsapp||!O.email){re({title:"Campos obrigatrios",description:"Preencha todos os campos obrigatrios",variant:"destructive"});return}B(!0);try{const Nt={cnpj:O.cnpj,razao_social:O.razao_social,nome_fantasia:O.nome_fantasia,email:O.email,cep:O.cep,logradouro:O.logradouro,numero:O.numero,complemento:O.complemento,bairro:O.bairro,cidade:O.cidade,uf:O.uf,whatsapp:O.whatsapp,tipo_operador:O.tipo_operador};O.capacidade_mensal_ton&&(Nt.capacidade_mensal_ton=parseFloat(O.capacidade_mensal_ton));const{error:Ge}=await J.from("cooperativas").update(Nt).eq("id",r.id);if(Ge)throw Ge;const{error:Lt}=await J.from("profiles").update({nome:O.nome_fantasia,cnpj:O.cnpj,cep:O.cep,logradouro:O.logradouro,numero:O.numero,complemento:O.complemento,bairro:O.bairro,cidade:O.cidade,uf:O.uf,telefone:O.whatsapp,tipo_pj:O.tipo_pj}).eq("id",r.id_user);Lt&&console.error("Erro ao atualizar profile:",Lt);const ps=O.cep!==r.cep||O.logradouro!==r.logradouro||O.numero!==r.numero||O.cidade!==r.cidade||O.uf!==r.uf;let ns=!1;if(ps)try{await Gne(r.id),ns=!0}catch(Ke){console.error("Erro ao geocodificar cooperativa:",Ke),(we=Ke.message)!=null&&we.includes("P0001")||(Le=Ke.message)!=null&&Le.includes("duplicadas")?(console.warn(" Erro de coordenadas duplicadas (possivelmente da prpria cooperativa). Favor corrigir trigger no banco."),re({title:"Aviso",description:"Dados atualizados, mas h um problema na validao de coordenadas duplicadas. O mapa pode no atualizar corretamente.",variant:"default",duration:5e3})):re({title:"Aviso",description:"Dados atualizados, mas no foi possvel atualizar a localizao no mapa.",variant:"default"})}re({title:"Operador atualizado!",description:ns?"Dados e localizao no mapa atualizados com sucesso":"Os dados cadastrais foram atualizados com sucesso"}),h(!1),await new Promise(Ke=>setTimeout(Ke,500)),le()}catch(Nt){re({title:"Erro ao atualizar",description:Nt.message,variant:"destructive"})}finally{B(!1)}},fe=async(we,Le,Nt)=>{const Ge=we.name.split(".").pop(),Lt=`${Le}/${Nt}_${Date.now()}.${Ge}`,{error:ps}=await J.storage.from("cooperative-documents").upload(Lt,we);if(ps)throw ps;const{data:{publicUrl:ns}}=J.storage.from("cooperative-documents").getPublicUrl(Lt);return ns},ve=async()=>{if(!cf(O.cnpj)){re({title:"CNPJ invlido",description:"Por favor, verifique o CNPJ informado",variant:"destructive"});return}if(!O.razao_social||!O.nome_fantasia||!O.cep||!O.whatsapp||!O.email){re({title:"Campos obrigatrios",description:"Preencha todos os campos obrigatrios, incluindo o email",variant:"destructive"});return}B(!0);try{const{data:we,error:Le}=await J.from("cooperativas").select("id, nome_fantasia, email").eq("email",O.email).maybeSingle();if(Le&&Le.code!=="PGRST116")throw Le;if(we){re({title:"Email j cadastrado",description:`Este email j est registrado para: ${we.nome_fantasia}. Por favor, utilize outro email.`,variant:"destructive"}),B(!1);return}const{data:Nt,error:Ge}=await J.auth.signUp({email:O.email,password:Math.random().toString(36).slice(-12)+"A1!",options:{data:{nome:O.nome_fantasia,tipo_pessoa:"PJ",tipo_pj:O.tipo_pj,cnpj:O.cnpj,cep:O.cep,logradouro:O.logradouro,numero:O.numero,complemento:O.complemento,bairro:O.bairro,cidade:O.cidade,uf:O.uf,telefone:O.whatsapp,role:"cooperativa"}}});if(Ge)throw Ge;if(!Nt.user)throw new Error("Falha ao criar usurio");await new Promise(Ke=>setTimeout(Ke,1e3));try{await J.rpc("confirmar_email_usuario",{usuario_id:Nt.user.id})}catch(Ke){console.error("Erro ao confirmar email automaticamente:",Ke)}const{data:Lt,error:ps}=await J.from("cooperativas").insert({id_user:Nt.user.id,cnpj:O.cnpj,razao_social:O.razao_social,nome_fantasia:O.nome_fantasia,email:O.email,cep:O.cep,logradouro:O.logradouro,numero:O.numero,complemento:O.complemento,bairro:O.bairro,cidade:O.cidade,uf:O.uf,whatsapp:O.whatsapp,capacidade_mensal_ton:O.capacidade_mensal_ton?parseFloat(O.capacidade_mensal_ton):null,tipo_operador:O.tipo_operador,status:"aprovada"}).select().single();if(ps)throw ps;if(F&&Lt){const Ke=await fe(F,Lt.id,"constituicao");await J.from("cooperativas").update({documento_constituicao_url:Ke}).eq("id",Lt.id)}if(z&&Lt){const Ke=await fe(z,Lt.id,"representante");await J.from("cooperativas").update({documento_representante_url:Ke}).eq("id",Lt.id)}try{await Hne(Lt.id)}catch(Ke){console.error("Erro ao geocodificar cooperativa:",Ke),re({title:"Aviso",description:"Cooperativa criada, mas no foi possvel obter a localizao automaticamente. Voc pode geocodificar depois.",variant:"default"})}const{error:ns}=await J.auth.resetPasswordForEmail(O.email,{redirectTo:Il("/reset-password")});re(ns?{title:"Operador criado!",description:"O operador foi cadastrado com sucesso"}:{title:"Operador criado com sucesso! ",description:`Email de reset de senha enviado para ${O.email}. O operador deve verificar a caixa de entrada.`}),c(!1),ne(),le()}catch(we){re({title:"Erro ao criar operador",description:we.message,variant:"destructive"})}finally{B(!1)}},ne=()=>{D({cnpj:"",razao_social:"",nome_fantasia:"",email:"",cep:"",logradouro:"",numero:"",complemento:"",bairro:"",cidade:"",uf:"",whatsapp:"",capacidade_mensal_ton:"",tipo_operador:"cooperativa",tipo_pj:"Outro"}),M(null),q(null)},Me=we=>({aprovada:s.jsx(Je,{className:"bg-success text-white",children:"Aprovada"}),pendente_aprovacao:s.jsx(Je,{className:"bg-warning text-white",children:"Pendente"}),suspensa:s.jsx(Je,{variant:"destructive",className:"text-white",children:"Bloqueada"})})[we]||s.jsx(Je,{className:"text-white",children:we}),Ie=we=>({cooperativa:s.jsx(Je,{variant:"default",className:"bg-success text-white",children:"Cooperativa"}),rota_ciclik:s.jsx(Je,{variant:"default",className:"bg-primary text-white",children:"Rota Ciclik"}),operador_parceiro:s.jsx(Je,{variant:"default",className:"bg-secondary text-white",children:"Operador Parceiro"})})[we]||s.jsx(Je,{className:"text-white",children:we}),Be=we=>({cooperativa:"Cooperativa",rota_ciclik:"Rota Ciclik",operador_parceiro:"Operador Parceiro"})[we]||we,ot=we=>{let Le=we==="all"?e:e.filter(Nt=>Nt.status===we);return Y&&(Le=Le.filter(Nt=>Nt.cnpj.includes(Y))),je!=="all"&&(Le=Le.filter(Nt=>Nt.uf===je)),Z!=="all"&&(Le=Le.filter(Nt=>Nt.tipo_operador===Z)),Le},Se=()=>{const we=e.map(Ge=>{var Lt,ps,ns,Ke;return{Tipo:Be(Ge.tipo_operador),"Nome Fantasia":Ge.nome_fantasia,"Razo Social":Ge.razao_social,CNPJ:Ge.cnpj,CEP:Ge.cep,Logradouro:Ge.logradouro,Nmero:Ge.numero,Bairro:Ge.bairro,Cidade:Ge.cidade,UF:Ge.uf,WhatsApp:Ge.whatsapp,Status:Ge.status,Confiabilidade:Ge.pontuacao_confiabilidade,"Total Entregas":((Lt=A[Ge.id])==null?void 0:Lt.totalEntregas)||0,"Peso Total (kg)":((ns=(ps=A[Ge.id])==null?void 0:ps.pesoTotal)==null?void 0:ns.toFixed(2))||0,"Entregas Validadas":((Ke=A[Ge.id])==null?void 0:Ke.validadas)||0,"Data Cadastro":new Date(Ge.data_cadastro).toLocaleDateString("pt-BR")}}),Le=bv.json_to_sheet(we),Nt=bv.book_new();bv.book_append_sheet(Nt,Le,"Operadores Logsticos"),Ine(Nt,`operadores_logisticos_${new Date().toISOString().split("T")[0]}.xlsx`),re({title:"Exportado com sucesso!",description:"Arquivo Excel baixado"})},ze=["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"];return s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-8",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>Q("/admin"),className:"gap-2",children:[s.jsx(As,{className:"h-4 w-4"}),"Voltar"]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(oe,{variant:"outline",onClick:Se,children:[s.jsx(Ua,{className:"mr-2 h-4 w-4"}),"Exportar Excel"]}),s.jsxs(oe,{onClick:()=>c(!0),children:[s.jsx(ra,{className:"mr-2 h-4 w-4"}),"Novo Operador"]})]})]}),s.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Gesto de Operadores Logsticos"}),s.jsx(Ne,{className:"mb-6",children:s.jsx(De,{className:"pt-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"search-cnpj",children:"Buscar por CNPJ"}),s.jsxs("div",{className:"relative",children:[s.jsx(eo,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),s.jsx(We,{id:"search-cnpj",placeholder:"Digite o CNPJ...",value:Y,onChange:we=>ae(we.target.value),className:"pl-9"})]})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"search-uf",children:"Filtrar por Estado"}),s.jsxs("select",{id:"search-uf",value:je,onChange:we=>H(we.target.value),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring",children:[s.jsx("option",{value:"all",children:"Todos os Estados"}),ze.map(we=>s.jsx("option",{value:we,children:we},we))]})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"filter-tipo",children:"Filtrar por Tipo"}),s.jsxs(qs,{value:Z,onValueChange:we=>G(we),children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Todos os tipos"})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"all",children:"Todos os tipos"}),s.jsx(xt,{value:"cooperativa",children:"Cooperativas"}),s.jsx(xt,{value:"rota_ciclik",children:"Rotas Ciclik"}),s.jsx(xt,{value:"operador_parceiro",children:"Operadores Parceiros"})]})]})]}),s.jsx("div",{className:"flex items-end",children:s.jsx(oe,{variant:"outline",onClick:()=>{ae(""),H("all"),G("all")},className:"w-full",children:"Limpar Filtros"})})]})})}),s.jsxs(Mn,{defaultValue:"all",className:"w-full",children:[s.jsxs(Nn,{className:"grid w-full grid-cols-4 mb-8",children:[s.jsx(Gs,{value:"all",children:"Todos"}),s.jsx(Gs,{value:"pendente_aprovacao",children:"Pendentes"}),s.jsx(Gs,{value:"aprovada",children:"Aprovados"}),s.jsx(Gs,{value:"suspensa",children:"Bloqueados"})]}),["all","pendente_aprovacao","aprovada","suspensa"].map(we=>s.jsx(hr,{value:we,children:s.jsx(Ne,{children:s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{children:"Tipo"}),s.jsx(rt,{children:"Nome Fantasia"}),s.jsx(rt,{children:"Razo Social"}),s.jsx(rt,{children:"CNPJ"}),s.jsx(rt,{children:"Email"}),s.jsx(rt,{children:"Cidade/UF"}),s.jsx(rt,{className:"text-center",children:"Status"}),s.jsx(rt,{className:"text-center",children:"Confiabilidade"}),s.jsx(rt,{className:"text-center",children:"Entregas"}),s.jsx(rt,{className:"text-right",children:"Aes"})]})}),s.jsx(da,{children:ot(we).length===0?s.jsx(Cs,{children:s.jsx(Ze,{colSpan:10,className:"text-center text-muted-foreground h-32",children:"Nenhum operador encontrado"})}):ot(we).map(Le=>{var Nt;return s.jsxs(Cs,{children:[s.jsx(Ze,{children:Ie(Le.tipo_operador)}),s.jsx(Ze,{className:"font-medium",children:Le.nome_fantasia}),s.jsx(Ze,{children:Le.razao_social}),s.jsx(Ze,{className:"text-sm",children:Le.cnpj}),s.jsx(Ze,{className:"text-sm",children:Le.email||"No informado"}),s.jsxs(Ze,{className:"text-sm",children:[Le.cidade,"/",Le.uf]}),s.jsx(Ze,{className:"text-center",children:Me(Le.status)}),s.jsx(Ze,{className:"text-center",children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx(sp,{className:"h-4 w-4 text-warning fill-warning"}),s.jsx("span",{className:"font-semibold",children:Le.pontuacao_confiabilidade||100})]})}),s.jsx(Ze,{className:"text-center font-semibold",children:((Nt=A[Le.id])==null?void 0:Nt.totalEntregas)||0}),s.jsx(Ze,{className:"text-right",children:s.jsxs(S_,{children:[s.jsx(T_,{asChild:!0,children:s.jsx(oe,{variant:"ghost",size:"sm",children:s.jsx(x4,{className:"h-4 w-4"})})}),s.jsxs(Xg,{align:"end",children:[Le.status==="pendente_aprovacao"&&s.jsxs(Ka,{onClick:()=>ee(Le.id,"aprovada"),children:[s.jsx(Tr,{className:"h-4 w-4 mr-2"}),"Aprovar"]}),Le.status==="aprovada"&&s.jsxs(Ka,{onClick:()=>ee(Le.id,"suspensa"),className:"text-destructive",children:[s.jsx(I6,{className:"h-4 w-4 mr-2"}),"Bloquear"]}),Le.status==="suspensa"&&s.jsxs(Ka,{onClick:()=>ee(Le.id,"aprovada"),children:[s.jsx(Tr,{className:"h-4 w-4 mr-2"}),"Desbloquear"]}),s.jsxs(Ka,{onClick:()=>{a(Le),i(!0)},children:[s.jsx(sp,{className:"h-4 w-4 mr-2"}),"Ajustar Pontuao"]}),s.jsxs(Ka,{onClick:()=>{var Ge;a(Le),D({cnpj:Le.cnpj||"",razao_social:Le.razao_social||"",nome_fantasia:Le.nome_fantasia||"",email:Le.email||"",cep:Le.cep||"",logradouro:Le.logradouro||"",numero:Le.numero||"",complemento:Le.complemento||"",bairro:Le.bairro||"",cidade:Le.cidade||"",uf:Le.uf||"",whatsapp:Le.whatsapp||"",capacidade_mensal_ton:((Ge=Le.capacidade_mensal_ton)==null?void 0:Ge.toString())||"",tipo_operador:Le.tipo_operador||"cooperativa",tipo_pj:Le.tipo_pj||"Outro"}),h(!0)},children:[s.jsx(Nd,{className:"h-4 w-4 mr-2"}),"Editar Dados Cadastrais"]}),s.jsxs(Ka,{onClick:()=>{a(Le),T(Le.email||""),b(!0)},children:[s.jsx(sf,{className:"h-4 w-4 mr-2"}),"Editar Email e Reenviar Convite"]}),s.jsxs(Ka,{onClick:()=>{a(Le),xe(Le.id),x(!0)},children:[s.jsx(Qa,{className:"h-4 w-4 mr-2"}),"Histrico de Emails"]}),s.jsxs(Ka,{onClick:()=>ce(Le.id),className:"text-destructive",children:[s.jsx(Ba,{className:"h-4 w-4 mr-2"}),"Excluir"]})]})]})})]},Le.id)})})]})})},we))]}),s.jsx(ar,{open:n,onOpenChange:i,children:s.jsxs(tr,{children:[s.jsx(nr,{children:s.jsx(ir,{children:"Ajustar Pontuao de Confiabilidade"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(ke,{children:"Operador"}),s.jsx("p",{className:"text-sm",children:r==null?void 0:r.nome_fantasia})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"pontuacao",children:"Nova Pontuao (0-100)"}),s.jsx(We,{id:"pontuacao",type:"number",min:"0",max:"100",defaultValue:(r==null?void 0:r.pontuacao_confiabilidade)||100,onChange:we=>{r&&a({...r,pontuacao_confiabilidade:parseInt(we.target.value)})}})]}),s.jsx(oe,{onClick:()=>ie(r==null?void 0:r.id,r==null?void 0:r.pontuacao_confiabilidade),className:"w-full",children:"Atualizar"})]})]})}),s.jsx(ar,{open:o,onOpenChange:c,children:s.jsxs(tr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsx(nr,{children:s.jsx(ir,{children:"Cadastrar Novo Operador Logstico"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"tipo_operador",children:"Tipo de Operador *"}),s.jsxs(qs,{value:O.tipo_operador,onValueChange:we=>D({...O,tipo_operador:we}),children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Selecione o tipo"})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"cooperativa",children:"Cooperativa"}),s.jsx(xt,{value:"rota_ciclik",children:"Rota Ciclik"}),s.jsx(xt,{value:"operador_parceiro",children:"Operador Parceiro"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"cnpj",children:"CNPJ *"}),s.jsx(We,{id:"cnpj",value:O.cnpj,onChange:we=>D({...O,cnpj:xp(we.target.value)}),placeholder:"00.000.000/0000-00",maxLength:18})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"whatsapp",children:"WhatsApp *"}),s.jsx(We,{id:"whatsapp",value:O.whatsapp,onChange:we=>D({...O,whatsapp:gp(we.target.value)}),placeholder:"(00) 00000-0000",maxLength:15})]})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"razao_social",children:"Razo Social *"}),s.jsx(We,{id:"razao_social",value:O.razao_social,onChange:we=>D({...O,razao_social:we.target.value})})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"nome_fantasia",children:"Nome Fantasia *"}),s.jsx(We,{id:"nome_fantasia",value:O.nome_fantasia,onChange:we=>D({...O,nome_fantasia:we.target.value})})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"email",children:"Email *"}),s.jsx(We,{id:"email",type:"email",value:O.email,onChange:we=>D({...O,email:we.target.value}),placeholder:"email@operador.com"})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"tipo_pj",children:"Tipo de Organizao *"}),s.jsxs("select",{id:"tipo_pj",value:O.tipo_pj,onChange:we=>D({...O,tipo_pj:we.target.value}),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring",children:[s.jsx("option",{value:"Condominio",children:"Condomnio"}),s.jsx("option",{value:"Restaurante",children:"Restaurante"}),s.jsx("option",{value:"Comercio",children:"Comrcio"}),s.jsx("option",{value:"Servico",children:"Servio"}),s.jsx("option",{value:"Industria",children:"Indstria"}),s.jsx("option",{value:"Outro",children:"Outro"})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsxs(ke,{htmlFor:"cep",children:["CEP * ",I&&s.jsx("span",{className:"text-xs text-muted-foreground",children:"(buscando...)"})]}),s.jsx(We,{id:"cep",value:O.cep,onChange:we=>{const Le=vp(we.target.value);D({...O,cep:Le}),Le.replace(/\D/g,"").length===8&&ye(Le)},placeholder:"00000-000",maxLength:9,disabled:I,className:I?"animate-pulse":""}),O.cep&&O.cep.replace(/\D/g,"").length===8&&O.logradouro&&s.jsx("p",{className:"text-xs text-green-600 mt-1",children:" Endereo preenchido automaticamente"})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx(ke,{htmlFor:"logradouro",children:"Logradouro"}),s.jsx(We,{id:"logradouro",value:O.logradouro,onChange:we=>D({...O,logradouro:we.target.value})})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"numero",children:"Nmero"}),s.jsx(We,{id:"numero",value:O.numero,onChange:we=>D({...O,numero:we.target.value})})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx(ke,{htmlFor:"complemento",children:"Complemento"}),s.jsx(We,{id:"complemento",value:O.complemento,onChange:we=>D({...O,complemento:we.target.value})})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"bairro",children:"Bairro"}),s.jsx(We,{id:"bairro",value:O.bairro,onChange:we=>D({...O,bairro:we.target.value})})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"cidade",children:"Cidade"}),s.jsx(We,{id:"cidade",value:O.cidade,onChange:we=>D({...O,cidade:we.target.value})})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"uf",children:"UF"}),s.jsx(We,{id:"uf",value:O.uf,onChange:we=>D({...O,uf:we.target.value.toUpperCase()}),maxLength:2})]})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"capacidade",children:"Capacidade Mensal (toneladas)"}),s.jsx(We,{id:"capacidade",type:"text",value:tx(O.capacidade_mensal_ton),onChange:we=>{const Le=tx(we.target.value),Nt=tS(Le);D({...O,capacidade_mensal_ton:Nt})},placeholder:"0,00"})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"doc_constituicao",children:"Documento de Constituio"}),s.jsx(We,{id:"doc_constituicao",type:"file",onChange:we=>{var Le;return M(((Le=we.target.files)==null?void 0:Le[0])||null)},accept:".pdf,.jpg,.jpeg,.png"})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"doc_representante",children:"Documento do Representante"}),s.jsx(We,{id:"doc_representante",type:"file",onChange:we=>{var Le;return q(((Le=we.target.files)==null?void 0:Le[0])||null)},accept:".pdf,.jpg,.jpeg,.png"})]}),s.jsx(oe,{onClick:ve,disabled:I,className:"w-full",children:I?"Criando...":"Criar Operador"})]})]})}),s.jsx(ar,{open:d,onOpenChange:h,children:s.jsxs(tr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsx(nr,{children:s.jsx(ir,{children:"Editar Dados Cadastrais do Operador"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"edit_tipo_operador",children:"Tipo de Operador *"}),s.jsxs(qs,{value:O.tipo_operador,onValueChange:we=>D({...O,tipo_operador:we}),children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Selecione o tipo"})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"cooperativa",children:"Cooperativa"}),s.jsx(xt,{value:"rota_ciclik",children:"Rota Ciclik"}),s.jsx(xt,{value:"operador_parceiro",children:"Operador Parceiro"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"edit_cnpj",children:"CNPJ *"}),s.jsx(We,{id:"edit_cnpj",value:O.cnpj,onChange:we=>D({...O,cnpj:xp(we.target.value)}),placeholder:"00.000.000/0000-00",maxLength:18})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"edit_whatsapp",children:"WhatsApp *"}),s.jsx(We,{id:"edit_whatsapp",value:O.whatsapp,onChange:we=>D({...O,whatsapp:gp(we.target.value)}),placeholder:"(00) 00000-0000",maxLength:15})]})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"edit_razao_social",children:"Razo Social *"}),s.jsx(We,{id:"edit_razao_social",value:O.razao_social,onChange:we=>D({...O,razao_social:we.target.value})})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"edit_nome_fantasia",children:"Nome Fantasia *"}),s.jsx(We,{id:"edit_nome_fantasia",value:O.nome_fantasia,onChange:we=>D({...O,nome_fantasia:we.target.value})})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"edit_email",children:"Email *"}),s.jsx(We,{id:"edit_email",type:"email",value:O.email,onChange:we=>D({...O,email:we.target.value}),placeholder:"email@operador.com"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:'Nota: Para reenviar convite com novo email, use a opo "Editar Email e Reenviar Convite"'})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"edit_tipo_pj",children:"Tipo de Organizao *"}),s.jsxs("select",{id:"edit_tipo_pj",value:O.tipo_pj,onChange:we=>D({...O,tipo_pj:we.target.value}),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring",children:[s.jsx("option",{value:"Condominio",children:"Condomnio"}),s.jsx("option",{value:"Restaurante",children:"Restaurante"}),s.jsx("option",{value:"Comercio",children:"Comrcio"}),s.jsx("option",{value:"Servico",children:"Servio"}),s.jsx("option",{value:"Industria",children:"Indstria"}),s.jsx("option",{value:"Outro",children:"Outro"})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsxs(ke,{htmlFor:"edit_cep",children:["CEP * ",I&&s.jsx("span",{className:"text-xs text-muted-foreground",children:"(buscando...)"})]}),s.jsx(We,{id:"edit_cep",value:O.cep,onChange:we=>{const Le=vp(we.target.value);D({...O,cep:Le}),Le.replace(/\D/g,"").length===8&&ye(Le)},placeholder:"00000-000",maxLength:9,disabled:I,className:I?"animate-pulse":""}),O.cep&&O.cep.replace(/\D/g,"").length===8&&O.logradouro&&s.jsx("p",{className:"text-xs text-green-600 mt-1",children:" Endereo preenchido automaticamente"})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx(ke,{htmlFor:"edit_logradouro",children:"Logradouro"}),s.jsx(We,{id:"edit_logradouro",value:O.logradouro,onChange:we=>D({...O,logradouro:we.target.value})})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"edit_numero",children:"Nmero"}),s.jsx(We,{id:"edit_numero",value:O.numero,onChange:we=>D({...O,numero:we.target.value})})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx(ke,{htmlFor:"edit_complemento",children:"Complemento"}),s.jsx(We,{id:"edit_complemento",value:O.complemento,onChange:we=>D({...O,complemento:we.target.value})})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"edit_bairro",children:"Bairro"}),s.jsx(We,{id:"edit_bairro",value:O.bairro,onChange:we=>D({...O,bairro:we.target.value})})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"edit_cidade",children:"Cidade"}),s.jsx(We,{id:"edit_cidade",value:O.cidade,onChange:we=>D({...O,cidade:we.target.value})})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"edit_uf",children:"UF"}),s.jsx(We,{id:"edit_uf",value:O.uf,onChange:we=>D({...O,uf:we.target.value.toUpperCase()}),maxLength:2})]})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"edit_capacidade",children:"Capacidade Mensal (toneladas)"}),s.jsx(We,{id:"edit_capacidade",type:"text",value:tx(O.capacidade_mensal_ton),onChange:we=>{const Le=tx(we.target.value),Nt=tS(Le);D({...O,capacidade_mensal_ton:Nt})},placeholder:"0,00"})]}),s.jsx(oe,{onClick:me,disabled:I,className:"w-full",children:I?"Atualizando...":"Salvar Alteraes"})]})]})}),s.jsx(ar,{open:v,onOpenChange:b,children:s.jsxs(tr,{children:[s.jsx(nr,{children:s.jsx(ir,{children:"Editar Email e Reenviar Convite"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(ke,{children:"Operador"}),s.jsx("p",{className:"text-sm",children:r==null?void 0:r.nome_fantasia})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"novo_email",children:"Novo Email"}),s.jsx(We,{id:"novo_email",type:"email",value:C,onChange:we=>T(we.target.value),placeholder:"novo@email.com"})]}),s.jsx(oe,{onClick:Ce,disabled:I,className:"w-full",children:I?"Processando...":"Atualizar e Reenviar Convite"})]})]})}),s.jsx(ar,{open:p,onOpenChange:x,children:s.jsxs(tr,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[s.jsx(nr,{children:s.jsxs(ir,{children:["Histrico de Emails - ",r==null?void 0:r.nome_fantasia]})}),s.jsx("div",{className:"space-y-4",children:N.length===0?s.jsx("p",{className:"text-center text-muted-foreground py-8",children:"Nenhum email enviado"}):s.jsx("div",{className:"space-y-4",children:N.map(we=>s.jsx(Ne,{children:s.jsx(De,{className:"pt-6",children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:we.assunto}),s.jsx("p",{className:"text-sm text-muted-foreground",children:we.tipo_email})]}),s.jsx(Je,{className:we.status_envio==="enviado"?"bg-success":"bg-destructive",children:we.status_envio})]}),s.jsxs("p",{className:"text-sm",children:[s.jsx("strong",{children:"Para:"})," ",we.email_destino]}),s.jsxs("p",{className:"text-sm",children:[s.jsx("strong",{children:"Data:"})," ",new Date(we.data_envio).toLocaleString("pt-BR")]}),we.mensagem_erro&&s.jsxs("p",{className:"text-sm text-destructive",children:[s.jsx("strong",{children:"Erro:"})," ",we.mensagem_erro]})]})})},we.id))})})]})})]})})}function Xne(){const[e,t]=E.useState([]),[r,a]=E.useState(!1),[n,i]=E.useState(!1),[o,c]=E.useState({cnpj:"",razao_social:"",nome_fantasia:"",cep:"",logradouro:"",numero:"",complemento:"",bairro:"",cidade:"",uf:"",telefone:"",tipo_empresa:"marketplace",plano_atual:""}),d=ds(),{toast:h}=_r();E.useEffect(()=>{p()},[]);const p=async()=>{const{data:_}=await J.from("empresas").select(`
        *,
        profiles:id_user (nome, email, telefone, cnpj)
      `).order("created_at",{ascending:!1});_&&t(_)},x=async _=>{if(confirm("Tem certeza que deseja excluir esta empresa? Esta ao no pode ser desfeita."))try{const{error:C}=await J.from("empresas").delete().eq("id",_);if(C)throw C;h({title:"Empresa excluda!",description:"A empresa foi removida do sistema"}),p()}catch(C){h({title:"Erro ao excluir",description:C.message,variant:"destructive"})}},v=async()=>{if(!cf(o.cnpj)){h({title:"CNPJ invlido",description:"Por favor, verifique o CNPJ informado",variant:"destructive"});return}if(!o.razao_social||!o.nome_fantasia||!o.cep||!o.telefone){h({title:"Campos obrigatrios",description:"Preencha todos os campos obrigatrios",variant:"destructive"});return}i(!0);try{const _=`empresa_${o.cnpj.replace(/\D/g,"")}@temp.com`,{data:C,error:T}=await J.auth.signUp({email:_,password:Math.random().toString(36).slice(-12)+"A1!",options:{data:{nome:o.nome_fantasia,tipo_pessoa:"PJ",cnpj:o.cnpj,cep:o.cep,logradouro:o.logradouro,numero:o.numero,complemento:o.complemento,bairro:o.bairro,cidade:o.cidade,uf:o.uf,telefone:o.telefone,tipo_pj:"empresa",role:"empresa"}}});if(T)throw T;if(!C.user)throw new Error("Falha ao criar usurio");const{error:A}=await J.from("user_roles").insert({user_id:C.user.id,role:"empresa"});if(A)throw A;const{error:k}=await J.from("empresas").insert({id_user:C.user.id,tipo_empresa:o.tipo_empresa,plano_atual:o.plano_atual||null});if(k)throw k;h({title:"Empresa criada!",description:"A empresa foi cadastrada com sucesso"}),a(!1),b(),p()}catch(_){h({title:"Erro ao criar empresa",description:_.message,variant:"destructive"})}finally{i(!1)}},b=()=>{c({cnpj:"",razao_social:"",nome_fantasia:"",cep:"",logradouro:"",numero:"",complemento:"",bairro:"",cidade:"",uf:"",telefone:"",tipo_empresa:"marketplace",plano_atual:""})},N=_=>({marketplace:s.jsx(Je,{className:"bg-primary",children:"Marketplace"}),fabricante:s.jsx(Je,{className:"bg-accent",children:"Fabricante"}),varejista:s.jsx(Je,{className:"bg-secondary",children:"Varejista"})})[_]||s.jsx(Je,{children:_});return s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-8",children:s.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>d("/admin"),className:"gap-2",children:[s.jsx(As,{className:"h-4 w-4"}),"Voltar"]}),s.jsxs("div",{className:"flex-1 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Gerenciar Empresas"}),s.jsx("p",{className:"text-muted-foreground",children:"Visualize e gerencie empresas parceiras"})]}),s.jsxs(oe,{onClick:()=>a(!0),children:[s.jsx(ra,{className:"mr-2 h-4 w-4"}),"Nova Empresa"]})]})]}),s.jsxs("div",{className:"grid gap-6",children:[e.map(_=>{var C,T,A,k;return s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx(Qe,{children:((C=_.profiles)==null?void 0:C.nome)||"Nome no disponvel"}),s.jsxs(Tt,{children:["CNPJ: ",((T=_.profiles)==null?void 0:T.cnpj)||"N/A"]})]}),N(_.tipo_empresa)]})}),s.jsxs(De,{children:[s.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"font-semibold mb-2 flex items-center gap-2",children:[s.jsx(hn,{className:"h-4 w-4"}),"Informaes"]}),((A=_.profiles)==null?void 0:A.email)&&s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Email: ",_.profiles.email]}),((k=_.profiles)==null?void 0:k.telefone)&&s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Telefone: ",_.profiles.telefone]}),_.plano_atual&&s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Plano: ",_.plano_atual]})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"font-semibold mb-2 flex items-center gap-2",children:[s.jsx(Ir,{className:"h-4 w-4"}),"Mtricas"]}),s.jsxs("div",{className:"space-y-2",children:[_.percentual_faturamento_verde!==null&&s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-muted-foreground",children:"Faturamento Verde:"}),s.jsxs("span",{className:"font-semibold",children:[_.percentual_faturamento_verde,"%"]})]}),_.percentual_recuperacao!==null&&s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-muted-foreground",children:"Taxa Recuperao:"}),s.jsxs("span",{className:"font-semibold",children:[_.percentual_recuperacao,"%"]})]}),_.nivel_selo_venda_limpa&&_.nivel_selo_venda_limpa!=="Nenhum"&&s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-muted-foreground",children:"Selo Venda Limpa:"}),s.jsx("span",{className:"font-semibold",children:_.nivel_selo_venda_limpa})]}),_.nivel_selo_origem&&_.nivel_selo_origem!=="Nenhum"&&s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-muted-foreground",children:"Selo Origem:"}),s.jsx("span",{className:"font-semibold",children:_.nivel_selo_origem})]})]})]})]}),s.jsxs("div",{className:"flex gap-2 mt-4",children:[s.jsxs(oe,{size:"sm",variant:"outline",onClick:()=>d(`/admin/companies/${_.id}/metrics`),children:[s.jsx(Su,{className:"mr-2 h-4 w-4"}),"Ver Mtricas"]}),s.jsxs(oe,{size:"sm",variant:"destructive",onClick:()=>x(_.id),children:[s.jsx(Ba,{className:"mr-2 h-4 w-4"}),"Excluir"]})]})]})]},_.id)}),e.length===0&&s.jsx(Ne,{children:s.jsx(De,{className:"py-8 text-center text-muted-foreground",children:"Nenhuma empresa cadastrada ainda."})})]}),s.jsx(ar,{open:r,onOpenChange:a,children:s.jsxs(tr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(nr,{children:[s.jsx(ir,{children:"Cadastrar Nova Empresa"}),s.jsx(Vr,{children:"Adicione uma nova empresa parceira ao sistema"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"cnpj",children:"CNPJ *"}),s.jsx(We,{id:"cnpj",value:o.cnpj,onChange:_=>c({...o,cnpj:xp(_.target.value)}),placeholder:"00.000.000/0000-00",maxLength:18})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"telefone",children:"Telefone *"}),s.jsx(We,{id:"telefone",value:o.telefone,onChange:_=>c({...o,telefone:gp(_.target.value)}),placeholder:"(00) 00000-0000",maxLength:15})]})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"razao_social",children:"Razo Social *"}),s.jsx(We,{id:"razao_social",value:o.razao_social,onChange:_=>c({...o,razao_social:_.target.value})})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"nome_fantasia",children:"Nome Fantasia *"}),s.jsx(We,{id:"nome_fantasia",value:o.nome_fantasia,onChange:_=>c({...o,nome_fantasia:_.target.value})})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"tipo_empresa",children:"Tipo de Empresa *"}),s.jsxs(qs,{value:o.tipo_empresa,onValueChange:_=>c({...o,tipo_empresa:_}),children:[s.jsx(Ls,{children:s.jsx(Ws,{})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"marketplace",children:"Marketplace"}),s.jsx(xt,{value:"fabricante",children:"Fabricante"}),s.jsx(xt,{value:"varejista",children:"Varejista"})]})]})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"plano_atual",children:"Plano Atual"}),s.jsx(We,{id:"plano_atual",value:o.plano_atual,onChange:_=>c({...o,plano_atual:_.target.value}),placeholder:"Ex: Premium, Bsico, etc."})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"cep",children:"CEP *"}),s.jsx(We,{id:"cep",value:o.cep,onChange:_=>c({...o,cep:vp(_.target.value)}),placeholder:"00000-000",maxLength:9})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx(ke,{htmlFor:"logradouro",children:"Logradouro"}),s.jsx(We,{id:"logradouro",value:o.logradouro,onChange:_=>c({...o,logradouro:_.target.value})})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"numero",children:"Nmero"}),s.jsx(We,{id:"numero",value:o.numero,onChange:_=>c({...o,numero:_.target.value})})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx(ke,{htmlFor:"complemento",children:"Complemento"}),s.jsx(We,{id:"complemento",value:o.complemento,onChange:_=>c({...o,complemento:_.target.value})})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"bairro",children:"Bairro"}),s.jsx(We,{id:"bairro",value:o.bairro,onChange:_=>c({...o,bairro:_.target.value})})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"cidade",children:"Cidade"}),s.jsx(We,{id:"cidade",value:o.cidade,onChange:_=>c({...o,cidade:_.target.value})})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"uf",children:"UF"}),s.jsx(We,{id:"uf",value:o.uf,onChange:_=>c({...o,uf:_.target.value.toUpperCase()}),maxLength:2})]})]}),s.jsx(oe,{onClick:v,className:"w-full",disabled:n,children:n?"Criando...":"Criar Empresa"})]})]})})]})})}var zs=function(){return zs=Object.assign||function(t){for(var r,a=1,n=arguments.length;a<n;a++){r=arguments[a];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},zs.apply(this,arguments)};function Yne(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]]);return r}function E5(e,t,r){for(var a=0,n=t.length,i;a<n;a++)(i||!(a in t))&&(i||(i=Array.prototype.slice.call(t,0,a)),i[a]=t[a]);return e.concat(i||Array.prototype.slice.call(t))}function m0(e){return e.mode==="multiple"}function p0(e){return e.mode==="range"}function a1(e){return e.mode==="single"}var Zne={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function Qne(e,t){return Os(e,"LLLL y",t)}function Jne(e,t){return Os(e,"d",t)}function eie(e,t){return Os(e,"LLLL",t)}function tie(e){return"".concat(e)}function sie(e,t){return Os(e,"cccccc",t)}function rie(e,t){return Os(e,"yyyy",t)}var aie=Object.freeze({__proto__:null,formatCaption:Qne,formatDay:Jne,formatMonthCaption:eie,formatWeekNumber:tie,formatWeekdayName:sie,formatYearCaption:rie}),nie=function(e,t,r){return Os(e,"do MMMM (EEEE)",r)},iie=function(){return"Month: "},oie=function(){return"Go to next month"},lie=function(){return"Go to previous month"},cie=function(e,t){return Os(e,"cccc",t)},die=function(e){return"Week n. ".concat(e)},uie=function(){return"Year: "},hie=Object.freeze({__proto__:null,labelDay:nie,labelMonthDropdown:iie,labelNext:oie,labelPrevious:lie,labelWeekNumber:die,labelWeekday:cie,labelYearDropdown:uie});function fie(){var e="buttons",t=Zne,r=i_,a={},n={},i=1,o={},c=new Date;return{captionLayout:e,classNames:t,formatters:aie,labels:hie,locale:r,modifiersClassNames:a,modifiers:n,numberOfMonths:i,styles:o,today:c,mode:"default"}}function mie(e){var t=e.fromYear,r=e.toYear,a=e.fromMonth,n=e.toMonth,i=e.fromDate,o=e.toDate;return a?i=In(a):t&&(i=new Date(t,0,1)),n?o=Lu(n):r&&(o=new Date(r,11,31)),{fromDate:i?Mu(i):void 0,toDate:o?Mu(o):void 0}}var S5=E.createContext(void 0);function pie(e){var t,r=e.initialProps,a=fie(),n=mie(r),i=n.fromDate,o=n.toDate,c=(t=r.captionLayout)!==null&&t!==void 0?t:a.captionLayout;c!=="buttons"&&(!i||!o)&&(c="buttons");var d;(a1(r)||m0(r)||p0(r))&&(d=r.onSelect);var h=zs(zs(zs({},a),r),{captionLayout:c,classNames:zs(zs({},a.classNames),r.classNames),components:zs({},r.components),formatters:zs(zs({},a.formatters),r.formatters),fromDate:i,labels:zs(zs({},a.labels),r.labels),mode:r.mode||a.mode,modifiers:zs(zs({},a.modifiers),r.modifiers),modifiersClassNames:zs(zs({},a.modifiersClassNames),r.modifiersClassNames),onSelect:d,styles:zs(zs({},a.styles),r.styles),toDate:o});return s.jsx(S5.Provider,{value:h,children:e.children})}function ua(){var e=E.useContext(S5);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function T5(e){var t=ua(),r=t.locale,a=t.classNames,n=t.styles,i=t.formatters.formatCaption;return s.jsx("div",{className:a.caption_label,style:n.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:i(e.displayMonth,{locale:r})})}function xie(e){return s.jsx("svg",zs({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:s.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function A5(e){var t,r,a=e.onChange,n=e.value,i=e.children,o=e.caption,c=e.className,d=e.style,h=ua(),p=(r=(t=h.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:xie;return s.jsxs("div",{className:c,style:d,children:[s.jsx("span",{className:h.classNames.vhidden,children:e["aria-label"]}),s.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:h.classNames.dropdown,style:h.styles.dropdown,value:n,onChange:a,children:i}),s.jsxs("div",{className:h.classNames.caption_label,style:h.styles.caption_label,"aria-hidden":"true",children:[o,s.jsx(p,{className:h.classNames.dropdown_icon,style:h.styles.dropdown_icon})]})]})}function gie(e){var t,r=ua(),a=r.fromDate,n=r.toDate,i=r.styles,o=r.locale,c=r.formatters.formatMonthCaption,d=r.classNames,h=r.components,p=r.labels.labelMonthDropdown;if(!a)return s.jsx(s.Fragment,{});if(!n)return s.jsx(s.Fragment,{});var x=[];if(hK(a,n))for(var v=In(a),b=a.getMonth();b<=n.getMonth();b++)x.push(av(v,b));else for(var v=In(new Date),b=0;b<=11;b++)x.push(av(v,b));var N=function(C){var T=Number(C.target.value),A=av(In(e.displayMonth),T);e.onChange(A)},_=(t=h==null?void 0:h.Dropdown)!==null&&t!==void 0?t:A5;return s.jsx(_,{name:"months","aria-label":p(),className:d.dropdown_month,style:i.dropdown_month,onChange:N,value:e.displayMonth.getMonth(),caption:c(e.displayMonth,{locale:o}),children:x.map(function(C){return s.jsx("option",{value:C.getMonth(),children:c(C,{locale:o})},C.getMonth())})})}function vie(e){var t,r=e.displayMonth,a=ua(),n=a.fromDate,i=a.toDate,o=a.locale,c=a.styles,d=a.classNames,h=a.components,p=a.formatters.formatYearCaption,x=a.labels.labelYearDropdown,v=[];if(!n)return s.jsx(s.Fragment,{});if(!i)return s.jsx(s.Fragment,{});for(var b=n.getFullYear(),N=i.getFullYear(),_=b;_<=N;_++)v.push(XC(lR(new Date),_));var C=function(A){var k=XC(In(r),Number(A.target.value));e.onChange(k)},T=(t=h==null?void 0:h.Dropdown)!==null&&t!==void 0?t:A5;return s.jsx(T,{name:"years","aria-label":x(),className:d.dropdown_year,style:c.dropdown_year,onChange:C,value:r.getFullYear(),caption:p(r,{locale:o}),children:v.map(function(A){return s.jsx("option",{value:A.getFullYear(),children:p(A,{locale:o})},A.getFullYear())})})}function yie(e,t){var r=E.useState(e),a=r[0],n=r[1],i=t===void 0?a:t;return[i,n]}function wie(e){var t=e.month,r=e.defaultMonth,a=e.today,n=t||r||a||new Date,i=e.toDate,o=e.fromDate,c=e.numberOfMonths,d=c===void 0?1:c;if(i&&vf(i,n)<0){var h=-1*(d-1);n=So(i,h)}return o&&vf(n,o)<0&&(n=o),In(n)}function bie(){var e=ua(),t=wie(e),r=yie(t,e.month),a=r[0],n=r[1],i=function(o){var c;if(!e.disableNavigation){var d=In(o);n(d),(c=e.onMonthChange)===null||c===void 0||c.call(e,d)}};return[a,i]}function _ie(e,t){for(var r=t.reverseMonths,a=t.numberOfMonths,n=In(e),i=In(So(n,a)),o=vf(i,n),c=[],d=0;d<o;d++){var h=So(n,d);c.push(h)}return r&&(c=c.reverse()),c}function jie(e,t){if(!t.disableNavigation){var r=t.toDate,a=t.pagedNavigation,n=t.numberOfMonths,i=n===void 0?1:n,o=a?i:1,c=In(e);if(!r)return So(c,o);var d=vf(r,e);if(!(d<i))return So(c,o)}}function Nie(e,t){if(!t.disableNavigation){var r=t.fromDate,a=t.pagedNavigation,n=t.numberOfMonths,i=n===void 0?1:n,o=a?i:1,c=In(e);if(!r)return So(c,-o);var d=vf(c,r);if(!(d<=0))return So(c,-o)}}var k5=E.createContext(void 0);function Cie(e){var t=ua(),r=bie(),a=r[0],n=r[1],i=_ie(a,t),o=jie(a,t),c=Nie(a,t),d=function(x){return i.some(function(v){return o_(x,v)})},h=function(x,v){d(x)||(v&&pR(x,v)?n(So(x,1+t.numberOfMonths*-1)):n(x))},p={currentMonth:a,displayMonths:i,goToMonth:n,goToDate:h,previousMonth:c,nextMonth:o,isDateDisplayed:d};return s.jsx(k5.Provider,{value:p,children:e.children})}function x0(){var e=E.useContext(k5);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function sS(e){var t,r=ua(),a=r.classNames,n=r.styles,i=r.components,o=x0().goToMonth,c=function(p){o(So(p,e.displayIndex?-e.displayIndex:0))},d=(t=i==null?void 0:i.CaptionLabel)!==null&&t!==void 0?t:T5,h=s.jsx(d,{id:e.id,displayMonth:e.displayMonth});return s.jsxs("div",{className:a.caption_dropdowns,style:n.caption_dropdowns,children:[s.jsx("div",{className:a.vhidden,children:h}),s.jsx(gie,{onChange:c,displayMonth:e.displayMonth}),s.jsx(vie,{onChange:c,displayMonth:e.displayMonth})]})}function Eie(e){return s.jsx("svg",zs({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:s.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Sie(e){return s.jsx("svg",zs({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:s.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var mg=E.forwardRef(function(e,t){var r=ua(),a=r.classNames,n=r.styles,i=[a.button_reset,a.button];e.className&&i.push(e.className);var o=i.join(" "),c=zs(zs({},n.button_reset),n.button);return e.style&&Object.assign(c,e.style),s.jsx("button",zs({},e,{ref:t,type:"button",className:o,style:c}))});function Tie(e){var t,r,a=ua(),n=a.dir,i=a.locale,o=a.classNames,c=a.styles,d=a.labels,h=d.labelPrevious,p=d.labelNext,x=a.components;if(!e.nextMonth&&!e.previousMonth)return s.jsx(s.Fragment,{});var v=h(e.previousMonth,{locale:i}),b=[o.nav_button,o.nav_button_previous].join(" "),N=p(e.nextMonth,{locale:i}),_=[o.nav_button,o.nav_button_next].join(" "),C=(t=x==null?void 0:x.IconRight)!==null&&t!==void 0?t:Sie,T=(r=x==null?void 0:x.IconLeft)!==null&&r!==void 0?r:Eie;return s.jsxs("div",{className:o.nav,style:c.nav,children:[!e.hidePrevious&&s.jsx(mg,{name:"previous-month","aria-label":v,className:b,style:c.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:n==="rtl"?s.jsx(C,{className:o.nav_icon,style:c.nav_icon}):s.jsx(T,{className:o.nav_icon,style:c.nav_icon})}),!e.hideNext&&s.jsx(mg,{name:"next-month","aria-label":N,className:_,style:c.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:n==="rtl"?s.jsx(T,{className:o.nav_icon,style:c.nav_icon}):s.jsx(C,{className:o.nav_icon,style:c.nav_icon})})]})}function rS(e){var t=ua().numberOfMonths,r=x0(),a=r.previousMonth,n=r.nextMonth,i=r.goToMonth,o=r.displayMonths,c=o.findIndex(function(N){return o_(e.displayMonth,N)}),d=c===0,h=c===o.length-1,p=t>1&&(d||!h),x=t>1&&(h||!d),v=function(){a&&i(a)},b=function(){n&&i(n)};return s.jsx(Tie,{displayMonth:e.displayMonth,hideNext:p,hidePrevious:x,nextMonth:n,previousMonth:a,onPreviousClick:v,onNextClick:b})}function Aie(e){var t,r=ua(),a=r.classNames,n=r.disableNavigation,i=r.styles,o=r.captionLayout,c=r.components,d=(t=c==null?void 0:c.CaptionLabel)!==null&&t!==void 0?t:T5,h;return n?h=s.jsx(d,{id:e.id,displayMonth:e.displayMonth}):o==="dropdown"?h=s.jsx(sS,{displayMonth:e.displayMonth,id:e.id}):o==="dropdown-buttons"?h=s.jsxs(s.Fragment,{children:[s.jsx(sS,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),s.jsx(rS,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):h=s.jsxs(s.Fragment,{children:[s.jsx(d,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),s.jsx(rS,{displayMonth:e.displayMonth,id:e.id})]}),s.jsx("div",{className:a.caption,style:i.caption,children:h})}function kie(e){var t=ua(),r=t.footer,a=t.styles,n=t.classNames.tfoot;return r?s.jsx("tfoot",{className:n,style:a.tfoot,children:s.jsx("tr",{children:s.jsx("td",{colSpan:8,children:r})})}):s.jsx(s.Fragment,{})}function Rie(e,t,r){for(var a=r?Du(new Date):$l(new Date,{locale:e,weekStartsOn:t}),n=[],i=0;i<7;i++){var o=di(a,i);n.push(o)}return n}function Pie(){var e=ua(),t=e.classNames,r=e.styles,a=e.showWeekNumber,n=e.locale,i=e.weekStartsOn,o=e.ISOWeek,c=e.formatters.formatWeekdayName,d=e.labels.labelWeekday,h=Rie(n,i,o);return s.jsxs("tr",{style:r.head_row,className:t.head_row,children:[a&&s.jsx("td",{style:r.head_cell,className:t.head_cell}),h.map(function(p,x){return s.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":d(p,{locale:n}),children:c(p,{locale:n})},x)})]})}function Iie(){var e,t=ua(),r=t.classNames,a=t.styles,n=t.components,i=(e=n==null?void 0:n.HeadRow)!==null&&e!==void 0?e:Pie;return s.jsx("thead",{style:a.head,className:r.head,children:s.jsx(i,{})})}function Oie(e){var t=ua(),r=t.locale,a=t.formatters.formatDay;return s.jsx(s.Fragment,{children:a(e.date,{locale:r})})}var Y_=E.createContext(void 0);function Die(e){if(!m0(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return s.jsx(Y_.Provider,{value:t,children:e.children})}return s.jsx(Mie,{initialProps:e.initialProps,children:e.children})}function Mie(e){var t=e.initialProps,r=e.children,a=t.selected,n=t.min,i=t.max,o=function(h,p,x){var v,b;(v=t.onDayClick)===null||v===void 0||v.call(t,h,p,x);var N=!!(p.selected&&n&&(a==null?void 0:a.length)===n);if(!N){var _=!!(!p.selected&&i&&(a==null?void 0:a.length)===i);if(!_){var C=a?E5([],a):[];if(p.selected){var T=C.findIndex(function(A){return Zn(h,A)});C.splice(T,1)}else C.push(h);(b=t.onSelect)===null||b===void 0||b.call(t,C,h,p,x)}}},c={disabled:[]};a&&c.disabled.push(function(h){var p=i&&a.length>i-1,x=a.some(function(v){return Zn(v,h)});return!!(p&&!x)});var d={selected:a,onDayClick:o,modifiers:c};return s.jsx(Y_.Provider,{value:d,children:r})}function Z_(){var e=E.useContext(Y_);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function Lie(e,t){var r=t||{},a=r.from,n=r.to;return a&&n?Zn(n,e)&&Zn(a,e)?void 0:Zn(n,e)?{from:n,to:void 0}:Zn(a,e)?void 0:Jy(a,e)?{from:e,to:n}:{from:a,to:e}:n?Jy(e,n)?{from:n,to:e}:{from:e,to:n}:a?pR(e,a)?{from:e,to:a}:{from:a,to:e}:{from:e,to:void 0}}var Q_=E.createContext(void 0);function Fie(e){if(!p0(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return s.jsx(Q_.Provider,{value:t,children:e.children})}return s.jsx(Bie,{initialProps:e.initialProps,children:e.children})}function Bie(e){var t=e.initialProps,r=e.children,a=t.selected,n=a||{},i=n.from,o=n.to,c=t.min,d=t.max,h=function(b,N,_){var C,T;(C=t.onDayClick)===null||C===void 0||C.call(t,b,N,_);var A=Lie(b,a);(T=t.onSelect)===null||T===void 0||T.call(t,A,b,N,_)},p={range_start:[],range_end:[],range_middle:[],disabled:[]};if(i?(p.range_start=[i],o?(p.range_end=[o],Zn(i,o)||(p.range_middle=[{after:i,before:o}])):p.range_end=[i]):o&&(p.range_start=[o],p.range_end=[o]),c&&(i&&!o&&p.disabled.push({after:ln(i,c-1),before:di(i,c-1)}),i&&o&&p.disabled.push({after:i,before:di(i,c-1)}),!i&&o&&p.disabled.push({after:ln(o,c-1),before:di(o,c-1)})),d){if(i&&!o&&(p.disabled.push({before:di(i,-d+1)}),p.disabled.push({after:di(i,d-1)})),i&&o){var x=kl(o,i)+1,v=d-x;p.disabled.push({before:ln(i,v)}),p.disabled.push({after:di(o,v)})}!i&&o&&(p.disabled.push({before:di(o,-d+1)}),p.disabled.push({after:di(o,d-1)}))}return s.jsx(Q_.Provider,{value:{selected:a,onDayClick:h,modifiers:p},children:r})}function J_(){var e=E.useContext(Q_);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function bx(e){return Array.isArray(e)?E5([],e):e!==void 0?[e]:[]}function Vie(e){var t={};return Object.entries(e).forEach(function(r){var a=r[0],n=r[1];t[a]=bx(n)}),t}var nl;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(nl||(nl={}));var Uie=nl.Selected,tc=nl.Disabled,zie=nl.Hidden,$ie=nl.Today,_v=nl.RangeEnd,jv=nl.RangeMiddle,Nv=nl.RangeStart,qie=nl.Outside;function Wie(e,t,r){var a,n=(a={},a[Uie]=bx(e.selected),a[tc]=bx(e.disabled),a[zie]=bx(e.hidden),a[$ie]=[e.today],a[_v]=[],a[jv]=[],a[Nv]=[],a[qie]=[],a);return e.fromDate&&n[tc].push({before:e.fromDate}),e.toDate&&n[tc].push({after:e.toDate}),m0(e)?n[tc]=n[tc].concat(t.modifiers[tc]):p0(e)&&(n[tc]=n[tc].concat(r.modifiers[tc]),n[Nv]=r.modifiers[Nv],n[jv]=r.modifiers[jv],n[_v]=r.modifiers[_v]),n}var R5=E.createContext(void 0);function Hie(e){var t=ua(),r=Z_(),a=J_(),n=Wie(t,r,a),i=Vie(t.modifiers),o=zs(zs({},n),i);return s.jsx(R5.Provider,{value:o,children:e.children})}function P5(){var e=E.useContext(R5);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function Gie(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function Kie(e){return!!(e&&typeof e=="object"&&"from"in e)}function Xie(e){return!!(e&&typeof e=="object"&&"after"in e)}function Yie(e){return!!(e&&typeof e=="object"&&"before"in e)}function Zie(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function Qie(e,t){var r,a=t.from,n=t.to;if(a&&n){var i=kl(n,a)<0;i&&(r=[n,a],a=r[0],n=r[1]);var o=kl(e,a)>=0&&kl(n,e)>=0;return o}return n?Zn(n,e):a?Zn(a,e):!1}function Jie(e){return r_(e)}function eoe(e){return Array.isArray(e)&&e.every(r_)}function toe(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(Jie(r))return Zn(e,r);if(eoe(r))return r.includes(e);if(Kie(r))return Qie(e,r);if(Zie(r))return r.dayOfWeek.includes(e.getDay());if(Gie(r)){var a=kl(r.before,e),n=kl(r.after,e),i=a>0,o=n<0,c=Jy(r.before,r.after);return c?o&&i:i||o}return Xie(r)?kl(e,r.after)>0:Yie(r)?kl(r.before,e)>0:typeof r=="function"?r(e):!1})}function e2(e,t,r){var a=Object.keys(t).reduce(function(i,o){var c=t[o];return toe(e,c)&&i.push(o),i},[]),n={};return a.forEach(function(i){return n[i]=!0}),r&&!o_(e,r)&&(n.outside=!0),n}function soe(e,t){for(var r=In(e[0]),a=Lu(e[e.length-1]),n,i,o=r;o<=a;){var c=e2(o,t),d=!c.disabled&&!c.hidden;if(!d){o=di(o,1);continue}if(c.selected)return o;c.today&&!i&&(i=o),n||(n=o),o=di(o,1)}return i||n}var roe=365;function I5(e,t){var r=t.moveBy,a=t.direction,n=t.context,i=t.modifiers,o=t.retry,c=o===void 0?{count:0,lastFocused:e}:o,d=n.weekStartsOn,h=n.fromDate,p=n.toDate,x=n.locale,v={day:di,week:Zy,month:So,year:rG,startOfWeek:function(C){return n.ISOWeek?Du(C):$l(C,{locale:x,weekStartsOn:d})},endOfWeek:function(C){return n.ISOWeek?cR(C):n_(C,{locale:x,weekStartsOn:d})}},b=v[r](e,a==="after"?1:-1);a==="before"&&h?b=aG([h,b]):a==="after"&&p&&(b=nG([p,b]));var N=!0;if(i){var _=e2(b,i);N=!_.disabled&&!_.hidden}return N?b:c.count>roe?c.lastFocused:I5(b,{moveBy:r,direction:a,context:n,modifiers:i,retry:zs(zs({},c),{count:c.count+1})})}var O5=E.createContext(void 0);function aoe(e){var t=x0(),r=P5(),a=E.useState(),n=a[0],i=a[1],o=E.useState(),c=o[0],d=o[1],h=soe(t.displayMonths,r),p=n??(c&&t.isDateDisplayed(c))?c:h,x=function(){d(n),i(void 0)},v=function(C){i(C)},b=ua(),N=function(C,T){if(n){var A=I5(n,{moveBy:C,direction:T,context:b,modifiers:r});Zn(n,A)||(t.goToDate(A,n),v(A))}},_={focusedDay:n,focusTarget:p,blur:x,focus:v,focusDayAfter:function(){return N("day","after")},focusDayBefore:function(){return N("day","before")},focusWeekAfter:function(){return N("week","after")},focusWeekBefore:function(){return N("week","before")},focusMonthBefore:function(){return N("month","before")},focusMonthAfter:function(){return N("month","after")},focusYearBefore:function(){return N("year","before")},focusYearAfter:function(){return N("year","after")},focusStartOfWeek:function(){return N("startOfWeek","before")},focusEndOfWeek:function(){return N("endOfWeek","after")}};return s.jsx(O5.Provider,{value:_,children:e.children})}function t2(){var e=E.useContext(O5);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function noe(e,t){var r=P5(),a=e2(e,r,t);return a}var s2=E.createContext(void 0);function ioe(e){if(!a1(e.initialProps)){var t={selected:void 0};return s.jsx(s2.Provider,{value:t,children:e.children})}return s.jsx(ooe,{initialProps:e.initialProps,children:e.children})}function ooe(e){var t=e.initialProps,r=e.children,a=function(i,o,c){var d,h,p;if((d=t.onDayClick)===null||d===void 0||d.call(t,i,o,c),o.selected&&!t.required){(h=t.onSelect)===null||h===void 0||h.call(t,void 0,i,o,c);return}(p=t.onSelect)===null||p===void 0||p.call(t,i,i,o,c)},n={selected:t.selected,onDayClick:a};return s.jsx(s2.Provider,{value:n,children:r})}function D5(){var e=E.useContext(s2);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function loe(e,t){var r=ua(),a=D5(),n=Z_(),i=J_(),o=t2(),c=o.focusDayAfter,d=o.focusDayBefore,h=o.focusWeekAfter,p=o.focusWeekBefore,x=o.blur,v=o.focus,b=o.focusMonthBefore,N=o.focusMonthAfter,_=o.focusYearBefore,C=o.focusYearAfter,T=o.focusStartOfWeek,A=o.focusEndOfWeek,k=function(G){var Q,re,le,ye;a1(r)?(Q=a.onDayClick)===null||Q===void 0||Q.call(a,e,t,G):m0(r)?(re=n.onDayClick)===null||re===void 0||re.call(n,e,t,G):p0(r)?(le=i.onDayClick)===null||le===void 0||le.call(i,e,t,G):(ye=r.onDayClick)===null||ye===void 0||ye.call(r,e,t,G)},I=function(G){var Q;v(e),(Q=r.onDayFocus)===null||Q===void 0||Q.call(r,e,t,G)},B=function(G){var Q;x(),(Q=r.onDayBlur)===null||Q===void 0||Q.call(r,e,t,G)},O=function(G){var Q;(Q=r.onDayMouseEnter)===null||Q===void 0||Q.call(r,e,t,G)},D=function(G){var Q;(Q=r.onDayMouseLeave)===null||Q===void 0||Q.call(r,e,t,G)},F=function(G){var Q;(Q=r.onDayPointerEnter)===null||Q===void 0||Q.call(r,e,t,G)},M=function(G){var Q;(Q=r.onDayPointerLeave)===null||Q===void 0||Q.call(r,e,t,G)},z=function(G){var Q;(Q=r.onDayTouchCancel)===null||Q===void 0||Q.call(r,e,t,G)},q=function(G){var Q;(Q=r.onDayTouchEnd)===null||Q===void 0||Q.call(r,e,t,G)},Y=function(G){var Q;(Q=r.onDayTouchMove)===null||Q===void 0||Q.call(r,e,t,G)},ae=function(G){var Q;(Q=r.onDayTouchStart)===null||Q===void 0||Q.call(r,e,t,G)},je=function(G){var Q;(Q=r.onDayKeyUp)===null||Q===void 0||Q.call(r,e,t,G)},H=function(G){var Q;switch(G.key){case"ArrowLeft":G.preventDefault(),G.stopPropagation(),r.dir==="rtl"?c():d();break;case"ArrowRight":G.preventDefault(),G.stopPropagation(),r.dir==="rtl"?d():c();break;case"ArrowDown":G.preventDefault(),G.stopPropagation(),h();break;case"ArrowUp":G.preventDefault(),G.stopPropagation(),p();break;case"PageUp":G.preventDefault(),G.stopPropagation(),G.shiftKey?_():b();break;case"PageDown":G.preventDefault(),G.stopPropagation(),G.shiftKey?C():N();break;case"Home":G.preventDefault(),G.stopPropagation(),T();break;case"End":G.preventDefault(),G.stopPropagation(),A();break}(Q=r.onDayKeyDown)===null||Q===void 0||Q.call(r,e,t,G)},Z={onClick:k,onFocus:I,onBlur:B,onKeyDown:H,onKeyUp:je,onMouseEnter:O,onMouseLeave:D,onPointerEnter:F,onPointerLeave:M,onTouchCancel:z,onTouchEnd:q,onTouchMove:Y,onTouchStart:ae};return Z}function coe(){var e=ua(),t=D5(),r=Z_(),a=J_(),n=a1(e)?t.selected:m0(e)?r.selected:p0(e)?a.selected:void 0;return n}function doe(e){return Object.values(nl).includes(e)}function uoe(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(a){var n=e.modifiersClassNames[a];if(n)r.push(n);else if(doe(a)){var i=e.classNames["day_".concat(a)];i&&r.push(i)}}),r}function hoe(e,t){var r=zs({},e.styles.day);return Object.keys(t).forEach(function(a){var n;r=zs(zs({},r),(n=e.modifiersStyles)===null||n===void 0?void 0:n[a])}),r}function foe(e,t,r){var a,n,i,o=ua(),c=t2(),d=noe(e,t),h=loe(e,d),p=coe(),x=!!(o.onDayClick||o.mode!=="default");E.useEffect(function(){var O;d.outside||c.focusedDay&&x&&Zn(c.focusedDay,e)&&((O=r.current)===null||O===void 0||O.focus())},[c.focusedDay,e,r,x,d.outside]);var v=uoe(o,d).join(" "),b=hoe(o,d),N=!!(d.outside&&!o.showOutsideDays||d.hidden),_=(i=(n=o.components)===null||n===void 0?void 0:n.DayContent)!==null&&i!==void 0?i:Oie,C=s.jsx(_,{date:e,displayMonth:t,activeModifiers:d}),T={style:b,className:v,children:C,role:"gridcell"},A=c.focusTarget&&Zn(c.focusTarget,e)&&!d.outside,k=c.focusedDay&&Zn(c.focusedDay,e),I=zs(zs(zs({},T),(a={disabled:d.disabled,role:"gridcell"},a["aria-selected"]=d.selected,a.tabIndex=k||A?0:-1,a)),h),B={isButton:x,isHidden:N,activeModifiers:d,selectedDays:p,buttonProps:I,divProps:T};return B}function moe(e){var t=E.useRef(null),r=foe(e.date,e.displayMonth,t);return r.isHidden?s.jsx("div",{role:"gridcell"}):r.isButton?s.jsx(mg,zs({name:"day",ref:t},r.buttonProps)):s.jsx("div",zs({},r.divProps))}function poe(e){var t=e.number,r=e.dates,a=ua(),n=a.onWeekNumberClick,i=a.styles,o=a.classNames,c=a.locale,d=a.labels.labelWeekNumber,h=a.formatters.formatWeekNumber,p=h(Number(t),{locale:c});if(!n)return s.jsx("span",{className:o.weeknumber,style:i.weeknumber,children:p});var x=d(Number(t),{locale:c}),v=function(b){n(t,r,b)};return s.jsx(mg,{name:"week-number","aria-label":x,className:o.weeknumber,style:i.weeknumber,onClick:v,children:p})}function xoe(e){var t,r,a=ua(),n=a.styles,i=a.classNames,o=a.showWeekNumber,c=a.components,d=(t=c==null?void 0:c.Day)!==null&&t!==void 0?t:moe,h=(r=c==null?void 0:c.WeekNumber)!==null&&r!==void 0?r:poe,p;return o&&(p=s.jsx("td",{className:i.cell,style:n.cell,children:s.jsx(h,{number:e.weekNumber,dates:e.dates})})),s.jsxs("tr",{className:i.row,style:n.row,children:[p,e.dates.map(function(x){return s.jsx("td",{className:i.cell,style:n.cell,role:"presentation",children:s.jsx(d,{displayMonth:e.displayMonth,date:x})},lK(x))})]})}function aS(e,t,r){for(var a=r!=null&&r.ISOWeek?cR(t):n_(t,r),n=r!=null&&r.ISOWeek?Du(e):$l(e,r),i=kl(a,n),o=[],c=0;c<=i;c++)o.push(di(n,c));var d=o.reduce(function(h,p){var x=r!=null&&r.ISOWeek?uR(p):fR(p,r),v=h.find(function(b){return b.weekNumber===x});return v?(v.dates.push(p),h):(h.push({weekNumber:x,dates:[p]}),h)},[]);return d}function goe(e,t){var r=aS(In(e),Lu(e),t);if(t!=null&&t.useFixedWeeks){var a=dK(e,t);if(a<6){var n=r[r.length-1],i=n.dates[n.dates.length-1],o=Zy(i,6-a),c=aS(Zy(i,1),o,t);r.push.apply(r,c)}}return r}function voe(e){var t,r,a,n=ua(),i=n.locale,o=n.classNames,c=n.styles,d=n.hideHead,h=n.fixedWeeks,p=n.components,x=n.weekStartsOn,v=n.firstWeekContainsDate,b=n.ISOWeek,N=goe(e.displayMonth,{useFixedWeeks:!!h,ISOWeek:b,locale:i,weekStartsOn:x,firstWeekContainsDate:v}),_=(t=p==null?void 0:p.Head)!==null&&t!==void 0?t:Iie,C=(r=p==null?void 0:p.Row)!==null&&r!==void 0?r:xoe,T=(a=p==null?void 0:p.Footer)!==null&&a!==void 0?a:kie;return s.jsxs("table",{id:e.id,className:o.table,style:c.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!d&&s.jsx(_,{}),s.jsx("tbody",{className:o.tbody,style:c.tbody,children:N.map(function(A){return s.jsx(C,{displayMonth:e.displayMonth,dates:A.dates,weekNumber:A.weekNumber},A.weekNumber)})}),s.jsx(T,{displayMonth:e.displayMonth})]})}function yoe(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var woe=yoe()?E.useLayoutEffect:E.useEffect,Cv=!1,boe=0;function nS(){return"react-day-picker-".concat(++boe)}function _oe(e){var t,r=e??(Cv?nS():null),a=E.useState(r),n=a[0],i=a[1];return woe(function(){n===null&&i(nS())},[]),E.useEffect(function(){Cv===!1&&(Cv=!0)},[]),(t=e??n)!==null&&t!==void 0?t:void 0}function joe(e){var t,r,a=ua(),n=a.dir,i=a.classNames,o=a.styles,c=a.components,d=x0().displayMonths,h=_oe(a.id?"".concat(a.id,"-").concat(e.displayIndex):void 0),p=a.id?"".concat(a.id,"-grid-").concat(e.displayIndex):void 0,x=[i.month],v=o.month,b=e.displayIndex===0,N=e.displayIndex===d.length-1,_=!b&&!N;n==="rtl"&&(t=[b,N],N=t[0],b=t[1]),b&&(x.push(i.caption_start),v=zs(zs({},v),o.caption_start)),N&&(x.push(i.caption_end),v=zs(zs({},v),o.caption_end)),_&&(x.push(i.caption_between),v=zs(zs({},v),o.caption_between));var C=(r=c==null?void 0:c.Caption)!==null&&r!==void 0?r:Aie;return s.jsxs("div",{className:x.join(" "),style:v,children:[s.jsx(C,{id:h,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),s.jsx(voe,{id:p,"aria-labelledby":h,displayMonth:e.displayMonth})]},e.displayIndex)}function Noe(e){var t=ua(),r=t.classNames,a=t.styles;return s.jsx("div",{className:r.months,style:a.months,children:e.children})}function Coe(e){var t,r,a=e.initialProps,n=ua(),i=t2(),o=x0(),c=E.useState(!1),d=c[0],h=c[1];E.useEffect(function(){n.initialFocus&&i.focusTarget&&(d||(i.focus(i.focusTarget),h(!0)))},[n.initialFocus,d,i.focus,i.focusTarget,i]);var p=[n.classNames.root,n.className];n.numberOfMonths>1&&p.push(n.classNames.multiple_months),n.showWeekNumber&&p.push(n.classNames.with_weeknumber);var x=zs(zs({},n.styles.root),n.style),v=Object.keys(a).filter(function(N){return N.startsWith("data-")}).reduce(function(N,_){var C;return zs(zs({},N),(C={},C[_]=a[_],C))},{}),b=(r=(t=a.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:Noe;return s.jsx("div",zs({className:p.join(" "),style:x,dir:n.dir,id:n.id,nonce:a.nonce,title:a.title,lang:a.lang},v,{children:s.jsx(b,{children:o.displayMonths.map(function(N,_){return s.jsx(joe,{displayIndex:_,displayMonth:N},_)})})}))}function Eoe(e){var t=e.children,r=Yne(e,["children"]);return s.jsx(pie,{initialProps:r,children:s.jsx(Cie,{children:s.jsx(ioe,{initialProps:r,children:s.jsx(Die,{initialProps:r,children:s.jsx(Fie,{initialProps:r,children:s.jsx(Hie,{children:s.jsx(aoe,{children:t})})})})})})})}function Soe(e){return s.jsx(Eoe,zs({},e,{children:s.jsx(Coe,{initialProps:e})}))}function oc({className:e,classNames:t,showOutsideDays:r=!0,...a}){return s.jsx(Soe,{showOutsideDays:r,className:pt("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:pt(up({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:pt(up({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...n})=>s.jsx(m4,{className:"h-4 w-4"}),IconRight:({...n})=>s.jsx(Xi,{className:"h-4 w-4"})},...a})}oc.displayName="Calendar";function Toe(){var Z,G,Q,re;const{id:e}=To(),[t,r]=E.useState(null),[a,n]=E.useState([]),[i,o]=E.useState(null),[c,d]=E.useState(!1),[h,p]=E.useState(!1),[x,v]=E.useState(ln(new Date,30)),[b,N]=E.useState(new Date),[_,C]=E.useState(ln(new Date,60)),[T,A]=E.useState(ln(new Date,31)),[k,I]=E.useState({data_registro:Os(new Date,"yyyy-MM-dd"),faturamento_verde:"",faturamento_total:"",taxa_recuperacao:"",toneladas_recuperadas:"",cupons_emitidos:"",notas_fiscais_validadas:""}),B=ds(),{toast:O}=_r();E.useEffect(()=>{e&&(D(),F(),M())},[e,x,b,_,T]);const D=async()=>{const{data:le}=await J.from("empresas").select(`
        *,
        profiles:id_user (nome, email, cnpj)
      `).eq("id",e).single();le&&r(le)},F=async()=>{const{data:le}=await J.from("metricas_empresas").select("*").eq("id_empresa",e).order("data_registro",{ascending:!0});le&&n(le)},M=async()=>{if(!x||!b)return;const{data:le}=await J.from("metricas_empresas").select("*").eq("id_empresa",e).gte("data_registro",x.toISOString()).lte("data_registro",b.toISOString()).order("data_registro",{ascending:!1});let ye=null;_&&T&&(ye=(await J.from("metricas_empresas").select("*").eq("id_empresa",e).gte("data_registro",_.toISOString()).lte("data_registro",T.toISOString()).order("data_registro",{ascending:!1})).data);const W=(ie,ce)=>!ie||ie.length===0?0:ie.reduce((Ce,me)=>Ce+(Number(me[ce])||0),0)/ie.length,ee=(ie,ce)=>!ie||ie.length===0?0:ie.reduce((xe,Ce)=>xe+(Number(Ce[ce])||0),0);if(le&&le.length>0){const ie={percentual_faturamento_verde:W(le,"percentual_faturamento_verde"),taxa_recuperacao:W(le,"taxa_recuperacao"),toneladas_recuperadas:ee(le,"toneladas_recuperadas"),cupons_emitidos:ee(le,"cupons_emitidos"),notas_fiscais_validadas:ee(le,"notas_fiscais_validadas"),faturamento_verde:ee(le,"faturamento_verde"),faturamento_total:ee(le,"faturamento_total")},ce=ye&&ye.length>0?{percentual_faturamento_verde:W(ye,"percentual_faturamento_verde"),taxa_recuperacao:W(ye,"taxa_recuperacao"),toneladas_recuperadas:ee(ye,"toneladas_recuperadas"),cupons_emitidos:ee(ye,"cupons_emitidos"),notas_fiscais_validadas:ee(ye,"notas_fiscais_validadas"),faturamento_verde:ee(ye,"faturamento_verde"),faturamento_total:ee(ye,"faturamento_total")}:null;o({atual:ie,anterior:ce})}},z=async()=>{if(!k.data_registro){O({title:"Campo obrigatrio",description:"Data de registro  obrigatria",variant:"destructive"});return}p(!0);try{const le=k.faturamento_verde?parseFloat(k.faturamento_verde):null,ye=k.faturamento_total?parseFloat(k.faturamento_total):null;let W=null;le&&ye&&ye>0&&(W=le/ye*100);const{error:ee}=await J.from("metricas_empresas").insert({id_empresa:e,data_registro:k.data_registro,faturamento_verde:le,faturamento_total:ye,percentual_faturamento_verde:W,taxa_recuperacao:k.taxa_recuperacao?parseFloat(k.taxa_recuperacao):null,toneladas_recuperadas:k.toneladas_recuperadas?parseFloat(k.toneladas_recuperadas):null,cupons_emitidos:k.cupons_emitidos?parseInt(k.cupons_emitidos):0,notas_fiscais_validadas:k.notas_fiscais_validadas?parseInt(k.notas_fiscais_validadas):0});if(ee)throw ee;O({title:"Mtrica adicionada!",description:"Os dados foram salvos com sucesso"}),d(!1),q(),F(),D()}catch(le){O({title:"Erro ao salvar mtrica",description:le.message,variant:"destructive"})}finally{p(!1)}},q=()=>{I({data_registro:Os(new Date,"yyyy-MM-dd"),faturamento_verde:"",faturamento_total:"",taxa_recuperacao:"",toneladas_recuperadas:"",cupons_emitidos:"",notas_fiscais_validadas:""})},Y=()=>a.map(le=>{var ye,W,ee;return{data:Os(new Date(le.data_registro),"dd/MM/yy",{locale:$s}),"Faturamento Verde (%)":((ye=le.percentual_faturamento_verde)==null?void 0:ye.toFixed(2))||0,"Taxa Recuperao (%)":((W=le.taxa_recuperacao)==null?void 0:W.toFixed(2))||0,Toneladas:((ee=le.toneladas_recuperadas)==null?void 0:ee.toFixed(2))||0}}),ae=()=>a.map(le=>({data:Os(new Date(le.data_registro),"dd/MM/yy",{locale:$s}),Cupons:le.cupons_emitidos||0,"Notas Fiscais":le.notas_fiscais_validadas||0})),H=a.length>0?a[a.length-1]:null;return s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-8",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs(oe,{variant:"ghost",onClick:()=>B("/admin/companies"),children:[s.jsx(As,{className:"mr-2 h-4 w-4"}),"Voltar"]}),s.jsxs(oe,{onClick:()=>d(!0),children:[s.jsx(ra,{className:"mr-2 h-4 w-4"}),"Adicionar Mtrica"]})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold",children:((Z=t==null?void 0:t.profiles)==null?void 0:Z.nome)||"Carregando..."}),s.jsx("p",{className:"text-muted-foreground",children:"Dashboard de Mtricas e Performance"})]}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-4 mb-8",children:[s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-2",children:[s.jsxs(Tt,{className:"flex items-center gap-2",children:[s.jsx(Mw,{className:"h-4 w-4"}),"Faturamento Verde"]}),s.jsxs(Qe,{className:"text-2xl",children:[((G=H==null?void 0:H.percentual_faturamento_verde)==null?void 0:G.toFixed(1))||"0","%"]})]})}),s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-2",children:[s.jsxs(Tt,{className:"flex items-center gap-2",children:[s.jsx(Ur,{className:"h-4 w-4"}),"Taxa Recuperao"]}),s.jsxs(Qe,{className:"text-2xl",children:[((Q=H==null?void 0:H.taxa_recuperacao)==null?void 0:Q.toFixed(1))||"0","%"]})]})}),s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-2",children:[s.jsxs(Tt,{className:"flex items-center gap-2",children:[s.jsx(Ir,{className:"h-4 w-4"}),"Toneladas Recuperadas"]}),s.jsx(Qe,{className:"text-2xl",children:((re=H==null?void 0:H.toneladas_recuperadas)==null?void 0:re.toFixed(1))||"0"})]})}),s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-2",children:[s.jsxs(Tt,{className:"flex items-center gap-2",children:[s.jsx(Qa,{className:"h-4 w-4"}),"Cupons Emitidos"]}),s.jsx(Qe,{className:"text-2xl",children:(H==null?void 0:H.cupons_emitidos)||0})]})})]}),a.length>0?s.jsxs(s.Fragment,{children:[s.jsxs(Ne,{className:"mb-6",children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Evoluo de Faturamento Verde e Recuperao"}),s.jsx(Tt,{children:"Percentuais ao longo do tempo"})]}),s.jsx(De,{children:s.jsx(mi,{width:"100%",height:300,children:s.jsxs(_x,{data:Y(),children:[s.jsx(go,{strokeDasharray:"3 3"}),s.jsx(vo,{dataKey:"data"}),s.jsx(yo,{}),s.jsx(pi,{}),s.jsx(Yo,{}),s.jsx(El,{type:"monotone",dataKey:"Faturamento Verde (%)",stroke:"hsl(var(--primary))",strokeWidth:2,dot:{r:4}}),s.jsx(El,{type:"monotone",dataKey:"Taxa Recuperao (%)",stroke:"hsl(var(--success))",strokeWidth:2,dot:{r:4}})]})})})]}),s.jsxs(Ne,{className:"mb-6",children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Toneladas Recuperadas"}),s.jsx(Tt,{children:"Volume de material reciclado ao longo do tempo"})]}),s.jsx(De,{children:s.jsx(mi,{width:"100%",height:300,children:s.jsxs(ju,{data:Y(),children:[s.jsx(go,{strokeDasharray:"3 3"}),s.jsx(vo,{dataKey:"data"}),s.jsx(yo,{}),s.jsx(pi,{}),s.jsx(Yo,{}),s.jsx(Rl,{dataKey:"Toneladas",fill:"hsl(var(--accent))"})]})})})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Atividade Operacional"}),s.jsx(Tt,{children:"Cupons emitidos e notas fiscais validadas"})]}),s.jsx(De,{children:s.jsx(mi,{width:"100%",height:300,children:s.jsxs(ju,{data:ae(),children:[s.jsx(go,{strokeDasharray:"3 3"}),s.jsx(vo,{dataKey:"data"}),s.jsx(yo,{}),s.jsx(pi,{}),s.jsx(Yo,{}),s.jsx(Rl,{dataKey:"Cupons",fill:"hsl(var(--primary))"}),s.jsx(Rl,{dataKey:"Notas Fiscais",fill:"hsl(var(--secondary))"})]})})})]})]}):s.jsx(Ne,{children:s.jsxs(De,{className:"py-12 text-center",children:[s.jsx(oc,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Nenhuma mtrica registrada"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:"Comece adicionando mtricas para visualizar a evoluo da empresa"}),s.jsxs(oe,{onClick:()=>d(!0),children:[s.jsx(ra,{className:"mr-2 h-4 w-4"}),"Adicionar Primeira Mtrica"]})]})}),s.jsx(ar,{open:c,onOpenChange:d,children:s.jsxs(tr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(nr,{children:[s.jsx(ir,{children:"Adicionar Nova Mtrica"}),s.jsx(Vr,{children:"Registre os dados de performance da empresa"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"data_registro",children:"Data de Registro *"}),s.jsx(We,{id:"data_registro",type:"date",value:k.data_registro,onChange:le=>I({...k,data_registro:le.target.value})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"faturamento_verde",children:"Faturamento Verde (R$)"}),s.jsx(We,{id:"faturamento_verde",type:"number",step:"0.01",value:k.faturamento_verde,onChange:le=>I({...k,faturamento_verde:le.target.value}),placeholder:"0.00"})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"faturamento_total",children:"Faturamento Total (R$)"}),s.jsx(We,{id:"faturamento_total",type:"number",step:"0.01",value:k.faturamento_total,onChange:le=>I({...k,faturamento_total:le.target.value}),placeholder:"0.00"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"taxa_recuperacao",children:"Taxa de Recuperao (%)"}),s.jsx(We,{id:"taxa_recuperacao",type:"number",step:"0.01",min:"0",max:"100",value:k.taxa_recuperacao,onChange:le=>I({...k,taxa_recuperacao:le.target.value}),placeholder:"0.00"})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"toneladas_recuperadas",children:"Toneladas Recuperadas"}),s.jsx(We,{id:"toneladas_recuperadas",type:"number",step:"0.01",value:k.toneladas_recuperadas,onChange:le=>I({...k,toneladas_recuperadas:le.target.value}),placeholder:"0.00"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"cupons_emitidos",children:"Cupons Emitidos"}),s.jsx(We,{id:"cupons_emitidos",type:"number",value:k.cupons_emitidos,onChange:le=>I({...k,cupons_emitidos:le.target.value}),placeholder:"0"})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"notas_fiscais_validadas",children:"Notas Fiscais Validadas"}),s.jsx(We,{id:"notas_fiscais_validadas",type:"number",value:k.notas_fiscais_validadas,onChange:le=>I({...k,notas_fiscais_validadas:le.target.value}),placeholder:"0"})]})]}),s.jsx(oe,{onClick:z,className:"w-full",disabled:h,children:h?"Salvando...":"Salvar Mtrica"})]})]})})]})})}function Aoe(){var _,C,T,A;const{user:e,profile:t,signOut:r}=sr(),[a,n]=E.useState(null),[i,o]=E.useState(null),[c,d]=E.useState(!0),h=ds();E.useEffect(()=>{p()},[e]);const p=async()=>{d(!0),await Promise.all([x(),v()]),d(!1)},x=async()=>{if(!e)return;const{data:k}=await J.from("empresas").select("*, profiles:id_user (nome, cnpj)").eq("id_user",e.id).single();k&&n(k)},v=async()=>{if(!e)return;const{data:k}=await J.from("empresas").select("id").eq("id_user",e.id).single();if(!k)return;const{data:I}=await J.from("metricas_empresas").select("*").eq("id_empresa",k.id).order("data_registro",{ascending:!1}).limit(1).maybeSingle();I&&o(I)};if(c)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-primary/5 to-secondary/5 flex items-center justify-center p-4",children:s.jsx(Ee.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:s.jsx(cr,{className:"w-12 h-12 text-primary"})})});if(!a)return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-primary/5 to-secondary/5 flex items-center justify-center p-4",children:s.jsx(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:s.jsxs(Ne,{className:"max-w-md w-full border-2 shadow-xl",children:[s.jsxs(Ye,{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 rounded-full bg-destructive/10 flex items-center justify-center mx-auto mb-4",children:s.jsx(hn,{className:"w-8 h-8 text-destructive"})}),s.jsx(Qe,{children:"Empresa no encontrada"}),s.jsx(Tt,{children:"Sua conta no est vinculada a nenhuma empresa"})]}),s.jsx(De,{children:s.jsxs(oe,{onClick:r,className:"w-full",variant:"outline",children:[s.jsx(gc,{className:"mr-2 h-4 w-4"}),"Sair"]})})]})})});const b={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},N={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-primary/5 to-secondary/5 p-4 md:p-8",children:s.jsxs(Ee.div,{className:"mx-auto max-w-7xl space-y-6",variants:b,initial:"hidden",animate:"show",children:[s.jsx(Ee.div,{variants:N,children:s.jsx(Ne,{className:"border-2 shadow-lg bg-card/50 backdrop-blur",children:s.jsx(De,{className:"p-6",children:s.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(C_,{className:"h-16 w-16 border-2 border-primary",children:s.jsx(E_,{className:"bg-primary text-primary-foreground text-xl font-bold",children:((_=t==null?void 0:t.nome)==null?void 0:_.charAt(0))||"E"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl md:text-3xl font-display font-bold",children:t==null?void 0:t.nome}),s.jsxs("p",{className:"text-muted-foreground flex items-center gap-2",children:[s.jsx(hn,{className:"w-4 h-4"}),"Painel Empresarial"]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>h("/company/own-metrics"),children:[s.jsx(Su,{className:"mr-2 h-4 w-4"}),"Minhas Mtricas"]}),s.jsx(oe,{variant:"ghost",size:"icon",onClick:r,children:s.jsx(gc,{className:"h-5 w-5"})})]})]})})})}),s.jsxs(Ee.div,{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",variants:N,children:[s.jsxs(Ne,{className:"border-2 hover:border-primary/50 transition-colors shadow-lg",children:[s.jsxs(Ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(Qe,{className:"text-sm font-medium",children:"Tipo de Empresa"}),s.jsx(hn,{className:"h-5 w-5 text-primary"})]}),s.jsxs(De,{children:[s.jsx("div",{className:"text-2xl font-display font-bold capitalize mb-1",children:a.tipo_empresa}),s.jsx(Je,{variant:"secondary",className:"text-xs",children:a.plano_atual||"Plano Bsico"})]})]}),s.jsxs(Ne,{className:"border-2 hover:border-primary/50 transition-colors shadow-lg",children:[s.jsxs(Ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(Qe,{className:"text-sm font-medium",children:"Faturamento Verde"}),s.jsx(Ir,{className:"h-5 w-5 text-green-500"})]}),s.jsxs(De,{children:[s.jsx("div",{className:"text-2xl font-display font-bold text-green-600",children:i!=null&&i.percentual_faturamento_verde?`${i.percentual_faturamento_verde.toFixed(1)}%`:"0%"}),s.jsxs("p",{className:"text-xs text-muted-foreground mt-1 flex items-center gap-1",children:[s.jsx(Fa,{className:"w-3 h-3"}),"ltima atualizao"]})]})]}),s.jsxs(Ne,{className:"border-2 hover:border-primary/50 transition-colors shadow-lg",children:[s.jsxs(Ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(Qe,{className:"text-sm font-medium",children:"Taxa Recuperao"}),s.jsx(d6,{className:"h-5 w-5 text-blue-500"})]}),s.jsxs(De,{children:[s.jsx("div",{className:"text-2xl font-display font-bold text-blue-600",children:i!=null&&i.taxa_recuperacao?`${i.taxa_recuperacao.toFixed(1)}%`:"0%"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Eficincia de reciclagem"})]})]}),s.jsxs(Ne,{className:"border-2 hover:border-primary/50 transition-colors shadow-lg",children:[s.jsxs(Ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(Qe,{className:"text-sm font-medium",children:"Status"}),s.jsx(vi,{className:"h-5 w-5 text-primary"})]}),s.jsxs(De,{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),s.jsx("span",{className:"text-2xl font-display font-bold",children:"Ativo"})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Compliance verificado"})]})]})]}),s.jsx(Ee.div,{variants:N,children:s.jsxs(Ne,{className:"border-2 shadow-lg",children:[s.jsxs(Ye,{children:[s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(Eo,{className:"w-5 h-5 text-primary"}),"Aes Rpidas"]}),s.jsx(Tt,{children:"Acesse as principais funcionalidades da plataforma"})]}),s.jsx(De,{children:s.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[s.jsxs(oe,{onClick:()=>h("/company/metrics"),className:"h-auto py-4 justify-start",variant:"outline",children:[s.jsxs("div",{className:"flex items-start gap-3 text-left",children:[s.jsx(Su,{className:"h-5 w-5 text-primary flex-shrink-0 mt-1"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold mb-1",children:"Mtricas Detalhadas"}),s.jsx("div",{className:"text-xs text-muted-foreground",children:"Visualize relatrios completos de desempenho"})]})]}),s.jsx(Hn,{className:"ml-auto h-5 w-5"})]}),s.jsxs(oe,{onClick:()=>h("/company/own-metrics"),className:"h-auto py-4 justify-start",variant:"outline",children:[s.jsxs("div",{className:"flex items-start gap-3 text-left",children:[s.jsx(fs,{className:"h-5 w-5 text-secondary flex-shrink-0 mt-1"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold mb-1",children:"Minhas Mtricas"}),s.jsx("div",{className:"text-xs text-muted-foreground",children:"Gerencie suas metas e indicadores"})]})]}),s.jsx(Hn,{className:"ml-auto h-5 w-5"})]})]})})]})}),s.jsx(Ee.div,{variants:N,children:s.jsxs(Ne,{className:"border-2 shadow-lg",children:[s.jsx(Ye,{children:s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(hn,{className:"w-5 h-5 text-primary"}),"Informaes da Empresa"]})}),s.jsxs(De,{className:"space-y-4",children:[s.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"CNPJ"}),s.jsx("p",{className:"text-lg font-mono font-semibold",children:((C=a.profiles)==null?void 0:C.cnpj)||"No informado"})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Tipo de Empresa"}),s.jsx("p",{className:"text-lg font-semibold capitalize",children:a.tipo_empresa})]})]}),s.jsx(al,{}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Plano Atual"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("p",{className:"text-lg font-semibold",children:a.plano_atual||"Plano Bsico"}),s.jsxs(Je,{variant:"outline",className:"text-xs",children:[s.jsx(cr,{className:"w-3 h-3 mr-1"}),"Ativo"]})]})]}),i&&s.jsxs(s.Fragment,{children:[s.jsx(al,{}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"ltima Atualizao de Mtricas"}),s.jsx("p",{className:"text-lg font-semibold",children:new Date(i.data_registro).toLocaleDateString("pt-BR",{day:"2-digit",month:"long",year:"numeric"})})]})]})]})]})}),i&&s.jsx(Ee.div,{variants:N,children:s.jsxs(Ne,{className:"border-2 shadow-lg bg-gradient-to-br from-primary/5 to-secondary/5",children:[s.jsxs(Ye,{children:[s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(cr,{className:"w-5 h-5 text-primary"}),"Resumo de Impacto Ambiental"]}),s.jsx(Tt,{children:"Suas contribuies para a sustentabilidade"})]}),s.jsx(De,{children:s.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"p-4 bg-card rounded-lg border",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(oa,{className:"w-4 h-4 text-primary"}),s.jsx("span",{className:"text-sm text-muted-foreground",children:"Impacto Social"})]}),s.jsxs("p",{className:"text-2xl font-bold text-primary",children:[((T=i.percentual_faturamento_verde)==null?void 0:T.toFixed(0))||"0","%"]}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Faturamento Verde"})]}),s.jsxs("div",{className:"p-4 bg-card rounded-lg border",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(fs,{className:"w-4 h-4 text-secondary"}),s.jsx("span",{className:"text-sm text-muted-foreground",children:"Reciclagem"})]}),s.jsxs("p",{className:"text-2xl font-bold text-secondary",children:[((A=i.taxa_recuperacao)==null?void 0:A.toFixed(0))||"0","%"]}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Taxa de Recuperao"})]}),s.jsxs("div",{className:"p-4 bg-card rounded-lg border",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ir,{className:"w-4 h-4 text-accent"}),s.jsx("span",{className:"text-sm text-muted-foreground",children:"Crescimento"})]}),s.jsx("p",{className:"text-2xl font-bold text-accent",children:"+15%"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"vs. ms anterior"})]})]})})]})})]})})}function koe(){var N,_;const{user:e,profile:t}=sr(),[r,a]=E.useState(null),[n,i]=E.useState([]),o=ds();E.useEffect(()=>{c()},[e]);const c=async()=>{if(!e)return;const{data:C}=await J.from("empresas").select("*").eq("id_user",e.id).single();C&&(a(C),d(C.id))},d=async C=>{const{data:T}=await J.from("metricas_empresas").select("*").eq("id_empresa",C).order("data_registro",{ascending:!0});T&&i(T)},h=()=>n.map(C=>{var T,A;return{data:Os(new Date(C.data_registro),"dd/MMM",{locale:$s}),"Faturamento Verde (%)":((T=C.percentual_faturamento_verde)==null?void 0:T.toFixed(1))||0,"Taxa Recuperao (%)":((A=C.taxa_recuperacao)==null?void 0:A.toFixed(1))||0}}),p=()=>n.map(C=>({data:Os(new Date(C.data_registro),"dd/MMM",{locale:$s}),Toneladas:C.toneladas_recuperadas||0})),x=()=>n.map(C=>({data:Os(new Date(C.data_registro),"dd/MMM",{locale:$s}),"Cupons Emitidos":C.cupons_emitidos||0,"Notas Validadas":C.notas_fiscais_validadas||0})),b=n.length===0?null:n[n.length-1];return r?s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-8",children:s.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>o("/company"),children:s.jsx(As,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:t==null?void 0:t.nome}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Mtricas de Desempenho"})]})]})}),b&&s.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[s.jsxs(Ne,{children:[s.jsxs(Ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(Qe,{className:"text-sm font-medium",children:"Faturamento Verde (%)"}),s.jsx(Ir,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsx(De,{children:s.jsxs("div",{className:"text-2xl font-bold",children:[((N=b.percentual_faturamento_verde)==null?void 0:N.toFixed(1))||0,"%"]})})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(Qe,{className:"text-sm font-medium",children:"Taxa Recuperao (%)"}),s.jsx(Ir,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsx(De,{children:s.jsxs("div",{className:"text-2xl font-bold",children:[((_=b.taxa_recuperacao)==null?void 0:_.toFixed(1))||0,"%"]})})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(Qe,{className:"text-sm font-medium",children:"Toneladas Recuperadas"}),s.jsx(fs,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsx(De,{children:s.jsx("div",{className:"text-2xl font-bold",children:b.toneladas_recuperadas||0})})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(Qe,{className:"text-sm font-medium",children:"Cupons Emitidos"}),s.jsx(dx,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsx(De,{children:s.jsx("div",{className:"text-2xl font-bold",children:b.cupons_emitidos||0})})]})]}),n.length===0?s.jsx(Ne,{children:s.jsx(De,{className:"pt-6 text-center",children:s.jsx("p",{className:"text-muted-foreground",children:"Nenhuma mtrica registrada ainda. Aguarde os administradores adicionarem dados."})})}):s.jsxs(s.Fragment,{children:[s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Evoluo de Faturamento Verde e Recuperao"}),s.jsx(Tt,{children:"Percentuais ao longo do tempo"})]}),s.jsx(De,{children:s.jsx(mi,{width:"100%",height:300,children:s.jsxs(_x,{data:h(),children:[s.jsx(go,{strokeDasharray:"3 3"}),s.jsx(vo,{dataKey:"data"}),s.jsx(yo,{}),s.jsx(pi,{}),s.jsx(Yo,{}),s.jsx(El,{type:"monotone",dataKey:"Faturamento Verde (%)",stroke:"hsl(var(--primary))",strokeWidth:2}),s.jsx(El,{type:"monotone",dataKey:"Taxa Recuperao (%)",stroke:"hsl(var(--accent))",strokeWidth:2})]})})})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Toneladas Recuperadas"}),s.jsx(Tt,{children:"Volume recuperado por perodo"})]}),s.jsx(De,{children:s.jsx(mi,{width:"100%",height:300,children:s.jsxs(ju,{data:p(),children:[s.jsx(go,{strokeDasharray:"3 3"}),s.jsx(vo,{dataKey:"data"}),s.jsx(yo,{}),s.jsx(pi,{}),s.jsx(Rl,{dataKey:"Toneladas",fill:"hsl(var(--primary))"})]})})})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Atividade Operacional"}),s.jsx(Tt,{children:"Cupons emitidos e notas fiscais validadas"})]}),s.jsx(De,{children:s.jsx(mi,{width:"100%",height:300,children:s.jsxs(ju,{data:x(),children:[s.jsx(go,{strokeDasharray:"3 3"}),s.jsx(vo,{dataKey:"data"}),s.jsx(yo,{}),s.jsx(pi,{}),s.jsx(Yo,{}),s.jsx(Rl,{dataKey:"Cupons Emitidos",fill:"hsl(var(--primary))"}),s.jsx(Rl,{dataKey:"Notas Validadas",fill:"hsl(var(--accent))"})]})})})]})]})]})}):s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsx("p",{className:"text-muted-foreground",children:"Carregando dados da empresa..."})})}function Roe(){const[e,t]=E.useState([]),[r,a]=E.useState([]),[n,i]=E.useState(0),[o,c]=E.useState(""),[d,h]=E.useState(null),[p,x]=E.useState(!1),[v,b]=E.useState(!1),[N,_]=E.useState({}),[C,T]=E.useState({}),[A,k]=E.useState(!1),[I,B]=E.useState({nome:"",email:"",telefone:"",cpf:"",cnpj:"",tipo_pessoa:"PF",tipo_pj:"Outro",cep:"",logradouro:"",numero:"",complemento:"",bairro:"",cidade:"",uf:""}),O=ds(),{toast:D}=_r();E.useEffect(()=>{F()},[]),E.useEffect(()=>{if(o){const Q=e.filter(re=>{var le,ye;return re.nome.toLowerCase().includes(o.toLowerCase())||re.email.toLowerCase().includes(o.toLowerCase())||((le=re.cpf)==null?void 0:le.includes(o))||((ye=re.cnpj)==null?void 0:ye.includes(o))});a(Q)}else a(e)},[o,e]);const F=async()=>{const{data:Q,error:re}=await J.from("profiles").select(`
        *,
        user_roles (role)
      `).not("email","is",null).not("nome","is",null).neq("email","").neq("nome","").order("created_at",{ascending:!1});if(re){console.error(" [AdminUsers] Erro ao carregar profiles:",re),D({title:"Erro ao carregar usurios",description:re.message,variant:"destructive"});return}const le=Q||[];i(le.length),t(le),a(le),await M(le)},M=async Q=>{const re={};for(const le of Q)try{const{data:ye,error:W}=await J.rpc("verificar_status_email_frontend",{usuario_id:le.id});ye&&ye.success&&(re[le.id]={emailConfirmed:ye.email_confirmado,confirmedAt:ye.confirmado_em,createdAt:ye.criado_em})}catch(ye){console.error(`Erro ao verificar status de email para ${le.email}:`,ye)}_(re)},z=Q=>{const re=N[Q];return re?re.emailConfirmed?s.jsxs(Je,{className:"bg-green-500 text-white flex items-center gap-1",children:[s.jsx(Tr,{className:"h-3 w-3"}),"Email confirmado"]}):s.jsxs(Je,{variant:"destructive",className:"flex items-center gap-1",children:[s.jsx(Va,{className:"h-3 w-3"}),"Email no confirmado"]}):s.jsxs(Je,{variant:"secondary",className:"flex items-center gap-1",children:[s.jsx(Kr,{className:"h-3 w-3"}),"Verificando..."]})},q=async Q=>{const re=N[Q.id];if(re!=null&&re.emailConfirmed){D({title:"Email j confirmado",description:`O email de ${Q.nome} j foi confirmado em ${new Date(re.confirmedAt).toLocaleDateString("pt-BR")}.`,variant:"default"});return}T(le=>({...le,[Q.id]:!0}));try{const{error:le}=await J.auth.resend({type:"signup",email:Q.email});if(le)throw le;D({title:"Email reenviado com sucesso!",description:`Email de confirmao reenviado para ${Q.email}. Pea ao usurio para verificar a caixa de entrada e spam.`})}catch(le){console.error(` [REENVIO] Erro ao reenviar email para ${Q.email}:`,le),D({title:"Erro ao reenviar email",description:le.message||"Ocorreu um erro ao tentar reenviar o email de confirmao.",variant:"destructive"})}finally{T(le=>({...le,[Q.id]:!1}))}},Y=async(Q,re)=>{try{const{error:le}=await J.from("profiles").update({score_verde:re}).eq("id",Q);if(le)throw le;D({title:"Score atualizado!"}),F(),x(!1)}catch(le){D({title:"Erro",description:le.message,variant:"destructive"})}},ae=async Q=>{const re=Q.replace(/\D/g,"");if(re.length===8){k(!0);try{const ye=await(await fetch(`https://viacep.com.br/ws/${re}/json/`)).json();if(ye.erro){D({title:"CEP no encontrado",description:"Verifique o CEP informado",variant:"destructive"});return}B(W=>({...W,logradouro:ye.logradouro||"",bairro:ye.bairro||"",cidade:ye.localidade||"",uf:ye.uf||""}))}catch(le){console.error("Erro ao buscar CEP:",le)}finally{k(!1)}}},je=async()=>{if(I.tipo_pessoa==="PF"){if(!jy(I.cpf)){D({title:"CPF invlido",description:"Por favor, verifique o CPF informado",variant:"destructive"});return}}else if(!cf(I.cnpj)){D({title:"CNPJ invlido",description:"Por favor, verifique o CNPJ informado",variant:"destructive"});return}if(!I.nome||!I.email||!I.cep||!I.telefone){D({title:"Campos obrigatrios",description:"Preencha todos os campos obrigatrios",variant:"destructive"});return}k(!0);try{const Q={nome:I.nome,email:I.email,telefone:I.telefone,tipo_pessoa:I.tipo_pessoa,cep:I.cep,logradouro:I.logradouro,numero:I.numero,complemento:I.complemento,bairro:I.bairro,cidade:I.cidade,uf:I.uf};I.tipo_pessoa==="PF"?(Q.cpf=I.cpf,Q.cnpj=null,Q.tipo_pj=null):(Q.cnpj=I.cnpj,Q.cpf=null,Q.tipo_pj=I.tipo_pj);const{error:re}=await J.from("profiles").update(Q).eq("id",d.id);if(re)throw re;D({title:"Usurio atualizado!",description:"Os dados cadastrais foram atualizados com sucesso"}),b(!1),F()}catch(Q){D({title:"Erro ao atualizar",description:Q.message,variant:"destructive"})}finally{k(!1)}},H=Q=>({Iniciante:s.jsx(Je,{variant:"secondary",children:"Iniciante"}),Ativo:s.jsx(Je,{className:"bg-success",children:"Ativo"}),"Guardiao Verde":s.jsx(Je,{className:"bg-accent",children:"Guardio Verde"})})[Q]||s.jsx(Je,{children:Q}),Z=(Q,re)=>Q==="PF"?s.jsx(Je,{variant:"outline",children:"Pessoa Fsica"}):s.jsxs(Je,{variant:"outline",children:["PJ - ",re]}),G=Q=>Q==="all"?r:Q==="pf"?r.filter(re=>re.tipo_pessoa==="PF"):Q==="pj"?r.filter(re=>re.tipo_pessoa==="PJ"):r.filter(re=>re.nivel===Q);return s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-8",children:s.jsxs("div",{className:"mx-auto max-w-6xl space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>O("/admin"),className:"gap-2",children:[s.jsx(As,{className:"h-4 w-4"}),"Voltar"]}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Gesto de Usurios"}),s.jsx("p",{className:"text-muted-foreground",children:"Ver e editar informaes dos usurios"})]})]}),s.jsxs("div",{className:"flex items-center gap-2 w-full max-w-sm",children:[s.jsx(eo,{className:"h-4 w-4 text-muted-foreground"}),s.jsx(We,{placeholder:"Buscar por nome, email ou documento...",value:o,onChange:Q=>c(Q.target.value)})]})]}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-2",children:[s.jsx(Tt,{className:"text-xs",children:"Total de Usurios"}),s.jsx(Qe,{className:"text-2xl",children:e.length})]})}),s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-2",children:[s.jsx(Tt,{className:"text-xs",children:"Pessoas Fsicas"}),s.jsx(Qe,{className:"text-2xl",children:e.filter(Q=>Q.tipo_pessoa==="PF").length})]})}),s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-2",children:[s.jsx(Tt,{className:"text-xs",children:"Pessoas Jurdicas"}),s.jsx(Qe,{className:"text-2xl",children:e.filter(Q=>Q.tipo_pessoa==="PJ").length})]})}),s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-2",children:[s.jsx(Tt,{className:"text-xs",children:"Guardies Verde"}),s.jsx(Qe,{className:"text-2xl",children:e.filter(Q=>Q.nivel==="Guardiao Verde").length})]})})]}),s.jsxs(Mn,{defaultValue:"all",children:[s.jsxs(Nn,{className:"grid w-full grid-cols-5",children:[s.jsx(Gs,{value:"all",children:"Todos"}),s.jsx(Gs,{value:"pf",children:"PF"}),s.jsx(Gs,{value:"pj",children:"PJ"}),s.jsx(Gs,{value:"Ativo",children:"Ativos"}),s.jsx(Gs,{value:"Guardiao Verde",children:"Guardies"})]}),["all","pf","pj","Ativo","Guardiao Verde"].map(Q=>s.jsxs(hr,{value:Q,className:"space-y-4",children:[G(Q).map(re=>{var le;return s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[s.jsx("div",{className:"rounded-full bg-primary/10 p-2",children:s.jsx(Ri,{className:"h-5 w-5 text-primary"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[s.jsx(Qe,{className:"text-lg",children:re.nome}),H(re.nivel),Z(re.tipo_pessoa,re.tipo_pj),z(re.id)]}),s.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Email:"})," ",re.email]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Telefone:"})," ",re.telefone||"N/A"]}),re.tipo_pessoa==="PF"?s.jsxs("div",{children:[s.jsx("strong",{children:"CPF:"})," ",re.cpf]}):s.jsxs("div",{children:[s.jsx("strong",{children:"CNPJ:"})," ",re.cnpj]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Endereo:"})," ",re.logradouro,", ",re.numero||"S/N"," - ",re.bairro,", ",re.cidade,"/",re.uf]}),s.jsxs("div",{className:"text-xs pt-1",children:["Cadastrado em: ",new Date(re.data_cadastro).toLocaleDateString("pt-BR")]})]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[!((le=N[re.id])!=null&&le.emailConfirmed)&&s.jsxs(oe,{size:"sm",variant:"outline",onClick:()=>q(re),disabled:C[re.id],className:"gap-2",children:[s.jsx(sf,{className:"h-4 w-4"}),C[re.id]?"Enviando...":"Reenviar Email"]}),s.jsxs(oe,{size:"sm",variant:"outline",onClick:()=>{h(re),B({nome:re.nome||"",email:re.email||"",telefone:re.telefone||"",cpf:re.cpf||"",cnpj:re.cnpj||"",tipo_pessoa:re.tipo_pessoa||"PF",tipo_pj:re.tipo_pj||"Outro",cep:re.cep||"",logradouro:re.logradouro||"",numero:re.numero||"",complemento:re.complemento||"",bairro:re.bairro||"",cidade:re.cidade||"",uf:re.uf||""}),b(!0)},className:"gap-2",children:[s.jsx(Nd,{className:"h-4 w-4"}),"Editar Cadastro"]}),s.jsx(oe,{size:"sm",variant:"ghost",onClick:()=>{h(re),x(!0)},children:s.jsx(wo,{className:"h-4 w-4"})})]})]})}),s.jsx(De,{children:s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[s.jsx("div",{className:"flex items-center justify-center mb-1",children:s.jsx(wo,{className:"h-4 w-4 text-primary mr-1"})}),s.jsx("p",{className:"text-2xl font-bold text-primary",children:re.score_verde}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Pontos Verdes"})]}),s.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[s.jsx("div",{className:"flex items-center justify-center mb-1",children:s.jsx(Eo,{className:"h-4 w-4 text-success mr-1"})}),s.jsx("p",{className:"text-2xl font-bold",children:re.missoes_concluidas}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Misses"})]}),s.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[s.jsx("div",{className:"flex items-center justify-center mb-1",children:s.jsx(Jn,{className:"h-4 w-4 text-accent mr-1"})}),s.jsx("p",{className:"text-2xl font-bold",children:re.cupons_resgatados}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Cupons"})]})]})})]},re.id)}),G(Q).length===0&&s.jsx(Ne,{children:s.jsxs(De,{className:"py-12 text-center",children:[s.jsx(Ri,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Nenhum usurio encontrado"})]})})]},Q))]}),s.jsx(ar,{open:v,onOpenChange:b,children:s.jsxs(tr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsx(nr,{children:s.jsx(ir,{children:"Editar Dados Cadastrais do Usurio"})}),d&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"edit_nome",children:"Nome Completo *"}),s.jsx(We,{id:"edit_nome",value:I.nome,onChange:Q=>B({...I,nome:Q.target.value})})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"edit_email",children:"Email *"}),s.jsx(We,{id:"edit_email",type:"email",value:I.email,onChange:Q=>B({...I,email:Q.target.value})})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"edit_telefone",children:"Telefone *"}),s.jsx(We,{id:"edit_telefone",value:I.telefone,onChange:Q=>B({...I,telefone:gp(Q.target.value)}),placeholder:"(00) 00000-0000",maxLength:15})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"edit_tipo_pessoa",children:"Tipo de Pessoa *"}),s.jsxs(qs,{value:I.tipo_pessoa,onValueChange:Q=>B({...I,tipo_pessoa:Q}),children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Selecione o tipo"})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"PF",children:"Pessoa Fsica"}),s.jsx(xt,{value:"PJ",children:"Pessoa Jurdica"})]})]})]}),I.tipo_pessoa==="PF"?s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"edit_cpf",children:"CPF *"}),s.jsx(We,{id:"edit_cpf",value:I.cpf,onChange:Q=>B({...I,cpf:wA(Q.target.value)}),placeholder:"000.000.000-00",maxLength:14})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"edit_cnpj",children:"CNPJ *"}),s.jsx(We,{id:"edit_cnpj",value:I.cnpj,onChange:Q=>B({...I,cnpj:xp(Q.target.value)}),placeholder:"00.000.000/0000-00",maxLength:18})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"edit_tipo_pj",children:"Tipo de Organizao *"}),s.jsxs("select",{id:"edit_tipo_pj",value:I.tipo_pj,onChange:Q=>B({...I,tipo_pj:Q.target.value}),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring",children:[s.jsx("option",{value:"Condominio",children:"Condomnio"}),s.jsx("option",{value:"Restaurante",children:"Restaurante"}),s.jsx("option",{value:"Comercio",children:"Comrcio"}),s.jsx("option",{value:"Servico",children:"Servio"}),s.jsx("option",{value:"Industria",children:"Indstria"}),s.jsx("option",{value:"Outro",children:"Outro"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsxs(ke,{htmlFor:"edit_cep",children:["CEP * ",A&&s.jsx("span",{className:"text-xs text-muted-foreground",children:"(buscando...)"})]}),s.jsx(We,{id:"edit_cep",value:I.cep,onChange:Q=>{const re=vp(Q.target.value);B({...I,cep:re}),re.replace(/\D/g,"").length===8&&ae(re)},placeholder:"00000-000",maxLength:9,disabled:A,className:A?"animate-pulse":""}),I.cep&&I.cep.replace(/\D/g,"").length===8&&I.logradouro&&s.jsx("p",{className:"text-xs text-green-600 mt-1",children:" Endereo preenchido automaticamente"})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx(ke,{htmlFor:"edit_logradouro",children:"Logradouro"}),s.jsx(We,{id:"edit_logradouro",value:I.logradouro,onChange:Q=>B({...I,logradouro:Q.target.value})})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"edit_numero",children:"Nmero"}),s.jsx(We,{id:"edit_numero",value:I.numero,onChange:Q=>B({...I,numero:Q.target.value})})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx(ke,{htmlFor:"edit_complemento",children:"Complemento"}),s.jsx(We,{id:"edit_complemento",value:I.complemento,onChange:Q=>B({...I,complemento:Q.target.value})})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"edit_bairro",children:"Bairro"}),s.jsx(We,{id:"edit_bairro",value:I.bairro,onChange:Q=>B({...I,bairro:Q.target.value})})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"edit_cidade",children:"Cidade"}),s.jsx(We,{id:"edit_cidade",value:I.cidade,onChange:Q=>B({...I,cidade:Q.target.value})})]}),s.jsxs("div",{children:[s.jsx(ke,{htmlFor:"edit_uf",children:"UF"}),s.jsx(We,{id:"edit_uf",value:I.uf,onChange:Q=>B({...I,uf:Q.target.value.toUpperCase()}),maxLength:2})]})]}),s.jsxs(oe,{onClick:je,disabled:A,className:"w-full",children:[s.jsx(Wu,{className:"h-4 w-4 mr-2"}),A?"Salvando...":"Salvar Alteraes"]})]})]})}),s.jsx(ar,{open:p,onOpenChange:x,children:s.jsxs(tr,{children:[s.jsx(nr,{children:s.jsx(ir,{children:"Editar Usurio"})}),d&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:d.nome}),s.jsx("p",{className:"text-sm text-muted-foreground",children:d.email})]}),N[d.id]&&s.jsxs(Er,{variant:N[d.id].emailConfirmed?"default":"destructive",children:[N[d.id].emailConfirmed?s.jsx(Tr,{className:"h-4 w-4"}):s.jsx(Va,{className:"h-4 w-4"}),s.jsx(tP,{children:N[d.id].emailConfirmed?" Email Confirmado":" Email No Confirmado"}),s.jsx(Sr,{children:N[d.id].emailConfirmed?`Email confirmado em ${new Date(N[d.id].confirmedAt).toLocaleDateString("pt-BR")}`:'O usurio ainda no confirmou o email. Use o boto "Reenviar Email" na lista de usurios para reenviar o email de confirmao.'})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{children:"Score Verde (pontos)"}),s.jsx(We,{type:"number",min:"0",defaultValue:d.score_verde,id:"novo-score"}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Score atual: ",d.score_verde," | Nvel: ",d.nivel]})]}),s.jsx(oe,{onClick:()=>{const Q=document.getElementById("novo-score");Y(d.id,parseInt(Q.value))},className:"w-full",children:"Atualizar Score"})]})]})})]})})}var n1="Popover",[M5,Xue]=bi(n1,[Tf]),g0=Tf(),[Poe,zd]=M5(n1),L5=e=>{const{__scopePopover:t,children:r,open:a,defaultOpen:n,onOpenChange:i,modal:o=!1}=e,c=g0(t),d=E.useRef(null),[h,p]=E.useState(!1),[x,v]=No({prop:a,defaultProp:n??!1,onChange:i,caller:n1});return s.jsx(kw,{...c,children:s.jsx(Poe,{scope:t,contentId:Ai(),triggerRef:d,open:x,onOpenChange:v,onOpenToggle:E.useCallback(()=>v(b=>!b),[v]),hasCustomAnchor:h,onCustomAnchorAdd:E.useCallback(()=>p(!0),[]),onCustomAnchorRemove:E.useCallback(()=>p(!1),[]),modal:o,children:r})})};L5.displayName=n1;var F5="PopoverAnchor",Ioe=E.forwardRef((e,t)=>{const{__scopePopover:r,...a}=e,n=zd(F5,r),i=g0(r),{onCustomAnchorAdd:o,onCustomAnchorRemove:c}=n;return E.useEffect(()=>(o(),()=>c()),[o,c]),s.jsx(vg,{...i,...a,ref:t})});Ioe.displayName=F5;var B5="PopoverTrigger",V5=E.forwardRef((e,t)=>{const{__scopePopover:r,...a}=e,n=zd(B5,r),i=g0(r),o=br(t,n.triggerRef),c=s.jsx(ys.button,{type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":W5(n.open),...a,ref:o,onClick:Ts(e.onClick,n.onOpenToggle)});return n.hasCustomAnchor?c:s.jsx(vg,{asChild:!0,...i,children:c})});V5.displayName=B5;var r2="PopoverPortal",[Ooe,Doe]=M5(r2,{forceMount:void 0}),U5=e=>{const{__scopePopover:t,forceMount:r,children:a,container:n}=e,i=zd(r2,t);return s.jsx(Ooe,{scope:t,forceMount:r,children:s.jsx(il,{present:r||i.open,children:s.jsx(YS,{asChild:!0,container:n,children:a})})})};U5.displayName=r2;var Cf="PopoverContent",z5=E.forwardRef((e,t)=>{const r=Doe(Cf,e.__scopePopover),{forceMount:a=r.forceMount,...n}=e,i=zd(Cf,e.__scopePopover);return s.jsx(il,{present:a||i.open,children:i.modal?s.jsx(Loe,{...n,ref:t}):s.jsx(Foe,{...n,ref:t})})});z5.displayName=Cf;var Moe=ZS("PopoverContent.RemoveScroll"),Loe=E.forwardRef((e,t)=>{const r=zd(Cf,e.__scopePopover),a=E.useRef(null),n=br(t,a),i=E.useRef(!1);return E.useEffect(()=>{const o=a.current;if(o)return HS(o)},[]),s.jsx(KS,{as:Moe,allowPinchZoom:!0,children:s.jsx($5,{...e,ref:n,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ts(e.onCloseAutoFocus,o=>{var c;o.preventDefault(),i.current||(c=r.triggerRef.current)==null||c.focus()}),onPointerDownOutside:Ts(e.onPointerDownOutside,o=>{const c=o.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0,h=c.button===2||d;i.current=h},{checkForDefaultPrevented:!1}),onFocusOutside:Ts(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),Foe=E.forwardRef((e,t)=>{const r=zd(Cf,e.__scopePopover),a=E.useRef(!1),n=E.useRef(!1);return s.jsx($5,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,c;(o=e.onCloseAutoFocus)==null||o.call(e,i),i.defaultPrevented||(a.current||(c=r.triggerRef.current)==null||c.focus(),i.preventDefault()),a.current=!1,n.current=!1},onInteractOutside:i=>{var d,h;(d=e.onInteractOutside)==null||d.call(e,i),i.defaultPrevented||(a.current=!0,i.detail.originalEvent.type==="pointerdown"&&(n.current=!0));const o=i.target;((h=r.triggerRef.current)==null?void 0:h.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&n.current&&i.preventDefault()}})}),$5=E.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:a,onOpenAutoFocus:n,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:p,...x}=e,v=zd(Cf,r),b=g0(r);return GS(),s.jsx(XS,{asChild:!0,loop:!0,trapped:a,onMountAutoFocus:n,onUnmountAutoFocus:i,children:s.jsx(Sw,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:p,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:h,onDismiss:()=>v.onOpenChange(!1),children:s.jsx(Tw,{"data-state":W5(v.open),role:"dialog",id:v.contentId,...b,...x,ref:t,style:{...x.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),q5="PopoverClose",Boe=E.forwardRef((e,t)=>{const{__scopePopover:r,...a}=e,n=zd(q5,r);return s.jsx(ys.button,{type:"button",...a,ref:t,onClick:Ts(e.onClick,()=>n.onOpenChange(!1))})});Boe.displayName=q5;var Voe="PopoverArrow",Uoe=E.forwardRef((e,t)=>{const{__scopePopover:r,...a}=e,n=g0(r);return s.jsx(Aw,{...n,...a,ref:t})});Uoe.displayName=Voe;function W5(e){return e?"open":"closed"}var zoe=L5,$oe=V5,qoe=U5,H5=z5;const bl=zoe,_l=$oe,Xo=E.forwardRef(({className:e,align:t="center",sideOffset:r=4,...a},n)=>s.jsx(qoe,{children:s.jsx(H5,{ref:n,align:t,sideOffset:r,className:pt("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...a})}));Xo.displayName=H5.displayName;const iS=["hsl(var(--primary))","hsl(var(--accent))","hsl(var(--secondary))","hsl(var(--chart-3))"];function Woe(){const e=ds(),[t,r]=E.useState({usuarios_totais:0,usuarios_ativos:0,cooperativas_ativas:0,entregas_total:0,peso_total_kg:0,cupons_disponiveis:0,cupons_resgatados:0,cupons_usados:0,notas_pendentes:0,notas_validadas:0,missoes_ativas:0}),[a,n]=E.useState(null),[i,o]=E.useState(!0),[c,d]=E.useState(ln(new Date,30)),[h,p]=E.useState(new Date),[x,v]=E.useState(ln(new Date,60)),[b,N]=E.useState(ln(new Date,31)),[_,C]=E.useState("todos"),[T,A]=E.useState("todas"),[k,I]=E.useState([]),[B,O]=E.useState("todas"),[D,F]=E.useState("todos"),[M,z]=E.useState("todas"),[q,Y]=E.useState(void 0),[ae,je]=E.useState(void 0),[H,Z]=E.useState([]),[G,Q]=E.useState(!1),[re,le]=E.useState([]);E.useEffect(()=>{ye(),ee(),ie()},[c,h,x,b,_,T]),E.useEffect(()=>{ce()},[B,D,M,q,ae]);const ye=async()=>{try{const ne=await W(c,h,_,T);if(r(ne),x&&b){const Me=await W(x,b,_,T);n(Me)}else n(null)}catch(ne){console.error("Error loading KPIs:",ne)}finally{o(!1)}},W=async(ne,Me,Ie,Be)=>{let ot=J.from("profiles").select("id",{count:"exact",head:!0});if(ne&&(ot=ot.gte("data_cadastro",ne.toISOString())),Me){const qe=new Date(Me);qe.setHours(23,59,59,999),ot=ot.lte("data_cadastro",qe.toISOString())}Ie&&Ie!=="todos"&&(ot=ot.eq("uf",Ie)),Be&&Be!=="todas"&&(ot=ot.eq("cidade",Be));let Se=J.from("cooperativas").select("id",{count:"exact",head:!0}).eq("status","aprovada");if(ne&&(Se=Se.gte("data_cadastro",ne.toISOString())),Me){const qe=new Date(Me);qe.setHours(23,59,59,999),Se=Se.lte("data_cadastro",qe.toISOString())}Ie&&Ie!=="todos"&&(Se=Se.eq("uf",Ie)),Be&&Be!=="todas"&&(Se=Se.eq("cidade",Be));let ze=J.from("entregas_reciclaveis").select("peso_validado, data_validacao, cooperativas!inner(uf, cidade)").eq("status","validada");if(ne&&(ze=ze.gte("data_validacao",ne.toISOString())),Me){const qe=new Date(Me);qe.setHours(23,59,59,999),ze=ze.lte("data_validacao",qe.toISOString())}Ie&&Ie!=="todos"&&(ze=ze.eq("cooperativas.uf",Ie)),Be&&Be!=="todas"&&(ze=ze.eq("cooperativas.cidade",Be));let we=J.from("cupons_resgates").select("id",{count:"exact",head:!0});if(ne&&(we=we.gte("data_resgate",ne.toISOString())),Me){const qe=new Date(Me);qe.setHours(23,59,59,999),we=we.lte("data_resgate",qe.toISOString())}const Le=J.from("notas_fiscais").select("id",{count:"exact",head:!0}).eq("status_validacao","valida"),Nt=J.from("notas_fiscais").select("id",{count:"exact",head:!0}).eq("status_validacao","pendente"),[Ge,Lt,ps,ns,Ke,dt,It,Ut,ts]=await Promise.allSettled([ot,Se,ze,J.from("cupons").select("id",{count:"exact",head:!0}).eq("status","disponivel"),we,J.from("cupons").select("id",{count:"exact",head:!0}).eq("status","usado"),Nt,Le,J.from("missoes").select("id",{count:"exact",head:!0}).eq("status","ativa")]),us=ps.status==="fulfilled"&&ps.value.data?ps.value.data.reduce((qe,jt)=>qe+(Number(jt.peso_validado)||0),0):0;return{usuarios_totais:Ge.status==="fulfilled"&&Ge.value.count||0,usuarios_ativos:Ge.status==="fulfilled"&&Ge.value.count||0,cooperativas_ativas:Lt.status==="fulfilled"&&Lt.value.count||0,entregas_total:ps.status==="fulfilled"&&ps.value.data?ps.value.data.length:0,peso_total_kg:Math.round(us),cupons_disponiveis:ns.status==="fulfilled"&&ns.value.count||0,cupons_resgatados:Ke.status==="fulfilled"&&Ke.value.count||0,cupons_usados:dt.status==="fulfilled"&&dt.value.count||0,notas_pendentes:It.status==="fulfilled"&&It.value.count||0,notas_validadas:Ut.status==="fulfilled"&&Ut.value.count||0,missoes_ativas:ts.status==="fulfilled"&&ts.value.count||0}},ee=async()=>{const{data:ne}=await J.from("cooperativas").select("id, nome_fantasia, cidade, uf").eq("status","aprovada").order("nome_fantasia");ne&&I(ne)},ie=async()=>{if(!(!c||!h))try{let ne=J.from("entregas_reciclaveis").select("data_validacao, peso_validado, cooperativas!inner(uf, cidade)").eq("status","validada").gte("data_validacao",c.toISOString()).lte("data_validacao",h.toISOString());_&&_!=="todos"&&(ne=ne.eq("cooperativas.uf",_)),T&&T!=="todas"&&(ne=ne.eq("cooperativas.cidade",T)),ne=ne.order("data_validacao");const{data:Me}=await ne;let Ie=null;if(x&&b){let we=J.from("entregas_reciclaveis").select("data_validacao, peso_validado, cooperativas!inner(uf, cidade)").eq("status","validada").gte("data_validacao",x.toISOString()).lte("data_validacao",b.toISOString());_&&_!=="todos"&&(we=we.eq("cooperativas.uf",_)),T&&T!=="todas"&&(we=we.eq("cooperativas.cidade",T)),we=we.order("data_validacao"),Ie=(await we).data}const Be=we=>we?we.reduce((Le,Nt)=>{const Ge=Os(new Date(Nt.data_validacao),"dd/MM/yyyy",{locale:$s});return Le[Ge]||(Le[Ge]={peso:0,count:0}),Le[Ge].peso+=Number(Nt.peso_validado)||0,Le[Ge].count+=1,Le},{}):{},ot=Be(Me||[]),Se=Be(Ie||[]),ze=[];Me&&Object.keys(ot).forEach(we=>{ze.push({data:we,"Perodo Atual - Peso (kg)":ot[we].peso,"Perodo Atual - Entregas":ot[we].count})}),Ie&&Object.keys(Se).forEach(we=>{const Le=ze.find(Nt=>Nt.data===we);Le?(Le["Perodo Anterior - Peso (kg)"]=Se[we].peso,Le["Perodo Anterior - Entregas"]=Se[we].count):ze.push({data:we,"Perodo Anterior - Peso (kg)":Se[we].peso,"Perodo Anterior - Entregas":Se[we].count})}),le(ze)}catch(ne){console.error("Error loading timeline data:",ne)}},ce=async()=>{Q(!0);try{let ne=J.from("entregas_reciclaveis").select("tipo_material, peso_validado, data_validacao, cooperativas!inner(id, cidade, uf)").eq("status","validada");if(B!=="todas"&&(ne=ne.eq("id_cooperativa",B)),D!=="todos"&&(ne=ne.eq("cooperativas.uf",D)),M!=="todas"&&(ne=ne.eq("cooperativas.cidade",M)),q&&(ne=ne.gte("data_validacao",q.toISOString())),ae){const Ie=new Date(ae);Ie.setHours(23,59,59,999),ne=ne.lte("data_validacao",Ie.toISOString())}const{data:Me}=await ne;if(Me){const Ie=Me.reduce((ot,Se)=>{const ze=Se.tipo_material;return ot[ze]||(ot[ze]=0),ot[ze]+=Number(Se.peso_validado)||0,ot},{}),Be=Object.entries(Ie).map(([ot,Se])=>({tipo_material:ot,peso_total:Number(Se)}));Z(Be)}}catch(ne){console.error("Error loading entregas:",ne)}finally{Q(!1)}},xe=[...new Set(k.map(ne=>ne.uf))].filter(Boolean).sort(),Ce=[...new Set(k.filter(ne=>D==="todos"||ne.uf===D).map(ne=>ne.cidade))].filter(Boolean).sort(),me=[{name:"Disponveis",value:t.cupons_disponiveis},{name:"Resgatados",value:t.cupons_resgatados},{name:"Usados",value:t.cupons_usados}],fe=[{name:"Pendentes",value:t.notas_pendentes},{name:"Validadas",value:t.notas_validadas}],ve=[{name:"Usurios",value:t.usuarios_totais},{name:"Cooperativas",value:t.cooperativas_ativas},{name:"Entregas",value:t.entregas_total},{name:"Misses",value:t.missoes_ativas}];return s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-8",children:s.jsxs("div",{className:"mx-auto max-w-7xl space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>e("/admin"),className:"gap-2",children:[s.jsx(As,{className:"h-4 w-4"}),"Voltar"]}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:"KPIs e Anlises"}),s.jsx("p",{className:"text-muted-foreground",children:"Acompanhe as mtricas detalhadas do sistema"})]})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Filtros de Anlise"}),s.jsx(Tt,{children:"Selecione perodos e localizao para anlise comparativa"})]}),s.jsxs(De,{className:"space-y-6",children:[s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx(oe,{variant:"outline",size:"sm",onClick:()=>{const ne=new Date;d(ln(ne,7)),p(ne),v(ln(ne,14)),N(ln(ne,8))},children:"ltimos 7 dias vs anterior"}),s.jsx(oe,{variant:"outline",size:"sm",onClick:()=>{const ne=new Date;d(ln(ne,30)),p(ne),v(ln(ne,60)),N(ln(ne,31))},children:"ltimos 30 dias vs anterior"}),s.jsx(oe,{variant:"outline",size:"sm",onClick:()=>{const ne=new Date;d(ln(ne,90)),p(ne),v(ln(ne,180)),N(ln(ne,91))},children:"ltimos 90 dias vs anterior"})]}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-4 p-4 border rounded-lg",children:[s.jsx("h3",{className:"font-semibold text-sm",children:"Perodo Atual"}),s.jsxs("div",{className:"grid gap-3",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Data Incio"}),s.jsxs(bl,{children:[s.jsx(_l,{asChild:!0,children:s.jsxs(oe,{variant:"outline",className:pt("w-full justify-start text-left font-normal",!c&&"text-muted-foreground"),children:[s.jsx(Fa,{className:"mr-2 h-4 w-4"}),c?Os(c,"PPP",{locale:$s}):"Selecione"]})}),s.jsx(Xo,{className:"w-auto p-0",align:"start",children:s.jsx(oc,{mode:"single",selected:c,onSelect:d,initialFocus:!0,className:pt("p-3 pointer-events-auto")})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Data Fim"}),s.jsxs(bl,{children:[s.jsx(_l,{asChild:!0,children:s.jsxs(oe,{variant:"outline",className:pt("w-full justify-start text-left font-normal",!h&&"text-muted-foreground"),children:[s.jsx(Fa,{className:"mr-2 h-4 w-4"}),h?Os(h,"PPP",{locale:$s}):"Selecione"]})}),s.jsx(Xo,{className:"w-auto p-0",align:"start",children:s.jsx(oc,{mode:"single",selected:h,onSelect:p,initialFocus:!0,className:pt("p-3 pointer-events-auto")})})]})]})]})]}),s.jsxs("div",{className:"space-y-4 p-4 border rounded-lg",children:[s.jsx("h3",{className:"font-semibold text-sm",children:"Perodo de Comparao"}),s.jsxs("div",{className:"grid gap-3",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Data Incio"}),s.jsxs(bl,{children:[s.jsx(_l,{asChild:!0,children:s.jsxs(oe,{variant:"outline",className:pt("w-full justify-start text-left font-normal",!x&&"text-muted-foreground"),children:[s.jsx(Fa,{className:"mr-2 h-4 w-4"}),x?Os(x,"PPP",{locale:$s}):"Selecione"]})}),s.jsx(Xo,{className:"w-auto p-0",align:"start",children:s.jsx(oc,{mode:"single",selected:x,onSelect:v,initialFocus:!0,className:pt("p-3 pointer-events-auto")})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Data Fim"}),s.jsxs(bl,{children:[s.jsx(_l,{asChild:!0,children:s.jsxs(oe,{variant:"outline",className:pt("w-full justify-start text-left font-normal",!b&&"text-muted-foreground"),children:[s.jsx(Fa,{className:"mr-2 h-4 w-4"}),b?Os(b,"PPP",{locale:$s}):"Selecione"]})}),s.jsx(Xo,{className:"w-auto p-0",align:"start",children:s.jsx(oc,{mode:"single",selected:b,onSelect:N,initialFocus:!0,className:pt("p-3 pointer-events-auto")})})]})]})]})]})]}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Estado (UF)"}),s.jsxs(qs,{value:_,onValueChange:C,children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Todos os estados"})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"todos",children:"Todos os estados"}),Array.from(new Set(k.map(ne=>ne.uf))).sort().map(ne=>s.jsx(xt,{value:ne,children:ne},ne))]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Cidade"}),s.jsxs(qs,{value:T,onValueChange:A,disabled:_==="todos",children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Todas as cidades"})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"todas",children:"Todas as cidades"}),k.filter(ne=>_==="todos"||ne.uf===_).map(ne=>ne.cidade).filter((ne,Me,Ie)=>Ie.indexOf(ne)===Me).sort().map(ne=>s.jsx(xt,{value:ne,children:ne},ne))]})]})]})]})]})]}),i?s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-muted-foreground",children:"Carregando mtricas..."})}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-2",children:[s.jsxs(Tt,{className:"flex items-center gap-2",children:[s.jsx(oa,{className:"h-4 w-4"}),"Usurios Totais"]}),s.jsx(Qe,{className:"text-3xl",children:t.usuarios_totais})]})}),s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-2",children:[s.jsxs(Tt,{className:"flex items-center gap-2",children:[s.jsx(Ur,{className:"h-4 w-4"}),"Cooperativas Ativas"]}),s.jsx(Qe,{className:"text-3xl",children:t.cooperativas_ativas})]})}),s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-2",children:[s.jsxs(Tt,{className:"flex items-center gap-2",children:[s.jsx(Ir,{className:"h-4 w-4"}),"Entregas Realizadas"]}),s.jsx(Qe,{className:"text-3xl",children:t.entregas_total})]})}),s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-2",children:[s.jsxs(Tt,{className:"flex items-center gap-2",children:[s.jsx(Ur,{className:"h-4 w-4"}),"Peso Total (kg)"]}),s.jsx(Qe,{className:"text-3xl",children:t.peso_total_kg})]})})]}),re.length>0&&s.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Evoluo do Peso de Resduos"}),s.jsx(Tt,{children:"Comparao entre perodos (kg validados)"})]}),s.jsx(De,{children:s.jsx(mi,{width:"100%",height:350,children:s.jsxs(_x,{data:re,children:[s.jsx(go,{strokeDasharray:"3 3"}),s.jsx(vo,{dataKey:"data",tick:{fontSize:11}}),s.jsx(yo,{label:{value:"Peso (kg)",angle:-90,position:"insideLeft"}}),s.jsx(pi,{}),s.jsx(Yo,{}),s.jsx(El,{type:"monotone",dataKey:"Perodo Atual - Peso (kg)",stroke:"hsl(var(--primary))",strokeWidth:2,dot:{fill:"hsl(var(--primary))"}}),s.jsx(El,{type:"monotone",dataKey:"Perodo Anterior - Peso (kg)",stroke:"hsl(var(--muted-foreground))",strokeWidth:2,strokeDasharray:"5 5",dot:{fill:"hsl(var(--muted-foreground))"}})]})})})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Evoluo de Entregas Validadas"}),s.jsx(Tt,{children:"Comparao entre perodos (quantidade)"})]}),s.jsx(De,{children:s.jsx(mi,{width:"100%",height:350,children:s.jsxs(_x,{data:re,children:[s.jsx(go,{strokeDasharray:"3 3"}),s.jsx(vo,{dataKey:"data",tick:{fontSize:11}}),s.jsx(yo,{label:{value:"Entregas",angle:-90,position:"insideLeft"}}),s.jsx(pi,{}),s.jsx(Yo,{}),s.jsx(El,{type:"monotone",dataKey:"Perodo Atual - Entregas",stroke:"hsl(var(--accent))",strokeWidth:2,dot:{fill:"hsl(var(--accent))"}}),s.jsx(El,{type:"monotone",dataKey:"Perodo Anterior - Entregas",stroke:"hsl(var(--muted-foreground))",strokeWidth:2,strokeDasharray:"5 5",dot:{fill:"hsl(var(--muted-foreground))"}})]})})})]})]}),s.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(Jn,{className:"h-5 w-5"}),"Status dos Cupons"]}),s.jsx(Tt,{children:"Distribuio de cupons por status"})]}),s.jsx(De,{children:s.jsx(mi,{width:"100%",height:300,children:s.jsxs(Pw,{children:[s.jsx(Iw,{data:me,cx:"50%",cy:"45%",labelLine:!0,label:({name:ne,value:Me})=>`${ne}: ${Me}`,outerRadius:70,fill:"#8884d8",dataKey:"value",children:me.map((ne,Me)=>s.jsx(Ow,{fill:iS[Me%iS.length]},`cell-${Me}`))}),s.jsx(pi,{}),s.jsx(Yo,{verticalAlign:"bottom",height:36})]})})})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(Qa,{className:"h-5 w-5"}),"Status das Notas Fiscais"]}),s.jsx(Tt,{children:"Notas fiscais pendentes vs validadas"})]}),s.jsx(De,{children:s.jsx(mi,{width:"100%",height:300,children:s.jsxs(ju,{data:fe,children:[s.jsx(go,{strokeDasharray:"3 3"}),s.jsx(vo,{dataKey:"name"}),s.jsx(yo,{}),s.jsx(pi,{}),s.jsx(Rl,{dataKey:"value",fill:"hsl(var(--primary))"})]})})})]}),s.jsxs(Ne,{className:"md:col-span-2",children:[s.jsxs(Ye,{children:[s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(hn,{className:"h-5 w-5"}),"Viso Geral da Plataforma"]}),s.jsx(Tt,{children:"Mtricas de engajamento e uso"})]}),s.jsx(De,{children:s.jsx(mi,{width:"100%",height:300,children:s.jsxs(ju,{data:ve,children:[s.jsx(go,{strokeDasharray:"3 3"}),s.jsx(vo,{dataKey:"name"}),s.jsx(yo,{}),s.jsx(pi,{}),s.jsx(Yo,{}),s.jsx(Rl,{dataKey:"value",fill:"hsl(var(--accent))"})]})})})]})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(P6,{className:"h-5 w-5"}),"Resduos Entregues"]}),s.jsx(Tt,{children:"Anlise de resduos por cooperativa, estado e cidade"})]}),s.jsxs(De,{className:"space-y-6",children:[s.jsxs("div",{className:"grid gap-4 md:grid-cols-3 lg:grid-cols-5",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Cooperativa"}),s.jsxs(qs,{value:B,onValueChange:O,children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Todas as cooperativas"})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"todas",children:"Todas as cooperativas"}),k.map(ne=>s.jsx(xt,{value:ne.id,children:ne.nome_fantasia},ne.id))]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Estado"}),s.jsxs(qs,{value:D,onValueChange:ne=>{F(ne),z("todas")},children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Todos os estados"})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"todos",children:"Todos os estados"}),xe.map(ne=>s.jsx(xt,{value:ne,children:ne},ne))]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Cidade"}),s.jsxs(qs,{value:M,onValueChange:z,children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Todas as cidades"})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"todas",children:"Todas as cidades"}),Ce.map(ne=>s.jsx(xt,{value:ne,children:ne},ne))]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Data Incio"}),s.jsxs(bl,{children:[s.jsx(_l,{asChild:!0,children:s.jsxs(oe,{variant:"outline",className:pt("w-full justify-start text-left font-normal",!q&&"text-muted-foreground"),children:[s.jsx(Fa,{className:"mr-2 h-4 w-4"}),q?Os(q,"dd/MM/yyyy",{locale:$s}):"Selecionar"]})}),s.jsxs(Xo,{className:"w-auto p-0",align:"start",children:[s.jsx(oc,{mode:"single",selected:q,onSelect:Y,initialFocus:!0,className:pt("p-3 pointer-events-auto")}),q&&s.jsx("div",{className:"p-3 border-t",children:s.jsx(oe,{variant:"ghost",className:"w-full",onClick:()=>Y(void 0),children:"Limpar"})})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Data Fim"}),s.jsxs(bl,{children:[s.jsx(_l,{asChild:!0,children:s.jsxs(oe,{variant:"outline",className:pt("w-full justify-start text-left font-normal",!ae&&"text-muted-foreground"),children:[s.jsx(Fa,{className:"mr-2 h-4 w-4"}),ae?Os(ae,"dd/MM/yyyy",{locale:$s}):"Selecionar"]})}),s.jsxs(Xo,{className:"w-auto p-0",align:"start",children:[s.jsx(oc,{mode:"single",selected:ae,onSelect:je,disabled:ne=>q?ne<q:!1,initialFocus:!0,className:pt("p-3 pointer-events-auto")}),ae&&s.jsx("div",{className:"p-3 border-t",children:s.jsx(oe,{variant:"ghost",className:"w-full",onClick:()=>je(void 0),children:"Limpar"})})]})]})]})]}),G?s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-muted-foreground",children:"Carregando dados..."})}):H.length===0?s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-muted-foreground",children:"Nenhum dado encontrado para os filtros selecionados"})}):s.jsx(mi,{width:"100%",height:400,children:s.jsxs(ju,{data:H,children:[s.jsx(go,{strokeDasharray:"3 3"}),s.jsx(vo,{dataKey:"tipo_material"}),s.jsx(yo,{label:{value:"Peso (kg)",angle:-90,position:"insideLeft"}}),s.jsx(pi,{formatter:ne=>[`${ne} kg`,"Peso Total"]}),s.jsx(Yo,{}),s.jsx(Rl,{dataKey:"peso_total",fill:"hsl(var(--primary))",name:"Peso Total (kg)"})]})})]})]})]})]})})}const Hoe=()=>{const e=ds(),{toast:t}=_r(),[r,a]=E.useState(!1),[n,i]=E.useState(""),[o,c]=E.useState(!0);E.useEffect(()=>{d()},[]);const d=async()=>{try{c(!0);const _=await(await fetch("/RELATORIO_FUNCIONAL_CICLIK.md")).text();i(_)}catch(N){console.error("Erro ao carregar relatrio:",N),t({title:"Erro ao carregar relatrio",description:"No foi possvel carregar o contedo do relatrio.",variant:"destructive"})}finally{c(!1)}},h=()=>{const N=new Blob([n],{type:"text/markdown"}),_=URL.createObjectURL(N),C=document.createElement("a");C.href=_,C.download="RELATORIO_FUNCIONAL_CICLIK.md",document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(_),t({title:"Download iniciado",description:"O arquivo Markdown est sendo baixado."})},p=async()=>{a(!0);try{const N=new Z8({orientation:"portrait",unit:"mm",format:"a4"}),_=N.internal.pageSize.getWidth(),C=N.internal.pageSize.getHeight(),T=15,A=_-2*T;let k=T;N.setFontSize(18),N.setFont("helvetica","bold"),N.text("Relatrio Funcional Completo - Ciclik",T,k),k+=10,N.setFontSize(10),N.setFont("helvetica","normal"),N.text(`Gerado em: ${new Date().toLocaleDateString("pt-BR")}`,T,k),k+=10;const I=n.split(`
`);for(let B=0;B<I.length;B++){const O=I[B];if(k>C-T&&(N.addPage(),k=T),O.startsWith("# ")){k+=5,N.setFontSize(16),N.setFont("helvetica","bold");const D=O.replace("# ","");N.text(D,T,k),k+=8}else if(O.startsWith("## ")){k+=4,N.setFontSize(14),N.setFont("helvetica","bold");const D=O.replace("## ","");N.text(D,T,k),k+=7}else if(O.startsWith("### ")){k+=3,N.setFontSize(12),N.setFont("helvetica","bold");const D=O.replace("### ","");N.text(D,T,k),k+=6}else if(O.startsWith("#### ")){N.setFontSize(11),N.setFont("helvetica","bold");const D=O.replace("#### ","");N.text(D,T,k),k+=5}else if(O.startsWith("- ")||O.startsWith("* ")){N.setFontSize(10),N.setFont("helvetica","normal");const D=" "+O.substring(2),F=N.splitTextToSize(D,A-5);N.text(F,T+5,k),k+=F.length*4.5}else if(O.startsWith("```")){for(N.setFontSize(9),N.setFont("courier","normal"),B++;B<I.length&&!I[B].startsWith("```");)k>C-T&&(N.addPage(),k=T),N.text(I[B],T+3,k),k+=4,B++;N.setFont("helvetica","normal")}else if(O.trim()!==""){N.setFontSize(10),N.setFont("helvetica","normal");const D=N.splitTextToSize(O,A);k+D.length*5>C-T&&(N.addPage(),k=T),N.text(D,T,k),k+=D.length*5}else k+=4}N.save("Relatorio_Funcional_Ciclik.pdf"),t({title:"PDF gerado com sucesso!",description:"O relatrio foi baixado em formato PDF."})}catch(N){console.error("Erro ao gerar PDF:",N),t({title:"Erro ao gerar PDF",description:"Ocorreu um erro durante a gerao do PDF.",variant:"destructive"})}finally{a(!1)}},x=()=>o?s.jsx("div",{className:"flex items-center justify-center p-12",children:s.jsx(_s,{className:"h-8 w-8 animate-spin text-primary"})}):s.jsx("div",{className:"prose prose-sm max-w-none",children:n.split(`
`).map((N,_)=>{if(N.startsWith("# "))return s.jsx("h1",{className:"text-3xl font-bold mt-8 mb-4 text-foreground",children:N.replace("# ","")},_);if(N.startsWith("## "))return s.jsx("h2",{className:"text-2xl font-bold mt-6 mb-3 text-foreground",children:N.replace("## ","")},_);if(N.startsWith("### "))return s.jsx("h3",{className:"text-xl font-semibold mt-5 mb-2 text-foreground",children:N.replace("### ","")},_);if(N.startsWith("#### "))return s.jsx("h4",{className:"text-lg font-semibold mt-4 mb-2 text-foreground",children:N.replace("#### ","")},_);if(N.startsWith("- ")||N.startsWith("* "))return s.jsx("li",{className:"ml-6 text-sm text-muted-foreground",children:N.substring(2)},_);if(N.startsWith("```"))return null;if(N.trim()==="---")return s.jsx("hr",{className:"my-6 border-border"},_);if(N.includes("**")){const C=N.split("**");return s.jsx("p",{className:"text-sm text-muted-foreground my-1",children:C.map((T,A)=>A%2===0?T:s.jsx("strong",{className:"font-semibold text-foreground",children:T},A))},_)}return N.trim()===""?s.jsx("div",{className:"h-2"},_):s.jsx("p",{className:"text-sm text-muted-foreground my-1",children:N},_)})}),b=n?(()=>{const N=[];return n.split(`
`).forEach((C,T)=>{C.startsWith("# ")?N.push({title:C.replace("# ",""),level:1,index:T}):C.startsWith("## ")?N.push({title:C.replace("## ",""),level:2,index:T}):C.startsWith("### ")&&N.push({title:C.replace("### ",""),level:3,index:T})}),N})():[];return s.jsx(Nc,{children:s.jsx("div",{className:"min-h-screen bg-background p-4 md:p-8",children:s.jsxs("div",{className:"mx-auto max-w-7xl space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>e("/admin"),className:"gap-2",children:[s.jsx(As,{className:"h-4 w-4"}),"Voltar"]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"rounded-full bg-warning/10 p-2",children:s.jsx(Qa,{className:"h-6 w-6 text-warning"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Documentao do Sistema"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Relatrio Funcional Completo - Ciclik"})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(oe,{variant:"outline",onClick:h,className:"gap-2",disabled:o,children:[s.jsx(w6,{className:"h-4 w-4"}),"Baixar MD"]}),s.jsxs(oe,{onClick:p,disabled:r||o,className:"gap-2",children:[r?s.jsx(_s,{className:"h-4 w-4 animate-spin"}):s.jsx(Ua,{className:"h-4 w-4"}),"Baixar PDF"]})]})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Relatrio Funcional Completo"}),s.jsx(Tt,{children:"Documentao tcnica completa sobre todas as funcionalidades, fluxos, modelos de dados e impactos ambientais do aplicativo Ciclik"})]}),s.jsx(De,{children:s.jsxs(Mn,{defaultValue:"content",className:"w-full",children:[s.jsxs(Nn,{className:"grid w-full grid-cols-2",children:[s.jsx(Gs,{value:"content",children:"Contedo Completo"}),s.jsx(Gs,{value:"toc",children:"ndice"})]}),s.jsx(hr,{value:"content",className:"mt-6",children:s.jsx("div",{className:"max-h-[calc(100vh-300px)] overflow-y-auto pr-4 space-y-2",children:x()})}),s.jsx(hr,{value:"toc",className:"mt-6",children:s.jsx("div",{className:"max-h-[calc(100vh-300px)] overflow-y-auto pr-4",children:o?s.jsx("div",{className:"flex items-center justify-center p-12",children:s.jsx(_s,{className:"h-8 w-8 animate-spin text-primary"})}):s.jsx("div",{className:"space-y-2",children:b.map((N,_)=>s.jsx("div",{className:`py-2 px-4 hover:bg-muted rounded-lg cursor-pointer transition-colors ${N.level===1?"font-bold text-foreground":N.level===2?"ml-4 font-semibold text-foreground":"ml-8 text-muted-foreground"}`,children:s.jsx("span",{className:"text-sm",children:N.title})},_))})})})]})})]})]})})})};async function G5(e){try{const{data:t,error:r}=await J.from("termos_uso").select("*").eq("id",e).single();if(r){if(r.code==="PGRST116")return null;throw console.error("Erro ao buscar termo por ID:",r),new Error("No foi possvel carregar o termo")}return t}catch(t){throw console.error("Erro em buscarTermoPorId:",t),t}}async function Goe(e={},t=1,r=10){try{const{data:{user:a}}=await J.auth.getUser();if(!a)throw new Error("Usurio no autenticado");const{data:n,error:i}=await J.from("user_roles").select("role").eq("user_id",a.id).single();if(i||n.role!=="admin")throw new Error("Apenas administradores podem listar todos os termos");let o=J.from("termos_uso").select("*",{count:"exact"});e.tipo&&(o=o.eq("tipo",e.tipo)),e.ativo!==void 0&&(o=o.eq("ativo",e.ativo)),e.versao&&(o=o.eq("versao",e.versao)),e.busca&&(o=o.or(`titulo.ilike.%${e.busca}%,resumo.ilike.%${e.busca}%`));const c=(t-1)*r;o=o.order("criado_em",{ascending:!1}).range(c,c+r-1);const{data:d,error:h,count:p}=await o;if(h)throw console.error("Erro ao listar termos:",h),new Error("No foi possvel carregar a lista de termos");return{dados:d||[],total:p||0,pagina:t,porPagina:r,totalPaginas:Math.ceil((p||0)/r)}}catch(a){throw console.error("Erro em listarTodosTermos:",a),a}}async function Koe(e){try{const{data:{user:t}}=await J.auth.getUser();if(!t)throw new Error("Usurio no autenticado");const{data:r,error:a}=await J.from("user_roles").select("role").eq("user_id",t.id).single();if(a||r.role!=="admin")throw new Error("Apenas administradores podem criar termos");if(!e.titulo||!e.tipo||!e.versao||!e.pdf_url)throw new Error("Campos obrigatrios faltando: ttulo, tipo, verso e PDF");if(!e.roles_aplicaveis||e.roles_aplicaveis.length===0)throw new Error("Pelo menos um role deve ser selecionado");const{data:n,error:i}=await J.from("termos_uso").insert({tipo:e.tipo,versao:e.versao,titulo:e.titulo,resumo:e.descricao,conteudo_html:e.conteudo_html,pdf_url:e.pdf_url,pdf_path:`v${e.versao}/${e.tipo.replace(/_/g,"-")}-v${e.versao}.pdf`,roles_aplicaveis:e.roles_aplicaveis,obrigatorio:e.obrigatorio??!0,ativo:e.ativo??!0}).select().single();if(i)throw console.error("Erro ao criar termo:",i),i.code==="23505"?new Error("J existe um termo com essa combinao de tipo e verso"):new Error("No foi possvel criar o termo");return n}catch(t){throw console.error("Erro em criarTermo:",t),t}}async function Xoe(e,t){try{const{data:{user:r}}=await J.auth.getUser();if(!r)throw new Error("Usurio no autenticado");const{data:a,error:n}=await J.from("user_roles").select("role").eq("user_id",r.id).single();if(n||a.role!=="admin")throw new Error("Apenas administradores podem atualizar termos");const{data:i,error:o}=await J.from("termos_uso").update({titulo:t.titulo,resumo:t.descricao,conteudo_html:t.conteudo_html,pdf_url:t.pdf_url,obrigatorio:t.obrigatorio,ativo:t.ativo}).eq("id",e).select().single();if(o)throw console.error("Erro ao atualizar termo:",o),o.code==="PGRST116"?new Error("Termo no encontrado"):new Error("No foi possvel atualizar o termo");return i}catch(r){throw console.error("Erro em atualizarTermo:",r),r}}async function oS(e,t){try{const{data:{user:r}}=await J.auth.getUser();if(!r)throw new Error("Usurio no autenticado");const{data:a,error:n}=await J.from("user_roles").select("role").eq("user_id",r.id).single();if(n||a.role!=="admin")throw new Error("Apenas administradores podem alterar status de termos");const{data:i,error:o}=await J.from("termos_uso").update({ativo:t}).eq("id",e).select().single();if(o)throw console.error("Erro ao alterar status do termo:",o),o.code==="PGRST116"?new Error("Termo no encontrado"):new Error("No foi possvel alterar o status do termo");return i}catch(r){throw console.error("Erro em alterarStatusTermo:",r),r}}async function Yoe(e){try{const{data:{user:t}}=await J.auth.getUser();if(!t)throw new Error("Usurio no autenticado");const{data:r,error:a}=await J.from("user_roles").select("role").eq("user_id",t.id).single();if(a||r.role!=="admin")throw new Error("Apenas administradores podem deletar termos");const{data:n,error:i}=await J.from("aceites_termos").select("id").eq("termo_id",e).limit(1);if(i)throw console.error("Erro ao verificar aceites:",i),new Error("No foi possvel verificar aceites do termo");if(n&&n.length>0)throw new Error("No  possvel deletar um termo que j possui aceites");const{error:o}=await J.from("termos_uso").delete().eq("id",e);if(o)throw console.error("Erro ao deletar termo:",o),o.code==="PGRST116"?new Error("Termo no encontrado"):new Error("No foi possvel deletar o termo")}catch(t){throw console.error("Erro em deletarTermo:",t),t}}async function Zoe(e){try{const{data:t,error:r}=await J.from("termos_uso").select("*").eq("tipo",e).order("versao",{ascending:!1});if(r)throw console.error("Erro ao buscar histrico:",r),new Error("No foi possvel carregar o histrico de verses");return t||[]}catch(t){throw console.error("Erro em buscarHistoricoVersoes:",t),t}}function Qoe(e){const t=[],r=e.size/1048576;return e.type!=="application/pdf"&&t.push("O arquivo deve ser um PDF"),r>L1.TAMANHO_MAX_PDF_MB&&t.push(`O arquivo deve ter no mximo ${L1.TAMANHO_MAX_PDF_MB}MB`),L1.PDF_NAME_PATTERN.test(e.name)||t.push("Nome do arquivo invlido. Use apenas letras, nmeros, hfens e underscores"),{valido:t.length===0,erros:t,tamanho_mb:r}}function Joe(e,t){const r=t.replace(/[^0-9.]/g,""),a=e.replace(/_/g,"-");return`v${r}/${a}-v${r}.pdf`}async function K5(e,t,r){try{const{data:{user:a}}=await J.auth.getUser();if(!a)return{success:!1,error:"Usurio no autenticado"};const{data:n,error:i}=await J.from("user_roles").select("role").eq("user_id",a.id).single();if(i||n.role!=="admin")return{success:!1,error:"Apenas administradores podem fazer upload de PDFs"};const o=Qoe(e);if(!o.valido)return{success:!1,error:o.erros.join(", ")};const c=Joe(t,r),{error:d}=await J.storage.from("termos-uso").upload(c,e,{cacheControl:"3600",upsert:!0,contentType:"application/pdf"});if(d)return console.error("Erro no upload:",d),d.message.includes("Bucket not found")?{success:!1,error:"Bucket de storage no encontrado. Configure o storage primeiro."}:{success:!1,error:`Erro ao fazer upload: ${d.message}`};const{data:h,error:p}=await J.storage.from("termos-uso").createSignedUrl(c,31536e3);return p?(console.error("Erro ao gerar URL:",p),{success:!1,error:"PDF enviado, mas erro ao gerar URL de acesso"}):{success:!0,pdf_path:c,pdf_url:h.signedUrl}}catch(a){return console.error("Erro em uploadPDF:",a),{success:!1,error:a instanceof Error?a.message:"Erro desconhecido no upload"}}}function X5(){const{user:e}=sr(),[t,r]=E.useState([]),[a,n]=E.useState(0),[i,o]=E.useState(1),[c,d]=E.useState(0),[h,p]=E.useState(!1),[x,v]=E.useState(null),[b,N]=E.useState(!1);E.useEffect(()=>{async function F(){if(!(e!=null&&e.id)){N(!1);return}try{const{supabase:M}=await Ov(async()=>{const{supabase:Y}=await Promise.resolve().then(()=>T7);return{supabase:Y}},void 0),{data:z,error:q}=await M.from("user_roles").select("role").eq("user_id",e.id).single();!q&&(z==null?void 0:z.role)==="admin"?N(!0):N(!1)}catch(M){console.error("Erro ao verificar admin:",M),N(!1)}}F()},[e==null?void 0:e.id]);const _=E.useCallback(async(F={},M=1)=>{if(!b){v("Apenas administradores podem listar termos");return}try{p(!0),v(null);const z=await Goe(F,M,10);r(z.dados),n(z.total),o(z.pagina),d(z.totalPaginas)}catch(z){const q=z instanceof Error?z.message:"Erro ao listar termos";v(q),console.error("Erro em listar:",z)}finally{p(!1)}},[b]),C=E.useCallback(async F=>{if(!b)return v("Apenas administradores podem criar termos"),null;try{p(!0),v(null);const M=await Koe(F);return await _(),console.log(" Termo criado:",M.id),M}catch(M){const z=M instanceof Error?M.message:"Erro ao criar termo";return v(z),console.error("Erro em criar:",M),null}finally{p(!1)}},[b,_]),T=E.useCallback(async(F,M)=>{if(!b)return v("Apenas administradores podem atualizar termos"),null;try{p(!0),v(null);const z=await Xoe(F,M);return r(q=>q.map(Y=>Y.id===F?z:Y)),console.log(" Termo atualizado:",F),z}catch(z){const q=z instanceof Error?z.message:"Erro ao atualizar termo";return v(q),console.error("Erro em atualizar:",z),null}finally{p(!1)}},[b]),A=E.useCallback(async F=>{if(!b)return v("Apenas administradores podem ativar termos"),!1;try{p(!0),v(null);const M=await oS(F,!0);return r(z=>z.map(q=>q.id===F?M:q)),console.log(" Termo ativado:",F),!0}catch(M){const z=M instanceof Error?M.message:"Erro ao ativar termo";return v(z),console.error("Erro em ativar:",M),!1}finally{p(!1)}},[b]),k=E.useCallback(async F=>{if(!b)return v("Apenas administradores podem desativar termos"),!1;try{p(!0),v(null);const M=await oS(F,!1);return r(z=>z.map(q=>q.id===F?M:q)),console.log(" Termo desativado:",F),!0}catch(M){const z=M instanceof Error?M.message:"Erro ao desativar termo";return v(z),console.error("Erro em desativar:",M),!1}finally{p(!1)}},[b]),I=E.useCallback(async F=>{if(!b)return v("Apenas administradores podem deletar termos"),!1;try{return p(!0),v(null),await Yoe(F),r(M=>M.filter(z=>z.id!==F)),n(M=>M-1),console.log(" Termo deletado:",F),!0}catch(M){const z=M instanceof Error?M.message:"Erro ao deletar termo";return v(z),console.error("Erro em deletar:",M),!1}finally{p(!1)}},[b]),B=E.useCallback(async F=>{if(!b)return v("Apenas administradores podem ver histrico"),[];try{p(!0),v(null);const M=await Zoe(F);return console.log(` Histrico carregado: ${M.length} verses`),M}catch(M){const z=M instanceof Error?M.message:"Erro ao buscar histrico";return v(z),console.error("Erro em buscarHistorico:",M),[]}finally{p(!1)}},[b]),O=E.useCallback(async(F,M,z)=>{if(!b)return{success:!1,error:"Apenas administradores podem fazer upload"};try{p(!0),v(null);const q=await K5(F,M,z);return q.success?console.log(" PDF enviado:",q.pdf_path):v(q.error||"Erro no upload"),q}catch(q){const Y=q instanceof Error?q.message:"Erro ao fazer upload";return v(Y),console.error("Erro em upload:",q),{success:!1,error:Y}}finally{p(!1)}},[b]),D=E.useCallback(async()=>{await _({},i)},[_,i]);return{termos:t,total:a,pagina:i,totalPaginas:c,loading:h,error:x,listar:_,criar:C,atualizar:T,ativar:A,desativar:k,deletar:I,buscarHistorico:B,upload:O,isAdmin:b,refetch:D}}function ele(e){const[t,r]=E.useState(null),[a,n]=E.useState([]),[i,o]=E.useState(!1),[c,d]=E.useState(null),h=E.useCallback(async()=>{if(!e){r(null),n([]);return}try{o(!0),d(null);const p=await F7(e);r(p);const{aceites:x}=await L7(e,1,10);n(x)}catch(p){const x=p instanceof Error?p.message:"Erro ao carregar estatsticas";d(x),console.error("Erro em useEstatisticasTermo:",p)}finally{o(!1)}},[e]);return E.useEffect(()=>{h()},[h]),{stats:t,aceites:a,loading:i,error:c,refetch:h}}function tle(){const e=ds(),{termos:t,loading:r,desativar:a,ativar:n,listar:i}=X5(),[o,c]=E.useState(""),[d,h]=E.useState("todos"),[p,x]=E.useState("todos"),[v,b]=E.useState(null),[N,_]=E.useState(!1);E.useEffect(()=>{i()},[i]);const C=t.filter(q=>{var Y;if(o){const ae=o.toLowerCase();if(!(q.titulo.toLowerCase().includes(ae)||((Y=q.resumo)==null?void 0:Y.toLowerCase().includes(ae))))return!1}return!(d!=="todos"&&q.tipo!==d||p==="ativos"&&!q.ativo||p==="inativos"&&q.ativo)}),T=async()=>{if(v){_(!0);try{await a(v.id),b(null)}catch(q){console.error("Erro ao desativar termo:",q)}finally{_(!1)}}},A=async q=>{try{await n(q)}catch(Y){console.error("Erro ao reativar termo:",Y)}},k=()=>{e("/admin/termos/novo")},I=q=>{e(`/admin/termos/${q}/editar`)},B=q=>{e(`/admin/termos/${q}`)},O=q=>{e(`/admin/termos/${q}/relatorio`)},D=q=>{q.pdf_url&&window.open(q.pdf_url,"_blank")},F=q=>new Date(q).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}),M=q=>q.ativo?s.jsx(Je,{variant:"default",children:"Ativo"}):s.jsx(Je,{variant:"secondary",children:"Inativo"}),z=q=>({termos_uso:"Termos de Uso",politica_privacidade:"Poltica de Privacidade",lgpd:"LGPD",contrato:"Contrato",outro:"Outro"})[q]||q;return s.jsxs("div",{className:"container mx-auto py-8 px-4",children:[s.jsxs("div",{className:"mb-6 flex items-center gap-4",children:[s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>e("/admin"),className:"gap-2",children:[s.jsx(As,{className:"h-4 w-4"}),"Voltar"]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Gerenciar Termos de Uso"}),s.jsx("p",{className:"text-muted-foreground mt-2",children:"Crie, edite e gerencie os termos de uso da plataforma"})]}),s.jsxs(oe,{onClick:k,size:"lg",children:[s.jsx(ra,{className:"h-5 w-5 mr-2"}),"Novo Termo"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[s.jsxs(Ne,{children:[s.jsx(Ye,{className:"pb-3",children:s.jsx(Qe,{className:"text-sm font-medium text-muted-foreground",children:"Total de Termos"})}),s.jsx(De,{children:s.jsx("div",{className:"text-2xl font-bold",children:t.length})})]}),s.jsxs(Ne,{children:[s.jsx(Ye,{className:"pb-3",children:s.jsx(Qe,{className:"text-sm font-medium text-muted-foreground",children:"Termos Ativos"})}),s.jsx(De,{children:s.jsx("div",{className:"text-2xl font-bold",children:t.filter(q=>q.ativo).length})})]}),s.jsxs(Ne,{children:[s.jsx(Ye,{className:"pb-3",children:s.jsx(Qe,{className:"text-sm font-medium text-muted-foreground",children:"Obrigatrios"})}),s.jsx(De,{children:s.jsx("div",{className:"text-2xl font-bold",children:t.filter(q=>q.obrigatorio).length})})]}),s.jsxs(Ne,{children:[s.jsx(Ye,{className:"pb-3",children:s.jsx(Qe,{className:"text-sm font-medium text-muted-foreground",children:"Inativos"})}),s.jsx(De,{children:s.jsx("div",{className:"text-2xl font-bold",children:t.filter(q=>!q.ativo).length})})]})]}),s.jsxs(Ne,{className:"mb-6",children:[s.jsx(Ye,{children:s.jsxs(Qe,{className:"text-lg flex items-center gap-2",children:[s.jsx(Of,{className:"h-5 w-5"}),"Filtros"]})}),s.jsxs(De,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(eo,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),s.jsx(We,{placeholder:"Buscar por ttulo ou descrio...",value:o,onChange:q=>c(q.target.value),className:"pl-9"})]}),s.jsxs(qs,{value:d,onValueChange:h,children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Filtrar por tipo"})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"todos",children:"Todos os tipos"}),s.jsx(xt,{value:"termos_uso",children:"Termos de Uso"}),s.jsx(xt,{value:"politica_privacidade",children:"Poltica de Privacidade"}),s.jsx(xt,{value:"lgpd",children:"LGPD"}),s.jsx(xt,{value:"contrato",children:"Contrato"}),s.jsx(xt,{value:"outro",children:"Outro"})]})]}),s.jsxs(qs,{value:p,onValueChange:x,children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Filtrar por status"})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"todos",children:"Todos"}),s.jsx(xt,{value:"ativos",children:"Apenas Ativos"}),s.jsx(xt,{value:"inativos",children:"Apenas Inativos"})]})]})]}),(o||d!=="todos"||p!=="todos")&&s.jsxs("div",{className:"mt-4 text-sm text-muted-foreground",children:["Mostrando ",C.length," de ",t.length," termo(s)"]})]})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Lista de Termos"}),s.jsx(Tt,{children:"Gerencie todos os termos de uso cadastrados"})]}),s.jsx(De,{children:r?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(_s,{className:"h-8 w-8 animate-spin text-primary"})}):C.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Qa,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground opacity-50"}),s.jsx("p",{className:"text-muted-foreground",children:o||d!=="todos"||p!=="todos"?"Nenhum termo encontrado com os filtros aplicados":"Nenhum termo cadastrado ainda"}),!o&&d==="todos"&&p==="todos"&&s.jsxs(oe,{onClick:k,variant:"outline",className:"mt-4",children:[s.jsx(ra,{className:"h-4 w-4 mr-2"}),"Criar Primeiro Termo"]})]}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{children:"Ttulo"}),s.jsx(rt,{children:"Tipo"}),s.jsx(rt,{children:"Verso"}),s.jsx(rt,{children:"Status"}),s.jsx(rt,{children:"Criado em"}),s.jsx(rt,{className:"text-right",children:"Aes"})]})}),s.jsx(da,{children:C.map(q=>s.jsxs(Cs,{children:[s.jsx(Ze,{children:s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:q.titulo}),q.resumo&&s.jsx("div",{className:"text-sm text-muted-foreground line-clamp-1",children:q.resumo})]})}),s.jsx(Ze,{children:s.jsxs("div",{className:"flex items-center gap-2",children:[z(q.tipo),q.obrigatorio&&s.jsx(Je,{variant:"destructive",className:"text-xs",children:"Obrigatrio"})]})}),s.jsx(Ze,{children:s.jsx(Je,{variant:"outline",children:q.versao})}),s.jsx(Ze,{children:M(q)}),s.jsx(Ze,{className:"text-muted-foreground",children:F(q.criado_em)}),s.jsx(Ze,{className:"text-right",children:s.jsxs(S_,{children:[s.jsx(T_,{asChild:!0,children:s.jsx(oe,{variant:"ghost",size:"sm",children:s.jsx(x4,{className:"h-4 w-4"})})}),s.jsxs(Xg,{align:"end",children:[s.jsx(qP,{children:"Aes"}),s.jsx(iw,{}),s.jsxs(Ka,{onClick:()=>B(q.id),children:[s.jsx(ki,{className:"h-4 w-4 mr-2"}),"Visualizar"]}),q.ativo&&s.jsxs(Ka,{onClick:()=>I(q.id),children:[s.jsx(Nd,{className:"h-4 w-4 mr-2"}),"Editar"]}),s.jsxs(Ka,{onClick:()=>O(q.id),children:[s.jsx(f4,{className:"h-4 w-4 mr-2"}),"Relatrio de Aceites"]}),q.pdf_url&&s.jsxs(Ka,{onClick:()=>D(q),children:[s.jsx(Ua,{className:"h-4 w-4 mr-2"}),"Baixar PDF"]}),s.jsx(iw,{}),q.ativo?s.jsxs(Ka,{onClick:()=>b(q),className:"text-destructive",children:[s.jsx(Ba,{className:"h-4 w-4 mr-2"}),"Desativar"]}):s.jsx(Ka,{onClick:()=>A(q.id),children:"Reativar Termo"})]})]})})]},q.id))})]})})})]}),s.jsx(hc,{open:!!v,onOpenChange:q=>!q&&b(null),children:s.jsxs(Dl,{children:[s.jsxs(Ml,{children:[s.jsx(Fl,{children:"Desativar termo?"}),s.jsxs(Bl,{children:['Tem certeza que deseja desativar o termo "',s.jsx("strong",{children:v==null?void 0:v.titulo}),'"?',s.jsx("br",{}),s.jsx("br",{}),"Termos desativados no sero exibidos para novos usurios, mas os aceites existentes sero mantidos. Voc pode reativar o termo posteriormente."]})]}),s.jsxs(Ll,{children:[s.jsx(Ul,{disabled:N,children:"Cancelar"}),s.jsx(Vl,{onClick:T,disabled:N,className:"bg-destructive hover:bg-destructive/90",children:N?s.jsxs(s.Fragment,{children:[s.jsx(_s,{className:"h-4 w-4 mr-2 animate-spin"}),"Desativando..."]}):"Desativar"})]})]})})]})}const sle=[{value:"termos_uso",label:"Termos de Uso"},{value:"politica_privacidade",label:"Poltica de Privacidade"},{value:"termo_lgpd",label:"LGPD"},{value:"contrato_cooperado",label:"Contrato Cooperado"},{value:"contrato_investidor",label:"Contrato Investidor"},{value:"outros",label:"Outro"}],rle=[{value:"cooperado",label:"Cooperado"},{value:"investidor",label:"Investidor"},{value:"operador_logistico",label:"Operador Logstico"},{value:"parceiro",label:"Parceiro"},{value:"admin",label:"Administrador"}];function lS(){const e=ds(),{id:t}=To(),{criar:r,atualizar:a,loading:n,error:i}=X5(),o=!!t,[c,d]=E.useState("termos_uso"),[h,p]=E.useState("1.0.0"),[x,v]=E.useState(""),[b,N]=E.useState(""),[_,C]=E.useState(""),[T,A]=E.useState(!0),[k,I]=E.useState(!0),[B,O]=E.useState([]),[D,F]=E.useState(null),[M,z]=E.useState(""),[q,Y]=E.useState(!1),[ae,je]=E.useState([]);E.useEffect(()=>{o&&t&&H()},[o,t]);const H=async()=>{try{Y(!0),je([]);const le=await G5(t);if(!le){je(["Termo no encontrado"]);return}d(le.tipo),p(le.versao),v(le.titulo),N(le.resumo||""),C(le.conteudo_html||""),A(le.obrigatorio),I(le.ativo),O(le.roles_aplicaveis||[]),z(le.pdf_url||"")}catch(le){console.error("Erro ao carregar termo:",le),je([le instanceof Error?le.message:"Erro ao carregar termo"])}finally{Y(!1)}},Z=()=>{const le=[];return x.trim()||le.push("O ttulo  obrigatrio"),h.trim()||le.push("A verso  obrigatria"),!o&&!D&&!M&&le.push(" necessrio fazer upload de um PDF ou fornecer uma URL"),B.length===0&&le.push("Selecione pelo menos um tipo de usurio (role)"),je(le),le.length===0},G=async le=>{if(le.preventDefault(),!!Z())try{let ye=M;if(D){const W=await K5(D,c,h);if(!W.success){je([W.error||"Erro ao fazer upload do PDF"]);return}ye=W.pdf_url||""}if(!ye){je([" necessrio fornecer um PDF"]);return}if(o)await a(t,{titulo:x,descricao:b,conteudo_html:_||void 0,pdf_url:ye,obrigatorio:T,ativo:k})&&e(`/admin/termos/${t}`);else{const W={tipo:c,versao:h,titulo:x,pdf_url:ye,descricao:b||void 0,conteudo_html:_||void 0,obrigatorio:T,roles_aplicaveis:B.length>0?B:[],ativo:k};await r(W)&&e("/admin/termos")}}catch(ye){console.error("Erro ao salvar termo:",ye),je([ye instanceof Error?ye.message:"Erro ao salvar termo"])}},Q=le=>{O(ye=>ye.includes(le)?ye.filter(W=>W!==le):[...ye,le])},re=le=>{var W;const ye=(W=le.target.files)==null?void 0:W[0];ye&&ye.type==="application/pdf"&&(F(ye),je(ee=>ee.filter(ie=>!ie.includes("PDF"))))};return s.jsxs("div",{className:"container mx-auto py-8 px-4 max-w-4xl",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>e("/admin/termos"),children:s.jsx(As,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:o?"Editar Termo":"Novo Termo de Uso"}),s.jsx("p",{className:"text-muted-foreground mt-1",children:o?"Atualize as informaes do termo existente":"Preencha os dados para criar um novo termo"})]})]}),q&&s.jsxs("div",{className:"flex items-center justify-center py-12",children:[s.jsx(_s,{className:"h-8 w-8 animate-spin text-primary"}),s.jsx("span",{className:"ml-3 text-lg",children:"Carregando termo..."})]}),ae.length>0&&s.jsxs(Er,{variant:"destructive",className:"mb-6",children:[s.jsx(Kr,{className:"h-4 w-4"}),s.jsx(Sr,{children:s.jsx("ul",{className:"list-disc list-inside space-y-1",children:ae.map((le,ye)=>s.jsx("li",{children:le},ye))})})]}),i&&s.jsxs(Er,{variant:"destructive",className:"mb-6",children:[s.jsx(Kr,{className:"h-4 w-4"}),s.jsx(Sr,{children:i})]}),!q&&s.jsxs("form",{onSubmit:G,className:"space-y-6",children:[s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Informaes Bsicas"}),s.jsx(Tt,{children:"Dados principais do termo de uso"})]}),s.jsxs(De,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"tipo",children:"Tipo de Termo *"}),s.jsxs(qs,{value:c,onValueChange:le=>d(le),children:[s.jsx(Ls,{id:"tipo",children:s.jsx(Ws,{})}),s.jsx(Fs,{children:sle.map(le=>s.jsx(xt,{value:le.value,children:le.label},le.value))})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2 md:col-span-2",children:[s.jsx(ke,{htmlFor:"titulo",children:"Ttulo *"}),s.jsx(We,{id:"titulo",value:x,onChange:le=>v(le.target.value),placeholder:"Ex: Termos de Uso da Plataforma Ciclik",required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"versao",children:"Verso *"}),s.jsx(We,{id:"versao",value:h,onChange:le=>p(le.target.value),placeholder:"Ex: 1.0.0",required:!0})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"descricao",children:"Descrio (Opcional)"}),s.jsx(jn,{id:"descricao",value:b,onChange:le=>N(le.target.value),placeholder:"Breve descrio do que este termo abrange...",rows:3}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Ser exibida como prvia para os usurios"})]})]})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Documento PDF *"}),s.jsx(Tt,{children:"Faa upload do arquivo PDF ou fornea uma URL"})]}),s.jsxs(De,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"pdf",children:"Upload de Arquivo"}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(We,{id:"pdf",type:"file",accept:"application/pdf",onChange:re,className:"flex-1"}),D&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(Qa,{className:"h-4 w-4"}),D.name]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"pdfUrl",children:"Ou fornea uma URL"}),s.jsx(We,{id:"pdfUrl",type:"url",value:M,onChange:le=>z(le.target.value),placeholder:"https://exemplo.com/documento.pdf"})]})]})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Contedo HTML (Opcional)"}),s.jsx(Tt,{children:"Verso HTML do termo para exibio inline"})]}),s.jsxs(De,{children:[s.jsx(jn,{value:_,onChange:le=>C(le.target.value),placeholder:"<h1>Ttulo</h1><p>Contedo...</p>",rows:8,className:"font-mono text-sm"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Se fornecido, ser exibido ao invs do PDF na interface"})]})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Configuraes"}),s.jsx(Tt,{children:"Defina como e para quem o termo ser aplicado"})]}),s.jsxs(De,{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx(ke,{htmlFor:"obrigatorio",children:"Aceite Obrigatrio"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Usurios devem aceitar para usar a plataforma"})]}),s.jsx(fi,{id:"obrigatorio",checked:T,onCheckedChange:A})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx(ke,{htmlFor:"ativo",children:"Termo Ativo"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Termo ser exibido para novos usurios"})]}),s.jsx(fi,{id:"ativo",checked:k,onCheckedChange:I})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(ke,{children:"Aplicvel para (deixe vazio para todos)"}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:rle.map(le=>s.jsxs("label",{className:"flex items-center gap-2 p-3 rounded-lg border cursor-pointer hover:bg-accent",children:[s.jsx("input",{type:"checkbox",checked:B.includes(le.value),onChange:()=>Q(le.value),className:"rounded"}),s.jsx("span",{className:"text-sm",children:le.label})]},le.value))}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Se nenhum for selecionado, o termo ser aplicvel para todos os usurios"})]})]})]}),s.jsxs("div",{className:"flex items-center justify-end gap-4",children:[s.jsx(oe,{type:"button",variant:"outline",onClick:()=>e("/admin/termos"),disabled:n,children:"Cancelar"}),s.jsx(oe,{type:"submit",disabled:n,size:"lg",children:n?s.jsxs(s.Fragment,{children:[s.jsx(_s,{className:"h-4 w-4 mr-2 animate-spin"}),"Salvando..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Wu,{className:"h-4 w-4 mr-2"}),o?"Atualizar Termo":"Criar Termo"]})})]})]})]})}const ale={termos_uso:"Termos de Uso",politica_privacidade:"Poltica de Privacidade",termo_lgpd:"LGPD",contrato_cooperado:"Contrato Cooperado",contrato_investidor:"Contrato Investidor",outros:"Outro"},nle={cooperado:"Cooperado",investidor:"Investidor",operador_logistico:"Operador Logstico",parceiro:"Parceiro",admin:"Administrador"};function ile(){const e=ds(),{id:t}=To(),[r,a]=E.useState(null),[n,i]=E.useState(!0),[o,c]=E.useState(null);E.useEffect(()=>{if(!t){e("/admin/termos");return}d()},[t]);const d=async()=>{try{i(!0),c(null);const N=await G5(t);if(!N){c("Termo no encontrado");return}a(N)}catch(N){console.error("Erro ao carregar termo:",N),c(N instanceof Error?N.message:"Erro ao carregar termo")}finally{i(!1)}},h=N=>new Date(N).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),p=()=>{e("/admin/termos")},x=()=>{e(`/admin/termos/${t}/editar`)},v=()=>{e(`/admin/termos/${t}/relatorio`)},b=()=>{r!=null&&r.pdf_url&&window.open(r.pdf_url,"_blank")};return n?s.jsx("div",{className:"container mx-auto py-6 space-y-6",children:s.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx(_s,{className:"h-8 w-8 animate-spin mx-auto text-primary"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Carregando detalhes do termo..."})]})})}):o||!r?s.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[s.jsxs(Er,{variant:"destructive",children:[s.jsx(Kr,{className:"h-4 w-4"}),s.jsx(Sr,{children:o||"Termo no encontrado"})]}),s.jsxs(oe,{variant:"outline",onClick:p,children:[s.jsx(As,{className:"h-4 w-4 mr-2"}),"Voltar"]})]}):s.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(oe,{variant:"outline",onClick:p,children:[s.jsx(As,{className:"h-4 w-4 mr-2"}),"Voltar"]}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Detalhes do Termo"}),s.jsx("p",{className:"text-muted-foreground",children:"Visualizao completa do termo de uso"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[r.ativo&&s.jsxs(oe,{variant:"outline",onClick:x,children:[s.jsx(Nd,{className:"h-4 w-4 mr-2"}),"Editar"]}),s.jsxs(oe,{variant:"outline",onClick:v,children:[s.jsx(f4,{className:"h-4 w-4 mr-2"}),"Relatrio"]}),r.pdf_url&&s.jsxs(oe,{variant:"outline",onClick:b,children:[s.jsx(Ua,{className:"h-4 w-4 mr-2"}),"PDF"]})]})]}),s.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(Qa,{className:"h-5 w-5"}),"Informaes Bsicas"]})}),s.jsxs(De,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(ke,{className:"text-sm text-muted-foreground",children:"Ttulo"}),s.jsx("p",{className:"text-base font-medium",children:r.titulo})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(ke,{className:"text-sm text-muted-foreground",children:"Tipo"}),s.jsx("p",{className:"text-base",children:ale[r.tipo]})]}),s.jsxs("div",{children:[s.jsx(ke,{className:"text-sm text-muted-foreground",children:"Verso"}),s.jsxs(Je,{variant:"outline",className:"text-sm",children:["v",r.versao]})]})]}),r.resumo&&s.jsxs("div",{children:[s.jsx(ke,{className:"text-sm text-muted-foreground",children:"Resumo"}),s.jsx("p",{className:"text-sm",children:r.resumo})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[r.obrigatorio?s.jsx(_n,{className:"h-4 w-4 text-green-600"}):s.jsx(Va,{className:"h-4 w-4 text-gray-400"}),s.jsx("span",{className:"text-sm",children:r.obrigatorio?"Obrigatrio":"Opcional"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[r.ativo?s.jsx(_n,{className:"h-4 w-4 text-green-600"}):s.jsx(Va,{className:"h-4 w-4 text-gray-400"}),s.jsx("span",{className:"text-sm",children:r.ativo?"Ativo":"Inativo"})]})]})]})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(oa,{className:"h-5 w-5"}),"Aplicabilidade"]}),s.jsx(Tt,{children:"Tipos de usurios que devem aceitar este termo"})]}),s.jsx(De,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{className:"text-sm text-muted-foreground",children:"Perfis Selecionados"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:r.roles_aplicaveis&&r.roles_aplicaveis.length>0?r.roles_aplicaveis.map(N=>s.jsx(Je,{variant:"secondary",className:"text-sm",children:nle[N]},N)):s.jsx("p",{className:"text-sm text-muted-foreground",children:"Aplicvel para todos os usurios"})})]})})]}),s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(Fa,{className:"h-5 w-5"}),"Datas"]})}),s.jsxs(De,{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx(ke,{className:"text-sm text-muted-foreground",children:"Criado em"}),s.jsx("p",{className:"text-sm",children:h(r.criado_em)})]}),s.jsxs("div",{children:[s.jsx(ke,{className:"text-sm text-muted-foreground",children:"ltima atualizao"}),s.jsx("p",{className:"text-sm",children:h(r.atualizado_em)})]})]})]}),s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(vi,{className:"h-5 w-5"}),"Documento"]})}),s.jsxs(De,{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx(ke,{className:"text-sm text-muted-foreground",children:"Caminho do PDF"}),s.jsx("p",{className:"text-sm font-mono break-all",children:r.pdf_path})]}),r.pdf_url&&s.jsxs(oe,{variant:"outline",className:"w-full",onClick:b,children:[s.jsx(Ua,{className:"h-4 w-4 mr-2"}),"Baixar PDF"]})]})]})]}),r.conteudo_html&&s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Contedo HTML"}),s.jsx(Tt,{children:"Verso HTML do termo (opcional)"})]}),s.jsx(De,{children:s.jsx("div",{className:"prose max-w-none",dangerouslySetInnerHTML:{__html:r.conteudo_html}})})]})]})}function ole(){const e=ds(),{id:t}=To(),{stats:r,aceites:a,loading:n,error:i,refetch:o}=ele(t||null),c=()=>{if(a.length===0){console.warn("Nenhum dado para exportar");return}const h=["Nome","Email","Verso","Data do Aceite","IP"],p=a.map(N=>{var _,C;return[((_=N.profiles)==null?void 0:_.nome)||"Nome no disponvel",((C=N.profiles)==null?void 0:C.email)||"N/A",N.versao_aceita,d(N.aceito_em),N.ip_aceite||"N/A"]}),x=[h.join(","),...p.map(N=>N.map(_=>`"${_}"`).join(","))].join(`
`),v=new Blob([x],{type:"text/csv;charset=utf-8;"}),b=document.createElement("a");b.href=URL.createObjectURL(v),b.download=`relatorio-aceites-termo-${t}-${new Date().toISOString().split("T")[0]}.csv`,b.click(),console.log(" CSV exportado")},d=h=>new Date(h).toLocaleString("pt-BR");return n?s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx(_s,{className:"h-8 w-8 animate-spin"})}):s.jsxs("div",{className:"container mx-auto py-8 px-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-8",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>e("/admin/termos"),children:s.jsx(As,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Relatrio de Aceites"}),s.jsx("p",{className:"text-muted-foreground mt-1",children:"Estatsticas e histrico de aceites do termo"})]})]}),s.jsxs(oe,{onClick:c,children:[s.jsx(Ua,{className:"h-4 w-4 mr-2"}),"Exportar CSV"]})]}),r&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[s.jsxs(Ne,{children:[s.jsx(Ye,{className:"pb-3",children:s.jsxs(Qe,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[s.jsx(oa,{className:"h-4 w-4"}),"Total de Aceites"]})}),s.jsx(De,{children:s.jsx("div",{className:"text-3xl font-bold",children:r.total_aceites})})]}),s.jsxs(Ne,{children:[s.jsx(Ye,{className:"pb-3",children:s.jsxs(Qe,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[s.jsx(Tr,{className:"h-4 w-4"}),"Total de Usurios"]})}),s.jsx(De,{children:s.jsx("div",{className:"text-3xl font-bold",children:r.total_usuarios})})]}),s.jsxs(Ne,{children:[s.jsx(Ye,{className:"pb-3",children:s.jsxs(Qe,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[s.jsx(Ir,{className:"h-4 w-4"}),"Taxa de Aceite"]})}),s.jsx(De,{children:s.jsx("div",{className:"text-3xl font-bold",children:r.percentual_aceites?`${r.percentual_aceites.toFixed(1)}%`:"0%"})})]})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Histrico de Aceites"}),s.jsx(Tt,{children:"Lista de todos os usurios que aceitaram este termo"})]}),s.jsx(De,{children:a.length===0?s.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"Nenhum aceite registrado ainda"}):s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{children:"Usurio"}),s.jsx(rt,{children:"Verso"}),s.jsx(rt,{children:"Data do Aceite"}),s.jsx(rt,{children:"IP"})]})}),s.jsx(da,{children:a.map(h=>{var p,x;return s.jsxs(Cs,{children:[s.jsx(Ze,{children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"font-medium",children:((p=h.profiles)==null?void 0:p.nome)||"Nome no disponvel"}),s.jsx("span",{className:"text-sm text-muted-foreground",children:((x=h.profiles)==null?void 0:x.email)||h.user_id})]})}),s.jsx(Ze,{children:s.jsx(Je,{variant:"outline",children:h.versao_aceita})}),s.jsx(Ze,{children:d(h.aceito_em)}),s.jsx(Ze,{className:"text-muted-foreground",children:h.ip_aceite||"N/A"})]},h.id)})})]})})]})]})}function lle(e){const{user:t}=sr(),[r,a]=E.useState(!1),[n,i]=E.useState(null),[o,c]=E.useState(!1),d=E.useCallback(async x=>{var v,b,N,_;if(!(t!=null&&t.id)){const C="Usurio no autenticado";return i(C),(v=e==null?void 0:e.onErro)==null||v.call(e,C),!1}if(!x||x.length===0){const C="Nenhum termo selecionado";return i(C),(b=e==null?void 0:e.onErro)==null||b.call(e,C),!1}try{return a(!0),i(null),c(!1),await gT(t.id,x),c(!0),(N=e==null?void 0:e.onSucesso)==null||N.call(e),console.log(` ${x.length} termo(s) aceito(s) com sucesso`),!0}catch(C){const T=C instanceof Error?C.message:"Erro ao registrar aceites";return i(T),c(!1),(_=e==null?void 0:e.onErro)==null||_.call(e,T),console.error("Erro ao registrar aceites:",C),!1}finally{a(!1)}},[t==null?void 0:t.id,e]),h=E.useCallback(async x=>{var v,b,N,_;if(!(t!=null&&t.id)){const C="Usurio no autenticado";return i(C),(v=e==null?void 0:e.onErro)==null||v.call(e,C),!1}if(!x){const C="ID do termo no fornecido";return i(C),(b=e==null?void 0:e.onErro)==null||b.call(e,C),!1}try{return a(!0),i(null),c(!1),await M7(t.id,x),c(!0),(N=e==null?void 0:e.onSucesso)==null||N.call(e),console.log(` Termo aceito com sucesso: ${x}`),!0}catch(C){const T=C instanceof Error?C.message:"Erro ao registrar aceite";return i(T),c(!1),(_=e==null?void 0:e.onErro)==null||_.call(e,T),console.error("Erro ao registrar aceite:",C),!1}finally{a(!1)}},[t==null?void 0:t.id,e]),p=E.useCallback(()=>{a(!1),i(null),c(!1)},[]);return{registrar:d,registrarUnico:h,loading:r,error:n,sucesso:o,resetar:p}}var i1="Checkbox",[cle,Yue]=bi(i1),[dle,a2]=cle(i1);function ule(e){const{__scopeCheckbox:t,checked:r,children:a,defaultChecked:n,disabled:i,form:o,name:c,onCheckedChange:d,required:h,value:p="on",internal_do_not_use_render:x}=e,[v,b]=No({prop:r,defaultProp:n??!1,onChange:d,caller:i1}),[N,_]=E.useState(null),[C,T]=E.useState(null),A=E.useRef(!1),k=N?!!o||!!N.closest("form"):!0,I={checked:v,disabled:i,setChecked:b,control:N,setControl:_,name:c,form:o,value:p,hasConsumerStoppedPropagationRef:A,required:h,defaultChecked:jd(n)?!1:n,isFormControl:k,bubbleInput:C,setBubbleInput:T};return s.jsx(dle,{scope:t,...I,children:hle(x)?x(I):a})}var Y5="CheckboxTrigger",Z5=E.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:r,...a},n)=>{const{control:i,value:o,disabled:c,checked:d,required:h,setControl:p,setChecked:x,hasConsumerStoppedPropagationRef:v,isFormControl:b,bubbleInput:N}=a2(Y5,e),_=br(n,p),C=E.useRef(d);return E.useEffect(()=>{const T=i==null?void 0:i.form;if(T){const A=()=>x(C.current);return T.addEventListener("reset",A),()=>T.removeEventListener("reset",A)}},[i,x]),s.jsx(ys.button,{type:"button",role:"checkbox","aria-checked":jd(d)?"mixed":d,"aria-required":h,"data-state":sO(d),"data-disabled":c?"":void 0,disabled:c,value:o,...a,ref:_,onKeyDown:Ts(t,T=>{T.key==="Enter"&&T.preventDefault()}),onClick:Ts(r,T=>{x(A=>jd(A)?!0:!A),N&&b&&(v.current=T.isPropagationStopped(),v.current||T.stopPropagation())})})});Z5.displayName=Y5;var n2=E.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:a,checked:n,defaultChecked:i,required:o,disabled:c,value:d,onCheckedChange:h,form:p,...x}=e;return s.jsx(ule,{__scopeCheckbox:r,checked:n,defaultChecked:i,disabled:c,required:o,onCheckedChange:h,name:a,form:p,value:d,internal_do_not_use_render:({isFormControl:v})=>s.jsxs(s.Fragment,{children:[s.jsx(Z5,{...x,ref:t,__scopeCheckbox:r}),v&&s.jsx(tO,{__scopeCheckbox:r})]})})});n2.displayName=i1;var Q5="CheckboxIndicator",J5=E.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:a,...n}=e,i=a2(Q5,r);return s.jsx(il,{present:a||jd(i.checked)||i.checked===!0,children:s.jsx(ys.span,{"data-state":sO(i.checked),"data-disabled":i.disabled?"":void 0,...n,ref:t,style:{pointerEvents:"none",...e.style}})})});J5.displayName=Q5;var eO="CheckboxBubbleInput",tO=E.forwardRef(({__scopeCheckbox:e,...t},r)=>{const{control:a,hasConsumerStoppedPropagationRef:n,checked:i,defaultChecked:o,required:c,disabled:d,name:h,value:p,form:x,bubbleInput:v,setBubbleInput:b}=a2(eO,e),N=br(r,b),_=Gp(i),C=_g(a);E.useEffect(()=>{const A=v;if(!A)return;const k=window.HTMLInputElement.prototype,B=Object.getOwnPropertyDescriptor(k,"checked").set,O=!n.current;if(_!==i&&B){const D=new Event("click",{bubbles:O});A.indeterminate=jd(i),B.call(A,jd(i)?!1:i),A.dispatchEvent(D)}},[v,_,i,n]);const T=E.useRef(jd(i)?!1:i);return s.jsx(ys.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??T.current,required:c,disabled:d,name:h,value:p,form:x,...t,tabIndex:-1,ref:N,style:{...t.style,...C,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});tO.displayName=eO;function hle(e){return typeof e=="function"}function jd(e){return e==="indeterminate"}function sO(e){return jd(e)?"indeterminate":e?"checked":"unchecked"}const Ef=E.forwardRef(({className:e,...t},r)=>s.jsx(n2,{ref:r,className:pt("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:s.jsx(J5,{className:pt("flex items-center justify-center text-current"),children:s.jsx(Ea,{className:"h-4 w-4"})})}));Ef.displayName=n2.displayName;function fle(e,t){return E.useReducer((r,a)=>t[r][a]??r,e)}var i2="ScrollArea",[rO,Zue]=bi(i2),[mle,Ro]=rO(i2),aO=E.forwardRef((e,t)=>{const{__scopeScrollArea:r,type:a="hover",dir:n,scrollHideDelay:i=600,...o}=e,[c,d]=E.useState(null),[h,p]=E.useState(null),[x,v]=E.useState(null),[b,N]=E.useState(null),[_,C]=E.useState(null),[T,A]=E.useState(0),[k,I]=E.useState(0),[B,O]=E.useState(!1),[D,F]=E.useState(!1),M=br(t,q=>d(q)),z=Af(n);return s.jsx(mle,{scope:r,type:a,dir:z,scrollHideDelay:i,scrollArea:c,viewport:h,onViewportChange:p,content:x,onContentChange:v,scrollbarX:b,onScrollbarXChange:N,scrollbarXEnabled:B,onScrollbarXEnabledChange:O,scrollbarY:_,onScrollbarYChange:C,scrollbarYEnabled:D,onScrollbarYEnabledChange:F,onCornerWidthChange:A,onCornerHeightChange:I,children:s.jsx(ys.div,{dir:z,...o,ref:M,style:{position:"relative","--radix-scroll-area-corner-width":T+"px","--radix-scroll-area-corner-height":k+"px",...e.style}})})});aO.displayName=i2;var nO="ScrollAreaViewport",iO=E.forwardRef((e,t)=>{const{__scopeScrollArea:r,children:a,nonce:n,...i}=e,o=Ro(nO,r),c=E.useRef(null),d=br(t,c,o.onViewportChange);return s.jsxs(s.Fragment,{children:[s.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),s.jsx(ys.div,{"data-radix-scroll-area-viewport":"",...i,ref:d,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...e.style},children:s.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:a})})]})});iO.displayName=nO;var Hl="ScrollAreaScrollbar",o2=E.forwardRef((e,t)=>{const{forceMount:r,...a}=e,n=Ro(Hl,e.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=n,c=e.orientation==="horizontal";return E.useEffect(()=>(c?i(!0):o(!0),()=>{c?i(!1):o(!1)}),[c,i,o]),n.type==="hover"?s.jsx(ple,{...a,ref:t,forceMount:r}):n.type==="scroll"?s.jsx(xle,{...a,ref:t,forceMount:r}):n.type==="auto"?s.jsx(oO,{...a,ref:t,forceMount:r}):n.type==="always"?s.jsx(l2,{...a,ref:t}):null});o2.displayName=Hl;var ple=E.forwardRef((e,t)=>{const{forceMount:r,...a}=e,n=Ro(Hl,e.__scopeScrollArea),[i,o]=E.useState(!1);return E.useEffect(()=>{const c=n.scrollArea;let d=0;if(c){const h=()=>{window.clearTimeout(d),o(!0)},p=()=>{d=window.setTimeout(()=>o(!1),n.scrollHideDelay)};return c.addEventListener("pointerenter",h),c.addEventListener("pointerleave",p),()=>{window.clearTimeout(d),c.removeEventListener("pointerenter",h),c.removeEventListener("pointerleave",p)}}},[n.scrollArea,n.scrollHideDelay]),s.jsx(il,{present:r||i,children:s.jsx(oO,{"data-state":i?"visible":"hidden",...a,ref:t})})}),xle=E.forwardRef((e,t)=>{const{forceMount:r,...a}=e,n=Ro(Hl,e.__scopeScrollArea),i=e.orientation==="horizontal",o=l1(()=>d("SCROLL_END"),100),[c,d]=fle("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return E.useEffect(()=>{if(c==="idle"){const h=window.setTimeout(()=>d("HIDE"),n.scrollHideDelay);return()=>window.clearTimeout(h)}},[c,n.scrollHideDelay,d]),E.useEffect(()=>{const h=n.viewport,p=i?"scrollLeft":"scrollTop";if(h){let x=h[p];const v=()=>{const b=h[p];x!==b&&(d("SCROLL"),o()),x=b};return h.addEventListener("scroll",v),()=>h.removeEventListener("scroll",v)}},[n.viewport,i,d,o]),s.jsx(il,{present:r||c!=="hidden",children:s.jsx(l2,{"data-state":c==="hidden"?"hidden":"visible",...a,ref:t,onPointerEnter:Ts(e.onPointerEnter,()=>d("POINTER_ENTER")),onPointerLeave:Ts(e.onPointerLeave,()=>d("POINTER_LEAVE"))})})}),oO=E.forwardRef((e,t)=>{const r=Ro(Hl,e.__scopeScrollArea),{forceMount:a,...n}=e,[i,o]=E.useState(!1),c=e.orientation==="horizontal",d=l1(()=>{if(r.viewport){const h=r.viewport.offsetWidth<r.viewport.scrollWidth,p=r.viewport.offsetHeight<r.viewport.scrollHeight;o(c?h:p)}},10);return Sf(r.viewport,d),Sf(r.content,d),s.jsx(il,{present:a||i,children:s.jsx(l2,{"data-state":i?"visible":"hidden",...n,ref:t})})}),l2=E.forwardRef((e,t)=>{const{orientation:r="vertical",...a}=e,n=Ro(Hl,e.__scopeScrollArea),i=E.useRef(null),o=E.useRef(0),[c,d]=E.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),h=hO(c.viewport,c.content),p={...a,sizes:c,onSizesChange:d,hasThumb:h>0&&h<1,onThumbChange:v=>i.current=v,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:v=>o.current=v};function x(v,b){return _le(v,o.current,c,b)}return r==="horizontal"?s.jsx(gle,{...p,ref:t,onThumbPositionChange:()=>{if(n.viewport&&i.current){const v=n.viewport.scrollLeft,b=cS(v,c,n.dir);i.current.style.transform=`translate3d(${b}px, 0, 0)`}},onWheelScroll:v=>{n.viewport&&(n.viewport.scrollLeft=v)},onDragScroll:v=>{n.viewport&&(n.viewport.scrollLeft=x(v,n.dir))}}):r==="vertical"?s.jsx(vle,{...p,ref:t,onThumbPositionChange:()=>{if(n.viewport&&i.current){const v=n.viewport.scrollTop,b=cS(v,c);i.current.style.transform=`translate3d(0, ${b}px, 0)`}},onWheelScroll:v=>{n.viewport&&(n.viewport.scrollTop=v)},onDragScroll:v=>{n.viewport&&(n.viewport.scrollTop=x(v))}}):null}),gle=E.forwardRef((e,t)=>{const{sizes:r,onSizesChange:a,...n}=e,i=Ro(Hl,e.__scopeScrollArea),[o,c]=E.useState(),d=E.useRef(null),h=br(t,d,i.onScrollbarXChange);return E.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),s.jsx(cO,{"data-orientation":"horizontal",...n,ref:h,sizes:r,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":o1(r)+"px",...e.style},onThumbPointerDown:p=>e.onThumbPointerDown(p.x),onDragScroll:p=>e.onDragScroll(p.x),onWheelScroll:(p,x)=>{if(i.viewport){const v=i.viewport.scrollLeft+p.deltaX;e.onWheelScroll(v),mO(v,x)&&p.preventDefault()}},onResize:()=>{d.current&&i.viewport&&o&&a({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:xg(o.paddingLeft),paddingEnd:xg(o.paddingRight)}})}})}),vle=E.forwardRef((e,t)=>{const{sizes:r,onSizesChange:a,...n}=e,i=Ro(Hl,e.__scopeScrollArea),[o,c]=E.useState(),d=E.useRef(null),h=br(t,d,i.onScrollbarYChange);return E.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),s.jsx(cO,{"data-orientation":"vertical",...n,ref:h,sizes:r,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":o1(r)+"px",...e.style},onThumbPointerDown:p=>e.onThumbPointerDown(p.y),onDragScroll:p=>e.onDragScroll(p.y),onWheelScroll:(p,x)=>{if(i.viewport){const v=i.viewport.scrollTop+p.deltaY;e.onWheelScroll(v),mO(v,x)&&p.preventDefault()}},onResize:()=>{d.current&&i.viewport&&o&&a({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:xg(o.paddingTop),paddingEnd:xg(o.paddingBottom)}})}})}),[yle,lO]=rO(Hl),cO=E.forwardRef((e,t)=>{const{__scopeScrollArea:r,sizes:a,hasThumb:n,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:c,onThumbPositionChange:d,onDragScroll:h,onWheelScroll:p,onResize:x,...v}=e,b=Ro(Hl,r),[N,_]=E.useState(null),C=br(t,M=>_(M)),T=E.useRef(null),A=E.useRef(""),k=b.viewport,I=a.content-a.viewport,B=dc(p),O=dc(d),D=l1(x,10);function F(M){if(T.current){const z=M.clientX-T.current.left,q=M.clientY-T.current.top;h({x:z,y:q})}}return E.useEffect(()=>{const M=z=>{const q=z.target;(N==null?void 0:N.contains(q))&&B(z,I)};return document.addEventListener("wheel",M,{passive:!1}),()=>document.removeEventListener("wheel",M,{passive:!1})},[k,N,I,B]),E.useEffect(O,[a,O]),Sf(N,D),Sf(b.content,D),s.jsx(yle,{scope:r,scrollbar:N,hasThumb:n,onThumbChange:dc(i),onThumbPointerUp:dc(o),onThumbPositionChange:O,onThumbPointerDown:dc(c),children:s.jsx(ys.div,{...v,ref:C,style:{position:"absolute",...v.style},onPointerDown:Ts(e.onPointerDown,M=>{M.button===0&&(M.target.setPointerCapture(M.pointerId),T.current=N.getBoundingClientRect(),A.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",b.viewport&&(b.viewport.style.scrollBehavior="auto"),F(M))}),onPointerMove:Ts(e.onPointerMove,F),onPointerUp:Ts(e.onPointerUp,M=>{const z=M.target;z.hasPointerCapture(M.pointerId)&&z.releasePointerCapture(M.pointerId),document.body.style.webkitUserSelect=A.current,b.viewport&&(b.viewport.style.scrollBehavior=""),T.current=null})})})}),pg="ScrollAreaThumb",dO=E.forwardRef((e,t)=>{const{forceMount:r,...a}=e,n=lO(pg,e.__scopeScrollArea);return s.jsx(il,{present:r||n.hasThumb,children:s.jsx(wle,{ref:t,...a})})}),wle=E.forwardRef((e,t)=>{const{__scopeScrollArea:r,style:a,...n}=e,i=Ro(pg,r),o=lO(pg,r),{onThumbPositionChange:c}=o,d=br(t,x=>o.onThumbChange(x)),h=E.useRef(void 0),p=l1(()=>{h.current&&(h.current(),h.current=void 0)},100);return E.useEffect(()=>{const x=i.viewport;if(x){const v=()=>{if(p(),!h.current){const b=jle(x,c);h.current=b,c()}};return c(),x.addEventListener("scroll",v),()=>x.removeEventListener("scroll",v)}},[i.viewport,p,c]),s.jsx(ys.div,{"data-state":o.hasThumb?"visible":"hidden",...n,ref:d,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...a},onPointerDownCapture:Ts(e.onPointerDownCapture,x=>{const b=x.target.getBoundingClientRect(),N=x.clientX-b.left,_=x.clientY-b.top;o.onThumbPointerDown({x:N,y:_})}),onPointerUp:Ts(e.onPointerUp,o.onThumbPointerUp)})});dO.displayName=pg;var c2="ScrollAreaCorner",uO=E.forwardRef((e,t)=>{const r=Ro(c2,e.__scopeScrollArea),a=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&a?s.jsx(ble,{...e,ref:t}):null});uO.displayName=c2;var ble=E.forwardRef((e,t)=>{const{__scopeScrollArea:r,...a}=e,n=Ro(c2,r),[i,o]=E.useState(0),[c,d]=E.useState(0),h=!!(i&&c);return Sf(n.scrollbarX,()=>{var x;const p=((x=n.scrollbarX)==null?void 0:x.offsetHeight)||0;n.onCornerHeightChange(p),d(p)}),Sf(n.scrollbarY,()=>{var x;const p=((x=n.scrollbarY)==null?void 0:x.offsetWidth)||0;n.onCornerWidthChange(p),o(p)}),h?s.jsx(ys.div,{...a,ref:t,style:{width:i,height:c,position:"absolute",right:n.dir==="ltr"?0:void 0,left:n.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function xg(e){return e?parseInt(e,10):0}function hO(e,t){const r=e/t;return isNaN(r)?0:r}function o1(e){const t=hO(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,a=(e.scrollbar.size-r)*t;return Math.max(a,18)}function _le(e,t,r,a="ltr"){const n=o1(r),i=n/2,o=t||i,c=n-o,d=r.scrollbar.paddingStart+o,h=r.scrollbar.size-r.scrollbar.paddingEnd-c,p=r.content-r.viewport,x=a==="ltr"?[0,p]:[p*-1,0];return fO([d,h],x)(e)}function cS(e,t,r="ltr"){const a=o1(t),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-n,o=t.content-t.viewport,c=i-a,d=r==="ltr"?[0,o]:[o*-1,0],h=hp(e,d);return fO([0,o],[0,c])(h)}function fO(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const a=(t[1]-t[0])/(e[1]-e[0]);return t[0]+a*(r-e[0])}}function mO(e,t){return e>0&&e<t}var jle=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},a=0;return function n(){const i={left:e.scrollLeft,top:e.scrollTop},o=r.left!==i.left,c=r.top!==i.top;(o||c)&&t(),r=i,a=window.requestAnimationFrame(n)}(),()=>window.cancelAnimationFrame(a)};function l1(e,t){const r=dc(e),a=E.useRef(0);return E.useEffect(()=>()=>window.clearTimeout(a.current),[]),E.useCallback(()=>{window.clearTimeout(a.current),a.current=window.setTimeout(r,t)},[r,t])}function Sf(e,t){const r=dc(t);Ji(()=>{let a=0;if(e){const n=new ResizeObserver(()=>{cancelAnimationFrame(a),a=window.requestAnimationFrame(r)});return n.observe(e),()=>{window.cancelAnimationFrame(a),n.unobserve(e)}}},[e,r])}var pO=aO,Nle=iO,Cle=uO;const d2=E.forwardRef(({className:e,children:t,...r},a)=>s.jsxs(pO,{ref:a,className:pt("relative overflow-hidden",e),...r,children:[s.jsx(Nle,{className:"h-full w-full rounded-[inherit]",children:t}),s.jsx(xO,{}),s.jsx(Cle,{})]}));d2.displayName=pO.displayName;const xO=E.forwardRef(({className:e,orientation:t="vertical",...r},a)=>s.jsx(o2,{ref:a,orientation:t,className:pt("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...r,children:s.jsx(dO,{className:"relative flex-1 rounded-full bg-border"})}));xO.displayName=o2.displayName;Q8.workerSrc="/Ciclik_validacoes/pdf.worker.min.mjs";function Ele({pdfUrl:e,titulo:t,onDownload:r}){const[a,n]=E.useState(null),[i,o]=E.useState(1),[c,d]=E.useState(!0),[h,p]=E.useState(null);function x({numPages:C}){n(C),d(!1),p(null)}function v(C){console.error("Erro ao carregar PDF:",C),p("No foi possvel carregar o PDF. Tente novamente mais tarde."),d(!1)}const b=()=>{a&&i<a&&o(C=>C+1)},N=()=>{i>1&&o(C=>C-1)},_=()=>{if(r)r();else{const C=document.createElement("a");C.href=e,C.download=`${t.replace(/\s+/g,"_")}.pdf`,C.click()}};return s.jsxs("div",{className:"w-full max-h-[600px] flex flex-col overflow-hidden border rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between gap-4 p-4 border-b bg-muted/50 flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(oe,{variant:"outline",size:"sm",onClick:N,disabled:i<=1||c,children:s.jsx(m4,{className:"h-4 w-4"})}),s.jsx("span",{className:"text-sm text-muted-foreground min-w-[80px] text-center",children:c?"Carregando...":h?"Erro":`${i} / ${a||"?"}`}),s.jsx(oe,{variant:"outline",size:"sm",onClick:b,disabled:!a||i>=a||c,children:s.jsx(Xi,{className:"h-4 w-4"})})]}),s.jsxs(oe,{variant:"outline",size:"sm",onClick:_,disabled:c||!!h,children:[s.jsx(Ua,{className:"h-4 w-4 mr-2"}),"Baixar PDF"]})]}),s.jsx("div",{className:"flex-1 min-h-0 overflow-auto bg-muted/20 p-4",children:s.jsx("div",{className:"flex flex-col items-center",children:h?s.jsxs(Er,{variant:"destructive",className:"max-w-md",children:[s.jsx(Kr,{className:"h-4 w-4"}),s.jsx(Sr,{children:h})]}):s.jsx(J8,{file:e,onLoadSuccess:x,onLoadError:v,loading:s.jsxs("div",{className:"flex flex-col items-center gap-4",children:[s.jsx(_s,{className:"h-8 w-8 animate-spin text-primary"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Carregando PDF..."})]}),error:s.jsxs(Er,{variant:"destructive",className:"max-w-md",children:[s.jsx(Kr,{className:"h-4 w-4"}),s.jsx(Sr,{children:"Erro ao carregar o PDF. Verifique sua conexo."})]}),children:s.jsx(e6,{pageNumber:i,renderTextLayer:!1,renderAnnotationLayer:!1,className:"shadow-lg",width:Math.min(window.innerWidth*.8,800)})})})}),s.jsx("div",{className:"p-2 border-t bg-muted/50 text-xs text-muted-foreground text-center flex-shrink-0",children:t})]})}function Sle({termo:e,className:t=""}){const r=()=>{window.open(e.pdf_url,"_blank","noopener,noreferrer")};return e.conteudo_html?s.jsx("div",{className:`p-6 ${t}`,children:s.jsx("div",{className:"prose prose-sm max-w-none dark:prose-invert",dangerouslySetInnerHTML:{__html:e.conteudo_html}})}):s.jsx("div",{className:`p-6 ${t}`,children:s.jsxs(Er,{children:[s.jsx(Qa,{className:"h-4 w-4"}),s.jsxs(Sr,{className:"mt-2",children:[s.jsx("p",{className:"mb-4",children:"O contedo completo deste termo est disponvel no documento PDF."}),e.resumo&&s.jsxs("div",{className:"mb-4 p-3 bg-muted rounded-md",children:[s.jsx("p",{className:"font-medium text-sm mb-2",children:"Resumo:"}),s.jsx("p",{className:"text-sm",children:e.resumo})]}),s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsxs(oe,{variant:"outline",onClick:r,className:"w-full",children:[s.jsx(Nx,{className:"h-4 w-4 mr-2"}),"Abrir PDF em Nova Aba"]}),s.jsx("p",{className:"text-xs text-muted-foreground text-center",children:'Voc pode visualizar o PDF clicando no boto "Ver PDF" acima'})]})]})]})})}function Tle({termos:e,onAceitar:t,onLogout:r,loading:a=!1,error:n=null}){const[i,o]=E.useState({}),[c,d]=E.useState(0),[h,p]=E.useState(!1);if(e.length===0)return null;const x=e[c],v=e.length,N=e.filter(I=>I.obrigatorio).every(I=>i[I.id]===!0),_=i[x.id]===!0,C=(I,B)=>{o(O=>({...O,[I]:B}))},T=()=>{c<v-1&&(d(I=>I+1),p(!1))},A=()=>{c>0&&(d(I=>I-1),p(!1))},k=async()=>{const I=Object.entries(i).filter(([B,O])=>O).map(([B])=>B);await t(I)};return s.jsx(ar,{open:!0,modal:!0,children:s.jsxs(tr,{className:"max-w-5xl max-h-[90vh] flex flex-col overflow-hidden",onPointerDownOutside:I=>I.preventDefault(),onEscapeKeyDown:I=>I.preventDefault(),children:[s.jsxs(nr,{className:"flex-shrink-0",children:[s.jsxs(ir,{className:"flex items-center gap-2",children:[s.jsx(Qa,{className:"h-5 w-5"}),"Termos e Polticas - Leitura Obrigatria"]}),s.jsxs(Vr,{children:["Para continuar usando a plataforma, voc deve ler e aceitar os termos abaixo.",v>1&&` (${c+1} de ${v})`]})]}),s.jsx(d2,{className:"flex-1 overflow-y-auto pr-6",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"p-4 bg-muted rounded-lg",children:s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-lg",children:x.titulo}),s.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[x.tipoLabel,"  Verso ",x.versao,x.obrigatorio&&s.jsx("span",{className:"ml-2 text-destructive font-medium",children:"* Obrigatrio"})]}),x.resumo&&s.jsx("p",{className:"text-sm mt-2 text-foreground/80",children:x.resumo})]}),x.pdf_url&&s.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>p(!h),children:[h?"Ocultar":"Ver"," PDF"]})]})}),s.jsx("div",{children:h&&x.pdf_url?s.jsx(Ele,{pdfUrl:x.pdf_url,titulo:x.titulo}):s.jsx("div",{className:"border rounded-lg",children:s.jsx(Sle,{termo:x})})}),s.jsx("div",{className:"p-4 border rounded-lg bg-card",children:s.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[s.jsx(Ef,{checked:_,onCheckedChange:I=>C(x.id,I===!0),disabled:a,className:"mt-1"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-medium",children:x.obrigatorio?s.jsxs(s.Fragment,{children:["Li e aceito ",x.tipoLabel]}):s.jsxs(s.Fragment,{children:["Li e aceito ",x.tipoLabel," (opcional)"]})}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:x.obrigatorio?" necessrio aceitar este termo para continuar":"Este termo  opcional, mas recomendado"})]})]})})]})}),n&&s.jsxs(Er,{variant:"destructive",className:"flex-shrink-0",children:[s.jsx(un,{className:"h-4 w-4"}),s.jsx(Sr,{children:n})]}),v>1&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground flex-shrink-0",children:[s.jsx("div",{className:"flex-1 bg-muted rounded-full h-2",children:s.jsx("div",{className:"bg-primary rounded-full h-2 transition-all",style:{width:`${(c+1)/v*100}%`}})}),s.jsxs("span",{className:"whitespace-nowrap",children:[c+1," de ",v]})]}),s.jsxs(Ya,{className:"flex-col sm:flex-row gap-2 flex-shrink-0",children:[s.jsxs(oe,{variant:"ghost",onClick:r,disabled:a,className:"sm:mr-auto",children:[s.jsx(gc,{className:"h-4 w-4 mr-2"}),"Sair"]}),v>1&&s.jsxs("div",{className:"flex gap-2",children:[s.jsx(oe,{variant:"outline",onClick:A,disabled:c===0||a,children:"Anterior"}),s.jsx(oe,{variant:"outline",onClick:T,disabled:c===v-1||a,children:"Prximo"})]}),s.jsx(oe,{onClick:k,disabled:!N||a,className:"min-w-[150px]",children:a?s.jsxs(s.Fragment,{children:[s.jsx(_s,{className:"h-4 w-4 mr-2 animate-spin"}),"Processando..."]}):s.jsx(s.Fragment,{children:"Aceitar e Continuar"})})]}),!N&&s.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:[s.jsx(un,{className:"h-4 w-4 inline mr-1"}),"Voc deve aceitar todos os termos obrigatrios para continuar"]})]})})}function Ale(){const e=ds(),{signOut:t}=sr(),{termosPendentes:r,loading:a,todosAceitos:n}=B7(),{registrar:i,loading:o,error:c}=lle({onSucesso:()=>{e("/",{replace:!0})}}),d=async p=>{p.length!==0&&await i(p)},h=async()=>{try{await t(),e("/auth",{replace:!0})}catch(p){console.error("Erro ao fazer logout:",p)}};return a?s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx(_s,{className:"h-8 w-8 animate-spin mx-auto text-primary"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Carregando termos de uso..."})]})}):n||r.length===0?(e("/",{replace:!0}),null):s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 bg-background border-b",children:s.jsxs("div",{className:"container mx-auto px-4 h-16 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"h-8 w-8 rounded-lg bg-primary flex items-center justify-center text-primary-foreground font-bold",children:"C"}),s.jsx("span",{className:"font-semibold text-lg",children:"Ciclik"})]}),s.jsxs(oe,{variant:"ghost",size:"sm",onClick:h,disabled:o,children:[s.jsx(gc,{className:"h-4 w-4 mr-2"}),"Sair"]})]})}),s.jsx("div",{className:"pt-16",children:s.jsx(Tle,{termos:r,onAceitar:d,onLogout:h,loading:o,error:c})})]})}var gO=["PageUp","PageDown"],vO=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],yO={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},Xf="Slider",[uw,kle,Rle]=Rw(Xf),[wO,Que]=bi(Xf,[Rle]),[Ple,c1]=wO(Xf),bO=E.forwardRef((e,t)=>{const{name:r,min:a=0,max:n=100,step:i=1,orientation:o="horizontal",disabled:c=!1,minStepsBetweenThumbs:d=0,defaultValue:h=[a],value:p,onValueChange:x=()=>{},onValueCommit:v=()=>{},inverted:b=!1,form:N,..._}=e,C=E.useRef(new Set),T=E.useRef(0),k=o==="horizontal"?Ile:Ole,[I=[],B]=No({prop:p,defaultProp:h,onChange:q=>{var ae;(ae=[...C.current][T.current])==null||ae.focus(),x(q)}}),O=E.useRef(I);function D(q){const Y=Ble(I,q);z(q,Y)}function F(q){z(q,T.current)}function M(){const q=O.current[T.current];I[T.current]!==q&&v(I)}function z(q,Y,{commit:ae}={commit:!1}){const je=$le(i),H=qle(Math.round((q-a)/i)*i+a,je),Z=hp(H,[a,n]);B((G=[])=>{const Q=Lle(G,Z,Y);if(zle(Q,d*i)){T.current=Q.indexOf(Z);const re=String(Q)!==String(G);return re&&ae&&v(Q),re?Q:G}else return G})}return s.jsx(Ple,{scope:e.__scopeSlider,name:r,disabled:c,min:a,max:n,valueIndexToChangeRef:T,thumbs:C.current,values:I,orientation:o,form:N,children:s.jsx(uw.Provider,{scope:e.__scopeSlider,children:s.jsx(uw.Slot,{scope:e.__scopeSlider,children:s.jsx(k,{"aria-disabled":c,"data-disabled":c?"":void 0,..._,ref:t,onPointerDown:Ts(_.onPointerDown,()=>{c||(O.current=I)}),min:a,max:n,inverted:b,onSlideStart:c?void 0:D,onSlideMove:c?void 0:F,onSlideEnd:c?void 0:M,onHomeKeyDown:()=>!c&&z(a,0,{commit:!0}),onEndKeyDown:()=>!c&&z(n,I.length-1,{commit:!0}),onStepKeyDown:({event:q,direction:Y})=>{if(!c){const H=gO.includes(q.key)||q.shiftKey&&vO.includes(q.key)?10:1,Z=T.current,G=I[Z],Q=i*H*Y;z(G+Q,Z,{commit:!0})}}})})})})});bO.displayName=Xf;var[_O,jO]=wO(Xf,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Ile=E.forwardRef((e,t)=>{const{min:r,max:a,dir:n,inverted:i,onSlideStart:o,onSlideMove:c,onSlideEnd:d,onStepKeyDown:h,...p}=e,[x,v]=E.useState(null),b=br(t,k=>v(k)),N=E.useRef(void 0),_=Af(n),C=_==="ltr",T=C&&!i||!C&&i;function A(k){const I=N.current||x.getBoundingClientRect(),B=[0,I.width],D=u2(B,T?[r,a]:[a,r]);return N.current=I,D(k-I.left)}return s.jsx(_O,{scope:e.__scopeSlider,startEdge:T?"left":"right",endEdge:T?"right":"left",direction:T?1:-1,size:"width",children:s.jsx(NO,{dir:_,"data-orientation":"horizontal",...p,ref:b,style:{...p.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:k=>{const I=A(k.clientX);o==null||o(I)},onSlideMove:k=>{const I=A(k.clientX);c==null||c(I)},onSlideEnd:()=>{N.current=void 0,d==null||d()},onStepKeyDown:k=>{const B=yO[T?"from-left":"from-right"].includes(k.key);h==null||h({event:k,direction:B?-1:1})}})})}),Ole=E.forwardRef((e,t)=>{const{min:r,max:a,inverted:n,onSlideStart:i,onSlideMove:o,onSlideEnd:c,onStepKeyDown:d,...h}=e,p=E.useRef(null),x=br(t,p),v=E.useRef(void 0),b=!n;function N(_){const C=v.current||p.current.getBoundingClientRect(),T=[0,C.height],k=u2(T,b?[a,r]:[r,a]);return v.current=C,k(_-C.top)}return s.jsx(_O,{scope:e.__scopeSlider,startEdge:b?"bottom":"top",endEdge:b?"top":"bottom",size:"height",direction:b?1:-1,children:s.jsx(NO,{"data-orientation":"vertical",...h,ref:x,style:{...h.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:_=>{const C=N(_.clientY);i==null||i(C)},onSlideMove:_=>{const C=N(_.clientY);o==null||o(C)},onSlideEnd:()=>{v.current=void 0,c==null||c()},onStepKeyDown:_=>{const T=yO[b?"from-bottom":"from-top"].includes(_.key);d==null||d({event:_,direction:T?-1:1})}})})}),NO=E.forwardRef((e,t)=>{const{__scopeSlider:r,onSlideStart:a,onSlideMove:n,onSlideEnd:i,onHomeKeyDown:o,onEndKeyDown:c,onStepKeyDown:d,...h}=e,p=c1(Xf,r);return s.jsx(ys.span,{...h,ref:t,onKeyDown:Ts(e.onKeyDown,x=>{x.key==="Home"?(o(x),x.preventDefault()):x.key==="End"?(c(x),x.preventDefault()):gO.concat(vO).includes(x.key)&&(d(x),x.preventDefault())}),onPointerDown:Ts(e.onPointerDown,x=>{const v=x.target;v.setPointerCapture(x.pointerId),x.preventDefault(),p.thumbs.has(v)?v.focus():a(x)}),onPointerMove:Ts(e.onPointerMove,x=>{x.target.hasPointerCapture(x.pointerId)&&n(x)}),onPointerUp:Ts(e.onPointerUp,x=>{const v=x.target;v.hasPointerCapture(x.pointerId)&&(v.releasePointerCapture(x.pointerId),i(x))})})}),CO="SliderTrack",EO=E.forwardRef((e,t)=>{const{__scopeSlider:r,...a}=e,n=c1(CO,r);return s.jsx(ys.span,{"data-disabled":n.disabled?"":void 0,"data-orientation":n.orientation,...a,ref:t})});EO.displayName=CO;var hw="SliderRange",SO=E.forwardRef((e,t)=>{const{__scopeSlider:r,...a}=e,n=c1(hw,r),i=jO(hw,r),o=E.useRef(null),c=br(t,o),d=n.values.length,h=n.values.map(v=>kO(v,n.min,n.max)),p=d>1?Math.min(...h):0,x=100-Math.max(...h);return s.jsx(ys.span,{"data-orientation":n.orientation,"data-disabled":n.disabled?"":void 0,...a,ref:c,style:{...e.style,[i.startEdge]:p+"%",[i.endEdge]:x+"%"}})});SO.displayName=hw;var fw="SliderThumb",TO=E.forwardRef((e,t)=>{const r=kle(e.__scopeSlider),[a,n]=E.useState(null),i=br(t,c=>n(c)),o=E.useMemo(()=>a?r().findIndex(c=>c.ref.current===a):-1,[r,a]);return s.jsx(Dle,{...e,ref:i,index:o})}),Dle=E.forwardRef((e,t)=>{const{__scopeSlider:r,index:a,name:n,...i}=e,o=c1(fw,r),c=jO(fw,r),[d,h]=E.useState(null),p=br(t,A=>h(A)),x=d?o.form||!!d.closest("form"):!0,v=_g(d),b=o.values[a],N=b===void 0?0:kO(b,o.min,o.max),_=Fle(a,o.values.length),C=v==null?void 0:v[c.size],T=C?Vle(C,N,c.direction):0;return E.useEffect(()=>{if(d)return o.thumbs.add(d),()=>{o.thumbs.delete(d)}},[d,o.thumbs]),s.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[c.startEdge]:`calc(${N}% + ${T}px)`},children:[s.jsx(uw.ItemSlot,{scope:e.__scopeSlider,children:s.jsx(ys.span,{role:"slider","aria-label":e["aria-label"]||_,"aria-valuemin":o.min,"aria-valuenow":b,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0,...i,ref:p,style:b===void 0?{display:"none"}:e.style,onFocus:Ts(e.onFocus,()=>{o.valueIndexToChangeRef.current=a})})}),x&&s.jsx(AO,{name:n??(o.name?o.name+(o.values.length>1?"[]":""):void 0),form:o.form,value:b},a)]})});TO.displayName=fw;var Mle="RadioBubbleInput",AO=E.forwardRef(({__scopeSlider:e,value:t,...r},a)=>{const n=E.useRef(null),i=br(n,a),o=Gp(t);return E.useEffect(()=>{const c=n.current;if(!c)return;const d=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(d,"value").set;if(o!==t&&p){const x=new Event("input",{bubbles:!0});p.call(c,t),c.dispatchEvent(x)}},[o,t]),s.jsx(ys.input,{style:{display:"none"},...r,ref:i,defaultValue:t})});AO.displayName=Mle;function Lle(e=[],t,r){const a=[...e];return a[r]=t,a.sort((n,i)=>n-i)}function kO(e,t,r){const i=100/(r-t)*(e-t);return hp(i,[0,100])}function Fle(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function Ble(e,t){if(e.length===1)return 0;const r=e.map(n=>Math.abs(n-t)),a=Math.min(...r);return r.indexOf(a)}function Vle(e,t,r){const a=e/2,i=u2([0,50],[0,a]);return(a-i(t)*r)*r}function Ule(e){return e.slice(0,-1).map((t,r)=>e[r+1]-t)}function zle(e,t){if(t>0){const r=Ule(e);return Math.min(...r)>=t}return!0}function u2(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const a=(t[1]-t[0])/(e[1]-e[0]);return t[0]+a*(r-e[0])}}function $le(e){return(String(e).split(".")[1]||"").length}function qle(e,t){const r=Math.pow(10,t);return Math.round(e*r)/r}var RO=bO,Wle=EO,Hle=SO,Gle=TO;const hu=E.forwardRef(({className:e,...t},r)=>s.jsxs(RO,{ref:r,className:pt("relative flex w-full touch-none select-none items-center",e),...t,children:[s.jsx(Wle,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:s.jsx(Hle,{className:"absolute h-full bg-primary"})}),s.jsx(Gle,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));hu.displayName=RO.displayName;var PO={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(e,t){((r,a)=>{e.exports=a()})(rd,function r(){var a=typeof self<"u"?self:typeof window<"u"?window:a!==void 0?a:{},n,i=!a.document&&!!a.postMessage,o=a.IS_PAPA_WORKER||!1,c={},d=0,h={};function p(F){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(M){var z=B(M);z.chunkSize=parseInt(z.chunkSize),M.step||M.chunk||(z.chunkSize=null),this._handle=new _(z),(this._handle.streamer=this)._config=z}).call(this,F),this.parseChunk=function(M,z){var q=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<q){let ae=this._config.newline;ae||(Y=this._config.quoteChar||'"',ae=this._handle.guessLineEndings(M,Y)),M=[...M.split(ae).slice(q)].join(ae)}this.isFirstChunk&&D(this._config.beforeFirstChunk)&&(Y=this._config.beforeFirstChunk(M))!==void 0&&(M=Y),this.isFirstChunk=!1,this._halted=!1;var q=this._partialLine+M,Y=(this._partialLine="",this._handle.parse(q,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(M=Y.meta.cursor,q=(this._finished||(this._partialLine=q.substring(M-this._baseIndex),this._baseIndex=M),Y&&Y.data&&(this._rowCount+=Y.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),o)a.postMessage({results:Y,workerId:h.WORKER_ID,finished:q});else if(D(this._config.chunk)&&!z){if(this._config.chunk(Y,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=Y=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(Y.data),this._completeResults.errors=this._completeResults.errors.concat(Y.errors),this._completeResults.meta=Y.meta),this._completed||!q||!D(this._config.complete)||Y&&Y.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),q||Y&&Y.meta.paused||this._nextChunk(),Y}this._halted=!0},this._sendError=function(M){D(this._config.error)?this._config.error(M):o&&this._config.error&&a.postMessage({workerId:h.WORKER_ID,error:M,finished:!1})}}function x(F){var M;(F=F||{}).chunkSize||(F.chunkSize=h.RemoteChunkSize),p.call(this,F),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(z){this._input=z,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(M=new XMLHttpRequest,this._config.withCredentials&&(M.withCredentials=this._config.withCredentials),i||(M.onload=O(this._chunkLoaded,this),M.onerror=O(this._chunkError,this)),M.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var z,q=this._config.downloadRequestHeaders;for(z in q)M.setRequestHeader(z,q[z])}var Y;this._config.chunkSize&&(Y=this._start+this._config.chunkSize-1,M.setRequestHeader("Range","bytes="+this._start+"-"+Y));try{M.send(this._config.downloadRequestBody)}catch(ae){this._chunkError(ae.message)}i&&M.status===0&&this._chunkError()}},this._chunkLoaded=function(){M.readyState===4&&(M.status<200||400<=M.status?this._chunkError():(this._start+=this._config.chunkSize||M.responseText.length,this._finished=!this._config.chunkSize||this._start>=(z=>(z=z.getResponseHeader("Content-Range"))!==null?parseInt(z.substring(z.lastIndexOf("/")+1)):-1)(M),this.parseChunk(M.responseText)))},this._chunkError=function(z){z=M.statusText||z,this._sendError(new Error(z))}}function v(F){(F=F||{}).chunkSize||(F.chunkSize=h.LocalChunkSize),p.call(this,F);var M,z,q=typeof FileReader<"u";this.stream=function(Y){this._input=Y,z=Y.slice||Y.webkitSlice||Y.mozSlice,q?((M=new FileReader).onload=O(this._chunkLoaded,this),M.onerror=O(this._chunkError,this)):M=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var Y=this._input,ae=(this._config.chunkSize&&(ae=Math.min(this._start+this._config.chunkSize,this._input.size),Y=z.call(Y,this._start,ae)),M.readAsText(Y,this._config.encoding));q||this._chunkLoaded({target:{result:ae}})},this._chunkLoaded=function(Y){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(Y.target.result)},this._chunkError=function(){this._sendError(M.error)}}function b(F){var M;p.call(this,F=F||{}),this.stream=function(z){return M=z,this._nextChunk()},this._nextChunk=function(){var z,q;if(!this._finished)return z=this._config.chunkSize,M=z?(q=M.substring(0,z),M.substring(z)):(q=M,""),this._finished=!M,this.parseChunk(q)}}function N(F){p.call(this,F=F||{});var M=[],z=!0,q=!1;this.pause=function(){p.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){p.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(Y){this._input=Y,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){q&&M.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),M.length?this.parseChunk(M.shift()):z=!0},this._streamData=O(function(Y){try{M.push(typeof Y=="string"?Y:Y.toString(this._config.encoding)),z&&(z=!1,this._checkIsFinished(),this.parseChunk(M.shift()))}catch(ae){this._streamError(ae)}},this),this._streamError=O(function(Y){this._streamCleanUp(),this._sendError(Y)},this),this._streamEnd=O(function(){this._streamCleanUp(),q=!0,this._streamData("")},this),this._streamCleanUp=O(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function _(F){var M,z,q,Y,ae=Math.pow(2,53),je=-ae,H=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Z=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,G=this,Q=0,re=0,le=!1,ye=!1,W=[],ee={data:[],errors:[],meta:{}};function ie(me){return F.skipEmptyLines==="greedy"?me.join("").trim()==="":me.length===1&&me[0].length===0}function ce(){if(ee&&q&&(Ce("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+h.DefaultDelimiter+"'"),q=!1),F.skipEmptyLines&&(ee.data=ee.data.filter(function(ne){return!ie(ne)})),xe()){let ne=function(Me,Ie){D(F.transformHeader)&&(Me=F.transformHeader(Me,Ie)),W.push(Me)};if(ee)if(Array.isArray(ee.data[0])){for(var me=0;xe()&&me<ee.data.length;me++)ee.data[me].forEach(ne);ee.data.splice(0,1)}else ee.data.forEach(ne)}function fe(ne,Me){for(var Ie=F.header?{}:[],Be=0;Be<ne.length;Be++){var ot=Be,Se=ne[Be],Se=((ze,we)=>(Le=>(F.dynamicTypingFunction&&F.dynamicTyping[Le]===void 0&&(F.dynamicTyping[Le]=F.dynamicTypingFunction(Le)),(F.dynamicTyping[Le]||F.dynamicTyping)===!0))(ze)?we==="true"||we==="TRUE"||we!=="false"&&we!=="FALSE"&&((Le=>{if(H.test(Le)&&(Le=parseFloat(Le),je<Le&&Le<ae))return 1})(we)?parseFloat(we):Z.test(we)?new Date(we):we===""?null:we):we)(ot=F.header?Be>=W.length?"__parsed_extra":W[Be]:ot,Se=F.transform?F.transform(Se,ot):Se);ot==="__parsed_extra"?(Ie[ot]=Ie[ot]||[],Ie[ot].push(Se)):Ie[ot]=Se}return F.header&&(Be>W.length?Ce("FieldMismatch","TooManyFields","Too many fields: expected "+W.length+" fields but parsed "+Be,re+Me):Be<W.length&&Ce("FieldMismatch","TooFewFields","Too few fields: expected "+W.length+" fields but parsed "+Be,re+Me)),Ie}var ve;ee&&(F.header||F.dynamicTyping||F.transform)&&(ve=1,!ee.data.length||Array.isArray(ee.data[0])?(ee.data=ee.data.map(fe),ve=ee.data.length):ee.data=fe(ee.data,0),F.header&&ee.meta&&(ee.meta.fields=W),re+=ve)}function xe(){return F.header&&W.length===0}function Ce(me,fe,ve,ne){me={type:me,code:fe,message:ve},ne!==void 0&&(me.row=ne),ee.errors.push(me)}D(F.step)&&(Y=F.step,F.step=function(me){ee=me,xe()?ce():(ce(),ee.data.length!==0&&(Q+=me.data.length,F.preview&&Q>F.preview?z.abort():(ee.data=ee.data[0],Y(ee,G))))}),this.parse=function(me,fe,ve){var ne=F.quoteChar||'"',ne=(F.newline||(F.newline=this.guessLineEndings(me,ne)),q=!1,F.delimiter?D(F.delimiter)&&(F.delimiter=F.delimiter(me),ee.meta.delimiter=F.delimiter):((ne=((Me,Ie,Be,ot,Se)=>{var ze,we,Le,Nt;Se=Se||[",","	","|",";",h.RECORD_SEP,h.UNIT_SEP];for(var Ge=0;Ge<Se.length;Ge++){for(var Lt,ps=Se[Ge],ns=0,Ke=0,dt=0,It=(Le=void 0,new T({comments:ot,delimiter:ps,newline:Ie,preview:10}).parse(Me)),Ut=0;Ut<It.data.length;Ut++)Be&&ie(It.data[Ut])?dt++:(Lt=It.data[Ut].length,Ke+=Lt,Le===void 0?Le=Lt:0<Lt&&(ns+=Math.abs(Lt-Le),Le=Lt));0<It.data.length&&(Ke/=It.data.length-dt),(we===void 0||ns<=we)&&(Nt===void 0||Nt<Ke)&&1.99<Ke&&(we=ns,ze=ps,Nt=Ke)}return{successful:!!(F.delimiter=ze),bestDelimiter:ze}})(me,F.newline,F.skipEmptyLines,F.comments,F.delimitersToGuess)).successful?F.delimiter=ne.bestDelimiter:(q=!0,F.delimiter=h.DefaultDelimiter),ee.meta.delimiter=F.delimiter),B(F));return F.preview&&F.header&&ne.preview++,M=me,z=new T(ne),ee=z.parse(M,fe,ve),ce(),le?{meta:{paused:!0}}:ee||{meta:{paused:!1}}},this.paused=function(){return le},this.pause=function(){le=!0,z.abort(),M=D(F.chunk)?"":M.substring(z.getCharIndex())},this.resume=function(){G.streamer._halted?(le=!1,G.streamer.parseChunk(M,!0)):setTimeout(G.resume,3)},this.aborted=function(){return ye},this.abort=function(){ye=!0,z.abort(),ee.meta.aborted=!0,D(F.complete)&&F.complete(ee),M=""},this.guessLineEndings=function(Me,ne){Me=Me.substring(0,1048576);var ne=new RegExp(C(ne)+"([^]*?)"+C(ne),"gm"),ve=(Me=Me.replace(ne,"")).split("\r"),ne=Me.split(`
`),Me=1<ne.length&&ne[0].length<ve[0].length;if(ve.length===1||Me)return`
`;for(var Ie=0,Be=0;Be<ve.length;Be++)ve[Be][0]===`
`&&Ie++;return Ie>=ve.length/2?`\r
`:"\r"}}function C(F){return F.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function T(F){var M=(F=F||{}).delimiter,z=F.newline,q=F.comments,Y=F.step,ae=F.preview,je=F.fastMode,H=null,Z=!1,G=F.quoteChar==null?'"':F.quoteChar,Q=G;if(F.escapeChar!==void 0&&(Q=F.escapeChar),(typeof M!="string"||-1<h.BAD_DELIMITERS.indexOf(M))&&(M=","),q===M)throw new Error("Comment character same as delimiter");q===!0?q="#":(typeof q!="string"||-1<h.BAD_DELIMITERS.indexOf(q))&&(q=!1),z!==`
`&&z!=="\r"&&z!==`\r
`&&(z=`
`);var re=0,le=!1;this.parse=function(ye,W,ee){if(typeof ye!="string")throw new Error("Input must be a string");var ie=ye.length,ce=M.length,xe=z.length,Ce=q.length,me=D(Y),fe=[],ve=[],ne=[],Me=re=0;if(!ye)return ns();if(je||je!==!1&&ye.indexOf(G)===-1){for(var Ie=ye.split(z),Be=0;Be<Ie.length;Be++){if(ne=Ie[Be],re+=ne.length,Be!==Ie.length-1)re+=z.length;else if(ee)return ns();if(!q||ne.substring(0,Ce)!==q){if(me){if(fe=[],Nt(ne.split(M)),Ke(),le)return ns()}else Nt(ne.split(M));if(ae&&ae<=Be)return fe=fe.slice(0,ae),ns(!0)}}return ns()}for(var ot=ye.indexOf(M,re),Se=ye.indexOf(z,re),ze=new RegExp(C(Q)+C(G),"g"),we=ye.indexOf(G,re);;)if(ye[re]===G)for(we=re,re++;;){if((we=ye.indexOf(G,we+1))===-1)return ee||ve.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:fe.length,index:re}),Lt();if(we===ie-1)return Lt(ye.substring(re,we).replace(ze,G));if(G===Q&&ye[we+1]===Q)we++;else if(G===Q||we===0||ye[we-1]!==Q){ot!==-1&&ot<we+1&&(ot=ye.indexOf(M,we+1));var Le=Ge((Se=Se!==-1&&Se<we+1?ye.indexOf(z,we+1):Se)===-1?ot:Math.min(ot,Se));if(ye.substr(we+1+Le,ce)===M){ne.push(ye.substring(re,we).replace(ze,G)),ye[re=we+1+Le+ce]!==G&&(we=ye.indexOf(G,re)),ot=ye.indexOf(M,re),Se=ye.indexOf(z,re);break}if(Le=Ge(Se),ye.substring(we+1+Le,we+1+Le+xe)===z){if(ne.push(ye.substring(re,we).replace(ze,G)),ps(we+1+Le+xe),ot=ye.indexOf(M,re),we=ye.indexOf(G,re),me&&(Ke(),le))return ns();if(ae&&fe.length>=ae)return ns(!0);break}ve.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:fe.length,index:re}),we++}}else if(q&&ne.length===0&&ye.substring(re,re+Ce)===q){if(Se===-1)return ns();re=Se+xe,Se=ye.indexOf(z,re),ot=ye.indexOf(M,re)}else if(ot!==-1&&(ot<Se||Se===-1))ne.push(ye.substring(re,ot)),re=ot+ce,ot=ye.indexOf(M,re);else{if(Se===-1)break;if(ne.push(ye.substring(re,Se)),ps(Se+xe),me&&(Ke(),le))return ns();if(ae&&fe.length>=ae)return ns(!0)}return Lt();function Nt(dt){fe.push(dt),Me=re}function Ge(dt){var It=0;return It=dt!==-1&&(dt=ye.substring(we+1,dt))&&dt.trim()===""?dt.length:It}function Lt(dt){return ee||(dt===void 0&&(dt=ye.substring(re)),ne.push(dt),re=ie,Nt(ne),me&&Ke()),ns()}function ps(dt){re=dt,Nt(ne),ne=[],Se=ye.indexOf(z,re)}function ns(dt){if(F.header&&!W&&fe.length&&!Z){var It=fe[0],Ut=Object.create(null),ts=new Set(It);let us=!1;for(let qe=0;qe<It.length;qe++){let jt=It[qe];if(Ut[jt=D(F.transformHeader)?F.transformHeader(jt,qe):jt]){let _t,Re=Ut[jt];for(;_t=jt+"_"+Re,Re++,ts.has(_t););ts.add(_t),It[qe]=_t,Ut[jt]++,us=!0,(H=H===null?{}:H)[_t]=jt}else Ut[jt]=1,It[qe]=jt;ts.add(jt)}us&&console.warn("Duplicate headers found and renamed."),Z=!0}return{data:fe,errors:ve,meta:{delimiter:M,linebreak:z,aborted:le,truncated:!!dt,cursor:Me+(W||0),renamedHeaders:H}}}function Ke(){Y(ns()),fe=[],ve=[]}},this.abort=function(){le=!0},this.getCharIndex=function(){return re}}function A(F){var M=F.data,z=c[M.workerId],q=!1;if(M.error)z.userError(M.error,M.file);else if(M.results&&M.results.data){var Y={abort:function(){q=!0,k(M.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:I,resume:I};if(D(z.userStep)){for(var ae=0;ae<M.results.data.length&&(z.userStep({data:M.results.data[ae],errors:M.results.errors,meta:M.results.meta},Y),!q);ae++);delete M.results}else D(z.userChunk)&&(z.userChunk(M.results,Y,M.file),delete M.results)}M.finished&&!q&&k(M.workerId,M.results)}function k(F,M){var z=c[F];D(z.userComplete)&&z.userComplete(M),z.terminate(),delete c[F]}function I(){throw new Error("Not implemented.")}function B(F){if(typeof F!="object"||F===null)return F;var M,z=Array.isArray(F)?[]:{};for(M in F)z[M]=B(F[M]);return z}function O(F,M){return function(){F.apply(M,arguments)}}function D(F){return typeof F=="function"}return h.parse=function(F,M){var z=(M=M||{}).dynamicTyping||!1;if(D(z)&&(M.dynamicTypingFunction=z,z={}),M.dynamicTyping=z,M.transform=!!D(M.transform)&&M.transform,!M.worker||!h.WORKERS_SUPPORTED)return z=null,h.NODE_STREAM_INPUT,typeof F=="string"?(F=(q=>q.charCodeAt(0)!==65279?q:q.slice(1))(F),z=new(M.download?x:b)(M)):F.readable===!0&&D(F.read)&&D(F.on)?z=new N(M):(a.File&&F instanceof File||F instanceof Object)&&(z=new v(M)),z.stream(F);(z=(()=>{var q;return!!h.WORKERS_SUPPORTED&&(q=(()=>{var Y=a.URL||a.webkitURL||null,ae=r.toString();return h.BLOB_URL||(h.BLOB_URL=Y.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",ae,")();"],{type:"text/javascript"})))})(),(q=new a.Worker(q)).onmessage=A,q.id=d++,c[q.id]=q)})()).userStep=M.step,z.userChunk=M.chunk,z.userComplete=M.complete,z.userError=M.error,M.step=D(M.step),M.chunk=D(M.chunk),M.complete=D(M.complete),M.error=D(M.error),delete M.worker,z.postMessage({input:F,config:M,workerId:z.id})},h.unparse=function(F,M){var z=!1,q=!0,Y=",",ae=`\r
`,je='"',H=je+je,Z=!1,G=null,Q=!1,re=((()=>{if(typeof M=="object"){if(typeof M.delimiter!="string"||h.BAD_DELIMITERS.filter(function(W){return M.delimiter.indexOf(W)!==-1}).length||(Y=M.delimiter),typeof M.quotes!="boolean"&&typeof M.quotes!="function"&&!Array.isArray(M.quotes)||(z=M.quotes),typeof M.skipEmptyLines!="boolean"&&typeof M.skipEmptyLines!="string"||(Z=M.skipEmptyLines),typeof M.newline=="string"&&(ae=M.newline),typeof M.quoteChar=="string"&&(je=M.quoteChar),typeof M.header=="boolean"&&(q=M.header),Array.isArray(M.columns)){if(M.columns.length===0)throw new Error("Option columns is empty");G=M.columns}M.escapeChar!==void 0&&(H=M.escapeChar+je),M.escapeFormulae instanceof RegExp?Q=M.escapeFormulae:typeof M.escapeFormulae=="boolean"&&M.escapeFormulae&&(Q=/^[=+\-@\t\r].*$/)}})(),new RegExp(C(je),"g"));if(typeof F=="string"&&(F=JSON.parse(F)),Array.isArray(F)){if(!F.length||Array.isArray(F[0]))return le(null,F,Z);if(typeof F[0]=="object")return le(G||Object.keys(F[0]),F,Z)}else if(typeof F=="object")return typeof F.data=="string"&&(F.data=JSON.parse(F.data)),Array.isArray(F.data)&&(F.fields||(F.fields=F.meta&&F.meta.fields||G),F.fields||(F.fields=Array.isArray(F.data[0])?F.fields:typeof F.data[0]=="object"?Object.keys(F.data[0]):[]),Array.isArray(F.data[0])||typeof F.data[0]=="object"||(F.data=[F.data])),le(F.fields||[],F.data||[],Z);throw new Error("Unable to serialize unrecognized input");function le(W,ee,ie){var ce="",xe=(typeof W=="string"&&(W=JSON.parse(W)),typeof ee=="string"&&(ee=JSON.parse(ee)),Array.isArray(W)&&0<W.length),Ce=!Array.isArray(ee[0]);if(xe&&q){for(var me=0;me<W.length;me++)0<me&&(ce+=Y),ce+=ye(W[me],me);0<ee.length&&(ce+=ae)}for(var fe=0;fe<ee.length;fe++){var ve=(xe?W:ee[fe]).length,ne=!1,Me=xe?Object.keys(ee[fe]).length===0:ee[fe].length===0;if(ie&&!xe&&(ne=ie==="greedy"?ee[fe].join("").trim()==="":ee[fe].length===1&&ee[fe][0].length===0),ie==="greedy"&&xe){for(var Ie=[],Be=0;Be<ve;Be++){var ot=Ce?W[Be]:Be;Ie.push(ee[fe][ot])}ne=Ie.join("").trim()===""}if(!ne){for(var Se=0;Se<ve;Se++){0<Se&&!Me&&(ce+=Y);var ze=xe&&Ce?W[Se]:Se;ce+=ye(ee[fe][ze],Se)}fe<ee.length-1&&(!ie||0<ve&&!Me)&&(ce+=ae)}}return ce}function ye(W,ee){var ie,ce;return W==null?"":W.constructor===Date?JSON.stringify(W).slice(1,25):(ce=!1,Q&&typeof W=="string"&&Q.test(W)&&(W="'"+W,ce=!0),ie=W.toString().replace(re,H),(ce=ce||z===!0||typeof z=="function"&&z(W,ee)||Array.isArray(z)&&z[ee]||((xe,Ce)=>{for(var me=0;me<Ce.length;me++)if(-1<xe.indexOf(Ce[me]))return!0;return!1})(ie,h.BAD_DELIMITERS)||-1<ie.indexOf(Y)||ie.charAt(0)===" "||ie.charAt(ie.length-1)===" ")?je+ie+je:ie)}},h.RECORD_SEP="",h.UNIT_SEP="",h.BYTE_ORDER_MARK="\uFEFF",h.BAD_DELIMITERS=["\r",`
`,'"',h.BYTE_ORDER_MARK],h.WORKERS_SUPPORTED=!i&&!!a.Worker,h.NODE_STREAM_INPUT=1,h.LocalChunkSize=10485760,h.RemoteChunkSize=5242880,h.DefaultDelimiter=",",h.Parser=T,h.ParserHandle=_,h.NetworkStreamer=x,h.FileStreamer=v,h.StringStreamer=b,h.ReadableStreamStreamer=N,a.jQuery&&((n=a.jQuery).fn.parse=function(F){var M=F.config||{},z=[];return this.each(function(ae){if(!(n(this).prop("tagName").toUpperCase()==="INPUT"&&n(this).attr("type").toLowerCase()==="file"&&a.FileReader)||!this.files||this.files.length===0)return!0;for(var je=0;je<this.files.length;je++)z.push({file:this.files[je],inputElem:this,instanceConfig:n.extend({},M)})}),q(),this;function q(){if(z.length===0)D(F.complete)&&F.complete();else{var ae,je,H,Z,G=z[0];if(D(F.before)){var Q=F.before(G.file,G.inputElem);if(typeof Q=="object"){if(Q.action==="abort")return ae="AbortError",je=G.file,H=G.inputElem,Z=Q.reason,void(D(F.error)&&F.error({name:ae},je,H,Z));if(Q.action==="skip")return void Y();typeof Q.config=="object"&&(G.instanceConfig=n.extend(G.instanceConfig,Q.config))}else if(Q==="skip")return void Y()}var re=G.instanceConfig.complete;G.instanceConfig.complete=function(le){D(re)&&re(le,G.file,G.inputElem),Y()},h.parse(G.file,G.instanceConfig)}}function Y(){z.splice(0,1),q()}}),o&&(a.onmessage=function(F){F=F.data,h.WORKER_ID===void 0&&F&&(h.WORKER_ID=F.workerId),typeof F.input=="string"?a.postMessage({workerId:h.WORKER_ID,results:h.parse(F.input,F.config),finished:!0}):(a.File&&F.input instanceof File||F.input instanceof Object)&&(F=h.parse(F.input,F.config))&&a.postMessage({workerId:h.WORKER_ID,results:F,finished:!0})}),(x.prototype=Object.create(p.prototype)).constructor=x,(v.prototype=Object.create(p.prototype)).constructor=v,(b.prototype=Object.create(b.prototype)).constructor=b,(N.prototype=Object.create(p.prototype)).constructor=N,h})})(PO);var Kle=PO.exports;const Xle=qu(Kle),Yle=yA({gtin:qn().trim().min(8,"GTIN deve ter no mnimo 8 dgitos").max(14,"GTIN deve ter no mximo 14 dgitos"),ncm:qn().trim().length(8,"NCM deve ter exatamente 8 dgitos"),descricao:qn().trim().min(3,"Descrio deve ter no mnimo 3 caracteres").max(200,"Descrio muito longa"),tipo_embalagem:_y(["vidro","plastico","papel","papelao","aluminio","laminado","misto"]),reciclavel:_y(["sim","nao","true","false","1","0","Sim","No","SIM","NO"]),percentual_reciclabilidade:qn().refine(e=>{const t=parseFloat(e);return!isNaN(t)&&t>=0&&t<=100},"Percentual deve ser entre 0 e 100"),observacoes:qn().trim().max(500,"Observaes muito longas").optional()});function Zle({open:e,onOpenChange:t,onSuccess:r}){const[a,n]=E.useState(null),[i,o]=E.useState(null),[c,d]=E.useState(!1),[h,p]=E.useState(0),{toast:x}=_r(),v=()=>{const A=["gtin,ncm,descricao,tipo_embalagem,reciclavel,percentual_reciclabilidade,observacoes","7891234567890,12345678,Garrafa PET 2L,plastico,sim,85,Embalagem reciclvel","7891234567891,12345679,Caixa de Papelo,papelao,sim,95,","7891234567892,12345680,Lata de Alumnio,aluminio,sim,100,100% reciclvel"].join(`
`),k=new Blob([A],{type:"text/csv;charset=utf-8;"}),I=document.createElement("a");I.href=URL.createObjectURL(k),I.download="template_produtos_ciclik.csv",I.click(),URL.revokeObjectURL(I.href)},b=A=>{const k=A.toLowerCase().trim();return["sim","true","1","yes"].includes(k)},N=A=>{const k=[],I=[];return A.forEach((B,O)=>{const D=[];try{Yle.parse(B),/^\d+$/.test(B.gtin)||D.push("GTIN deve conter apenas nmeros"),/^\d{8}$/.test(B.ncm)||D.push("NCM deve ter 8 dgitos numricos"),D.length===0?k.push(B):I.push({row:O+2,data:B,errors:D})}catch(F){F instanceof zl&&F.errors.forEach(M=>{D.push(`${M.path.join(".")}: ${M.message}`)}),I.push({row:O+2,data:B,errors:D})}}),{valid:k,invalid:I}},_=A=>{var I;const k=(I=A.target.files)==null?void 0:I[0];if(k){if(!k.name.endsWith(".csv")){x({title:"Formato invlido",description:"Por favor, selecione um arquivo CSV",variant:"destructive"});return}n(k),o(null),Xle.parse(k,{header:!0,skipEmptyLines:!0,complete:B=>{if(B.data.length===0){x({title:"Arquivo vazio",description:"O arquivo CSV no contm dados",variant:"destructive"});return}const O=N(B.data);o(O),O.invalid.length>0?x({title:"Erros de validao",description:`${O.invalid.length} produto(s) com erro. Revise antes de importar.`,variant:"destructive"}):x({title:"Validao concluda",description:`${O.valid.length} produto(s) validado(s) com sucesso`})},error:B=>{x({title:"Erro ao ler arquivo",description:B.message,variant:"destructive"})}})}},C=async()=>{if(!(!i||i.valid.length===0)){d(!0),p(0);try{const A=i.valid.map(O=>{var D;return{gtin:O.gtin.trim(),ncm:O.ncm.trim(),descricao:O.descricao.trim(),tipo_embalagem:O.tipo_embalagem,reciclavel:b(O.reciclavel),percentual_reciclabilidade:parseFloat(O.percentual_reciclabilidade),observacoes:((D=O.observacoes)==null?void 0:D.trim())||null}}),k=50;let I=0;const B=[];for(let O=0;O<A.length;O+=k){const D=A.slice(O,O+k),{error:F}=await J.from("produtos_ciclik").insert(D);if(F)if(F.code==="23505")for(const M of D){const{error:z}=await J.from("produtos_ciclik").insert([M]);z?B.push(`GTIN ${M.gtin}: ${z.message}`):I++}else throw F;else I+=D.length;p(Math.round((O+D.length)/A.length*100))}x({title:"Importao concluda",description:`${I} produto(s) importado(s) com sucesso${B.length>0?`. ${B.length} erro(s) encontrado(s)`:""}`}),r(),T()}catch(A){console.error("Erro na importao:",A),x({title:"Erro na importao",description:A.message||"No foi possvel importar os produtos",variant:"destructive"})}finally{d(!1),p(0)}}},T=()=>{n(null),o(null),p(0),t(!1)};return s.jsx(ar,{open:e,onOpenChange:T,children:s.jsxs(tr,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(nr,{children:[s.jsx(ir,{children:"Importar Produtos via CSV"}),s.jsx(Vr,{children:"Faa upload de um arquivo CSV com os dados dos produtos Ciclik"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs(Er,{children:[s.jsx(Ua,{className:"h-4 w-4"}),s.jsxs(Sr,{className:"flex items-center justify-between",children:[s.jsx("span",{children:"Baixe o template CSV com o formato correto"}),s.jsxs(oe,{variant:"outline",size:"sm",onClick:v,children:[s.jsx(Ua,{className:"h-4 w-4 mr-2"}),"Baixar Template"]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"csv-upload",children:"Arquivo CSV"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(We,{id:"csv-upload",type:"file",accept:".csv",onChange:_,disabled:c,className:"flex-1"}),a&&s.jsx(oe,{variant:"ghost",size:"sm",onClick:()=>{n(null),o(null)},disabled:c,children:s.jsx(Jr,{className:"h-4 w-4"})})]})]}),c&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{children:"Importando produtos..."}),s.jsx(fn,{value:h}),s.jsxs("p",{className:"text-sm text-muted-foreground text-center",children:[h,"%"]})]}),i&&!c&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex gap-4",children:[s.jsxs(Er,{className:"flex-1",children:[s.jsx(_n,{className:"h-4 w-4 text-green-500"}),s.jsxs(Sr,{children:[s.jsx("strong",{children:i.valid.length})," produto(s) vlido(s)"]})]}),i.invalid.length>0&&s.jsxs(Er,{className:"flex-1",variant:"destructive",children:[s.jsx(Kr,{className:"h-4 w-4"}),s.jsxs(Sr,{children:[s.jsx("strong",{children:i.invalid.length})," produto(s) com erro(s)"]})]})]}),i.valid.length>0&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{children:"Produtos Vlidos (primeiros 5)"}),s.jsx("div",{className:"border rounded-lg overflow-hidden",children:s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{children:"GTIN"}),s.jsx(rt,{children:"NCM"}),s.jsx(rt,{children:"Descrio"}),s.jsx(rt,{children:"Tipo"}),s.jsx(rt,{children:"Reciclvel"})]})}),s.jsx(da,{children:i.valid.slice(0,5).map((A,k)=>s.jsxs(Cs,{children:[s.jsx(Ze,{className:"font-mono text-sm",children:A.gtin}),s.jsx(Ze,{className:"font-mono text-sm",children:A.ncm}),s.jsx(Ze,{children:A.descricao}),s.jsx(Ze,{children:s.jsx(Je,{variant:"secondary",children:qi[A.tipo_embalagem]})}),s.jsx(Ze,{children:b(A.reciclavel)?s.jsxs(Je,{variant:"outline",className:"bg-green-50 text-green-700",children:["Sim (",A.percentual_reciclabilidade,"%)"]}):s.jsx(Je,{variant:"outline",children:"No"})})]},k))})]})}),i.valid.length>5&&s.jsxs("p",{className:"text-sm text-muted-foreground text-center",children:["+ ",i.valid.length-5," produto(s) adicionais"]})]}),i.invalid.length>0&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{className:"text-destructive",children:"Produtos com Erros"}),s.jsx("div",{className:"border border-destructive rounded-lg p-4 space-y-2 max-h-64 overflow-y-auto",children:i.invalid.map((A,k)=>s.jsxs("div",{className:"border-b pb-2 last:border-0",children:[s.jsxs("p",{className:"text-sm font-semibold",children:["Linha ",A.row]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["GTIN: ",A.data.gtin," | ",A.data.descricao]}),s.jsx("ul",{className:"text-sm text-destructive list-disc list-inside",children:A.errors.map((I,B)=>s.jsx("li",{children:I},B))})]},k))})]})]})]}),s.jsxs(Ya,{children:[s.jsx(oe,{variant:"outline",onClick:T,disabled:c,children:"Cancelar"}),s.jsx(oe,{onClick:C,disabled:!i||i.valid.length===0||c,children:c?s.jsx(s.Fragment,{children:"Importando..."}):s.jsxs(s.Fragment,{children:[s.jsx(wd,{className:"h-4 w-4 mr-2"}),"Importar ",(i==null?void 0:i.valid.length)||0," Produto(s)"]})})]})]})})}function Qle(){const e=ds(),[t,r]=E.useState([]),[a,n]=E.useState([]),[i,o]=E.useState(""),[c,d]=E.useState(!1),[h,p]=E.useState(!1),[x,v]=E.useState(!1),[b,N]=E.useState(null),[_,C]=E.useState(null),[T,A]=E.useState(!1),[k,I]=E.useState(!1),{toast:B}=_r(),[O,D]=E.useState(!1),[F,M]=E.useState("all"),[z,q]=E.useState("all"),[Y,ae]=E.useState(0),[je,H]=E.useState(100),[Z,G]=E.useState({gtin:"",ncm:"",descricao:"",tipo_embalagem:"plastico",reciclavel:!0,percentual_reciclabilidade:100,peso_medio_gramas:null,observacoes:"",embalagens:[]}),Q=Se=>Se?parseFloat((Se/1e3).toFixed(3)):null,re=Se=>Se?parseFloat((Se*1e3).toFixed(2)):null,[le,ye]=E.useState({tipo_embalagem:"plastico",reciclavel:!0,percentual_reciclabilidade:100,peso_medio_gramas:null}),[W,ee]=E.useState({total:0,reciclaveis:0,vidro:0,plastico:0,papel:0,papelao:0,aluminio:0,laminado:0,misto:0});E.useEffect(()=>{ce()},[]),E.useEffect(()=>{let Se=t.filter(ze=>ze.gtin.toLowerCase().includes(i.toLowerCase())||ze.ncm.toLowerCase().includes(i.toLowerCase())||ze.descricao.toLowerCase().includes(i.toLowerCase()));F!=="all"&&(Se=Se.filter(ze=>ze.tipo_embalagem===F)),z!=="all"&&(Se=Se.filter(ze=>z==="yes"?ze.reciclavel:!ze.reciclavel)),Se=Se.filter(ze=>ze.percentual_reciclabilidade>=Y&&ze.percentual_reciclabilidade<=je),n(Se)},[i,t,F,z,Y,je]),E.useEffect(()=>{ie()},[t]);const ie=()=>{const Se={total:t.length,reciclaveis:t.filter(ze=>ze.reciclavel).length,vidro:t.filter(ze=>ze.tipo_embalagem==="vidro").length,plastico:t.filter(ze=>ze.tipo_embalagem==="plastico").length,papel:t.filter(ze=>ze.tipo_embalagem==="papel").length,papelao:t.filter(ze=>ze.tipo_embalagem==="papelao").length,aluminio:t.filter(ze=>ze.tipo_embalagem==="aluminio").length,laminado:t.filter(ze=>ze.tipo_embalagem==="laminado").length,misto:t.filter(ze=>ze.tipo_embalagem==="misto").length};ee(Se)},ce=async()=>{A(!0);try{const{data:Se,error:ze}=await J.from("produtos_ciclik").select("*").order("descricao");if(ze)throw ze;r(Se)}catch(Se){console.error("Erro ao carregar produtos:",Se),B({title:"Erro",description:"No foi possvel carregar os produtos",variant:"destructive"})}finally{A(!1)}},xe=()=>{G({gtin:"",ncm:"",descricao:"",tipo_embalagem:"plastico",reciclavel:!0,percentual_reciclabilidade:100,peso_medio_gramas:null,observacoes:"",embalagens:[]}),ye({tipo_embalagem:"plastico",reciclavel:!0,percentual_reciclabilidade:100,peso_medio_gramas:null}),N(null)},Ce=async Se=>{if(Se){N(Se);const{data:ze}=await J.from("produto_embalagens").select("id, tipo_embalagem, reciclavel, percentual_reciclabilidade, peso_medio_gramas").eq("produto_id",Se.id);G({gtin:Se.gtin,ncm:Se.ncm,descricao:Se.descricao,tipo_embalagem:Se.tipo_embalagem,reciclavel:Se.reciclavel,percentual_reciclabilidade:Se.percentual_reciclabilidade,peso_medio_gramas:Q(Se.peso_medio_gramas),observacoes:Se.observacoes||"",embalagens:(ze||[]).map(we=>({...we,peso_medio_gramas:Q(we.peso_medio_gramas)}))})}else xe();d(!0)},me=Se=>{C({id:Se.id,descricao:Se.descricao,peso:Q(Se.peso_medio_gramas)}),v(!0)},fe=async()=>{if(_){A(!0);try{const Se=re(_.peso),{error:ze}=await J.from("produtos_ciclik").update({peso_medio_gramas:Se}).eq("id",_.id);if(ze)throw ze;B({title:"Sucesso",description:"Peso mdio atualizado com sucesso"}),v(!1),C(null),await ce()}catch(Se){console.error("Erro ao atualizar peso:",Se),B({title:"Erro",description:"No foi possvel atualizar o peso mdio",variant:"destructive"})}finally{A(!1)}}},ve=()=>{G({...Z,embalagens:[...Z.embalagens,{...le}]}),ye({tipo_embalagem:"plastico",reciclavel:!0,percentual_reciclabilidade:100,peso_medio_gramas:null})},ne=Se=>{G({...Z,embalagens:Z.embalagens.filter((ze,we)=>we!==Se)})},Me=async()=>{if(!Z.gtin||!Z.ncm||!Z.descricao){B({title:"Campos obrigatrios",description:"Preencha GTIN, NCM e Descrio",variant:"destructive"});return}A(!0);try{let Se=b==null?void 0:b.id;const ze=re(Z.peso_medio_gramas);if(b){const{error:we}=await J.from("produtos_ciclik").update({gtin:Z.gtin,ncm:Z.ncm,descricao:Z.descricao,tipo_embalagem:Z.tipo_embalagem,reciclavel:Z.reciclavel,percentual_reciclabilidade:Z.percentual_reciclabilidade,peso_medio_gramas:ze,observacoes:Z.observacoes}).eq("id",b.id);if(we)throw we;B({title:"Sucesso",description:"Produto atualizado com sucesso"})}else{const{data:we,error:Le}=await J.from("produtos_ciclik").insert([{gtin:Z.gtin,ncm:Z.ncm,descricao:Z.descricao,tipo_embalagem:Z.tipo_embalagem,reciclavel:Z.reciclavel,percentual_reciclabilidade:Z.percentual_reciclabilidade,peso_medio_gramas:ze,observacoes:Z.observacoes}]).select().single();if(Le)throw Le;Se=we.id,B({title:"Sucesso",description:"Produto cadastrado com sucesso"})}if(Z.embalagens.length>0&&Se){const we=Z.embalagens.filter(Nt=>"id"in Nt&&Nt.id),Le=Z.embalagens.filter(Nt=>!("id"in Nt)||!Nt.id);for(const Nt of we){const{error:Ge}=await J.from("produto_embalagens").update({tipo_embalagem:Nt.tipo_embalagem,reciclavel:Nt.reciclavel,percentual_reciclabilidade:Nt.percentual_reciclabilidade,peso_medio_gramas:re(Nt.peso_medio_gramas)}).eq("id",Nt.id);if(Ge)throw Ge}if(Le.length>0){const Nt=Le.map(Lt=>({produto_id:Se,tipo_embalagem:Lt.tipo_embalagem,reciclavel:Lt.reciclavel,percentual_reciclabilidade:Lt.percentual_reciclabilidade,peso_medio_gramas:re(Lt.peso_medio_gramas)})),{error:Ge}=await J.from("produto_embalagens").insert(Nt);if(Ge)throw Ge}}await ce(),d(!1),xe()}catch(Se){console.error("Erro ao salvar produto:",Se),B({title:"Erro",description:Se.message||"No foi possvel salvar o produto",variant:"destructive"})}finally{A(!1)}},Ie=async Se=>{if(confirm("Tem certeza que deseja excluir este produto?")){A(!0);try{const{error:ze}=await J.from("produtos_ciclik").delete().eq("id",Se);if(ze)throw ze;B({title:"Sucesso",description:"Produto excludo com sucesso"}),ce()}catch(ze){console.error("Erro ao excluir produto:",ze),B({title:"Erro",description:"No foi possvel excluir o produto",variant:"destructive"})}finally{A(!1)}}},Be=()=>{if(t.length===0){B({title:"Nenhum produto",description:"No h produtos para exportar",variant:"destructive"});return}const Se=["GTIN","NCM","Descrio","Tipo Embalagem","Reciclvel","% Reciclabilidade","Peso Mdio (kg)","Observaes","Data Cadastro"],ze=t.map(Lt=>[Lt.gtin,Lt.ncm,`"${(Lt.descricao||"").replace(/"/g,'""')}"`,qi[Lt.tipo_embalagem]||Lt.tipo_embalagem,Lt.reciclavel?"Sim":"No",Lt.percentual_reciclabilidade,Lt.peso_medio_gramas?(Lt.peso_medio_gramas/1e3).toFixed(3).replace(".",","):"",`"${(Lt.observacoes||"").replace(/"/g,'""')}"`,Lt.data_cadastro?new Date(Lt.data_cadastro).toLocaleDateString("pt-BR"):""]),we=[Se.join(";"),...ze.map(Lt=>Lt.join(";"))].join(`
`),Le=new Blob(["\uFEFF"+we],{type:"text/csv;charset=utf-8;"}),Nt=URL.createObjectURL(Le),Ge=document.createElement("a");Ge.href=Nt,Ge.download=`produtos_ciclik_${new Date().toISOString().split("T")[0]}.csv`,Ge.click(),URL.revokeObjectURL(Nt),B({title:"Exportao concluda",description:`${t.length} produtos exportados com sucesso`})},ot=async()=>{if(!Z.gtin||Z.gtin.length<8){B({title:"GTIN invlido",description:"Digite um GTIN vlido (mnimo 8 dgitos)",variant:"destructive"});return}I(!0);try{const{data:Se,error:ze}=await J.functions.invoke("buscar-produto-gtin",{body:{gtin:Z.gtin}});if(ze){console.error("Erro HTTP ao buscar produto:",ze),B({title:"Erro na busca",description:"No foi possvel conectar ao servio de busca",variant:"destructive"});return}if(Se!=null&&Se.success&&(Se!=null&&Se.data)){const we=Se.data,Le=Se.suggested_packaging||[];G(Ge=>({...Ge,descricao:we.descricao||Ge.descricao,ncm:we.ncm||Ge.ncm,observacoes:`${Ge.observacoes?Ge.observacoes+`
`:""}Marca: ${we.marca||"N/A"}
Categoria: ${we.categoria||"N/A"}
Fonte: ${Se.source}`,embalagens:Le.length>0?Le:Ge.embalagens}));const Nt=[];we.descricao&&Nt.push("descrio"),we.ncm&&Nt.push("NCM"),Le.length>0&&Nt.push(`${Le.length} tipo(s) de embalagem`),B({title:"Produto encontrado!",description:`Dados de ${Se.source}. ${Nt.length>0?`Preenchido: ${Nt.join(", ")}.`:""} Revise as informaes.`})}else B({title:"Produto no encontrado",description:(Se==null?void 0:Se.message)||(Se==null?void 0:Se.error)||"Preencha os dados manualmente"})}catch(Se){console.error("Erro ao buscar produto:",Se),B({title:"Erro na busca",description:Se.message||"No foi possvel buscar o produto",variant:"destructive"})}finally{I(!1)}};return s.jsx(Nc,{children:s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(Rd,{}),s.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>e("/admin"),className:"gap-2",children:[s.jsx(As,{className:"h-4 w-4"}),"Voltar"]}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Gesto de Produtos Ciclik"}),s.jsx("p",{className:"text-muted-foreground",children:"Cadastro e gerenciamento de produtos"})]})]}),s.jsxs(S_,{children:[s.jsx(T_,{asChild:!0,children:s.jsx(oe,{variant:"outline",children:s.jsx(Lw,{className:"h-4 w-4"})})}),s.jsxs(Xg,{align:"end",children:[s.jsxs(Ka,{onClick:()=>e("/admin/products/analysis"),children:[s.jsx(un,{className:"mr-2 h-4 w-4"}),"Produtos em Anlise"]}),s.jsxs(Ka,{onClick:()=>e("/admin/products/report"),children:[s.jsx(fs,{className:"mr-2 h-4 w-4"}),"Relatrio Produtos"]}),s.jsxs(Ka,{onClick:()=>p(!0),children:[s.jsx(wd,{className:"mr-2 h-4 w-4"}),"Importar CSV"]}),s.jsxs(Ka,{onClick:Be,children:[s.jsx(Ua,{className:"mr-2 h-4 w-4"}),"Exportar CSV"]}),s.jsxs(Ka,{onClick:()=>Ce(),children:[s.jsx(ra,{className:"mr-2 h-4 w-4"}),"Novo Produto"]})]})]}),s.jsx(ar,{open:c,onOpenChange:d,children:s.jsxs(tr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(nr,{children:[s.jsx(ir,{children:b?"Editar Produto":"Novo Produto"}),s.jsx(Vr,{children:"Preencha os dados do produto Ciclik"})]}),s.jsxs("div",{className:"grid gap-4 py-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"gtin",children:"GTIN *"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(We,{id:"gtin",value:Z.gtin,onChange:Se=>G({...Z,gtin:Se.target.value}),placeholder:"7891234567890",className:"flex-1"}),s.jsx(oe,{type:"button",variant:"outline",onClick:ot,disabled:k||!Z.gtin||Z.gtin.length<8,children:k?s.jsx(_s,{className:"h-4 w-4 animate-spin"}):s.jsx(eo,{className:"h-4 w-4"})})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Clique na lupa para buscar dados automaticamente"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"ncm",children:"NCM *"}),s.jsx(We,{id:"ncm",value:Z.ncm,onChange:Se=>G({...Z,ncm:Se.target.value}),placeholder:"12345678",maxLength:8})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"descricao",children:"Descrio *"}),s.jsx(We,{id:"descricao",value:Z.descricao,onChange:Se=>G({...Z,descricao:Se.target.value}),placeholder:"Nome do produto"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"tipo_embalagem",children:"Tipo de Embalagem"}),s.jsxs(qs,{value:Z.tipo_embalagem,onValueChange:Se=>G({...Z,tipo_embalagem:Se}),children:[s.jsx(Ls,{children:s.jsx(Ws,{})}),s.jsx(Fs,{children:Object.entries(qi).map(([Se,ze])=>s.jsx(xt,{value:Se,children:ze},Se))})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(fi,{id:"reciclavel",checked:Z.reciclavel,onCheckedChange:Se=>G({...Z,reciclavel:Se})}),s.jsx(ke,{htmlFor:"reciclavel",children:"Reciclvel"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs(ke,{htmlFor:"percentual",children:["Percentual de Reciclabilidade: ",Z.percentual_reciclabilidade,"%"]}),s.jsx(hu,{id:"percentual",min:0,max:100,step:5,value:[Z.percentual_reciclabilidade],onValueChange:Se=>G({...Z,percentual_reciclabilidade:Se[0]})}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"h-3 w-full bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full transition-all duration-300 ${Z.percentual_reciclabilidade>=80?"bg-green-500":Z.percentual_reciclabilidade>=50?"bg-yellow-500":Z.percentual_reciclabilidade>=25?"bg-orange-500":"bg-red-500"}`,style:{width:`${Z.percentual_reciclabilidade}%`}})}),s.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[s.jsx("span",{children:"0%"}),s.jsx("span",{className:"font-medium",children:Z.percentual_reciclabilidade>=80?" Excelente":Z.percentual_reciclabilidade>=50?" Bom":Z.percentual_reciclabilidade>=25?" Regular":" Baixo"}),s.jsx("span",{children:"100%"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"peso_medio",children:"Peso Mdio da Embalagem (kg)"}),s.jsx(We,{id:"peso_medio",type:"number",step:"0.001",min:"0",value:Z.peso_medio_gramas||"",onChange:Se=>G({...Z,peso_medio_gramas:Se.target.value?parseFloat(Se.target.value):null}),placeholder:"Ex: 0.250"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Peso mdio da embalagem vazia em quilos (para clculo de peso total)"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"observacoes",children:"Observaes"}),s.jsx(jn,{id:"observacoes",value:Z.observacoes,onChange:Se=>G({...Z,observacoes:Se.target.value}),placeholder:"Informaes adicionais",rows:3})]}),s.jsxs("div",{className:"border-t pt-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx(ke,{className:"text-lg font-semibold",children:"Tipos de Embalagem Adicionais"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Adicione mltiplos tipos de embalagem com suas respectivas classificaes"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 border rounded-lg bg-muted/50",children:[s.jsxs("div",{className:"col-span-2",children:[s.jsx(ke,{children:"Tipo de Embalagem"}),s.jsxs(qs,{value:le.tipo_embalagem,onValueChange:Se=>ye({...le,tipo_embalagem:Se}),children:[s.jsx(Ls,{children:s.jsx(Ws,{})}),s.jsx(Fs,{children:Object.entries(qi).map(([Se,ze])=>s.jsx(xt,{value:Se,children:ze},Se))})]})]}),s.jsxs("div",{className:"col-span-2 flex items-center space-x-2",children:[s.jsx(fi,{checked:le.reciclavel,onCheckedChange:Se=>ye({...le,reciclavel:Se})}),s.jsx(ke,{children:"Reciclvel"})]}),s.jsxs("div",{className:"col-span-2 space-y-3",children:[s.jsxs(ke,{children:["Percentual de Reciclabilidade: ",le.percentual_reciclabilidade,"%"]}),s.jsx(hu,{min:0,max:100,step:5,value:[le.percentual_reciclabilidade],onValueChange:Se=>ye({...le,percentual_reciclabilidade:Se[0]})}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"h-3 w-full bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full transition-all duration-300 ${le.percentual_reciclabilidade>=80?"bg-green-500":le.percentual_reciclabilidade>=50?"bg-yellow-500":le.percentual_reciclabilidade>=25?"bg-orange-500":"bg-red-500"}`,style:{width:`${le.percentual_reciclabilidade}%`}})}),s.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[s.jsx("span",{children:"0%"}),s.jsx("span",{className:"font-medium",children:le.percentual_reciclabilidade>=80?" Excelente":le.percentual_reciclabilidade>=50?" Bom":le.percentual_reciclabilidade>=25?" Regular":" Baixo"}),s.jsx("span",{children:"100%"})]})]})]}),s.jsxs("div",{className:"col-span-2 space-y-2",children:[s.jsx(ke,{children:"Peso Mdio (kg)"}),s.jsx(We,{type:"number",step:"0.001",min:"0",value:le.peso_medio_gramas||"",onChange:Se=>ye({...le,peso_medio_gramas:Se.target.value?parseFloat(Se.target.value):null}),placeholder:"Ex: 0.150"})]}),s.jsx("div",{className:"col-span-2",children:s.jsxs(oe,{type:"button",onClick:ve,className:"w-full",variant:"outline",children:[s.jsx(ra,{className:"h-4 w-4 mr-2"}),"Adicionar Embalagem"]})})]}),Z.embalagens.length>0&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs(ke,{children:["Embalagens Adicionadas (",Z.embalagens.length,")"]}),s.jsx("div",{className:"space-y-2",children:Z.embalagens.map((Se,ze)=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-background",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium",children:qi[Se.tipo_embalagem]}),s.jsxs("div",{className:"text-sm text-muted-foreground",children:[Se.reciclavel?"Reciclvel":"No reciclvel","  ",Se.percentual_reciclabilidade,"%"]})]}),s.jsx(oe,{type:"button",variant:"ghost",size:"sm",onClick:()=>ne(ze),children:s.jsx(Jr,{className:"h-4 w-4"})})]},ze))})]})]})]}),s.jsxs(Ya,{children:[s.jsx(oe,{variant:"outline",onClick:()=>d(!1),children:"Cancelar"}),s.jsx(oe,{onClick:Me,disabled:T,children:T?"Salvando...":"Salvar"})]})]})}),s.jsx(ar,{open:x,onOpenChange:v,children:s.jsxs(tr,{className:"sm:max-w-md",children:[s.jsxs(nr,{children:[s.jsx(ir,{children:"Editar Peso Mdio"}),s.jsx(Vr,{children:_==null?void 0:_.descricao})]}),s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"peso_edicao",children:"Peso Mdio (kg)"}),s.jsx(We,{id:"peso_edicao",type:"number",step:"0.001",min:"0",value:(_==null?void 0:_.peso)||"",onChange:Se=>C(_?{..._,peso:Se.target.value?parseFloat(Se.target.value):null}:null),placeholder:"Ex: 0.250"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Peso mdio da embalagem vazia em quilos"})]})}),s.jsxs(Ya,{children:[s.jsx(oe,{variant:"outline",onClick:()=>v(!1),children:"Cancelar"}),s.jsx(oe,{onClick:fe,disabled:T,children:T?"Salvando...":"Salvar"})]})]})})]}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[s.jsxs(Ne,{children:[s.jsxs(Ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(Qe,{className:"text-sm font-medium",children:"Total de Produtos"}),s.jsx(fs,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsx(De,{children:s.jsx("div",{className:"text-2xl font-bold",children:W.total})})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(Qe,{className:"text-sm font-medium",children:"Reciclveis"}),s.jsx(Ur,{className:"h-4 w-4 text-green-500"})]}),s.jsxs(De,{children:[s.jsx("div",{className:"text-2xl font-bold",children:W.reciclaveis}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[W.total>0?Math.round(W.reciclaveis/W.total*100):0,"% do total"]})]})]}),s.jsxs(Ne,{children:[s.jsx(Ye,{className:"pb-2",children:s.jsx(Qe,{className:"text-sm font-medium",children:"Por Tipo"})}),s.jsxs(De,{className:"space-y-1",children:[s.jsxs("div",{className:"text-xs",children:["Plstico: ",W.plastico]}),s.jsxs("div",{className:"text-xs",children:["Vidro: ",W.vidro]}),s.jsxs("div",{className:"text-xs",children:["Papel: ",W.papel]}),s.jsxs("div",{className:"text-xs",children:["Papelo: ",W.papelao]})]})]}),s.jsxs(Ne,{children:[s.jsx(Ye,{className:"pb-2",children:s.jsx(Qe,{className:"text-sm font-medium",children:"Outros"})}),s.jsxs(De,{className:"space-y-1",children:[s.jsxs("div",{className:"text-xs",children:["Alumnio: ",W.aluminio]}),s.jsxs("div",{className:"text-xs",children:["Laminado: ",W.laminado]}),s.jsxs("div",{className:"text-xs",children:["Misto: ",W.misto]})]})]})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(Qe,{children:"Produtos Cadastrados"}),s.jsxs(Tt,{className:"mt-2",children:[a.length," de ",t.length," produto(s)"]})]}),s.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>D(!O),children:[s.jsx(Of,{className:"h-4 w-4 mr-2"}),"Filtros"]})]}),s.jsxs("div",{className:"space-y-4 mt-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(eo,{className:"h-4 w-4 text-muted-foreground"}),s.jsx(We,{placeholder:"Buscar por GTIN, NCM ou descrio...",value:i,onChange:Se=>o(Se.target.value),className:"max-w-sm"})]}),O&&s.jsxs("div",{className:"grid gap-4 p-4 border rounded-lg bg-muted/30",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{children:"Tipo de Embalagem"}),s.jsxs(qs,{value:F,onValueChange:M,children:[s.jsx(Ls,{children:s.jsx(Ws,{})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"all",children:"Todos os tipos"}),Object.entries(qi).map(([Se,ze])=>s.jsx(xt,{value:Se,children:ze},Se))]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{children:"Reciclvel"}),s.jsxs(qs,{value:z,onValueChange:q,children:[s.jsx(Ls,{children:s.jsx(Ws,{})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"all",children:"Todos"}),s.jsx(xt,{value:"yes",children:"Apenas reciclveis"}),s.jsx(xt,{value:"no",children:"Apenas no reciclveis"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{children:"Aes"}),s.jsxs(oe,{variant:"outline",className:"w-full",onClick:()=>{M("all"),q("all"),ae(0),H(100)},children:[s.jsx(Jr,{className:"h-4 w-4 mr-2"}),"Limpar Filtros"]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(ke,{children:["Faixa de Reciclabilidade: ",Y,"% - ",je,"%"]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx(ke,{className:"text-xs text-muted-foreground",children:"Mnimo"}),s.jsx(hu,{min:0,max:100,step:5,value:[Y],onValueChange:Se=>ae(Se[0])})]}),s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx(ke,{className:"text-xs text-muted-foreground",children:"Mximo"}),s.jsx(hu,{min:0,max:100,step:5,value:[je],onValueChange:Se=>H(Se[0])})]})]})]})]})]})]}),s.jsx(De,{children:a.length===0?s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:i?"Nenhum produto encontrado":"Nenhum produto cadastrado"}):s.jsx("div",{className:"rounded-md border",children:s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{className:"w-[130px]",children:"GTIN"}),s.jsx(rt,{children:"Descrio"}),s.jsx(rt,{className:"w-[100px]",children:"NCM"}),s.jsx(rt,{className:"w-[120px]",children:"Embalagem"}),s.jsx(rt,{className:"w-[100px]",children:"Peso Mdio"}),s.jsx(rt,{className:"w-[120px]",children:"Reciclvel"}),s.jsx(rt,{className:"w-[100px] text-center",children:"% Recic."}),s.jsx(rt,{className:"w-[120px] text-right",children:"Aes"})]})}),s.jsx(da,{children:a.map(Se=>s.jsxs(Cs,{children:[s.jsx(Ze,{className:"font-mono text-xs",children:Se.gtin}),s.jsx(Ze,{children:s.jsxs("div",{className:"max-w-md",children:[s.jsx("div",{className:"font-medium",children:Se.descricao}),Se.observacoes&&s.jsx("div",{className:"text-xs text-muted-foreground truncate mt-1",children:Se.observacoes})]})}),s.jsx(Ze,{className:"font-mono text-xs",children:Se.ncm}),s.jsx(Ze,{children:s.jsx(Je,{variant:"outline",children:qi[Se.tipo_embalagem]})}),s.jsx(Ze,{children:Se.peso_medio_gramas?`${Q(Se.peso_medio_gramas)} kg`:s.jsx("span",{className:"text-muted-foreground text-xs",children:"-"})}),s.jsx(Ze,{children:s.jsx(Je,{variant:Se.reciclavel?"default":"secondary",children:Se.reciclavel?"Sim":"No"})}),s.jsx(Ze,{className:"text-center",children:Se.reciclavel&&s.jsxs("span",{className:"font-medium",children:[Se.percentual_reciclabilidade,"%"]})}),s.jsx(Ze,{className:"text-right",children:s.jsxs("div",{className:"flex justify-end gap-1",children:[s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>me(Se),title:"Editar peso mdio",children:s.jsx(Zi,{className:"h-4 w-4"})}),s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>Ce(Se),children:s.jsx(Nd,{className:"h-4 w-4"})}),s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>Ie(Se.id),children:s.jsx(Ba,{className:"h-4 w-4 text-destructive"})})]})})]},Se.id))})]})})})]})]}),s.jsx(Zle,{open:h,onOpenChange:p,onSuccess:ce})]})})}function Jle(){var D;const[e,t]=E.useState([]),[r,a]=E.useState(!0),[n,i]=E.useState(!1),[o,c]=E.useState(!1),[d,h]=E.useState(!1),[p,x]=E.useState(null),v=ds(),{toast:b}=_r(),[N,_]=E.useState({gtin:"",ncm:"",descricao:"",tipo_embalagem:"plastico",reciclavel:!0,percentual_reciclabilidade:100,observacoes:""});E.useEffect(()=>{C()},[]);const C=async()=>{a(!0);try{const{data:F,error:M}=await J.from("notas_fiscais").select("itens_enriquecidos, data_envio, numero_nota").not("itens_enriquecidos","is",null);if(M)throw M;const z=new Map;F==null||F.forEach(Y=>{const ae=Y.itens_enriquecidos;Array.isArray(ae)&&ae.forEach(je=>{if(je.produto_cadastrado===!1&&je.gtin){const H=z.get(je.gtin);H?(H.frequencia++,je.nome&&H.descricoes.add(je.nome),Y.numero_nota&&H.exemplosNotas.add(Y.numero_nota),Y.data_envio&&Y.data_envio>H.ultimaOcorrencia&&(H.ultimaOcorrencia=Y.data_envio)):z.set(je.gtin,{gtin:je.gtin,descricoes:new Set(je.nome?[je.nome]:[]),frequencia:1,ultimaOcorrencia:Y.data_envio||new Date().toISOString(),exemplosNotas:new Set(Y.numero_nota?[Y.numero_nota]:[])})}})});const q=Array.from(z.values()).map(Y=>({gtin:Y.gtin,descricao:Array.from(Y.descricoes).join(" / ")||"Sem descrio",frequencia:Y.frequencia,ultimaOcorrencia:Y.ultimaOcorrencia,exemplosNotas:Array.from(Y.exemplosNotas).slice(0,3)})).sort((Y,ae)=>ae.frequencia-Y.frequencia);t(q)}catch(F){console.error("Erro ao carregar relatrio:",F),b({title:"Erro",description:"No foi possvel carregar o relatrio",variant:"destructive"})}finally{a(!1)}},T=F=>{x(F),_({gtin:F.gtin,ncm:"",descricao:F.descricao.split(" / ")[0],tipo_embalagem:"plastico",reciclavel:!0,percentual_reciclabilidade:100,observacoes:`Frequncia: ${F.frequencia}x
ltima ocorrncia: ${new Date(F.ultimaOcorrencia).toLocaleDateString()}`}),i(!0)},A=async()=>{if(!N.gtin||N.gtin.length<8){b({title:"GTIN invlido",description:"Digite um GTIN vlido (mnimo 8 dgitos)",variant:"destructive"});return}c(!0);try{const{data:F,error:M}=await J.functions.invoke("buscar-produto-gtin",{body:{gtin:N.gtin}});if(M)throw M;if(F.success&&F.data){const z=F.data;_(q=>({...q,descricao:z.descricao||q.descricao,ncm:z.ncm||q.ncm,observacoes:`${q.observacoes}

Marca: ${z.marca||"N/A"}
Categoria: ${z.categoria||"N/A"}
Fonte: ${F.source}`})),b({title:"Produto encontrado!",description:`Dados obtidos de ${F.source}. Revise e complete as informaes.`})}else b({title:"Produto no encontrado",description:F.message||"Preencha os dados manualmente",variant:"destructive"})}catch(F){console.error("Erro ao buscar produto:",F),b({title:"Erro na busca",description:F.message||"No foi possvel buscar o produto",variant:"destructive"})}finally{c(!1)}},k=async()=>{if(!N.gtin||!N.ncm||!N.descricao){b({title:"Campos obrigatrios",description:"Preencha GTIN, NCM e Descrio",variant:"destructive"});return}h(!0);try{const{error:F}=await J.from("produtos_ciclik").insert([{gtin:N.gtin,ncm:N.ncm,descricao:N.descricao,tipo_embalagem:N.tipo_embalagem,reciclavel:N.reciclavel,percentual_reciclabilidade:N.percentual_reciclabilidade,observacoes:N.observacoes}]);if(F)throw F;b({title:"Sucesso",description:"Produto cadastrado com sucesso"}),i(!1),C()}catch(F){console.error("Erro ao salvar produto:",F),b({title:"Erro",description:F.message||"No foi possvel salvar o produto",variant:"destructive"})}finally{h(!1)}},I=e.length,B=e.reduce((F,M)=>F+M.frequencia,0),O=e.slice(0,5);return s.jsx(Nc,{children:s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(Rd,{}),s.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>v("/admin/products"),className:"gap-2",children:[s.jsx(As,{className:"h-4 w-4"}),"Voltar"]}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Relatrio de Produtos No Cadastrados"}),s.jsx("p",{className:"text-muted-foreground",children:"Priorize cadastros baseado na frequncia nas notas fiscais"})]})]}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[s.jsxs(Ne,{children:[s.jsxs(Ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(Qe,{className:"text-sm font-medium",children:"Produtos nicos"}),s.jsx(un,{className:"h-4 w-4 text-yellow-500"})]}),s.jsxs(De,{children:[s.jsx("div",{className:"text-2xl font-bold",children:I}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Aguardando cadastro"})]})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(Qe,{className:"text-sm font-medium",children:"Total de Ocorrncias"}),s.jsx(Ir,{className:"h-4 w-4 text-orange-500"})]}),s.jsxs(De,{children:[s.jsx("div",{className:"text-2xl font-bold",children:B}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Nas notas fiscais"})]})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(Qe,{className:"text-sm font-medium",children:"Top Prioridade"}),s.jsx(fs,{className:"h-4 w-4 text-red-500"})]}),s.jsxs(De,{children:[s.jsxs("div",{className:"text-2xl font-bold",children:[((D=O[0])==null?void 0:D.frequencia)||0,"x"]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Produto mais frequente"})]})]})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Produtos No Cadastrados"}),s.jsx(Tt,{children:"Ordenados por frequncia de apario nas notas fiscais"})]}),s.jsx(De,{children:r?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(_s,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.length===0?s.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[s.jsx(fs,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"Nenhum produto no cadastrado encontrado"}),s.jsx("p",{className:"text-sm",children:"Todos os produtos das notas fiscais j esto cadastrados!"})]}):s.jsx("div",{className:"border rounded-lg overflow-hidden",children:s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{className:"w-[50px]",children:"#"}),s.jsx(rt,{children:"GTIN"}),s.jsx(rt,{children:"Descrio"}),s.jsx(rt,{className:"text-center",children:"Frequncia"}),s.jsx(rt,{children:"ltima Ocorrncia"}),s.jsx(rt,{children:"Exemplos de Notas"}),s.jsx(rt,{className:"text-right",children:"Aes"})]})}),s.jsx(da,{children:e.map((F,M)=>s.jsxs(Cs,{children:[s.jsx(Ze,{className:"font-medium",children:M+1}),s.jsx(Ze,{className:"font-mono text-sm",children:F.gtin}),s.jsx(Ze,{className:"max-w-xs truncate",children:F.descricao}),s.jsx(Ze,{className:"text-center",children:s.jsxs(Je,{variant:F.frequencia>=10?"destructive":F.frequencia>=5?"default":"secondary",children:[F.frequencia,"x"]})}),s.jsx(Ze,{className:"text-sm text-muted-foreground",children:new Date(F.ultimaOcorrencia).toLocaleDateString("pt-BR")}),s.jsx(Ze,{className:"text-xs text-muted-foreground",children:F.exemplosNotas.length>0?s.jsx("div",{className:"flex flex-wrap gap-1",children:F.exemplosNotas.map((z,q)=>s.jsx(Je,{variant:"outline",className:"text-xs",children:z},q))}):s.jsx("span",{children:"-"})}),s.jsx(Ze,{className:"text-right",children:s.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>T(F),children:[s.jsx(ra,{className:"h-4 w-4 mr-2"}),"Cadastrar"]})})]},F.gtin))})]})})})]})]}),s.jsx(ar,{open:n,onOpenChange:i,children:s.jsxs(tr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(nr,{children:[s.jsx(ir,{children:"Cadastrar Produto"}),s.jsx(Vr,{children:"Complete os dados do produto para cadastr-lo no sistema"})]}),s.jsxs("div",{className:"grid gap-4 py-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"gtin",children:"GTIN *"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(We,{id:"gtin",value:N.gtin,onChange:F=>_({...N,gtin:F.target.value}),placeholder:"7891234567890",disabled:!0,className:"flex-1"}),s.jsx(oe,{type:"button",variant:"outline",onClick:A,disabled:o,children:o?s.jsx(_s,{className:"h-4 w-4 animate-spin"}):s.jsx(eo,{className:"h-4 w-4"})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"ncm",children:"NCM *"}),s.jsx(We,{id:"ncm",value:N.ncm,onChange:F=>_({...N,ncm:F.target.value}),placeholder:"12345678",maxLength:8})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"descricao",children:"Descrio *"}),s.jsx(We,{id:"descricao",value:N.descricao,onChange:F=>_({...N,descricao:F.target.value}),placeholder:"Nome do produto"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"tipo_embalagem",children:"Tipo de Embalagem"}),s.jsxs(qs,{value:N.tipo_embalagem,onValueChange:F=>_({...N,tipo_embalagem:F}),children:[s.jsx(Ls,{children:s.jsx(Ws,{})}),s.jsx(Fs,{children:Object.entries(qi).map(([F,M])=>s.jsx(xt,{value:F,children:M},F))})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(fi,{id:"reciclavel",checked:N.reciclavel,onCheckedChange:F=>_({...N,reciclavel:F})}),s.jsx(ke,{htmlFor:"reciclavel",children:"Reciclvel"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(ke,{htmlFor:"percentual",children:["Percentual de Reciclabilidade: ",N.percentual_reciclabilidade,"%"]}),s.jsx(hu,{id:"percentual",min:0,max:100,step:5,value:[N.percentual_reciclabilidade],onValueChange:F=>_({...N,percentual_reciclabilidade:F[0]})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"observacoes",children:"Observaes"}),s.jsx(jn,{id:"observacoes",value:N.observacoes,onChange:F=>_({...N,observacoes:F.target.value}),placeholder:"Informaes adicionais",rows:4})]})]}),s.jsxs(Ya,{children:[s.jsx(oe,{variant:"outline",onClick:()=>i(!1),children:"Cancelar"}),s.jsx(oe,{onClick:k,disabled:d,children:d?s.jsxs(s.Fragment,{children:[s.jsx(_s,{className:"h-4 w-4 mr-2 animate-spin"}),"Salvando..."]}):"Cadastrar"})]})]})})]})})}const $n={URL:"https://ciclik-api-produtos.onrender.com",TOKEN:"ciclik_secret_token_2026",TIMEOUT_MS:3e4,MAX_RETRIES:1,RETRY_DELAY_MS:3e3,CACHE_DURATION_MS:24*60*60*1e3,CIRCUIT_BREAKER_THRESHOLD:3,CIRCUIT_BREAKER_TIMEOUT_MS:6e4};class ece{constructor(){um(this,"failures",0);um(this,"isOpen",!1);um(this,"openedAt",0)}reset(){this.failures=0,this.isOpen=!1,this.openedAt=0,console.log(" Circuit Breaker resetado")}recordSuccess(){this.failures>0&&console.log(` Sucesso aps ${this.failures} falhas - resetando contador`),this.failures=0}recordFailure(){this.failures++,console.warn(` Falha registrada (${this.failures}/${$n.CIRCUIT_BREAKER_THRESHOLD})`),this.failures>=$n.CIRCUIT_BREAKER_THRESHOLD&&(this.isOpen=!0,this.openedAt=Date.now(),console.error(" CIRCUIT BREAKER ATIVADO: API com muitas falhas consecutivas"))}canAttempt(){if(!this.isOpen)return{allowed:!0};const t=Date.now()-this.openedAt;return t>=$n.CIRCUIT_BREAKER_TIMEOUT_MS?(console.log(" Circuit Breaker: Tempo expirado, tentando reconectar..."),this.reset(),{allowed:!0}):{allowed:!1,waitTime:Math.ceil(($n.CIRCUIT_BREAKER_TIMEOUT_MS-t)/1e3)}}getStatus(){return{failures:this.failures,isOpen:this.isOpen,openedAt:this.openedAt}}}const Im=new ece;class tce{constructor(){um(this,"PREFIX","ciclik_api_cache_")}get(t){try{const r=localStorage.getItem(`${this.PREFIX}${t}`);if(!r)return null;const{data:a,timestamp:n}=JSON.parse(r),i=Date.now()-n;if(i>$n.CACHE_DURATION_MS)return localStorage.removeItem(`${this.PREFIX}${t}`),console.log(` Cache expirado para GTIN ${t}`),null;const o=Math.round(i/1e3/60);return console.log(` Cache HIT para GTIN ${t} (idade: ${o} min)`),a}catch(r){return console.warn(` Erro ao ler cache para GTIN ${t}:`,r),null}}set(t,r){try{localStorage.setItem(`${this.PREFIX}${t}`,JSON.stringify({data:r,timestamp:Date.now()})),console.log(` Dados salvos em cache para GTIN ${t}`)}catch(a){console.warn(" Falha ao salvar cache (localStorage cheio?):",a),this.cleanOldCache()}}clear(){try{const t=Object.keys(localStorage).filter(r=>r.startsWith(this.PREFIX));t.forEach(r=>localStorage.removeItem(r)),console.log(` Cache limpo: ${t.length} itens removidos`)}catch(t){console.warn(" Erro ao limpar cache:",t)}}cleanOldCache(){try{const t=Object.keys(localStorage).filter(n=>n.startsWith(this.PREFIX)),r=Date.now();let a=0;t.forEach(n=>{try{const i=localStorage.getItem(n);if(!i)return;const{timestamp:o}=JSON.parse(i);r-o>$n.CACHE_DURATION_MS&&(localStorage.removeItem(n),a++)}catch{localStorage.removeItem(n),a++}}),a>0&&console.log(` Limpeza automtica: ${a} caches antigos removidos`)}catch(t){console.warn(" Erro na limpeza automtica de cache:",t)}}getStats(){return{total:Object.keys(localStorage).filter(r=>r.startsWith(this.PREFIX)).length,sizeKB:new Blob([JSON.stringify(localStorage)]).size/1024}}}const dS=new tce;function sce(e){const t=e.replace(/[^0-9]/g,"");if(t.length===0)return{valido:!1,gtinNormalizado:"",erro:"GTIN vazio"};if(![8,12,13,14].includes(t.length))return{valido:!1,gtinNormalizado:"",erro:`GTIN invlido: ${t.length} dgitos (esperado: 8, 12, 13 ou 14)`};let r=t;return t.length===12&&(r="0"+t,console.log(` Convertendo UPC para EAN-13: ${t}  ${r}`)),{valido:!0,gtinNormalizado:r}}async function rce(e){if(!e||e.startsWith("SEM_GTIN_")||e==="SEM GTIN")return{ean_gtin:e,encontrado:!1,mensagem:"Produto sem cdigo GTIN vlido - consulta impossvel"};const t=sce(e);if(!t.valido)return{ean_gtin:e,encontrado:!1,mensagem:t.erro||"GTIN invlido"};const r=t.gtinNormalizado,a=dS.get(r);if(a)return a;const n=Im.canAttempt();if(!n.allowed)return{ean_gtin:r,encontrado:!1,mensagem:` API temporariamente indisponvel (muitas falhas consecutivas). Aguarde ${n.waitTime}s e tente novamente.`};const i=await ace(r);return i.encontrado!==void 0&&dS.set(r,i),i}async function ace(e){let t;for(let r=1;r<=$n.MAX_RETRIES+1;r++)try{console.log(` Tentativa ${r}/${$n.MAX_RETRIES+1} - GTIN: ${e}`);const a=new AbortController,n=setTimeout(()=>a.abort(),$n.TIMEOUT_MS),i=await fetch(`${$n.URL}/api/produtos/${e}`,{method:"GET",headers:{Authorization:`Bearer ${$n.TOKEN}`,"Content-Type":"application/json",Accept:"application/json"},signal:a.signal});if(clearTimeout(n),!i.ok){if(i.status===404)return Im.recordSuccess(),{ean_gtin:e,encontrado:!1,mensagem:"Produto no encontrado na base de dados"};if(i.status===401)throw Im.recordFailure(),new Error("Token de autenticao invlido");if(i.status===400)return{ean_gtin:e,encontrado:!1,mensagem:"GTIN invlido"};throw i.status>=500?new Error(`Erro no servidor da API: ${i.status}`):new Error(`Erro HTTP ${i.status}`)}const o=await i.json();return console.log(` Sucesso - GTIN: ${e}`,o.encontrado?"(encontrado)":"(no encontrado)"),Im.recordSuccess(),{ean_gtin:o.ean_gtin||e,descricao:o.descricao||void 0,marca:o.marca||void 0,fabricante:o.fabricante||void 0,ncm:o.ncm||void 0,ncm_descricao:o.ncm_completo?o.ncm_completo.split(" - ")[1]:void 0,preco_medio:o.preco_medio||void 0,peso_liquido:o.peso_liquido_em_gramas||void 0,peso_bruto:o.peso_bruto_em_gramas||void 0,categoria_api:o.categoria_api||void 0,imagem_url:o.imagem_url||void 0,encontrado:o.encontrado,mensagem:o.mensagem||(o.encontrado?"Produto encontrado":"Produto no encontrado")}}catch(a){if(t=a,a.name==="AbortError"&&(console.warn(` Timeout na tentativa ${r}`),r<=$n.MAX_RETRIES)){await uS($n.RETRY_DELAY_MS);continue}if(a.message&&(a.message.includes("fetch")||a.message.includes("network")||a.message.includes("ERR_CONNECTION")||a.message.includes("Failed to fetch"))&&(console.warn(` Erro de rede na tentativa ${r}:`,a.message),r<=$n.MAX_RETRIES)){await uS($n.RETRY_DELAY_MS);continue}break}return Im.recordFailure(),t.name==="AbortError"?{ean_gtin:e,encontrado:!1,mensagem:` Timeout: API no respondeu em ${$n.TIMEOUT_MS/1e3}s`}:t.message&&(t.message.includes("fetch")||t.message.includes("network")||t.message.includes("ERR_CONNECTION")||t.message.includes("Failed to fetch"))?{ean_gtin:e,encontrado:!1,mensagem:" API temporariamente indisponvel (erro de conexo)"}:{ean_gtin:e,encontrado:!1,mensagem:` Erro: ${t.message||"Desconhecido"}`}}function uS(e){return new Promise(t=>setTimeout(t,e))}function hS(e){const t=`${e.categoria_api||""} ${e.descricao||""}`.toLowerCase();return t.includes("vidro")||t.includes("garrafa")&&(t.includes("cerveja")||t.includes("vinho")||t.includes("suco"))?"vidro":t.includes("lata")||t.includes("alumnio")||t.includes("aluminio")?"aluminio":t.includes("caixa")||t.includes("tetra pak")||t.includes("embalagem longa vida")?"papel":t.includes("papelo")||t.includes("papelao")||t.includes("caixa de papelo")?"papelao":t.includes("salgadinho")||t.includes("biscoito")||t.includes("caf")||t.includes("snack")||t.includes("chips")?"laminado":"plastico"}function h2(e){switch(e){case"aluminio":return{reciclavel:!0,percentual:100};case"vidro":return{reciclavel:!0,percentual:100};case"plastico":return{reciclavel:!0,percentual:85};case"papel":return{reciclavel:!0,percentual:90};case"papelao":return{reciclavel:!0,percentual:95};case"laminado":return{reciclavel:!1,percentual:20};case"misto":return{reciclavel:!1,percentual:30};default:return{reciclavel:!0,percentual:70}}}function nce(e){return e.peso_liquido||e.peso_bruto||void 0}function ice(e){return h2(e).reciclavel}function oce(e){return h2(e).percentual}function lce(e){if(!e)return"";const t=e.match(/^(\d{8})/);return t?t[1]:""}function cce(){const[e,t]=E.useState([]),[r,a]=E.useState(!0),[n,i]=E.useState(""),[o,c]=E.useState("all"),[d,h]=E.useState("all"),[p,x]=E.useState(null),[v,b]=E.useState(!1),[N,_]=E.useState(null),[C,T]=E.useState(""),[A,k]=E.useState(!1),[I,B]=E.useState(null),[O,D]=E.useState({gtin:"",ncm:"",descricao:"",tipo_embalagem:"plastico",reciclavel:!0,percentual_reciclabilidade:100,peso_medio_gramas:null,observacoes:""}),[F,M]=E.useState(!1),[z,q]=E.useState(!1),[Y,ae]=E.useState(null),[je,H]=E.useState(!1),[Z,G]=E.useState(new Set),[Q,re]=E.useState(!1),[le,ye]=E.useState(!1),[W,ee]=E.useState(0),[ie,ce]=E.useState(null),[xe,Ce]=E.useState(!1),[me,fe]=E.useState(null),[ve,ne]=E.useState(0),Me=ds(),{toast:Ie}=_r();E.useEffect(()=>{Be(),ot()},[]);const Be=async()=>{a(!0);try{const{data:Oe,error:Xe}=await J.from("produtos_em_analise").select("*").order("origem",{ascending:!1}).order("data_ultima_deteccao",{ascending:!1});if(Xe)throw Xe;t(Oe||[])}catch(Oe){console.error("Erro ao carregar produtos:",Oe),Ie({title:"Erro ao carregar",description:"No foi possvel carregar os produtos em anlise.",variant:"destructive"})}finally{a(!1)}},ot=async()=>{try{const{data:Oe,error:Xe}=await J.rpc("contar_consultas_hoje");if(Xe){console.error("Erro ao carregar contador de consultas:",Xe);return}ne(Oe||0)}catch(Oe){console.error("Erro ao carregar contador de consultas:",Oe)}},Se=async(Oe,Xe,zt)=>{M(!0);try{const qt={status:Xe,updated_at:new Date().toISOString()};zt&&(qt.observacoes=zt);const{error:St}=await J.from("produtos_em_analise").update(qt).eq("id",Oe);if(St)throw St;Ie({title:"Status atualizado!",description:`Produto marcado como ${Xe}.`}),await Be(),b(!1),x(null),T("")}catch(qt){console.error("Erro ao atualizar status:",qt),Ie({title:"Erro",description:"No foi possvel atualizar o status do produto.",variant:"destructive"})}finally{M(!1)}},ze=Oe=>{if(Oe.dados_api&&Oe.status==="consultado"){It(Oe);return}B(Oe),D({gtin:Oe.ean_gtin,ncm:"",descricao:Oe.descricao,tipo_embalagem:"plastico",reciclavel:!0,percentual_reciclabilidade:100,peso_medio_gramas:null,observacoes:""}),k(!0)},we=async()=>{var Oe,Xe,zt;if(I){M(!0);try{if(!O.gtin||!O.ncm||!O.descricao){Ie({title:"Campos obrigatrios",description:"Preencha GTIN, NCM e Descrio.",variant:"destructive"}),M(!1);return}const{data:qt,error:St}=await J.from("produtos_ciclik").insert({gtin:O.gtin,ncm:O.ncm,descricao:O.descricao,marca:((Oe=I==null?void 0:I.dados_api)==null?void 0:Oe.marca)||null,categoria_api:((Xe=I==null?void 0:I.dados_api)==null?void 0:Xe.categoria_api)||null,tipo_embalagem:O.tipo_embalagem,reciclavel:O.reciclavel,percentual_reciclabilidade:O.percentual_reciclabilidade,peso_medio_gramas:O.peso_medio_gramas,observacoes:O.observacoes||null,imagem_url:((zt=I==null?void 0:I.dados_api)==null?void 0:zt.imagem_url)||null}).select("id, gtin, descricao, ncm").single();if(St)throw St;const{error:ls}=await J.from("produtos_em_analise").update({status:"aprovado",updated_at:new Date().toISOString()}).eq("id",I.id);if(ls)throw ls;Ie({title:"Produto cadastrado!",description:`${O.descricao} foi adicionado ao catlogo.`}),await Be(),k(!1),B(null),D({gtin:"",ncm:"",descricao:"",tipo_embalagem:"plastico",reciclavel:!0,percentual_reciclabilidade:100,peso_medio_gramas:null,observacoes:""})}catch(qt){console.error("Erro ao cadastrar produto:",qt),Ie({title:"Erro ao cadastrar",description:qt.message||"No foi possvel cadastrar o produto.",variant:"destructive"})}finally{M(!1)}}},Le=()=>{const Oe=`ean_gtin,descricao
7891234567890,Garrafa PET 2L
7891234567891,Lata de Alumnio 350ml
7891234567892,Caixa de Papelo
7891234567893,Garrafa de Vidro 1L
7891234567894,Embalagem Tetra Pak 1L`,Xe=new Blob([Oe],{type:"text/csv;charset=utf-8;"}),zt=document.createElement("a"),qt=URL.createObjectURL(Xe);zt.setAttribute("href",qt),zt.setAttribute("download","template_produtos_em_analise.csv"),zt.style.visibility="hidden",document.body.appendChild(zt),zt.click(),document.body.removeChild(zt),Ie({title:"Template baixado!",description:"Use este arquivo como modelo para registrar produtos em anlise."})},Nt=Oe=>{var zt;const Xe=(zt=Oe.target.files)==null?void 0:zt[0];if(Xe){if(!Xe.name.endsWith(".csv")){Ie({title:"Formato invlido",description:"Por favor, selecione um arquivo CSV.",variant:"destructive"});return}ae(Xe)}},Ge=async()=>{if(!Y){Ie({title:"Nenhum arquivo",description:"Selecione um arquivo CSV primeiro.",variant:"destructive"});return}H(!0);try{const zt=(await Y.text()).split(`
`).filter(Gt=>Gt.trim()).slice(1);if(zt.length===0)throw new Error("Arquivo CSV vazio ou sem dados.");const qt=[],St=[],ls=new Set;for(let Gt=0;Gt<zt.length;Gt++){const pe=zt[Gt].split(",").map(Te=>Te.trim());if(pe.length<2){St.push(`Linha ${Gt+2}: Dados insuficientes (necessrio EAN e Descrio)`);continue}const[ge,be]=pe;if(!ge||!be){St.push(`Linha ${Gt+2}: EAN/GTIN e Descrio so obrigatrios`);continue}if(ls.has(ge)){St.push(`Linha ${Gt+2}: EAN/GTIN "${ge}" duplicado no arquivo (j existe em linha anterior)`);continue}ls.add(ge),qt.push({ean_gtin:ge,descricao:be,origem:"manual",status:"pendente",quantidade_ocorrencias:1,data_primeira_deteccao:new Date().toISOString(),data_ultima_deteccao:new Date().toISOString()})}if(qt.length===0)throw new Error("Nenhum produto vlido encontrado no CSV.");const is=qt.map(Gt=>Gt.ean_gtin),{data:ws,error:Bs}=await J.from("produtos_em_analise").select("ean_gtin").in("ean_gtin",is).in("status",["pendente","em_analise"]);Bs&&console.error("Erro ao verificar duplicatas:",Bs);const js=new Set((ws==null?void 0:ws.map(Gt=>Gt.ean_gtin))||[]),ha=qt.filter(Gt=>js.has(Gt.ean_gtin)?(St.push(`EAN/GTIN "${Gt.ean_gtin}" j est pendente de anlise no sistema`),!1):!0);if(ha.length===0)throw new Error("Todos os produtos do CSV j esto registrados como pendentes de anlise.");const{data:$r,error:_a}=await J.from("produtos_em_analise").insert(ha).select();if(_a)throw _a;const Or=ha.length===qt.length?`${ha.length} produto(s) adicionado(s) para anlise!`:`${ha.length} de ${qt.length} produto(s) adicionado(s)`;Ie({title:"Upload concludo!",description:`${Or}${St.length>0?` (${St.length} ignorado(s) por duplicao ou erro)`:""}`}),St.length>0&&(console.warn("Produtos no processados:",St),Ie({title:"Alguns produtos no foram adicionados",description:`${St.length} produto(s) ignorado(s) por duplicao ou erro. Veja os detalhes no console.`,variant:"destructive"})),q(!1),ae(null),await Be()}catch(Oe){console.error("Erro ao processar CSV:",Oe),Ie({title:"Erro no upload",description:Oe.message||"No foi possvel processar o arquivo CSV.",variant:"destructive"})}finally{H(!1)}},Lt=Oe=>{const Xe=new Set(Z);Xe.has(Oe)?Xe.delete(Oe):Xe.add(Oe),G(Xe)},ps=()=>{const Oe=_t.filter(Xe=>Xe.status==="pendente"||Xe.status==="acao_manual");Z.size===Oe.length?G(new Set):G(new Set(Oe.map(Xe=>Xe.id)))},ns=()=>{if(Z.size===0){Ie({title:"Nenhum produto selecionado",description:"Selecione pelo menos um produto para consultar.",variant:"destructive"});return}if(ve>=100){Ie({title:"Limite de consultas atingido",description:"Voc j realizou 100 consultas hoje. Tente novamente amanh.",variant:"destructive"});return}re(!0)},Ke=async()=>{re(!1),ye(!0),ee(0);const Oe={autoCadastrados:[],precisamRevisao:[],naoEncontrados:[],erros:[]},Xe=Array.from(Z),zt=Xe.length;let qt=0;try{for(let St=0;St<Xe.length;St++){if(ve+qt>=100){Ie({title:"Limite dirio atingido",description:`Processadas ${qt} consultas. Limite de 100/dia atingido.`,variant:"destructive"});break}const is=Xe[St];try{const ws=e.find(pe=>pe.id===is);if(!ws)continue;St>0&&(console.log(" Aguardando 2s antes da prxima consulta..."),await new Promise(pe=>setTimeout(pe,2e3))),console.log(` Iniciando consulta ${St+1}/${zt} - GTIN: ${ws.ean_gtin}`);const Bs=Date.now(),js=await rce(ws.ean_gtin),ha=Date.now()-Bs;console.log(` Consulta concluda em ${(ha/1e3).toFixed(2)}s`);let $r=!1;try{const{data:{user:pe}}=await J.auth.getUser();if(pe){const{error:ge}=await J.from("log_consultas_api").insert({admin_id:pe.id,produto_id:is,ean_gtin:ws.ean_gtin,sucesso:js.encontrado,tempo_resposta_ms:ha,resposta_api:js,erro_mensagem:js.encontrado?null:js.mensagem});if(ge){if(console.error("Erro ao registrar consulta:",ge),ge.message.includes("Limite dirio")){Ie({title:"Limite dirio atingido",description:`Processadas ${qt} consultas. O banco de dados bloqueou novas consultas.`,variant:"destructive"});break}throw ge}$r=!0,qt++,ne(be=>be+1)}}catch(pe){if(console.error("Erro ao registrar consulta no log:",pe),pe instanceof Error&&pe.message.includes("Limite"))break}if(!$r){console.warn(" Consulta no registrada - produto permanece pendente:",is);continue}const _a=hS(js),Or=nce(js),Gt={ean_gtin:js.ean_gtin,descricao:js.descricao,marca:js.marca,fabricante:js.fabricante,ncm:js.ncm,ncm_descricao:js.ncm_descricao,preco_medio:js.preco_medio,peso_liquido:js.peso_liquido,peso_bruto:js.peso_bruto,peso_medio_gramas:Or,categoria_api:js.categoria_api,imagem_url:js.imagem_url,tipo_embalagem:_a,reciclavel:ice(_a),percentual_reciclabilidade:oce(_a),encontrado:js.encontrado,mensagem:js.mensagem},{error:de}=await J.from("produtos_em_analise").update({dados_api:Gt,consultado_em:new Date().toISOString(),status:"consultado",updated_at:new Date().toISOString()}).eq("id",is);if(de)throw console.error(" Erro ao atualizar produto na base:",de),console.error(" Produto ID:",is),console.error(" GTIN:",ws.ean_gtin),new Error(`Falha ao salvar dados da API: ${de.message}`);console.log(" Produto atualizado com sucesso:",is),dce(js)?Oe.autoCadastrados.push(ws.descricao):js.encontrado?Oe.precisamRevisao.push(ws.descricao):Oe.naoEncontrados.push(ws.descricao)}catch(ws){Oe.erros.push({id:is,erro:ws.message})}ee((St+1)/zt*100)}ce(Oe),Ie({title:" Consulta concluda!",description:`${Oe.autoCadastrados.length} cadastrados, ${Oe.precisamRevisao.length} precisam reviso`}),G(new Set),await Be()}catch(St){Ie({title:"Erro na consulta",description:St.message,variant:"destructive"})}finally{ye(!1),ee(0)}},dt=Oe=>{fe(Oe),Ce(!0)},It=Oe=>{if(!Oe.dados_api)return;const Xe=Oe.dados_api,zt=Xe.tipo_embalagem||hS(Xe),{reciclavel:qt,percentual:St}=h2(zt),ls=lce(Xe.ncm),is=[Xe.marca?`Marca: ${Xe.marca}`:null,Xe.categoria_api?`Categoria: ${Xe.categoria_api}`:null,Xe.preco_medio?`Preo mdio: R$ ${Xe.preco_medio.toFixed(2)}`:null].filter(Boolean).join(" | ");D({gtin:Xe.ean_gtin||Oe.ean_gtin,ncm:ls,descricao:Xe.descricao||Oe.descricao,tipo_embalagem:zt,reciclavel:Xe.reciclavel??qt,percentual_reciclabilidade:Xe.percentual_reciclabilidade||St,peso_medio_gramas:Xe.peso_medio_gramas||Xe.peso_liquido||Xe.peso_bruto||null,observacoes:Xe.observacoes||is}),B(Oe),Ce(!1),k(!0),Ie({title:" Dados carregados com inteligncia!",description:`NCM: ${ls} | Embalagem: ${qi[zt]} | Reciclabilidade: ${St}%`})},Ut=(Oe,Xe)=>{x(Oe),_(Xe),T(Oe.observacoes||""),b(!0)},ts=async Oe=>{if(Oe.status!=="consultado"){Ie({title:"Ao invlida",description:"Apenas produtos consultados podem ser revertidos.",variant:"destructive"});return}M(!0);try{const{error:Xe}=await J.from("produtos_em_analise").update({status:"pendente",dados_api:null,consultado_em:null,updated_at:new Date().toISOString()}).eq("id",Oe.id);if(Xe)throw Xe;Ie({title:" Status revertido!",description:`Produto ${Oe.ean_gtin} voltou para PENDENTE. Voc pode consult-lo novamente.`}),await Be()}catch(Xe){console.error("Erro ao reverter status:",Xe),Ie({title:"Erro ao reverter",description:Xe.message||"No foi possvel reverter o status do produto.",variant:"destructive"})}finally{M(!1)}},us=Oe=>{if(Oe.origem!=="qrcode")return null;const Xe=a_(new Date,new Date(Oe.data_primeira_deteccao)),zt=72-Xe;return{horasDecorridas:Xe,horasRestantes:Math.max(0,zt),percentualDecorrido:Math.min(100,Xe/72*100),isVencido:Xe>72,isCritico:zt<=12&&zt>0,isAlerta:zt>12&&zt<=24,isAtencao:zt>24&&zt<=48}},qe=Oe=>{const Xe=us(Oe);return Xe?Xe.isVencido?s.jsxs(Je,{variant:"outline",className:"bg-red-100 text-red-800 border-red-300 font-semibold animate-pulse",children:[s.jsx(un,{className:"h-3 w-3 mr-1"}),"VENCIDO h ",Math.floor(Xe.horasDecorridas-72),"h"]}):Xe.isCritico?s.jsxs(Je,{variant:"outline",className:"bg-red-50 text-red-700 border-red-300 font-semibold",children:[s.jsx(Gn,{className:"h-3 w-3 mr-1"}),"CRTICO - ",Math.floor(Xe.horasRestantes),"h restantes"]}):Xe.isAlerta?s.jsxs(Je,{variant:"outline",className:"bg-orange-50 text-orange-700 border-orange-300 font-semibold",children:[s.jsx(Gn,{className:"h-3 w-3 mr-1"}),"URGENTE - ",Math.floor(Xe.horasRestantes),"h restantes"]}):Xe.isAtencao?s.jsxs(Je,{variant:"outline",className:"bg-yellow-50 text-yellow-700 border-yellow-300",children:[s.jsx(Gn,{className:"h-3 w-3 mr-1"}),Math.floor(Xe.horasRestantes),"h restantes"]}):s.jsxs(Je,{variant:"outline",className:"bg-green-50 text-green-700 border-green-300",children:[s.jsx(Gn,{className:"h-3 w-3 mr-1"}),Math.floor(Xe.horasRestantes),"h restantes"]}):null},jt=Oe=>{const Xe=us(Oe);return Xe?Xe.isVencido?"bg-red-50 border-l-4 border-l-red-500":Xe.isCritico?"bg-red-25 border-l-4 border-l-red-400":Xe.isAlerta?"bg-orange-25 border-l-4 border-l-orange-400":Xe.isAtencao?"bg-yellow-25 border-l-4 border-l-yellow-400":"":""},_t=e.filter(Oe=>Oe.status==="pendente"||Oe.status==="acao_manual"||Oe.status==="consultado").filter(Oe=>{var St,ls;const Xe=Oe.ean_gtin.toLowerCase().includes(n.toLowerCase())||Oe.descricao.toLowerCase().includes(n.toLowerCase()),zt=o==="all"||Oe.origem===o;let qt=!0;return d==="encontrados"?qt=Oe.status==="consultado"&&((St=Oe.dados_api)==null?void 0:St.encontrado)===!0:d==="nao_encontrados"?qt=Oe.status==="consultado"&&((ls=Oe.dados_api)==null?void 0:ls.encontrado)===!1:d==="nao_consultados"&&(qt=Oe.status!=="consultado"),Xe&&zt&&qt}),Re=e.filter(Oe=>Oe.status==="pendente"||Oe.status==="acao_manual"),et=e.filter(Oe=>Oe.status==="consultado"),Ct=et.filter(Oe=>{var Xe;return((Xe=Oe.dados_api)==null?void 0:Xe.encontrado)===!0}),Yt=et.filter(Oe=>{var Xe;return((Xe=Oe.dados_api)==null?void 0:Xe.encontrado)===!1}),bt={total:Re.length,pendentes:Re.filter(Oe=>Oe.status==="pendente").length,acaoManual:Re.filter(Oe=>Oe.status==="acao_manual").length,qrcode:Re.filter(Oe=>Oe.origem==="qrcode").length,manual:Re.filter(Oe=>Oe.origem==="manual").length,consultados:et.length,encontradosAPI:Ct.length,naoEncontradosAPI:Yt.length,vencidos:Re.filter(Oe=>{const Xe=us(Oe);return Xe==null?void 0:Xe.isVencido}).length,criticos:Re.filter(Oe=>{const Xe=us(Oe);return Xe==null?void 0:Xe.isCritico}).length,urgentes:Re.filter(Oe=>{const Xe=us(Oe);return Xe==null?void 0:Xe.isAlerta}).length},Dt=Oe=>{const Xe={pendente:{variant:"outline",label:"Pendente",className:"bg-yellow-50 text-yellow-700 border-yellow-200"},em_analise:{variant:"outline",label:"Em Anlise",className:"bg-blue-50 text-blue-700 border-blue-200"},aprovado:{variant:"outline",label:"Aprovado",className:"bg-green-50 text-green-700 border-green-200"},rejeitado:{variant:"outline",label:"Rejeitado",className:"bg-red-50 text-red-700 border-red-200"},acao_manual:{variant:"outline",label:"Ao Manual",className:"bg-orange-50 text-orange-700 border-orange-200"},consultado:{variant:"outline",label:"Consultado",className:"bg-cyan-50 text-cyan-700 border-cyan-200"}},zt=Xe[Oe]||Xe.pendente;return s.jsx(Je,{variant:zt.variant,className:zt.className,children:zt.label})},Jt=Oe=>Oe==="qrcode"?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(Je,{variant:"outline",className:"bg-purple-50 text-purple-700 border-purple-200",children:[s.jsx(Da,{className:"h-3 w-3 mr-1"}),"QR Code"]}),s.jsx("div",{title:"Prioridade Mxima",children:s.jsx(sp,{className:"h-4 w-4 text-amber-500 fill-amber-500"})})]}):s.jsxs(Je,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:[s.jsx(Nd,{className:"h-3 w-3 mr-1"}),"Manual"]});return s.jsxs("div",{className:"container mx-auto p-6 max-w-[1600px]",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs(oe,{variant:"ghost",onClick:()=>Me("/admin/products"),className:"mb-4",children:[s.jsx(As,{className:"h-4 w-4 mr-2"}),"Voltar para Produtos"]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Produtos em Anlise"}),s.jsx("p",{className:"text-muted-foreground mt-1",children:"Produtos no cadastrados detectados durante upload de notas fiscais"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(oe,{variant:"outline",onClick:Le,children:[s.jsx(Ua,{className:"h-4 w-4 mr-2"}),"Baixar Template CSV"]}),s.jsxs(oe,{variant:"outline",onClick:ns,disabled:Z.size===0||ve>=100,className:"relative",children:[s.jsx(Kn,{className:"h-4 w-4 mr-2"}),"Consultar API",Z.size>0&&s.jsx(Je,{className:"ml-2 bg-blue-600",children:Z.size})]}),s.jsxs(oe,{variant:"default",onClick:()=>q(!0),children:[s.jsx(wd,{className:"h-4 w-4 mr-2"}),"Upload em Massa"]})]})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-2 text-sm text-muted-foreground",children:[s.jsxs(Je,{variant:ve>=100?"destructive":"outline",children:[ve,"/100 consultas hoje"]}),ve>=100&&s.jsx("span",{className:"text-red-600",children:"Limite dirio atingido"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-7 gap-3 mb-6",children:[s.jsx(Ne,{className:"col-span-1",children:s.jsx(De,{className:"pt-4 pb-4",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Total"}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-xl font-bold",children:bt.total}),s.jsx(fs,{className:"h-5 w-5 text-muted-foreground"})]})]})})}),s.jsx(Ne,{className:"col-span-1",children:s.jsx(De,{className:"pt-4 pb-4",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Pendentes"}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-xl font-bold text-yellow-600",children:bt.pendentes}),s.jsx(Kr,{className:"h-5 w-5 text-yellow-600"})]})]})})}),bt.vencidos>0&&s.jsx(Ne,{className:"col-span-1 border-red-300 bg-red-50",children:s.jsx(De,{className:"pt-4 pb-4",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("p",{className:"text-xs text-red-700 font-medium mb-1",children:"Vencidos (>72h)"}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-xl font-bold text-red-700",children:bt.vencidos}),s.jsx(un,{className:"h-5 w-5 text-red-700 animate-pulse"})]})]})})}),bt.criticos>0&&s.jsx(Ne,{className:"col-span-1 border-red-200 bg-red-25",children:s.jsx(De,{className:"pt-4 pb-4",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("p",{className:"text-xs text-red-600 font-medium mb-1",children:"Crticos (<12h)"}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-xl font-bold text-red-600",children:bt.criticos}),s.jsx(Gn,{className:"h-5 w-5 text-red-600"})]})]})})}),bt.urgentes>0&&s.jsx(Ne,{className:"col-span-1 border-orange-200 bg-orange-25",children:s.jsx(De,{className:"pt-4 pb-4",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("p",{className:"text-xs text-orange-600 font-medium mb-1",children:"Urgentes (<24h)"}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-xl font-bold text-orange-600",children:bt.urgentes}),s.jsx(Gn,{className:"h-5 w-5 text-orange-600"})]})]})})}),s.jsx(Ne,{className:"col-span-1",children:s.jsx(De,{className:"pt-4 pb-4",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Via QR Code"}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-xl font-bold text-purple-600",children:bt.qrcode}),s.jsx(Da,{className:"h-5 w-5 text-purple-600"})]})]})})}),s.jsx(Ne,{className:"col-span-1",children:s.jsx(De,{className:"pt-4 pb-4",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Manual"}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-xl font-bold text-gray-600",children:bt.manual}),s.jsx(Nd,{className:"h-5 w-5 text-gray-600"})]})]})})}),bt.acaoManual>0&&s.jsx(Ne,{className:"col-span-1 border-orange-200 bg-orange-25",children:s.jsx(De,{className:"pt-4 pb-4",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("p",{className:"text-xs text-orange-600 font-medium mb-1",children:"Ao Manual"}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-xl font-bold text-orange-600",children:bt.acaoManual}),s.jsx(un,{className:"h-5 w-5 text-orange-600"})]}),s.jsx("p",{className:"text-[10px] text-orange-600/70 mt-1",children:"Sem GTIN vlido"})]})})}),bt.encontradosAPI>0&&s.jsx(Ne,{className:"col-span-1 border-green-200 bg-green-50",children:s.jsx(De,{className:"pt-4 pb-4",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("p",{className:"text-xs text-green-700 font-medium mb-1",children:"Encontrados na API"}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-xl font-bold text-green-700",children:bt.encontradosAPI}),s.jsx(_n,{className:"h-5 w-5 text-green-700"})]}),s.jsx("p",{className:"text-[10px] text-green-700/70 mt-1",children:"Com dados completos"})]})})}),bt.consultados>0&&s.jsx(Ne,{className:"col-span-1 border-cyan-200 bg-cyan-50",children:s.jsx(De,{className:"pt-4 pb-4",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("p",{className:"text-xs text-cyan-700 font-medium mb-1",children:"Consultados"}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-xl font-bold text-cyan-700",children:bt.consultados}),s.jsx(tp,{className:"h-5 w-5 text-cyan-700"})]}),s.jsxs("p",{className:"text-[10px] text-cyan-700/70 mt-1",children:[bt.encontradosAPI," encontrados, ",bt.naoEncontradosAPI," no encontrados"]})]})})})]}),s.jsx(Ne,{className:"mb-6",children:s.jsx(De,{className:"pt-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(ke,{className:"mb-2",children:"Buscar"}),s.jsxs("div",{className:"relative",children:[s.jsx(eo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),s.jsx(We,{placeholder:"EAN ou descrio...",value:n,onChange:Oe=>i(Oe.target.value),className:"pl-10"})]})]}),s.jsxs("div",{children:[s.jsx(ke,{className:"mb-2",children:"Origem"}),s.jsxs(qs,{value:o,onValueChange:c,children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Todas"})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"all",children:"Todas"}),s.jsx(xt,{value:"qrcode",children:"QR Code"}),s.jsx(xt,{value:"manual",children:"Manual"})]})]})]}),s.jsxs("div",{children:[s.jsx(ke,{className:"mb-2",children:"Status API"}),s.jsxs(qs,{value:d,onValueChange:h,children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Todos"})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"all",children:"Todos"}),s.jsx(xt,{value:"encontrados",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(_n,{className:"h-4 w-4 text-green-600"}),"Encontrados na API"]})}),s.jsx(xt,{value:"nao_encontrados",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Jr,{className:"h-4 w-4 text-red-600"}),"No Encontrados"]})}),s.jsx(xt,{value:"nao_consultados",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Kr,{className:"h-4 w-4 text-gray-600"}),"No Consultados"]})})]})]})]})]})})}),s.jsxs(Ne,{children:[s.jsxs(Ye,{className:"pb-3",children:[s.jsxs(Qe,{children:["Lista de Produtos (",_t.length,")"]}),s.jsx(Tt,{children:"Produtos detectados que ainda no esto cadastrados no sistema"})]}),s.jsx(De,{className:"px-0",children:r?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(_s,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):_t.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(fs,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Nenhum produto encontrado"})]}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{className:"w-[50px]",children:s.jsx(Ef,{checked:Z.size>0&&Z.size===_t.filter(Oe=>Oe.status==="pendente"||Oe.status==="acao_manual").length,onCheckedChange:ps})}),s.jsx(rt,{className:"w-[130px]",children:"EAN/GTIN"}),s.jsx(rt,{className:"min-w-[250px]",children:"Descrio"}),s.jsx(rt,{className:"w-[130px]",children:"Origem"}),s.jsx(rt,{className:"w-[130px]",children:"Status"}),s.jsx(rt,{className:"w-[200px]",children:"Urgncia"}),s.jsx(rt,{className:"w-[110px]",children:"Ocorrncias"}),s.jsx(rt,{className:"w-[150px]",children:"ltima Deteco"}),s.jsx(rt,{className:"text-right w-[200px]",children:"Aes"})]})}),s.jsx(da,{children:_t.map(Oe=>{const Xe=Oe.status==="pendente"||Oe.status==="acao_manual";return s.jsxs(Cs,{className:jt(Oe),children:[s.jsx(Ze,{children:Xe?s.jsx(Ef,{checked:Z.has(Oe.id),onCheckedChange:()=>Lt(Oe.id)}):s.jsx("span",{className:"text-gray-300",children:"-"})}),s.jsx(Ze,{className:"font-mono font-medium text-sm",children:Oe.ean_gtin.startsWith("SEM_GTIN_")?"SEM GTIN":Oe.ean_gtin}),s.jsx(Ze,{className:"font-medium",children:Oe.descricao}),s.jsx(Ze,{children:Jt(Oe.origem)}),s.jsx(Ze,{children:Dt(Oe.status)}),s.jsx(Ze,{children:qe(Oe)}),s.jsx(Ze,{children:s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Ir,{className:"h-4 w-4 text-muted-foreground"}),s.jsxs("span",{className:"font-medium",children:[Oe.quantidade_ocorrencias,"x"]})]})}),s.jsx(Ze,{className:"text-sm text-muted-foreground",children:Ad(new Date(Oe.data_ultima_deteccao),{addSuffix:!0,locale:$s})}),s.jsx(Ze,{className:"text-right",children:s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[Oe.status==="consultado"&&(!Oe.dados_api||Oe.dados_api.encontrado!==!0)&&s.jsxs(oe,{size:"sm",variant:"outline",onClick:()=>ts(Oe),disabled:F,className:"bg-amber-50 border-amber-200 text-amber-700 hover:bg-amber-100",title:"Reverter para Pendente e consultar novamente",children:[s.jsx(Kn,{className:"h-4 w-4 mr-1"}),"Reverter"]}),Oe.status==="consultado"&&Oe.dados_api&&Oe.dados_api.encontrado===!0&&s.jsxs(oe,{size:"sm",variant:"outline",onClick:()=>dt(Oe),className:"bg-cyan-50 border-cyan-200 text-cyan-700 hover:bg-cyan-100",children:[s.jsx(ki,{className:"h-4 w-4 mr-1"}),"Ver Dados"]}),s.jsxs(oe,{size:"sm",variant:"default",onClick:()=>ze(Oe),disabled:F,children:[s.jsx(fs,{className:"h-4 w-4 mr-1"}),"Cadastrar"]}),s.jsx(oe,{size:"sm",variant:"destructive",onClick:()=>Ut(Oe,"rejeitar"),disabled:F,children:s.jsx(Jr,{className:"h-4 w-4"})})]})})]},Oe.id)})})]})})})]}),s.jsx(ar,{open:v,onOpenChange:b,children:s.jsxs(tr,{children:[s.jsxs(nr,{children:[s.jsxs(ir,{children:[N==="aprovar"&&"Aprovar Produto",N==="rejeitar"&&"Rejeitar Produto",N==="observacao"&&"Adicionar Observao"]}),s.jsx(Vr,{children:p&&s.jsxs("div",{className:"mt-2",children:[s.jsx("p",{className:"font-medium",children:p.ean_gtin}),s.jsx("p",{className:"text-sm",children:p.descricao})]})})]}),s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{children:[s.jsx(ke,{children:"Observaes"}),s.jsx(jn,{value:C,onChange:Oe=>T(Oe.target.value),placeholder:"Adicione observaes sobre este produto...",rows:4})]})}),s.jsxs(Ya,{children:[s.jsx(oe,{variant:"outline",onClick:()=>b(!1),children:"Cancelar"}),s.jsxs(oe,{onClick:()=>{if(p){const Oe=N==="rejeitar"?"rejeitado":N==="aprovar"?"aprovado":"em_analise";Se(p.id,Oe,C)}},disabled:F,children:[F&&s.jsx(_s,{className:"h-4 w-4 mr-2 animate-spin"}),"Confirmar"]})]})]})}),s.jsx(ar,{open:A,onOpenChange:k,children:s.jsxs(tr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(nr,{children:[s.jsx(ir,{children:"Cadastrar Novo Produto"}),s.jsx(Vr,{children:"Preencha as informaes do produto para adicion-lo ao catlogo"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"gtin",children:"EAN/GTIN *"}),s.jsx(We,{id:"gtin",value:O.gtin,onChange:Oe=>D({...O,gtin:Oe.target.value}),placeholder:"7891234567890",className:"font-mono"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"ncm",children:"NCM *"}),s.jsx(We,{id:"ncm",value:O.ncm,onChange:Oe=>D({...O,ncm:Oe.target.value}),placeholder:"12345678",maxLength:8,className:"font-mono"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Nomenclatura Comum do Mercosul - obrigatrio para nota fiscal"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"descricao",children:"Descrio do Produto *"}),s.jsx(We,{id:"descricao",value:O.descricao,onChange:Oe=>D({...O,descricao:Oe.target.value}),placeholder:"Ex: GARRAFA PET 2L COCA COLA"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"tipo_embalagem",children:"Tipo de Embalagem *"}),s.jsxs(qs,{value:O.tipo_embalagem,onValueChange:Oe=>D({...O,tipo_embalagem:Oe}),children:[s.jsx(Ls,{id:"tipo_embalagem",children:s.jsx(Ws,{})}),s.jsx(Fs,{children:Object.entries(qi).map(([Oe,Xe])=>s.jsx(xt,{value:Oe,children:Xe},Oe))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"peso_medio",children:"Peso Mdio da Embalagem (kg)"}),s.jsx(We,{id:"peso_medio",type:"number",step:"0.001",min:"0",value:O.peso_medio_gramas?(O.peso_medio_gramas/1e3).toFixed(3):"",onChange:Oe=>D({...O,peso_medio_gramas:Oe.target.value?parseFloat(Oe.target.value)*1e3:null}),placeholder:"Ex: 0.250"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Peso mdio da embalagem vazia em quilos (para clculo de peso total)"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(fi,{id:"reciclavel",checked:O.reciclavel,onCheckedChange:Oe=>D({...O,reciclavel:Oe})}),s.jsx(ke,{htmlFor:"reciclavel",children:"Material Reciclvel"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs(ke,{htmlFor:"percentual",children:["Percentual de Reciclabilidade: ",O.percentual_reciclabilidade,"%"]}),s.jsx(hu,{id:"percentual",min:0,max:100,step:5,value:[O.percentual_reciclabilidade],onValueChange:Oe=>D({...O,percentual_reciclabilidade:Oe[0]})}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"h-3 w-full bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full transition-all duration-300 ${O.percentual_reciclabilidade>=80?"bg-green-500":O.percentual_reciclabilidade>=50?"bg-yellow-500":O.percentual_reciclabilidade>=25?"bg-orange-500":"bg-red-500"}`,style:{width:`${O.percentual_reciclabilidade}%`}})}),s.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[s.jsx("span",{children:"0%"}),s.jsx("span",{className:"font-medium",children:O.percentual_reciclabilidade>=80?" Excelente":O.percentual_reciclabilidade>=50?" Bom":O.percentual_reciclabilidade>=25?" Regular":" Baixo"}),s.jsx("span",{children:"100%"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"observacoes",children:"Observaes"}),s.jsx(jn,{id:"observacoes",value:O.observacoes,onChange:Oe=>D({...O,observacoes:Oe.target.value}),placeholder:"Informaes adicionais sobre o produto",rows:3})]}),I&&s.jsxs("div",{className:"mt-4 p-4 bg-muted rounded-lg",children:[s.jsx("p",{className:"text-sm font-medium mb-2",children:"Informaes de Origem:"}),s.jsxs("div",{className:"text-xs space-y-1 text-muted-foreground",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{children:" Detectado via:"}),s.jsx(Je,{variant:"outline",className:"ml-1",children:I.origem==="qrcode"?" QR Code":" Manual"})]}),s.jsxs("p",{children:[" Ocorrncias: ",I.quantidade_ocorrencias,"x"]}),s.jsxs("p",{children:[" Primeira deteco: ",new Date(I.data_primeira_deteccao).toLocaleString("pt-BR")]})]})]})]}),s.jsxs(Ya,{children:[s.jsx(oe,{variant:"outline",onClick:()=>{k(!1),B(null)},disabled:F,children:"Cancelar"}),s.jsxs(oe,{onClick:we,disabled:F||!O.gtin||!O.ncm||!O.descricao,children:[F&&s.jsx(_s,{className:"h-4 w-4 mr-2 animate-spin"}),s.jsx(fs,{className:"h-4 w-4 mr-2"}),"Salvar Produto"]})]})]})}),s.jsx(ar,{open:z,onOpenChange:q,children:s.jsxs(tr,{className:"max-w-2xl",children:[s.jsxs(nr,{children:[s.jsxs(ir,{className:"flex items-center gap-2",children:[s.jsx(wd,{className:"h-5 w-5"}),"Upload em Massa de Produtos"]}),s.jsx(Vr,{children:"Adicione mltiplos produtos para anlise de uma vez usando um arquivo CSV"})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(b6,{className:"h-5 w-5 text-blue-600 mt-0.5"}),s.jsxs("div",{className:"text-sm space-y-2",children:[s.jsx("p",{className:"font-medium text-blue-900",children:"Como usar:"}),s.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-blue-700",children:[s.jsx("li",{children:"Baixe o template CSV clicando no boto abaixo"}),s.jsx("li",{children:"Preencha apenas EAN/GTIN e Descrio"}),s.jsx("li",{children:"Faa upload do arquivo preenchido"}),s.jsx("li",{children:'Os produtos sero adicionados como "Pendentes" para cadastro'})]})]})]})}),s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-gray-50",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-sm",children:"Template CSV"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Arquivo simples com 2 colunas: EAN e Descrio"})]}),s.jsxs(oe,{variant:"outline",onClick:Le,className:"shrink-0",children:[s.jsx(Ua,{className:"h-4 w-4 mr-2"}),"Baixar Template"]})]}),s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[s.jsx("p",{className:"font-medium text-sm text-green-900 mb-2",children:" Formato do CSV:"}),s.jsxs("div",{className:"text-xs text-green-700 space-y-2",children:[s.jsxs("p",{className:"font-mono bg-white p-2 rounded border border-green-200",children:["ean_gtin,descricao",s.jsx("br",{}),"7891234567890,Garrafa PET 2L",s.jsx("br",{}),"7891234567891,Lata de Alumnio 350ml"]}),s.jsxs("p",{className:"text-xs",children:[" ",s.jsx("strong",{children:"Apenas 2 campos necessrios:"})," EAN/GTIN e Descrio do produto. Aps o upload, voc poder cadastrar cada produto com as informaes completas."]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"csv-upload",children:"Arquivo CSV"}),s.jsx(We,{id:"csv-upload",type:"file",accept:".csv",onChange:Nt,disabled:je}),Y&&s.jsxs("p",{className:"text-sm text-green-600 flex items-center gap-2",children:[s.jsx(Ea,{className:"h-4 w-4"}),"Arquivo selecionado: ",Y.name]})]})]}),s.jsxs(Ya,{children:[s.jsx(oe,{variant:"outline",onClick:()=>{q(!1),ae(null)},disabled:je,children:"Cancelar"}),s.jsxs(oe,{onClick:Ge,disabled:je||!Y,children:[je&&s.jsx(_s,{className:"h-4 w-4 mr-2 animate-spin"}),s.jsx(wd,{className:"h-4 w-4 mr-2"}),"Fazer Upload"]})]})]})}),s.jsx(ar,{open:Q,onOpenChange:re,children:s.jsxs(tr,{children:[s.jsxs(nr,{children:[s.jsxs(ir,{className:"flex items-center gap-2",children:[s.jsx(Kn,{className:"h-5 w-5 text-blue-600"}),"Consultar API OnRender"]}),s.jsx(Vr,{children:"Voc est prestes a consultar a API externa para buscar informaes dos produtos selecionados."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"font-semibold text-blue-900",children:"Produtos selecionados:"}),s.jsx(Je,{className:"bg-blue-600",children:Z.size})]}),s.jsxs("p",{className:"text-sm text-blue-700",children:["Produtos com dados completos sero ",s.jsx("strong",{children:"cadastrados automaticamente"}),"."]}),s.jsxs("p",{className:"text-sm text-blue-700",children:["Produtos com dados incompletos ficaro com status ",s.jsx("strong",{children:'"Consultado"'})," para reviso manual."]})]}),ve+Z.size>100?s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[s.jsxs("p",{className:"text-sm text-red-800 flex items-center gap-2 mb-2",children:[s.jsx(un,{className:"h-4 w-4"}),s.jsx("strong",{children:"Ateno: Limite ser excedido!"})]}),s.jsxs("p",{className:"text-sm text-red-700",children:["Voc selecionou ",s.jsxs("strong",{children:[Z.size," produtos"]}),", mas s restam"," ",s.jsxs("strong",{children:[Math.max(0,100-ve)," consultas"]})," disponveis hoje."]}),s.jsxs("p",{className:"text-sm text-red-700 mt-2",children:[" Sero processadas apenas as ",s.jsxs("strong",{children:["primeiras ",Math.max(0,100-ve)]})," consultas."]})]}):s.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:s.jsxs("p",{className:"text-sm text-amber-800 flex items-center gap-2",children:[s.jsx(un,{className:"h-4 w-4"}),s.jsx("strong",{children:"Limite de consultas:"})," ",ve+Z.size,"/100 consultas hoje"]})})]}),s.jsxs(Ya,{children:[s.jsx(oe,{variant:"outline",onClick:()=>re(!1),children:"Cancelar"}),s.jsxs(oe,{onClick:Ke,children:[s.jsx(Kn,{className:"h-4 w-4 mr-2"}),"Confirmar Consulta"]})]})]})}),s.jsx(ar,{open:le,onOpenChange:()=>{},children:s.jsxs(tr,{className:"sm:max-w-md",onInteractOutside:Oe=>Oe.preventDefault(),children:[s.jsxs(nr,{children:[s.jsxs(ir,{className:"flex items-center gap-2",children:[s.jsx(_s,{className:"h-5 w-5 animate-spin text-blue-600"}),"Consultando API..."]}),s.jsx(Vr,{children:"Aguarde enquanto processamos os produtos"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(fn,{value:W,className:"h-2"}),s.jsxs("p",{className:"text-center text-sm text-muted-foreground",children:[Math.round(W),"% concludo"]}),s.jsx("p",{className:"text-xs text-center text-muted-foreground",children:"Este processo pode levar alguns minutos. Por favor, no feche esta janela."})]})]})}),s.jsx(ar,{open:ie!==null,onOpenChange:()=>ce(null),children:s.jsxs(tr,{className:"sm:max-w-2xl",children:[s.jsxs(nr,{children:[s.jsxs(ir,{className:"flex items-center gap-2",children:[s.jsx(Ea,{className:"h-5 w-5 text-green-600"}),"Consulta Concluda"]}),s.jsx(Vr,{children:"Veja o resumo dos resultados da consulta  API"})]}),ie&&s.jsxs("div",{className:"space-y-4",children:[ie.autoCadastrados.length>0&&s.jsxs(Ne,{className:"bg-green-50 border-green-200",children:[s.jsx(Ye,{className:"pb-3",children:s.jsxs(Qe,{className:"text-sm flex items-center gap-2 text-green-800",children:[s.jsx(Ea,{className:"h-4 w-4"}),"Cadastrados Automaticamente"]})}),s.jsxs(De,{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-2xl font-bold text-green-700",children:ie.autoCadastrados.length}),s.jsx("span",{className:"text-sm text-green-600",children:"produtos"})]}),s.jsxs("details",{className:"mt-2",children:[s.jsx("summary",{className:"text-xs text-green-700 cursor-pointer hover:underline",children:"Ver lista de produtos"}),s.jsx("ul",{className:"mt-2 space-y-1 text-xs text-green-600",children:ie.autoCadastrados.map((Oe,Xe)=>s.jsxs("li",{children:[" ",Oe]},Xe))})]})]})]}),ie.precisamRevisao.length>0&&s.jsxs(Ne,{className:"bg-cyan-50 border-cyan-200",children:[s.jsx(Ye,{className:"pb-3",children:s.jsxs(Qe,{className:"text-sm flex items-center gap-2 text-cyan-800",children:[s.jsx(Kr,{className:"h-4 w-4"}),"Precisam Reviso Manual"]})}),s.jsxs(De,{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-2xl font-bold text-cyan-700",children:ie.precisamRevisao.length}),s.jsx("span",{className:"text-sm text-cyan-600",children:"produtos (dados incompletos)"})]}),s.jsxs("details",{className:"mt-2",children:[s.jsx("summary",{className:"text-xs text-cyan-700 cursor-pointer hover:underline",children:"Ver lista de produtos"}),s.jsx("ul",{className:"mt-2 space-y-1 text-xs text-cyan-600",children:ie.precisamRevisao.map((Oe,Xe)=>s.jsxs("li",{children:[" ",Oe]},Xe))})]})]})]}),ie.naoEncontrados.length>0&&s.jsxs(Ne,{className:"bg-gray-50 border-gray-200",children:[s.jsx(Ye,{className:"pb-3",children:s.jsxs(Qe,{className:"text-sm flex items-center gap-2 text-gray-800",children:[s.jsx(eo,{className:"h-4 w-4"}),"No Encontrados"]})}),s.jsxs(De,{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-2xl font-bold text-gray-700",children:ie.naoEncontrados.length}),s.jsx("span",{className:"text-sm text-gray-600",children:"produtos"})]}),s.jsxs("details",{className:"mt-2",children:[s.jsx("summary",{className:"text-xs text-gray-700 cursor-pointer hover:underline",children:"Ver lista de produtos"}),s.jsx("ul",{className:"mt-2 space-y-1 text-xs text-gray-600",children:ie.naoEncontrados.map((Oe,Xe)=>s.jsxs("li",{children:[" ",Oe]},Xe))})]})]})]}),ie.erros.length>0&&s.jsxs(Ne,{className:"bg-red-50 border-red-200",children:[s.jsx(Ye,{className:"pb-3",children:s.jsxs(Qe,{className:"text-sm flex items-center gap-2 text-red-800",children:[s.jsx(Jr,{className:"h-4 w-4"}),"Erros Durante Consulta"]})}),s.jsxs(De,{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-2xl font-bold text-red-700",children:ie.erros.length}),s.jsx("span",{className:"text-sm text-red-600",children:"erros"})]}),s.jsxs("details",{className:"mt-2",children:[s.jsx("summary",{className:"text-xs text-red-700 cursor-pointer hover:underline",children:"Ver detalhes dos erros"}),s.jsx("ul",{className:"mt-2 space-y-1 text-xs text-red-600",children:ie.erros.map((Oe,Xe)=>s.jsxs("li",{children:[" ",Oe.erro]},Xe))})]})]})]})]}),s.jsx(Ya,{children:s.jsx(oe,{onClick:()=>ce(null),children:"Fechar"})})]})}),s.jsx(ar,{open:xe,onOpenChange:Ce,children:s.jsxs(tr,{className:"max-w-3xl max-h-[80vh] overflow-y-auto",children:[s.jsxs(nr,{children:[s.jsxs(ir,{className:"flex items-center gap-2",children:[s.jsx(ki,{className:"h-5 w-5 text-cyan-600"}),"Dados Retornados da API Cosmos"]}),s.jsx(Vr,{children:"Informaes obtidas da consulta  API OnRender"})]}),me&&me.dados_api&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs(Ne,{children:[s.jsx(Ye,{className:"pb-3",children:s.jsx(Qe,{className:"text-sm",children:"Produto"})}),s.jsxs(De,{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"EAN/GTIN:"})," ",me.dados_api.ean_gtin]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Encontrado:"})," ",me.dados_api.encontrado?" Sim":" No"]})]}),me.dados_api.descricao&&s.jsxs("div",{children:[s.jsx("strong",{children:"Descrio:"})," ",me.dados_api.descricao]}),me.dados_api.marca&&s.jsxs("div",{children:[s.jsx("strong",{children:"Marca:"})," ",me.dados_api.marca]}),me.dados_api.fabricante&&s.jsxs("div",{children:[s.jsx("strong",{children:"Fabricante:"})," ",me.dados_api.fabricante]})]})]}),(me.dados_api.ncm||me.dados_api.categoria_api)&&s.jsxs(Ne,{children:[s.jsx(Ye,{className:"pb-3",children:s.jsx(Qe,{className:"text-sm",children:"Classificao"})}),s.jsxs(De,{className:"space-y-2 text-sm",children:[me.dados_api.ncm&&s.jsxs("div",{children:[s.jsx("strong",{children:"NCM:"})," ",me.dados_api.ncm]}),me.dados_api.ncm_descricao&&s.jsxs("div",{children:[s.jsx("strong",{children:"Descrio NCM:"})," ",me.dados_api.ncm_descricao]}),me.dados_api.categoria_api&&s.jsxs("div",{children:[s.jsx("strong",{children:"Categoria:"})," ",me.dados_api.categoria_api]})]})]}),(me.dados_api.peso_liquido||me.dados_api.peso_bruto||me.dados_api.peso_medio_gramas)&&s.jsxs(Ne,{children:[s.jsx(Ye,{className:"pb-3",children:s.jsx(Qe,{className:"text-sm",children:"Caractersticas Fsicas"})}),s.jsxs(De,{className:"space-y-2 text-sm",children:[me.dados_api.peso_liquido&&s.jsxs("div",{children:[s.jsx("strong",{children:"Peso Lquido:"})," ",me.dados_api.peso_liquido,"g"]}),me.dados_api.peso_bruto&&s.jsxs("div",{children:[s.jsx("strong",{children:"Peso Bruto:"})," ",me.dados_api.peso_bruto,"g"]}),me.dados_api.peso_medio_gramas&&s.jsxs("div",{children:[s.jsx("strong",{children:"Peso Mdio:"})," ",me.dados_api.peso_medio_gramas,"g"]})]})]}),(me.dados_api.tipo_embalagem||me.dados_api.reciclavel!==void 0)&&s.jsxs(Ne,{children:[s.jsx(Ye,{className:"pb-3",children:s.jsx(Qe,{className:"text-sm",children:"Embalagem"})}),s.jsxs(De,{className:"space-y-2 text-sm",children:[me.dados_api.tipo_embalagem&&s.jsxs("div",{children:[s.jsx("strong",{children:"Tipo:"})," ",me.dados_api.tipo_embalagem]}),me.dados_api.reciclavel!==void 0&&s.jsxs("div",{children:[s.jsx("strong",{children:"Reciclvel:"})," ",me.dados_api.reciclavel?" Sim":" No"]}),me.dados_api.percentual_reciclabilidade&&s.jsxs("div",{children:[s.jsx("strong",{children:"Reciclabilidade:"})," ",me.dados_api.percentual_reciclabilidade,"%"]})]})]}),me.dados_api.preco_medio&&s.jsxs(Ne,{children:[s.jsx(Ye,{className:"pb-3",children:s.jsx(Qe,{className:"text-sm",children:"Precificao"})}),s.jsx(De,{className:"text-sm",children:s.jsxs("div",{children:[s.jsx("strong",{children:"Preo Mdio:"})," R$ ",me.dados_api.preco_medio.toFixed(2)]})})]}),me.dados_api.imagem_url&&s.jsxs(Ne,{children:[s.jsx(Ye,{className:"pb-3",children:s.jsx(Qe,{className:"text-sm",children:"Imagem do Produto"})}),s.jsx(De,{children:s.jsx("img",{src:me.dados_api.imagem_url,alt:me.dados_api.descricao,className:"max-w-full h-auto rounded-md border"})})]}),me.dados_api.mensagem&&s.jsxs("div",{className:"text-sm text-muted-foreground italic",children:[" ",me.dados_api.mensagem]})]}),s.jsxs(Ya,{children:[s.jsx(oe,{variant:"outline",onClick:()=>Ce(!1),children:"Fechar"}),me&&s.jsxs(oe,{onClick:()=>{It(me),Ce(!1)},children:[s.jsx(fs,{className:"h-4 w-4 mr-2"}),"Preencher Formulrio"]})]})]})})]})}function dce(e){return e.encontrado?[e.ean_gtin,e.descricao,e.categoria].every(r=>r!=null&&String(r).trim().length>0):!1}const uce=()=>{const e=ds(),[t,r]=E.useState(""),[a,n]=E.useState(!0),[i,o]=E.useState(!1);E.useEffect(()=>{c()},[]);const c=async()=>{try{const{data:h,error:p}=await J.from("configuracoes_sistema").select("valor").eq("chave","whatsapp_ciclik").single();if(p)throw p;r((h==null?void 0:h.valor)||"")}catch(h){ct.error("Erro ao carregar configuraes",{description:h.message})}finally{n(!1)}},d=async()=>{o(!0);try{const{error:h}=await J.from("configuracoes_sistema").update({valor:t}).eq("chave","whatsapp_ciclik");if(h)throw h;ct.success("Configuraes salvas com sucesso!")}catch(h){ct.error("Erro ao salvar configuraes",{description:h.message})}finally{o(!1)}};return a?s.jsx("div",{className:"container mx-auto p-6",children:s.jsx("p",{className:"text-center text-muted-foreground",children:"Carregando configuraes..."})}):s.jsxs("div",{className:"container mx-auto p-6 max-w-2xl",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>e("/admin"),className:"gap-2",children:[s.jsx(As,{className:"h-4 w-4"}),"Voltar"]}),s.jsx("div",{children:s.jsx("h1",{className:"text-2xl font-bold",children:"Configuraes do Sistema"})})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(Cx,{className:"h-6 w-6 text-primary"}),"Configuraes do Sistema"]}),s.jsx(Tt,{children:"Gerencie as configuraes gerais do sistema Ciclik"})]}),s.jsxs(De,{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"whatsapp",children:"WhatsApp para Atendimento de Cooperativas"}),s.jsx(We,{id:"whatsapp",type:"tel",placeholder:"5511999999999",value:t,onChange:h=>r(h.target.value)}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Nmero no formato internacional (cdigo do pas + DDD + nmero)",s.jsx("br",{}),"Exemplo: 5511999999999 (Brasil, So Paulo)"]})]}),s.jsxs(oe,{onClick:d,disabled:i,className:"w-full",children:[s.jsx(Wu,{className:"mr-2 h-4 w-4"}),i?"Salvando...":"Salvar Configuraes"]})]})]})]})},hce=()=>{const e=ds(),[t,r]=E.useState([]),[a,n]=E.useState(!0),[i,o]=E.useState(!1),c=[{key:"pontos_missao_completa",label:"Misso Concluda",description:"Pontos ganhos ao completar uma misso educacional",value:10,category:"earning",meta_semanal_basico:3,meta_mensal_basico:10,meta_semanal_intermediario:5,meta_mensal_intermediario:15,meta_semanal_avancado:7,meta_mensal_avancado:20},{key:"pontos_nota_fiscal_validada",label:"Nota Fiscal Validada",description:"Pontos ganhos quando uma nota fiscal  validada",value:50,category:"earning",meta_semanal_basico:1,meta_mensal_basico:4,meta_semanal_intermediario:2,meta_mensal_intermediario:6,meta_semanal_avancado:3,meta_mensal_avancado:10},{key:"pontos_material_cadastro_nota",label:"Material Cadastrado (Nota Fiscal)",description:"Pontos por cada material cadastrado via nota fiscal",value:5,category:"earning",meta_semanal_basico:0,meta_mensal_basico:0,meta_semanal_intermediario:0,meta_mensal_intermediario:0,meta_semanal_avancado:0,meta_mensal_avancado:0},{key:"pontos_material_cadastro_manual",label:"Material Cadastrado (Manual)",description:"Pontos por cada material cadastrado manualmente",value:10,category:"earning",meta_semanal_basico:0,meta_mensal_basico:0,meta_semanal_intermediario:0,meta_mensal_intermediario:0,meta_semanal_avancado:0,meta_mensal_avancado:0},{key:"pontos_indicacao_cadastro",label:"Indicao - Cadastro",description:"Pontos quando um indicado se cadastra no sistema",value:40,category:"earning",meta_semanal_basico:0,meta_mensal_basico:1,meta_semanal_intermediario:0,meta_mensal_intermediario:2,meta_semanal_avancado:1,meta_mensal_avancado:3},{key:"pontos_indicacao_primeira_missao",label:"Indicao - Primeira Misso",description:"Pontos quando indicado completa sua primeira misso",value:20,category:"earning",meta_semanal_basico:0,meta_mensal_basico:0,meta_semanal_intermediario:0,meta_mensal_intermediario:0,meta_semanal_avancado:0,meta_mensal_avancado:0},{key:"pontos_base_entrega_6kg",label:"Base Entrega (6kg)",description:"Pontos base para cada 6kg de material entregue",value:20,category:"earning",meta_semanal_basico:1,meta_mensal_basico:4,meta_semanal_intermediario:2,meta_mensal_intermediario:8,meta_semanal_avancado:3,meta_mensal_avancado:12}];E.useEffect(()=>{d()},[]);const d=async()=>{try{n(!0);const{data:v,error:b}=await J.from("configuracoes_sistema").select("*").or("chave.like.pontos_%,chave.like.nivel_%,chave.like.meta_%");if(b)throw b;const N=new Map((v==null?void 0:v.map(C=>[C.chave,parseInt(C.valor)]))||[]),_=c.map(C=>({...C,value:N.get(C.key)??C.value,meta_semanal_basico:N.get(`meta_semanal_basico_${C.key}`)??C.meta_semanal_basico,meta_mensal_basico:N.get(`meta_mensal_basico_${C.key}`)??C.meta_mensal_basico,meta_semanal_intermediario:N.get(`meta_semanal_intermediario_${C.key}`)??C.meta_semanal_intermediario,meta_mensal_intermediario:N.get(`meta_mensal_intermediario_${C.key}`)??C.meta_mensal_intermediario,meta_semanal_avancado:N.get(`meta_semanal_avancado_${C.key}`)??C.meta_semanal_avancado,meta_mensal_avancado:N.get(`meta_mensal_avancado_${C.key}`)??C.meta_mensal_avancado}));r(_)}catch(v){console.error("Erro ao carregar configuraes:",v),ct.error("Erro ao carregar configuraes de gamificao")}finally{n(!1)}},h=(v,b,N="value")=>{const _=parseInt(b)||0;r(t.map(C=>C.key===v?{...C,[N]:_}:C))},p=async()=>{try{o(!0);for(const v of t){const{data:b}=await J.from("configuracoes_sistema").select("id").eq("chave",v.key).single();b?await J.from("configuracoes_sistema").update({valor:v.value.toString(),updated_at:new Date().toISOString()}).eq("chave",v.key):await J.from("configuracoes_sistema").insert({chave:v.key,valor:v.value.toString(),descricao:v.description});const N=[{key:`meta_semanal_basico_${v.key}`,value:v.meta_semanal_basico},{key:`meta_mensal_basico_${v.key}`,value:v.meta_mensal_basico},{key:`meta_semanal_intermediario_${v.key}`,value:v.meta_semanal_intermediario},{key:`meta_mensal_intermediario_${v.key}`,value:v.meta_mensal_intermediario},{key:`meta_semanal_avancado_${v.key}`,value:v.meta_semanal_avancado},{key:`meta_mensal_avancado_${v.key}`,value:v.meta_mensal_avancado}];for(const _ of N)if(_.value!==void 0){const{data:C}=await J.from("configuracoes_sistema").select("id").eq("chave",_.key).single();C?await J.from("configuracoes_sistema").update({valor:_.value.toString(),updated_at:new Date().toISOString()}).eq("chave",_.key):await J.from("configuracoes_sistema").insert({chave:_.key,valor:_.value.toString(),descricao:`Meta para ${v.label}`})}}ct.success("Configuraes de gamificao salvas com sucesso!")}catch(v){console.error("Erro ao salvar configuraes:",v),ct.error("Erro ao salvar configuraes")}finally{o(!1)}},x=()=>{r(c),ct.info("Valores resetados para padro. Clique em Salvar para aplicar.")};return s.jsx("div",{className:"min-h-screen bg-background",children:s.jsxs("div",{className:"mx-auto max-w-6xl p-4 md:p-8",children:[s.jsx("div",{className:"mb-6",children:s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>e("/admin"),className:"gap-2 mb-4",children:[s.jsx(As,{className:"h-4 w-4"}),"Voltar"]})}),s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(wo,{className:"h-6 w-6 text-primary"}),"Gesto de Gamificao"]}),s.jsx(Tt,{children:"Configure os pontos de cada atividade e as metas de misses por nvel"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(oe,{variant:"outline",onClick:x,disabled:a||i,children:[s.jsx(Kn,{className:"mr-2 h-4 w-4"}),"Resetar"]}),s.jsxs(oe,{onClick:p,disabled:a||i,children:[s.jsx(Wu,{className:"mr-2 h-4 w-4"}),i?"Salvando...":"Salvar"]})]})]})}),s.jsx(De,{children:a?s.jsx("div",{className:"text-center py-8",children:s.jsx("p",{className:"text-muted-foreground",children:"Carregando configuraes..."})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs(Ne,{className:"border-primary/20 bg-gradient-to-br from-primary/5 to-transparent",children:[s.jsxs(Ye,{children:[s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(Eo,{className:"h-5 w-5 text-primary"}),"Sistema de Nveis Mensais"]}),s.jsx(Tt,{children:"Os nveis so baseados nos pontos acumulados em um nico ms. Usurios mudam de nvel automaticamente ao atingir a faixa."})]}),s.jsx(De,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs(Ne,{className:"border-2 border-primary/20",children:[s.jsxs(Ye,{className:"pb-3",children:[s.jsx(Qe,{className:"text-lg text-primary",children:"Nvel Bsico"}),s.jsx(Tt,{children:"Embaixador Ciclik"})]}),s.jsx(De,{children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-3xl font-bold text-primary",children:"0 - 500"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"pontos mensais"})]})})]}),s.jsxs(Ne,{className:"border-2 border-success/30 bg-success/5",children:[s.jsxs(Ye,{className:"pb-3",children:[s.jsx(Qe,{className:"text-lg text-success",children:"Nvel Intermedirio"}),s.jsx(Tt,{children:"Protetor Ciclik"})]}),s.jsx(De,{children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-3xl font-bold text-success",children:"501 - 1.000"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"pontos mensais"})]})})]}),s.jsxs(Ne,{className:"border-2 border-accent/30 bg-accent/5",children:[s.jsxs(Ye,{className:"pb-3",children:[s.jsx(Qe,{className:"text-lg text-accent",children:"Nvel Avanado"}),s.jsx(Tt,{children:"Guardio Ciclik"})]}),s.jsx(De,{children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-3xl font-bold text-accent",children:"1.001+"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"pontos mensais"})]})})]})]})})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[s.jsx(wo,{className:"h-5 w-5 text-primary"}),"Pontuao de Atividades e Metas por Nvel"]}),s.jsx("div",{className:"border rounded-lg overflow-x-auto",children:s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{className:"bg-muted/50",children:[s.jsx(rt,{className:"min-w-[200px]",children:"Atividade"}),s.jsx(rt,{className:"min-w-[250px]",children:"Descrio"}),s.jsx(rt,{className:"text-center w-[100px]",children:"Pontos"}),s.jsxs(rt,{className:"text-center w-[80px] border-l",children:["Semanal",s.jsx("br",{}),s.jsx("span",{className:"text-xs font-normal",children:"Bsico"})]}),s.jsxs(rt,{className:"text-center w-[80px]",children:["Mensal",s.jsx("br",{}),s.jsx("span",{className:"text-xs font-normal",children:"Bsico"})]}),s.jsxs(rt,{className:"text-center w-[100px]",children:["Pontos Proj.",s.jsx("br",{}),s.jsx("span",{className:"text-xs font-normal",children:"Bsico"})]}),s.jsxs(rt,{className:"text-center w-[80px] border-l",children:["Semanal",s.jsx("br",{}),s.jsx("span",{className:"text-xs font-normal",children:"Interm."})]}),s.jsxs(rt,{className:"text-center w-[80px]",children:["Mensal",s.jsx("br",{}),s.jsx("span",{className:"text-xs font-normal",children:"Interm."})]}),s.jsxs(rt,{className:"text-center w-[100px]",children:["Pontos Proj.",s.jsx("br",{}),s.jsx("span",{className:"text-xs font-normal",children:"Interm."})]}),s.jsxs(rt,{className:"text-center w-[80px] border-l",children:["Semanal",s.jsx("br",{}),s.jsx("span",{className:"text-xs font-normal",children:"Avan."})]}),s.jsxs(rt,{className:"text-center w-[80px]",children:["Mensal",s.jsx("br",{}),s.jsx("span",{className:"text-xs font-normal",children:"Avan."})]}),s.jsxs(rt,{className:"text-center w-[100px]",children:["Pontos Proj.",s.jsx("br",{}),s.jsx("span",{className:"text-xs font-normal",children:"Avan."})]})]})}),s.jsxs(da,{children:[t.filter(v=>v.category==="earning"&&!v.key.includes("nivel_")).map(v=>s.jsxs(Cs,{children:[s.jsx(Ze,{className:"font-medium",children:v.label}),s.jsx(Ze,{className:"text-sm text-muted-foreground",children:v.description}),s.jsx(Ze,{className:"text-center",children:s.jsx(We,{type:"number",min:"0",value:v.value,onChange:b=>h(v.key,b.target.value,"value"),className:"w-20 text-center mx-auto"})}),s.jsx(Ze,{className:"text-center border-l",children:s.jsx(We,{type:"number",min:"0",value:v.meta_semanal_basico??0,onChange:b=>h(v.key,b.target.value,"meta_semanal_basico"),className:"w-16 text-center mx-auto"})}),s.jsx(Ze,{className:"text-center",children:s.jsx(We,{type:"number",min:"0",value:v.meta_mensal_basico??0,onChange:b=>h(v.key,b.target.value,"meta_mensal_basico"),className:"w-16 text-center mx-auto"})}),s.jsx(Ze,{className:"text-center bg-muted/30",children:s.jsx("div",{className:"text-sm font-semibold text-primary",children:(v.meta_mensal_basico??0)*v.value})}),s.jsx(Ze,{className:"text-center border-l",children:s.jsx(We,{type:"number",min:"0",value:v.meta_semanal_intermediario??0,onChange:b=>h(v.key,b.target.value,"meta_semanal_intermediario"),className:"w-16 text-center mx-auto"})}),s.jsx(Ze,{className:"text-center",children:s.jsx(We,{type:"number",min:"0",value:v.meta_mensal_intermediario??0,onChange:b=>h(v.key,b.target.value,"meta_mensal_intermediario"),className:"w-16 text-center mx-auto"})}),s.jsx(Ze,{className:"text-center bg-muted/30",children:s.jsx("div",{className:"text-sm font-semibold text-primary",children:(v.meta_mensal_intermediario??0)*v.value})}),s.jsx(Ze,{className:"text-center border-l",children:s.jsx(We,{type:"number",min:"0",value:v.meta_semanal_avancado??0,onChange:b=>h(v.key,b.target.value,"meta_semanal_avancado"),className:"w-16 text-center mx-auto"})}),s.jsx(Ze,{className:"text-center",children:s.jsx(We,{type:"number",min:"0",value:v.meta_mensal_avancado??0,onChange:b=>h(v.key,b.target.value,"meta_mensal_avancado"),className:"w-16 text-center mx-auto"})}),s.jsx(Ze,{className:"text-center bg-muted/30",children:s.jsx("div",{className:"text-sm font-semibold text-primary",children:(v.meta_mensal_avancado??0)*v.value})})]},v.key)),s.jsxs(Cs,{className:"bg-primary/10 font-bold border-t-2 border-primary/20",children:[s.jsx(Ze,{colSpan:3,className:"text-right pr-4",children:s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsx(wo,{className:"h-5 w-5 text-primary"}),s.jsx("span",{className:"text-lg",children:"TOTAL MENSAL POR NVEL:"})]})}),s.jsx(Ze,{colSpan:2}),s.jsxs(Ze,{className:"text-center bg-primary/20",children:[s.jsx("div",{className:"text-lg font-bold text-primary",children:t.filter(v=>v.category==="earning"&&!v.key.includes("nivel_")).reduce((v,b)=>v+(b.meta_mensal_basico??0)*b.value,0).toLocaleString("pt-BR")}),s.jsx("div",{className:"text-xs text-muted-foreground",children:"pts Bsico"})]}),s.jsx(Ze,{colSpan:2}),s.jsxs(Ze,{className:"text-center bg-primary/20",children:[s.jsx("div",{className:"text-lg font-bold text-primary",children:t.filter(v=>v.category==="earning"&&!v.key.includes("nivel_")).reduce((v,b)=>v+(b.meta_mensal_intermediario??0)*b.value,0).toLocaleString("pt-BR")}),s.jsx("div",{className:"text-xs text-muted-foreground",children:"pts Intermedirio"})]}),s.jsx(Ze,{colSpan:2}),s.jsxs(Ze,{className:"text-center bg-primary/20",children:[s.jsx("div",{className:"text-lg font-bold text-primary",children:t.filter(v=>v.category==="earning"&&!v.key.includes("nivel_")).reduce((v,b)=>v+(b.meta_mensal_avancado??0)*b.value,0).toLocaleString("pt-BR")}),s.jsx("div",{className:"text-xs text-muted-foreground",children:"pts Avanado"})]})]})]})]})})]}),s.jsxs("div",{className:"bg-muted/50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold mb-2",children:" Informaes Importantes"}),s.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1",children:[s.jsx("li",{children:" As pontuaes de misses especficas so configuradas individualmente em cada misso"}),s.jsx("li",{children:" Pontos de entregas so calculados proporcionalmente ao peso validado"}),s.jsx("li",{children:" Resgate de cupons deduz pontos baseado no valor configurado em cada cupom"}),s.jsx("li",{children:" Alteraes nas configuraes afetam apenas transaes futuras"}),s.jsx("li",{children:" Metas de misses definem quantas misses os usurios devem completar por perodo em cada nvel"})]})]})]})})]})]})})};function fce(){const e=ds(),[t,r]=E.useState([]),[a,n]=E.useState([]),[i,o]=E.useState(!0),[c,d]=E.useState(null),[h,p]=E.useState(null),[x,v]=E.useState(!1),[b,N]=E.useState("");E.useEffect(()=>{_(),C()},[]);const _=async()=>{try{o(!0);const{data:B,error:O}=await J.from("profiles").select("id, nome, email, score_verde").order("nome");if(O)throw O;const D=[];for(const F of B||[])try{const{data:M,error:z}=await J.functions.invoke("calcular-pontos-esperados",{body:{userId:F.id}});if(z){console.error(`Erro ao calcular pontos para ${F.nome}:`,z);continue}const q=M.pontos_esperados||0,Y=F.score_verde-q,ae=q>0?Y/q*100:0;D.push({id:F.id,nome:F.nome,email:F.email,score_verde:F.score_verde,pontos_esperados:q,discrepancia:Y,percentual_discrepancia:ae,detalhes:M.detalhes})}catch(M){console.error(`Erro ao processar ${F.nome}:`,M)}r(D)}catch(B){console.error("Erro ao carregar auditoria:",B),ct.error("Erro ao carregar auditoria de pontos")}finally{o(!1)}},C=async()=>{try{const{data:B,error:O}=await J.from("ajustes_pontos_manuais").select(`
          *,
          usuario:id_usuario(nome),
          admin:id_admin(nome)
        `).order("created_at",{ascending:!1}).limit(50);if(O)throw O;const D=B.map(F=>{var M,z;return{id:F.id,id_usuario:F.id_usuario,nome_usuario:((M=F.usuario)==null?void 0:M.nome)||"Usurio removido",id_admin:F.id_admin,nome_admin:((z=F.admin)==null?void 0:z.nome)||"Admin removido",pontos_antes:F.pontos_antes,pontos_depois:F.pontos_depois,diferenca:F.diferenca,motivo:F.motivo,detalhes:F.detalhes,created_at:F.created_at}});n(D)}catch(B){console.error("Erro ao carregar histrico:",B)}},T=async B=>{var O;if(confirm(`Recalcular pontos para ${B.nome}?

Pontos atuais: ${B.score_verde}
Pontos esperados: ${B.pontos_esperados}

Esta ao ir ajustar o score_verde e pontos mensais.`))try{d(B.id);const{data:D}=await J.auth.getUser(),F=(O=D==null?void 0:D.user)==null?void 0:O.id;if(!F)throw new Error("Admin no identificado");const M=new Date().toISOString().slice(0,7)+"-01",{error:z}=await J.from("profiles").update({score_verde:B.pontos_esperados}).eq("id",B.id);if(z)throw z;const{error:q}=await J.from("pontos_mensais_usuarios").upsert({id_usuario:B.id,mes_referencia:M,pontos_acumulados:B.pontos_esperados,nivel_atingido:B.pontos_esperados>=1001?"Guardiao Verde":B.pontos_esperados>=501?"Ativo":"Iniciante"},{onConflict:"id_usuario,mes_referencia"});if(q)throw q;const{error:Y}=await J.from("ajustes_pontos_manuais").insert({id_usuario:B.id,id_admin:F,pontos_antes:B.score_verde,pontos_depois:B.pontos_esperados,diferenca:B.pontos_esperados-B.score_verde,motivo:"recalculo_automatico",detalhes:JSON.stringify({detalhes_calculo:B.detalhes,discrepancia_original:B.discrepancia})});if(Y)throw Y;ct.success(`Pontos de ${B.nome} recalculados com sucesso!`),await _(),await C()}catch(D){console.error("Erro ao recalcular pontos:",D),ct.error("Erro ao recalcular pontos: "+D.message)}finally{d(null)}},A=async()=>{var B;if(!h||!b.trim()){ct.error("Preencha o motivo do ajuste");return}try{const{data:O}=await J.auth.getUser(),D=(B=O==null?void 0:O.user)==null?void 0:B.id;if(!D)throw new Error("Admin no identificado");const F=new Date().toISOString().slice(0,7)+"-01",{error:M}=await J.from("profiles").update({score_verde:h.pontos_esperados}).eq("id",h.id);if(M)throw M;const{error:z}=await J.from("pontos_mensais_usuarios").upsert({id_usuario:h.id,mes_referencia:F,pontos_acumulados:h.pontos_esperados,nivel_atingido:h.pontos_esperados>=1001?"Guardiao Verde":h.pontos_esperados>=501?"Ativo":"Iniciante"},{onConflict:"id_usuario,mes_referencia"});if(z)throw z;const{error:q}=await J.from("ajustes_pontos_manuais").insert({id_usuario:h.id,id_admin:D,pontos_antes:h.score_verde,pontos_depois:h.pontos_esperados,diferenca:h.pontos_esperados-h.score_verde,motivo:"ajuste_manual",detalhes:b});if(q)throw q;ct.success("Ajuste manual registrado com sucesso!"),v(!1),p(null),N(""),await _(),await C()}catch(O){console.error("Erro ao registrar ajuste:",O),ct.error("Erro ao registrar ajuste: "+O.message)}},k=B=>{const O=Math.abs(B);return O<5?"text-success":O<15?"text-warning":"text-destructive"},I=B=>Math.abs(B)<3?s.jsx(Tr,{className:"h-4 w-4 text-success"}):Math.abs(B)<10?s.jsx(Kr,{className:"h-4 w-4 text-warning"}):s.jsx(Va,{className:"h-4 w-4 text-destructive"});return s.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>e("/admin/dashboard"),className:"gap-2",children:[s.jsx(As,{className:"h-4 w-4"}),"Voltar"]}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Auditoria de Pontos"}),s.jsx("p",{className:"text-muted-foreground",children:"Visualize discrepncias e recalcule pontos dos usurios"})]})]}),s.jsxs(oe,{onClick:_,disabled:i,children:[s.jsx(Kn,{className:`h-4 w-4 mr-2 ${i?"animate-spin":""}`}),"Atualizar"]})]}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-2",children:[s.jsx(Tt,{children:"Total de Usurios"}),s.jsx(Qe,{className:"text-3xl",children:t.length})]})}),s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-2",children:[s.jsx(Tt,{children:"Com Discrepncia"}),s.jsx(Qe,{className:"text-3xl text-warning",children:t.filter(B=>Math.abs(B.discrepancia)>=3).length})]})}),s.jsx(Ne,{children:s.jsxs(Ye,{className:"pb-2",children:[s.jsx(Tt,{children:"Crticas (>10 pts)"}),s.jsx(Qe,{className:"text-3xl text-destructive",children:t.filter(B=>Math.abs(B.discrepancia)>=10).length})]})})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Relatrio de Discrepncias"}),s.jsx(Tt,{children:"Comparao entre pontos reais e pontos calculados pelas regras de gamificao"})]}),s.jsx(De,{children:i?s.jsx("div",{className:"text-center py-8",children:"Carregando auditoria..."}):s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{children:"Status"}),s.jsx(rt,{children:"Usurio"}),s.jsx(rt,{className:"text-right",children:"Pontos Reais"}),s.jsx(rt,{className:"text-right",children:"Pontos Esperados"}),s.jsx(rt,{className:"text-right",children:"Discrepncia"}),s.jsx(rt,{className:"text-right",children:"%"}),s.jsx(rt,{className:"text-right",children:"Aes"})]})}),s.jsx(da,{children:t.map(B=>s.jsxs(Cs,{children:[s.jsx(Ze,{children:I(B.discrepancia)}),s.jsx(Ze,{children:s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:B.nome}),s.jsx("div",{className:"text-sm text-muted-foreground",children:B.email})]})}),s.jsx(Ze,{className:"text-right font-medium",children:Br(B.score_verde,0)}),s.jsx(Ze,{className:"text-right",children:Br(B.pontos_esperados,0)}),s.jsxs(Ze,{className:`text-right font-medium ${k(B.percentual_discrepancia)}`,children:[B.discrepancia>0?"+":"",Br(B.discrepancia,0)]}),s.jsxs(Ze,{className:`text-right ${k(B.percentual_discrepancia)}`,children:[B.discrepancia>0?"+":"",Br(B.percentual_discrepancia,1),"%"]}),s.jsx(Ze,{className:"text-right",children:Math.abs(B.discrepancia)>=3&&s.jsxs("div",{className:"flex gap-2 justify-end",children:[s.jsx(oe,{size:"sm",onClick:()=>T(B),disabled:c===B.id,children:c===B.id?s.jsx(Kn,{className:"h-3 w-3 animate-spin"}):s.jsxs(s.Fragment,{children:[s.jsx(Ir,{className:"h-3 w-3 mr-1"}),"Recalcular"]})}),s.jsx(oe,{size:"sm",variant:"outline",onClick:()=>{p(B),v(!0)},children:"Ajuste Manual"})]})})]},B.id))})]})})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Histrico de Ajustes"}),s.jsx(Tt,{children:"ltimos 50 ajustes manuais realizados"})]}),s.jsx(De,{children:s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{children:"Data"}),s.jsx(rt,{children:"Usurio"}),s.jsx(rt,{children:"Admin"}),s.jsx(rt,{className:"text-right",children:"Antes"}),s.jsx(rt,{className:"text-right",children:"Depois"}),s.jsx(rt,{className:"text-right",children:"Diferena"}),s.jsx(rt,{children:"Motivo"})]})}),s.jsx(da,{children:a.map(B=>s.jsxs(Cs,{children:[s.jsx(Ze,{children:new Date(B.created_at).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}),s.jsx(Ze,{children:B.nome_usuario}),s.jsx(Ze,{children:B.nome_admin}),s.jsx(Ze,{className:"text-right",children:Br(B.pontos_antes,0)}),s.jsx(Ze,{className:"text-right",children:Br(B.pontos_depois,0)}),s.jsxs(Ze,{className:`text-right font-medium ${B.diferenca>0?"text-success":"text-destructive"}`,children:[B.diferenca>0?"+":"",Br(B.diferenca,0)]}),s.jsx(Ze,{children:s.jsx(Je,{variant:B.motivo==="recalculo_automatico"?"default":"secondary",children:B.motivo==="recalculo_automatico"?"Reclculo":"Ajuste Manual"})})]},B.id))})]})})]}),s.jsx(ar,{open:x,onOpenChange:v,children:s.jsxs(tr,{children:[s.jsxs(nr,{children:[s.jsx(ir,{children:"Ajuste Manual de Pontos"}),s.jsxs(Vr,{children:["Registre o motivo do ajuste para ",h==null?void 0:h.nome]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-muted-foreground",children:"Pontos Atuais:"}),s.jsx("p",{className:"font-semibold",children:h==null?void 0:h.score_verde})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-muted-foreground",children:"Pontos Esperados:"}),s.jsx("p",{className:"font-semibold",children:h==null?void 0:h.pontos_esperados})]})]}),s.jsx(jn,{placeholder:"Descreva o motivo do ajuste manual...",value:b,onChange:B=>N(B.target.value),rows:4})]}),s.jsxs(Ya,{children:[s.jsx(oe,{variant:"outline",onClick:()=>v(!1),children:"Cancelar"}),s.jsx(oe,{onClick:A,children:"Confirmar Ajuste"})]})]})})]})}const fS={amazon:{bg:"from-orange-500 to-amber-600",text:"text-white",gradient:"bg-gradient-to-br"},magalu:{bg:"from-blue-600 to-blue-700",text:"text-white",gradient:"bg-gradient-to-br"},ifood:{bg:"from-red-500 to-red-600",text:"text-white",gradient:"bg-gradient-to-br"},mercadolivre:{bg:"from-yellow-400 to-yellow-500",text:"text-black",gradient:"bg-gradient-to-br"},casasbahia:{bg:"from-blue-700 to-blue-800",text:"text-white",gradient:"bg-gradient-to-br"},aliexpress:{bg:"from-red-600 to-orange-500",text:"text-white",gradient:"bg-gradient-to-br"},shopee:{bg:"from-orange-500 to-red-500",text:"text-white",gradient:"bg-gradient-to-br"},kabum:{bg:"from-orange-600 to-orange-700",text:"text-white",gradient:"bg-gradient-to-br"},uber:{bg:"from-black to-gray-800",text:"text-white",gradient:"bg-gradient-to-br"},rappi:{bg:"from-orange-500 to-red-500",text:"text-white",gradient:"bg-gradient-to-br"},default:{bg:"from-primary to-primary/80",text:"text-primary-foreground",gradient:"bg-gradient-to-br"}},mce=e=>{const t=e.toLowerCase().replace(/[^a-z]/g,"");return fS[t]||fS.default},pce=e=>e.charAt(0).toUpperCase();function xce({cupons:e,pontosUsuario:t,onResgatar:r,isAdmin:a,onDelete:n}){const i=c=>t>=c.pontos_necessarios,o=c=>Math.max(0,c.pontos_necessarios-t);return e.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[s.jsx(Jn,{className:"h-16 w-16 text-muted-foreground/50 mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Nenhum cupom disponvel no momento"})]}):s.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-4",children:e.map((c,d)=>{const h=mce(c.marketplace),p=i(c),x=o(c);return s.jsxs(Ee.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:d*.05},whileHover:{scale:1.05,y:-4},whileTap:{scale:.98},className:"flex flex-col items-center group cursor-pointer",onClick:()=>p&&r(c.id),children:[s.jsxs(Ee.div,{className:`
                relative w-16 h-16 sm:w-20 sm:h-20 rounded-2xl ${h.gradient} ${h.bg}
                shadow-lg group-hover:shadow-xl transition-shadow duration-300
                flex items-center justify-center overflow-hidden
              `,children:[s.jsx("div",{className:`absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent 
                -translate-x-full group-hover:translate-x-full transition-transform duration-700`}),s.jsx("span",{className:`text-2xl sm:text-3xl font-bold ${h.text} relative z-10`,children:pce(c.marketplace)}),p&&s.jsx(Ee.div,{className:"absolute -top-1 -right-1",initial:{scale:0},animate:{scale:[1,1.2,1]},transition:{repeat:1/0,duration:2},children:s.jsx(Md,{className:"h-4 w-4 text-yellow-400 drop-shadow-lg"})}),c.quantidade_disponivel<=c.limite_alerta&&s.jsx("div",{className:`absolute -bottom-1 -right-1 bg-destructive text-destructive-foreground 
                  text-[10px] px-1.5 py-0.5 rounded-full font-medium`,children:c.quantidade_disponivel})]}),s.jsx("p",{className:"mt-2 text-xs sm:text-sm font-medium text-center line-clamp-1 max-w-full px-1",children:c.marketplace}),s.jsxs("div",{className:"flex flex-col items-center mt-1",children:[s.jsx("span",{className:`text-sm sm:text-base font-bold ${p?"text-primary":"text-muted-foreground"}`,children:rb(c.valor_reais)}),s.jsx(OR,{content:p?`Custo: ${c.pontos_necessarios} pontos`:`Faltam ${x} pontos para resgatar este cupom`,className:"text-xs max-w-[180px]",children:s.jsx("span",{className:`text-[10px] sm:text-xs mt-0.5 cursor-help ${p?"text-primary/70":"text-muted-foreground"}`,children:p?`${c.pontos_necessarios} pts`:`-${x} pts`})})]}),p&&s.jsx(Ee.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"mt-2 w-full",children:s.jsx(oe,{size:"sm",className:"w-full h-7 text-xs rounded-full",onClick:v=>{v.stopPropagation(),r(c.id)},children:"Resgatar"})}),a&&n&&s.jsx(oe,{size:"sm",variant:"ghost",className:"mt-1 h-6 text-xs text-destructive hover:text-destructive",onClick:v=>{v.stopPropagation(),n(c.id)},children:"Remover"})]},c.id)})})}function gce(){var H;const e=ds(),{user:t,userRole:r,profile:a,refreshProfile:n}=sr(),{pontos:i,refetch:o}=sb(),[c,d]=E.useState([]),[h,p]=E.useState([]),[x,v]=E.useState(!0),[b,N]=E.useState(!1),[_,C]=E.useState(!1),[T,A]=E.useState(null),{toast:k}=_r(),[I,B]=E.useState({marketplace:"",codigo:"",valor_reais:"",pontos_necessarios:"",minimo_compra:"",quantidade_total:"",data_validade:"",limite_alerta:"10"});E.useEffect(()=>t?(D(),F(),O()):void 0,[t==null?void 0:t.id]);const O=()=>{const Z=J.channel("cupons-updates").on("postgres_changes",{event:"*",schema:"public",table:"cupons"},()=>{D()}).subscribe();return()=>{J.removeChannel(Z)}},D=async()=>{const{data:Z,error:G}=await J.from("cupons").select("*").eq("ativo",!0).eq("status","disponivel").gt("quantidade_disponivel",0).or("data_validade.is.null,data_validade.gte."+new Date().toISOString().split("T")[0]).order("valor_reais",{ascending:!0});G&&(console.error("Erro ao carregar cupons:",G),k({title:"Erro ao carregar cupons",description:G.message,variant:"destructive"})),d(Z||[]),v(!1)},F=async()=>{if(!t)return;const{data:Z,error:G}=await J.from("cupons_resgates").select(`
        *,
        cupons:id_cupom (marketplace, valor_reais, pontos_necessarios, data_validade)
      `).eq("id_usuario",t.id).order("data_resgate",{ascending:!1});G&&(console.error("Erro ao carregar meus cupons:",G),k({title:"Erro ao carregar cupons resgatados",description:G.message,variant:"destructive"})),p(Z||[])},M=async Z=>{if(!t)return;const{data:G,error:Q}=await J.rpc("resgatar_cupom",{p_cupom_id:Z,p_usuario_id:t.id});if(Q||!(G!=null&&G.success)){k({title:"Erro ao resgatar",description:(G==null?void 0:G.error)||(Q==null?void 0:Q.message),variant:"destructive"});return}k({title:"Cupom resgatado! ",description:`Seu cdigo: ${G.codigo_unico}. Cupom de R$ ${G.valor_reais.toFixed(2)} resgatado por ${G.pontos_utilizados} pontos! Pontos restantes: ${G.pontos_restantes}`,duration:8e3}),A({valor_reais:G.valor_reais,codigo_unico:G.codigo_unico}),C(!0),await n(),await o(),await D(),await F()},z=async Z=>{Z.preventDefault();const{error:G}=await J.from("cupons").insert({marketplace:I.marketplace,codigo:I.codigo,valor_reais:parseFloat(I.valor_reais),pontos_necessarios:parseInt(I.pontos_necessarios),minimo_compra:parseFloat(I.minimo_compra),quantidade_total:parseInt(I.quantidade_total),quantidade_disponivel:parseInt(I.quantidade_total),quantidade_resgatada:0,data_validade:I.data_validade||null,limite_alerta:parseInt(I.limite_alerta),ativo:!0,status:"disponivel"});if(G){k({title:"Erro ao criar cupom",description:G.message,variant:"destructive"});return}k({title:"Cupom criado com sucesso!"}),N(!1),B({marketplace:"",codigo:"",valor_reais:"",pontos_necessarios:"",minimo_compra:"",quantidade_total:"",data_validade:"",limite_alerta:"10"}),D()},q=async Z=>{const{error:G}=await J.from("cupons").update({ativo:!1}).eq("id",Z);if(G){k({title:"Erro ao desativar cupom",description:G.message,variant:"destructive"});return}k({title:"Cupom desativado"}),D()},Y=Z=>{navigator.clipboard.writeText(Z),k({title:"Cdigo copiado!",description:"Cole este cdigo no marketplace ao finalizar sua compra."})},ae=async Z=>{const{error:G}=await J.from("cupons_resgates").update({status:"usado",data_uso:new Date().toISOString()}).eq("id",Z);if(G){k({title:"Erro ao marcar como usado",description:G.message,variant:"destructive"});return}k({title:"Cupom marcado como usado"}),F()},je=Z=>{const G={resgatado:"default",usado:"secondary",expirado:"destructive"},Q={resgatado:"Resgatado",usado:"Usado",expirado:"Expirado"};return s.jsx(Je,{variant:G[Z],children:Q[Z]})};return x?s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:"Carregando..."}):s.jsxs("div",{className:"min-h-screen bg-background p-6",children:[s.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>e("/user"),children:s.jsx(As,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Resgatar Cupons"}),s.jsx("p",{className:"text-muted-foreground",children:"Use seus pontos para resgatar cupons de desconto"})]})]}),s.jsx(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},children:s.jsxs(Ne,{className:"relative overflow-hidden bg-gradient-to-br from-primary/5 via-primary/10 to-emerald-500/10 border-primary/20",children:[s.jsxs("div",{className:"absolute inset-0 opacity-5",children:[s.jsx("div",{className:"absolute top-4 right-4 w-32 h-32 rounded-full bg-primary blur-3xl"}),s.jsx("div",{className:"absolute bottom-4 left-4 w-24 h-24 rounded-full bg-emerald-500 blur-2xl"})]}),s.jsx(De,{className:"pt-6 relative z-10",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground font-medium",children:"Sua Pontuao"}),s.jsxs(Ee.p,{className:"text-4xl font-bold text-primary",initial:{scale:.9},animate:{scale:1},transition:{type:"spring",stiffness:200},children:[i," pontos"]}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Complete misses e entregue reciclveis para ganhar mais pontos!"})]}),s.jsx(Ee.div,{className:"relative",animate:{rotate:[0,5,-5,0]},transition:{repeat:1/0,duration:4,ease:"easeInOut"},children:s.jsxs("div",{className:"relative w-16 h-16 flex items-center justify-center",children:[s.jsx(Ee.div,{className:"absolute inset-0 rounded-full bg-primary/20",animate:{scale:[1,1.1,1]},transition:{repeat:1/0,duration:2}}),s.jsx(q2,{className:"h-10 w-10 text-primary relative z-10"})]})})]})})]})}),s.jsx(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},children:s.jsx(Ne,{children:s.jsx(De,{className:"pt-6",children:s.jsxs("div",{className:"grid grid-cols-3 divide-x divide-border",children:[s.jsxs(Ee.div,{className:"flex flex-col items-center px-4",whileHover:{scale:1.05},children:[s.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-primary/10 mb-2",children:s.jsx(W2,{className:"h-5 w-5 text-primary"})}),s.jsx("span",{className:"text-2xl font-bold",children:c.length}),s.jsx("span",{className:"text-xs text-muted-foreground text-center",children:"Disponveis"})]}),s.jsxs(Ee.div,{className:"flex flex-col items-center px-4",whileHover:{scale:1.05},children:[s.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-amber-500/10 mb-2",children:s.jsx(q2,{className:"h-5 w-5 text-amber-600"})}),s.jsx("span",{className:"text-2xl font-bold",children:(a==null?void 0:a.cupons_resgatados)||0}),s.jsx("span",{className:"text-xs text-muted-foreground text-center",children:"Resgatados"})]}),s.jsxs(Ee.div,{className:"flex flex-col items-center px-4",whileHover:{scale:1.05},children:[s.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-green-500/10 mb-2",children:s.jsx(W2,{className:"h-5 w-5 text-green-600"})}),s.jsx("span",{className:"text-2xl font-bold",children:h.filter(Z=>Z.status==="usado").length}),s.jsx("span",{className:"text-xs text-muted-foreground text-center",children:"Usados"})]})]})})})}),s.jsxs(Mn,{defaultValue:"disponiveis",className:"w-full",children:[s.jsxs(Nn,{className:"grid w-full grid-cols-2",children:[s.jsx(Gs,{value:"disponiveis",children:"Cupons Disponveis"}),s.jsx(Gs,{value:"meus",children:"Meus Cupons"})]}),s.jsxs(hr,{value:"disponiveis",className:"space-y-4",children:[r==="admin"&&s.jsxs(ar,{open:b,onOpenChange:N,children:[s.jsx(kp,{asChild:!0,children:s.jsxs(oe,{className:"w-full",children:[s.jsx(ra,{className:"mr-2 h-4 w-4"})," Adicionar Novo Lote de Cupons"]})}),s.jsxs(tr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsx(nr,{children:s.jsx(ir,{children:"Novo Lote de Gift Cards"})}),s.jsxs("form",{onSubmit:z,className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(ke,{children:"Marketplace"}),s.jsx(We,{placeholder:"Ex: iFood",value:I.marketplace,onChange:Z=>B({...I,marketplace:Z.target.value}),required:!0})]}),s.jsxs("div",{children:[s.jsx(ke,{children:"Cdigo Base"}),s.jsx(We,{placeholder:"Ex: IFOOD20",value:I.codigo,onChange:Z=>B({...I,codigo:Z.target.value}),required:!0})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(ke,{children:"Valor em R$"}),s.jsx(We,{type:"number",step:"0.01",placeholder:"20.00",value:I.valor_reais,onChange:Z=>B({...I,valor_reais:Z.target.value}),required:!0})]}),s.jsxs("div",{children:[s.jsx(ke,{children:"Pontos Necessrios"}),s.jsx(We,{type:"number",placeholder:"600",value:I.pontos_necessarios,onChange:Z=>B({...I,pontos_necessarios:Z.target.value}),required:!0}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"300pts=R$10, 600pts=R$20"})]}),s.jsxs("div",{children:[s.jsx(ke,{children:"Compra Mnima (R$)"}),s.jsx(We,{type:"number",step:"0.01",value:I.minimo_compra,onChange:Z=>B({...I,minimo_compra:Z.target.value}),required:!0})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(ke,{children:"Quantidade Total"}),s.jsx(We,{type:"number",value:I.quantidade_total,onChange:Z=>B({...I,quantidade_total:Z.target.value}),required:!0})]}),s.jsxs("div",{children:[s.jsx(ke,{children:"Limite de Alerta"}),s.jsx(We,{type:"number",value:I.limite_alerta,onChange:Z=>B({...I,limite_alerta:Z.target.value}),required:!0})]})]}),s.jsxs("div",{children:[s.jsx(ke,{children:"Data de Validade"}),s.jsx(We,{type:"date",value:I.data_validade,onChange:Z=>B({...I,data_validade:Z.target.value})})]}),s.jsx(oe,{type:"submit",className:"w-full",children:"Criar Lote"})]})]})]}),s.jsx(Ne,{className:"p-6",children:s.jsx(xce,{cupons:c,pontosUsuario:i,onResgatar:M,isAdmin:r==="admin",onDelete:q})})]}),s.jsx(hr,{value:"meus",className:"space-y-4",children:h.length===0?s.jsx(Ne,{children:s.jsxs(De,{className:"py-12 flex flex-col items-center justify-center text-center",children:[s.jsx(Jn,{className:"h-12 w-12 text-muted-foreground/50 mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Voc ainda no resgatou nenhum cupom"}),s.jsx("p",{className:"text-sm text-muted-foreground/70 mt-1",children:"Acumule pontos e resgate cupons de desconto!"}),s.jsx(Ee.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"mt-6",children:s.jsxs(Ee.button,{onClick:()=>e("/goals"),whileHover:{scale:1.05},whileTap:{scale:.98},className:`group relative px-6 py-3 rounded-full bg-gradient-to-r from-primary to-primary/80 
                        text-primary-foreground font-medium shadow-lg hover:shadow-xl transition-shadow
                        flex items-center gap-2 overflow-hidden`,children:[s.jsx("div",{className:`absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent 
                        -translate-x-full group-hover:translate-x-full transition-transform duration-700`}),s.jsx(Ee.div,{animate:{rotate:[0,10,-10,0]},transition:{repeat:1/0,duration:2,repeatDelay:1},children:s.jsx(Eo,{className:"h-5 w-5"})}),s.jsx("span",{children:"Atingir metas e ganhar pontos"}),s.jsx(Ee.div,{animate:{x:[0,4,0]},transition:{repeat:1/0,duration:1.5},children:s.jsx(Xi,{className:"h-5 w-5"})})]})})]})}):s.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:h.map(Z=>s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx(Qe,{children:Z.cupons.marketplace}),s.jsxs(Tt,{children:["R$ ",Z.cupons.valor_reais.toFixed(2)," por ",Z.pontos_utilizados," pontos"]})]}),je(Z.status)]})}),s.jsxs(De,{className:"space-y-3",children:[s.jsxs("div",{className:"bg-muted p-3 rounded-md",children:[s.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Cdigo:"}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("code",{className:"text-sm font-mono",children:Z.codigo_unico}),s.jsx(oe,{size:"icon",variant:"ghost",onClick:()=>Y(Z.codigo_unico),children:s.jsx(ep,{className:"h-4 w-4"})})]})]}),Z.status==="resgatado"&&s.jsx(oe,{variant:"outline",onClick:()=>ae(Z.id),className:"w-full",children:"Marcar como Usado"})]})]},Z.id))})})]})]}),s.jsx(ar,{open:_,onOpenChange:C,children:s.jsxs(tr,{className:"sm:max-w-md",children:[s.jsx(nr,{children:s.jsx(ir,{children:"Cupom Resgatado com Sucesso! "})}),s.jsxs("div",{className:"space-y-4",children:[T&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"p-4 bg-muted rounded-lg text-center",children:[s.jsxs("p",{className:"text-2xl font-bold text-primary",children:["R$ ",(H=T.valor_reais)==null?void 0:H.toFixed(2)]}),s.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Cdigo: ",T.codigo_unico]})]}),s.jsx(__,{shareData:{type:"cupom_resgatado",valor_cupom:T.valor_reais},nomeUsuario:a==null?void 0:a.nome.split(" ")[0]})]}),s.jsx(oe,{onClick:()=>C(!1),className:"w-full",variant:"outline",children:"Fechar"})]})]})})]})}const mS=["Dom","Seg","Ter","Qua","Qui","Sex","Sb"];function vce({open:e,onOpenChange:t}){var je;const{user:r,profile:a}=sr(),[n,i]=E.useState(!0),[o,c]=E.useState([]),[d,h]=E.useState([]),[p,x]=E.useState(null),[v,b]=E.useState(""),[N,_]=E.useState(""),[C,T]=E.useState(!1),[A,k]=E.useState(null),[I,B]=E.useState("disponiveis");E.useEffect(()=>{e&&r&&O()},[e,r]);const O=async()=>{i(!0),await Promise.all([D(),F()]),i(!1)},D=async()=>{try{const{data:H,error:Z}=await J.from("rotas_coleta").select(`
          id,
          nome,
          descricao,
          operador:cooperativas(nome_fantasia)
        `).eq("status","ativa").order("nome");if(Z)throw Z;const G=await Promise.all((H||[]).map(async ye=>{const[W,ee]=await Promise.all([J.from("rotas_dias_coleta").select("dia_semana, horario_inicio, horario_fim").eq("id_rota",ye.id),J.from("rotas_areas_cobertura").select("bairro, cidade, uf").eq("id_rota",ye.id)]);return{...ye,operador:Array.isArray(ye.operador)?ye.operador[0]:ye.operador,dias:W.data||[],areas:ee.data||[]}})),{data:Q}=await J.from("usuarios_rotas").select("id_rota").eq("id_usuario",r==null?void 0:r.id).in("status",["ativa","pausada"]),re=new Set((Q||[]).map(ye=>ye.id_rota)),le=G.filter(ye=>!re.has(ye.id));c(le)}catch(H){ct.error("Erro ao carregar rotas",{description:H.message})}},F=async()=>{try{const{data:H,error:Z}=await J.from("usuarios_rotas").select(`
          *,
          rota:rotas_coleta(
            nome,
            operador:cooperativas(nome_fantasia)
          )
        `).eq("id_usuario",r==null?void 0:r.id).order("data_adesao",{ascending:!1});if(Z)throw Z;h(H||[]),(H||[]).length>0&&B("minhas")}catch(H){ct.error("Erro ao carregar adeses",{description:H.message})}},M=H=>{if(x(H),a){const Z=[a.logradouro,a.numero,a.complemento,a.bairro,a.cidade,a.uf,a.cep].filter(Boolean).join(", ");b(Z)}},z=async()=>{if(!(!p||!r)){if(!v.trim()){ct.error("Informe o endereo de coleta");return}T(!0);try{const{data:H}=await J.from("usuarios_rotas").select("*").eq("id_usuario",r.id).eq("id_rota",p.id).eq("status","cancelada").single();let Z,G;if(H){Z=H.qrcode_adesao,G=H.hash_qrcode;const{error:le}=await J.from("usuarios_rotas").update({status:"ativa",endereco_coleta:v,observacoes:N||null,data_adesao:new Date().toISOString()}).eq("id",H.id);if(le)throw le}else{const{data:le,error:ye}=await J.rpc("gerar_qrcode_adesao_rota");if(ye)throw ye;Z=le,G=crypto.randomUUID();const{error:W}=await J.from("usuarios_rotas").insert({id_usuario:r.id,id_rota:p.id,qrcode_adesao:Z,hash_qrcode:G,endereco_coleta:v,observacoes:N||null,status:"ativa"});if(W)throw W}const Q=JSON.stringify({tipo:"adesao_rota_ciclik",qrcode:Z,hash:G,id_rota:p.id}),re=await kd({data:Q,width:400,margin:2});k(re),ct.success(H?"Adeso reativada com sucesso!":"Adeso realizada com sucesso!"),O(),x(null),b(""),_(""),B("minhas")}catch(H){ct.error("Erro ao aderir  rota",{description:H.message})}finally{T(!1)}}},q=async H=>{if(confirm("Deseja realmente cancelar esta adeso?"))try{const{error:Z}=await J.from("usuarios_rotas").update({status:"cancelada"}).eq("id",H);if(Z)throw Z;ct.success("Adeso cancelada"),O()}catch(Z){ct.error("Erro ao cancelar",{description:Z.message})}},Y=async H=>{try{const Z=JSON.stringify({tipo:"adesao_rota_ciclik",qrcode:H.qrcode_adesao,hash:H.hash_qrcode,id_rota:H.id_rota}),G=await kd({data:Z,width:400,margin:2}),Q=document.createElement("a");Q.download=`qrcode-rota-${H.qrcode_adesao}.png`,Q.href=G,Q.click()}catch{ct.error("Erro ao gerar QR Code")}},ae=()=>{x(null),k(null),t(!1)};return s.jsx(ar,{open:e,onOpenChange:ae,children:s.jsxs(tr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(nr,{children:[s.jsxs(ir,{className:"flex items-center gap-2",children:[s.jsx(Sl,{className:"h-5 w-5 text-primary"}),"Rotas de Coleta Semanal"]}),s.jsx(Vr,{children:"Adira a uma rota para receber coletas semanais com QR Code fixo"})]}),A?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"inline-block bg-white p-4 rounded-lg",children:s.jsx("img",{src:A,alt:"QR Code",className:"w-64 h-64"})}),s.jsx("p",{className:"mt-4 text-lg font-medium text-success",children:" Adeso realizada com sucesso!"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Este  seu QR Code fixo. Imprima e deixe visvel para o coletor."})]}),s.jsxs("div",{className:"flex justify-center gap-2",children:[s.jsxs(oe,{variant:"outline",onClick:()=>{const H=document.createElement("a");H.download="qrcode-rota.png",H.href=A,H.click()},children:[s.jsx(Ua,{className:"mr-2 h-4 w-4"}),"Baixar QR Code"]}),s.jsx(oe,{onClick:()=>k(null),children:"Continuar"})]})]}):p?s.jsxs("div",{className:"space-y-4",children:[s.jsx(Ne,{children:s.jsxs(De,{className:"pt-4",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold",children:p.nome}),s.jsx("p",{className:"text-sm text-muted-foreground",children:((je=p.operador)==null?void 0:je.nome_fantasia)||"Operador no definido"})]}),s.jsx(oe,{variant:"ghost",size:"sm",onClick:()=>x(null),children:s.jsx(Jr,{className:"h-4 w-4"})})]}),p.dias&&p.dias.length>0&&s.jsx("div",{className:"mt-3 flex flex-wrap gap-1",children:p.dias.map((H,Z)=>s.jsxs(Je,{variant:"outline",className:"text-xs",children:[mS[H.dia_semana],H.horario_inicio&&` ${H.horario_inicio.slice(0,5)}`]},Z))})]})}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"endereco",children:"Endereo de Coleta *"}),s.jsx(jn,{id:"endereco",value:v,onChange:H=>b(H.target.value),placeholder:"Endereo completo onde os materiais sero coletados",rows:2})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"obs",children:"Observaes (opcional)"}),s.jsx(We,{id:"obs",value:N,onChange:H=>_(H.target.value),placeholder:"Ex: Porto azul, tocar a campainha"})]}),s.jsxs(Ya,{children:[s.jsx(oe,{variant:"outline",onClick:()=>x(null),children:"Voltar"}),s.jsxs(oe,{onClick:z,disabled:C,children:[C&&s.jsx(_s,{className:"mr-2 h-4 w-4 animate-spin"}),"Confirmar Adeso"]})]})]}):s.jsxs(Mn,{value:I,onValueChange:B,children:[s.jsxs(Nn,{className:"w-full",children:[s.jsx(Gs,{value:"disponiveis",className:"flex-1",children:"Rotas Disponveis"}),s.jsxs(Gs,{value:"minhas",className:"flex-1",children:["Minhas Rotas (",d.filter(H=>H.status==="ativa").length,")"]})]}),s.jsx(hr,{value:"disponiveis",className:"space-y-3 mt-4",children:n?s.jsx("div",{className:"flex justify-center py-8",children:s.jsx(_s,{className:"h-8 w-8 animate-spin text-primary"})}):o.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Sl,{className:"h-12 w-12 mx-auto text-muted-foreground mb-2"}),s.jsx("p",{className:"text-muted-foreground",children:d.length>0?"Voc j aderiu a todas as rotas disponveis":"Nenhuma rota disponvel na sua regio"})]}):o.map(H=>{var Z;return s.jsx(Ne,{className:"cursor-pointer hover:border-primary transition-colors",onClick:()=>M(H),children:s.jsxs(De,{className:"pt-4",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold",children:H.nome}),s.jsx("p",{className:"text-sm text-muted-foreground",children:((Z=H.operador)==null?void 0:Z.nome_fantasia)||"Operador no definido"}),H.descricao&&s.jsx("p",{className:"text-sm mt-1",children:H.descricao})]}),s.jsx(oe,{size:"sm",children:"Aderir"})]}),s.jsxs("div",{className:"mt-3 space-y-2",children:[H.dias&&H.dias.length>0&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Fa,{className:"h-4 w-4 text-muted-foreground"}),s.jsx("div",{className:"flex flex-wrap gap-1",children:H.dias.map((G,Q)=>s.jsx(Je,{variant:"secondary",className:"text-xs",children:mS[G.dia_semana]},Q))})]}),H.areas&&H.areas.length>0&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Co,{className:"h-4 w-4 text-muted-foreground"}),s.jsx("span",{className:"text-muted-foreground",children:(()=>{var ye,W;const G=(ye=H.areas[0])==null?void 0:ye.uf,Q=(W=H.areas[0])==null?void 0:W.cidade,re=[...new Set(H.areas.map(ee=>ee.bairro).filter(Boolean))],le=[];return re.length>0&&le.push(re.slice(0,2).join(", ")+(re.length>2?` +${re.length-2}`:"")),Q&&le.push(Q),G&&le.push(G),le.join(" - ")})()})]})]})]})},H.id)})}),s.jsx(hr,{value:"minhas",className:"space-y-3 mt-4",children:d.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Da,{className:"h-12 w-12 mx-auto text-muted-foreground mb-2"}),s.jsx("p",{className:"text-muted-foreground",children:"Voc ainda no aderiu a nenhuma rota"})]}):d.map(H=>{var Z,G,Q;return s.jsx(Ne,{children:s.jsxs(De,{className:"pt-4",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h3",{className:"font-semibold",children:(Z=H.rota)==null?void 0:Z.nome}),H.status==="ativa"?s.jsx(Je,{className:"bg-success/20 text-success",children:"Ativa"}):H.status==="pausada"?s.jsx(Je,{variant:"secondary",children:"Pausada"}):s.jsx(Je,{variant:"destructive",children:"Cancelada"})]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:(Q=(G=H.rota)==null?void 0:G.operador)==null?void 0:Q.nome_fantasia})]}),H.status==="ativa"&&s.jsxs("div",{className:"flex gap-2",children:[s.jsx(oe,{variant:"outline",size:"sm",onClick:()=>Y(H),children:s.jsx(Da,{className:"h-4 w-4"})}),s.jsx(oe,{variant:"outline",size:"sm",onClick:()=>q(H.id),children:s.jsx(Jr,{className:"h-4 w-4 text-destructive"})})]})]}),s.jsxs("div",{className:"mt-3 space-y-1 text-sm",children:[s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Co,{className:"h-4 w-4 text-muted-foreground shrink-0 mt-0.5"}),s.jsx("span",{className:"text-muted-foreground",children:H.endereco_coleta})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Da,{className:"h-4 w-4 text-muted-foreground"}),s.jsx("code",{className:"text-xs bg-muted px-2 py-1 rounded",children:H.qrcode_adesao})]})]})]})},H.id)})})]})]})})}const yce=({materials:e,selectedIds:t,onToggle:r,onDelete:a,onSelectAll:n,onClearAll:i})=>{const[o,c]=E.useState(!1),d=x=>x>=1e3?`${(x/1e3).toFixed(2).replace(".",",")} kg`:`${x.toFixed(0)} g`,h=e.filter(x=>t.has(x.id)),p=e.length>0&&t.size===e.length;return s.jsxs("div",{className:"space-y-3",children:[s.jsxs(bl,{open:o,onOpenChange:c,children:[s.jsx(_l,{asChild:!0,children:s.jsxs(oe,{variant:"outline",role:"combobox","aria-expanded":o,className:"w-full justify-between h-12 text-left font-normal",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(fs,{className:"h-4 w-4 text-muted-foreground"}),s.jsx("span",{children:t.size===0?"Selecionar materiais...":`${t.size} ${t.size===1?"material selecionado":"materiais selecionados"}`})]}),s.jsx(If,{className:pt("h-4 w-4 shrink-0 opacity-50 transition-transform",o&&"rotate-180")})]})}),s.jsxs(Xo,{className:"w-[var(--radix-popover-trigger-width)] p-0 bg-background border shadow-lg",align:"start",sideOffset:4,style:{zIndex:9999},children:[s.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[s.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:[e.length," ",e.length===1?"disponvel":"disponveis"]}),s.jsxs("div",{className:"flex gap-2",children:[t.size>0&&s.jsx(oe,{variant:"ghost",size:"sm",onClick:x=>{x.stopPropagation(),i()},className:"h-7 text-xs",children:"Limpar"}),s.jsx(oe,{variant:"ghost",size:"sm",onClick:x=>{x.stopPropagation(),p?i():n()},className:"h-7 text-xs",children:p?"Desmarcar todos":"Selecionar todos"})]})]}),s.jsx(d2,{className:"max-h-[280px]",children:e.length===0?s.jsx("div",{className:"p-6 text-center text-muted-foreground text-sm",children:"Nenhum material disponvel"}):s.jsx("div",{className:"p-1",children:e.map(x=>{const v=t.has(x.id),b=!x.peso_gramas&&x.origem_cadastro==="manual";return s.jsxs("div",{className:pt("flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-colors group",v?"bg-primary/10":"hover:bg-muted/50"),onClick:()=>r(x.id),children:[s.jsx(Ef,{checked:v,onCheckedChange:()=>r(x.id),onClick:N=>N.stopPropagation(),className:"shrink-0"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-medium truncate",children:x.descricao}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[x.tipo_embalagem,x.peso_gramas>0&&`  ${d(x.peso_gramas)}`,b&&"  A pesar"]})]}),s.jsx(oe,{variant:"ghost",size:"icon",onClick:N=>{N.stopPropagation(),a(x.id)},className:"h-7 w-7 opacity-0 group-hover:opacity-100 text-destructive hover:text-destructive hover:bg-destructive/10 shrink-0",children:s.jsx(Ba,{className:"h-3.5 w-3.5"})})]},x.id)})})})]})]}),s.jsx(Qi,{mode:"popLayout",children:h.length>0&&s.jsx(Ee.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"flex flex-wrap gap-2",children:h.map(x=>s.jsx(Ee.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},layout:!0,children:s.jsxs(Je,{variant:"secondary",className:"pl-2 pr-1 py-1 gap-1 text-xs font-normal max-w-[180px]",children:[s.jsx("span",{className:"truncate",children:x.descricao}),s.jsx("button",{onClick:()=>r(x.id),className:"ml-1 hover:bg-muted rounded-full p-0.5",children:s.jsx(Jr,{className:"h-3 w-3"})})]})},x.id))})})]})};var mw={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(r,a){a(t)})(rd,function(r){var a="1.9.4";function n(f){var w,R,U,X;for(R=1,U=arguments.length;R<U;R++){X=arguments[R];for(w in X)f[w]=X[w]}return f}var i=Object.create||function(){function f(){}return function(w){return f.prototype=w,new f}}();function o(f,w){var R=Array.prototype.slice;if(f.bind)return f.bind.apply(f,R.call(arguments,1));var U=R.call(arguments,2);return function(){return f.apply(w,U.length?U.concat(R.call(arguments)):arguments)}}var c=0;function d(f){return"_leaflet_id"in f||(f._leaflet_id=++c),f._leaflet_id}function h(f,w,R){var U,X,he,Fe;return Fe=function(){U=!1,X&&(he.apply(R,X),X=!1)},he=function(){U?X=arguments:(f.apply(R,arguments),setTimeout(Fe,w),U=!0)},he}function p(f,w,R){var U=w[1],X=w[0],he=U-X;return f===U&&R?f:((f-X)%he+he)%he+X}function x(){return!1}function v(f,w){if(w===!1)return f;var R=Math.pow(10,w===void 0?6:w);return Math.round(f*R)/R}function b(f){return f.trim?f.trim():f.replace(/^\s+|\s+$/g,"")}function N(f){return b(f).split(/\s+/)}function _(f,w){Object.prototype.hasOwnProperty.call(f,"options")||(f.options=f.options?i(f.options):{});for(var R in w)f.options[R]=w[R];return f.options}function C(f,w,R){var U=[];for(var X in f)U.push(encodeURIComponent(R?X.toUpperCase():X)+"="+encodeURIComponent(f[X]));return(!w||w.indexOf("?")===-1?"?":"&")+U.join("&")}var T=/\{ *([\w_ -]+) *\}/g;function A(f,w){return f.replace(T,function(R,U){var X=w[U];if(X===void 0)throw new Error("No value provided for variable "+R);return typeof X=="function"&&(X=X(w)),X})}var k=Array.isArray||function(f){return Object.prototype.toString.call(f)==="[object Array]"};function I(f,w){for(var R=0;R<f.length;R++)if(f[R]===w)return R;return-1}var B="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function O(f){return window["webkit"+f]||window["moz"+f]||window["ms"+f]}var D=0;function F(f){var w=+new Date,R=Math.max(0,16-(w-D));return D=w+R,window.setTimeout(f,R)}var M=window.requestAnimationFrame||O("RequestAnimationFrame")||F,z=window.cancelAnimationFrame||O("CancelAnimationFrame")||O("CancelRequestAnimationFrame")||function(f){window.clearTimeout(f)};function q(f,w,R){if(R&&M===F)f.call(w);else return M.call(window,o(f,w))}function Y(f){f&&z.call(window,f)}var ae={__proto__:null,extend:n,create:i,bind:o,get lastId(){return c},stamp:d,throttle:h,wrapNum:p,falseFn:x,formatNum:v,trim:b,splitWords:N,setOptions:_,getParamString:C,template:A,isArray:k,indexOf:I,emptyImageUrl:B,requestFn:M,cancelFn:z,requestAnimFrame:q,cancelAnimFrame:Y};function je(){}je.extend=function(f){var w=function(){_(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},R=w.__super__=this.prototype,U=i(R);U.constructor=w,w.prototype=U;for(var X in this)Object.prototype.hasOwnProperty.call(this,X)&&X!=="prototype"&&X!=="__super__"&&(w[X]=this[X]);return f.statics&&n(w,f.statics),f.includes&&(H(f.includes),n.apply(null,[U].concat(f.includes))),n(U,f),delete U.statics,delete U.includes,U.options&&(U.options=R.options?i(R.options):{},n(U.options,f.options)),U._initHooks=[],U.callInitHooks=function(){if(!this._initHooksCalled){R.callInitHooks&&R.callInitHooks.call(this),this._initHooksCalled=!0;for(var he=0,Fe=U._initHooks.length;he<Fe;he++)U._initHooks[he].call(this)}},w},je.include=function(f){var w=this.prototype.options;return n(this.prototype,f),f.options&&(this.prototype.options=w,this.mergeOptions(f.options)),this},je.mergeOptions=function(f){return n(this.prototype.options,f),this},je.addInitHook=function(f){var w=Array.prototype.slice.call(arguments,1),R=typeof f=="function"?f:function(){this[f].apply(this,w)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(R),this};function H(f){if(!(typeof L>"u"||!L||!L.Mixin)){f=k(f)?f:[f];for(var w=0;w<f.length;w++)f[w]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Z={on:function(f,w,R){if(typeof f=="object")for(var U in f)this._on(U,f[U],w);else{f=N(f);for(var X=0,he=f.length;X<he;X++)this._on(f[X],w,R)}return this},off:function(f,w,R){if(!arguments.length)delete this._events;else if(typeof f=="object")for(var U in f)this._off(U,f[U],w);else{f=N(f);for(var X=arguments.length===1,he=0,Fe=f.length;he<Fe;he++)X?this._off(f[he]):this._off(f[he],w,R)}return this},_on:function(f,w,R,U){if(typeof w!="function"){console.warn("wrong listener type: "+typeof w);return}if(this._listens(f,w,R)===!1){R===this&&(R=void 0);var X={fn:w,ctx:R};U&&(X.once=!0),this._events=this._events||{},this._events[f]=this._events[f]||[],this._events[f].push(X)}},_off:function(f,w,R){var U,X,he;if(this._events&&(U=this._events[f],!!U)){if(arguments.length===1){if(this._firingCount)for(X=0,he=U.length;X<he;X++)U[X].fn=x;delete this._events[f];return}if(typeof w!="function"){console.warn("wrong listener type: "+typeof w);return}var Fe=this._listens(f,w,R);if(Fe!==!1){var it=U[Fe];this._firingCount&&(it.fn=x,this._events[f]=U=U.slice()),U.splice(Fe,1)}}},fire:function(f,w,R){if(!this.listens(f,R))return this;var U=n({},w,{type:f,target:this,sourceTarget:w&&w.sourceTarget||this});if(this._events){var X=this._events[f];if(X){this._firingCount=this._firingCount+1||1;for(var he=0,Fe=X.length;he<Fe;he++){var it=X[he],mt=it.fn;it.once&&this.off(f,mt,it.ctx),mt.call(it.ctx||this,U)}this._firingCount--}}return R&&this._propagateEvent(U),this},listens:function(f,w,R,U){typeof f!="string"&&console.warn('"string" type argument expected');var X=w;typeof w!="function"&&(U=!!w,X=void 0,R=void 0);var he=this._events&&this._events[f];if(he&&he.length&&this._listens(f,X,R)!==!1)return!0;if(U){for(var Fe in this._eventParents)if(this._eventParents[Fe].listens(f,w,R,U))return!0}return!1},_listens:function(f,w,R){if(!this._events)return!1;var U=this._events[f]||[];if(!w)return!!U.length;R===this&&(R=void 0);for(var X=0,he=U.length;X<he;X++)if(U[X].fn===w&&U[X].ctx===R)return X;return!1},once:function(f,w,R){if(typeof f=="object")for(var U in f)this._on(U,f[U],w,!0);else{f=N(f);for(var X=0,he=f.length;X<he;X++)this._on(f[X],w,R,!0)}return this},addEventParent:function(f){return this._eventParents=this._eventParents||{},this._eventParents[d(f)]=f,this},removeEventParent:function(f){return this._eventParents&&delete this._eventParents[d(f)],this},_propagateEvent:function(f){for(var w in this._eventParents)this._eventParents[w].fire(f.type,n({layer:f.target,propagatedFrom:f.target},f),!0)}};Z.addEventListener=Z.on,Z.removeEventListener=Z.clearAllEventListeners=Z.off,Z.addOneTimeEventListener=Z.once,Z.fireEvent=Z.fire,Z.hasEventListeners=Z.listens;var G=je.extend(Z);function Q(f,w,R){this.x=R?Math.round(f):f,this.y=R?Math.round(w):w}var re=Math.trunc||function(f){return f>0?Math.floor(f):Math.ceil(f)};Q.prototype={clone:function(){return new Q(this.x,this.y)},add:function(f){return this.clone()._add(le(f))},_add:function(f){return this.x+=f.x,this.y+=f.y,this},subtract:function(f){return this.clone()._subtract(le(f))},_subtract:function(f){return this.x-=f.x,this.y-=f.y,this},divideBy:function(f){return this.clone()._divideBy(f)},_divideBy:function(f){return this.x/=f,this.y/=f,this},multiplyBy:function(f){return this.clone()._multiplyBy(f)},_multiplyBy:function(f){return this.x*=f,this.y*=f,this},scaleBy:function(f){return new Q(this.x*f.x,this.y*f.y)},unscaleBy:function(f){return new Q(this.x/f.x,this.y/f.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=re(this.x),this.y=re(this.y),this},distanceTo:function(f){f=le(f);var w=f.x-this.x,R=f.y-this.y;return Math.sqrt(w*w+R*R)},equals:function(f){return f=le(f),f.x===this.x&&f.y===this.y},contains:function(f){return f=le(f),Math.abs(f.x)<=Math.abs(this.x)&&Math.abs(f.y)<=Math.abs(this.y)},toString:function(){return"Point("+v(this.x)+", "+v(this.y)+")"}};function le(f,w,R){return f instanceof Q?f:k(f)?new Q(f[0],f[1]):f==null?f:typeof f=="object"&&"x"in f&&"y"in f?new Q(f.x,f.y):new Q(f,w,R)}function ye(f,w){if(f)for(var R=w?[f,w]:f,U=0,X=R.length;U<X;U++)this.extend(R[U])}ye.prototype={extend:function(f){var w,R;if(!f)return this;if(f instanceof Q||typeof f[0]=="number"||"x"in f)w=R=le(f);else if(f=W(f),w=f.min,R=f.max,!w||!R)return this;return!this.min&&!this.max?(this.min=w.clone(),this.max=R.clone()):(this.min.x=Math.min(w.x,this.min.x),this.max.x=Math.max(R.x,this.max.x),this.min.y=Math.min(w.y,this.min.y),this.max.y=Math.max(R.y,this.max.y)),this},getCenter:function(f){return le((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,f)},getBottomLeft:function(){return le(this.min.x,this.max.y)},getTopRight:function(){return le(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(f){var w,R;return typeof f[0]=="number"||f instanceof Q?f=le(f):f=W(f),f instanceof ye?(w=f.min,R=f.max):w=R=f,w.x>=this.min.x&&R.x<=this.max.x&&w.y>=this.min.y&&R.y<=this.max.y},intersects:function(f){f=W(f);var w=this.min,R=this.max,U=f.min,X=f.max,he=X.x>=w.x&&U.x<=R.x,Fe=X.y>=w.y&&U.y<=R.y;return he&&Fe},overlaps:function(f){f=W(f);var w=this.min,R=this.max,U=f.min,X=f.max,he=X.x>w.x&&U.x<R.x,Fe=X.y>w.y&&U.y<R.y;return he&&Fe},isValid:function(){return!!(this.min&&this.max)},pad:function(f){var w=this.min,R=this.max,U=Math.abs(w.x-R.x)*f,X=Math.abs(w.y-R.y)*f;return W(le(w.x-U,w.y-X),le(R.x+U,R.y+X))},equals:function(f){return f?(f=W(f),this.min.equals(f.getTopLeft())&&this.max.equals(f.getBottomRight())):!1}};function W(f,w){return!f||f instanceof ye?f:new ye(f,w)}function ee(f,w){if(f)for(var R=w?[f,w]:f,U=0,X=R.length;U<X;U++)this.extend(R[U])}ee.prototype={extend:function(f){var w=this._southWest,R=this._northEast,U,X;if(f instanceof ce)U=f,X=f;else if(f instanceof ee){if(U=f._southWest,X=f._northEast,!U||!X)return this}else return f?this.extend(xe(f)||ie(f)):this;return!w&&!R?(this._southWest=new ce(U.lat,U.lng),this._northEast=new ce(X.lat,X.lng)):(w.lat=Math.min(U.lat,w.lat),w.lng=Math.min(U.lng,w.lng),R.lat=Math.max(X.lat,R.lat),R.lng=Math.max(X.lng,R.lng)),this},pad:function(f){var w=this._southWest,R=this._northEast,U=Math.abs(w.lat-R.lat)*f,X=Math.abs(w.lng-R.lng)*f;return new ee(new ce(w.lat-U,w.lng-X),new ce(R.lat+U,R.lng+X))},getCenter:function(){return new ce((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ce(this.getNorth(),this.getWest())},getSouthEast:function(){return new ce(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(f){typeof f[0]=="number"||f instanceof ce||"lat"in f?f=xe(f):f=ie(f);var w=this._southWest,R=this._northEast,U,X;return f instanceof ee?(U=f.getSouthWest(),X=f.getNorthEast()):U=X=f,U.lat>=w.lat&&X.lat<=R.lat&&U.lng>=w.lng&&X.lng<=R.lng},intersects:function(f){f=ie(f);var w=this._southWest,R=this._northEast,U=f.getSouthWest(),X=f.getNorthEast(),he=X.lat>=w.lat&&U.lat<=R.lat,Fe=X.lng>=w.lng&&U.lng<=R.lng;return he&&Fe},overlaps:function(f){f=ie(f);var w=this._southWest,R=this._northEast,U=f.getSouthWest(),X=f.getNorthEast(),he=X.lat>w.lat&&U.lat<R.lat,Fe=X.lng>w.lng&&U.lng<R.lng;return he&&Fe},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(f,w){return f?(f=ie(f),this._southWest.equals(f.getSouthWest(),w)&&this._northEast.equals(f.getNorthEast(),w)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ie(f,w){return f instanceof ee?f:new ee(f,w)}function ce(f,w,R){if(isNaN(f)||isNaN(w))throw new Error("Invalid LatLng object: ("+f+", "+w+")");this.lat=+f,this.lng=+w,R!==void 0&&(this.alt=+R)}ce.prototype={equals:function(f,w){if(!f)return!1;f=xe(f);var R=Math.max(Math.abs(this.lat-f.lat),Math.abs(this.lng-f.lng));return R<=(w===void 0?1e-9:w)},toString:function(f){return"LatLng("+v(this.lat,f)+", "+v(this.lng,f)+")"},distanceTo:function(f){return me.distance(this,xe(f))},wrap:function(){return me.wrapLatLng(this)},toBounds:function(f){var w=180*f/40075017,R=w/Math.cos(Math.PI/180*this.lat);return ie([this.lat-w,this.lng-R],[this.lat+w,this.lng+R])},clone:function(){return new ce(this.lat,this.lng,this.alt)}};function xe(f,w,R){return f instanceof ce?f:k(f)&&typeof f[0]!="object"?f.length===3?new ce(f[0],f[1],f[2]):f.length===2?new ce(f[0],f[1]):null:f==null?f:typeof f=="object"&&"lat"in f?new ce(f.lat,"lng"in f?f.lng:f.lon,f.alt):w===void 0?null:new ce(f,w,R)}var Ce={latLngToPoint:function(f,w){var R=this.projection.project(f),U=this.scale(w);return this.transformation._transform(R,U)},pointToLatLng:function(f,w){var R=this.scale(w),U=this.transformation.untransform(f,R);return this.projection.unproject(U)},project:function(f){return this.projection.project(f)},unproject:function(f){return this.projection.unproject(f)},scale:function(f){return 256*Math.pow(2,f)},zoom:function(f){return Math.log(f/256)/Math.LN2},getProjectedBounds:function(f){if(this.infinite)return null;var w=this.projection.bounds,R=this.scale(f),U=this.transformation.transform(w.min,R),X=this.transformation.transform(w.max,R);return new ye(U,X)},infinite:!1,wrapLatLng:function(f){var w=this.wrapLng?p(f.lng,this.wrapLng,!0):f.lng,R=this.wrapLat?p(f.lat,this.wrapLat,!0):f.lat,U=f.alt;return new ce(R,w,U)},wrapLatLngBounds:function(f){var w=f.getCenter(),R=this.wrapLatLng(w),U=w.lat-R.lat,X=w.lng-R.lng;if(U===0&&X===0)return f;var he=f.getSouthWest(),Fe=f.getNorthEast(),it=new ce(he.lat-U,he.lng-X),mt=new ce(Fe.lat-U,Fe.lng-X);return new ee(it,mt)}},me=n({},Ce,{wrapLng:[-180,180],R:6371e3,distance:function(f,w){var R=Math.PI/180,U=f.lat*R,X=w.lat*R,he=Math.sin((w.lat-f.lat)*R/2),Fe=Math.sin((w.lng-f.lng)*R/2),it=he*he+Math.cos(U)*Math.cos(X)*Fe*Fe,mt=2*Math.atan2(Math.sqrt(it),Math.sqrt(1-it));return this.R*mt}}),fe=6378137,ve={R:fe,MAX_LATITUDE:85.0511287798,project:function(f){var w=Math.PI/180,R=this.MAX_LATITUDE,U=Math.max(Math.min(R,f.lat),-R),X=Math.sin(U*w);return new Q(this.R*f.lng*w,this.R*Math.log((1+X)/(1-X))/2)},unproject:function(f){var w=180/Math.PI;return new ce((2*Math.atan(Math.exp(f.y/this.R))-Math.PI/2)*w,f.x*w/this.R)},bounds:function(){var f=fe*Math.PI;return new ye([-f,-f],[f,f])}()};function ne(f,w,R,U){if(k(f)){this._a=f[0],this._b=f[1],this._c=f[2],this._d=f[3];return}this._a=f,this._b=w,this._c=R,this._d=U}ne.prototype={transform:function(f,w){return this._transform(f.clone(),w)},_transform:function(f,w){return w=w||1,f.x=w*(this._a*f.x+this._b),f.y=w*(this._c*f.y+this._d),f},untransform:function(f,w){return w=w||1,new Q((f.x/w-this._b)/this._a,(f.y/w-this._d)/this._c)}};function Me(f,w,R,U){return new ne(f,w,R,U)}var Ie=n({},me,{code:"EPSG:3857",projection:ve,transformation:function(){var f=.5/(Math.PI*ve.R);return Me(f,.5,-f,.5)}()}),Be=n({},Ie,{code:"EPSG:900913"});function ot(f){return document.createElementNS("http://www.w3.org/2000/svg",f)}function Se(f,w){var R="",U,X,he,Fe,it,mt;for(U=0,he=f.length;U<he;U++){for(it=f[U],X=0,Fe=it.length;X<Fe;X++)mt=it[X],R+=(X?"L":"M")+mt.x+" "+mt.y;R+=w?Gt.svg?"z":"x":""}return R||"M0 0"}var ze=document.documentElement.style,we="ActiveXObject"in window,Le=we&&!document.addEventListener,Nt="msLaunchUri"in navigator&&!("documentMode"in document),Ge=Or("webkit"),Lt=Or("android"),ps=Or("android 2")||Or("android 3"),ns=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ke=Lt&&Or("Google")&&ns<537&&!("AudioNode"in window),dt=!!window.opera,It=!Nt&&Or("chrome"),Ut=Or("gecko")&&!Ge&&!dt&&!we,ts=!It&&Or("safari"),us=Or("phantom"),qe="OTransition"in ze,jt=navigator.platform.indexOf("Win")===0,_t=we&&"transition"in ze,Re="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ps,et="MozPerspective"in ze,Ct=!window.L_DISABLE_3D&&(_t||Re||et)&&!qe&&!us,Yt=typeof orientation<"u"||Or("mobile"),bt=Yt&&Ge,Dt=Yt&&Re,Jt=!window.PointerEvent&&window.MSPointerEvent,Oe=!!(window.PointerEvent||Jt),Xe="ontouchstart"in window||!!window.TouchEvent,zt=!window.L_NO_TOUCH&&(Xe||Oe),qt=Yt&&dt,St=Yt&&Ut,ls=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,is=function(){var f=!1;try{var w=Object.defineProperty({},"passive",{get:function(){f=!0}});window.addEventListener("testPassiveEventSupport",x,w),window.removeEventListener("testPassiveEventSupport",x,w)}catch{}return f}(),ws=function(){return!!document.createElement("canvas").getContext}(),Bs=!!(document.createElementNS&&ot("svg").createSVGRect),js=!!Bs&&function(){var f=document.createElement("div");return f.innerHTML="<svg/>",(f.firstChild&&f.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),ha=!Bs&&function(){try{var f=document.createElement("div");f.innerHTML='<v:shape adj="1"/>';var w=f.firstChild;return w.style.behavior="url(#default#VML)",w&&typeof w.adj=="object"}catch{return!1}}(),$r=navigator.platform.indexOf("Mac")===0,_a=navigator.platform.indexOf("Linux")===0;function Or(f){return navigator.userAgent.toLowerCase().indexOf(f)>=0}var Gt={ie:we,ielt9:Le,edge:Nt,webkit:Ge,android:Lt,android23:ps,androidStock:Ke,opera:dt,chrome:It,gecko:Ut,safari:ts,phantom:us,opera12:qe,win:jt,ie3d:_t,webkit3d:Re,gecko3d:et,any3d:Ct,mobile:Yt,mobileWebkit:bt,mobileWebkit3d:Dt,msPointer:Jt,pointer:Oe,touch:zt,touchNative:Xe,mobileOpera:qt,mobileGecko:St,retina:ls,passiveEvents:is,canvas:ws,svg:Bs,vml:ha,inlineSvg:js,mac:$r,linux:_a},de=Gt.msPointer?"MSPointerDown":"pointerdown",pe=Gt.msPointer?"MSPointerMove":"pointermove",ge=Gt.msPointer?"MSPointerUp":"pointerup",be=Gt.msPointer?"MSPointerCancel":"pointercancel",Te={touchstart:de,touchmove:pe,touchend:ge,touchcancel:be},Pe={touchstart:Xt,touchmove:Mt,touchend:Mt,touchcancel:Mt},nt={},vt=!1;function tt(f,w,R){return w==="touchstart"&&Ft(),Pe[w]?(R=Pe[w].bind(this,R),f.addEventListener(Te[w],R,!1),R):(console.warn("wrong event specified:",w),x)}function lt(f,w,R){if(!Te[w]){console.warn("wrong event specified:",w);return}f.removeEventListener(Te[w],R,!1)}function ut(f){nt[f.pointerId]=f}function kt(f){nt[f.pointerId]&&(nt[f.pointerId]=f)}function Ot(f){delete nt[f.pointerId]}function Ft(){vt||(document.addEventListener(de,ut,!0),document.addEventListener(pe,kt,!0),document.addEventListener(ge,Ot,!0),document.addEventListener(be,Ot,!0),vt=!0)}function Mt(f,w){if(w.pointerType!==(w.MSPOINTER_TYPE_MOUSE||"mouse")){w.touches=[];for(var R in nt)w.touches.push(nt[R]);w.changedTouches=[w],f(w)}}function Xt(f,w){w.MSPOINTER_TYPE_TOUCH&&w.pointerType===w.MSPOINTER_TYPE_TOUCH&&tn(w),Mt(f,w)}function Ds(f){var w={},R,U;for(U in f)R=f[U],w[U]=R&&R.bind?R.bind(f):R;return f=w,w.type="dblclick",w.detail=2,w.isTrusted=!1,w._simulated=!0,w}var gt=200;function ea(f,w){f.addEventListener("dblclick",w);var R=0,U;function X(he){if(he.detail!==1){U=he.detail;return}if(!(he.pointerType==="mouse"||he.sourceCapabilities&&!he.sourceCapabilities.firesTouchEvents)){var Fe=Ac(he);if(!(Fe.some(function(mt){return mt instanceof HTMLLabelElement&&mt.attributes.for})&&!Fe.some(function(mt){return mt instanceof HTMLInputElement||mt instanceof HTMLSelectElement}))){var it=Date.now();it-R<=gt?(U++,U===2&&w(Ds(he))):U=1,R=it}}}return f.addEventListener("click",X),{dblclick:w,simDblclick:X}}function or(f,w){f.removeEventListener("dblclick",w.dblclick),f.removeEventListener("click",w.simDblclick)}var Ln=at(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Mi=at(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),fr=Mi==="webkitTransition"||Mi==="OTransition"?Mi+"End":"transitionend";function rr(f){return typeof f=="string"?document.getElementById(f):f}function Ks(f,w){var R=f.style[w]||f.currentStyle&&f.currentStyle[w];if((!R||R==="auto")&&document.defaultView){var U=document.defaultView.getComputedStyle(f,null);R=U?U[w]:null}return R==="auto"?null:R}function Hs(f,w,R){var U=document.createElement(f);return U.className=w||"",R&&R.appendChild(U),U}function ta(f){var w=f.parentNode;w&&w.removeChild(f)}function Tc(f){for(;f.firstChild;)f.removeChild(f.firstChild)}function aa(f){var w=f.parentNode;w&&w.lastChild!==f&&w.appendChild(f)}function si(f){var w=f.parentNode;w&&w.firstChild!==f&&w.insertBefore(f,w.firstChild)}function Zf(f,w){if(f.classList!==void 0)return f.classList.contains(w);var R=Po(f);return R.length>0&&new RegExp("(^|\\s)"+w+"(\\s|$)").test(R)}function xs(f,w){if(f.classList!==void 0)for(var R=N(w),U=0,X=R.length;U<X;U++)f.classList.add(R[U]);else if(!Zf(f,w)){var he=Po(f);Qf(f,(he?he+" ":"")+w)}}function Mr(f,w){f.classList!==void 0?f.classList.remove(w):Qf(f,b((" "+Po(f)+" ").replace(" "+w+" "," ")))}function Qf(f,w){f.className.baseVal===void 0?f.className=w:f.className.baseVal=w}function Po(f){return f.correspondingElement&&(f=f.correspondingElement),f.className.baseVal===void 0?f.className:f.className.baseVal}function mr(f,w){"opacity"in f.style?f.style.opacity=w:"filter"in f.style&&mn(f,w)}function mn(f,w){var R=!1,U="DXImageTransform.Microsoft.Alpha";try{R=f.filters.item(U)}catch{if(w===1)return}w=Math.round(w*100),R?(R.Enabled=w!==100,R.Opacity=w):f.style.filter+=" progid:"+U+"(opacity="+w+")"}function at(f){for(var w=document.documentElement.style,R=0;R<f.length;R++)if(f[R]in w)return f[R];return!1}function _e(f,w,R){var U=w||new Q(0,0);f.style[Ln]=(Gt.ie3d?"translate("+U.x+"px,"+U.y+"px)":"translate3d("+U.x+"px,"+U.y+"px,0)")+(R?" scale("+R+")":"")}function Zt(f,w){f._leaflet_pos=w,Gt.any3d?_e(f,w):(f.style.left=w.x+"px",f.style.top=w.y+"px")}function na(f){return f._leaflet_pos||new Q(0,0)}var pn,$d,qd;if("onselectstart"in document)pn=function(){Vs(window,"selectstart",tn)},$d=function(){Qt(window,"selectstart",tn)};else{var xn=at(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);pn=function(){if(xn){var f=document.documentElement.style;qd=f[xn],f[xn]="none"}},$d=function(){xn&&(document.documentElement.style[xn]=qd,qd=void 0)}}function Ns(){Vs(window,"dragstart",tn)}function sa(){Qt(window,"dragstart",tn)}var Wd,Jf;function Hd(f){for(;f.tabIndex===-1;)f=f.parentNode;f.style&&(Gl(),Wd=f,Jf=f.style.outlineStyle,f.style.outlineStyle="none",Vs(window,"keydown",Gl))}function Gl(){Wd&&(Wd.style.outlineStyle=Jf,Wd=void 0,Jf=void 0,Qt(window,"keydown",Gl))}function Qu(f){do f=f.parentNode;while((!f.offsetWidth||!f.offsetHeight)&&f!==document.body);return f}function em(f){var w=f.getBoundingClientRect();return{x:w.width/f.offsetWidth||1,y:w.height/f.offsetHeight||1,boundingClientRect:w}}var za={__proto__:null,TRANSFORM:Ln,TRANSITION:Mi,TRANSITION_END:fr,get:rr,getStyle:Ks,create:Hs,remove:ta,empty:Tc,toFront:aa,toBack:si,hasClass:Zf,addClass:xs,removeClass:Mr,setClass:Qf,getClass:Po,setOpacity:mr,testProp:at,setTransform:_e,setPosition:Zt,getPosition:na,get disableTextSelection(){return pn},get enableTextSelection(){return $d},disableImageDrag:Ns,enableImageDrag:sa,preventOutline:Hd,restoreOutline:Gl,getSizedParentNode:Qu,getScale:em};function Vs(f,w,R,U){if(w&&typeof w=="object")for(var X in w)La(f,X,w[X],R);else{w=N(w);for(var he=0,Fe=w.length;he<Fe;he++)La(f,w[he],R,U)}return this}var en="_leaflet_events";function Qt(f,w,R,U){if(arguments.length===1)y0(f),delete f[en];else if(w&&typeof w=="object")for(var X in w)tm(f,X,w[X],R);else if(w=N(w),arguments.length===2)y0(f,function(it){return I(w,it)!==-1});else for(var he=0,Fe=w.length;he<Fe;he++)tm(f,w[he],R,U);return this}function y0(f,w){for(var R in f[en]){var U=R.split(/\d/)[0];(!w||w(U))&&tm(f,U,null,null,R)}}var Xs={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function La(f,w,R,U){var X=w+d(R)+(U?"_"+d(U):"");if(f[en]&&f[en][X])return this;var he=function(it){return R.call(U||f,it||window.event)},Fe=he;!Gt.touchNative&&Gt.pointer&&w.indexOf("touch")===0?he=tt(f,w,he):Gt.touch&&w==="dblclick"?he=ea(f,he):"addEventListener"in f?w==="touchstart"||w==="touchmove"||w==="wheel"||w==="mousewheel"?f.addEventListener(Xs[w]||w,he,Gt.passiveEvents?{passive:!1}:!1):w==="mouseenter"||w==="mouseleave"?(he=function(it){it=it||window.event,Kl(f,it)&&Fe(it)},f.addEventListener(Xs[w],he,!1)):f.addEventListener(w,Fe,!1):f.attachEvent("on"+w,he),f[en]=f[en]||{},f[en][X]=he}function tm(f,w,R,U,X){X=X||w+d(R)+(U?"_"+d(U):"");var he=f[en]&&f[en][X];if(!he)return this;!Gt.touchNative&&Gt.pointer&&w.indexOf("touch")===0?lt(f,w,he):Gt.touch&&w==="dblclick"?or(f,he):"removeEventListener"in f?f.removeEventListener(Xs[w]||w,he,!1):f.detachEvent("on"+w,he),f[en][X]=null}function Io(f){return f.stopPropagation?f.stopPropagation():f.originalEvent?f.originalEvent._stopped=!0:f.cancelBubble=!0,this}function Ju(f){return La(f,"wheel",Io),this}function Li(f){return Vs(f,"mousedown touchstart dblclick contextmenu",Io),f._leaflet_disable_click=!0,this}function tn(f){return f.preventDefault?f.preventDefault():f.returnValue=!1,this}function Fi(f){return tn(f),Io(f),this}function Ac(f){if(f.composedPath)return f.composedPath();for(var w=[],R=f.target;R;)w.push(R),R=R.parentNode;return w}function kc(f,w){if(!w)return new Q(f.clientX,f.clientY);var R=em(w),U=R.boundingClientRect;return new Q((f.clientX-U.left)/R.x-w.clientLeft,(f.clientY-U.top)/R.y-w.clientTop)}var w0=Gt.linux&&Gt.chrome?window.devicePixelRatio:Gt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Rc(f){return Gt.edge?f.wheelDeltaY/2:f.deltaY&&f.deltaMode===0?-f.deltaY/w0:f.deltaY&&f.deltaMode===1?-f.deltaY*20:f.deltaY&&f.deltaMode===2?-f.deltaY*60:f.deltaX||f.deltaZ?0:f.wheelDelta?(f.wheelDeltaY||f.wheelDelta)/2:f.detail&&Math.abs(f.detail)<32765?-f.detail*20:f.detail?f.detail/-32765*60:0}function Kl(f,w){var R=w.relatedTarget;if(!R)return!0;try{for(;R&&R!==f;)R=R.parentNode}catch{return!1}return R!==f}var Fn={__proto__:null,on:Vs,off:Qt,stopPropagation:Io,disableScrollPropagation:Ju,disableClickPropagation:Li,preventDefault:tn,stop:Fi,getPropagationPath:Ac,getMousePosition:kc,getWheelDelta:Rc,isExternalTarget:Kl,addListener:Vs,removeListener:Qt},sm=G.extend({run:function(f,w,R,U){this.stop(),this._el=f,this._inProgress=!0,this._duration=R||.25,this._easeOutPower=1/Math.max(U||.5,.2),this._startPos=na(f),this._offset=w.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=q(this._animate,this),this._step()},_step:function(f){var w=+new Date-this._startTime,R=this._duration*1e3;w<R?this._runFrame(this._easeOut(w/R),f):(this._runFrame(1),this._complete())},_runFrame:function(f,w){var R=this._startPos.add(this._offset.multiplyBy(f));w&&R._round(),Zt(this._el,R),this.fire("step")},_complete:function(){Y(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(f){return 1-Math.pow(1-f,this._easeOutPower)}}),wr=G.extend({options:{crs:Ie,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(f,w){w=_(this,w),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(f),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),w.maxBounds&&this.setMaxBounds(w.maxBounds),w.zoom!==void 0&&(this._zoom=this._limitZoom(w.zoom)),w.center&&w.zoom!==void 0&&this.setView(xe(w.center),w.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Mi&&Gt.any3d&&!Gt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Vs(this._proxy,fr,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(f,w,R){if(w=w===void 0?this._zoom:this._limitZoom(w),f=this._limitCenter(xe(f),w,this.options.maxBounds),R=R||{},this._stop(),this._loaded&&!R.reset&&R!==!0){R.animate!==void 0&&(R.zoom=n({animate:R.animate},R.zoom),R.pan=n({animate:R.animate,duration:R.duration},R.pan));var U=this._zoom!==w?this._tryAnimatedZoom&&this._tryAnimatedZoom(f,w,R.zoom):this._tryAnimatedPan(f,R.pan);if(U)return clearTimeout(this._sizeTimer),this}return this._resetView(f,w,R.pan&&R.pan.noMoveStart),this},setZoom:function(f,w){return this._loaded?this.setView(this.getCenter(),f,{zoom:w}):(this._zoom=f,this)},zoomIn:function(f,w){return f=f||(Gt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+f,w)},zoomOut:function(f,w){return f=f||(Gt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-f,w)},setZoomAround:function(f,w,R){var U=this.getZoomScale(w),X=this.getSize().divideBy(2),he=f instanceof Q?f:this.latLngToContainerPoint(f),Fe=he.subtract(X).multiplyBy(1-1/U),it=this.containerPointToLatLng(X.add(Fe));return this.setView(it,w,{zoom:R})},_getBoundsCenterZoom:function(f,w){w=w||{},f=f.getBounds?f.getBounds():ie(f);var R=le(w.paddingTopLeft||w.padding||[0,0]),U=le(w.paddingBottomRight||w.padding||[0,0]),X=this.getBoundsZoom(f,!1,R.add(U));if(X=typeof w.maxZoom=="number"?Math.min(w.maxZoom,X):X,X===1/0)return{center:f.getCenter(),zoom:X};var he=U.subtract(R).divideBy(2),Fe=this.project(f.getSouthWest(),X),it=this.project(f.getNorthEast(),X),mt=this.unproject(Fe.add(it).divideBy(2).add(he),X);return{center:mt,zoom:X}},fitBounds:function(f,w){if(f=ie(f),!f.isValid())throw new Error("Bounds are not valid.");var R=this._getBoundsCenterZoom(f,w);return this.setView(R.center,R.zoom,w)},fitWorld:function(f){return this.fitBounds([[-90,-180],[90,180]],f)},panTo:function(f,w){return this.setView(f,this._zoom,{pan:w})},panBy:function(f,w){if(f=le(f).round(),w=w||{},!f.x&&!f.y)return this.fire("moveend");if(w.animate!==!0&&!this.getSize().contains(f))return this._resetView(this.unproject(this.project(this.getCenter()).add(f)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new sm,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),w.noMoveStart||this.fire("movestart"),w.animate!==!1){xs(this._mapPane,"leaflet-pan-anim");var R=this._getMapPanePos().subtract(f).round();this._panAnim.run(this._mapPane,R,w.duration||.25,w.easeLinearity)}else this._rawPanBy(f),this.fire("move").fire("moveend");return this},flyTo:function(f,w,R){if(R=R||{},R.animate===!1||!Gt.any3d)return this.setView(f,w,R);this._stop();var U=this.project(this.getCenter()),X=this.project(f),he=this.getSize(),Fe=this._zoom;f=xe(f),w=w===void 0?Fe:w;var it=Math.max(he.x,he.y),mt=it*this.getZoomScale(Fe,w),Rt=X.distanceTo(U)||1,ss=1.42,Ms=ss*ss;function vr(qa){var T0=qa?-1:1,I8=qa?mt:it,O8=mt*mt-it*it+T0*Ms*Ms*Rt*Rt,D8=2*I8*Ms*Rt,y1=O8/D8,I2=Math.sqrt(y1*y1+1)-y1,M8=I2<1e-9?-18:Math.log(I2);return M8}function ii(qa){return(Math.exp(qa)-Math.exp(-qa))/2}function gn(qa){return(Math.exp(qa)+Math.exp(-qa))/2}function co(qa){return ii(qa)/gn(qa)}var ji=vr(0);function ah(qa){return it*(gn(ji)/gn(ji+ss*qa))}function A8(qa){return it*(gn(ji)*co(ji+ss*qa)-ii(ji))/Ms}function k8(qa){return 1-Math.pow(1-qa,1.5)}var R8=Date.now(),R2=(vr(1)-ji)/ss,P8=R.duration?1e3*R.duration:1e3*R2*.8;function P2(){var qa=(Date.now()-R8)/P8,T0=k8(qa)*R2;qa<=1?(this._flyToFrame=q(P2,this),this._move(this.unproject(U.add(X.subtract(U).multiplyBy(A8(T0)/Rt)),Fe),this.getScaleZoom(it/ah(T0),Fe),{flyTo:!0})):this._move(f,w)._moveEnd(!0)}return this._moveStart(!0,R.noMoveStart),P2.call(this),this},flyToBounds:function(f,w){var R=this._getBoundsCenterZoom(f,w);return this.flyTo(R.center,R.zoom,w)},setMaxBounds:function(f){return f=ie(f),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),f.isValid()?(this.options.maxBounds=f,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(f){var w=this.options.minZoom;return this.options.minZoom=f,this._loaded&&w!==f&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(f):this},setMaxZoom:function(f){var w=this.options.maxZoom;return this.options.maxZoom=f,this._loaded&&w!==f&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(f):this},panInsideBounds:function(f,w){this._enforcingBounds=!0;var R=this.getCenter(),U=this._limitCenter(R,this._zoom,ie(f));return R.equals(U)||this.panTo(U,w),this._enforcingBounds=!1,this},panInside:function(f,w){w=w||{};var R=le(w.paddingTopLeft||w.padding||[0,0]),U=le(w.paddingBottomRight||w.padding||[0,0]),X=this.project(this.getCenter()),he=this.project(f),Fe=this.getPixelBounds(),it=W([Fe.min.add(R),Fe.max.subtract(U)]),mt=it.getSize();if(!it.contains(he)){this._enforcingBounds=!0;var Rt=he.subtract(it.getCenter()),ss=it.extend(he).getSize().subtract(mt);X.x+=Rt.x<0?-ss.x:ss.x,X.y+=Rt.y<0?-ss.y:ss.y,this.panTo(this.unproject(X),w),this._enforcingBounds=!1}return this},invalidateSize:function(f){if(!this._loaded)return this;f=n({animate:!1,pan:!0},f===!0?{animate:!0}:f);var w=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var R=this.getSize(),U=w.divideBy(2).round(),X=R.divideBy(2).round(),he=U.subtract(X);return!he.x&&!he.y?this:(f.animate&&f.pan?this.panBy(he):(f.pan&&this._rawPanBy(he),this.fire("move"),f.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:w,newSize:R}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(f){if(f=this._locateOptions=n({timeout:1e4,watch:!1},f),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var w=o(this._handleGeolocationResponse,this),R=o(this._handleGeolocationError,this);return f.watch?this._locationWatchId=navigator.geolocation.watchPosition(w,R,f):navigator.geolocation.getCurrentPosition(w,R,f),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(f){if(this._container._leaflet_id){var w=f.code,R=f.message||(w===1?"permission denied":w===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:w,message:"Geolocation error: "+R+"."})}},_handleGeolocationResponse:function(f){if(this._container._leaflet_id){var w=f.coords.latitude,R=f.coords.longitude,U=new ce(w,R),X=U.toBounds(f.coords.accuracy*2),he=this._locateOptions;if(he.setView){var Fe=this.getBoundsZoom(X);this.setView(U,he.maxZoom?Math.min(Fe,he.maxZoom):Fe)}var it={latlng:U,bounds:X,timestamp:f.timestamp};for(var mt in f.coords)typeof f.coords[mt]=="number"&&(it[mt]=f.coords[mt]);this.fire("locationfound",it)}},addHandler:function(f,w){if(!w)return this;var R=this[f]=new w(this);return this._handlers.push(R),this.options[f]&&R.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),ta(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Y(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var f;for(f in this._layers)this._layers[f].remove();for(f in this._panes)ta(this._panes[f]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(f,w){var R="leaflet-pane"+(f?" leaflet-"+f.replace("Pane","")+"-pane":""),U=Hs("div",R,w||this._mapPane);return f&&(this._panes[f]=U),U},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var f=this.getPixelBounds(),w=this.unproject(f.getBottomLeft()),R=this.unproject(f.getTopRight());return new ee(w,R)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(f,w,R){f=ie(f),R=le(R||[0,0]);var U=this.getZoom()||0,X=this.getMinZoom(),he=this.getMaxZoom(),Fe=f.getNorthWest(),it=f.getSouthEast(),mt=this.getSize().subtract(R),Rt=W(this.project(it,U),this.project(Fe,U)).getSize(),ss=Gt.any3d?this.options.zoomSnap:1,Ms=mt.x/Rt.x,vr=mt.y/Rt.y,ii=w?Math.max(Ms,vr):Math.min(Ms,vr);return U=this.getScaleZoom(ii,U),ss&&(U=Math.round(U/(ss/100))*(ss/100),U=w?Math.ceil(U/ss)*ss:Math.floor(U/ss)*ss),Math.max(X,Math.min(he,U))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Q(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(f,w){var R=this._getTopLeftPoint(f,w);return new ye(R,R.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(f){return this.options.crs.getProjectedBounds(f===void 0?this.getZoom():f)},getPane:function(f){return typeof f=="string"?this._panes[f]:f},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(f,w){var R=this.options.crs;return w=w===void 0?this._zoom:w,R.scale(f)/R.scale(w)},getScaleZoom:function(f,w){var R=this.options.crs;w=w===void 0?this._zoom:w;var U=R.zoom(f*R.scale(w));return isNaN(U)?1/0:U},project:function(f,w){return w=w===void 0?this._zoom:w,this.options.crs.latLngToPoint(xe(f),w)},unproject:function(f,w){return w=w===void 0?this._zoom:w,this.options.crs.pointToLatLng(le(f),w)},layerPointToLatLng:function(f){var w=le(f).add(this.getPixelOrigin());return this.unproject(w)},latLngToLayerPoint:function(f){var w=this.project(xe(f))._round();return w._subtract(this.getPixelOrigin())},wrapLatLng:function(f){return this.options.crs.wrapLatLng(xe(f))},wrapLatLngBounds:function(f){return this.options.crs.wrapLatLngBounds(ie(f))},distance:function(f,w){return this.options.crs.distance(xe(f),xe(w))},containerPointToLayerPoint:function(f){return le(f).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(f){return le(f).add(this._getMapPanePos())},containerPointToLatLng:function(f){var w=this.containerPointToLayerPoint(le(f));return this.layerPointToLatLng(w)},latLngToContainerPoint:function(f){return this.layerPointToContainerPoint(this.latLngToLayerPoint(xe(f)))},mouseEventToContainerPoint:function(f){return kc(f,this._container)},mouseEventToLayerPoint:function(f){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(f))},mouseEventToLatLng:function(f){return this.layerPointToLatLng(this.mouseEventToLayerPoint(f))},_initContainer:function(f){var w=this._container=rr(f);if(w){if(w._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Vs(w,"scroll",this._onScroll,this),this._containerId=d(w)},_initLayout:function(){var f=this._container;this._fadeAnimated=this.options.fadeAnimation&&Gt.any3d,xs(f,"leaflet-container"+(Gt.touch?" leaflet-touch":"")+(Gt.retina?" leaflet-retina":"")+(Gt.ielt9?" leaflet-oldie":"")+(Gt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var w=Ks(f,"position");w!=="absolute"&&w!=="relative"&&w!=="fixed"&&w!=="sticky"&&(f.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var f=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Zt(this._mapPane,new Q(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(xs(f.markerPane,"leaflet-zoom-hide"),xs(f.shadowPane,"leaflet-zoom-hide"))},_resetView:function(f,w,R){Zt(this._mapPane,new Q(0,0));var U=!this._loaded;this._loaded=!0,w=this._limitZoom(w),this.fire("viewprereset");var X=this._zoom!==w;this._moveStart(X,R)._move(f,w)._moveEnd(X),this.fire("viewreset"),U&&this.fire("load")},_moveStart:function(f,w){return f&&this.fire("zoomstart"),w||this.fire("movestart"),this},_move:function(f,w,R,U){w===void 0&&(w=this._zoom);var X=this._zoom!==w;return this._zoom=w,this._lastCenter=f,this._pixelOrigin=this._getNewPixelOrigin(f),U?R&&R.pinch&&this.fire("zoom",R):((X||R&&R.pinch)&&this.fire("zoom",R),this.fire("move",R)),this},_moveEnd:function(f){return f&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Y(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(f){Zt(this._mapPane,this._getMapPanePos().subtract(f))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(f){this._targets={},this._targets[d(this._container)]=this;var w=f?Qt:Vs;w(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&w(window,"resize",this._onResize,this),Gt.any3d&&this.options.transform3DLimit&&(f?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Y(this._resizeRequest),this._resizeRequest=q(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var f=this._getMapPanePos();Math.max(Math.abs(f.x),Math.abs(f.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(f,w){for(var R=[],U,X=w==="mouseout"||w==="mouseover",he=f.target||f.srcElement,Fe=!1;he;){if(U=this._targets[d(he)],U&&(w==="click"||w==="preclick")&&this._draggableMoved(U)){Fe=!0;break}if(U&&U.listens(w,!0)&&(X&&!Kl(he,f)||(R.push(U),X))||he===this._container)break;he=he.parentNode}return!R.length&&!Fe&&!X&&this.listens(w,!0)&&(R=[this]),R},_isClickDisabled:function(f){for(;f&&f!==this._container;){if(f._leaflet_disable_click)return!0;f=f.parentNode}},_handleDOMEvent:function(f){var w=f.target||f.srcElement;if(!(!this._loaded||w._leaflet_disable_events||f.type==="click"&&this._isClickDisabled(w))){var R=f.type;R==="mousedown"&&Hd(w),this._fireDOMEvent(f,R)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(f,w,R){if(f.type==="click"){var U=n({},f);U.type="preclick",this._fireDOMEvent(U,U.type,R)}var X=this._findEventTargets(f,w);if(R){for(var he=[],Fe=0;Fe<R.length;Fe++)R[Fe].listens(w,!0)&&he.push(R[Fe]);X=he.concat(X)}if(X.length){w==="contextmenu"&&tn(f);var it=X[0],mt={originalEvent:f};if(f.type!=="keypress"&&f.type!=="keydown"&&f.type!=="keyup"){var Rt=it.getLatLng&&(!it._radius||it._radius<=10);mt.containerPoint=Rt?this.latLngToContainerPoint(it.getLatLng()):this.mouseEventToContainerPoint(f),mt.layerPoint=this.containerPointToLayerPoint(mt.containerPoint),mt.latlng=Rt?it.getLatLng():this.layerPointToLatLng(mt.layerPoint)}for(Fe=0;Fe<X.length;Fe++)if(X[Fe].fire(w,mt,!0),mt.originalEvent._stopped||X[Fe].options.bubblingMouseEvents===!1&&I(this._mouseEvents,w)!==-1)return}},_draggableMoved:function(f){return f=f.dragging&&f.dragging.enabled()?f:this,f.dragging&&f.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var f=0,w=this._handlers.length;f<w;f++)this._handlers[f].disable()},whenReady:function(f,w){return this._loaded?f.call(w||this,{target:this}):this.on("load",f,w),this},_getMapPanePos:function(){return na(this._mapPane)||new Q(0,0)},_moved:function(){var f=this._getMapPanePos();return f&&!f.equals([0,0])},_getTopLeftPoint:function(f,w){var R=f&&w!==void 0?this._getNewPixelOrigin(f,w):this.getPixelOrigin();return R.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(f,w){var R=this.getSize()._divideBy(2);return this.project(f,w)._subtract(R)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(f,w,R){var U=this._getNewPixelOrigin(R,w);return this.project(f,w)._subtract(U)},_latLngBoundsToNewLayerBounds:function(f,w,R){var U=this._getNewPixelOrigin(R,w);return W([this.project(f.getSouthWest(),w)._subtract(U),this.project(f.getNorthWest(),w)._subtract(U),this.project(f.getSouthEast(),w)._subtract(U),this.project(f.getNorthEast(),w)._subtract(U)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(f){return this.latLngToLayerPoint(f).subtract(this._getCenterLayerPoint())},_limitCenter:function(f,w,R){if(!R)return f;var U=this.project(f,w),X=this.getSize().divideBy(2),he=new ye(U.subtract(X),U.add(X)),Fe=this._getBoundsOffset(he,R,w);return Math.abs(Fe.x)<=1&&Math.abs(Fe.y)<=1?f:this.unproject(U.add(Fe),w)},_limitOffset:function(f,w){if(!w)return f;var R=this.getPixelBounds(),U=new ye(R.min.add(f),R.max.add(f));return f.add(this._getBoundsOffset(U,w))},_getBoundsOffset:function(f,w,R){var U=W(this.project(w.getNorthEast(),R),this.project(w.getSouthWest(),R)),X=U.min.subtract(f.min),he=U.max.subtract(f.max),Fe=this._rebound(X.x,-he.x),it=this._rebound(X.y,-he.y);return new Q(Fe,it)},_rebound:function(f,w){return f+w>0?Math.round(f-w)/2:Math.max(0,Math.ceil(f))-Math.max(0,Math.floor(w))},_limitZoom:function(f){var w=this.getMinZoom(),R=this.getMaxZoom(),U=Gt.any3d?this.options.zoomSnap:1;return U&&(f=Math.round(f/U)*U),Math.max(w,Math.min(R,f))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Mr(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(f,w){var R=this._getCenterOffset(f)._trunc();return(w&&w.animate)!==!0&&!this.getSize().contains(R)?!1:(this.panBy(R,w),!0)},_createAnimProxy:function(){var f=this._proxy=Hs("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(f),this.on("zoomanim",function(w){var R=Ln,U=this._proxy.style[R];_e(this._proxy,this.project(w.center,w.zoom),this.getZoomScale(w.zoom,1)),U===this._proxy.style[R]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ta(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var f=this.getCenter(),w=this.getZoom();_e(this._proxy,this.project(f,w),this.getZoomScale(w,1))},_catchTransitionEnd:function(f){this._animatingZoom&&f.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(f,w,R){if(this._animatingZoom)return!0;if(R=R||{},!this._zoomAnimated||R.animate===!1||this._nothingToAnimate()||Math.abs(w-this._zoom)>this.options.zoomAnimationThreshold)return!1;var U=this.getZoomScale(w),X=this._getCenterOffset(f)._divideBy(1-1/U);return R.animate!==!0&&!this.getSize().contains(X)?!1:(q(function(){this._moveStart(!0,R.noMoveStart||!1)._animateZoom(f,w,!0)},this),!0)},_animateZoom:function(f,w,R,U){this._mapPane&&(R&&(this._animatingZoom=!0,this._animateToCenter=f,this._animateToZoom=w,xs(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:f,zoom:w,noUpdate:U}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Mr(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function b0(f,w){return new wr(f,w)}var Bi=je.extend({options:{position:"topright"},initialize:function(f){_(this,f)},getPosition:function(){return this.options.position},setPosition:function(f){var w=this._map;return w&&w.removeControl(this),this.options.position=f,w&&w.addControl(this),this},getContainer:function(){return this._container},addTo:function(f){this.remove(),this._map=f;var w=this._container=this.onAdd(f),R=this.getPosition(),U=f._controlCorners[R];return xs(w,"leaflet-control"),R.indexOf("bottom")!==-1?U.insertBefore(w,U.firstChild):U.appendChild(w),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ta(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(f){this._map&&f&&f.screenX>0&&f.screenY>0&&this._map.getContainer().focus()}}),Gd=function(f){return new Bi(f)};wr.include({addControl:function(f){return f.addTo(this),this},removeControl:function(f){return f.remove(),this},_initControlPos:function(){var f=this._controlCorners={},w="leaflet-",R=this._controlContainer=Hs("div",w+"control-container",this._container);function U(X,he){var Fe=w+X+" "+w+he;f[X+he]=Hs("div",Fe,R)}U("top","left"),U("top","right"),U("bottom","left"),U("bottom","right")},_clearControlPos:function(){for(var f in this._controlCorners)ta(this._controlCorners[f]);ta(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var _0=Bi.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(f,w,R,U){return R<U?-1:U<R?1:0}},initialize:function(f,w,R){_(this,R),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var U in f)this._addLayer(f[U],U);for(U in w)this._addLayer(w[U],U,!0)},onAdd:function(f){this._initLayout(),this._update(),this._map=f,f.on("zoomend",this._checkDisabledLayers,this);for(var w=0;w<this._layers.length;w++)this._layers[w].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(f){return Bi.prototype.addTo.call(this,f),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var f=0;f<this._layers.length;f++)this._layers[f].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(f,w){return this._addLayer(f,w),this._map?this._update():this},addOverlay:function(f,w){return this._addLayer(f,w,!0),this._map?this._update():this},removeLayer:function(f){f.off("add remove",this._onLayerChange,this);var w=this._getLayer(d(f));return w&&this._layers.splice(this._layers.indexOf(w),1),this._map?this._update():this},expand:function(){xs(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var f=this._map.getSize().y-(this._container.offsetTop+50);return f<this._section.clientHeight?(xs(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=f+"px"):Mr(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Mr(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var f="leaflet-control-layers",w=this._container=Hs("div",f),R=this.options.collapsed;w.setAttribute("aria-haspopup",!0),Li(w),Ju(w);var U=this._section=Hs("section",f+"-list");R&&(this._map.on("click",this.collapse,this),Vs(w,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var X=this._layersLink=Hs("a",f+"-toggle",w);X.href="#",X.title="Layers",X.setAttribute("role","button"),Vs(X,{keydown:function(he){he.keyCode===13&&this._expandSafely()},click:function(he){tn(he),this._expandSafely()}},this),R||this.expand(),this._baseLayersList=Hs("div",f+"-base",U),this._separator=Hs("div",f+"-separator",U),this._overlaysList=Hs("div",f+"-overlays",U),w.appendChild(U)},_getLayer:function(f){for(var w=0;w<this._layers.length;w++)if(this._layers[w]&&d(this._layers[w].layer)===f)return this._layers[w]},_addLayer:function(f,w,R){this._map&&f.on("add remove",this._onLayerChange,this),this._layers.push({layer:f,name:w,overlay:R}),this.options.sortLayers&&this._layers.sort(o(function(U,X){return this.options.sortFunction(U.layer,X.layer,U.name,X.name)},this)),this.options.autoZIndex&&f.setZIndex&&(this._lastZIndex++,f.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Tc(this._baseLayersList),Tc(this._overlaysList),this._layerControlInputs=[];var f,w,R,U,X=0;for(R=0;R<this._layers.length;R++)U=this._layers[R],this._addItem(U),w=w||U.overlay,f=f||!U.overlay,X+=U.overlay?0:1;return this.options.hideSingleBase&&(f=f&&X>1,this._baseLayersList.style.display=f?"":"none"),this._separator.style.display=w&&f?"":"none",this},_onLayerChange:function(f){this._handlingClick||this._update();var w=this._getLayer(d(f.target)),R=w.overlay?f.type==="add"?"overlayadd":"overlayremove":f.type==="add"?"baselayerchange":null;R&&this._map.fire(R,w)},_createRadioElement:function(f,w){var R='<input type="radio" class="leaflet-control-layers-selector" name="'+f+'"'+(w?' checked="checked"':"")+"/>",U=document.createElement("div");return U.innerHTML=R,U.firstChild},_addItem:function(f){var w=document.createElement("label"),R=this._map.hasLayer(f.layer),U;f.overlay?(U=document.createElement("input"),U.type="checkbox",U.className="leaflet-control-layers-selector",U.defaultChecked=R):U=this._createRadioElement("leaflet-base-layers_"+d(this),R),this._layerControlInputs.push(U),U.layerId=d(f.layer),Vs(U,"click",this._onInputClick,this);var X=document.createElement("span");X.innerHTML=" "+f.name;var he=document.createElement("span");w.appendChild(he),he.appendChild(U),he.appendChild(X);var Fe=f.overlay?this._overlaysList:this._baseLayersList;return Fe.appendChild(w),this._checkDisabledLayers(),w},_onInputClick:function(){if(!this._preventClick){var f=this._layerControlInputs,w,R,U=[],X=[];this._handlingClick=!0;for(var he=f.length-1;he>=0;he--)w=f[he],R=this._getLayer(w.layerId).layer,w.checked?U.push(R):w.checked||X.push(R);for(he=0;he<X.length;he++)this._map.hasLayer(X[he])&&this._map.removeLayer(X[he]);for(he=0;he<U.length;he++)this._map.hasLayer(U[he])||this._map.addLayer(U[he]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var f=this._layerControlInputs,w,R,U=this._map.getZoom(),X=f.length-1;X>=0;X--)w=f[X],R=this._getLayer(w.layerId).layer,w.disabled=R.options.minZoom!==void 0&&U<R.options.minZoom||R.options.maxZoom!==void 0&&U>R.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var f=this._section;this._preventClick=!0,Vs(f,"click",tn),this.expand();var w=this;setTimeout(function(){Qt(f,"click",tn),w._preventClick=!1})}}),Lr=function(f,w,R){return new _0(f,w,R)},eh=Bi.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(f){var w="leaflet-control-zoom",R=Hs("div",w+" leaflet-bar"),U=this.options;return this._zoomInButton=this._createButton(U.zoomInText,U.zoomInTitle,w+"-in",R,this._zoomIn),this._zoomOutButton=this._createButton(U.zoomOutText,U.zoomOutTitle,w+"-out",R,this._zoomOut),this._updateDisabled(),f.on("zoomend zoomlevelschange",this._updateDisabled,this),R},onRemove:function(f){f.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(f){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(f.shiftKey?3:1))},_zoomOut:function(f){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(f.shiftKey?3:1))},_createButton:function(f,w,R,U,X){var he=Hs("a",R,U);return he.innerHTML=f,he.href="#",he.title=w,he.setAttribute("role","button"),he.setAttribute("aria-label",w),Li(he),Vs(he,"click",Fi),Vs(he,"click",X,this),Vs(he,"click",this._refocusOnMap,this),he},_updateDisabled:function(){var f=this._map,w="leaflet-disabled";Mr(this._zoomInButton,w),Mr(this._zoomOutButton,w),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||f._zoom===f.getMinZoom())&&(xs(this._zoomOutButton,w),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||f._zoom===f.getMaxZoom())&&(xs(this._zoomInButton,w),this._zoomInButton.setAttribute("aria-disabled","true"))}});wr.mergeOptions({zoomControl:!0}),wr.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new eh,this.addControl(this.zoomControl))});var th=function(f){return new eh(f)},Oo=Bi.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(f){var w="leaflet-control-scale",R=Hs("div",w),U=this.options;return this._addScales(U,w+"-line",R),f.on(U.updateWhenIdle?"moveend":"move",this._update,this),f.whenReady(this._update,this),R},onRemove:function(f){f.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(f,w,R){f.metric&&(this._mScale=Hs("div",w,R)),f.imperial&&(this._iScale=Hs("div",w,R))},_update:function(){var f=this._map,w=f.getSize().y/2,R=f.distance(f.containerPointToLatLng([0,w]),f.containerPointToLatLng([this.options.maxWidth,w]));this._updateScales(R)},_updateScales:function(f){this.options.metric&&f&&this._updateMetric(f),this.options.imperial&&f&&this._updateImperial(f)},_updateMetric:function(f){var w=this._getRoundNum(f),R=w<1e3?w+" m":w/1e3+" km";this._updateScale(this._mScale,R,w/f)},_updateImperial:function(f){var w=f*3.2808399,R,U,X;w>5280?(R=w/5280,U=this._getRoundNum(R),this._updateScale(this._iScale,U+" mi",U/R)):(X=this._getRoundNum(w),this._updateScale(this._iScale,X+" ft",X/w))},_updateScale:function(f,w,R){f.style.width=Math.round(this.options.maxWidth*R)+"px",f.innerHTML=w},_getRoundNum:function(f){var w=Math.pow(10,(Math.floor(f)+"").length-1),R=f/w;return R=R>=10?10:R>=5?5:R>=3?3:R>=2?2:1,w*R}}),f1=function(f){return new Oo(f)},ft='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Js=Bi.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Gt.inlineSvg?ft+" ":"")+"Leaflet</a>"},initialize:function(f){_(this,f),this._attributions={}},onAdd:function(f){f.attributionControl=this,this._container=Hs("div","leaflet-control-attribution"),Li(this._container);for(var w in f._layers)f._layers[w].getAttribution&&this.addAttribution(f._layers[w].getAttribution());return this._update(),f.on("layeradd",this._addAttribution,this),this._container},onRemove:function(f){f.off("layeradd",this._addAttribution,this)},_addAttribution:function(f){f.layer.getAttribution&&(this.addAttribution(f.layer.getAttribution()),f.layer.once("remove",function(){this.removeAttribution(f.layer.getAttribution())},this))},setPrefix:function(f){return this.options.prefix=f,this._update(),this},addAttribution:function(f){return f?(this._attributions[f]||(this._attributions[f]=0),this._attributions[f]++,this._update(),this):this},removeAttribution:function(f){return f?(this._attributions[f]&&(this._attributions[f]--,this._update()),this):this},_update:function(){if(this._map){var f=[];for(var w in this._attributions)this._attributions[w]&&f.push(w);var R=[];this.options.prefix&&R.push(this.options.prefix),f.length&&R.push(f.join(", ")),this._container.innerHTML=R.join(' <span aria-hidden="true">|</span> ')}}});wr.mergeOptions({attributionControl:!0}),wr.addInitHook(function(){this.options.attributionControl&&new Js().addTo(this)});var sn=function(f){return new Js(f)};Bi.Layers=_0,Bi.Zoom=eh,Bi.Scale=Oo,Bi.Attribution=Js,Gd.layers=Lr,Gd.zoom=th,Gd.scale=f1,Gd.attribution=sn;var ri=je.extend({initialize:function(f){this._map=f},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ri.addTo=function(f,w){return f.addHandler(w,this),this};var j0={Events:Z},N0=Gt.touch?"touchstart mousedown":"mousedown",dl=G.extend({options:{clickTolerance:3},initialize:function(f,w,R,U){_(this,U),this._element=f,this._dragStartTarget=w||f,this._preventOutline=R},enable:function(){this._enabled||(Vs(this._dragStartTarget,N0,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(dl._dragging===this&&this.finishDrag(!0),Qt(this._dragStartTarget,N0,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(f){if(this._enabled&&(this._moved=!1,!Zf(this._element,"leaflet-zoom-anim"))){if(f.touches&&f.touches.length!==1){dl._dragging===this&&this.finishDrag();return}if(!(dl._dragging||f.shiftKey||f.which!==1&&f.button!==1&&!f.touches)&&(dl._dragging=this,this._preventOutline&&Hd(this._element),Ns(),pn(),!this._moving)){this.fire("down");var w=f.touches?f.touches[0]:f,R=Qu(this._element);this._startPoint=new Q(w.clientX,w.clientY),this._startPos=na(this._element),this._parentScale=em(R);var U=f.type==="mousedown";Vs(document,U?"mousemove":"touchmove",this._onMove,this),Vs(document,U?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(f){if(this._enabled){if(f.touches&&f.touches.length>1){this._moved=!0;return}var w=f.touches&&f.touches.length===1?f.touches[0]:f,R=new Q(w.clientX,w.clientY)._subtract(this._startPoint);!R.x&&!R.y||Math.abs(R.x)+Math.abs(R.y)<this.options.clickTolerance||(R.x/=this._parentScale.x,R.y/=this._parentScale.y,tn(f),this._moved||(this.fire("dragstart"),this._moved=!0,xs(document.body,"leaflet-dragging"),this._lastTarget=f.target||f.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),xs(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(R),this._moving=!0,this._lastEvent=f,this._updatePosition())}},_updatePosition:function(){var f={originalEvent:this._lastEvent};this.fire("predrag",f),Zt(this._element,this._newPos),this.fire("drag",f)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(f){Mr(document.body,"leaflet-dragging"),this._lastTarget&&(Mr(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Qt(document,"mousemove touchmove",this._onMove,this),Qt(document,"mouseup touchend touchcancel",this._onUp,this),sa(),$d();var w=this._moved&&this._moving;this._moving=!1,dl._dragging=!1,w&&this.fire("dragend",{noInertia:f,distance:this._newPos.distanceTo(this._startPos)})}});function C0(f,w,R){var U,X=[1,4,2,8],he,Fe,it,mt,Rt,ss,Ms,vr;for(he=0,ss=f.length;he<ss;he++)f[he]._code=Yl(f[he],w);for(it=0;it<4;it++){for(Ms=X[it],U=[],he=0,ss=f.length,Fe=ss-1;he<ss;Fe=he++)mt=f[he],Rt=f[Fe],mt._code&Ms?Rt._code&Ms||(vr=Do(Rt,mt,Ms,w,R),vr._code=Yl(vr,w),U.push(vr)):(Rt._code&Ms&&(vr=Do(Rt,mt,Ms,w,R),vr._code=Yl(vr,w),U.push(vr)),U.push(mt));f=U}return f}function sh(f,w){var R,U,X,he,Fe,it,mt,Rt,ss;if(!f||f.length===0)throw new Error("latlngs not passed");ai(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var Ms=xe([0,0]),vr=ie(f),ii=vr.getNorthWest().distanceTo(vr.getSouthWest())*vr.getNorthEast().distanceTo(vr.getNorthWest());ii<1700&&(Ms=ja(f));var gn=f.length,co=[];for(R=0;R<gn;R++){var ji=xe(f[R]);co.push(w.project(xe([ji.lat-Ms.lat,ji.lng-Ms.lng])))}for(it=mt=Rt=0,R=0,U=gn-1;R<gn;U=R++)X=co[R],he=co[U],Fe=X.y*he.x-he.y*X.x,mt+=(X.x+he.x)*Fe,Rt+=(X.y+he.y)*Fe,it+=Fe*3;it===0?ss=co[0]:ss=[mt/it,Rt/it];var ah=w.unproject(le(ss));return xe([ah.lat+Ms.lat,ah.lng+Ms.lng])}function ja(f){for(var w=0,R=0,U=0,X=0;X<f.length;X++){var he=xe(f[X]);w+=he.lat,R+=he.lng,U++}return xe([w/U,R/U])}var rm={__proto__:null,clipPolygon:C0,polygonCenter:sh,centroid:ja};function fa(f,w){if(!w||!f.length)return f.slice();var R=w*w;return f=m1(f,R),f=qr(f,R),f}function Kd(f,w,R){return Math.sqrt(Zl(f,w,R,!0))}function Xl(f,w,R){return Zl(f,w,R)}function qr(f,w){var R=f.length,U=typeof Uint8Array<"u"?Uint8Array:Array,X=new U(R);X[0]=X[R-1]=1,Es(f,X,w,0,R-1);var he,Fe=[];for(he=0;he<R;he++)X[he]&&Fe.push(f[he]);return Fe}function Es(f,w,R,U,X){var he=0,Fe,it,mt;for(it=U+1;it<=X-1;it++)mt=Zl(f[it],f[U],f[X],!0),mt>he&&(Fe=it,he=mt);he>R&&(w[Fe]=1,Es(f,w,R,U,Fe),Es(f,w,R,Fe,X))}function m1(f,w){for(var R=[f[0]],U=1,X=0,he=f.length;U<he;U++)ao(f[U],f[X])>w&&(R.push(f[U]),X=U);return X<he-1&&R.push(f[he-1]),R}var Zr;function ul(f,w,R,U,X){var he=U?Zr:Yl(f,R),Fe=Yl(w,R),it,mt,Rt;for(Zr=Fe;;){if(!(he|Fe))return[f,w];if(he&Fe)return!1;it=he||Fe,mt=Do(f,w,it,R,X),Rt=Yl(mt,R),it===he?(f=mt,he=Rt):(w=mt,Fe=Rt)}}function Do(f,w,R,U,X){var he=w.x-f.x,Fe=w.y-f.y,it=U.min,mt=U.max,Rt,ss;return R&8?(Rt=f.x+he*(mt.y-f.y)/Fe,ss=mt.y):R&4?(Rt=f.x+he*(it.y-f.y)/Fe,ss=it.y):R&2?(Rt=mt.x,ss=f.y+Fe*(mt.x-f.x)/he):R&1&&(Rt=it.x,ss=f.y+Fe*(it.x-f.x)/he),new Q(Rt,ss,X)}function Yl(f,w){var R=0;return f.x<w.min.x?R|=1:f.x>w.max.x&&(R|=2),f.y<w.min.y?R|=4:f.y>w.max.y&&(R|=8),R}function ao(f,w){var R=w.x-f.x,U=w.y-f.y;return R*R+U*U}function Zl(f,w,R,U){var X=w.x,he=w.y,Fe=R.x-X,it=R.y-he,mt=Fe*Fe+it*it,Rt;return mt>0&&(Rt=((f.x-X)*Fe+(f.y-he)*it)/mt,Rt>1?(X=R.x,he=R.y):Rt>0&&(X+=Fe*Rt,he+=it*Rt)),Fe=f.x-X,it=f.y-he,U?Fe*Fe+it*it:new Q(X,he)}function ai(f){return!k(f[0])||typeof f[0][0]!="object"&&typeof f[0][0]<"u"}function rh(f){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),ai(f)}function am(f,w){var R,U,X,he,Fe,it,mt,Rt;if(!f||f.length===0)throw new Error("latlngs not passed");ai(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var ss=xe([0,0]),Ms=ie(f),vr=Ms.getNorthWest().distanceTo(Ms.getSouthWest())*Ms.getNorthEast().distanceTo(Ms.getNorthWest());vr<1700&&(ss=ja(f));var ii=f.length,gn=[];for(R=0;R<ii;R++){var co=xe(f[R]);gn.push(w.project(xe([co.lat-ss.lat,co.lng-ss.lng])))}for(R=0,U=0;R<ii-1;R++)U+=gn[R].distanceTo(gn[R+1])/2;if(U===0)Rt=gn[0];else for(R=0,he=0;R<ii-1;R++)if(Fe=gn[R],it=gn[R+1],X=Fe.distanceTo(it),he+=X,he>U){mt=(he-U)/X,Rt=[it.x-mt*(it.x-Fe.x),it.y-mt*(it.y-Fe.y)];break}var ji=w.unproject(le(Rt));return xe([ji.lat+ss.lat,ji.lng+ss.lng])}var E0={__proto__:null,simplify:fa,pointToSegmentDistance:Kd,closestPointOnSegment:Xl,clipSegment:ul,_getEdgeIntersection:Do,_getBitCode:Yl,_sqClosestPointOnSegment:Zl,isFlat:ai,_flat:rh,polylineCenter:am},nm={project:function(f){return new Q(f.lng,f.lat)},unproject:function(f){return new ce(f.y,f.x)},bounds:new ye([-180,-90],[180,90])},hl={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ye([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(f){var w=Math.PI/180,R=this.R,U=f.lat*w,X=this.R_MINOR/R,he=Math.sqrt(1-X*X),Fe=he*Math.sin(U),it=Math.tan(Math.PI/4-U/2)/Math.pow((1-Fe)/(1+Fe),he/2);return U=-R*Math.log(Math.max(it,1e-10)),new Q(f.lng*w*R,U)},unproject:function(f){for(var w=180/Math.PI,R=this.R,U=this.R_MINOR/R,X=Math.sqrt(1-U*U),he=Math.exp(-f.y/R),Fe=Math.PI/2-2*Math.atan(he),it=0,mt=.1,Rt;it<15&&Math.abs(mt)>1e-7;it++)Rt=X*Math.sin(Fe),Rt=Math.pow((1-Rt)/(1+Rt),X/2),mt=Math.PI/2-2*Math.atan(he*Rt)-Fe,Fe+=mt;return new ce(Fe*w,f.x*w/R)}},im={__proto__:null,LonLat:nm,Mercator:hl,SphericalMercator:ve},p1=n({},me,{code:"EPSG:3395",projection:hl,transformation:function(){var f=.5/(Math.PI*hl.R);return Me(f,.5,-f,.5)}()}),Pc=n({},me,{code:"EPSG:4326",projection:nm,transformation:Me(1/180,1,-1/180,.5)}),x1=n({},Ce,{projection:nm,transformation:Me(1,0,-1,0),scale:function(f){return Math.pow(2,f)},zoom:function(f){return Math.log(f)/Math.LN2},distance:function(f,w){var R=w.lng-f.lng,U=w.lat-f.lat;return Math.sqrt(R*R+U*U)},infinite:!0});Ce.Earth=me,Ce.EPSG3395=p1,Ce.EPSG3857=Ie,Ce.EPSG900913=Be,Ce.EPSG4326=Pc,Ce.Simple=x1;var $a=G.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(f){return f.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(f){return f&&f.removeLayer(this),this},getPane:function(f){return this._map.getPane(f?this.options[f]||f:this.options.pane)},addInteractiveTarget:function(f){return this._map._targets[d(f)]=this,this},removeInteractiveTarget:function(f){return delete this._map._targets[d(f)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(f){var w=f.target;if(w.hasLayer(this)){if(this._map=w,this._zoomAnimated=w._zoomAnimated,this.getEvents){var R=this.getEvents();w.on(R,this),this.once("remove",function(){w.off(R,this)},this)}this.onAdd(w),this.fire("add"),w.fire("layeradd",{layer:this})}}});wr.include({addLayer:function(f){if(!f._layerAdd)throw new Error("The provided object is not a Layer.");var w=d(f);return this._layers[w]?this:(this._layers[w]=f,f._mapToAdd=this,f.beforeAdd&&f.beforeAdd(this),this.whenReady(f._layerAdd,f),this)},removeLayer:function(f){var w=d(f);return this._layers[w]?(this._loaded&&f.onRemove(this),delete this._layers[w],this._loaded&&(this.fire("layerremove",{layer:f}),f.fire("remove")),f._map=f._mapToAdd=null,this):this},hasLayer:function(f){return d(f)in this._layers},eachLayer:function(f,w){for(var R in this._layers)f.call(w,this._layers[R]);return this},_addLayers:function(f){f=f?k(f)?f:[f]:[];for(var w=0,R=f.length;w<R;w++)this.addLayer(f[w])},_addZoomLimit:function(f){(!isNaN(f.options.maxZoom)||!isNaN(f.options.minZoom))&&(this._zoomBoundLayers[d(f)]=f,this._updateZoomLevels())},_removeZoomLimit:function(f){var w=d(f);this._zoomBoundLayers[w]&&(delete this._zoomBoundLayers[w],this._updateZoomLevels())},_updateZoomLevels:function(){var f=1/0,w=-1/0,R=this._getZoomSpan();for(var U in this._zoomBoundLayers){var X=this._zoomBoundLayers[U].options;f=X.minZoom===void 0?f:Math.min(f,X.minZoom),w=X.maxZoom===void 0?w:Math.max(w,X.maxZoom)}this._layersMaxZoom=w===-1/0?void 0:w,this._layersMinZoom=f===1/0?void 0:f,R!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Mo=$a.extend({initialize:function(f,w){_(this,w),this._layers={};var R,U;if(f)for(R=0,U=f.length;R<U;R++)this.addLayer(f[R])},addLayer:function(f){var w=this.getLayerId(f);return this._layers[w]=f,this._map&&this._map.addLayer(f),this},removeLayer:function(f){var w=f in this._layers?f:this.getLayerId(f);return this._map&&this._layers[w]&&this._map.removeLayer(this._layers[w]),delete this._layers[w],this},hasLayer:function(f){var w=typeof f=="number"?f:this.getLayerId(f);return w in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(f){var w=Array.prototype.slice.call(arguments,1),R,U;for(R in this._layers)U=this._layers[R],U[f]&&U[f].apply(U,w);return this},onAdd:function(f){this.eachLayer(f.addLayer,f)},onRemove:function(f){this.eachLayer(f.removeLayer,f)},eachLayer:function(f,w){for(var R in this._layers)f.call(w,this._layers[R]);return this},getLayer:function(f){return this._layers[f]},getLayers:function(){var f=[];return this.eachLayer(f.push,f),f},setZIndex:function(f){return this.invoke("setZIndex",f)},getLayerId:function(f){return d(f)}}),_i=function(f,w){return new Mo(f,w)},no=Mo.extend({addLayer:function(f){return this.hasLayer(f)?this:(f.addEventParent(this),Mo.prototype.addLayer.call(this,f),this.fire("layeradd",{layer:f}))},removeLayer:function(f){return this.hasLayer(f)?(f in this._layers&&(f=this._layers[f]),f.removeEventParent(this),Mo.prototype.removeLayer.call(this,f),this.fire("layerremove",{layer:f})):this},setStyle:function(f){return this.invoke("setStyle",f)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var f=new ee;for(var w in this._layers){var R=this._layers[w];f.extend(R.getBounds?R.getBounds():R.getLatLng())}return f}}),io=function(f,w){return new no(f,w)},Ic=je.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(f){_(this,f)},createIcon:function(f){return this._createIcon("icon",f)},createShadow:function(f){return this._createIcon("shadow",f)},_createIcon:function(f,w){var R=this._getIconUrl(f);if(!R){if(f==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var U=this._createImg(R,w&&w.tagName==="IMG"?w:null);return this._setIconStyles(U,f),(this.options.crossOrigin||this.options.crossOrigin==="")&&(U.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),U},_setIconStyles:function(f,w){var R=this.options,U=R[w+"Size"];typeof U=="number"&&(U=[U,U]);var X=le(U),he=le(w==="shadow"&&R.shadowAnchor||R.iconAnchor||X&&X.divideBy(2,!0));f.className="leaflet-marker-"+w+" "+(R.className||""),he&&(f.style.marginLeft=-he.x+"px",f.style.marginTop=-he.y+"px"),X&&(f.style.width=X.x+"px",f.style.height=X.y+"px")},_createImg:function(f,w){return w=w||document.createElement("img"),w.src=f,w},_getIconUrl:function(f){return Gt.retina&&this.options[f+"RetinaUrl"]||this.options[f+"Url"]}});function om(f){return new Ic(f)}var Xd=Ic.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(f){return typeof Xd.imagePath!="string"&&(Xd.imagePath=this._detectIconPath()),(this.options.imagePath||Xd.imagePath)+Ic.prototype._getIconUrl.call(this,f)},_stripUrl:function(f){var w=function(R,U,X){var he=U.exec(R);return he&&he[X]};return f=w(f,/^url\((['"])?(.+)\1\)$/,2),f&&w(f,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var f=Hs("div","leaflet-default-icon-path",document.body),w=Ks(f,"background-image")||Ks(f,"backgroundImage");if(document.body.removeChild(f),w=this._stripUrl(w),w)return w;var R=document.querySelector('link[href$="leaflet.css"]');return R?R.href.substring(0,R.href.length-11-1):""}}),lm=ri.extend({initialize:function(f){this._marker=f},addHooks:function(){var f=this._marker._icon;this._draggable||(this._draggable=new dl(f,f,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),xs(f,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Mr(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(f){var w=this._marker,R=w._map,U=this._marker.options.autoPanSpeed,X=this._marker.options.autoPanPadding,he=na(w._icon),Fe=R.getPixelBounds(),it=R.getPixelOrigin(),mt=W(Fe.min._subtract(it).add(X),Fe.max._subtract(it).subtract(X));if(!mt.contains(he)){var Rt=le((Math.max(mt.max.x,he.x)-mt.max.x)/(Fe.max.x-mt.max.x)-(Math.min(mt.min.x,he.x)-mt.min.x)/(Fe.min.x-mt.min.x),(Math.max(mt.max.y,he.y)-mt.max.y)/(Fe.max.y-mt.max.y)-(Math.min(mt.min.y,he.y)-mt.min.y)/(Fe.min.y-mt.min.y)).multiplyBy(U);R.panBy(Rt,{animate:!1}),this._draggable._newPos._add(Rt),this._draggable._startPos._add(Rt),Zt(w._icon,this._draggable._newPos),this._onDrag(f),this._panRequest=q(this._adjustPan.bind(this,f))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(f){this._marker.options.autoPan&&(Y(this._panRequest),this._panRequest=q(this._adjustPan.bind(this,f)))},_onDrag:function(f){var w=this._marker,R=w._shadow,U=na(w._icon),X=w._map.layerPointToLatLng(U);R&&Zt(R,U),w._latlng=X,f.latlng=X,f.oldLatLng=this._oldLatLng,w.fire("move",f).fire("drag",f)},_onDragEnd:function(f){Y(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",f)}}),ni=$a.extend({options:{icon:new Xd,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(f,w){_(this,w),this._latlng=xe(f)},onAdd:function(f){this._zoomAnimated=this._zoomAnimated&&f.options.markerZoomAnimation,this._zoomAnimated&&f.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(f){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&f.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(f){var w=this._latlng;return this._latlng=xe(f),this.update(),this.fire("move",{oldLatLng:w,latlng:this._latlng})},setZIndexOffset:function(f){return this.options.zIndexOffset=f,this.update()},getIcon:function(){return this.options.icon},setIcon:function(f){return this.options.icon=f,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var f=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(f)}return this},_initIcon:function(){var f=this.options,w="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),R=f.icon.createIcon(this._icon),U=!1;R!==this._icon&&(this._icon&&this._removeIcon(),U=!0,f.title&&(R.title=f.title),R.tagName==="IMG"&&(R.alt=f.alt||"")),xs(R,w),f.keyboard&&(R.tabIndex="0",R.setAttribute("role","button")),this._icon=R,f.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Vs(R,"focus",this._panOnFocus,this);var X=f.icon.createShadow(this._shadow),he=!1;X!==this._shadow&&(this._removeShadow(),he=!0),X&&(xs(X,w),X.alt=""),this._shadow=X,f.opacity<1&&this._updateOpacity(),U&&this.getPane().appendChild(this._icon),this._initInteraction(),X&&he&&this.getPane(f.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Qt(this._icon,"focus",this._panOnFocus,this),ta(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ta(this._shadow),this._shadow=null},_setPos:function(f){this._icon&&Zt(this._icon,f),this._shadow&&Zt(this._shadow,f),this._zIndex=f.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(f){this._icon&&(this._icon.style.zIndex=this._zIndex+f)},_animateZoom:function(f){var w=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center).round();this._setPos(w)},_initInteraction:function(){if(this.options.interactive&&(xs(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),lm)){var f=this.options.draggable;this.dragging&&(f=this.dragging.enabled(),this.dragging.disable()),this.dragging=new lm(this),f&&this.dragging.enable()}},setOpacity:function(f){return this.options.opacity=f,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var f=this.options.opacity;this._icon&&mr(this._icon,f),this._shadow&&mr(this._shadow,f)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var f=this._map;if(f){var w=this.options.icon.options,R=w.iconSize?le(w.iconSize):le(0,0),U=w.iconAnchor?le(w.iconAnchor):le(0,0);f.panInside(this._latlng,{paddingTopLeft:U,paddingBottomRight:R.subtract(U)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function g1(f,w){return new ni(f,w)}var oo=$a.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(f){this._renderer=f.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(f){return _(this,f),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&f&&Object.prototype.hasOwnProperty.call(f,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),fl=oo.extend({options:{fill:!0,radius:10},initialize:function(f,w){_(this,w),this._latlng=xe(f),this._radius=this.options.radius},setLatLng:function(f){var w=this._latlng;return this._latlng=xe(f),this.redraw(),this.fire("move",{oldLatLng:w,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(f){return this.options.radius=this._radius=f,this.redraw()},getRadius:function(){return this._radius},setStyle:function(f){var w=f&&f.radius||this._radius;return oo.prototype.setStyle.call(this,f),this.setRadius(w),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var f=this._radius,w=this._radiusY||f,R=this._clickTolerance(),U=[f+R,w+R];this._pxBounds=new ye(this._point.subtract(U),this._point.add(U))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(f){return f.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function jr(f,w){return new fl(f,w)}var Oc=fl.extend({initialize:function(f,w,R){if(typeof w=="number"&&(w=n({},R,{radius:w})),_(this,w),this._latlng=xe(f),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(f){return this._mRadius=f,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var f=[this._radius,this._radiusY||this._radius];return new ee(this._map.layerPointToLatLng(this._point.subtract(f)),this._map.layerPointToLatLng(this._point.add(f)))},setStyle:oo.prototype.setStyle,_project:function(){var f=this._latlng.lng,w=this._latlng.lat,R=this._map,U=R.options.crs;if(U.distance===me.distance){var X=Math.PI/180,he=this._mRadius/me.R/X,Fe=R.project([w+he,f]),it=R.project([w-he,f]),mt=Fe.add(it).divideBy(2),Rt=R.unproject(mt).lat,ss=Math.acos((Math.cos(he*X)-Math.sin(w*X)*Math.sin(Rt*X))/(Math.cos(w*X)*Math.cos(Rt*X)))/X;(isNaN(ss)||ss===0)&&(ss=he/Math.cos(Math.PI/180*w)),this._point=mt.subtract(R.getPixelOrigin()),this._radius=isNaN(ss)?0:mt.x-R.project([Rt,f-ss]).x,this._radiusY=mt.y-Fe.y}else{var Ms=U.unproject(U.project(this._latlng).subtract([this._mRadius,0]));this._point=R.latLngToLayerPoint(this._latlng),this._radius=this._point.x-R.latLngToLayerPoint(Ms).x}this._updateBounds()}});function te(f,w,R){return new Oc(f,w,R)}var l=oo.extend({options:{smoothFactor:1,noClip:!1},initialize:function(f,w){_(this,w),this._setLatLngs(f)},getLatLngs:function(){return this._latlngs},setLatLngs:function(f){return this._setLatLngs(f),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(f){for(var w=1/0,R=null,U=Zl,X,he,Fe=0,it=this._parts.length;Fe<it;Fe++)for(var mt=this._parts[Fe],Rt=1,ss=mt.length;Rt<ss;Rt++){X=mt[Rt-1],he=mt[Rt];var Ms=U(f,X,he,!0);Ms<w&&(w=Ms,R=U(f,X,he))}return R&&(R.distance=Math.sqrt(w)),R},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return am(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(f,w){return w=w||this._defaultShape(),f=xe(f),w.push(f),this._bounds.extend(f),this.redraw()},_setLatLngs:function(f){this._bounds=new ee,this._latlngs=this._convertLatLngs(f)},_defaultShape:function(){return ai(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(f){for(var w=[],R=ai(f),U=0,X=f.length;U<X;U++)R?(w[U]=xe(f[U]),this._bounds.extend(w[U])):w[U]=this._convertLatLngs(f[U]);return w},_project:function(){var f=new ye;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,f),this._bounds.isValid()&&f.isValid()&&(this._rawPxBounds=f,this._updateBounds())},_updateBounds:function(){var f=this._clickTolerance(),w=new Q(f,f);this._rawPxBounds&&(this._pxBounds=new ye([this._rawPxBounds.min.subtract(w),this._rawPxBounds.max.add(w)]))},_projectLatlngs:function(f,w,R){var U=f[0]instanceof ce,X=f.length,he,Fe;if(U){for(Fe=[],he=0;he<X;he++)Fe[he]=this._map.latLngToLayerPoint(f[he]),R.extend(Fe[he]);w.push(Fe)}else for(he=0;he<X;he++)this._projectLatlngs(f[he],w,R)},_clipPoints:function(){var f=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}var w=this._parts,R,U,X,he,Fe,it,mt;for(R=0,X=0,he=this._rings.length;R<he;R++)for(mt=this._rings[R],U=0,Fe=mt.length;U<Fe-1;U++)it=ul(mt[U],mt[U+1],f,U,!0),it&&(w[X]=w[X]||[],w[X].push(it[0]),(it[1]!==mt[U+1]||U===Fe-2)&&(w[X].push(it[1]),X++))}},_simplifyPoints:function(){for(var f=this._parts,w=this.options.smoothFactor,R=0,U=f.length;R<U;R++)f[R]=fa(f[R],w)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(f,w){var R,U,X,he,Fe,it,mt=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(R=0,he=this._parts.length;R<he;R++)for(it=this._parts[R],U=0,Fe=it.length,X=Fe-1;U<Fe;X=U++)if(!(!w&&U===0)&&Kd(f,it[X],it[U])<=mt)return!0;return!1}});function u(f,w){return new l(f,w)}l._flat=rh;var m=l.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return sh(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(f){var w=l.prototype._convertLatLngs.call(this,f),R=w.length;return R>=2&&w[0]instanceof ce&&w[0].equals(w[R-1])&&w.pop(),w},_setLatLngs:function(f){l.prototype._setLatLngs.call(this,f),ai(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return ai(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var f=this._renderer._bounds,w=this.options.weight,R=new Q(w,w);if(f=new ye(f.min.subtract(R),f.max.add(R)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}for(var U=0,X=this._rings.length,he;U<X;U++)he=C0(this._rings[U],f,!0),he.length&&this._parts.push(he)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(f){var w=!1,R,U,X,he,Fe,it,mt,Rt;if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(he=0,mt=this._parts.length;he<mt;he++)for(R=this._parts[he],Fe=0,Rt=R.length,it=Rt-1;Fe<Rt;it=Fe++)U=R[Fe],X=R[it],U.y>f.y!=X.y>f.y&&f.x<(X.x-U.x)*(f.y-U.y)/(X.y-U.y)+U.x&&(w=!w);return w||l.prototype._containsPoint.call(this,f,!0)}});function g(f,w){return new m(f,w)}var y=no.extend({initialize:function(f,w){_(this,w),this._layers={},f&&this.addData(f)},addData:function(f){var w=k(f)?f:f.features,R,U,X;if(w){for(R=0,U=w.length;R<U;R++)X=w[R],(X.geometries||X.geometry||X.features||X.coordinates)&&this.addData(X);return this}var he=this.options;if(he.filter&&!he.filter(f))return this;var Fe=j(f,he);return Fe?(Fe.feature=Ae(f),Fe.defaultOptions=Fe.options,this.resetStyle(Fe),he.onEachFeature&&he.onEachFeature(f,Fe),this.addLayer(Fe)):this},resetStyle:function(f){return f===void 0?this.eachLayer(this.resetStyle,this):(f.options=n({},f.defaultOptions),this._setLayerStyle(f,this.options.style),this)},setStyle:function(f){return this.eachLayer(function(w){this._setLayerStyle(w,f)},this)},_setLayerStyle:function(f,w){f.setStyle&&(typeof w=="function"&&(w=w(f.feature)),f.setStyle(w))}});function j(f,w){var R=f.type==="Feature"?f.geometry:f,U=R?R.coordinates:null,X=[],he=w&&w.pointToLayer,Fe=w&&w.coordsToLatLng||P,it,mt,Rt,ss;if(!U&&!R)return null;switch(R.type){case"Point":return it=Fe(U),S(he,f,it,w);case"MultiPoint":for(Rt=0,ss=U.length;Rt<ss;Rt++)it=Fe(U[Rt]),X.push(S(he,f,it,w));return new no(X);case"LineString":case"MultiLineString":return mt=V(U,R.type==="LineString"?0:1,Fe),new l(mt,w);case"Polygon":case"MultiPolygon":return mt=V(U,R.type==="Polygon"?1:2,Fe),new m(mt,w);case"GeometryCollection":for(Rt=0,ss=R.geometries.length;Rt<ss;Rt++){var Ms=j({geometry:R.geometries[Rt],type:"Feature",properties:f.properties},w);Ms&&X.push(Ms)}return new no(X);case"FeatureCollection":for(Rt=0,ss=R.features.length;Rt<ss;Rt++){var vr=j(R.features[Rt],w);vr&&X.push(vr)}return new no(X);default:throw new Error("Invalid GeoJSON object.")}}function S(f,w,R,U){return f?f(w,R):new ni(R,U&&U.markersInheritOptions&&U)}function P(f){return new ce(f[1],f[0],f[2])}function V(f,w,R){for(var U=[],X=0,he=f.length,Fe;X<he;X++)Fe=w?V(f[X],w-1,R):(R||P)(f[X]),U.push(Fe);return U}function K(f,w){return f=xe(f),f.alt!==void 0?[v(f.lng,w),v(f.lat,w),v(f.alt,w)]:[v(f.lng,w),v(f.lat,w)]}function se(f,w,R,U){for(var X=[],he=0,Fe=f.length;he<Fe;he++)X.push(w?se(f[he],ai(f[he])?0:w-1,R,U):K(f[he],U));return!w&&R&&X.length>0&&X.push(X[0].slice()),X}function ue(f,w){return f.feature?n({},f.feature,{geometry:w}):Ae(w)}function Ae(f){return f.type==="Feature"||f.type==="FeatureCollection"?f:{type:"Feature",properties:{},geometry:f}}var Ve={toGeoJSON:function(f){return ue(this,{type:"Point",coordinates:K(this.getLatLng(),f)})}};ni.include(Ve),Oc.include(Ve),fl.include(Ve),l.include({toGeoJSON:function(f){var w=!ai(this._latlngs),R=se(this._latlngs,w?1:0,!1,f);return ue(this,{type:(w?"Multi":"")+"LineString",coordinates:R})}}),m.include({toGeoJSON:function(f){var w=!ai(this._latlngs),R=w&&!ai(this._latlngs[0]),U=se(this._latlngs,R?2:w?1:0,!0,f);return w||(U=[U]),ue(this,{type:(R?"Multi":"")+"Polygon",coordinates:U})}}),Mo.include({toMultiPoint:function(f){var w=[];return this.eachLayer(function(R){w.push(R.toGeoJSON(f).geometry.coordinates)}),ue(this,{type:"MultiPoint",coordinates:w})},toGeoJSON:function(f){var w=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(w==="MultiPoint")return this.toMultiPoint(f);var R=w==="GeometryCollection",U=[];return this.eachLayer(function(X){if(X.toGeoJSON){var he=X.toGeoJSON(f);if(R)U.push(he.geometry);else{var Fe=Ae(he);Fe.type==="FeatureCollection"?U.push.apply(U,Fe.features):U.push(Fe)}}}),R?ue(this,{geometries:U,type:"GeometryCollection"}):{type:"FeatureCollection",features:U}}});function $e(f,w){return new y(f,w)}var st=$e,ht=$a.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(f,w,R){this._url=f,this._bounds=ie(w),_(this,R)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(xs(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ta(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(f){return this.options.opacity=f,this._image&&this._updateOpacity(),this},setStyle:function(f){return f.opacity&&this.setOpacity(f.opacity),this},bringToFront:function(){return this._map&&aa(this._image),this},bringToBack:function(){return this._map&&si(this._image),this},setUrl:function(f){return this._url=f,this._image&&(this._image.src=f),this},setBounds:function(f){return this._bounds=ie(f),this._map&&this._reset(),this},getEvents:function(){var f={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var f=this._url.tagName==="IMG",w=this._image=f?this._url:Hs("img");if(xs(w,"leaflet-image-layer"),this._zoomAnimated&&xs(w,"leaflet-zoom-animated"),this.options.className&&xs(w,this.options.className),w.onselectstart=x,w.onmousemove=x,w.onload=o(this.fire,this,"load"),w.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(w.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),f){this._url=w.src;return}w.src=this._url,w.alt=this.options.alt},_animateZoom:function(f){var w=this._map.getZoomScale(f.zoom),R=this._map._latLngBoundsToNewLayerBounds(this._bounds,f.zoom,f.center).min;_e(this._image,R,w)},_reset:function(){var f=this._image,w=new ye(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),R=w.getSize();Zt(f,w.min),f.style.width=R.x+"px",f.style.height=R.y+"px"},_updateOpacity:function(){mr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var f=this.options.errorOverlayUrl;f&&this._url!==f&&(this._url=f,this._image.src=f)},getCenter:function(){return this._bounds.getCenter()}}),Bt=function(f,w,R){return new ht(f,w,R)},Vt=ht.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var f=this._url.tagName==="VIDEO",w=this._image=f?this._url:Hs("video");if(xs(w,"leaflet-image-layer"),this._zoomAnimated&&xs(w,"leaflet-zoom-animated"),this.options.className&&xs(w,this.options.className),w.onselectstart=x,w.onmousemove=x,w.onloadeddata=o(this.fire,this,"load"),f){for(var R=w.getElementsByTagName("source"),U=[],X=0;X<R.length;X++)U.push(R[X].src);this._url=R.length>0?U:[w.src];return}k(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(w.style,"objectFit")&&(w.style.objectFit="fill"),w.autoplay=!!this.options.autoplay,w.loop=!!this.options.loop,w.muted=!!this.options.muted,w.playsInline=!!this.options.playsInline;for(var he=0;he<this._url.length;he++){var Fe=Hs("source");Fe.src=this._url[he],w.appendChild(Fe)}}});function Pt(f,w,R){return new Vt(f,w,R)}var pr=ht.extend({_initImage:function(){var f=this._image=this._url;xs(f,"leaflet-image-layer"),this._zoomAnimated&&xs(f,"leaflet-zoom-animated"),this.options.className&&xs(f,this.options.className),f.onselectstart=x,f.onmousemove=x}});function Ys(f,w,R){return new pr(f,w,R)}var ma=$a.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(f,w){f&&(f instanceof ce||k(f))?(this._latlng=xe(f),_(this,w)):(_(this,f),this._source=w),this.options.content&&(this._content=this.options.content)},openOn:function(f){return f=arguments.length?f:this._source._map,f.hasLayer(this)||f.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(f){return this._map?this.close():(arguments.length?this._source=f:f=this._source,this._prepareOpen(),this.openOn(f._map)),this},onAdd:function(f){this._zoomAnimated=f._zoomAnimated,this._container||this._initLayout(),f._fadeAnimated&&mr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),f._fadeAnimated&&mr(this._container,1),this.bringToFront(),this.options.interactive&&(xs(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(f){f._fadeAnimated?(mr(this._container,0),this._removeTimeout=setTimeout(o(ta,void 0,this._container),200)):ta(this._container),this.options.interactive&&(Mr(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(f){return this._latlng=xe(f),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(f){return this._content=f,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var f={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&aa(this._container),this},bringToBack:function(){return this._map&&si(this._container),this},_prepareOpen:function(f){var w=this._source;if(!w._map)return!1;if(w instanceof no){w=null;var R=this._source._layers;for(var U in R)if(R[U]._map){w=R[U];break}if(!w)return!1;this._source=w}if(!f)if(w.getCenter)f=w.getCenter();else if(w.getLatLng)f=w.getLatLng();else if(w.getBounds)f=w.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(f),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var f=this._contentNode,w=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof w=="string")f.innerHTML=w;else{for(;f.hasChildNodes();)f.removeChild(f.firstChild);f.appendChild(w)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var f=this._map.latLngToLayerPoint(this._latlng),w=le(this.options.offset),R=this._getAnchor();this._zoomAnimated?Zt(this._container,f.add(R)):w=w.add(f).add(R);var U=this._containerBottom=-w.y,X=this._containerLeft=-Math.round(this._containerWidth/2)+w.x;this._container.style.bottom=U+"px",this._container.style.left=X+"px"}},_getAnchor:function(){return[0,0]}});wr.include({_initOverlay:function(f,w,R,U){var X=w;return X instanceof f||(X=new f(U).setContent(w)),R&&X.setLatLng(R),X}}),$a.include({_initOverlay:function(f,w,R,U){var X=R;return X instanceof f?(_(X,U),X._source=this):(X=w&&!U?w:new f(U,this),X.setContent(R)),X}});var Bn=ma.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(f){return f=arguments.length?f:this._source._map,!f.hasLayer(this)&&f._popup&&f._popup.options.autoClose&&f.removeLayer(f._popup),f._popup=this,ma.prototype.openOn.call(this,f)},onAdd:function(f){ma.prototype.onAdd.call(this,f),f.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof oo||this._source.on("preclick",Io))},onRemove:function(f){ma.prototype.onRemove.call(this,f),f.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof oo||this._source.off("preclick",Io))},getEvents:function(){var f=ma.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(f.preclick=this.close),this.options.keepInView&&(f.moveend=this._adjustPan),f},_initLayout:function(){var f="leaflet-popup",w=this._container=Hs("div",f+" "+(this.options.className||"")+" leaflet-zoom-animated"),R=this._wrapper=Hs("div",f+"-content-wrapper",w);if(this._contentNode=Hs("div",f+"-content",R),Li(w),Ju(this._contentNode),Vs(w,"contextmenu",Io),this._tipContainer=Hs("div",f+"-tip-container",w),this._tip=Hs("div",f+"-tip",this._tipContainer),this.options.closeButton){var U=this._closeButton=Hs("a",f+"-close-button",w);U.setAttribute("role","button"),U.setAttribute("aria-label","Close popup"),U.href="#close",U.innerHTML='<span aria-hidden="true">&#215;</span>',Vs(U,"click",function(X){tn(X),this.close()},this)}},_updateLayout:function(){var f=this._contentNode,w=f.style;w.width="",w.whiteSpace="nowrap";var R=f.offsetWidth;R=Math.min(R,this.options.maxWidth),R=Math.max(R,this.options.minWidth),w.width=R+1+"px",w.whiteSpace="",w.height="";var U=f.offsetHeight,X=this.options.maxHeight,he="leaflet-popup-scrolled";X&&U>X?(w.height=X+"px",xs(f,he)):Mr(f,he),this._containerWidth=this._container.offsetWidth},_animateZoom:function(f){var w=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center),R=this._getAnchor();Zt(this._container,w.add(R))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var f=this._map,w=parseInt(Ks(this._container,"marginBottom"),10)||0,R=this._container.offsetHeight+w,U=this._containerWidth,X=new Q(this._containerLeft,-R-this._containerBottom);X._add(na(this._container));var he=f.layerPointToContainerPoint(X),Fe=le(this.options.autoPanPadding),it=le(this.options.autoPanPaddingTopLeft||Fe),mt=le(this.options.autoPanPaddingBottomRight||Fe),Rt=f.getSize(),ss=0,Ms=0;he.x+U+mt.x>Rt.x&&(ss=he.x+U-Rt.x+mt.x),he.x-ss-it.x<0&&(ss=he.x-it.x),he.y+R+mt.y>Rt.y&&(Ms=he.y+R-Rt.y+mt.y),he.y-Ms-it.y<0&&(Ms=he.y-it.y),(ss||Ms)&&(this.options.keepInView&&(this._autopanning=!0),f.fire("autopanstart").panBy([ss,Ms]))}},_getAnchor:function(){return le(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Vn=function(f,w){return new Bn(f,w)};wr.mergeOptions({closePopupOnClick:!0}),wr.include({openPopup:function(f,w,R){return this._initOverlay(Bn,f,w,R).openOn(this),this},closePopup:function(f){return f=arguments.length?f:this._popup,f&&f.close(),this}}),$a.include({bindPopup:function(f,w){return this._popup=this._initOverlay(Bn,this._popup,f,w),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(f){return this._popup&&(this instanceof no||(this._popup._source=this),this._popup._prepareOpen(f||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(f){return this._popup&&this._popup.setContent(f),this},getPopup:function(){return this._popup},_openPopup:function(f){if(!(!this._popup||!this._map)){Fi(f);var w=f.layer||f.target;if(this._popup._source===w&&!(w instanceof oo)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(f.latlng);return}this._popup._source=w,this.openPopup(f.latlng)}},_movePopup:function(f){this._popup.setLatLng(f.latlng)},_onKeyPress:function(f){f.originalEvent.keyCode===13&&this._openPopup(f)}});var kr=ma.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(f){ma.prototype.onAdd.call(this,f),this.setOpacity(this.options.opacity),f.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(f){ma.prototype.onRemove.call(this,f),f.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var f=ma.prototype.getEvents.call(this);return this.options.permanent||(f.preclick=this.close),f},_initLayout:function(){var f="leaflet-tooltip",w=f+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Hs("div",w),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(f){var w,R,U=this._map,X=this._container,he=U.latLngToContainerPoint(U.getCenter()),Fe=U.layerPointToContainerPoint(f),it=this.options.direction,mt=X.offsetWidth,Rt=X.offsetHeight,ss=le(this.options.offset),Ms=this._getAnchor();it==="top"?(w=mt/2,R=Rt):it==="bottom"?(w=mt/2,R=0):it==="center"?(w=mt/2,R=Rt/2):it==="right"?(w=0,R=Rt/2):it==="left"?(w=mt,R=Rt/2):Fe.x<he.x?(it="right",w=0,R=Rt/2):(it="left",w=mt+(ss.x+Ms.x)*2,R=Rt/2),f=f.subtract(le(w,R,!0)).add(ss).add(Ms),Mr(X,"leaflet-tooltip-right"),Mr(X,"leaflet-tooltip-left"),Mr(X,"leaflet-tooltip-top"),Mr(X,"leaflet-tooltip-bottom"),xs(X,"leaflet-tooltip-"+it),Zt(X,f)},_updatePosition:function(){var f=this._map.latLngToLayerPoint(this._latlng);this._setPosition(f)},setOpacity:function(f){this.options.opacity=f,this._container&&mr(this._container,f)},_animateZoom:function(f){var w=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center);this._setPosition(w)},_getAnchor:function(){return le(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),rn=function(f,w){return new kr(f,w)};wr.include({openTooltip:function(f,w,R){return this._initOverlay(kr,f,w,R).openOn(this),this},closeTooltip:function(f){return f.close(),this}}),$a.include({bindTooltip:function(f,w){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(kr,this._tooltip,f,w),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(f){if(!(!f&&this._tooltipHandlersAdded)){var w=f?"off":"on",R={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?R.add=this._openTooltip:(R.mouseover=this._openTooltip,R.mouseout=this.closeTooltip,R.click=this._openTooltip,this._map?this._addFocusListeners():R.add=this._addFocusListeners),this._tooltip.options.sticky&&(R.mousemove=this._moveTooltip),this[w](R),this._tooltipHandlersAdded=!f}},openTooltip:function(f){return this._tooltip&&(this instanceof no||(this._tooltip._source=this),this._tooltip._prepareOpen(f)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(f){return this._tooltip&&this._tooltip.setContent(f),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(f){var w=typeof f.getElement=="function"&&f.getElement();w&&(Vs(w,"focus",function(){this._tooltip._source=f,this.openTooltip()},this),Vs(w,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(f){var w=typeof f.getElement=="function"&&f.getElement();w&&w.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(f){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var w=this;this._map.once("moveend",function(){w._openOnceFlag=!1,w._openTooltip(f)});return}this._tooltip._source=f.layer||f.target,this.openTooltip(this._tooltip.options.sticky?f.latlng:void 0)}},_moveTooltip:function(f){var w=f.latlng,R,U;this._tooltip.options.sticky&&f.originalEvent&&(R=this._map.mouseEventToContainerPoint(f.originalEvent),U=this._map.containerPointToLayerPoint(R),w=this._map.layerPointToLatLng(U)),this._tooltip.setLatLng(w)}});var Un=Ic.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(f){var w=f&&f.tagName==="DIV"?f:document.createElement("div"),R=this.options;if(R.html instanceof Element?(Tc(w),w.appendChild(R.html)):w.innerHTML=R.html!==!1?R.html:"",R.bgPos){var U=le(R.bgPos);w.style.backgroundPosition=-U.x+"px "+-U.y+"px"}return this._setIconStyles(w,"icon"),w},createShadow:function(){return null}});function Dc(f){return new Un(f)}Ic.Default=Xd;var lo=$a.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Gt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(f){_(this,f)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(f){f._addZoomLimit(this)},onRemove:function(f){this._removeAllTiles(),ta(this._container),f._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(aa(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(si(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(f){return this.options.opacity=f,this._updateOpacity(),this},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var f=this._clampZoom(this._map.getZoom());f!==this._tileZoom&&(this._tileZoom=f,this._updateLevels()),this._update()}return this},getEvents:function(){var f={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=h(this._onMoveEnd,this.options.updateInterval,this)),f.move=this._onMove),this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},createTile:function(){return document.createElement("div")},getTileSize:function(){var f=this.options.tileSize;return f instanceof Q?f:new Q(f,f)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(f){for(var w=this.getPane().children,R=-f(-1/0,1/0),U=0,X=w.length,he;U<X;U++)he=w[U].style.zIndex,w[U]!==this._container&&he&&(R=f(R,+he));isFinite(R)&&(this.options.zIndex=R+f(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Gt.ielt9){mr(this._container,this.options.opacity);var f=+new Date,w=!1,R=!1;for(var U in this._tiles){var X=this._tiles[U];if(!(!X.current||!X.loaded)){var he=Math.min(1,(f-X.loaded)/200);mr(X.el,he),he<1?w=!0:(X.active?R=!0:this._onOpaqueTile(X),X.active=!0)}}R&&!this._noPrune&&this._pruneTiles(),w&&(Y(this._fadeFrame),this._fadeFrame=q(this._updateOpacity,this))}},_onOpaqueTile:x,_initContainer:function(){this._container||(this._container=Hs("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var f=this._tileZoom,w=this.options.maxZoom;if(f!==void 0){for(var R in this._levels)R=Number(R),this._levels[R].el.children.length||R===f?(this._levels[R].el.style.zIndex=w-Math.abs(f-R),this._onUpdateLevel(R)):(ta(this._levels[R].el),this._removeTilesAtZoom(R),this._onRemoveLevel(R),delete this._levels[R]);var U=this._levels[f],X=this._map;return U||(U=this._levels[f]={},U.el=Hs("div","leaflet-tile-container leaflet-zoom-animated",this._container),U.el.style.zIndex=w,U.origin=X.project(X.unproject(X.getPixelOrigin()),f).round(),U.zoom=f,this._setZoomTransform(U,X.getCenter(),X.getZoom()),x(U.el.offsetWidth),this._onCreateLevel(U)),this._level=U,U}},_onUpdateLevel:x,_onRemoveLevel:x,_onCreateLevel:x,_pruneTiles:function(){if(this._map){var f,w,R=this._map.getZoom();if(R>this.options.maxZoom||R<this.options.minZoom){this._removeAllTiles();return}for(f in this._tiles)w=this._tiles[f],w.retain=w.current;for(f in this._tiles)if(w=this._tiles[f],w.current&&!w.active){var U=w.coords;this._retainParent(U.x,U.y,U.z,U.z-5)||this._retainChildren(U.x,U.y,U.z,U.z+2)}for(f in this._tiles)this._tiles[f].retain||this._removeTile(f)}},_removeTilesAtZoom:function(f){for(var w in this._tiles)this._tiles[w].coords.z===f&&this._removeTile(w)},_removeAllTiles:function(){for(var f in this._tiles)this._removeTile(f)},_invalidateAll:function(){for(var f in this._levels)ta(this._levels[f].el),this._onRemoveLevel(Number(f)),delete this._levels[f];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(f,w,R,U){var X=Math.floor(f/2),he=Math.floor(w/2),Fe=R-1,it=new Q(+X,+he);it.z=+Fe;var mt=this._tileCoordsToKey(it),Rt=this._tiles[mt];return Rt&&Rt.active?(Rt.retain=!0,!0):(Rt&&Rt.loaded&&(Rt.retain=!0),Fe>U?this._retainParent(X,he,Fe,U):!1)},_retainChildren:function(f,w,R,U){for(var X=2*f;X<2*f+2;X++)for(var he=2*w;he<2*w+2;he++){var Fe=new Q(X,he);Fe.z=R+1;var it=this._tileCoordsToKey(Fe),mt=this._tiles[it];if(mt&&mt.active){mt.retain=!0;continue}else mt&&mt.loaded&&(mt.retain=!0);R+1<U&&this._retainChildren(X,he,R+1,U)}},_resetView:function(f){var w=f&&(f.pinch||f.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),w,w)},_animateZoom:function(f){this._setView(f.center,f.zoom,!0,f.noUpdate)},_clampZoom:function(f){var w=this.options;return w.minNativeZoom!==void 0&&f<w.minNativeZoom?w.minNativeZoom:w.maxNativeZoom!==void 0&&w.maxNativeZoom<f?w.maxNativeZoom:f},_setView:function(f,w,R,U){var X=Math.round(w);this.options.maxZoom!==void 0&&X>this.options.maxZoom||this.options.minZoom!==void 0&&X<this.options.minZoom?X=void 0:X=this._clampZoom(X);var he=this.options.updateWhenZooming&&X!==this._tileZoom;(!U||he)&&(this._tileZoom=X,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),X!==void 0&&this._update(f),R||this._pruneTiles(),this._noPrune=!!R),this._setZoomTransforms(f,w)},_setZoomTransforms:function(f,w){for(var R in this._levels)this._setZoomTransform(this._levels[R],f,w)},_setZoomTransform:function(f,w,R){var U=this._map.getZoomScale(R,f.zoom),X=f.origin.multiplyBy(U).subtract(this._map._getNewPixelOrigin(w,R)).round();Gt.any3d?_e(f.el,X,U):Zt(f.el,X)},_resetGrid:function(){var f=this._map,w=f.options.crs,R=this._tileSize=this.getTileSize(),U=this._tileZoom,X=this._map.getPixelWorldBounds(this._tileZoom);X&&(this._globalTileRange=this._pxBoundsToTileRange(X)),this._wrapX=w.wrapLng&&!this.options.noWrap&&[Math.floor(f.project([0,w.wrapLng[0]],U).x/R.x),Math.ceil(f.project([0,w.wrapLng[1]],U).x/R.y)],this._wrapY=w.wrapLat&&!this.options.noWrap&&[Math.floor(f.project([w.wrapLat[0],0],U).y/R.x),Math.ceil(f.project([w.wrapLat[1],0],U).y/R.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(f){var w=this._map,R=w._animatingZoom?Math.max(w._animateToZoom,w.getZoom()):w.getZoom(),U=w.getZoomScale(R,this._tileZoom),X=w.project(f,this._tileZoom).floor(),he=w.getSize().divideBy(U*2);return new ye(X.subtract(he),X.add(he))},_update:function(f){var w=this._map;if(w){var R=this._clampZoom(w.getZoom());if(f===void 0&&(f=w.getCenter()),this._tileZoom!==void 0){var U=this._getTiledPixelBounds(f),X=this._pxBoundsToTileRange(U),he=X.getCenter(),Fe=[],it=this.options.keepBuffer,mt=new ye(X.getBottomLeft().subtract([it,-it]),X.getTopRight().add([it,-it]));if(!(isFinite(X.min.x)&&isFinite(X.min.y)&&isFinite(X.max.x)&&isFinite(X.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Rt in this._tiles){var ss=this._tiles[Rt].coords;(ss.z!==this._tileZoom||!mt.contains(new Q(ss.x,ss.y)))&&(this._tiles[Rt].current=!1)}if(Math.abs(R-this._tileZoom)>1){this._setView(f,R);return}for(var Ms=X.min.y;Ms<=X.max.y;Ms++)for(var vr=X.min.x;vr<=X.max.x;vr++){var ii=new Q(vr,Ms);if(ii.z=this._tileZoom,!!this._isValidTile(ii)){var gn=this._tiles[this._tileCoordsToKey(ii)];gn?gn.current=!0:Fe.push(ii)}}if(Fe.sort(function(ji,ah){return ji.distanceTo(he)-ah.distanceTo(he)}),Fe.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var co=document.createDocumentFragment();for(vr=0;vr<Fe.length;vr++)this._addTile(Fe[vr],co);this._level.el.appendChild(co)}}}},_isValidTile:function(f){var w=this._map.options.crs;if(!w.infinite){var R=this._globalTileRange;if(!w.wrapLng&&(f.x<R.min.x||f.x>R.max.x)||!w.wrapLat&&(f.y<R.min.y||f.y>R.max.y))return!1}if(!this.options.bounds)return!0;var U=this._tileCoordsToBounds(f);return ie(this.options.bounds).overlaps(U)},_keyToBounds:function(f){return this._tileCoordsToBounds(this._keyToTileCoords(f))},_tileCoordsToNwSe:function(f){var w=this._map,R=this.getTileSize(),U=f.scaleBy(R),X=U.add(R),he=w.unproject(U,f.z),Fe=w.unproject(X,f.z);return[he,Fe]},_tileCoordsToBounds:function(f){var w=this._tileCoordsToNwSe(f),R=new ee(w[0],w[1]);return this.options.noWrap||(R=this._map.wrapLatLngBounds(R)),R},_tileCoordsToKey:function(f){return f.x+":"+f.y+":"+f.z},_keyToTileCoords:function(f){var w=f.split(":"),R=new Q(+w[0],+w[1]);return R.z=+w[2],R},_removeTile:function(f){var w=this._tiles[f];w&&(ta(w.el),delete this._tiles[f],this.fire("tileunload",{tile:w.el,coords:this._keyToTileCoords(f)}))},_initTile:function(f){xs(f,"leaflet-tile");var w=this.getTileSize();f.style.width=w.x+"px",f.style.height=w.y+"px",f.onselectstart=x,f.onmousemove=x,Gt.ielt9&&this.options.opacity<1&&mr(f,this.options.opacity)},_addTile:function(f,w){var R=this._getTilePos(f),U=this._tileCoordsToKey(f),X=this.createTile(this._wrapCoords(f),o(this._tileReady,this,f));this._initTile(X),this.createTile.length<2&&q(o(this._tileReady,this,f,null,X)),Zt(X,R),this._tiles[U]={el:X,coords:f,current:!0},w.appendChild(X),this.fire("tileloadstart",{tile:X,coords:f})},_tileReady:function(f,w,R){w&&this.fire("tileerror",{error:w,tile:R,coords:f});var U=this._tileCoordsToKey(f);R=this._tiles[U],R&&(R.loaded=+new Date,this._map._fadeAnimated?(mr(R.el,0),Y(this._fadeFrame),this._fadeFrame=q(this._updateOpacity,this)):(R.active=!0,this._pruneTiles()),w||(xs(R.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:R.el,coords:f})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Gt.ielt9||!this._map._fadeAnimated?q(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(f){return f.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(f){var w=new Q(this._wrapX?p(f.x,this._wrapX):f.x,this._wrapY?p(f.y,this._wrapY):f.y);return w.z=f.z,w},_pxBoundsToTileRange:function(f){var w=this.getTileSize();return new ye(f.min.unscaleBy(w).floor(),f.max.unscaleBy(w).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var f in this._tiles)if(!this._tiles[f].loaded)return!1;return!0}});function v1(f){return new lo(f)}var Mc=lo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(f,w){this._url=f,w=_(this,w),w.detectRetina&&Gt.retina&&w.maxZoom>0?(w.tileSize=Math.floor(w.tileSize/2),w.zoomReverse?(w.zoomOffset--,w.minZoom=Math.min(w.maxZoom,w.minZoom+1)):(w.zoomOffset++,w.maxZoom=Math.max(w.minZoom,w.maxZoom-1)),w.minZoom=Math.max(0,w.minZoom)):w.zoomReverse?w.minZoom=Math.min(w.maxZoom,w.minZoom):w.maxZoom=Math.max(w.minZoom,w.maxZoom),typeof w.subdomains=="string"&&(w.subdomains=w.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(f,w){return this._url===f&&w===void 0&&(w=!0),this._url=f,w||this.redraw(),this},createTile:function(f,w){var R=document.createElement("img");return Vs(R,"load",o(this._tileOnLoad,this,w,R)),Vs(R,"error",o(this._tileOnError,this,w,R)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(R.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(R.referrerPolicy=this.options.referrerPolicy),R.alt="",R.src=this.getTileUrl(f),R},getTileUrl:function(f){var w={r:Gt.retina?"@2x":"",s:this._getSubdomain(f),x:f.x,y:f.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var R=this._globalTileRange.max.y-f.y;this.options.tms&&(w.y=R),w["-y"]=R}return A(this._url,n(w,this.options))},_tileOnLoad:function(f,w){Gt.ielt9?setTimeout(o(f,this,null,w),0):f(null,w)},_tileOnError:function(f,w,R){var U=this.options.errorTileUrl;U&&w.getAttribute("src")!==U&&(w.src=U),f(R,w)},_onTileRemove:function(f){f.tile.onload=null},_getZoomForUrl:function(){var f=this._tileZoom,w=this.options.maxZoom,R=this.options.zoomReverse,U=this.options.zoomOffset;return R&&(f=w-f),f+U},_getSubdomain:function(f){var w=Math.abs(f.x+f.y)%this.options.subdomains.length;return this.options.subdomains[w]},_abortLoading:function(){var f,w;for(f in this._tiles)if(this._tiles[f].coords.z!==this._tileZoom&&(w=this._tiles[f].el,w.onload=x,w.onerror=x,!w.complete)){w.src=B;var R=this._tiles[f].coords;ta(w),delete this._tiles[f],this.fire("tileabort",{tile:w,coords:R})}},_removeTile:function(f){var w=this._tiles[f];if(w)return w.el.setAttribute("src",B),lo.prototype._removeTile.call(this,f)},_tileReady:function(f,w,R){if(!(!this._map||R&&R.getAttribute("src")===B))return lo.prototype._tileReady.call(this,f,w,R)}});function v2(f,w){return new Mc(f,w)}var y2=Mc.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(f,w){this._url=f;var R=n({},this.defaultWmsParams);for(var U in w)U in this.options||(R[U]=w[U]);w=_(this,w);var X=w.detectRetina&&Gt.retina?2:1,he=this.getTileSize();R.width=he.x*X,R.height=he.y*X,this.wmsParams=R},onAdd:function(f){this._crs=this.options.crs||f.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var w=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[w]=this._crs.code,Mc.prototype.onAdd.call(this,f)},getTileUrl:function(f){var w=this._tileCoordsToNwSe(f),R=this._crs,U=W(R.project(w[0]),R.project(w[1])),X=U.min,he=U.max,Fe=(this._wmsVersion>=1.3&&this._crs===Pc?[X.y,X.x,he.y,he.x]:[X.x,X.y,he.x,he.y]).join(","),it=Mc.prototype.getTileUrl.call(this,f);return it+C(this.wmsParams,it,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Fe},setParams:function(f,w){return n(this.wmsParams,f),w||this.redraw(),this}});function N8(f,w){return new y2(f,w)}Mc.WMS=y2,v2.wms=N8;var Ql=$a.extend({options:{padding:.1},initialize:function(f){_(this,f),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),xs(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var f={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(f.zoomanim=this._onAnimZoom),f},_onAnimZoom:function(f){this._updateTransform(f.center,f.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(f,w){var R=this._map.getZoomScale(w,this._zoom),U=this._map.getSize().multiplyBy(.5+this.options.padding),X=this._map.project(this._center,w),he=U.multiplyBy(-R).add(X).subtract(this._map._getNewPixelOrigin(f,w));Gt.any3d?_e(this._container,he,R):Zt(this._container,he)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var f in this._layers)this._layers[f]._reset()},_onZoomEnd:function(){for(var f in this._layers)this._layers[f]._project()},_updatePaths:function(){for(var f in this._layers)this._layers[f]._update()},_update:function(){var f=this.options.padding,w=this._map.getSize(),R=this._map.containerPointToLayerPoint(w.multiplyBy(-f)).round();this._bounds=new ye(R,R.add(w.multiplyBy(1+f*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),w2=Ql.extend({options:{tolerance:0},getEvents:function(){var f=Ql.prototype.getEvents.call(this);return f.viewprereset=this._onViewPreReset,f},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Ql.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var f=this._container=document.createElement("canvas");Vs(f,"mousemove",this._onMouseMove,this),Vs(f,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Vs(f,"mouseout",this._handleMouseOut,this),f._leaflet_disable_events=!0,this._ctx=f.getContext("2d")},_destroyContainer:function(){Y(this._redrawRequest),delete this._ctx,ta(this._container),Qt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var f;this._redrawBounds=null;for(var w in this._layers)f=this._layers[w],f._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ql.prototype._update.call(this);var f=this._bounds,w=this._container,R=f.getSize(),U=Gt.retina?2:1;Zt(w,f.min),w.width=U*R.x,w.height=U*R.y,w.style.width=R.x+"px",w.style.height=R.y+"px",Gt.retina&&this._ctx.scale(2,2),this._ctx.translate(-f.min.x,-f.min.y),this.fire("update")}},_reset:function(){Ql.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(f){this._updateDashArray(f),this._layers[d(f)]=f;var w=f._order={layer:f,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=w),this._drawLast=w,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(f){this._requestRedraw(f)},_removePath:function(f){var w=f._order,R=w.next,U=w.prev;R?R.prev=U:this._drawLast=U,U?U.next=R:this._drawFirst=R,delete f._order,delete this._layers[d(f)],this._requestRedraw(f)},_updatePath:function(f){this._extendRedrawBounds(f),f._project(),f._update(),this._requestRedraw(f)},_updateStyle:function(f){this._updateDashArray(f),this._requestRedraw(f)},_updateDashArray:function(f){if(typeof f.options.dashArray=="string"){var w=f.options.dashArray.split(/[, ]+/),R=[],U,X;for(X=0;X<w.length;X++){if(U=Number(w[X]),isNaN(U))return;R.push(U)}f.options._dashArray=R}else f.options._dashArray=f.options.dashArray},_requestRedraw:function(f){this._map&&(this._extendRedrawBounds(f),this._redrawRequest=this._redrawRequest||q(this._redraw,this))},_extendRedrawBounds:function(f){if(f._pxBounds){var w=(f.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ye,this._redrawBounds.extend(f._pxBounds.min.subtract([w,w])),this._redrawBounds.extend(f._pxBounds.max.add([w,w]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var f=this._redrawBounds;if(f){var w=f.getSize();this._ctx.clearRect(f.min.x,f.min.y,w.x,w.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var f,w=this._redrawBounds;if(this._ctx.save(),w){var R=w.getSize();this._ctx.beginPath(),this._ctx.rect(w.min.x,w.min.y,R.x,R.y),this._ctx.clip()}this._drawing=!0;for(var U=this._drawFirst;U;U=U.next)f=U.layer,(!w||f._pxBounds&&f._pxBounds.intersects(w))&&f._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(f,w){if(this._drawing){var R,U,X,he,Fe=f._parts,it=Fe.length,mt=this._ctx;if(it){for(mt.beginPath(),R=0;R<it;R++){for(U=0,X=Fe[R].length;U<X;U++)he=Fe[R][U],mt[U?"lineTo":"moveTo"](he.x,he.y);w&&mt.closePath()}this._fillStroke(mt,f)}}},_updateCircle:function(f){if(!(!this._drawing||f._empty())){var w=f._point,R=this._ctx,U=Math.max(Math.round(f._radius),1),X=(Math.max(Math.round(f._radiusY),1)||U)/U;X!==1&&(R.save(),R.scale(1,X)),R.beginPath(),R.arc(w.x,w.y/X,U,0,Math.PI*2,!1),X!==1&&R.restore(),this._fillStroke(R,f)}},_fillStroke:function(f,w){var R=w.options;R.fill&&(f.globalAlpha=R.fillOpacity,f.fillStyle=R.fillColor||R.color,f.fill(R.fillRule||"evenodd")),R.stroke&&R.weight!==0&&(f.setLineDash&&f.setLineDash(w.options&&w.options._dashArray||[]),f.globalAlpha=R.opacity,f.lineWidth=R.weight,f.strokeStyle=R.color,f.lineCap=R.lineCap,f.lineJoin=R.lineJoin,f.stroke())},_onClick:function(f){for(var w=this._map.mouseEventToLayerPoint(f),R,U,X=this._drawFirst;X;X=X.next)R=X.layer,R.options.interactive&&R._containsPoint(w)&&(!(f.type==="click"||f.type==="preclick")||!this._map._draggableMoved(R))&&(U=R);this._fireEvent(U?[U]:!1,f)},_onMouseMove:function(f){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var w=this._map.mouseEventToLayerPoint(f);this._handleMouseHover(f,w)}},_handleMouseOut:function(f){var w=this._hoveredLayer;w&&(Mr(this._container,"leaflet-interactive"),this._fireEvent([w],f,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(f,w){if(!this._mouseHoverThrottled){for(var R,U,X=this._drawFirst;X;X=X.next)R=X.layer,R.options.interactive&&R._containsPoint(w)&&(U=R);U!==this._hoveredLayer&&(this._handleMouseOut(f),U&&(xs(this._container,"leaflet-interactive"),this._fireEvent([U],f,"mouseover"),this._hoveredLayer=U)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,f),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(f,w,R){this._map._fireDOMEvent(w,R||w.type,f)},_bringToFront:function(f){var w=f._order;if(w){var R=w.next,U=w.prev;if(R)R.prev=U;else return;U?U.next=R:R&&(this._drawFirst=R),w.prev=this._drawLast,this._drawLast.next=w,w.next=null,this._drawLast=w,this._requestRedraw(f)}},_bringToBack:function(f){var w=f._order;if(w){var R=w.next,U=w.prev;if(U)U.next=R;else return;R?R.prev=U:U&&(this._drawLast=U),w.prev=null,w.next=this._drawFirst,this._drawFirst.prev=w,this._drawFirst=w,this._requestRedraw(f)}}});function b2(f){return Gt.canvas?new w2(f):null}var cm=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(f){return document.createElement("<lvml:"+f+' class="lvml">')}}catch{}return function(f){return document.createElement("<"+f+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),C8={_initContainer:function(){this._container=Hs("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Ql.prototype._update.call(this),this.fire("update"))},_initPath:function(f){var w=f._container=cm("shape");xs(w,"leaflet-vml-shape "+(this.options.className||"")),w.coordsize="1 1",f._path=cm("path"),w.appendChild(f._path),this._updateStyle(f),this._layers[d(f)]=f},_addPath:function(f){var w=f._container;this._container.appendChild(w),f.options.interactive&&f.addInteractiveTarget(w)},_removePath:function(f){var w=f._container;ta(w),f.removeInteractiveTarget(w),delete this._layers[d(f)]},_updateStyle:function(f){var w=f._stroke,R=f._fill,U=f.options,X=f._container;X.stroked=!!U.stroke,X.filled=!!U.fill,U.stroke?(w||(w=f._stroke=cm("stroke")),X.appendChild(w),w.weight=U.weight+"px",w.color=U.color,w.opacity=U.opacity,U.dashArray?w.dashStyle=k(U.dashArray)?U.dashArray.join(" "):U.dashArray.replace(/( *, *)/g," "):w.dashStyle="",w.endcap=U.lineCap.replace("butt","flat"),w.joinstyle=U.lineJoin):w&&(X.removeChild(w),f._stroke=null),U.fill?(R||(R=f._fill=cm("fill")),X.appendChild(R),R.color=U.fillColor||U.color,R.opacity=U.fillOpacity):R&&(X.removeChild(R),f._fill=null)},_updateCircle:function(f){var w=f._point.round(),R=Math.round(f._radius),U=Math.round(f._radiusY||R);this._setPath(f,f._empty()?"M0 0":"AL "+w.x+","+w.y+" "+R+","+U+" 0,"+65535*360)},_setPath:function(f,w){f._path.v=w},_bringToFront:function(f){aa(f._container)},_bringToBack:function(f){si(f._container)}},S0=Gt.vml?cm:ot,dm=Ql.extend({_initContainer:function(){this._container=S0("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=S0("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ta(this._container),Qt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ql.prototype._update.call(this);var f=this._bounds,w=f.getSize(),R=this._container;(!this._svgSize||!this._svgSize.equals(w))&&(this._svgSize=w,R.setAttribute("width",w.x),R.setAttribute("height",w.y)),Zt(R,f.min),R.setAttribute("viewBox",[f.min.x,f.min.y,w.x,w.y].join(" ")),this.fire("update")}},_initPath:function(f){var w=f._path=S0("path");f.options.className&&xs(w,f.options.className),f.options.interactive&&xs(w,"leaflet-interactive"),this._updateStyle(f),this._layers[d(f)]=f},_addPath:function(f){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(f._path),f.addInteractiveTarget(f._path)},_removePath:function(f){ta(f._path),f.removeInteractiveTarget(f._path),delete this._layers[d(f)]},_updatePath:function(f){f._project(),f._update()},_updateStyle:function(f){var w=f._path,R=f.options;w&&(R.stroke?(w.setAttribute("stroke",R.color),w.setAttribute("stroke-opacity",R.opacity),w.setAttribute("stroke-width",R.weight),w.setAttribute("stroke-linecap",R.lineCap),w.setAttribute("stroke-linejoin",R.lineJoin),R.dashArray?w.setAttribute("stroke-dasharray",R.dashArray):w.removeAttribute("stroke-dasharray"),R.dashOffset?w.setAttribute("stroke-dashoffset",R.dashOffset):w.removeAttribute("stroke-dashoffset")):w.setAttribute("stroke","none"),R.fill?(w.setAttribute("fill",R.fillColor||R.color),w.setAttribute("fill-opacity",R.fillOpacity),w.setAttribute("fill-rule",R.fillRule||"evenodd")):w.setAttribute("fill","none"))},_updatePoly:function(f,w){this._setPath(f,Se(f._parts,w))},_updateCircle:function(f){var w=f._point,R=Math.max(Math.round(f._radius),1),U=Math.max(Math.round(f._radiusY),1)||R,X="a"+R+","+U+" 0 1,0 ",he=f._empty()?"M0 0":"M"+(w.x-R)+","+w.y+X+R*2+",0 "+X+-R*2+",0 ";this._setPath(f,he)},_setPath:function(f,w){f._path.setAttribute("d",w)},_bringToFront:function(f){aa(f._path)},_bringToBack:function(f){si(f._path)}});Gt.vml&&dm.include(C8);function _2(f){return Gt.svg||Gt.vml?new dm(f):null}wr.include({getRenderer:function(f){var w=f.options.renderer||this._getPaneRenderer(f.options.pane)||this.options.renderer||this._renderer;return w||(w=this._renderer=this._createRenderer()),this.hasLayer(w)||this.addLayer(w),w},_getPaneRenderer:function(f){if(f==="overlayPane"||f===void 0)return!1;var w=this._paneRenderers[f];return w===void 0&&(w=this._createRenderer({pane:f}),this._paneRenderers[f]=w),w},_createRenderer:function(f){return this.options.preferCanvas&&b2(f)||_2(f)}});var j2=m.extend({initialize:function(f,w){m.prototype.initialize.call(this,this._boundsToLatLngs(f),w)},setBounds:function(f){return this.setLatLngs(this._boundsToLatLngs(f))},_boundsToLatLngs:function(f){return f=ie(f),[f.getSouthWest(),f.getNorthWest(),f.getNorthEast(),f.getSouthEast()]}});function E8(f,w){return new j2(f,w)}dm.create=S0,dm.pointsToPath=Se,y.geometryToLayer=j,y.coordsToLatLng=P,y.coordsToLatLngs=V,y.latLngToCoords=K,y.latLngsToCoords=se,y.getFeature=ue,y.asFeature=Ae,wr.mergeOptions({boxZoom:!0});var N2=ri.extend({initialize:function(f){this._map=f,this._container=f._container,this._pane=f._panes.overlayPane,this._resetStateTimeout=0,f.on("unload",this._destroy,this)},addHooks:function(){Vs(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Qt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ta(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(f){if(!f.shiftKey||f.which!==1&&f.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),pn(),Ns(),this._startPoint=this._map.mouseEventToContainerPoint(f),Vs(document,{contextmenu:Fi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(f){this._moved||(this._moved=!0,this._box=Hs("div","leaflet-zoom-box",this._container),xs(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(f);var w=new ye(this._point,this._startPoint),R=w.getSize();Zt(this._box,w.min),this._box.style.width=R.x+"px",this._box.style.height=R.y+"px"},_finish:function(){this._moved&&(ta(this._box),Mr(this._container,"leaflet-crosshair")),$d(),sa(),Qt(document,{contextmenu:Fi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(f){if(!(f.which!==1&&f.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var w=new ee(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(w).fire("boxzoomend",{boxZoomBounds:w})}},_onKeyDown:function(f){f.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});wr.addInitHook("addHandler","boxZoom",N2),wr.mergeOptions({doubleClickZoom:!0});var C2=ri.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(f){var w=this._map,R=w.getZoom(),U=w.options.zoomDelta,X=f.originalEvent.shiftKey?R-U:R+U;w.options.doubleClickZoom==="center"?w.setZoom(X):w.setZoomAround(f.containerPoint,X)}});wr.addInitHook("addHandler","doubleClickZoom",C2),wr.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var E2=ri.extend({addHooks:function(){if(!this._draggable){var f=this._map;this._draggable=new dl(f._mapPane,f._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),f.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),f.on("zoomend",this._onZoomEnd,this),f.whenReady(this._onZoomEnd,this))}xs(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Mr(this._map._container,"leaflet-grab"),Mr(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var f=this._map;if(f._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var w=ie(this._map.options.maxBounds);this._offsetLimit=W(this._map.latLngToContainerPoint(w.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(w.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;f.fire("movestart").fire("dragstart"),f.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(f){if(this._map.options.inertia){var w=this._lastTime=+new Date,R=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(R),this._times.push(w),this._prunePositions(w)}this._map.fire("move",f).fire("drag",f)},_prunePositions:function(f){for(;this._positions.length>1&&f-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var f=this._map.getSize().divideBy(2),w=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=w.subtract(f).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(f,w){return f-(f-w)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var f=this._draggable._newPos.subtract(this._draggable._startPos),w=this._offsetLimit;f.x<w.min.x&&(f.x=this._viscousLimit(f.x,w.min.x)),f.y<w.min.y&&(f.y=this._viscousLimit(f.y,w.min.y)),f.x>w.max.x&&(f.x=this._viscousLimit(f.x,w.max.x)),f.y>w.max.y&&(f.y=this._viscousLimit(f.y,w.max.y)),this._draggable._newPos=this._draggable._startPos.add(f)}},_onPreDragWrap:function(){var f=this._worldWidth,w=Math.round(f/2),R=this._initialWorldOffset,U=this._draggable._newPos.x,X=(U-w+R)%f+w-R,he=(U+w+R)%f-w-R,Fe=Math.abs(X+R)<Math.abs(he+R)?X:he;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Fe},_onDragEnd:function(f){var w=this._map,R=w.options,U=!R.inertia||f.noInertia||this._times.length<2;if(w.fire("dragend",f),U)w.fire("moveend");else{this._prunePositions(+new Date);var X=this._lastPos.subtract(this._positions[0]),he=(this._lastTime-this._times[0])/1e3,Fe=R.easeLinearity,it=X.multiplyBy(Fe/he),mt=it.distanceTo([0,0]),Rt=Math.min(R.inertiaMaxSpeed,mt),ss=it.multiplyBy(Rt/mt),Ms=Rt/(R.inertiaDeceleration*Fe),vr=ss.multiplyBy(-Ms/2).round();!vr.x&&!vr.y?w.fire("moveend"):(vr=w._limitOffset(vr,w.options.maxBounds),q(function(){w.panBy(vr,{duration:Ms,easeLinearity:Fe,noMoveStart:!0,animate:!0})}))}}});wr.addInitHook("addHandler","dragging",E2),wr.mergeOptions({keyboard:!0,keyboardPanDelta:80});var S2=ri.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(f){this._map=f,this._setPanDelta(f.options.keyboardPanDelta),this._setZoomDelta(f.options.zoomDelta)},addHooks:function(){var f=this._map._container;f.tabIndex<=0&&(f.tabIndex="0"),Vs(f,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Qt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var f=document.body,w=document.documentElement,R=f.scrollTop||w.scrollTop,U=f.scrollLeft||w.scrollLeft;this._map._container.focus(),window.scrollTo(U,R)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(f){var w=this._panKeys={},R=this.keyCodes,U,X;for(U=0,X=R.left.length;U<X;U++)w[R.left[U]]=[-1*f,0];for(U=0,X=R.right.length;U<X;U++)w[R.right[U]]=[f,0];for(U=0,X=R.down.length;U<X;U++)w[R.down[U]]=[0,f];for(U=0,X=R.up.length;U<X;U++)w[R.up[U]]=[0,-1*f]},_setZoomDelta:function(f){var w=this._zoomKeys={},R=this.keyCodes,U,X;for(U=0,X=R.zoomIn.length;U<X;U++)w[R.zoomIn[U]]=f;for(U=0,X=R.zoomOut.length;U<X;U++)w[R.zoomOut[U]]=-f},_addHooks:function(){Vs(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Qt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(f){if(!(f.altKey||f.ctrlKey||f.metaKey)){var w=f.keyCode,R=this._map,U;if(w in this._panKeys){if(!R._panAnim||!R._panAnim._inProgress)if(U=this._panKeys[w],f.shiftKey&&(U=le(U).multiplyBy(3)),R.options.maxBounds&&(U=R._limitOffset(le(U),R.options.maxBounds)),R.options.worldCopyJump){var X=R.wrapLatLng(R.unproject(R.project(R.getCenter()).add(U)));R.panTo(X)}else R.panBy(U)}else if(w in this._zoomKeys)R.setZoom(R.getZoom()+(f.shiftKey?3:1)*this._zoomKeys[w]);else if(w===27&&R._popup&&R._popup.options.closeOnEscapeKey)R.closePopup();else return;Fi(f)}}});wr.addInitHook("addHandler","keyboard",S2),wr.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var T2=ri.extend({addHooks:function(){Vs(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Qt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(f){var w=Rc(f),R=this._map.options.wheelDebounceTime;this._delta+=w,this._lastMousePos=this._map.mouseEventToContainerPoint(f),this._startTime||(this._startTime=+new Date);var U=Math.max(R-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),U),Fi(f)},_performZoom:function(){var f=this._map,w=f.getZoom(),R=this._map.options.zoomSnap||0;f._stop();var U=this._delta/(this._map.options.wheelPxPerZoomLevel*4),X=4*Math.log(2/(1+Math.exp(-Math.abs(U))))/Math.LN2,he=R?Math.ceil(X/R)*R:X,Fe=f._limitZoom(w+(this._delta>0?he:-he))-w;this._delta=0,this._startTime=null,Fe&&(f.options.scrollWheelZoom==="center"?f.setZoom(w+Fe):f.setZoomAround(this._lastMousePos,w+Fe))}});wr.addInitHook("addHandler","scrollWheelZoom",T2);var S8=600;wr.mergeOptions({tapHold:Gt.touchNative&&Gt.safari&&Gt.mobile,tapTolerance:15});var A2=ri.extend({addHooks:function(){Vs(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Qt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(f){if(clearTimeout(this._holdTimeout),f.touches.length===1){var w=f.touches[0];this._startPos=this._newPos=new Q(w.clientX,w.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(Vs(document,"touchend",tn),Vs(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",w))},this),S8),Vs(document,"touchend touchcancel contextmenu",this._cancel,this),Vs(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function f(){Qt(document,"touchend",tn),Qt(document,"touchend touchcancel",f)},_cancel:function(){clearTimeout(this._holdTimeout),Qt(document,"touchend touchcancel contextmenu",this._cancel,this),Qt(document,"touchmove",this._onMove,this)},_onMove:function(f){var w=f.touches[0];this._newPos=new Q(w.clientX,w.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(f,w){var R=new MouseEvent(f,{bubbles:!0,cancelable:!0,view:window,screenX:w.screenX,screenY:w.screenY,clientX:w.clientX,clientY:w.clientY});R._simulated=!0,w.target.dispatchEvent(R)}});wr.addInitHook("addHandler","tapHold",A2),wr.mergeOptions({touchZoom:Gt.touch,bounceAtZoomLimits:!0});var k2=ri.extend({addHooks:function(){xs(this._map._container,"leaflet-touch-zoom"),Vs(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Mr(this._map._container,"leaflet-touch-zoom"),Qt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(f){var w=this._map;if(!(!f.touches||f.touches.length!==2||w._animatingZoom||this._zooming)){var R=w.mouseEventToContainerPoint(f.touches[0]),U=w.mouseEventToContainerPoint(f.touches[1]);this._centerPoint=w.getSize()._divideBy(2),this._startLatLng=w.containerPointToLatLng(this._centerPoint),w.options.touchZoom!=="center"&&(this._pinchStartLatLng=w.containerPointToLatLng(R.add(U)._divideBy(2))),this._startDist=R.distanceTo(U),this._startZoom=w.getZoom(),this._moved=!1,this._zooming=!0,w._stop(),Vs(document,"touchmove",this._onTouchMove,this),Vs(document,"touchend touchcancel",this._onTouchEnd,this),tn(f)}},_onTouchMove:function(f){if(!(!f.touches||f.touches.length!==2||!this._zooming)){var w=this._map,R=w.mouseEventToContainerPoint(f.touches[0]),U=w.mouseEventToContainerPoint(f.touches[1]),X=R.distanceTo(U)/this._startDist;if(this._zoom=w.getScaleZoom(X,this._startZoom),!w.options.bounceAtZoomLimits&&(this._zoom<w.getMinZoom()&&X<1||this._zoom>w.getMaxZoom()&&X>1)&&(this._zoom=w._limitZoom(this._zoom)),w.options.touchZoom==="center"){if(this._center=this._startLatLng,X===1)return}else{var he=R._add(U)._divideBy(2)._subtract(this._centerPoint);if(X===1&&he.x===0&&he.y===0)return;this._center=w.unproject(w.project(this._pinchStartLatLng,this._zoom).subtract(he),this._zoom)}this._moved||(w._moveStart(!0,!1),this._moved=!0),Y(this._animRequest);var Fe=o(w._move,w,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=q(Fe,this,!0),tn(f)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Y(this._animRequest),Qt(document,"touchmove",this._onTouchMove,this),Qt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});wr.addInitHook("addHandler","touchZoom",k2),wr.BoxZoom=N2,wr.DoubleClickZoom=C2,wr.Drag=E2,wr.Keyboard=S2,wr.ScrollWheelZoom=T2,wr.TapHold=A2,wr.TouchZoom=k2,r.Bounds=ye,r.Browser=Gt,r.CRS=Ce,r.Canvas=w2,r.Circle=Oc,r.CircleMarker=fl,r.Class=je,r.Control=Bi,r.DivIcon=Un,r.DivOverlay=ma,r.DomEvent=Fn,r.DomUtil=za,r.Draggable=dl,r.Evented=G,r.FeatureGroup=no,r.GeoJSON=y,r.GridLayer=lo,r.Handler=ri,r.Icon=Ic,r.ImageOverlay=ht,r.LatLng=ce,r.LatLngBounds=ee,r.Layer=$a,r.LayerGroup=Mo,r.LineUtil=E0,r.Map=wr,r.Marker=ni,r.Mixin=j0,r.Path=oo,r.Point=Q,r.PolyUtil=rm,r.Polygon=m,r.Polyline=l,r.Popup=Bn,r.PosAnimation=sm,r.Projection=im,r.Rectangle=j2,r.Renderer=Ql,r.SVG=dm,r.SVGOverlay=pr,r.TileLayer=Mc,r.Tooltip=kr,r.Transformation=ne,r.Util=ae,r.VideoOverlay=Vt,r.bind=o,r.bounds=W,r.canvas=b2,r.circle=te,r.circleMarker=jr,r.control=Gd,r.divIcon=Dc,r.extend=n,r.featureGroup=io,r.geoJSON=$e,r.geoJson=st,r.gridLayer=v1,r.icon=om,r.imageOverlay=Bt,r.latLng=xe,r.latLngBounds=ie,r.layerGroup=_i,r.map=b0,r.marker=g1,r.point=le,r.polygon=g,r.polyline=u,r.popup=Vn,r.rectangle=E8,r.setOptions=_,r.stamp=d,r.svg=_2,r.svgOverlay=Ys,r.tileLayer=v2,r.tooltip=rn,r.transformation=Me,r.version=a,r.videoOverlay=Pt;var T8=window.L;r.noConflict=function(){return window.L=T8,this},window.L=r})})(mw,mw.exports);var wce=mw.exports;const Yc=qu(wce),bce=e=>{const t=e?"#95C11F":"#FBBB1A",r=e?32:24;return Yc.divIcon({className:"custom-marker",html:`
      <div style="
        width: ${r}px;
        height: ${r}px;
        background: ${t};
        border: 3px solid white;
        border-radius: 50%;
        box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
        ${e?"transform: scale(1.1);":""}
      ">
        <svg width="${r*.5}" height="${r*.5}" viewBox="0 0 24 24" fill="white">
          <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
        </svg>
      </div>
    `,iconSize:[r,r],iconAnchor:[r/2,r],popupAnchor:[0,-r]})},_ce=Yc.divIcon({className:"user-location-marker",html:`
    <div style="
      width: 20px;
      height: 20px;
      background: #3B82F6;
      border: 4px solid white;
      border-radius: 50%;
      box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.3), 0 2px 8px rgba(0,0,0,0.3);
      animation: pulse 2s infinite;
    "></div>
    <style>
      @keyframes pulse {
        0%, 100% { box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.3), 0 2px 8px rgba(0,0,0,0.3); }
        50% { box-shadow: 0 0 0 8px rgba(59, 130, 246, 0.1), 0 2px 8px rgba(0,0,0,0.3); }
      }
    </style>
  `,iconSize:[20,20],iconAnchor:[10,10]}),jce=e=>e==null?"":e<1?`${Math.round(e*1e3)} m`:`${e.toFixed(1)} km`;function Nce({cooperativas:e,selectedId:t,onSelect:r,userLocation:a,className:n}){const i=E.useRef(null),o=E.useRef(null),c=E.useRef(new Map);E.useEffect(()=>{if(!i.current||o.current)return;const x=a?[a.latitude,a.longitude]:[-15.7801,-47.9292],v=Yc.map(i.current,{center:x,zoom:a?12:4,zoomControl:!1});return Yc.control.zoom({position:"bottomright"}).addTo(v),Yc.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap",maxZoom:18}).addTo(v),o.current=v,()=>{v.remove(),o.current=null}},[]),E.useEffect(()=>{const x=o.current;if(!x||!a)return;const v=Yc.marker([a.latitude,a.longitude],{icon:_ce,zIndexOffset:1e3}).addTo(x);return v.bindPopup("<strong>Voc est aqui</strong>"),()=>{v.remove()}},[a]),E.useEffect(()=>{const x=o.current;if(!x)return;c.current.forEach(b=>b.remove()),c.current.clear();const v=e.filter(b=>b.latitude&&b.longitude);if(v.forEach(b=>{const N=b.id===t,_=Yc.marker([b.latitude,b.longitude],{icon:bce(N),zIndexOffset:N?500:0}).addTo(x),C=`
        <div style="min-width: 150px;">
          <strong style="color: #1a1a1a;">${b.nome_fantasia}</strong>
          <br/>
          <span style="color: #666; font-size: 12px;">
            ${b.cidade||""}${b.cidade&&b.uf?", ":""}${b.uf||""}
          </span>
          ${b.distance!==null&&b.distance!==void 0?`<br/><span style="color: #95C11F; font-weight: 600; font-size: 13px;">${jce(b.distance)}</span>`:""}
        </div>
      `;_.bindPopup(C),_.on("click",()=>{r(b.id)}),c.current.set(b.id,_)}),v.length>0){const b=Yc.latLngBounds(v.map(N=>[N.latitude,N.longitude]));a&&b.extend([a.latitude,a.longitude]),x.fitBounds(b,{padding:[50,50],maxZoom:13})}},[e,t,r]),E.useEffect(()=>{const x=o.current;if(!x||!t)return;const v=c.current.get(t);v&&(x.setView(v.getLatLng(),14,{animate:!0}),v.openPopup())},[t]);const d=e.some(x=>x.latitude&&x.longitude),h=e.length,p=e.filter(x=>x.latitude&&x.longitude).length;return s.jsxs(Ee.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1},className:pt("relative rounded-2xl overflow-hidden border shadow-sm z-0",n),style:{isolation:"isolate"},children:[s.jsx("div",{ref:i,className:"w-full h-full min-h-[250px]",style:{zIndex:0}}),!d&&s.jsxs("div",{className:"absolute inset-0 bg-muted/95 backdrop-blur-sm flex flex-col items-center justify-center p-6",children:[s.jsx(Co,{className:"h-12 w-12 text-muted-foreground mb-3"}),s.jsx("p",{className:"font-medium text-foreground mb-1",children:"Localizao no disponvel"}),s.jsx("p",{className:"text-sm text-muted-foreground text-center max-w-xs",children:h===0?"Nenhuma cooperativa cadastrada ainda":`${h} ${h===1?"cooperativa encontrada":"cooperativas encontradas"}, mas sem dados de localizao`}),h>0&&s.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Use o seletor abaixo para escolher a cooperativa"})]}),d&&s.jsxs("div",{className:"absolute bottom-12 left-3 bg-background/90 backdrop-blur-sm rounded-lg px-3 py-2 shadow-md text-xs space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-3 h-3 rounded-full bg-primary border-2 border-white shadow"}),s.jsx("span",{children:"Selecionada"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-3 h-3 rounded-full bg-accent border-2 border-white shadow"}),s.jsx("span",{children:"Disponvel"})]}),a&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-3 h-3 rounded-full bg-blue-500 border-2 border-white shadow"}),s.jsx("span",{children:"Voc"})]}),s.jsx("div",{className:"pt-1 mt-1 border-t border-border/50",children:s.jsxs("span",{className:"text-muted-foreground",children:[p," ",p===1?"ponto":"pontos"," no mapa"]})})]}),a&&s.jsx("button",{onClick:()=>{var x;(x=o.current)==null||x.setView([a.latitude,a.longitude],14,{animate:!0})},className:"absolute top-3 right-3 bg-background/90 backdrop-blur-sm p-2 rounded-lg shadow-md hover:bg-background transition-colors",title:"Centralizar em voc",children:s.jsx(k6,{className:"h-4 w-4 text-blue-500"})})]})}function Cce(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}const IO=He.createContext({drawerRef:{current:null},overlayRef:{current:null},onPress:()=>{},onRelease:()=>{},onDrag:()=>{},onNestedDrag:()=>{},onNestedOpenChange:()=>{},onNestedRelease:()=>{},openProp:void 0,dismissible:!1,isOpen:!1,isDragging:!1,keyboardIsOpen:{current:!1},snapPointsOffset:null,snapPoints:null,handleOnly:!1,modal:!1,shouldFade:!1,activeSnapPoint:null,onOpenChange:()=>{},setActiveSnapPoint:()=>{},closeDrawer:()=>{},direction:"bottom",shouldScaleBackground:!1,setBackgroundColorOnScale:!0,noBodyStyles:!1,container:null,autoFocus:!1}),Yf=()=>{const e=He.useContext(IO);if(!e)throw new Error("useDrawerContext must be used within a Drawer.Root");return e};Cce(`[data-vaul-drawer]{touch-action:none;will-change:transform;transition:transform .5s cubic-bezier(.32, .72, 0, 1);animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=open]{animation-name:slideFromBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=closed]{animation-name:slideToBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=open]{animation-name:slideFromTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=closed]{animation-name:slideToTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=open]{animation-name:slideFromLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=closed]{animation-name:slideToLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=open]{animation-name:slideFromRight}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=closed]{animation-name:slideToRight}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,100%,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,-100%,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(-100%,0,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(100%,0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-overlay][data-vaul-snap-points=false]{animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-overlay][data-vaul-snap-points=false][data-state=open]{animation-name:fadeIn}[data-vaul-overlay][data-state=closed]{animation-name:fadeOut}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:0;transition:opacity .5s cubic-bezier(.32, .72, 0, 1)}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:1}[data-vaul-drawer]:not([data-vaul-custom-container=true])::after{content:'';position:absolute;background:inherit;background-color:inherit}[data-vaul-drawer][data-vaul-drawer-direction=top]::after{top:initial;bottom:100%;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=bottom]::after{top:100%;bottom:initial;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=left]::after{left:initial;right:100%;top:0;bottom:0;width:200%}[data-vaul-drawer][data-vaul-drawer-direction=right]::after{left:100%;right:initial;top:0;bottom:0;width:200%}[data-vaul-overlay][data-vaul-snap-points=true]:not([data-vaul-snap-points-overlay=true]):not(
[data-state=closed]
){opacity:0}[data-vaul-overlay][data-vaul-snap-points-overlay=true]{opacity:1}[data-vaul-handle]{display:block;position:relative;opacity:.7;background:#e2e2e4;margin-left:auto;margin-right:auto;height:5px;width:32px;border-radius:1rem;touch-action:pan-y}[data-vaul-handle]:active,[data-vaul-handle]:hover{opacity:1}[data-vaul-handle-hitarea]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:max(100%,2.75rem);height:max(100%,2.75rem);touch-action:inherit}@media (hover:hover) and (pointer:fine){[data-vaul-drawer]{user-select:none}}@media (pointer:fine){[data-vaul-handle-hitarea]:{width:100%;height:100%}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{to{opacity:0}}@keyframes slideFromBottom{from{transform:translate3d(0,100%,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToBottom{to{transform:translate3d(0,100%,0)}}@keyframes slideFromTop{from{transform:translate3d(0,-100%,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToTop{to{transform:translate3d(0,-100%,0)}}@keyframes slideFromLeft{from{transform:translate3d(-100%,0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToLeft{to{transform:translate3d(-100%,0,0)}}@keyframes slideFromRight{from{transform:translate3d(100%,0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToRight{to{transform:translate3d(100%,0,0)}}`);const Ece=24,Sce=typeof window<"u"?E.useLayoutEffect:E.useEffect;function pS(...e){return(...t)=>{for(let r of e)typeof r=="function"&&r(...t)}}function Tce(){return f2(/^Mac/)}function Ace(){return f2(/^iPhone/)}function xS(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function kce(){return f2(/^iPad/)||Tce()&&navigator.maxTouchPoints>1}function OO(){return Ace()||kce()}function f2(e){return typeof window<"u"&&window.navigator!=null?e.test(window.navigator.platform):void 0}const Ev=typeof document<"u"&&window.visualViewport;function gS(e){let t=window.getComputedStyle(e);return/(auto|scroll)/.test(t.overflow+t.overflowX+t.overflowY)}function DO(e){for(gS(e)&&(e=e.parentElement);e&&!gS(e);)e=e.parentElement;return e||document.scrollingElement||document.documentElement}const Rce=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let sx=0,Sv;function Pce(e={}){let{isDisabled:t}=e;Sce(()=>{if(!t)return sx++,sx===1&&OO()&&(Sv=Ice()),()=>{sx--,sx===0&&(Sv==null||Sv())}},[t])}function Ice(){let e,t=0,r=x=>{e=DO(x.target),!(e===document.documentElement&&e===document.body)&&(t=x.changedTouches[0].pageY)},a=x=>{if(!e||e===document.documentElement||e===document.body){x.preventDefault();return}let v=x.changedTouches[0].pageY,b=e.scrollTop,N=e.scrollHeight-e.clientHeight;N!==0&&((b<=0&&v>t||b>=N&&v<t)&&x.preventDefault(),t=v)},n=x=>{let v=x.target;pw(v)&&v!==document.activeElement&&(x.preventDefault(),v.style.transform="translateY(-2000px)",v.focus(),requestAnimationFrame(()=>{v.style.transform=""}))},i=x=>{let v=x.target;pw(v)&&(v.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{v.style.transform="",Ev&&(Ev.height<window.innerHeight?requestAnimationFrame(()=>{vS(v)}):Ev.addEventListener("resize",()=>vS(v),{once:!0}))}))},o=()=>{window.scrollTo(0,0)},c=window.pageXOffset,d=window.pageYOffset,h=pS(Oce(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`));window.scrollTo(0,0);let p=pS(_m(document,"touchstart",r,{passive:!1,capture:!0}),_m(document,"touchmove",a,{passive:!1,capture:!0}),_m(document,"touchend",n,{passive:!1,capture:!0}),_m(document,"focus",i,!0),_m(window,"scroll",o));return()=>{h(),p(),window.scrollTo(c,d)}}function Oce(e,t,r){let a=e.style[t];return e.style[t]=r,()=>{e.style[t]=a}}function _m(e,t,r,a){return e.addEventListener(t,r,a),()=>{e.removeEventListener(t,r,a)}}function vS(e){let t=document.scrollingElement||document.documentElement;for(;e&&e!==t;){let r=DO(e);if(r!==document.documentElement&&r!==document.body&&r!==e){let a=r.getBoundingClientRect().top,n=e.getBoundingClientRect().top,i=e.getBoundingClientRect().bottom;const o=r.getBoundingClientRect().bottom+Ece;i>o&&(r.scrollTop+=n-a)}e=r.parentElement}}function pw(e){return e instanceof HTMLInputElement&&!Rce.has(e.type)||e instanceof HTMLTextAreaElement||e instanceof HTMLElement&&e.isContentEditable}function Dce(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function Mce(...e){return t=>e.forEach(r=>Dce(r,t))}function MO(...e){return E.useCallback(Mce(...e),e)}const LO=new WeakMap;function on(e,t,r=!1){if(!e||!(e instanceof HTMLElement))return;let a={};Object.entries(t).forEach(([n,i])=>{if(n.startsWith("--")){e.style.setProperty(n,i);return}a[n]=e.style[n],e.style[n]=i}),!r&&LO.set(e,a)}function Lce(e,t){if(!e||!(e instanceof HTMLElement))return;let r=LO.get(e);r&&(e.style[t]=r[t])}const cn=e=>{switch(e){case"top":case"bottom":return!0;case"left":case"right":return!1;default:return e}};function rx(e,t){if(!e)return null;const r=window.getComputedStyle(e),a=r.transform||r.webkitTransform||r.mozTransform;let n=a.match(/^matrix3d\((.+)\)$/);return n?parseFloat(n[1].split(", ")[cn(t)?13:12]):(n=a.match(/^matrix\((.+)\)$/),n?parseFloat(n[1].split(", ")[cn(t)?5:4]):null)}function Fce(e){return 8*(Math.log(e+1)-2)}function Tv(e,t){if(!e)return()=>{};const r=e.style.cssText;return Object.assign(e.style,t),()=>{e.style.cssText=r}}function Bce(...e){return(...t)=>{for(const r of e)typeof r=="function"&&r(...t)}}const Ca={DURATION:.5,EASE:[.32,.72,0,1]},FO=.4,Vce=.25,Uce=100,BO=8,Jd=16,xw=26,Av="vaul-dragging";function VO(e){const t=He.useRef(e);return He.useEffect(()=>{t.current=e}),He.useMemo(()=>(...r)=>t.current==null?void 0:t.current.call(t,...r),[])}function zce({defaultProp:e,onChange:t}){const r=He.useState(e),[a]=r,n=He.useRef(a),i=VO(t);return He.useEffect(()=>{n.current!==a&&(i(a),n.current=a)},[a,n,i]),r}function UO({prop:e,defaultProp:t,onChange:r=()=>{}}){const[a,n]=zce({defaultProp:t,onChange:r}),i=e!==void 0,o=i?e:a,c=VO(r),d=He.useCallback(h=>{if(i){const x=typeof h=="function"?h(e):h;x!==e&&c(x)}else n(h)},[i,e,n,c]);return[o,d]}function $ce({activeSnapPointProp:e,setActiveSnapPointProp:t,snapPoints:r,drawerRef:a,overlayRef:n,fadeFromIndex:i,onSnapPointChange:o,direction:c="bottom",container:d,snapToSequentialPoint:h}){const[p,x]=UO({prop:e,defaultProp:r==null?void 0:r[0],onChange:t}),[v,b]=He.useState(typeof window<"u"?{innerWidth:window.innerWidth,innerHeight:window.innerHeight}:void 0);He.useEffect(()=>{function D(){b({innerWidth:window.innerWidth,innerHeight:window.innerHeight})}return window.addEventListener("resize",D),()=>window.removeEventListener("resize",D)},[]);const N=He.useMemo(()=>p===(r==null?void 0:r[r.length-1])||null,[r,p]),_=He.useMemo(()=>r==null?void 0:r.findIndex(D=>D===p),[r,p]),C=r&&r.length>0&&(i||i===0)&&!Number.isNaN(i)&&r[i]===p||!r,T=He.useMemo(()=>{const D=d?{width:d.getBoundingClientRect().width,height:d.getBoundingClientRect().height}:typeof window<"u"?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0};var F;return(F=r==null?void 0:r.map(M=>{const z=typeof M=="string";let q=0;if(z&&(q=parseInt(M,10)),cn(c)){const ae=z?q:v?M*D.height:0;return v?c==="bottom"?D.height-ae:-D.height+ae:ae}const Y=z?q:v?M*D.width:0;return v?c==="right"?D.width-Y:-D.width+Y:Y}))!=null?F:[]},[r,v,d]),A=He.useMemo(()=>_!==null?T==null?void 0:T[_]:null,[T,_]),k=He.useCallback(D=>{var F;const M=(F=T==null?void 0:T.findIndex(z=>z===D))!=null?F:null;o(M),on(a.current,{transition:`transform ${Ca.DURATION}s cubic-bezier(${Ca.EASE.join(",")})`,transform:cn(c)?`translate3d(0, ${D}px, 0)`:`translate3d(${D}px, 0, 0)`}),T&&M!==T.length-1&&M!==i&&M<i?on(n.current,{transition:`opacity ${Ca.DURATION}s cubic-bezier(${Ca.EASE.join(",")})`,opacity:"0"}):on(n.current,{transition:`opacity ${Ca.DURATION}s cubic-bezier(${Ca.EASE.join(",")})`,opacity:"1"}),x(r==null?void 0:r[Math.max(M,0)])},[a.current,r,T,i,n,x]);He.useEffect(()=>{if(p||e){var D;const F=(D=r==null?void 0:r.findIndex(M=>M===e||M===p))!=null?D:-1;T&&F!==-1&&typeof T[F]=="number"&&k(T[F])}},[p,e,r,T,k]);function I({draggedDistance:D,closeDrawer:F,velocity:M,dismissible:z}){if(i===void 0)return;const q=c==="bottom"||c==="right"?(A??0)-D:(A??0)+D,Y=_===i-1,ae=_===0,je=D>0;if(Y&&on(n.current,{transition:`opacity ${Ca.DURATION}s cubic-bezier(${Ca.EASE.join(",")})`}),!h&&M>2&&!je){z?F():k(T[0]);return}if(!h&&M>2&&je&&T&&r){k(T[r.length-1]);return}const H=T==null?void 0:T.reduce((G,Q)=>typeof G!="number"||typeof Q!="number"?G:Math.abs(Q-q)<Math.abs(G-q)?Q:G),Z=cn(c)?window.innerHeight:window.innerWidth;if(M>FO&&Math.abs(D)<Z*.4){const G=je?1:-1;if(G>0&&N){k(T[r.length-1]);return}if(ae&&G<0&&z&&F(),_===null)return;k(T[_+G]);return}k(H)}function B({draggedDistance:D}){if(A===null)return;const F=c==="bottom"||c==="right"?A-D:A+D;(c==="bottom"||c==="right")&&F<T[T.length-1]||(c==="top"||c==="left")&&F>T[T.length-1]||on(a.current,{transform:cn(c)?`translate3d(0, ${F}px, 0)`:`translate3d(${F}px, 0, 0)`})}function O(D,F){if(!r||typeof _!="number"||!T||i===void 0)return null;const M=_===i-1;if(_>=i&&F)return 0;if(M&&!F)return 1;if(!C&&!M)return null;const q=M?_+1:_-1,Y=M?T[q]-T[q-1]:T[q+1]-T[q],ae=D/Math.abs(Y);return M?1-ae:ae}return{isLastSnapPoint:N,activeSnapPoint:p,shouldFade:C,getPercentageDragged:O,setActiveSnapPoint:x,activeSnapPointIndex:_,onRelease:I,onDrag:B,snapPointsOffset:T}}const qce=()=>()=>{};function Wce(){const{direction:e,isOpen:t,shouldScaleBackground:r,setBackgroundColorOnScale:a,noBodyStyles:n}=Yf(),i=He.useRef(null),o=E.useMemo(()=>document.body.style.backgroundColor,[]);function c(){return(window.innerWidth-xw)/window.innerWidth}He.useEffect(()=>{if(t&&r){i.current&&clearTimeout(i.current);const d=document.querySelector("[data-vaul-drawer-wrapper]")||document.querySelector("[vaul-drawer-wrapper]");if(!d)return;Bce(a&&!n?Tv(document.body,{background:"black"}):qce,Tv(d,{transformOrigin:cn(e)?"top":"left",transitionProperty:"transform, border-radius",transitionDuration:`${Ca.DURATION}s`,transitionTimingFunction:`cubic-bezier(${Ca.EASE.join(",")})`}));const h=Tv(d,{borderRadius:`${BO}px`,overflow:"hidden",...cn(e)?{transform:`scale(${c()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`}:{transform:`scale(${c()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`}});return()=>{h(),i.current=window.setTimeout(()=>{o?document.body.style.background=o:document.body.style.removeProperty("background")},Ca.DURATION*1e3)}}},[t,r,o])}let jm=null;function Hce({isOpen:e,modal:t,nested:r,hasBeenOpened:a,preventScrollRestoration:n,noBodyStyles:i}){const[o,c]=He.useState(()=>typeof window<"u"?window.location.href:""),d=He.useRef(0),h=He.useCallback(()=>{if(xS()&&jm===null&&e&&!i){jm={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,height:document.body.style.height,right:"unset"};const{scrollX:x,innerHeight:v}=window;document.body.style.setProperty("position","fixed","important"),Object.assign(document.body.style,{top:`${-d.current}px`,left:`${-x}px`,right:"0px",height:"auto"}),window.setTimeout(()=>window.requestAnimationFrame(()=>{const b=v-window.innerHeight;b&&d.current>=v&&(document.body.style.top=`${-(d.current+b)}px`)}),300)}},[e]),p=He.useCallback(()=>{if(xS()&&jm!==null&&!i){const x=-parseInt(document.body.style.top,10),v=-parseInt(document.body.style.left,10);Object.assign(document.body.style,jm),window.requestAnimationFrame(()=>{if(n&&o!==window.location.href){c(window.location.href);return}window.scrollTo(v,x)}),jm=null}},[o]);return He.useEffect(()=>{function x(){d.current=window.scrollY}return x(),window.addEventListener("scroll",x),()=>{window.removeEventListener("scroll",x)}},[]),He.useEffect(()=>{r||!a||(e?(!window.matchMedia("(display-mode: standalone)").matches&&h(),t||window.setTimeout(()=>{p()},500)):p())},[e,a,o,t,r,h,p]),{restorePositionSetting:p}}function zO({open:e,onOpenChange:t,children:r,onDrag:a,onRelease:n,snapPoints:i,shouldScaleBackground:o=!1,setBackgroundColorOnScale:c=!0,closeThreshold:d=Vce,scrollLockTimeout:h=Uce,dismissible:p=!0,handleOnly:x=!1,fadeFromIndex:v=i&&i.length-1,activeSnapPoint:b,setActiveSnapPoint:N,fixed:_,modal:C=!0,onClose:T,nested:A,noBodyStyles:k,direction:I="bottom",defaultOpen:B=!1,disablePreventScroll:O=!0,snapToSequentialPoint:D=!1,preventScrollRestoration:F=!1,repositionInputs:M=!0,onAnimationEnd:z,container:q,autoFocus:Y=!1}){var ae,je;const[H=!1,Z]=UO({defaultProp:B,prop:e,onChange:bt=>{t==null||t(bt),!bt&&!A&&dt(),setTimeout(()=>{z==null||z(bt)},Ca.DURATION*1e3),bt&&!C&&typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),bt||(document.body.style.pointerEvents="auto")}}),[G,Q]=He.useState(!1),[re,le]=He.useState(!1),[ye,W]=He.useState(!1),ee=He.useRef(null),ie=He.useRef(null),ce=He.useRef(null),xe=He.useRef(null),Ce=He.useRef(null),me=He.useRef(!1),fe=He.useRef(null),ve=He.useRef(0),ne=He.useRef(!1),Me=He.useRef(0),Ie=He.useRef(null),Be=He.useRef(((ae=Ie.current)==null?void 0:ae.getBoundingClientRect().height)||0),ot=He.useRef(((je=Ie.current)==null?void 0:je.getBoundingClientRect().width)||0),Se=He.useRef(0),ze=He.useCallback(bt=>{i&&bt===Lt.length-1&&(ie.current=new Date)},[]),{activeSnapPoint:we,activeSnapPointIndex:Le,setActiveSnapPoint:Nt,onRelease:Ge,snapPointsOffset:Lt,onDrag:ps,shouldFade:ns,getPercentageDragged:Ke}=$ce({snapPoints:i,activeSnapPointProp:b,setActiveSnapPointProp:N,drawerRef:Ie,fadeFromIndex:v,overlayRef:ee,onSnapPointChange:ze,direction:I,container:q,snapToSequentialPoint:D});Pce({isDisabled:!H||re||!C||ye||!G||!M||!O});const{restorePositionSetting:dt}=Hce({isOpen:H,modal:C,nested:A,hasBeenOpened:G,preventScrollRestoration:F,noBodyStyles:k});function It(){return(window.innerWidth-xw)/window.innerWidth}function Ut(bt){var Dt,Jt;!p&&!i||Ie.current&&!Ie.current.contains(bt.target)||(Be.current=((Dt=Ie.current)==null?void 0:Dt.getBoundingClientRect().height)||0,ot.current=((Jt=Ie.current)==null?void 0:Jt.getBoundingClientRect().width)||0,le(!0),ce.current=new Date,OO()&&window.addEventListener("touchend",()=>me.current=!1,{once:!0}),bt.target.setPointerCapture(bt.pointerId),ve.current=cn(I)?bt.pageY:bt.pageX)}function ts(bt,Dt){var Jt,Oe;let Xe=bt;const zt=(Jt=window.getSelection())==null?void 0:Jt.toString(),qt=Ie.current?rx(Ie.current,I):null,St=new Date;if(Xe.hasAttribute("data-vaul-no-drag")||Xe.closest("[data-vaul-no-drag]"))return!1;if(I==="right"||I==="left")return!0;if(ie.current&&St.getTime()-ie.current.getTime()<500)return!1;if(qt!==null&&(I==="bottom"?qt>0:qt<0))return!0;if(zt&&zt.length>0)return!1;if(St.getTime()-((Oe=Ce.current)==null?void 0:Oe.getTime())<h&&qt===0||Dt)return Ce.current=St,!1;for(;Xe;){if(Xe.scrollHeight>Xe.clientHeight){if(Xe.scrollTop!==0)return Ce.current=new Date,!1;if(Xe.getAttribute("role")==="dialog")return!0}Xe=Xe.parentNode}return!0}function us(bt){if(Ie.current&&re){const Dt=I==="bottom"||I==="right"?1:-1,Jt=(ve.current-(cn(I)?bt.pageY:bt.pageX))*Dt,Oe=Jt>0,Xe=i&&!p&&!Oe;if(Xe&&Le===0)return;const zt=Math.abs(Jt),qt=document.querySelector("[data-vaul-drawer-wrapper]"),St=I==="bottom"||I==="top"?Be.current:ot.current;let ls=zt/St;const is=Ke(zt,Oe);if(is!==null&&(ls=is),Xe&&ls>=1||!me.current&&!ts(bt.target,Oe))return;if(Ie.current.classList.add(Av),me.current=!0,on(Ie.current,{transition:"none"}),on(ee.current,{transition:"none"}),i&&ps({draggedDistance:Jt}),Oe&&!i){const Bs=Fce(Jt),js=Math.min(Bs*-1,0)*Dt;on(Ie.current,{transform:cn(I)?`translate3d(0, ${js}px, 0)`:`translate3d(${js}px, 0, 0)`});return}const ws=1-ls;if((ns||v&&Le===v-1)&&(a==null||a(bt,ls),on(ee.current,{opacity:`${ws}`,transition:"none"},!0)),qt&&ee.current&&o){const Bs=Math.min(It()+ls*(1-It()),1),js=8-ls*8,ha=Math.max(0,14-ls*14);on(qt,{borderRadius:`${js}px`,transform:cn(I)?`scale(${Bs}) translate3d(0, ${ha}px, 0)`:`scale(${Bs}) translate3d(${ha}px, 0, 0)`,transition:"none"},!0)}if(!i){const Bs=zt*Dt;on(Ie.current,{transform:cn(I)?`translate3d(0, ${Bs}px, 0)`:`translate3d(${Bs}px, 0, 0)`})}}}He.useEffect(()=>{var bt;function Dt(){if(!Ie.current||!M)return;const Jt=document.activeElement;if(pw(Jt)||ne.current){var Oe;const Xe=((Oe=window.visualViewport)==null?void 0:Oe.height)||0,zt=window.innerHeight;let qt=zt-Xe;const St=Ie.current.getBoundingClientRect().height||0,ls=St>zt*.8;Se.current||(Se.current=St);const is=Ie.current.getBoundingClientRect().top;if(Math.abs(Me.current-qt)>60&&(ne.current=!ne.current),i&&i.length>0&&Lt&&Le){const ws=Lt[Le]||0;qt+=ws}if(Me.current=qt,St>Xe||ne.current){const ws=Ie.current.getBoundingClientRect().height;let Bs=ws;ws>Xe&&(Bs=Xe-(ls?is:xw)),_?Ie.current.style.height=`${ws-Math.max(qt,0)}px`:Ie.current.style.height=`${Math.max(Bs,Xe-is)}px`}else Ie.current.style.height=`${Se.current}px`;i&&i.length>0&&!ne.current?Ie.current.style.bottom="0px":Ie.current.style.bottom=`${Math.max(qt,0)}px`}}return(bt=window.visualViewport)==null||bt.addEventListener("resize",Dt),()=>{var Jt;return(Jt=window.visualViewport)==null?void 0:Jt.removeEventListener("resize",Dt)}},[Le,i,Lt]);function qe(bt){_t(),T==null||T(),bt||Z(!1),setTimeout(()=>{i&&Nt(i[0])},Ca.DURATION*1e3)}function jt(){if(!Ie.current)return;const bt=document.querySelector("[data-vaul-drawer-wrapper]"),Dt=rx(Ie.current,I);on(Ie.current,{transform:"translate3d(0, 0, 0)",transition:`transform ${Ca.DURATION}s cubic-bezier(${Ca.EASE.join(",")})`}),on(ee.current,{transition:`opacity ${Ca.DURATION}s cubic-bezier(${Ca.EASE.join(",")})`,opacity:"1"}),o&&Dt&&Dt>0&&H&&on(bt,{borderRadius:`${BO}px`,overflow:"hidden",...cn(I)?{transform:`scale(${It()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${It()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${Ca.DURATION}s`,transitionTimingFunction:`cubic-bezier(${Ca.EASE.join(",")})`},!0)}function _t(){!re||!Ie.current||(Ie.current.classList.remove(Av),me.current=!1,le(!1),xe.current=new Date)}function Re(bt){if(!re||!Ie.current)return;Ie.current.classList.remove(Av),me.current=!1,le(!1),xe.current=new Date;const Dt=rx(Ie.current,I);if(!ts(bt.target,!1)||!Dt||Number.isNaN(Dt)||ce.current===null)return;const Jt=xe.current.getTime()-ce.current.getTime(),Oe=ve.current-(cn(I)?bt.pageY:bt.pageX),Xe=Math.abs(Oe)/Jt;if(Xe>.05&&(W(!0),setTimeout(()=>{W(!1)},200)),i){Ge({draggedDistance:Oe*(I==="bottom"||I==="right"?1:-1),closeDrawer:qe,velocity:Xe,dismissible:p}),n==null||n(bt,!0);return}if(I==="bottom"||I==="right"?Oe>0:Oe<0){jt(),n==null||n(bt,!0);return}if(Xe>FO){qe(),n==null||n(bt,!1);return}var zt;const qt=Math.min((zt=Ie.current.getBoundingClientRect().height)!=null?zt:0,window.innerHeight);var St;const ls=Math.min((St=Ie.current.getBoundingClientRect().width)!=null?St:0,window.innerWidth),is=I==="left"||I==="right";if(Math.abs(Dt)>=(is?ls:qt)*d){qe(),n==null||n(bt,!1);return}n==null||n(bt,!0),jt()}He.useEffect(()=>(H&&(on(document.documentElement,{scrollBehavior:"auto"}),ie.current=new Date),()=>{Lce(document.documentElement,"scrollBehavior")}),[H]);function et(bt){const Dt=bt?(window.innerWidth-Jd)/window.innerWidth:1,Jt=bt?-Jd:0;fe.current&&window.clearTimeout(fe.current),on(Ie.current,{transition:`transform ${Ca.DURATION}s cubic-bezier(${Ca.EASE.join(",")})`,transform:`scale(${Dt}) translate3d(0, ${Jt}px, 0)`}),!bt&&Ie.current&&(fe.current=setTimeout(()=>{const Oe=rx(Ie.current,I);on(Ie.current,{transition:"none",transform:cn(I)?`translate3d(0, ${Oe}px, 0)`:`translate3d(${Oe}px, 0, 0)`})},500))}function Ct(bt,Dt){if(Dt<0)return;const Jt=(window.innerWidth-Jd)/window.innerWidth,Oe=Jt+Dt*(1-Jt),Xe=-Jd+Dt*Jd;on(Ie.current,{transform:cn(I)?`scale(${Oe}) translate3d(0, ${Xe}px, 0)`:`scale(${Oe}) translate3d(${Xe}px, 0, 0)`,transition:"none"})}function Yt(bt,Dt){const Jt=cn(I)?window.innerHeight:window.innerWidth,Oe=Dt?(Jt-Jd)/Jt:1,Xe=Dt?-Jd:0;Dt&&on(Ie.current,{transition:`transform ${Ca.DURATION}s cubic-bezier(${Ca.EASE.join(",")})`,transform:cn(I)?`scale(${Oe}) translate3d(0, ${Xe}px, 0)`:`scale(${Oe}) translate3d(${Xe}px, 0, 0)`})}return He.createElement(Wp,{defaultOpen:B,onOpenChange:bt=>{!p&&!bt||(bt?Q(!0):qe(!0),Z(bt))},open:H},He.createElement(IO.Provider,{value:{activeSnapPoint:we,snapPoints:i,setActiveSnapPoint:Nt,drawerRef:Ie,overlayRef:ee,onOpenChange:t,onPress:Ut,onRelease:Re,onDrag:us,dismissible:p,handleOnly:x,isOpen:H,isDragging:re,shouldFade:ns,closeDrawer:qe,onNestedDrag:Ct,onNestedOpenChange:et,onNestedRelease:Yt,keyboardIsOpen:ne,modal:C,snapPointsOffset:Lt,direction:I,shouldScaleBackground:o,setBackgroundColorOnScale:c,noBodyStyles:k,container:q,autoFocus:Y}},r))}const $O=He.forwardRef(function({...e},t){const{overlayRef:r,snapPoints:a,onRelease:n,shouldFade:i,isOpen:o,modal:c}=Yf(),d=MO(t,r),h=a&&a.length>0;return c?He.createElement(zu,{onMouseUp:n,ref:d,"data-vaul-overlay":"","data-vaul-snap-points":o&&h?"true":"false","data-vaul-snap-points-overlay":o&&i?"true":"false",...e}):(typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),null)});$O.displayName="Drawer.Overlay";const qO=He.forwardRef(function({onPointerDownOutside:e,style:t,onOpenAutoFocus:r,...a},n){const{drawerRef:i,onPress:o,onRelease:c,onDrag:d,keyboardIsOpen:h,snapPointsOffset:p,modal:x,isOpen:v,direction:b,snapPoints:N,container:_,handleOnly:C,autoFocus:T}=Yf(),[A,k]=He.useState(!1),I=MO(n,i),B=He.useRef(null),O=He.useRef(null),D=He.useRef(!1),F=N&&N.length>0;Wce();const M=(q,Y,ae=0)=>{if(D.current)return!0;const je=Math.abs(q.y),H=Math.abs(q.x),Z=H>je,G=["bottom","right"].includes(Y)?1:-1;if(Y==="left"||Y==="right"){if(!(q.x*G<0)&&H>=0&&H<=ae)return Z}else if(!(q.y*G<0)&&je>=0&&je<=ae)return!Z;return D.current=!0,!0};He.useEffect(()=>{F&&window.requestAnimationFrame(()=>{k(!0)})},[]);function z(q){B.current=null,D.current=!1,c(q)}return He.createElement($u,{"data-vaul-drawer-direction":b,"data-vaul-drawer":"","data-vaul-delayed-snap-points":A?"true":"false","data-vaul-snap-points":v&&F?"true":"false","data-vaul-custom-container":_?"true":"false",...a,ref:I,style:p&&p.length>0?{"--snap-point-height":`${p[0]}px`,...t}:t,onPointerDown:q=>{C||(a.onPointerDown==null||a.onPointerDown.call(a,q),B.current={x:q.pageX,y:q.pageY},o(q))},onOpenAutoFocus:q=>{r==null||r(q),T||q.preventDefault()},onPointerDownOutside:q=>{if(e==null||e(q),!x||q.defaultPrevented){q.preventDefault();return}h.current&&(h.current=!1)},onFocusOutside:q=>{if(!x){q.preventDefault();return}},onPointerMove:q=>{if(O.current=q,C||(a.onPointerMove==null||a.onPointerMove.call(a,q),!B.current))return;const Y=q.pageY-B.current.y,ae=q.pageX-B.current.x,je=q.pointerType==="touch"?10:2;M({x:ae,y:Y},b,je)?d(q):(Math.abs(ae)>je||Math.abs(Y)>je)&&(B.current=null)},onPointerUp:q=>{a.onPointerUp==null||a.onPointerUp.call(a,q),B.current=null,D.current=!1,c(q)},onPointerOut:q=>{a.onPointerOut==null||a.onPointerOut.call(a,q),z(O.current)},onContextMenu:q=>{a.onContextMenu==null||a.onContextMenu.call(a,q),z(O.current)}})});qO.displayName="Drawer.Content";const Gce=250,Kce=120,WO=He.forwardRef(function({preventCycle:e=!1,children:t,...r},a){const{closeDrawer:n,isDragging:i,snapPoints:o,activeSnapPoint:c,setActiveSnapPoint:d,dismissible:h,handleOnly:p,isOpen:x,onPress:v,onDrag:b}=Yf(),N=He.useRef(null),_=He.useRef(!1);function C(){if(_.current){k();return}window.setTimeout(()=>{T()},Kce)}function T(){if(i||e||_.current){k();return}if(k(),(!o||o.length===0)&&h){n();return}if(c===o[o.length-1]&&h){n();return}const B=o.findIndex(D=>D===c);if(B===-1)return;const O=o[B+1];d(O)}function A(){N.current=window.setTimeout(()=>{_.current=!0},Gce)}function k(){window.clearTimeout(N.current),_.current=!1}return He.createElement("div",{onClick:C,onPointerCancel:k,onPointerDown:I=>{p&&v(I),A()},onPointerMove:I=>{p&&b(I)},ref:a,"data-vaul-drawer-visible":x?"true":"false","data-vaul-handle":"","aria-hidden":"true",...r},He.createElement("span",{"data-vaul-handle-hitarea":"","aria-hidden":"true"},t))});WO.displayName="Drawer.Handle";function Xce({onDrag:e,onOpenChange:t,...r}){const{onNestedDrag:a,onNestedOpenChange:n,onNestedRelease:i}=Yf();if(!a)throw new Error("Drawer.NestedRoot must be placed in another drawer");return He.createElement(zO,{nested:!0,onClose:()=>{n(!1)},onDrag:(o,c)=>{a(o,c),e==null||e(o,c)},onOpenChange:o=>{o&&n(o)},onRelease:i,...r})}function Yce(e){const t=Yf(),{container:r=t.container,...a}=e;return He.createElement(qp,{container:r,...a})}const Sc={Root:zO,NestedRoot:Xce,Content:qO,Overlay:$O,Trigger:bg,Portal:Yce,Handle:WO,Close:$p,Title:kf,Description:Rf},HO=({shouldScaleBackground:e=!0,...t})=>s.jsx(Sc.Root,{shouldScaleBackground:e,...t});HO.displayName="Drawer";const Zce=Sc.Portal,GO=E.forwardRef(({className:e,...t},r)=>s.jsx(Sc.Overlay,{ref:r,className:pt("fixed inset-0 z-50 bg-black/80",e),...t}));GO.displayName=Sc.Overlay.displayName;const KO=E.forwardRef(({className:e,children:t,...r},a)=>s.jsxs(Zce,{children:[s.jsx(GO,{}),s.jsxs(Sc.Content,{ref:a,className:pt("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",e),...r,children:[s.jsx("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"}),t]})]}));KO.displayName="DrawerContent";const XO=({className:e,...t})=>s.jsx("div",{className:pt("grid gap-1.5 p-4 text-center sm:text-left",e),...t});XO.displayName="DrawerHeader";const YO=E.forwardRef(({className:e,...t},r)=>s.jsx(Sc.Title,{ref:r,className:pt("text-lg font-semibold leading-none tracking-tight",e),...t}));YO.displayName=Sc.Title.displayName;const ZO=E.forwardRef(({className:e,...t},r)=>s.jsx(Sc.Description,{ref:r,className:pt("text-sm text-muted-foreground",e),...t}));ZO.displayName=Sc.Description.displayName;function QO(e,t,r,a){const i=ax(r-e),o=ax(a-t),c=Math.sin(i/2)*Math.sin(i/2)+Math.cos(ax(e))*Math.cos(ax(r))*Math.sin(o/2)*Math.sin(o/2);return 6371*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}function ax(e){return e*(Math.PI/180)}function Qce(e){return e<1?`${Math.round(e*1e3)} m`:e<10?`${e.toFixed(1)} km`:`${Math.round(e)} km`}function Jce(e){return[...e].sort((t,r)=>t.distance!==null&&t.distance!==void 0&&(r.distance===null||r.distance===void 0)?-1:(t.distance===null||t.distance===void 0)&&r.distance!==null&&r.distance!==void 0?1:t.distance!==null&&t.distance!==void 0&&r.distance!==null&&r.distance!==void 0?t.distance-r.distance:0)}function JO(){var o,c;const{profile:e}=sr(),[t,r]=E.useState({coordinates:null,loading:!0,error:null,permissionDenied:!1,source:null}),a=E.useCallback(()=>e!=null&&e.latitude&&(e!=null&&e.longitude)?{latitude:Number(e.latitude),longitude:Number(e.longitude)}:null,[e]),n=E.useCallback(()=>{if(r(d=>({...d,loading:!0,error:null})),!navigator.geolocation){const d=a();r({coordinates:d,loading:!1,error:d?null:"Geolocalizao no suportada",permissionDenied:!1,source:d?"profile":null});return}navigator.geolocation.getCurrentPosition(d=>{r({coordinates:{latitude:d.coords.latitude,longitude:d.coords.longitude},loading:!1,error:null,permissionDenied:!1,source:"browser"})},d=>{const h=a();r({coordinates:h,loading:!1,error:h?null:ede(d),permissionDenied:d.code===d.PERMISSION_DENIED,source:h?"profile":null})},{enableHighAccuracy:!1,timeout:1e4,maximumAge:3e5})},[a]),i=E.useCallback(()=>{const d=a();r({coordinates:d,loading:!1,error:d?null:"Coordenadas do perfil no disponveis",permissionDenied:!1,source:d?"profile":null})},[a]);return E.useEffect(()=>{const d=a();r(d?{coordinates:d,loading:!1,error:null,permissionDenied:!1,source:"profile"}:h=>({...h,loading:!1}))},[a]),{...t,requestBrowserLocation:n,useProfileLocation:i,refresh:n,latitude:(o=t.coordinates)==null?void 0:o.latitude,longitude:(c=t.coordinates)==null?void 0:c.longitude}}function ede(e){switch(e.code){case e.PERMISSION_DENIED:return"Permisso de localizao negada";case e.POSITION_UNAVAILABLE:return"Localizao indisponvel";case e.TIMEOUT:return"Tempo esgotado ao obter localizao";default:return"Erro ao obter localizao"}}function tde({cooperativas:e,selected:t,onSelect:r,className:a}){const[n,i]=E.useState(""),[o,c]=E.useState(null),{coordinates:d,loading:h,permissionDenied:p,source:x,requestBrowserLocation:v}=JO(),b=E.useCallback(async(C,T,A,k)=>{C.stopPropagation();const I=d?`https://www.google.com/maps/dir/?api=1&origin=${d.latitude},${d.longitude}&destination=${A},${k}`:`https://www.google.com/maps/dir/?api=1&destination=${A},${k}`;try{if(window.open(I,"_blank","noopener,noreferrer"))return}catch{}try{await navigator.clipboard.writeText(I),c(T),ct.success("Link copiado!"),setTimeout(()=>c(null),3e3)}catch{ct.info("Copie o link:",{description:I,duration:1e4})}},[d]),N=E.useMemo(()=>{const C=e.map(T=>{let A=null;return d&&T.latitude&&T.longitude&&(A=QO(d.latitude,d.longitude,Number(T.latitude),Number(T.longitude))),{...T,distance:A}});return Jce(C)},[e,d]),_=E.useMemo(()=>{if(!n.trim())return N;const C=n.toLowerCase();return N.filter(T=>{var B,O,D;const A=((B=T.nome_fantasia)==null?void 0:B.toLowerCase())||"",k=((O=T.cidade)==null?void 0:O.toLowerCase())||"",I=((D=T.bairro)==null?void 0:D.toLowerCase())||"";return A.includes(C)||k.includes(C)||I.includes(C)})},[N,n]);return s.jsxs("div",{className:pt("space-y-3",a),children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm",children:[s.jsx("div",{className:"flex items-center gap-2 text-muted-foreground",children:h?s.jsxs(s.Fragment,{children:[s.jsx(_s,{className:"h-3.5 w-3.5 animate-spin"}),s.jsx("span",{children:"Localizando..."})]}):d?s.jsxs(s.Fragment,{children:[s.jsx(Co,{className:"h-3.5 w-3.5 text-success"}),s.jsx("span",{children:"Ordenado por proximidade"})]}):s.jsxs(s.Fragment,{children:[s.jsx(Co,{className:"h-3.5 w-3.5"}),s.jsx("span",{children:p?"GPS negado":"GPS desativado"})]})}),!d&&!h&&s.jsxs(oe,{variant:"ghost",size:"sm",onClick:v,className:"h-7 px-2 text-xs",children:[s.jsx(R6,{className:"h-3.5 w-3.5 mr-1"}),"Ativar"]})]}),s.jsxs("div",{className:"relative",children:[s.jsx(eo,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),s.jsx(We,{placeholder:"Buscar por nome, cidade ou bairro...",value:n,onChange:C=>i(C.target.value),className:"pl-9 pr-8 h-10"}),n&&s.jsx("button",{onClick:()=>i(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:s.jsx(Jr,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"space-y-1 max-h-[280px] overflow-y-auto -mx-1 px-1",children:[s.jsx(Qi,{mode:"popLayout",children:_.map((C,T)=>{const A=t===C.id;return s.jsx(Ee.div,{layout:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},children:s.jsxs("div",{role:"button",tabIndex:0,onClick:()=>r(C.id),onKeyDown:k=>{(k.key==="Enter"||k.key===" ")&&(k.preventDefault(),r(C.id))},className:pt("flex items-center justify-between gap-3 p-3 rounded-xl cursor-pointer transition-colors",A?"bg-primary/10":"hover:bg-muted/50"),children:[s.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[s.jsx("div",{className:pt("w-4 h-4 rounded-full border-2 shrink-0 flex items-center justify-center transition-colors",A?"border-primary bg-primary":"border-muted-foreground/30"),children:A&&s.jsx(Ee.div,{initial:{scale:0},animate:{scale:1},className:"w-1.5 h-1.5 rounded-full bg-primary-foreground"})}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("p",{className:pt("text-sm font-medium truncate",A?"text-primary":"text-foreground"),children:C.nome_fantasia}),s.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:[C.bairro&&`${C.bairro}, `,C.cidade," - ",C.uf]})]})]}),s.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[C.distance!==null&&s.jsx("span",{className:"text-xs text-muted-foreground font-mono",children:Qce(C.distance)}),C.latitude&&C.longitude&&s.jsx("button",{type:"button",onClick:k=>b(k,C.id,Number(C.latitude),Number(C.longitude)),className:pt("p-1.5 rounded-md transition-colors","text-muted-foreground hover:text-primary hover:bg-primary/10",o===C.id&&"text-success"),children:o===C.id?s.jsx(Ea,{className:"h-4 w-4"}):s.jsx(Nx,{className:"h-4 w-4"})})]})]})},C.id)})}),_.length===0&&s.jsx("div",{className:"text-center py-8",children:s.jsx("p",{className:"text-sm text-muted-foreground",children:n?"Nenhum resultado encontrado":"Nenhuma cooperativa disponvel"})})]})]})}function sde({cooperativas:e,selected:t,onSelect:r}){const[a,n]=E.useState(!1),i=e.find(d=>d.id===t),o=d=>{r(d),setTimeout(()=>n(!1),200)},c=d=>{var h;d&&((h=document.activeElement)==null||h.blur()),n(d)};return s.jsxs(s.Fragment,{children:[s.jsxs(oe,{variant:"outline",onClick:()=>c(!0),className:pt("w-full justify-between h-auto py-3 px-4","border-2 transition-all duration-200",t?"border-primary bg-primary/5 hover:bg-primary/10":"border-dashed hover:border-primary/50"),children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:pt("p-2 rounded-lg",t?"bg-primary/20":"bg-muted"),children:t?s.jsx(Ea,{className:"h-4 w-4 text-primary"}):s.jsx(hn,{className:"h-4 w-4 text-muted-foreground"})}),s.jsx("div",{className:"text-left",children:i?s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"font-medium text-foreground",children:i.nome_fantasia}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[i.bairro&&`${i.bairro} - `,i.cidade,", ",i.uf]})]}):s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"font-medium text-muted-foreground",children:"Escolher cooperativa"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Toque para selecionar o ponto de entrega"})]})})]}),s.jsx(If,{className:pt("h-5 w-5 text-muted-foreground transition-transform",a&&"rotate-180")})]}),s.jsx(HO,{open:a,onOpenChange:c,children:s.jsxs(KO,{className:"max-h-[85vh]",children:[s.jsxs(XO,{className:"text-left border-b pb-4",children:[s.jsxs(YO,{className:"flex items-center gap-2",children:[s.jsx(Co,{className:"h-5 w-5 text-primary"}),"Escolher Ponto de Entrega"]}),s.jsx(ZO,{children:"Selecione a cooperativa mais prxima para entregar seus materiais"})]}),s.jsx("div",{className:"p-4 overflow-y-auto max-h-[calc(85vh-100px)]",children:s.jsx(tde,{cooperativas:e,selected:t,onSelect:o})})]})})]})}const rde=()=>{const e=ds(),{user:t}=sr(),{coordinates:r}=JO(),[a,n]=E.useState([]),[i,o]=E.useState(new Set),[c,d]=E.useState([]),[h,p]=E.useState(""),[x,v]=E.useState(!0),[b,N]=E.useState(!1),[_,C]=E.useState(!1),[T,A]=E.useState(""),[k,I]=E.useState(""),[B,O]=E.useState(!1),[D,F]=E.useState(""),[M,z]=E.useState(""),[q,Y]=E.useState(!1),[ae,je]=E.useState(!1),H=E.useMemo(()=>r?c.map(fe=>({...fe,distance:fe.latitude&&fe.longitude?QO(r.latitude,r.longitude,fe.latitude,fe.longitude):null})).sort((fe,ve)=>fe.distance===null&&ve.distance===null?0:fe.distance===null?1:ve.distance===null?-1:fe.distance-ve.distance):c,[c,r]);E.useMemo(()=>H.find(fe=>fe.id===h),[H,h]),E.useEffect(()=>{if(t){Z();const fe=J.channel("cooperativas-changes").on("postgres_changes",{event:"*",schema:"public",table:"cooperativas"},ve=>{setTimeout(()=>{Q()},1e3)}).subscribe();return()=>{fe.unsubscribe()}}},[t]);const Z=async()=>{try{await J.functions.invoke("validar-expiracoes-entregas")}catch{}G(),Q()},G=async()=>{try{const{data:fe,error:ve}=await J.from("materiais_reciclaveis_usuario").select("*").eq("id_usuario",t==null?void 0:t.id).eq("status","disponivel").order("data_cadastro",{ascending:!1});if(ve)throw ve;n(fe||[])}catch(fe){ct.error("Erro ao carregar materiais",{description:fe.message})}finally{v(!1)}},Q=async()=>{try{const{data:fe,error:ve}=await J.from("cooperativas").select("id, nome_fantasia, cidade, uf, logradouro, bairro, latitude, longitude").eq("status","aprovada").order("nome_fantasia");if(ve)throw ve;d(fe||[])}catch(fe){console.error(" Erro ao carregar cooperativas:",fe),ct.error("Erro ao carregar cooperativas",{description:fe.message})}},re=async()=>{N(!0);try{await Q(),ct.success("Mapa atualizado!",{description:"Localizaes das cooperativas foram recarregadas"})}catch{ct.error("Erro ao atualizar mapa")}finally{N(!1)}},le=fe=>{const ve=new Set(i);ve.has(fe)?ve.delete(fe):ve.add(fe),o(ve)},ye=async fe=>{try{const{data:ve,error:ne}=await J.from("materiais_reciclaveis_usuario").delete().eq("id",fe).eq("id_usuario",t==null?void 0:t.id).select();if(ne)throw ne;if(!ve||ve.length===0){const{error:Me}=await J.from("materiais_reciclaveis_usuario").delete().eq("id",fe);if(Me)throw Me}n(Me=>Me.filter(Ie=>Ie.id!==fe)),o(Me=>{const Ie=new Set(Me);return Ie.delete(fe),Ie}),ct.success("Material excludo")}catch(ve){console.error("Erro ao excluir material:",ve),ct.error("Erro ao excluir",{description:ve.message}),G()}},W=fe=>{const ve=fe.quantidade??1,ne=fe.peso_unitario_gramas??0;return fe.peso_total_estimado_gramas??ve*ne},ee=()=>a.filter(ve=>i.has(ve.id)).reduce((ve,ne)=>ve+W(ne),0)/1e3,ie=async()=>{if(i.size===0){ct.error("Selecione pelo menos um material");return}if(!h){ct.error("Selecione uma cooperativa");return}C(!0);try{const fe=crypto.randomUUID(),ve=crypto.randomUUID(),ne=`${t==null?void 0:t.id}-${Date.now()}-${Math.random().toString(36).substring(7)}`,Me=Array.from(i),Ie=ee(),{data:Be,error:ot}=await J.from("entregas_reciclaveis").insert({id:ve,id_usuario:t==null?void 0:t.id,id_cooperativa:h,qrcode_id:fe,hash_qrcode:ne,tipo_material:"misto",status:"gerada",status_promessa:"ativa",itens_vinculados:Me,peso_estimado:Ie,data_geracao:new Date().toISOString()}).select().single();if(ot)throw ot;const{error:Se}=await J.from("materiais_reciclaveis_usuario").update({status:"em_entrega",id_entrega:Be.id}).in("id",Me);if(Se)throw Se;console.log("[QRCode] Gerando QR Code com UUID simples:",fe);const ze=await kd({data:fe,width:400,margin:2});A(ze),I(Be.id),ct.success("QR Code gerado com sucesso!",{description:`${i.size} materiais prontos para entrega`})}catch(fe){ct.error("Erro ao gerar QR Code",{description:fe.message})}finally{C(!1)}},ce=()=>{const fe=document.createElement("a");fe.download=`qrcode-entrega-${k}.png`,fe.href=T,fe.click()},xe=()=>{A(""),I(""),o(new Set),p(""),G()},Ce=async()=>{if(!D.trim()){ct.error("Informe uma descrio para o material");return}Y(!0);try{const{data:fe,error:ve}=await J.from("materiais_reciclaveis_usuario").insert({id_usuario:t==null?void 0:t.id,descricao:D.trim(),origem_cadastro:"manual",tipo_embalagem:"misto",percentual_reciclabilidade:100,quantidade:1,peso_unitario_gramas:M?parseFloat(M.replace(",","."))*1e3:null,peso_total_estimado_gramas:M?parseFloat(M.replace(",","."))*1e3:null,status:"disponivel",pontos_ganhos:0}).select().single();if(ve)throw ve;ct.success("Entrada diversa adicionada!",{description:"O peso ser definido pelo operador na coleta"}),n(ne=>[fe,...ne]),o(ne=>new Set([...ne,fe.id])),F(""),z(""),O(!1)}catch(fe){ct.error("Erro ao adicionar entrada",{description:fe.message})}finally{Y(!1)}},me=i.size>0&&h;return T?s.jsx("div",{className:"container mx-auto p-4 sm:p-6 max-w-lg",children:s.jsx(Ee.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3},children:s.jsxs(Ne,{className:"overflow-hidden",children:[s.jsxs("div",{className:"bg-gradient-to-br from-primary/20 to-success/20 p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"p-2 bg-primary/20 rounded-xl",children:s.jsx(Ur,{className:"h-6 w-6 text-primary"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"font-display text-xl font-semibold",children:"Promessa Criada!"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Apresente o QR Code na cooperativa"})]})]}),s.jsx("div",{className:"bg-white p-4 rounded-2xl shadow-sm",children:s.jsx("img",{src:T,alt:"QR Code",className:"w-full max-w-[280px] mx-auto"})})]}),s.jsxs(De,{className:"p-6 space-y-4",children:[s.jsxs("div",{className:"bg-muted/50 p-3 rounded-lg",children:[s.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"ID da Promessa"}),s.jsx("p",{className:"font-mono text-sm truncate",children:k})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"bg-primary/10 p-3 rounded-lg text-center",children:[s.jsx("p",{className:"text-2xl font-bold text-primary",children:i.size}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"materiais"})]}),s.jsxs("div",{className:"bg-success/10 p-3 rounded-lg text-center",children:[s.jsx("p",{className:"text-2xl font-bold text-success",children:Br(ee(),2)}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"kg estimados"})]})]}),s.jsxs("div",{className:"bg-warning/10 p-3 rounded-lg flex items-center gap-2",children:[s.jsx("span",{className:"text-lg",children:""}),s.jsxs("p",{className:"text-sm text-warning-foreground",children:["Este QR Code expira em ",s.jsx("strong",{children:"24 horas"})]})]}),s.jsxs("div",{className:"space-y-2 pt-2",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsx(oe,{onClick:ce,variant:"outline",children:"Baixar QR"}),s.jsx(oe,{onClick:xe,variant:"secondary",children:"Nova Entrega"})]}),s.jsxs(oe,{onClick:()=>e("/user"),variant:"ghost",className:"w-full",children:[s.jsx(As,{className:"mr-2 h-4 w-4"}),"Ver Minhas Entregas"]})]})]})]})})}):s.jsxs("div",{className:"min-h-screen bg-background pb-40",children:[s.jsx(Ee.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"sticky top-0 z-20 bg-background/95 backdrop-blur-sm border-b",children:s.jsx("div",{className:"container mx-auto px-4 py-3 max-w-2xl",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(oe,{onClick:()=>e("/user"),variant:"ghost",size:"icon",className:"shrink-0",children:s.jsx(As,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"font-display font-semibold text-lg",children:"Entregar Materiais"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Selecione e escolha o ponto de entrega"})]})]}),s.jsxs(oe,{onClick:()=>O(!0),variant:"outline",size:"sm",className:"border-accent text-accent hover:bg-accent/10",children:[s.jsx(ra,{className:"h-4 w-4 mr-1"}),"Adicionar"]})]})})}),s.jsx("div",{className:"container mx-auto px-4 py-4 max-w-2xl space-y-4",children:x?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"text-center",children:[s.jsx(fs,{className:"h-10 w-10 mx-auto text-muted-foreground animate-pulse mb-3"}),s.jsx("p",{className:"text-muted-foreground",children:"Carregando materiais..."})]})}):a.length===0?s.jsxs(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-12",children:[s.jsx("div",{className:"p-4 bg-muted/50 rounded-full w-20 h-20 mx-auto mb-4 flex items-center justify-center",children:s.jsx(fs,{className:"h-10 w-10 text-muted-foreground"})}),s.jsx("h3",{className:"font-medium mb-2",children:"Nenhum material disponvel"}),s.jsx("p",{className:"text-sm text-muted-foreground mb-6 max-w-xs mx-auto",children:"Cadastre notas fiscais ou adicione entradas diversas para comear"}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center",children:[s.jsx(oe,{onClick:()=>e("/upload-receipt"),variant:"outline",children:"Cadastrar Nota Fiscal"}),s.jsxs(oe,{onClick:()=>O(!0),variant:"accent",children:[s.jsx(ra,{className:"mr-2 h-4 w-4"}),"Entradas Diversas"]})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs(Ee.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.05},children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(fs,{className:"h-4 w-4 text-primary"}),s.jsx("h2",{className:"font-medium text-sm",children:"Seus Materiais"}),i.size>0&&s.jsxs(Je,{variant:"secondary",className:"text-xs",children:[i.size," selecionado",i.size>1?"s":""]})]}),s.jsx(yce,{materials:a.map(fe=>({id:fe.id,descricao:fe.descricao,tipo_embalagem:fe.tipo_embalagem,peso_gramas:W(fe),origem_cadastro:fe.origem_cadastro})),selectedIds:i,onToggle:le,onDelete:ye,onSelectAll:()=>o(new Set(a.map(fe=>fe.id))),onClearAll:()=>o(new Set)})]}),s.jsxs(Ee.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Co,{className:"h-4 w-4 text-primary"}),s.jsx("h2",{className:"font-medium text-sm",children:"Localizao"})]}),s.jsxs(oe,{variant:"ghost",size:"sm",onClick:re,disabled:b,className:"h-7 text-xs",children:[s.jsx(Kn,{className:pt("h-3 w-3 mr-1",b&&"animate-spin")}),"Atualizar"]})]}),s.jsx(Nce,{cooperativas:H,selectedId:h,onSelect:p,userLocation:r,className:"h-[200px]"})]}),s.jsxs(Ee.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.15},children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Co,{className:"h-4 w-4 text-primary"}),s.jsx("h2",{className:"font-medium text-sm",children:"Ponto de Entrega"}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",H.length," disponveis)"]})]}),s.jsx(sde,{cooperativas:H,selected:h,onSelect:p})]})]})}),a.length>0&&s.jsx(Ee.div,{initial:{y:100},animate:{y:0},className:"fixed bottom-0 left-0 right-0 bg-background/95 backdrop-blur-sm border-t shadow-lg z-30",children:s.jsxs("div",{className:"container mx-auto px-4 py-4 max-w-2xl",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:pt("p-1.5 rounded-lg",i.size>0?"bg-primary/20":"bg-muted"),children:s.jsx(fs,{className:pt("h-4 w-4",i.size>0?"text-primary":"text-muted-foreground")})}),s.jsxs("span",{className:"text-sm font-medium",children:[i.size," ",i.size===1?"material":"materiais"]}),i.size>0&&s.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",Br(ee(),2)," kg"]})]}),!h&&i.size>0&&s.jsx("span",{className:"text-xs text-muted-foreground",children:"Toque no mapa para selecionar"})]}),s.jsx(oe,{onClick:ie,disabled:_||!me,className:"w-full h-12 text-base font-medium",size:"lg",children:_?"Gerando...":i.size?h?s.jsxs(s.Fragment,{children:[s.jsx(Da,{className:"h-5 w-5 mr-2"}),"Gerar QR Code de Entrega"]}):"Selecione um ponto no mapa":"Selecione materiais acima"})]})}),s.jsx(ar,{open:B,onOpenChange:O,children:s.jsxs(tr,{children:[s.jsxs(nr,{children:[s.jsxs(ir,{className:"flex items-center gap-2",children:[s.jsx(Zi,{className:"h-5 w-5 text-accent"}),"Entradas Diversas"]}),s.jsx(Vr,{children:"Adicione materiais reciclveis que no vieram de nota fiscal."})]}),s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"descricao",children:"Tipo de Material *"}),s.jsxs(qs,{value:D,onValueChange:F,children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Selecione o tipo de material"})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"Misto (diversos tipos)",children:"Misto (diversos tipos)"}),s.jsx(xt,{value:"Plstico",children:"Plstico"}),s.jsx(xt,{value:"Papel / Papelo",children:"Papel / Papelo"}),s.jsx(xt,{value:"Vidro",children:"Vidro"}),s.jsx(xt,{value:"Metal / Alumnio",children:"Metal / Alumnio"}),s.jsx(xt,{value:"Eletrnicos",children:"Eletrnicos"}),s.jsx(xt,{value:"leo de cozinha",children:"leo de cozinha"}),s.jsx(xt,{value:"Outros",children:"Outros"})]})]})]}),D==="Misto (diversos tipos)"&&s.jsxs(oe,{onClick:()=>{O(!1),je(!0)},variant:"outline",className:"w-full border-success text-success hover:bg-success/10",children:[s.jsx(Sl,{className:"mr-2 h-4 w-4"}),"Aderir a Rotas de Coleta"]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(ke,{htmlFor:"peso",children:["Peso aproximado (kg) ",s.jsx("span",{className:"text-muted-foreground text-xs",children:"(opcional)"})]}),s.jsx(We,{id:"peso",type:"text",inputMode:"decimal",placeholder:"Ex: 2,5",value:M,onChange:fe=>{const ve=fe.target.value.replace(/[^0-9,]/g,"");ve.split(",").length<=2&&z(ve)}})]}),s.jsx("div",{className:"bg-muted/50 p-3 rounded-lg",children:s.jsx("p",{className:"text-sm text-muted-foreground",children:" O peso exato ser definido pelo operador no momento da coleta."})})]}),s.jsxs(Ya,{children:[s.jsx(oe,{variant:"outline",onClick:()=>O(!1),children:"Cancelar"}),s.jsx(oe,{onClick:Ce,disabled:q||!D.trim(),variant:"accent",children:q?"Adicionando...":"Adicionar Material"})]})]})}),s.jsx(vce,{open:ae,onOpenChange:je})]})},yS={Plstico:["PET","PP","PEAD","PEBD","PVC","PS","OUTROS_PLASTICOS"],Papel:["PAPEL_BRANCO","PAPEL_MISTO","PAPELAO","PAPELAO_ONDULADO","JORNAL","REVISTA"],Vidro:["VIDRO_INCOLOR","VIDRO_VERDE","VIDRO_AMBAR"],Metal:["ALUMINIO","ACO","COBRE","OUTROS_METAIS"],Laminado:["TETRAPACK"],Rejeito:["REJEITO"]},ade={PET:"PET (Garrafas)",PP:"PP (Potes)",PEAD:"PEAD (Embalagens rgidas)",PEBD:"PEBD (Sacolas)",PVC:"PVC",PS:"PS (Isopor)",OUTROS_PLASTICOS:"Outros Plsticos",PAPEL_BRANCO:"Papel Branco",PAPEL_MISTO:"Papel Misto",PAPELAO:"Papelo",PAPELAO_ONDULADO:"Papelo Ondulado",JORNAL:"Jornal",REVISTA:"Revista",VIDRO_INCOLOR:"Vidro Incolor",VIDRO_VERDE:"Vidro Verde",VIDRO_AMBAR:"Vidro mbar",ALUMINIO:"Alumnio",ACO:"Ao",COBRE:"Cobre",OUTROS_METAIS:"Outros Metais",TETRAPACK:"Tetra Pak (Caixa de Leite)",REJEITO:"Rejeito (No Reciclvel)"},nde=()=>{var q,Y;const e=ds(),[t,r]=E.useState([]),[a,n]=E.useState([]),[i,o]=E.useState({total_entregas:0,entregas_ativas:0,entregas_finalizadas:0,entregas_expiradas:0,peso_total_coletado:0,peso_rejeito_total:0}),[c,d]=E.useState({}),[h,p]=E.useState("todos"),[x,v]=E.useState(!0),[b,N]=E.useState("entregas"),[_,C]=E.useState(null),[T,A]=E.useState(!1),[k,I]=E.useState(!1);E.useEffect(()=>{B()},[]);const B=async()=>{try{v(!0);const{data:ae,error:je}=await J.from("entregas_reciclaveis").select(`
          *,
          cooperativas(nome_fantasia)
        `).order("data_geracao",{ascending:!1});if(je)throw je;const{data:H,error:Z}=await J.from("materiais_coletados_detalhado").select(`
          *,
          entregas_reciclaveis(
            id,
            id_usuario
          ),
          cooperativas(nome_fantasia)
        `).order("registrado_em",{ascending:!1}).limit(100);if(Z)throw Z;const G=ae||[],Q=H||[];r(G),n(Q);const re=new Set;if(G.forEach(ye=>{ye.id_usuario&&re.add(ye.id_usuario)}),Q.forEach(ye=>{var ee;const W=(ee=ye.entregas_reciclaveis)==null?void 0:ee.id_usuario;W&&re.add(W)}),re.size>0){const{data:ye,error:W}=await J.from("profiles").select("id, nome").in("id",Array.from(re));if(W)throw W;const ee={};ye==null||ye.forEach(ie=>{ie.id&&(ee[ie.id]=ie.nome)}),d(ee)}const le={total_entregas:G.length,entregas_ativas:G.filter(ye=>ye.status_promessa==="ativa").length,entregas_finalizadas:G.filter(ye=>ye.status_promessa==="finalizada").length,entregas_expiradas:G.filter(ye=>ye.status_promessa==="expirada").length,peso_total_coletado:G.reduce((ye,W)=>ye+(W.peso_validado||0),0),peso_rejeito_total:G.reduce((ye,W)=>ye+(W.peso_rejeito_kg||0),0)};o(le)}catch(ae){ct.error("Erro ao carregar dados",{description:ae.message})}finally{v(!1)}},O=ae=>{const je={ativa:{variant:"default",icon:Gn,label:"Ativa"},em_coleta:{variant:"secondary",icon:fs,label:"Em Coleta"},finalizada:{variant:"default",icon:Tr,label:"Finalizada"},expirada:{variant:"destructive",icon:Va,label:"Expirada"},cancelada:{variant:"outline",icon:Va,label:"Cancelada"}},H=je[ae]||je.ativa,Z=H.icon;return s.jsxs(Je,{variant:H.variant,className:"flex items-center gap-1 w-fit",children:[s.jsx(Z,{className:"h-3 w-3"}),H.label]})},D=ae=>{C({...ae}),A(!0)},F=()=>{A(!1),C(null)},M=async()=>{if(_){I(!0);try{const{error:ae}=await J.from("materiais_coletados_detalhado").update({tipo_material:_.tipo_material,subtipo_material:_.subtipo_material,peso_kg:_.peso_kg}).eq("id",_.id);if(ae)throw ae;ct.success("Material atualizado com sucesso!"),F(),B()}catch(ae){ct.error("Erro ao atualizar material",{description:ae.message})}finally{I(!1)}}},z=t.filter(ae=>h==="todos"||ae.status_promessa===h);return x?s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(Rd,{}),s.jsx("div",{className:"container mx-auto p-6",children:s.jsx("p",{className:"text-center text-muted-foreground",children:"Carregando..."})})]}):s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(Rd,{}),s.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>e("/admin"),className:"gap-2",children:[s.jsx(As,{className:"h-4 w-4"}),"Voltar"]}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Promessas de Entrega"}),s.jsx("p",{className:"text-muted-foreground",children:"Rastreamento completo de entregas via QR Code"})]})]}),s.jsx(oe,{onClick:B,children:"Atualizar"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[s.jsx(Ne,{children:s.jsx(De,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total de Entregas"}),s.jsx("p",{className:"text-2xl font-bold",children:i.total_entregas})]}),s.jsx(fs,{className:"h-8 w-8 text-primary"})]})})}),s.jsx(Ne,{children:s.jsx(De,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Entregas Ativas"}),s.jsx("p",{className:"text-2xl font-bold",children:i.entregas_ativas})]}),s.jsx(Gn,{className:"h-8 w-8 text-primary"})]})})}),s.jsx(Ne,{children:s.jsx(De,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Finalizadas"}),s.jsx("p",{className:"text-2xl font-bold",children:i.entregas_finalizadas})]}),s.jsx(Tr,{className:"h-8 w-8 text-primary"})]})})}),s.jsx(Ne,{children:s.jsx(De,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Peso Total Coletado"}),s.jsxs("p",{className:"text-2xl font-bold",children:[i.peso_total_coletado.toFixed(2)," kg"]})]}),s.jsx(Ur,{className:"h-8 w-8 text-primary"})]})})}),s.jsx(Ne,{children:s.jsx(De,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Rejeito Total"}),s.jsxs("p",{className:"text-2xl font-bold",children:[i.peso_rejeito_total.toFixed(2)," kg"]})]}),s.jsx(Va,{className:"h-8 w-8 text-destructive"})]})})}),s.jsx(Ne,{children:s.jsx(De,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Expiradas"}),s.jsx("p",{className:"text-2xl font-bold",children:i.entregas_expiradas})]}),s.jsx(Va,{className:"h-8 w-8 text-muted-foreground"})]})})})]}),s.jsxs(Mn,{value:b,onValueChange:N,className:"space-y-4",children:[s.jsxs(Nn,{children:[s.jsx(Gs,{value:"entregas",children:"Entregas"}),s.jsx(Gs,{value:"materiais",children:"Materiais Coletados"})]}),s.jsx(hr,{value:"entregas",className:"space-y-4",children:s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(Qe,{children:"Histrico de Entregas"}),s.jsx(Tt,{children:"Lista completa de todas as promessas de entrega"})]}),s.jsxs(qs,{value:h,onValueChange:p,children:[s.jsx(Ls,{className:"w-[180px]",children:s.jsx(Ws,{placeholder:"Filtrar por status"})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"todos",children:"Todos"}),s.jsx(xt,{value:"ativa",children:"Ativas"}),s.jsx(xt,{value:"em_coleta",children:"Em Coleta"}),s.jsx(xt,{value:"finalizada",children:"Finalizadas"}),s.jsx(xt,{value:"expirada",children:"Expiradas"})]})]})]})}),s.jsx(De,{children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{children:"ID"}),s.jsx(rt,{children:"Usurio"}),s.jsx(rt,{children:"Cooperativa"}),s.jsx(rt,{children:"Status"}),s.jsx(rt,{children:"Peso Est."}),s.jsx(rt,{children:"Peso Valid."}),s.jsx(rt,{children:"Rejeito"}),s.jsx(rt,{children:"Data Gerao"})]})}),s.jsx(da,{children:z.map(ae=>{var je,H;return s.jsxs(Cs,{children:[s.jsx(Ze,{className:"font-mono text-xs",children:ae.id.substring(0,8)}),s.jsx(Ze,{children:c[ae.id_usuario]||"Usurio"}),s.jsx(Ze,{children:(je=ae.cooperativas)==null?void 0:je.nome_fantasia}),s.jsx(Ze,{children:O(ae.status_promessa)}),s.jsxs(Ze,{children:[(H=ae.peso_estimado)==null?void 0:H.toFixed(2)," kg"]}),s.jsx(Ze,{children:ae.peso_validado?`${ae.peso_validado.toFixed(2)} kg`:"-"}),s.jsx(Ze,{children:ae.peso_rejeito_kg>0?`${ae.peso_rejeito_kg.toFixed(2)} kg`:"-"}),s.jsx(Ze,{children:new Date(ae.data_geracao).toLocaleString("pt-BR")})]},ae.id)})})]})})})]})}),s.jsx(hr,{value:"materiais",className:"space-y-4",children:s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Materiais Coletados Detalhados"}),s.jsx(Tt,{children:"Registro detalhado de todos os materiais e submateriais coletados"})]}),s.jsx(De,{children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{children:"Data"}),s.jsx(rt,{children:"Usurio"}),s.jsx(rt,{children:"Cooperativa"}),s.jsx(rt,{children:"Material"}),s.jsx(rt,{children:"Submaterial"}),s.jsx(rt,{children:"Peso (kg)"}),s.jsx(rt,{className:"text-right",children:"Aes"})]})}),s.jsx(da,{children:a.map(ae=>{var je,H;return s.jsxs(Cs,{children:[s.jsx(Ze,{children:new Date(ae.registrado_em).toLocaleString("pt-BR")}),s.jsx(Ze,{children:c[((je=ae.entregas_reciclaveis)==null?void 0:je.id_usuario)||""]||"Usurio"}),s.jsx(Ze,{children:(H=ae.cooperativas)==null?void 0:H.nome_fantasia}),s.jsx(Ze,{children:s.jsx(Je,{variant:"outline",children:ae.tipo_material})}),s.jsx(Ze,{children:s.jsx(Je,{variant:ae.subtipo_material==="REJEITO"?"destructive":"secondary",children:ae.subtipo_material})}),s.jsxs(Ze,{className:"font-bold",children:[ae.peso_kg.toFixed(2)," kg"]}),s.jsx(Ze,{className:"text-right",children:s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>D(ae),className:"gap-2",children:[s.jsx(Fw,{className:"h-4 w-4"}),"Editar"]})})]},ae.id)})})]})})})]})})]})]}),s.jsx(ar,{open:T,onOpenChange:A,children:s.jsxs(tr,{className:"sm:max-w-[500px]",children:[s.jsxs(nr,{children:[s.jsx(ir,{children:"Editar Material Coletado"}),s.jsx(Vr,{children:"Altere os campos do material coletado"})]}),_&&s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"tipo_material",children:"Tipo de Material"}),s.jsxs(qs,{value:_.tipo_material,onValueChange:ae=>{C({..._,tipo_material:ae,subtipo_material:""})},children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Selecione o tipo"})}),s.jsx(Fs,{children:Object.keys(yS).map(ae=>s.jsx(xt,{value:ae,children:ae},ae))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"subtipo_material",children:"Subtipo de Material"}),s.jsxs(qs,{value:_.subtipo_material,onValueChange:ae=>{C({..._,subtipo_material:ae})},disabled:!_.tipo_material,children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:_.tipo_material?"Selecione o subtipo":"Primeiro selecione o tipo"})}),s.jsx(Fs,{children:_.tipo_material&&((q=yS[_.tipo_material])==null?void 0:q.map(ae=>s.jsx(xt,{value:ae,children:ade[ae]||ae},ae)))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"peso_kg",children:"Peso (kg)"}),s.jsx(We,{id:"peso_kg",type:"number",step:"0.01",min:"0",value:_.peso_kg,onChange:ae=>C({..._,peso_kg:parseFloat(ae.target.value)||0}),placeholder:"0.00"})]}),s.jsxs("div",{className:"bg-muted p-3 rounded-lg space-y-1",children:[s.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.jsx("strong",{children:"Data:"})," ",new Date(_.registrado_em).toLocaleString("pt-BR")]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.jsx("strong",{children:"Cooperativa:"})," ",(Y=_.cooperativas)==null?void 0:Y.nome_fantasia]})]})]}),s.jsxs(Ya,{children:[s.jsx(oe,{variant:"outline",onClick:F,disabled:k,children:"Cancelar"}),s.jsx(oe,{onClick:M,disabled:k,children:k?"Salvando...":"Salvar Alteraes"})]})]})})]})},ide=()=>{ds();const{user:e}=sr(),[t,r]=E.useState([]),[a,n]=E.useState(!0),[i,o]=E.useState(0),[c,d]=E.useState(0),[h,p]=E.useState(0),[x,v]=E.useState(void 0),[b,N]=E.useState(!1);E.useEffect(()=>{e&&_()},[e]);const _=async()=>{var M;if(e)try{n(!0);const z=[],{data:q}=await J.from("configuracoes_sistema").select("chave, valor").like("chave","pontos_%"),Y={};q==null||q.forEach(me=>{Y[me.chave]=parseInt(me.valor)});const{data:ae}=await J.from("missoes_usuarios").select("data_conclusao, missoes (titulo, pontos)").eq("id_usuario",e.id).order("data_conclusao",{ascending:!1});ae==null||ae.forEach(me=>{if(me.data_conclusao){const fe=me.missoes;z.push({date:me.data_conclusao,type:"missao",points:Y.pontos_missao_completa??0,description:"Misso Concluda",details:(fe==null?void 0:fe.titulo)||"Misso"})}});const{data:je}=await J.from("notas_fiscais").select("data_envio, numero_nota").eq("id_usuario",e.id).eq("status_validacao","validada").order("data_envio",{ascending:!1}),H=Y.pontos_nota_fiscal_validada??0;je==null||je.forEach(me=>{me.data_envio&&z.push({date:me.data_envio,type:"nota_fiscal",points:H,description:"Nota Fiscal Validada",details:me.numero_nota?`NF ${me.numero_nota}`:void 0})});const{data:Z}=await J.from("materiais_reciclaveis_usuario").select("data_cadastro, descricao, origem_cadastro").eq("id_usuario",e.id).order("data_cadastro",{ascending:!1}),G=Y.pontos_material_cadastro_nota??0,Q=Y.pontos_material_cadastro_manual??0;Z==null||Z.forEach(me=>{if(me.data_cadastro){const fe=me.origem_cadastro==="nota_fiscal"?G:Q;z.push({date:me.data_cadastro,type:"material_cadastro",points:fe,description:me.origem_cadastro==="nota_fiscal"?"Material (NF)":"Material (Manual)",details:me.descricao})}});const{data:re}=await J.from("entregas_reciclaveis").select("data_validacao, peso_validado, tipo_material").eq("id_usuario",e.id).eq("status","validada").order("data_validacao",{ascending:!1}),le=Y.pontos_base_entrega_6kg??20;if(re&&re.length>0){const me=re.reduce((ne,Me)=>ne+(Me.peso_validado||0),0),fe=Math.round(me/6*le),ve=(M=re[0])==null?void 0:M.data_validacao;ve&&fe>0&&z.push({date:ve,type:"entrega_validada",points:fe,description:"Entregas Validadas",details:`${me.toFixed(2)}kg total (${re.length} ${re.length===1?"entrega":"entregas"})`})}const{data:ye}=await J.from("cupons_resgates").select("data_resgate, pontos_utilizados, cupons (marketplace, valor_reais)").eq("id_usuario",e.id).order("data_resgate",{ascending:!1});ye==null||ye.forEach(me=>{var fe;me.data_resgate&&z.push({date:me.data_resgate,type:"cupom_resgate",points:-me.pontos_utilizados,description:"Cupom Resgatado",details:`${(fe=me.cupons)==null?void 0:fe.marketplace}`})});const{data:W}=await J.from("indicacoes").select("data_indicacao, pontos_cadastro_concedidos, pontos_primeira_missao_concedidos, profiles!indicacoes_id_indicado_fkey (nome)").eq("id_indicador",e.id).order("data_indicacao",{ascending:!1}),ee=Y.pontos_indicacao_cadastro??0,ie=Y.pontos_indicacao_primeira_missao??0;W==null||W.forEach(me=>{var fe,ve,ne,Me;me.data_indicacao&&me.pontos_cadastro_concedidos&&z.push({date:me.data_indicacao,type:"indicacao_cadastro",points:ee,description:"Indicao",details:`${(ve=(fe=me.profiles)==null?void 0:fe.nome)==null?void 0:ve.split(" ")[0]} se cadastrou`}),me.pontos_primeira_missao_concedidos&&z.push({date:me.data_indicacao,type:"indicacao_primeira_missao",points:ie,description:"Bnus Indicao",details:`${(Me=(ne=me.profiles)==null?void 0:ne.nome)==null?void 0:Me.split(" ")[0]} completou misso`})}),z.sort((me,fe)=>new Date(fe.date).getTime()-new Date(me.date).getTime()),r(z);const ce=z.reduce((me,fe)=>me+fe.points,0),xe=z.filter(me=>me.points>0).reduce((me,fe)=>me+fe.points,0),Ce=z.filter(me=>me.points<0).reduce((me,fe)=>me+Math.abs(fe.points),0);o(ce),d(xe),p(Ce)}catch(z){console.error("Erro ao carregar extrato:",z),ct.error("Erro ao carregar extrato de pontos")}finally{n(!1)}},C=M=>{const z="h-4 w-4";switch(M){case"missao":return s.jsx(wo,{className:z});case"nota_fiscal":return s.jsx(Qa,{className:z});case"material_cadastro":return s.jsx(fs,{className:z});case"entrega_validada":return s.jsx(tl,{className:z});case"cupom_resgate":return s.jsx(Jn,{className:z});case"indicacao_cadastro":case"indicacao_primeira_missao":return s.jsx(Mv,{className:z});default:return s.jsx(Md,{className:z})}},T=(M,z)=>{if(z<0)return"bg-rose-500/15 text-rose-600 dark:text-rose-400";switch(M){case"missao":return"bg-amber-500/15 text-amber-600 dark:text-amber-400";case"nota_fiscal":return"bg-blue-500/15 text-blue-600 dark:text-blue-400";case"material_cadastro":return"bg-violet-500/15 text-violet-600 dark:text-violet-400";case"entrega_validada":return"bg-emerald-500/15 text-emerald-600 dark:text-emerald-400";case"cupom_resgate":return"bg-rose-500/15 text-rose-600 dark:text-rose-400";case"indicacao_cadastro":case"indicacao_primeira_missao":return"bg-cyan-500/15 text-cyan-600 dark:text-cyan-400";default:return"bg-muted text-muted-foreground"}},A=M=>{const z=new Date(M);return xR(z)?"Hoje":gR(z)?"Ontem":Os(z,"dd 'de' MMMM",{locale:$s})},k=x!=null&&x.from?t.filter(M=>{const z=new Date(M.date),q=Mu(x.from),Y=x.to?Qy(x.to):Qy(x.from);return fK(z,{start:q,end:Y})}):t,I=k.filter(M=>M.points>0).reduce((M,z)=>M+z.points,0),B=k.filter(M=>M.points<0).reduce((M,z)=>M+Math.abs(z.points),0),D=(()=>{const M={};return k.forEach(z=>{const q=Os(new Date(z.date),"yyyy-MM-dd");M[q]||(M[q]=[]),M[q].push(z)}),Object.entries(M).map(([z,q])=>({label:A(z),transactions:q}))})(),F=()=>{v(void 0),N(!1)};return s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-muted/30 to-background",children:[s.jsx(Rd,{showBackButton:!0,backTo:"/user",title:"Extrato de Pontos"}),s.jsxs(Ee.div,{className:"relative overflow-hidden",initial:{opacity:0},animate:{opacity:1},children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary via-primary/90 to-emerald-600"}),s.jsxs("div",{className:"absolute inset-0 opacity-30",children:[s.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full blur-3xl transform translate-x-1/2 -translate-y-1/2"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-48 h-48 bg-emerald-400/20 rounded-full blur-2xl transform -translate-x-1/2 translate-y-1/2"})]}),s.jsx("div",{className:"relative mx-auto max-w-lg px-4 pt-4 pb-6",children:s.jsxs(Ee.div,{className:"bg-white/10 backdrop-blur-md rounded-3xl p-5 border border-white/20",initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.1,type:"spring",stiffness:200},children:[s.jsxs("div",{className:"text-center mb-4",children:[s.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-white/10 mb-3",children:[s.jsx(cr,{className:"h-4 w-4 text-emerald-300"}),s.jsx("span",{className:"text-xs font-medium text-white/90",children:"Saldo Disponvel"})]}),s.jsx(Ee.p,{className:"text-5xl font-bold text-white tracking-tight",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,type:"spring"},children:Br(i,0)}),s.jsx("p",{className:"text-sm text-white/60 mt-1",children:"pontos verdes"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs(Ee.div,{className:"bg-emerald-400/20 rounded-2xl p-3",whileHover:{scale:1.02},transition:{type:"spring",stiffness:400},children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("div",{className:"w-6 h-6 rounded-full bg-emerald-400/30 flex items-center justify-center",children:s.jsx(Ir,{className:"h-3.5 w-3.5 text-emerald-300"})}),s.jsx("span",{className:"text-[11px] font-medium text-white/80",children:"Ganhos"})]}),s.jsxs("p",{className:"text-xl font-bold text-white",children:["+",Br(x!=null&&x.from?I:c,0)]})]}),s.jsxs(Ee.div,{className:"bg-rose-400/20 rounded-2xl p-3",whileHover:{scale:1.02},transition:{type:"spring",stiffness:400},children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("div",{className:"w-6 h-6 rounded-full bg-rose-400/30 flex items-center justify-center",children:s.jsx(Vw,{className:"h-3.5 w-3.5 text-rose-300"})}),s.jsx("span",{className:"text-[11px] font-medium text-white/80",children:"Resgatados"})]}),s.jsxs("p",{className:"text-xl font-bold text-white",children:["-",Br(x!=null&&x.from?B:h,0)]})]})]})]})})]}),s.jsx("div",{className:"mx-auto max-w-lg px-4 -mt-2",children:s.jsxs("div",{className:"bg-card rounded-t-3xl shadow-xl border border-border/50 min-h-[50vh]",children:[s.jsxs("div",{className:"p-4 border-b border-border/50",children:[s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Fa,{className:"h-4 w-4 text-muted-foreground"}),s.jsx("span",{className:"text-sm font-medium text-foreground",children:"Histrico"}),s.jsxs(Je,{variant:"secondary",className:"text-[10px] h-5",children:[k.length," ",k.length===1?"transao":"transaes"]})]}),s.jsxs(bl,{open:b,onOpenChange:N,children:[s.jsx(_l,{asChild:!0,children:s.jsxs(oe,{variant:x!=null&&x.from?"default":"outline",size:"sm",className:pt("h-8 gap-2 text-xs rounded-xl",(x==null?void 0:x.from)&&"bg-primary text-primary-foreground"),children:[s.jsx(Of,{className:"h-3.5 w-3.5"}),x!=null&&x.from?s.jsxs(s.Fragment,{children:[Os(x.from,"dd/MM",{locale:$s}),x.to&&` - ${Os(x.to,"dd/MM",{locale:$s})}`]}):"Filtrar"]})}),s.jsxs(Xo,{className:"w-auto p-0",align:"end",children:[s.jsx("div",{className:"p-3 border-b border-border",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium",children:"Perodo"}),(x==null?void 0:x.from)&&s.jsxs(oe,{variant:"ghost",size:"sm",onClick:F,className:"h-7 text-xs text-muted-foreground hover:text-foreground",children:[s.jsx(Jr,{className:"h-3 w-3 mr-1"}),"Limpar"]})]})}),s.jsx(oc,{initialFocus:!0,mode:"range",defaultMonth:x==null?void 0:x.from,selected:x,onSelect:v,numberOfMonths:1,locale:$s,className:"pointer-events-auto"})]})]})]}),s.jsx(Qi,{children:(x==null?void 0:x.from)&&s.jsx(Ee.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-3",children:s.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-primary/10 rounded-xl text-xs",children:[s.jsx(Fa,{className:"h-3.5 w-3.5 text-primary"}),s.jsxs("span",{className:"text-foreground",children:["Exibindo: ",Os(x.from,"dd 'de' MMMM",{locale:$s}),x.to&&x.to!==x.from&&s.jsxs(s.Fragment,{children:[" at ",Os(x.to,"dd 'de' MMMM",{locale:$s})]})]}),s.jsx(oe,{variant:"ghost",size:"sm",onClick:F,className:"h-5 w-5 p-0 ml-auto hover:bg-primary/20",children:s.jsx(Jr,{className:"h-3 w-3"})})]})})})]}),s.jsx("div",{className:"p-4",children:a?s.jsx("div",{className:"space-y-3",children:[1,2,3,4,5].map(M=>s.jsx("div",{className:"h-16 bg-muted/50 rounded-2xl animate-pulse"},M))}):k.length===0?s.jsxs(Ee.div,{className:"text-center py-12",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-muted/50 flex items-center justify-center",children:s.jsx(cr,{className:"h-8 w-8 text-muted-foreground"})}),s.jsx("p",{className:"text-sm font-medium text-foreground",children:x!=null&&x.from?"Nenhuma transao no perodo":"Nenhuma transao"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:x!=null&&x.from?"Tente selecionar outro perodo":"Complete misses e entregue reciclveis para ganhar pontos!"}),(x==null?void 0:x.from)&&s.jsx(oe,{variant:"outline",size:"sm",onClick:F,className:"mt-4",children:"Limpar filtro"})]}):s.jsx(Qi,{children:D.map((M,z)=>s.jsxs(Ee.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:z*.05},className:"mb-5",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2 px-1",children:[s.jsx("span",{className:"text-[11px] font-semibold text-muted-foreground uppercase tracking-wider",children:M.label}),s.jsx("div",{className:"flex-1 h-px bg-border/50"})]}),s.jsx("div",{className:"space-y-2",children:M.transactions.map((q,Y)=>s.jsxs(Ee.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:Y*.02},className:"flex items-center gap-3 p-3 rounded-2xl bg-muted/30 hover:bg-muted/50 transition-all duration-200 border border-transparent hover:border-border/50",children:[s.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0 ${T(q.type,q.points)}`,children:C(q.type)}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:q.description}),s.jsx("p",{className:"text-[11px] text-muted-foreground truncate",children:q.details||Os(new Date(q.date),"HH:mm",{locale:$s})})]}),s.jsxs("div",{className:`text-right flex-shrink-0 ${q.points>0?"text-emerald-600 dark:text-emerald-400":"text-rose-600 dark:text-rose-400"}`,children:[s.jsxs("p",{className:"text-sm font-bold",children:[q.points>0?"+":"",q.points]}),s.jsx("p",{className:"text-[10px] opacity-60",children:"pts"})]})]},`${q.date}-${Y}`))})]},M.label))})})]})})]})},ode={"Misses Educativas":{path:"/missions",label:"Iniciar Misso"},"Notas Fiscais":{path:"/upload-receipt",label:"Enviar Nota"},"Entregas de Reciclveis":{path:"/select-materials",label:"Agendar Entrega"},Indicaes:{path:"/profile",label:"Convidar Amigos"}};function lde({icon:e}){return e===""?s.jsx(Ee.div,{className:"text-3xl",animate:{rotateY:[0,360]},transition:{duration:2,repeat:1/0,repeatDelay:3},children:e}):e===""?s.jsx(Ee.div,{className:"text-3xl",animate:{scale:[1,1.2,1],rotate:[0,-10,10,0]},transition:{duration:1.5,repeat:1/0,repeatDelay:2},children:e}):e===""?s.jsx(Ee.div,{className:"text-3xl",animate:{rotate:[0,360]},transition:{duration:3,repeat:1/0,ease:"linear"},children:e}):e===""?s.jsx(Ee.div,{className:"text-3xl",animate:{x:[0,-5,5,0],scale:[1,1.1,1]},transition:{duration:1.5,repeat:1/0,repeatDelay:2},children:e}):s.jsx(Ee.div,{className:"text-3xl",animate:{scale:[1,1.1,1]},transition:{duration:1,repeat:1/0,repeatDelay:2},children:e})}function zc({title:e,icon:t,color:r,semanal:a,mensal:n,delay:i=0,actionPath:o,actionLabel:c}){const d=ds(),h=a.progresso>=100,p=n.progresso>=100,x=h&&p,v=ode[e]||{path:o||"/user",label:c||"Ir"};return s.jsxs(Ee.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{delay:i*.1,type:"spring",stiffness:100},whileHover:{scale:1.02,y:-2},className:pt("relative p-4 rounded-2xl border overflow-hidden",x?"bg-gradient-to-br from-success/10 via-success/5 to-card border-success/30":"bg-card border-border hover:border-primary/30 hover:shadow-md"),children:[s.jsx(Ee.div,{className:"absolute -right-8 -top-8 w-24 h-24 rounded-full opacity-10",style:{background:x?"hsl(var(--success))":"hsl(var(--primary))"},animate:{scale:[1,1.2,1],rotate:[0,180,360]},transition:{duration:10,repeat:1/0}}),s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(lde,{icon:t}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold text-foreground",children:e}),x&&s.jsxs(Ee.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},className:"flex items-center gap-1 mt-0.5",children:[s.jsx(Md,{className:"h-3 w-3 text-success"}),s.jsx("span",{className:"text-[10px] text-success font-medium",children:"Metas concludas!"})]})]})]}),s.jsx(Ee.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:i*.1+.2},whileHover:{scale:1.1},whileTap:{scale:.95},children:s.jsxs(oe,{size:"sm",variant:x?"outline":"default",className:pt("rounded-full h-8 px-3 text-xs shadow-sm",x?"border-success text-success hover:bg-success/10":"bg-primary hover:bg-primary/90"),onClick:()=>d(v.path),children:[v.label,s.jsx(Xi,{className:"h-3 w-3 ml-1"})]})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsx("span",{className:"text-muted-foreground font-medium",children:"Meta Semanal"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(Ee.span,{className:"font-bold text-foreground",initial:{scale:1.5,color:"hsl(var(--primary))"},animate:{scale:1,color:"hsl(var(--foreground))"},children:[a.atual,"/",a.meta]},a.atual),h&&s.jsx(Ee.span,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:500},className:"text-success text-sm",children:""})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx(fn,{value:a.progresso,className:pt("h-2.5 rounded-full",h&&"[&>div]:bg-success")}),a.progresso>=70&&a.progresso<100&&s.jsx(Ee.div,{className:"absolute right-1 top-1/2 -translate-y-1/2 text-sm",animate:{scale:[1,1.3,1],rotate:[0,-10,10,0]},transition:{duration:.5,repeat:1/0,repeatDelay:1},children:""}),h&&s.jsx(Ee.div,{className:"absolute right-1 top-1/2 -translate-y-1/2",initial:{scale:0},animate:{scale:[0,1.5,1]},transition:{type:"spring"},children:""})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsx("span",{className:"text-muted-foreground font-medium",children:"Meta Mensal"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(Ee.span,{className:"font-bold text-foreground",initial:{scale:1.5,color:"hsl(var(--primary))"},animate:{scale:1,color:"hsl(var(--foreground))"},children:[n.atual,"/",n.meta]},n.atual),p&&s.jsx(Ee.span,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:500},className:"text-success text-sm",children:""})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx(fn,{value:n.progresso,className:pt("h-2.5 rounded-full",p&&"[&>div]:bg-success")}),n.progresso>=70&&n.progresso<100&&s.jsx(Ee.div,{className:"absolute right-1 top-1/2 -translate-y-1/2 text-sm",animate:{y:[0,-3,0],scale:[1,1.2,1]},transition:{duration:.8,repeat:1/0},children:""}),p&&s.jsx(Ee.div,{className:"absolute right-1 top-1/2 -translate-y-1/2",initial:{scale:0},animate:{scale:[0,1.5,1]},transition:{type:"spring"},children:""})]})]})]}),x&&s.jsx(Ee.div,{className:"absolute inset-0 pointer-events-none",initial:{opacity:0},animate:{opacity:1},children:[...Array(5)].map((b,N)=>s.jsx(Ee.div,{className:"absolute w-2 h-2 rounded-full bg-success/30",style:{left:`${20+N*15}%`,top:`${30+N%3*20}%`},animate:{y:[0,-10,0],opacity:[.3,.6,.3],scale:[1,1.5,1]},transition:{duration:2,repeat:1/0,delay:N*.3}},N))})]})}const wS=["hsl(var(--primary))","hsl(var(--success))","hsl(var(--warning))","#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7"];function cde({trigger:e,onComplete:t}){const[r,a]=E.useState([]),[n,i]=E.useState(!1);return E.useEffect(()=>{if(e){const o=Array.from({length:50},(d,h)=>({id:h,x:Math.random()*100,delay:Math.random()*.5,duration:2+Math.random()*2,color:wS[Math.floor(Math.random()*wS.length)],rotation:Math.random()*360,size:8+Math.random()*8}));a(o),i(!0);const c=setTimeout(()=>{a([]),i(!1),t==null||t()},4e3);return()=>clearTimeout(c)}},[e,t]),s.jsx(Qi,{children:n&&s.jsxs(s.Fragment,{children:[s.jsx(Ee.div,{className:"fixed inset-0 flex items-center justify-center pointer-events-none z-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:s.jsx(Ee.div,{className:"text-6xl",initial:{scale:0,rotate:-180},animate:{scale:[0,1.5,1],rotate:[180,0]},transition:{duration:.5,ease:"backOut"},children:""})}),s.jsx("div",{className:"fixed inset-0 overflow-hidden pointer-events-none z-50",children:r.map(o=>s.jsx(Ee.div,{className:"absolute top-0",style:{left:`${o.x}%`,width:o.size,height:o.size,backgroundColor:o.color,borderRadius:Math.random()>.5?"50%":"2px"},initial:{y:-20,x:0,rotate:0,opacity:1},animate:{y:window.innerHeight+100,x:(Math.random()-.5)*200,rotate:o.rotation+720,opacity:[1,1,0]},transition:{duration:o.duration,delay:o.delay,ease:"easeIn"}},o.id))}),s.jsx(Ee.div,{className:"fixed inset-0 pointer-events-none z-40",initial:{opacity:0},animate:{opacity:[0,.3,0]},transition:{duration:.8},style:{background:"radial-gradient(circle at center, hsl(var(--primary) / 0.2) 0%, transparent 70%)"}})]})})}const nx=[{emoji:"",text:"Complete misses educativas para aprender sobre reciclagem e ganhar pontos extras!"},{emoji:"",text:"Escaneie suas notas fiscais para catalogar embalagens e contribuir com o meio ambiente."},{emoji:"",text:"Separe seus reciclveis por tipo para facilitar a triagem nas cooperativas."},{emoji:"",text:"Indique amigos para o Ciclik! Vocs dois ganham pontos quando eles completam a primeira misso."},{emoji:"",text:"Acompanhe suas metas semanais e mensais para subir de nvel mais rpido!"},{emoji:"",text:"Cada kg de material reciclado evita emisso de CO na atmosfera."},{emoji:"",text:"Quanto mais alto seu nvel, mais benefcios e recompensas voc desbloqueia!"},{emoji:"",text:"Embalagens limpas e secas tm maior valor de reciclagem."},{emoji:"",text:"Sua contribuio ajuda a construir um futuro mais sustentvel para todos."},{emoji:"",text:"Troque seus pontos por cupons de desconto em lojas parceiras!"}];function dde(){const[e,t]=E.useState(()=>new Date().getMonth()%nx.length);E.useEffect(()=>{const a=setInterval(()=>{t(n=>(n+1)%nx.length)},8e3);return()=>clearInterval(a)},[]);const r=nx[e];return s.jsx(Ne,{className:"rounded-2xl border-0 shadow-sm bg-gradient-to-br from-warning/5 to-card overflow-hidden",children:s.jsx(De,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Ee.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1,rotate:[0,10,-10,0]},transition:{duration:.5},className:"text-2xl flex-shrink-0",children:r.emoji},e),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("p",{className:"text-sm font-medium text-foreground",children:"Dica do Ciclo"}),s.jsx("div",{className:"flex gap-1",children:nx.map((a,n)=>s.jsx(Ee.div,{className:`w-1.5 h-1.5 rounded-full ${n===e?"bg-primary":"bg-muted"}`,animate:n===e?{scale:[1,1.3,1]}:{},transition:{duration:.5}},n))})]}),s.jsx(Qi,{mode:"wait",children:s.jsx(Ee.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},className:"text-xs text-muted-foreground leading-relaxed",children:r.text},e)})]})]})})})}const Nm={initial:{opacity:0,y:20},animate:{opacity:1,y:0}};function ude(){const e=ds(),{profile:t}=sr(),r=DR(),[a,n]=E.useState(!1),[i,o]=E.useState(!1),c=x=>{switch(x){case"Iniciante":return"Embaixador Ciclik";case"Ativo":return"Protetor Ciclik";case"Guardiao Verde":return"Guardio Ciclik";default:return x}},d=x=>{switch(x){case"Iniciante":return"";case"Ativo":return"";case"Guardiao Verde":return"";default:return""}};E.useEffect(()=>{!i&&!r.loading&&r.missoes.progressoSemanal>=100&&r.notas.progressoSemanal>=100&&r.entregas.progressoSemanal>=100&&r.indicacoes.progressoSemanal>=100&&(n(!0),o(!0))},[r,i]);const h=[r.missoes.progressoSemanal>=100,r.notas.progressoSemanal>=100,r.entregas.progressoSemanal>=100,r.indicacoes.progressoSemanal>=100].filter(Boolean).length,p=[r.missoes.progressoMensal>=100,r.notas.progressoMensal>=100,r.entregas.progressoMensal>=100,r.indicacoes.progressoMensal>=100].filter(Boolean).length;return s.jsxs(Nc,{children:[s.jsx(cde,{trigger:a,onComplete:()=>n(!1)}),s.jsxs("div",{className:"min-h-screen bg-background pb-6",children:[s.jsx("div",{className:"bg-white border-b border-border sticky top-0 z-40 shadow-sm",children:s.jsx("div",{className:"mx-auto max-w-lg px-4 py-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(oe,{variant:"ghost",size:"icon",className:"rounded-full",onClick:()=>e("/user"),children:s.jsx(As,{className:"h-5 w-5"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("h1",{className:"text-lg font-bold text-foreground flex items-center gap-2",children:[s.jsx(Eo,{className:"h-5 w-5 text-primary"}),"Suas Metas"]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Acompanhe seu progresso semanal e mensal"})]})]})})}),s.jsxs("div",{className:"mx-auto max-w-lg px-4 pt-4 space-y-4",children:[s.jsx(Ee.div,{...Nm,transition:{delay:.1},children:s.jsx(Ne,{className:"rounded-2xl border-0 shadow-lg overflow-hidden bg-gradient-to-br from-card via-card to-primary/5",children:s.jsxs(De,{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ee.div,{className:"w-14 h-14 rounded-2xl bg-gradient-to-br from-primary to-success flex items-center justify-center shadow-lg",animate:{scale:[1,1.05,1]},transition:{duration:2,repeat:1/0},children:s.jsx("span",{className:"text-3xl",children:d((t==null?void 0:t.nivel)||"Iniciante")})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Seu nvel"}),s.jsx("p",{className:"font-bold text-lg text-foreground",children:c((t==null?void 0:t.nivel)||"Iniciante")})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-2xl font-bold text-primary",children:r.pontosMes}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"pts este ms"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[s.jsx(Ir,{className:"h-3 w-3"}),"Prximo: ",r.proximoNivel]}),s.jsx("span",{className:"font-medium text-primary",children:r.pontosParaProximoNivel>0?`Faltam ${r.pontosParaProximoNivel} pts`:" Nvel mximo!"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(fn,{value:r.progressoNivel,className:"h-3 rounded-full"}),r.progressoNivel>=90&&r.pontosParaProximoNivel>0&&s.jsx(Ee.div,{className:"absolute right-1 top-1/2 -translate-y-1/2",animate:{scale:[1,1.3,1],rotate:[0,10,-10,0]},transition:{duration:.5,repeat:1/0},children:s.jsx(Go,{className:"h-4 w-4 text-warning"})})]})]})]})})}),s.jsx(Ee.div,{...Nm,transition:{delay:.2},children:s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx(Ne,{className:"rounded-2xl border-0 shadow-sm bg-gradient-to-br from-primary/5 to-card",children:s.jsxs(De,{className:"p-4 text-center",children:[s.jsxs("div",{className:"flex items-center justify-center gap-1 mb-1",children:[s.jsx(Fa,{className:"h-4 w-4 text-primary"}),s.jsx("span",{className:"text-xs text-muted-foreground",children:"Esta Semana"})]}),s.jsxs("p",{className:"text-2xl font-bold text-foreground",children:[h,"/4"]}),s.jsxs("p",{className:"text-[10px] text-muted-foreground mt-1",children:[r.diasRestantesSemana," dias restantes"]})]})}),s.jsx(Ne,{className:"rounded-2xl border-0 shadow-sm bg-gradient-to-br from-success/5 to-card",children:s.jsxs(De,{className:"p-4 text-center",children:[s.jsxs("div",{className:"flex items-center justify-center gap-1 mb-1",children:[s.jsx(Qn,{className:"h-4 w-4 text-success"}),s.jsx("span",{className:"text-xs text-muted-foreground",children:"Este Ms"})]}),s.jsxs("p",{className:"text-2xl font-bold text-foreground",children:[p,"/4"]}),s.jsxs("p",{className:"text-[10px] text-muted-foreground mt-1",children:[r.diasRestantesMes," dias restantes"]})]})})]})}),s.jsx(Ee.div,{...Nm,transition:{delay:.3},children:s.jsxs(Mn,{defaultValue:"semanal",className:"w-full",children:[s.jsxs(Nn,{className:"w-full rounded-2xl p-1 bg-muted/50",children:[s.jsx(Gs,{value:"semanal",className:"flex-1 rounded-xl data-[state=active]:bg-primary data-[state=active]:text-primary-foreground",children:"Semanal"}),s.jsx(Gs,{value:"mensal",className:"flex-1 rounded-xl data-[state=active]:bg-primary data-[state=active]:text-primary-foreground",children:"Mensal"})]}),s.jsxs(hr,{value:"semanal",className:"mt-4 space-y-3",children:[s.jsx(zc,{title:"Misses Educativas",icon:"",color:"amber",semanal:{atual:Math.round(r.missoes.progressoSemanal*r.missoes.metaSemanal/100),meta:r.missoes.metaSemanal,progresso:r.missoes.progressoSemanal},mensal:{atual:r.missoes.atual,meta:r.missoes.metaMensal,progresso:r.missoes.progressoMensal},delay:0}),s.jsx(zc,{title:"Notas Fiscais",icon:"",color:"blue",semanal:{atual:Math.round(r.notas.progressoSemanal*r.notas.metaSemanal/100),meta:r.notas.metaSemanal,progresso:r.notas.progressoSemanal},mensal:{atual:r.notas.atual,meta:r.notas.metaMensal,progresso:r.notas.progressoMensal},delay:1}),s.jsx(zc,{title:"Entregas de Reciclveis",icon:"",color:"green",semanal:{atual:Math.round(r.entregas.progressoSemanal*r.entregas.metaSemanal/100),meta:r.entregas.metaSemanal,progresso:r.entregas.progressoSemanal},mensal:{atual:r.entregas.atual,meta:r.entregas.metaMensal,progresso:r.entregas.progressoMensal},delay:2}),s.jsx(zc,{title:"Indicaes",icon:"",color:"purple",semanal:{atual:Math.round(r.indicacoes.progressoSemanal*r.indicacoes.metaSemanal/100),meta:r.indicacoes.metaSemanal,progresso:r.indicacoes.progressoSemanal},mensal:{atual:r.indicacoes.atual,meta:r.indicacoes.metaMensal,progresso:r.indicacoes.progressoMensal},delay:3})]}),s.jsxs(hr,{value:"mensal",className:"mt-4 space-y-3",children:[s.jsx(zc,{title:"Misses Educativas",icon:"",color:"amber",semanal:{atual:Math.round(r.missoes.progressoSemanal*r.missoes.metaSemanal/100),meta:r.missoes.metaSemanal,progresso:r.missoes.progressoSemanal},mensal:{atual:r.missoes.atual,meta:r.missoes.metaMensal,progresso:r.missoes.progressoMensal},delay:0}),s.jsx(zc,{title:"Notas Fiscais",icon:"",color:"blue",semanal:{atual:Math.round(r.notas.progressoSemanal*r.notas.metaSemanal/100),meta:r.notas.metaSemanal,progresso:r.notas.progressoSemanal},mensal:{atual:r.notas.atual,meta:r.notas.metaMensal,progresso:r.notas.progressoMensal},delay:1}),s.jsx(zc,{title:"Entregas de Reciclveis",icon:"",color:"green",semanal:{atual:Math.round(r.entregas.progressoSemanal*r.entregas.metaSemanal/100),meta:r.entregas.metaSemanal,progresso:r.entregas.progressoSemanal},mensal:{atual:r.entregas.atual,meta:r.entregas.metaMensal,progresso:r.entregas.progressoMensal},delay:2}),s.jsx(zc,{title:"Indicaes",icon:"",color:"purple",semanal:{atual:Math.round(r.indicacoes.progressoSemanal*r.indicacoes.metaSemanal/100),meta:r.indicacoes.metaSemanal,progresso:r.indicacoes.progressoSemanal},mensal:{atual:r.indicacoes.atual,meta:r.indicacoes.metaMensal,progresso:r.indicacoes.progressoMensal},delay:3})]})]})}),s.jsx(Ee.div,{...Nm,transition:{delay:.4},children:s.jsx(dde,{})}),r.metaEmRisco&&s.jsx(Ee.div,{...Nm,transition:{delay:.5},children:s.jsxs(oe,{className:"w-full rounded-2xl h-12 bg-gradient-to-r from-primary to-success hover:opacity-90",onClick:()=>{r.metaEmRisco==="misses"?e("/missions"):r.metaEmRisco==="notas fiscais"?e("/upload-receipt"):r.metaEmRisco==="entregas"?e("/select-materials"):e("/profile")},children:[s.jsx(Md,{className:"h-4 w-4 mr-2"}),"Completar meta de ",r.metaEmRisco,s.jsx(Xi,{className:"h-4 w-4 ml-2"})]})})]})]})]})}const hde=()=>{const e=ds(),t=[{icon:s.jsx(cr,{className:"w-8 h-8 text-primary"}),title:"1.000 kg de Resduos",description:"Reciclagem certificada de materiais com rastreabilidade completa"},{icon:s.jsx(Xa,{className:"w-8 h-8 text-secondary"}),title:"1.200 Horas de Educao",description:"Contedo ambiental distribudo para 30 pessoas (40h cada)"},{icon:s.jsx(fs,{className:"w-8 h-8 text-accent"}),title:"18 Embalagens Catalogadas",description:"Anlise tcnica de reciclabilidade e impacto ambiental"}],r=[{step:"Adquira sua quota CDV por R$ 2.000",detail:"Investimento nico com retorno garantido em impacto ambiental"},{step:"Acompanhe mensalmente o progresso dos impactos",detail:"Dashboard exclusivo com mtricas em tempo real"},{step:"Aguarde o perodo de maturao de 12 meses",detail:"Enquanto isso, seu investimento gera impacto contnuo"},{step:"Receba certificado digital com QR code de validao",detail:"Certificao blockchain auditvel e transparente"}],a=[{icon:vi,text:"100% Auditvel"},{icon:Da,text:"Blockchain Verificado"},{icon:Ir,text:"Impacto Mensurvel"},{icon:jl,text:"Certificao Digital"}];return s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-background via-primary/5 to-secondary/10 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[...Array(8)].map((n,i)=>s.jsx("div",{className:"absolute opacity-20",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`},children:s.jsx(cr,{className:"w-6 h-6 text-primary/20"})},i))}),s.jsxs("div",{className:"container mx-auto px-4 py-16 relative z-10",children:[s.jsxs(Ee.div,{className:"text-center max-w-4xl mx-auto mb-16",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[s.jsxs(Je,{className:"mb-6 text-base px-4 py-2",children:[s.jsx(cr,{className:"w-4 h-4 mr-2"}),"Certificado Digital Verde"]}),s.jsx("h1",{className:"text-4xl md:text-6xl font-display font-bold mb-6 bg-gradient-to-r from-primary via-primary/80 to-accent bg-clip-text text-transparent",children:"Invista no Futuro Sustentvel"}),s.jsxs("p",{className:"text-xl md:text-2xl text-muted-foreground mb-8 leading-relaxed",children:["O CDV  um produto de investimento ambiental que garante a entrega de",s.jsx("span",{className:"font-bold text-foreground",children:" impactos concretos e mensurveis "}),"em 12 meses."]}),s.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 mb-8 p-6 bg-card/80 backdrop-blur rounded-2xl border-2 border-primary/20 max-w-2xl mx-auto",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-5xl font-display font-bold text-primary mb-1",children:"R$ 2.000"}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"por quota CDV"})]}),s.jsx("div",{className:"h-12 w-px bg-border hidden sm:block"}),s.jsx("div",{className:"h-px w-12 bg-border sm:hidden"}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-5xl font-display font-bold text-primary mb-1",children:"12 meses"}),s.jsx("div",{className:"text-sm text-muted-foreground",children:"perodo de maturao"})]})]}),s.jsx("div",{className:"flex flex-wrap justify-center gap-3 mb-8",children:a.map((n,i)=>s.jsxs(Ee.div,{className:"flex items-center gap-2 px-4 py-2 bg-card/80 backdrop-blur rounded-full border shadow-sm",whileHover:{scale:1.05},initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1*i},children:[s.jsx(n.icon,{className:"w-4 h-4 text-primary"}),s.jsx("span",{className:"font-medium text-sm",children:n.text})]},i))}),s.jsx(Ee.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},children:s.jsxs(oe,{size:"lg",onClick:()=>e("/auth"),className:"gap-2 text-lg px-8 shadow-lg",children:["Comear Agora ",s.jsx(Hn,{className:"w-5 h-5"})]})})]}),s.jsx(Ee.div,{className:"grid md:grid-cols-3 gap-8 mb-16",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.6},children:t.map((n,i)=>s.jsx(Ee.div,{whileHover:{scale:1.03,y:-5},transition:{duration:.2},children:s.jsx(Ne,{className:"border-2 hover:border-primary/50 transition-all h-full shadow-lg",children:s.jsxs(De,{className:"p-8 text-center",children:[s.jsx("div",{className:"flex justify-center mb-6",children:n.icon}),s.jsx("h3",{className:"text-xl font-display font-bold mb-3",children:n.title}),s.jsx("p",{className:"text-muted-foreground leading-relaxed",children:n.description})]})})},i))}),s.jsx(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.6},children:s.jsx(Ne,{className:"max-w-4xl mx-auto mb-16 shadow-2xl border-2",children:s.jsxs(De,{className:"p-8 md:p-12",children:[s.jsx("h2",{className:"text-3xl md:text-4xl font-display font-bold text-center mb-10",children:"Como Funciona"}),s.jsx("div",{className:"space-y-6",children:r.map((n,i)=>s.jsxs(Ee.div,{className:"flex items-start gap-4 p-4 rounded-xl hover:bg-muted/50 transition-colors",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.6+i*.1},children:[s.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-primary text-primary-foreground flex items-center justify-center font-bold text-lg",children:i+1}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-lg font-semibold mb-1",children:n.step}),s.jsx("p",{className:"text-muted-foreground text-sm",children:n.detail})]}),s.jsx(_n,{className:"w-6 h-6 text-primary flex-shrink-0 mt-1"})]},i))})]})})}),s.jsx(Ee.div,{className:"text-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.6},children:s.jsx(Ne,{className:"max-w-3xl mx-auto bg-gradient-to-br from-primary/10 via-primary/5 to-accent/10 border-2 border-primary/20 shadow-2xl",children:s.jsxs(De,{className:"p-8 md:p-12",children:[s.jsx(Ee.div,{initial:{scale:0},animate:{scale:1},transition:{delay:1,type:"spring"},children:s.jsx(oa,{className:"w-20 h-20 text-primary mx-auto mb-6"})}),s.jsx("h2",{className:"text-3xl md:text-4xl font-display font-bold mb-4",children:"Pronto para Investir?"}),s.jsx("p",{className:"text-lg md:text-xl text-muted-foreground mb-8 max-w-2xl mx-auto leading-relaxed",children:"Junte-se s empresas que j esto transformando o impacto ambiental em valor mensurvel e certificado."}),s.jsxs(oe,{size:"lg",onClick:()=>e("/auth"),className:"gap-2 text-lg px-8 shadow-lg",children:["Acessar Plataforma ",s.jsx(Hn,{className:"w-5 h-5"})]}),s.jsxs("p",{className:"text-sm text-muted-foreground mt-6",children:["Tem dvidas? "," ",s.jsx("button",{onClick:()=>e("/investidor"),className:"text-primary hover:underline font-semibold",children:"Veja a apresentao completa para investidores"})]})]})})})]})]})},fde=({x:e,y:t,size:r})=>s.jsx("div",{className:"absolute rounded-full",style:{left:`${e}%`,top:`${t}%`,width:r,height:r,background:"linear-gradient(135deg, hsl(76, 72%, 44%, 0.15), hsl(76, 72%, 44%, 0.05))",opacity:.4}});function mde({onCtaClick:e}){const t=Array.from({length:15},(r,a)=>({id:a,delay:Math.random()*3,duration:4+Math.random()*3,x:Math.random()*100,y:Math.random()*100,size:8+Math.random()*24}));return s.jsxs("section",{className:"relative min-h-screen flex items-center justify-center overflow-hidden bg-white",children:[s.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[s.jsx("svg",{className:"absolute -top-20 -left-20 w-96 h-96 text-primary/5",viewBox:"0 0 200 200",children:s.jsx("circle",{cx:"100",cy:"100",r:"80",fill:"currentColor"})}),s.jsx("svg",{className:"absolute -bottom-32 -right-32 w-[500px] h-[500px] text-accent/5",viewBox:"0 0 200 200",children:s.jsx("circle",{cx:"100",cy:"100",r:"90",fill:"currentColor"})}),t.map(r=>s.jsx(fde,{...r},r.id))]}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.03] via-transparent to-accent/[0.02]"}),s.jsx("div",{className:"relative z-10 container mx-auto px-4 py-24 pt-32 text-center",children:s.jsxs(Ee.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8},children:[s.jsx(Ee.div,{className:"flex justify-center mb-6",initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{duration:.8,delay:.2,type:"spring"},children:s.jsx("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-primary to-primary/80 flex items-center justify-center shadow-lg",children:s.jsx(Ur,{className:"w-10 h-10 text-white"})})}),s.jsx(Ee.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.4},children:s.jsxs(Je,{className:"mb-6 bg-primary/10 text-primary border-primary/20 px-5 py-2.5 text-sm font-display rounded-full",children:[s.jsx(vi,{className:"w-4 h-4 mr-2"}),"Impactos 100% Auditveis com QR Code"]})}),s.jsxs(Ee.h1,{className:"font-display text-4xl md:text-5xl lg:text-6xl font-bold text-foreground mb-6 leading-tight tracking-tight",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.8},children:["Sua Marca Associada a",s.jsx("br",{}),s.jsx("span",{className:"text-primary",children:"Impactos Ambientais Reais"})]}),s.jsxs(Ee.p,{className:"font-body text-lg md:text-xl text-muted-foreground mb-10 max-w-2xl mx-auto leading-relaxed",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7},children:["Invista em Certificados ",s.jsx("strong",{className:"text-primary",children:"Ciclik - Digital Verde"})," e receba impactos ambientais rastreveis e auditveis. Cada quota gera impacto real."]})]})})]})}var cl="Accordion",pde=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[m2,xde,gde]=Rw(cl),[d1,Jue]=bi(cl,[gde,MR]),p2=MR(),e8=He.forwardRef((e,t)=>{const{type:r,...a}=e,n=a,i=a;return s.jsx(m2.Provider,{scope:e.__scopeAccordion,children:r==="multiple"?s.jsx(bde,{...i,ref:t}):s.jsx(wde,{...n,ref:t})})});e8.displayName=cl;var[t8,vde]=d1(cl),[s8,yde]=d1(cl,{collapsible:!1}),wde=He.forwardRef((e,t)=>{const{value:r,defaultValue:a,onValueChange:n=()=>{},collapsible:i=!1,...o}=e,[c,d]=No({prop:r,defaultProp:a??"",onChange:n,caller:cl});return s.jsx(t8,{scope:e.__scopeAccordion,value:He.useMemo(()=>c?[c]:[],[c]),onItemOpen:d,onItemClose:He.useCallback(()=>i&&d(""),[i,d]),children:s.jsx(s8,{scope:e.__scopeAccordion,collapsible:i,children:s.jsx(r8,{...o,ref:t})})})}),bde=He.forwardRef((e,t)=>{const{value:r,defaultValue:a,onValueChange:n=()=>{},...i}=e,[o,c]=No({prop:r,defaultProp:a??[],onChange:n,caller:cl}),d=He.useCallback(p=>c((x=[])=>[...x,p]),[c]),h=He.useCallback(p=>c((x=[])=>x.filter(v=>v!==p)),[c]);return s.jsx(t8,{scope:e.__scopeAccordion,value:o,onItemOpen:d,onItemClose:h,children:s.jsx(s8,{scope:e.__scopeAccordion,collapsible:!0,children:s.jsx(r8,{...i,ref:t})})})}),[_de,u1]=d1(cl),r8=He.forwardRef((e,t)=>{const{__scopeAccordion:r,disabled:a,dir:n,orientation:i="vertical",...o}=e,c=He.useRef(null),d=br(c,t),h=xde(r),x=Af(n)==="ltr",v=Ts(e.onKeyDown,b=>{var F;if(!pde.includes(b.key))return;const N=b.target,_=h().filter(M=>{var z;return!((z=M.ref.current)!=null&&z.disabled)}),C=_.findIndex(M=>M.ref.current===N),T=_.length;if(C===-1)return;b.preventDefault();let A=C;const k=0,I=T-1,B=()=>{A=C+1,A>I&&(A=k)},O=()=>{A=C-1,A<k&&(A=I)};switch(b.key){case"Home":A=k;break;case"End":A=I;break;case"ArrowRight":i==="horizontal"&&(x?B():O());break;case"ArrowDown":i==="vertical"&&B();break;case"ArrowLeft":i==="horizontal"&&(x?O():B());break;case"ArrowUp":i==="vertical"&&O();break}const D=A%T;(F=_[D].ref.current)==null||F.focus()});return s.jsx(_de,{scope:r,disabled:a,direction:n,orientation:i,children:s.jsx(m2.Slot,{scope:r,children:s.jsx(ys.div,{...o,"data-orientation":i,ref:d,onKeyDown:a?void 0:v})})})}),gg="AccordionItem",[jde,x2]=d1(gg),a8=He.forwardRef((e,t)=>{const{__scopeAccordion:r,value:a,...n}=e,i=u1(gg,r),o=vde(gg,r),c=p2(r),d=Ai(),h=a&&o.value.includes(a)||!1,p=i.disabled||e.disabled;return s.jsx(jde,{scope:r,open:h,disabled:p,triggerId:d,children:s.jsx(BR,{"data-orientation":i.orientation,"data-state":d8(h),...c,...n,ref:t,disabled:p,open:h,onOpenChange:x=>{x?o.onItemOpen(a):o.onItemClose(a)}})})});a8.displayName=gg;var n8="AccordionHeader",i8=He.forwardRef((e,t)=>{const{__scopeAccordion:r,...a}=e,n=u1(cl,r),i=x2(n8,r);return s.jsx(ys.h3,{"data-orientation":n.orientation,"data-state":d8(i.open),"data-disabled":i.disabled?"":void 0,...a,ref:t})});i8.displayName=n8;var gw="AccordionTrigger",o8=He.forwardRef((e,t)=>{const{__scopeAccordion:r,...a}=e,n=u1(cl,r),i=x2(gw,r),o=yde(gw,r),c=p2(r);return s.jsx(m2.ItemSlot,{scope:r,children:s.jsx(qX,{"aria-disabled":i.open&&!o.collapsible||void 0,"data-orientation":n.orientation,id:i.triggerId,...c,...a,ref:t})})});o8.displayName=gw;var l8="AccordionContent",c8=He.forwardRef((e,t)=>{const{__scopeAccordion:r,...a}=e,n=u1(cl,r),i=x2(l8,r),o=p2(r);return s.jsx(WX,{role:"region","aria-labelledby":i.triggerId,"data-orientation":n.orientation,...o,...a,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});c8.displayName=l8;function d8(e){return e?"open":"closed"}var Nde=e8,Cde=a8,Ede=i8,u8=o8,h8=c8;const Sde=Nde,f8=E.forwardRef(({className:e,...t},r)=>s.jsx(Cde,{ref:r,className:pt("border-b",e),...t}));f8.displayName="AccordionItem";const m8=E.forwardRef(({className:e,children:t,...r},a)=>s.jsx(Ede,{className:"flex",children:s.jsxs(u8,{ref:a,className:pt("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e),...r,children:[t,s.jsx(If,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));m8.displayName=u8.displayName;const p8=E.forwardRef(({className:e,children:t,...r},a)=>s.jsx(h8,{ref:a,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...r,children:s.jsx("div",{className:pt("pb-4 pt-0",e),children:t})}));p8.displayName=h8.displayName;const Tde=[{question:"Quanto custa uma quota CDV?",answer:"Cada quota CDV custa R$ 2.000. Esse valor garante  sua marca o direito a 250kg de resduos reciclados, 5 minutos de educao ambiental e 1 produto catalogado, todos rastreveis e certificados."},{question:"Qual o prazo para receber os impactos?",answer:"O prazo varia de acordo com o projeto escolhido. A maioria dos projetos tem prazo de maturao de 12 a 24 meses. Durante esse perodo, voc acompanha o progresso em tempo real pelo dashboard exclusivo."},{question:"Como verifico a autenticidade do certificado?",answer:"Cada CDV possui um QR code nico que, ao ser escaneado, direciona para uma pgina pblica de validao. Qualquer pessoa pode verificar os impactos, datas e rastreabilidade completa do certificado."},{question:"Posso investir em mltiplos projetos?",answer:"Sim! Voc pode adquirir quotas em quantos projetos desejar. Isso permite diversificar seus impactos ambientais e apoiar diferentes pblicos-alvo e regies."},{question:"Como uso os impactos para relatrios ESG?",answer:"Oferecemos relatrios formatados especificamente para uso em documentao ESG. Voc pode exportar dados em PDF e Excel, incluindo certificados, rastreabilidade e mtricas detalhadas de impacto."},{question:"O que acontece se o projeto no atingir 100%?",answer:"Trabalhamos com projees baseadas no histrico do ecossistema Ciclik. Em caso de atrasos, voc  notificado e pode acompanhar o progresso em tempo real. Projetos com risco de atraso so sinalizados no dashboard."},{question:'Posso usar o selo "Investidor Ciclik"?',answer:'Sim! Ao adquirir quotas CDV, sua empresa recebe o direito de uso do selo "Investidor Ciclik" em materiais de comunicao, campanhas de marketing e relatrios de sustentabilidade.'},{question:"Como funciona a rastreabilidade?",answer:"Cada unidade de impacto (UIB)  rastrevel at a origem: voc pode ver qual cooperativa recebeu os resduos, qual usurio assistiu ao contedo educativo, e qual produto foi catalogado. Tudo com data, hora e localizao."}];function Ade(){const e=E.useRef(null),t=zb(e,{once:!0,margin:"-100px"});return s.jsx("section",{className:"py-24 bg-muted/30",ref:e,children:s.jsxs("div",{className:"container mx-auto px-4",children:[s.jsxs(Ee.div,{className:"text-center mb-16",initial:{opacity:0,y:20},animate:t?{opacity:1,y:0}:{},transition:{duration:.6},children:[s.jsx("span",{className:"text-primary font-semibold text-sm uppercase tracking-wider",children:"Perguntas Frequentes"}),s.jsx("h2",{className:"text-4xl md:text-5xl font-bold text-foreground mt-4 mb-6",children:"Tire Suas Dvidas"}),s.jsx("p",{className:"text-xl text-muted-foreground max-w-3xl mx-auto",children:"Encontre respostas para as perguntas mais comuns sobre investimento em CDV e impactos ambientais certificados."})]}),s.jsx(Ee.div,{className:"max-w-3xl mx-auto",initial:{opacity:0,y:30},animate:t?{opacity:1,y:0}:{},transition:{delay:.3,duration:.6},children:s.jsx(Sde,{type:"single",collapsible:!0,className:"space-y-4",children:Tde.map((r,a)=>s.jsx(Ee.div,{initial:{opacity:0,y:20},animate:t?{opacity:1,y:0}:{},transition:{delay:.2+a*.05,duration:.5},children:s.jsxs(f8,{value:`item-${a}`,className:"bg-card border border-border rounded-xl px-6 overflow-hidden hover:border-primary/30 transition-colors",children:[s.jsx(m8,{className:"text-left font-semibold text-foreground hover:text-primary transition-colors py-5 [&[data-state=open]]:text-primary",children:r.question}),s.jsx(p8,{className:"text-muted-foreground pb-5 leading-relaxed",children:r.answer})]})},a))})}),s.jsx(Ee.div,{className:"mt-16 text-center",initial:{opacity:0},animate:t?{opacity:1}:{},transition:{delay:.8,duration:.6},children:s.jsxs("p",{className:"text-muted-foreground",children:["No encontrou o que procurava?"," ",s.jsx("a",{href:"mailto:contato@ciclik.com.br",className:"text-primary hover:underline font-semibold",children:"Entre em contato conosco"})]})})]})})}function kde(){const e=E.useRef(null),t=zb(e,{once:!0,margin:"-100px"}),[r,a]=E.useState(!1),[n,i]=E.useState(!1),[o,c]=E.useState({nome:"",email:"",empresa:"",telefone:""}),d=async h=>{h.preventDefault(),a(!0);try{const{error:p}=await J.from("cdv_leads").insert({nome:o.nome,email:o.email,empresa:o.empresa,telefone:o.telefone||null,origem:"landing_cdv"});if(p)throw p;i(!0),ct.success("Recebemos seu interesse! Entraremos em contato em breve.")}catch(p){console.error("Erro ao enviar lead:",p),ct.error("Erro ao enviar. Por favor, tente novamente.")}finally{a(!1)}};return s.jsxs("section",{className:"py-24 relative overflow-hidden",ref:e,children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary via-primary/90 to-primary/80"}),s.jsxs("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:[s.jsx("div",{className:"absolute -top-20 -left-20 w-80 h-80 rounded-full bg-white/10 blur-3xl opacity-10"}),s.jsx("div",{className:"absolute -bottom-20 -right-20 w-96 h-96 rounded-full bg-white/10 blur-3xl opacity-15"})]}),s.jsx("div",{className:"container mx-auto px-4 relative z-10",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsxs(Ee.div,{className:"text-center mb-12",initial:{opacity:0,y:20},animate:t?{opacity:1,y:0}:{},transition:{duration:.6},children:[s.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-white/20 rounded-full text-white/90 text-sm mb-6",children:[s.jsx(cr,{className:"w-4 h-4"}),"Comece a gerar impacto hoje"]}),s.jsxs("h2",{className:"text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-6",children:["Transforme Investimento",s.jsx("br",{}),"em Impacto Real"]}),s.jsx("p",{className:"text-xl text-white/80 max-w-2xl mx-auto",children:"Preencha o formulrio e nossa equipe entrar em contato para apresentar os projetos disponveis e tirar suas dvidas."})]}),s.jsx(Ee.div,{className:"bg-white/10 backdrop-blur-md rounded-3xl p-8 md:p-12 border border-white/20",initial:{opacity:0,y:30},animate:t?{opacity:1,y:0}:{},transition:{delay:.3,duration:.6},children:n?s.jsxs(Ee.div,{className:"text-center py-8",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.4},children:[s.jsx(Ee.div,{className:"w-20 h-20 rounded-full bg-white/20 flex items-center justify-center mx-auto mb-6",animate:{scale:[1,1.1,1]},transition:{duration:1,repeat:3},children:s.jsx(_n,{className:"w-10 h-10 text-white"})}),s.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"Obrigado pelo seu interesse!"}),s.jsx("p",{className:"text-white/80",children:"Nossa equipe entrar em contato em at 24 horas teis."})]}):s.jsxs("form",{onSubmit:d,className:"space-y-6",children:[s.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"nome",className:"text-white",children:"Nome completo"}),s.jsxs("div",{className:"relative",children:[s.jsx(Ri,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-white/50"}),s.jsx(We,{id:"nome",placeholder:"Seu nome",value:o.nome,onChange:h=>c({...o,nome:h.target.value}),required:!0,className:"pl-10 bg-white/10 border-white/20 text-white placeholder:text-white/50 focus:border-white/50"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"email",className:"text-white",children:"E-mail corporativo"}),s.jsxs("div",{className:"relative",children:[s.jsx(sf,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-white/50"}),s.jsx(We,{id:"email",type:"email",placeholder:"seu@empresa.com",value:o.email,onChange:h=>c({...o,email:h.target.value}),required:!0,className:"pl-10 bg-white/10 border-white/20 text-white placeholder:text-white/50 focus:border-white/50"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"empresa",className:"text-white",children:"Empresa"}),s.jsxs("div",{className:"relative",children:[s.jsx(hn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-white/50"}),s.jsx(We,{id:"empresa",placeholder:"Nome da empresa",value:o.empresa,onChange:h=>c({...o,empresa:h.target.value}),required:!0,className:"pl-10 bg-white/10 border-white/20 text-white placeholder:text-white/50 focus:border-white/50"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"telefone",className:"text-white",children:"Telefone"}),s.jsxs("div",{className:"relative",children:[s.jsx(Bw,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-white/50"}),s.jsx(We,{id:"telefone",type:"tel",placeholder:"(00) 00000-0000",value:o.telefone,onChange:h=>c({...o,telefone:h.target.value}),className:"pl-10 bg-white/10 border-white/20 text-white placeholder:text-white/50 focus:border-white/50"})]})]})]}),s.jsx(oe,{type:"submit",size:"lg",disabled:r,className:"w-full bg-white text-primary hover:bg-white/90 text-lg py-6 rounded-xl group",children:r?s.jsxs(s.Fragment,{children:[s.jsx(_s,{className:"w-5 h-5 mr-2 animate-spin"}),"Enviando..."]}):s.jsxs(s.Fragment,{children:["Quero Ser Investidor",s.jsx(Hn,{className:"w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform"})]})}),s.jsx("p",{className:"text-center text-white/60 text-sm",children:"Ao enviar, voc concorda em receber comunicaes da Ciclik. No compartilhamos seus dados com terceiros."})]})}),s.jsx(Ee.div,{className:"mt-8 text-center",initial:{opacity:0},animate:t?{opacity:1}:{},transition:{delay:.6,duration:.6},children:s.jsxs("p",{className:"text-white/70",children:["Prefere conversar diretamente?"," ",s.jsx("a",{href:"mailto:investidores@ciclik.com.br",className:"text-white hover:underline font-semibold",children:"investidores@ciclik.com.br"})]})})]})})]})}function kv({position:e,size:t="md",opacity:r=.15,rotate:a=0,flip:n=!1,className:i=""}){const o={sm:"w-24 h-24 md:w-32 md:h-32",md:"w-32 h-32 md:w-48 md:h-48",lg:"w-48 h-48 md:w-64 md:h-64"},c={"top-left":"top-0 left-0 -translate-x-1/4 -translate-y-1/4","top-right":"top-0 right-0 translate-x-1/4 -translate-y-1/4","bottom-left":"bottom-0 left-0 -translate-x-1/4 translate-y-1/4","bottom-right":"bottom-0 right-0 translate-x-1/4 translate-y-1/4","center-left":"top-1/2 left-0 -translate-x-1/3 -translate-y-1/2","center-right":"top-1/2 right-0 translate-x-1/3 -translate-y-1/2"};return s.jsx(Ee.div,{className:`absolute pointer-events-none z-0 ${c[e]} ${i}`,initial:{opacity:0,scale:.8},whileInView:{opacity:1,scale:1},viewport:{once:!0,margin:"-50px"},transition:{duration:.8,ease:"easeOut"},children:s.jsx("img",{src:"/Ciclik_validacoes/folhas-ciclik.png",alt:"","aria-hidden":"true",className:`${o[t]} object-contain`,style:{opacity:r,transform:`rotate(${a}deg) ${n?"scaleX(-1)":""}`,filter:"blur(0.5px)"}})})}function bS(){const e=ds(),t=E.useRef(null),[r,a]=E.useState(!1),[n,i]=E.useState(!1);E.useEffect(()=>{window.scrollTo(0,0)},[]),E.useEffect(()=>{const d=()=>{a(window.scrollY>500),i(window.scrollY>50)};return window.addEventListener("scroll",d),()=>window.removeEventListener("scroll",d)},[]);const o=()=>{var d;(d=t.current)==null||d.scrollIntoView({behavior:"smooth"})},c=()=>{window.scrollTo({top:0,behavior:"smooth"})};return s.jsxs("div",{className:"min-h-screen bg-white font-body overflow-x-hidden",children:[s.jsx(Ee.header,{className:`fixed top-0 left-0 right-0 z-50 transition-all duration-300 ${n?"bg-white/95 backdrop-blur-md shadow-sm border-b border-border/30":"bg-transparent"}`,initial:{y:-100},animate:{y:0},transition:{duration:.5},children:s.jsxs("div",{className:"container mx-auto px-4 py-3 flex items-center justify-between",children:[s.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>e("/apresentacao"),className:"font-display font-medium bg-white/90 backdrop-blur-sm hover:bg-white shadow-md rounded-full gap-2",children:[s.jsx(As,{className:"w-4 h-4"}),"Voltar"]}),s.jsx("div",{className:"flex items-center",children:s.jsx("img",{src:"/Ciclik_validacoes/logo-with-slogan.png",alt:"Ciclik - Recicle e Ganhe",className:"h-10 md:h-12 w-auto object-contain",style:{filter:"drop-shadow(0 0 0 transparent)",mixBlendMode:"normal"}})}),s.jsx("div",{className:"w-20"})]})}),s.jsxs("main",{children:[s.jsx(mde,{onCtaClick:o}),s.jsxs("div",{ref:t,className:"relative",children:[s.jsx(kv,{position:"bottom-left",size:"lg",opacity:.12,rotate:15,flip:!0}),s.jsx(kv,{position:"top-right",size:"md",opacity:.1,rotate:-25}),s.jsx(kde,{})]}),s.jsxs("div",{id:"faq",className:"relative",children:[s.jsx(kv,{position:"top-right",size:"md",opacity:.08,rotate:-20}),s.jsx(Ade,{})]})]}),s.jsx("footer",{className:"bg-gradient-to-b from-muted/30 to-muted/50 border-t border-border/50 py-16",children:s.jsxs("div",{className:"container mx-auto px-4",children:[s.jsxs("div",{className:"grid md:grid-cols-4 gap-10",children:[s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("img",{src:"/Ciclik_validacoes/logo-with-slogan.png",alt:"Ciclik - Recicle e Ganhe",className:"h-14 w-auto object-contain mb-5"}),s.jsx("p",{className:"font-body text-muted-foreground text-sm max-w-md leading-relaxed",children:"Mais do que uma plataforma de benefcios, somos um movimento de transformao de comportamentos. Uma comunidade onde voc recicla e todos ganham."})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-display font-semibold text-foreground mb-5",children:"Links"}),s.jsxs("ul",{className:"space-y-3 text-sm font-body text-muted-foreground",children:[s.jsx("li",{children:s.jsx("a",{href:"#",className:"hover:text-primary transition-colors inline-flex items-center gap-2",children:"Sobre a Ciclik"})}),s.jsx("li",{children:s.jsx("a",{href:"#projetos",className:"hover:text-primary transition-colors inline-flex items-center gap-2",children:"Projetos CDV"})}),s.jsx("li",{children:s.jsx("a",{href:"#faq",className:"hover:text-primary transition-colors inline-flex items-center gap-2",children:"Perguntas Frequentes"})}),s.jsx("li",{children:s.jsx("a",{href:"/cdv/investor",className:"hover:text-primary transition-colors inline-flex items-center gap-2",children:"rea do Investidor"})})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-display font-semibold text-foreground mb-5",children:"Contato"}),s.jsxs("ul",{className:"space-y-3 text-sm font-body text-muted-foreground",children:[s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-primary",children:""}),"investidores@ciclik.com.br"]}),s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-primary",children:""}),"(11) 99999-9999"]})]})]})]}),s.jsxs("div",{className:"mt-14 pt-8 border-t border-border/50 flex flex-col md:flex-row items-center justify-between gap-4",children:[s.jsxs("p",{className:"text-sm font-body text-muted-foreground",children:[" ",new Date().getFullYear()," Ciclik. Todos os direitos reservados."]}),s.jsxs("div",{className:"flex gap-6 text-sm font-body text-muted-foreground",children:[s.jsx("a",{href:"#",className:"hover:text-primary transition-colors",children:"Termos de Uso"}),s.jsx("a",{href:"#",className:"hover:text-primary transition-colors",children:"Poltica de Privacidade"})]})]})]})}),s.jsx(Ee.div,{className:"fixed bottom-8 right-8 z-50",initial:{opacity:0,scale:.8},animate:{opacity:r?1:0,scale:r?1:.8,pointerEvents:r?"auto":"none"},transition:{duration:.2},children:s.jsx(oe,{size:"icon",className:"rounded-full w-14 h-14 bg-primary hover:brightness-105 shadow-lg hover:shadow-xl transition-all duration-300",onClick:c,children:s.jsx(u6,{className:"w-6 h-6"})})})]})}const Rde=()=>{const[e,t]=E.useState([]),[r,a]=E.useState(!0),[n,i]=E.useState(""),{toast:o}=_r(),c=ds();E.useEffect(()=>{d()},[]);const d=async()=>{try{const{data:{user:v}}=await J.auth.getUser();if(!v){c("/auth");return}const{data:b,error:N}=await J.from("cdv_investidores").select("id, razao_social, status").eq("id_user",v.id);if(N)throw N;if(!b||b.length===0){o({title:"Erro",description:"Investidor no encontrado. Entre em contato com o suporte.",variant:"destructive"});return}const _=b[0];i(_.razao_social||"");const{data:C,error:T}=await J.from("cdv_quotas").select("*").eq("id_investidor",_.id).order("data_compra",{ascending:!1});if(T)throw T;t(C||[])}catch(v){o({title:"Erro ao carregar quotas",description:v.message||"Ocorreu um erro desconhecido",variant:"destructive"})}finally{a(!1)}},h=async()=>{await J.auth.signOut(),c("/auth")},p=(v,b)=>Math.min(v/b*100,100),x=v=>{const b={em_geracao:{label:"Em Gerao",className:"bg-blue-500"},pronto:{label:"Pronto",className:"bg-green-500"},certificado_emitido:{label:"Certificado Emitido",className:"bg-purple-500"}},N=b[v]||b.em_geracao;return s.jsx(Je,{className:N.className,children:N.label})};return r?s.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-background to-primary/5",children:s.jsxs("div",{className:"flex flex-col items-center gap-4",children:[s.jsx("img",{src:Sa("ciclik-logo.png"),alt:"Ciclik",className:"h-12 animate-pulse"}),s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})]})}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-primary/5",children:[s.jsx("header",{className:"sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-border/50 shadow-sm",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 md:px-8 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("img",{src:Sa("logo-with-slogan.png"),alt:"Ciclik - Recicle e Ganhe",className:"h-16 md:h-20 object-contain"}),s.jsx("div",{className:"hidden md:block h-8 w-px bg-border/50"}),s.jsx(Je,{variant:"outline",className:"hidden md:flex bg-primary/5 text-primary border-primary/20 font-display",children:"Digital Verde"})]}),s.jsx("div",{className:"flex items-center gap-3",children:s.jsxs(oe,{variant:"outline",size:"sm",onClick:h,className:"gap-2",children:[s.jsx(gc,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Sair"})]})})]})})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 md:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"w-1.5 h-8 bg-gradient-to-b from-primary to-ciclik-orange rounded-full"}),s.jsx("h1",{className:"text-3xl md:text-4xl font-display font-bold text-foreground",children:"Meu Portflio CDV"})]}),s.jsxs("p",{className:"text-muted-foreground font-body ml-5",children:[n?`Ol, ${n}! `:"","Acompanhe seus investimentos e certificados verdes"]})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6 mb-8",children:[s.jsxs(Ne,{className:"border-primary/10 shadow-sm hover:shadow-md transition-shadow",children:[s.jsxs(Ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(Qe,{className:"text-sm font-medium font-body",children:"Total de Quotas"}),s.jsx(Qn,{className:"h-4 w-4 text-primary"})]}),s.jsx(De,{children:s.jsx("div",{className:"text-2xl font-display font-bold text-foreground",children:e.length})})]}),s.jsxs(Ne,{className:"border-primary/10 shadow-sm hover:shadow-md transition-shadow",children:[s.jsxs(Ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(Qe,{className:"text-sm font-medium font-body",children:"Investimento"}),s.jsx(Ir,{className:"h-4 w-4 text-primary"})]}),s.jsx(De,{children:s.jsxs("div",{className:"text-2xl font-display font-bold text-foreground",children:["R$ ",e.reduce((v,b)=>v+b.valor_pago,0).toLocaleString("pt-BR")]})})]}),s.jsxs(Ne,{className:"border-primary/10 shadow-sm hover:shadow-md transition-shadow",children:[s.jsxs(Ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(Qe,{className:"text-sm font-medium font-body",children:"Prontos"}),s.jsx(Qn,{className:"h-4 w-4 text-green-500"})]}),s.jsx(De,{children:s.jsx("div",{className:"text-2xl font-display font-bold text-green-600",children:e.filter(v=>v.status==="pronto"||v.status==="certificado_emitido").length})})]}),s.jsxs(Ne,{className:"border-primary/10 shadow-sm hover:shadow-md transition-shadow",children:[s.jsxs(Ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(Qe,{className:"text-sm font-medium font-body",children:"Em Gerao"}),s.jsx(cr,{className:"h-4 w-4 text-ciclik-orange"})]}),s.jsx(De,{children:s.jsx("div",{className:"text-2xl font-display font-bold text-ciclik-orange",children:e.filter(v=>v.status==="em_geracao").length})})]})]}),s.jsxs("div",{className:"space-y-6",children:[e.map(v=>{const b=p(v.kg_conciliados,v.meta_kg_residuos),N=p(v.horas_conciliadas,v.meta_horas_educacao),_=p(v.embalagens_conciliadas,v.meta_embalagens),C=(b+N+_)/3;return s.jsxs(Ne,{className:"overflow-hidden border-primary/10 shadow-sm hover:shadow-md transition-shadow",children:[s.jsx(Ye,{className:"bg-gradient-to-r from-primary/10 via-primary/5 to-transparent",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs(Qe,{className:"text-2xl font-display",children:["Quota #",v.numero_quota]}),s.jsxs(Tt,{className:"flex items-center gap-2 mt-2 font-body",children:[s.jsx(Fa,{className:"w-4 h-4"}),"Maturao em ",Ad(new Date(v.data_maturacao),{locale:$s,addSuffix:!0})]})]}),x(v.status)]})}),s.jsxs(De,{className:"p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex justify-between mb-2",children:[s.jsx("span",{className:"text-sm font-medium font-body",children:"Progresso Total"}),s.jsxs("span",{className:"text-sm font-display font-bold text-primary",children:[C.toFixed(1),"%"]})]}),s.jsx(fn,{value:C,className:"h-3"})]}),s.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"p-4 bg-primary/5 rounded-xl",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(cr,{className:"w-5 h-5 text-primary"}),s.jsx("span",{className:"font-display font-semibold",children:"Resduos"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm font-body",children:[s.jsx("span",{className:"text-muted-foreground",children:"Meta"}),s.jsxs("span",{className:"font-medium",children:[v.meta_kg_residuos," kg"]})]}),s.jsxs("div",{className:"flex justify-between text-sm font-body",children:[s.jsx("span",{className:"text-muted-foreground",children:"Conciliado"}),s.jsxs("span",{className:"font-medium text-primary",children:[v.kg_conciliados," kg"]})]}),s.jsx(fn,{value:b,className:"h-2"})]})]}),s.jsxs("div",{className:"p-4 bg-primary/5 rounded-xl",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(Xa,{className:"w-5 h-5 text-primary"}),s.jsx("span",{className:"font-display font-semibold",children:"Educao"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm font-body",children:[s.jsx("span",{className:"text-muted-foreground",children:"Meta"}),s.jsxs("span",{className:"font-medium",children:[v.meta_horas_educacao," horas"]})]}),s.jsxs("div",{className:"flex justify-between text-sm font-body",children:[s.jsx("span",{className:"text-muted-foreground",children:"Conciliado"}),s.jsxs("span",{className:"font-medium text-primary",children:[v.horas_conciliadas," horas"]})]}),s.jsx(fn,{value:N,className:"h-2"})]})]}),s.jsxs("div",{className:"p-4 bg-primary/5 rounded-xl",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(fs,{className:"w-5 h-5 text-primary"}),s.jsx("span",{className:"font-display font-semibold",children:"Embalagens"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm font-body",children:[s.jsx("span",{className:"text-muted-foreground",children:"Meta"}),s.jsxs("span",{className:"font-medium",children:[v.meta_embalagens," itens"]})]}),s.jsxs("div",{className:"flex justify-between text-sm font-body",children:[s.jsx("span",{className:"text-muted-foreground",children:"Conciliado"}),s.jsxs("span",{className:"font-medium text-primary",children:[v.embalagens_conciliadas," itens"]})]}),s.jsx(fn,{value:_,className:"h-2"})]})]})]}),(v.status==="pronto"||v.status==="certificado_emitido")&&s.jsxs("div",{className:"flex gap-4 mt-6 pt-6 border-t",children:[s.jsxs(oe,{className:"flex-1 gap-2 font-display",onClick:()=>c(`/cdv/certificate/${v.id}`),children:[s.jsx(Ua,{className:"w-4 h-4"}),"Baixar Certificado"]}),s.jsxs(oe,{variant:"outline",className:"flex-1 gap-2 font-display",onClick:()=>c(`/cdv/validate/${v.id}`),children:[s.jsx(Da,{className:"w-4 h-4"}),"Ver QR Code"]})]})]})]},v.id)}),e.length===0&&s.jsx(Ne,{className:"border-primary/10",children:s.jsxs(De,{className:"p-12 text-center",children:[s.jsx("img",{src:Sa("ciclik-logo.png"),alt:"Ciclik",className:"h-16 mx-auto mb-6 opacity-50"}),s.jsx("h3",{className:"text-xl font-display font-bold mb-2",children:"Nenhuma quota adquirida"}),s.jsx("p",{className:"text-muted-foreground font-body mb-6",children:"Comece seu investimento ambiental adquirindo sua primeira quota CDV"}),s.jsx(oe,{onClick:()=>c("/cdv"),className:"font-display",children:"Conhecer CDV"})]})})]}),s.jsxs("footer",{className:"mt-16 pt-8 border-t border-border/50 text-center",children:[s.jsx("img",{src:Sa("logo-with-slogan.png"),alt:"Ciclik",className:"h-8 mx-auto mb-3 opacity-60"}),s.jsxs("p",{className:"text-xs text-muted-foreground font-body",children:[" ",new Date().getFullYear()," Ciclik - Digital Verde. Todos os direitos reservados."]})]})]})]})},Zc="/Ciclik_validacoes/assets/ods-08-BGlMgP0n.jpg",Qc="/Ciclik_validacoes/assets/ods-09-C2hQpqXf.jpg",Jc="/Ciclik_validacoes/assets/ods-10-BX6iEeQ4.jpg",ed="/Ciclik_validacoes/assets/ods-11-D6lYXwtR.jpg",td="/Ciclik_validacoes/assets/ods-12-k0HXTbTv.jpg",sd="/Ciclik_validacoes/assets/ods-13-BYnBSpAV.jpg",Pde=()=>{var B,O,D,F;const{id:e}=To(),t=ds(),{toast:r}=_r(),[a,n]=E.useState(null),[i,o]=E.useState(!0),[c,d]=E.useState(""),h=E.useRef(null);E.useEffect(()=>{p()},[e]);const p=async()=>{try{const{data:M,error:z}=await J.from("cdv_quotas").select(`
          *,
          investidor:cdv_investidores(razao_social, cnpj, nome_responsavel),
          projeto:cdv_projetos(titulo)
        `).eq("id",e).single();if(z)throw z;n(M);const q=Il(`/cdv/validate/${e}`),Y=await kd({data:q,width:200,margin:2});d(Y)}catch(M){r({title:"Erro ao carregar certificado",description:M.message,variant:"destructive"})}finally{o(!1)}},x=async()=>{if(!(!h.current||!a))try{const M=(await Ov(async()=>{const{default:ye}=await import("./pdf-vendor-CF3S67IK.js").then(W=>W.h);return{default:ye}},__vite__mapDeps([0,1,2,3]))).default,z=(await Ov(async()=>{const{default:ye}=await import("./pdf-vendor-CF3S67IK.js").then(W=>W.j);return{default:ye}},__vite__mapDeps([0,1,2,3]))).default,q=210,Y=297,ae=h.current.querySelector("[data-qr-container]");ae&&(ae.style.visibility="hidden"),await new Promise(ye=>setTimeout(ye,100));const je=await M(h.current,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff",windowWidth:794,logging:!1});ae&&(ae.style.visibility="visible");const H=new z("p","mm","a4"),Z=je.toDataURL("image/png"),G=q,Q=je.height*G/je.width;let re=0,le=1;if(Q>Y){le=Y/Q;const ye=G*le,W=Y,ee=(q-ye)/2;H.addImage(Z,"PNG",ee,0,ye,W)}else re=(Y-Q)/2,H.addImage(Z,"PNG",0,re,G,Q);if(c){const W=q-55,ee=Q>Y?Y-65:re+Q-65;H.addImage(c,"PNG",W,ee,25,25)}H.save(`Certificado_CDV_${a.numero_quota}.pdf`),r({title:"Certificado baixado!",description:"O PDF foi salvo com sucesso."})}catch(M){console.error("Erro ao gerar PDF:",M),r({title:"Erro ao gerar PDF",description:M.message,variant:"destructive"})}};if(i)return s.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-background to-primary/5",children:s.jsxs("div",{className:"flex flex-col items-center gap-4",children:[s.jsx("img",{src:Sa("ciclik-logo.png"),alt:"Ciclik",className:"h-12 animate-pulse"}),s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})]})});if(!a)return s.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gradient-to-br from-background to-primary/5",children:s.jsxs(Ne,{className:"p-8 text-center border-primary/10",children:[s.jsx("img",{src:Sa("ciclik-logo.png"),alt:"Ciclik",className:"h-12 mx-auto mb-4 opacity-50"}),s.jsx(Qn,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-display font-bold mb-2",children:"Certificado no encontrado"}),s.jsx(oe,{onClick:()=>t("/cdv/investor"),className:"font-display",children:"Voltar"})]})});const v=new Date,b=a!=null&&a.created_at?new Date(a.created_at):v,N=(a==null?void 0:a.kg_conciliados)||0,_=(a==null?void 0:a.horas_conciliadas)||0;a!=null&&a.embalagens_conciliadas;const C=(N*2.5).toFixed(0),T=Math.ceil(N/200),A=(N*4.5).toFixed(0),k=(N*90).toFixed(0),I=Math.ceil(N/3+_*10);return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-primary/5",children:[s.jsx("header",{className:"sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-border/50 shadow-sm",children:s.jsx("div",{className:"max-w-4xl mx-auto px-4 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("img",{src:Sa("ciclik-logo-full.png"),alt:"Ciclik",className:"h-9 object-contain"}),s.jsx("div",{className:"h-6 w-px bg-border/50"}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(vi,{className:"w-4 h-4 text-primary"}),s.jsx("span",{className:"text-sm font-display font-medium text-primary",children:"Certificado"})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>t("/cdv/investor"),className:"gap-2 font-display",children:[s.jsx(As,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Voltar"})]}),s.jsxs(oe,{size:"sm",onClick:x,className:"gap-2 font-display",children:[s.jsx(Ua,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Baixar PDF"})]})]})]})})}),s.jsx("div",{className:"max-w-4xl mx-auto p-4 md:p-8",children:s.jsx("div",{ref:h,className:"bg-white rounded-2xl overflow-hidden shadow-lg",children:s.jsxs(Ne,{className:"border-0 overflow-hidden shadow-2xl bg-white",children:[s.jsx("div",{className:"bg-gradient-to-r from-slate-800 to-slate-700 text-white",children:s.jsxs("div",{className:"px-8 py-8",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("div",{className:"flex items-center gap-3",children:s.jsx("img",{src:Sa("logo-with-slogan.png"),alt:"Ciclik",className:"h-12 object-contain"})}),s.jsxs(Je,{className:"bg-white/20 text-white border-0 px-4 py-2 backdrop-blur-sm",children:[s.jsx(vi,{className:"w-4 h-4 mr-2"}),"Certificado Oficial #",a.numero_quota]})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-4xl font-display font-bold mb-2",children:"Certificado Digital Verde"}),s.jsx("p",{className:"text-lg opacity-90",children:"Comprovao de Impacto Ambiental Mensurvel"})]})]})}),s.jsxs(De,{className:"p-8 space-y-6",children:[s.jsxs("div",{className:"border-l-4 border-primary pl-6 py-4 bg-muted/30",children:[s.jsx("p",{className:"text-sm text-muted-foreground font-body mb-2 uppercase tracking-wider",children:"Certificado emitido para"}),s.jsx("h2",{className:"text-3xl font-display font-bold text-foreground mb-1",children:((B=a.investidor)==null?void 0:B.razao_social)||"Investidor"}),s.jsxs("p",{className:"text-muted-foreground font-body",children:["CNPJ: ",((O=a.investidor)==null?void 0:O.cnpj)||"N/A","  Responsvel: ",((D=a.investidor)==null?void 0:D.nome_responsavel)||"N/A"]})]}),s.jsx("div",{className:"border rounded-lg overflow-hidden",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-primary/5",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-left p-4 font-display font-semibold",children:"Categoria de Impacto"}),s.jsx("th",{className:"text-right p-4 font-display font-semibold",children:"Valor Certificado"})]})}),s.jsxs("tbody",{children:[s.jsxs("tr",{className:"border-t",children:[s.jsxs("td",{className:"p-4 flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:s.jsx(cr,{className:"w-5 h-5 text-primary"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-display font-medium",children:"Resduos Reciclados"}),s.jsx("p",{className:"text-xs text-muted-foreground font-body",children:"Material desviado de aterros"})]})]}),s.jsx("td",{className:"p-4 text-right",children:s.jsxs("span",{className:"text-2xl font-display font-bold text-primary",children:[a.kg_conciliados," kg"]})})]}),s.jsxs("tr",{className:"border-t bg-muted/20",children:[s.jsxs("td",{className:"p-4 flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:s.jsx(Xa,{className:"w-5 h-5 text-primary"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-display font-medium",children:"Educao Ambiental"}),s.jsx("p",{className:"text-xs text-muted-foreground font-body",children:"Horas de conscientizao"})]})]}),s.jsx("td",{className:"p-4 text-right",children:s.jsxs("span",{className:"text-2xl font-display font-bold text-primary",children:[a.horas_conciliadas,"h"]})})]}),s.jsxs("tr",{className:"border-t",children:[s.jsxs("td",{className:"p-4 flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:s.jsx(fs,{className:"w-5 h-5 text-primary"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-display font-medium",children:"Embalagens Mapeadas"}),s.jsx("p",{className:"text-xs text-muted-foreground font-body",children:"Rastreabilidade logstica"})]})]}),s.jsx("td",{className:"p-4 text-right",children:s.jsx("span",{className:"text-2xl font-display font-bold text-primary",children:a.embalagens_conciliadas})})]})]})]})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-display font-bold mb-3 text-muted-foreground uppercase tracking-wider",children:"Equivalncia de Impacto Ambiental"}),s.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[s.jsxs("div",{className:"bg-white border border-blue-200 rounded-lg p-3 text-center shadow-sm",children:[s.jsx(Hc,{className:"w-6 h-6 text-blue-600 mx-auto mb-1"}),s.jsx("p",{className:"text-xl font-display font-bold text-blue-700",children:Number(C).toLocaleString("pt-BR")}),s.jsx("p",{className:"text-[10px] text-blue-600 uppercase",children:"kg CO"})]}),s.jsxs("div",{className:"bg-white border border-green-200 rounded-lg p-3 text-center shadow-sm",children:[s.jsx(eu,{className:"w-6 h-6 text-green-600 mx-auto mb-1"}),s.jsx("p",{className:"text-xl font-display font-bold text-green-700",children:T.toLocaleString("pt-BR")}),s.jsx("p",{className:"text-[10px] text-green-600 uppercase",children:"rvores"})]}),s.jsxs("div",{className:"bg-white border border-yellow-200 rounded-lg p-3 text-center shadow-sm",children:[s.jsx(Go,{className:"w-6 h-6 text-yellow-600 mx-auto mb-1"}),s.jsx("p",{className:"text-xl font-display font-bold text-yellow-700",children:Number(A).toLocaleString("pt-BR")}),s.jsx("p",{className:"text-[10px] text-yellow-600 uppercase",children:"kWh"})]}),s.jsxs("div",{className:"bg-white border border-cyan-200 rounded-lg p-3 text-center shadow-sm",children:[s.jsx(Gc,{className:"w-6 h-6 text-cyan-600 mx-auto mb-1"}),s.jsx("p",{className:"text-xl font-display font-bold text-cyan-700",children:Number(k).toLocaleString("pt-BR")}),s.jsx("p",{className:"text-[10px] text-cyan-600 uppercase",children:"litros"})]}),s.jsxs("div",{className:"bg-white border border-purple-200 rounded-lg p-3 text-center shadow-sm",children:[s.jsx(oa,{className:"w-6 h-6 text-purple-600 mx-auto mb-1"}),s.jsx("p",{className:"text-xl font-display font-bold text-purple-700",children:I.toLocaleString("pt-BR")}),s.jsx("p",{className:"text-[10px] text-purple-600 uppercase",children:"pessoas"})]})]})]}),s.jsxs("div",{className:"border-t pt-6",children:[s.jsx("p",{className:"text-xs text-muted-foreground font-body text-center mb-3 uppercase tracking-wider",children:"Contribuio ODS da ONU - Agenda 2030"}),s.jsxs("div",{className:"flex justify-center gap-2",children:[s.jsx("img",{src:Zc,alt:"ODS 8",className:"w-14 h-14 rounded-lg"}),s.jsx("img",{src:Qc,alt:"ODS 9",className:"w-14 h-14 rounded-lg"}),s.jsx("img",{src:Jc,alt:"ODS 10",className:"w-14 h-14 rounded-lg"}),s.jsx("img",{src:ed,alt:"ODS 11",className:"w-14 h-14 rounded-lg"}),s.jsx("img",{src:td,alt:"ODS 12",className:"w-14 h-14 rounded-lg"}),s.jsx("img",{src:sd,alt:"ODS 13",className:"w-14 h-14 rounded-lg"})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-6 border-t pt-6 items-center","data-qr-container":!0,children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-muted-foreground font-body mb-1",children:"Emitido em"}),s.jsx("p",{className:"font-display font-semibold",children:Os(b,"dd/MM/yyyy",{locale:$s})}),s.jsx("p",{className:"text-xs text-muted-foreground font-body mt-2",children:"Projeto"}),s.jsx("p",{className:"font-display font-medium text-sm",children:((F=a.projeto)==null?void 0:F.titulo)||"CDV"})]}),s.jsx("div",{className:"flex justify-center",children:c&&s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-28 h-28 bg-white rounded-xl border-2 border-muted p-2 shadow-sm",children:s.jsx("img",{src:c,alt:"QR Code de Validao",className:"w-full h-full"})}),s.jsx("p",{className:"text-[10px] text-muted-foreground font-body text-center mt-1",children:"QR Code de Validao"})]})}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-xs text-muted-foreground font-body mb-1",children:"Perodo de Validade"}),s.jsxs("p",{className:"font-display font-semibold text-sm",children:[Os(new Date(a.data_compra),"MMM/yy",{locale:$s})," - ",Os(new Date(a.data_maturacao),"MMM/yy",{locale:$s})]}),s.jsx("p",{className:"text-xs text-muted-foreground font-body mt-2",children:"Verificvel em"}),s.jsx("p",{className:"font-display font-medium text-sm text-primary",children:"ciclik.com.br"})]})]})]})]})})})]})},Ide=()=>{const e=ds(),[t,r]=E.useState("v1"),a={numero_quota:"CIC-0001",razao_social:"Empresa Exemplo Ltda",cnpj:"12.345.678/0001-90",nome_responsavel:"Joo Silva",projeto_titulo:"Ciclik Digital Verde",kg_reciclados:512,horas_educacao:25,embalagens_mapeadas:128,data_geracao:new Date,data_compra:new Date(2025,0,1),data_maturacao:new Date(2026,0,1)},n=(a.kg_reciclados*2.5).toFixed(0),i=Math.ceil(a.kg_reciclados/200),o=(a.kg_reciclados*4.5).toFixed(0),c=(a.kg_reciclados*90).toFixed(0),d=Math.ceil(a.kg_reciclados/3+a.horas_educacao*10),h=()=>s.jsxs(Ne,{className:"border-0 overflow-hidden shadow-2xl max-w-4xl mx-auto",children:[s.jsxs("div",{className:"bg-gradient-to-r from-primary via-primary/95 to-primary/85 text-white relative overflow-hidden",children:[s.jsxs("div",{className:"absolute inset-0 opacity-10",children:[s.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-white rounded-full -translate-y-1/2 translate-x-1/2"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-72 h-72 bg-white rounded-full translate-y-1/2 -translate-x-1/2"})]}),s.jsxs("div",{className:"relative z-10 px-8 py-10",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",children:s.jsx(cr,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsx("span",{className:"text-2xl font-display font-bold tracking-wide",children:"ciclik"}),s.jsx("p",{className:"text-xs opacity-90",children:"Recicle e Ganhe"})]})]}),s.jsxs(Je,{className:"bg-white/20 text-white border-white/30 backdrop-blur-sm px-4 py-2",children:[s.jsx(vi,{className:"w-4 h-4 mr-2"}),"Certificado Oficial"]})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-4xl font-display font-bold mb-2 tracking-tight",children:"Certificado Digital Verde"}),s.jsx("p",{className:"text-lg opacity-90 font-body",children:"Impacto Ambiental Verificvel e Auditado"})]})]})]}),s.jsxs(De,{className:"p-8 space-y-8",children:[s.jsxs("div",{className:"text-center space-y-4",children:[s.jsxs("div",{className:"inline-flex items-center gap-2 bg-primary/10 text-primary px-6 py-2 rounded-full",children:[s.jsx(Qn,{className:"w-5 h-5"}),s.jsxs("span",{className:"font-display font-bold text-lg",children:["#",a.numero_quota]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h2",{className:"text-3xl font-display font-bold text-foreground",children:a.razao_social}),s.jsxs("p",{className:"text-muted-foreground font-body",children:["CNPJ: ",a.cnpj]})]}),s.jsxs("div",{className:"inline-flex items-center gap-3 bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-500/20 rounded-full px-6 py-3 shadow-sm",children:[s.jsx(Tr,{className:"w-6 h-6 text-green-600"}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"font-display font-bold text-green-700",children:"Certificado Vlido"}),s.jsx("p",{className:"text-xs text-green-600",children:"Impacto verificado e auditado"})]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-display font-bold text-center mb-6 text-foreground",children:"Impactos Ambientais Certificados"}),s.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"bg-gradient-to-br from-primary/20 via-primary/10 to-primary/5 border-2 border-primary/30 rounded-2xl p-6 text-center transform hover:scale-105 transition-transform",children:[s.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-primary to-primary/80 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:s.jsx(cr,{className:"w-8 h-8 text-white"})}),s.jsxs("p",{className:"text-4xl font-display font-bold text-primary mb-2",children:[a.kg_reciclados.toLocaleString("pt-BR")," kg"]}),s.jsx("p",{className:"text-sm text-muted-foreground font-body font-semibold",children:"Resduos Reciclados"})]}),s.jsxs("div",{className:"bg-gradient-to-br from-blue-100/50 via-blue-50 to-blue-100/30 border-2 border-blue-300/50 rounded-2xl p-6 text-center transform hover:scale-105 transition-transform",children:[s.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:s.jsx(Xa,{className:"w-8 h-8 text-white"})}),s.jsxs("p",{className:"text-4xl font-display font-bold text-blue-700 mb-2",children:[a.horas_educacao," horas"]}),s.jsx("p",{className:"text-sm text-muted-foreground font-body font-semibold",children:"Educao Ambiental"})]}),s.jsxs("div",{className:"bg-gradient-to-br from-amber-100/50 via-amber-50 to-amber-100/30 border-2 border-amber-300/50 rounded-2xl p-6 text-center transform hover:scale-105 transition-transform",children:[s.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-amber-500 to-amber-600 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:s.jsx(fs,{className:"w-8 h-8 text-white"})}),s.jsx("p",{className:"text-4xl font-display font-bold text-amber-700 mb-2",children:a.embalagens_mapeadas.toLocaleString("pt-BR")}),s.jsx("p",{className:"text-sm text-muted-foreground font-body font-semibold",children:"Embalagens Mapeadas"})]})]})]}),s.jsxs("div",{className:"bg-gradient-to-br from-muted/50 to-muted/20 rounded-2xl p-6 border",children:[s.jsx("h3",{className:"text-lg font-display font-bold text-center mb-4 text-foreground",children:"Equivalncia de Impacto Ambiental"}),s.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[s.jsxs("div",{className:"bg-white border border-blue-200 rounded-xl p-4 text-center shadow-sm",children:[s.jsx(Hc,{className:"w-8 h-8 text-blue-600 mx-auto mb-2"}),s.jsx("p",{className:"text-2xl font-display font-bold text-blue-700",children:Number(n).toLocaleString("pt-BR")}),s.jsxs("p",{className:"text-xs text-blue-600 font-body mt-1",children:["kg de CO",s.jsx("br",{}),"evitados"]})]}),s.jsxs("div",{className:"bg-white border border-green-200 rounded-xl p-4 text-center shadow-sm",children:[s.jsx(eu,{className:"w-8 h-8 text-green-600 mx-auto mb-2"}),s.jsx("p",{className:"text-2xl font-display font-bold text-green-700",children:i}),s.jsxs("p",{className:"text-xs text-green-600 font-body mt-1",children:["rvores",s.jsx("br",{}),"preservadas"]})]}),s.jsxs("div",{className:"bg-white border border-yellow-200 rounded-xl p-4 text-center shadow-sm",children:[s.jsx(Go,{className:"w-8 h-8 text-yellow-600 mx-auto mb-2"}),s.jsx("p",{className:"text-2xl font-display font-bold text-yellow-700",children:Number(o).toLocaleString("pt-BR")}),s.jsxs("p",{className:"text-xs text-yellow-600 font-body mt-1",children:["kWh de",s.jsx("br",{}),"energia"]})]}),s.jsxs("div",{className:"bg-white border border-cyan-200 rounded-xl p-4 text-center shadow-sm",children:[s.jsx(Gc,{className:"w-8 h-8 text-cyan-600 mx-auto mb-2"}),s.jsx("p",{className:"text-2xl font-display font-bold text-cyan-700",children:Number(c).toLocaleString("pt-BR")}),s.jsxs("p",{className:"text-xs text-cyan-600 font-body mt-1",children:["litros de",s.jsx("br",{}),"gua"]})]}),s.jsxs("div",{className:"bg-white border border-purple-200 rounded-xl p-4 text-center shadow-sm",children:[s.jsx(oa,{className:"w-8 h-8 text-purple-600 mx-auto mb-2"}),s.jsx("p",{className:"text-2xl font-display font-bold text-purple-700",children:d}),s.jsxs("p",{className:"text-xs text-purple-600 font-body mt-1",children:["pessoas",s.jsx("br",{}),"impactadas"]})]})]}),s.jsxs("div",{className:"mt-4 flex items-center justify-center gap-2 text-sm text-muted-foreground font-body bg-white/50 rounded-lg py-3 px-4",children:[s.jsx(Ir,{className:"w-4 h-4 text-primary"}),s.jsxs("span",{children:["Estimativa de ",s.jsxs("strong",{className:"text-foreground",children:[d," cidados"]})," em processo de mudana de comportamento ambiental"]})]})]}),s.jsxs("div",{className:"border-t pt-6",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsxs("div",{className:"inline-flex items-center gap-2 mb-2",children:[s.jsx(Eh,{className:"w-5 h-5 text-primary"}),s.jsx("h3",{className:"text-lg font-display font-bold text-foreground",children:"Objetivos de Desenvolvimento Sustentvel"})]}),s.jsx("p",{className:"text-sm text-muted-foreground font-body",children:"Contribuio direta para as ODS da ONU - Agenda 2030"})]}),s.jsxs("div",{className:"flex justify-center gap-3 flex-wrap",children:[s.jsx("img",{src:Zc,alt:"ODS 8",className:"w-20 h-20 rounded-lg shadow-md hover:scale-110 transition-transform"}),s.jsx("img",{src:Qc,alt:"ODS 9",className:"w-20 h-20 rounded-lg shadow-md hover:scale-110 transition-transform"}),s.jsx("img",{src:Jc,alt:"ODS 10",className:"w-20 h-20 rounded-lg shadow-md hover:scale-110 transition-transform"}),s.jsx("img",{src:ed,alt:"ODS 11",className:"w-20 h-20 rounded-lg shadow-md hover:scale-110 transition-transform"}),s.jsx("img",{src:td,alt:"ODS 12",className:"w-20 h-20 rounded-lg shadow-md hover:scale-110 transition-transform"}),s.jsx("img",{src:sd,alt:"ODS 13",className:"w-20 h-20 rounded-lg shadow-md hover:scale-110 transition-transform"})]})]}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-6 border-t pt-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-3 p-4 bg-muted/50 rounded-xl border",children:[s.jsx(hn,{className:"w-5 h-5 text-primary"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-muted-foreground font-body",children:"Projeto"}),s.jsx("p",{className:"font-display font-semibold",children:a.projeto_titulo})]})]}),s.jsxs("div",{className:"flex items-center gap-3 p-4 bg-muted/50 rounded-xl border",children:[s.jsx(Fa,{className:"w-5 h-5 text-primary"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-muted-foreground font-body",children:"Perodo de Maturao"}),s.jsxs("p",{className:"font-display font-semibold",children:[Os(a.data_compra,"dd/MM/yyyy",{locale:$s})," - ",Os(a.data_maturacao,"dd/MM/yyyy",{locale:$s})]})]})]}),s.jsxs("div",{className:"flex items-center gap-3 p-4 bg-muted/50 rounded-xl border",children:[s.jsx(jl,{className:"w-5 h-5 text-primary"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-muted-foreground font-body",children:"Data de Emisso"}),s.jsx("p",{className:"font-display font-semibold",children:Os(a.data_geracao,"dd/MM/yyyy 's' HH:mm",{locale:$s})})]})]})]}),s.jsxs("div",{className:"flex flex-col items-center justify-center bg-gradient-to-br from-primary/5 to-primary/10 rounded-xl border-2 border-primary/20 p-6",children:[s.jsx("div",{className:"w-48 h-48 bg-white rounded-xl shadow-lg flex items-center justify-center mb-4 border-2 border-primary/20",children:s.jsx("div",{className:"w-44 h-44 bg-white p-2",children:s.jsx("div",{className:"grid grid-cols-8 gap-0.5 w-full h-full",children:Array.from({length:64}).map((_,C)=>s.jsx("div",{className:`${Math.random()>.5?"bg-black":"bg-white"} rounded-sm`},C))})})}),s.jsxs("p",{className:"text-sm text-center text-muted-foreground font-body",children:["Escaneie para validar a autenticidade",s.jsx("br",{}),"deste certificado em tempo real"]})]})]}),s.jsxs("div",{className:"border-t pt-6",children:[s.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground font-body",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("img",{src:Sa("ciclik-logo.png"),alt:"Ciclik",className:"h-6 opacity-60"}),s.jsx("span",{children:"Certificado de Impacto Ambiental Verificvel"})]}),s.jsxs("span",{className:"font-mono",children:["ID: ",a.numero_quota]})]}),s.jsxs("p",{className:"text-center text-xs text-muted-foreground mt-4",children:["Este certificado comprova o investimento e gerao de impacto ambiental real, mensurvel e auditado.",s.jsx("br",{}),"Vlido permanentemente  Validao pblica disponvel em ",s.jsx("strong",{children:"ciclik.com.br"})]})]})]})]}),p=()=>s.jsxs(Ne,{className:"border-0 overflow-hidden shadow-2xl max-w-4xl mx-auto bg-white",children:[s.jsx("div",{className:"bg-white border-b-4 border-primary",children:s.jsxs("div",{className:"px-8 py-8",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-3xl font-display font-bold text-primary",children:"ciclik"}),s.jsx(cr,{className:"w-6 h-6 text-ciclik-orange"})]}),s.jsx(Je,{variant:"outline",className:"border-primary text-primary px-4 py-2",children:"Certificado #CIC-0001"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-5xl font-display font-bold mb-3 text-foreground",children:"Certificado Digital Verde"}),s.jsx("p",{className:"text-lg text-muted-foreground font-body",children:"Comprova Impacto Ambiental Real e Mensurvel"})]})]})}),s.jsxs(De,{className:"p-8 space-y-8",children:[s.jsxs("div",{className:"text-center space-y-3",children:[s.jsx("p",{className:"text-sm text-muted-foreground font-body uppercase tracking-wider",children:"Certificado emitido para"}),s.jsx("h2",{className:"text-4xl font-display font-bold text-foreground",children:a.razao_social}),s.jsxs("p",{className:"text-muted-foreground font-body",children:["CNPJ: ",a.cnpj]})]}),s.jsx("div",{className:"bg-gradient-to-r from-primary/5 via-primary/10 to-primary/5 rounded-2xl p-8",children:s.jsxs("div",{className:"grid grid-cols-3 gap-8 text-center",children:[s.jsxs("div",{children:[s.jsx(cr,{className:"w-12 h-12 text-primary mx-auto mb-3"}),s.jsx("p",{className:"text-5xl font-display font-bold text-primary mb-2",children:a.kg_reciclados}),s.jsx("p",{className:"text-sm text-muted-foreground font-body",children:"kg reciclados"})]}),s.jsxs("div",{children:[s.jsx(Xa,{className:"w-12 h-12 text-blue-600 mx-auto mb-3"}),s.jsx("p",{className:"text-5xl font-display font-bold text-blue-600 mb-2",children:a.horas_educacao}),s.jsx("p",{className:"text-sm text-muted-foreground font-body",children:"horas de educao"})]}),s.jsxs("div",{children:[s.jsx(fs,{className:"w-12 h-12 text-amber-600 mx-auto mb-3"}),s.jsx("p",{className:"text-5xl font-display font-bold text-amber-600 mb-2",children:a.embalagens_mapeadas}),s.jsx("p",{className:"text-sm text-muted-foreground font-body",children:"embalagens mapeadas"})]})]})}),s.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[s.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-xl",children:[s.jsx(Hc,{className:"w-8 h-8 text-blue-600 mx-auto mb-2"}),s.jsx("p",{className:"text-xl font-display font-bold text-blue-700",children:n}),s.jsx("p",{className:"text-xs text-blue-600",children:"kg CO"})]}),s.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-xl",children:[s.jsx(eu,{className:"w-8 h-8 text-green-600 mx-auto mb-2"}),s.jsx("p",{className:"text-xl font-display font-bold text-green-700",children:i}),s.jsx("p",{className:"text-xs text-green-600",children:"rvores"})]}),s.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-xl",children:[s.jsx(Go,{className:"w-8 h-8 text-yellow-600 mx-auto mb-2"}),s.jsx("p",{className:"text-xl font-display font-bold text-yellow-700",children:o}),s.jsx("p",{className:"text-xs text-yellow-600",children:"kWh"})]}),s.jsxs("div",{className:"text-center p-4 bg-cyan-50 rounded-xl",children:[s.jsx(Gc,{className:"w-8 h-8 text-cyan-600 mx-auto mb-2"}),s.jsx("p",{className:"text-xl font-display font-bold text-cyan-700",children:c}),s.jsx("p",{className:"text-xs text-cyan-600",children:"litros"})]}),s.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-xl",children:[s.jsx(oa,{className:"w-8 h-8 text-purple-600 mx-auto mb-2"}),s.jsx("p",{className:"text-xl font-display font-bold text-purple-700",children:d}),s.jsx("p",{className:"text-xs text-purple-600",children:"pessoas"})]})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("h3",{className:"text-sm font-display font-bold mb-4 text-muted-foreground uppercase tracking-wider",children:"Contribuio ODS da ONU"}),s.jsx("div",{className:"flex justify-center gap-2",children:[Zc,Qc,Jc,ed,td,sd].map((_,C)=>s.jsx("img",{src:_,alt:`ODS ${C+8}`,className:"w-16 h-16 rounded-lg"},C))})]}),s.jsxs("div",{className:"border-t pt-6 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-muted-foreground font-body",children:"Emitido em"}),s.jsx("p",{className:"font-display font-semibold",children:Os(a.data_geracao,"dd/MM/yyyy",{locale:$s})})]}),s.jsx("div",{className:"w-32 h-32 bg-white rounded-xl border-2 border-muted p-2 flex items-center justify-center",children:s.jsx("div",{className:"grid grid-cols-8 gap-0.5 w-full h-full",children:Array.from({length:64}).map((_,C)=>s.jsx("div",{className:`${Math.random()>.5?"bg-black":"bg-white"} rounded-sm`},C))})}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-xs text-muted-foreground font-body",children:"Vlido permanentemente"}),s.jsx("p",{className:"font-display font-semibold",children:"ciclik.com.br"})]})]})]})]}),x=()=>s.jsxs(Ne,{className:"border-0 overflow-hidden shadow-2xl max-w-4xl mx-auto bg-gradient-to-br from-white via-primary/5 to-white",children:[s.jsxs("div",{className:"relative bg-gradient-to-r from-primary/95 via-primary to-primary/90 text-white overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 opacity-10",children:s.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}})}),s.jsxs("div",{className:"relative z-10 px-8 py-12",children:[s.jsxs("div",{className:"flex items-start justify-between mb-8",children:[s.jsx("div",{children:s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center backdrop-blur-sm",children:s.jsx(cr,{className:"w-8 h-8 text-white"})}),s.jsxs("div",{children:[s.jsx("span",{className:"text-3xl font-display font-bold",children:"ciclik"}),s.jsx("p",{className:"text-sm opacity-90",children:"Digital Verde"})]})]})}),s.jsxs("div",{className:"text-right",children:[s.jsxs(Je,{className:"bg-white text-primary border-0 px-4 py-2 mb-2",children:["#",a.numero_quota]}),s.jsx("p",{className:"text-xs opacity-75",children:"Certificado Oficial"})]})]}),s.jsxs("div",{className:"text-center max-w-2xl mx-auto",children:[s.jsx("div",{className:"inline-block p-1 bg-white/20 rounded-full backdrop-blur-sm mb-4",children:s.jsx(Tr,{className:"w-8 h-8 text-white"})}),s.jsx("h1",{className:"text-5xl font-display font-bold mb-3",children:"Certificado Digital Verde"}),s.jsx("p",{className:"text-lg opacity-95",children:"Comprova impacto ambiental real, mensurvel e auditado"})]})]})]}),s.jsxs(De,{className:"p-10 space-y-10",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-sm text-muted-foreground font-body mb-3 uppercase tracking-widest",children:"Certificado emitido para"}),s.jsx("h2",{className:"text-4xl font-display font-bold text-foreground mb-2",children:a.razao_social}),s.jsxs("p",{className:"text-lg text-muted-foreground font-body",children:["CNPJ: ",a.cnpj]})]}),s.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary to-primary/70 rounded-2xl blur-xl opacity-20 group-hover:opacity-30 transition-opacity"}),s.jsxs("div",{className:"relative bg-white border-2 border-primary/20 rounded-2xl p-8 text-center",children:[s.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-primary to-primary/80 rounded-full flex items-center justify-center mx-auto mb-6 shadow-xl",children:s.jsx(cr,{className:"w-10 h-10 text-white"})}),s.jsx("p",{className:"text-5xl font-display font-bold text-primary mb-3",children:a.kg_reciclados}),s.jsx("p",{className:"text-sm text-muted-foreground font-body uppercase tracking-wider",children:"kg de resduos reciclados"})]})]}),s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500 to-blue-400 rounded-2xl blur-xl opacity-20 group-hover:opacity-30 transition-opacity"}),s.jsxs("div",{className:"relative bg-white border-2 border-blue-200 rounded-2xl p-8 text-center",children:[s.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-xl",children:s.jsx(Xa,{className:"w-10 h-10 text-white"})}),s.jsx("p",{className:"text-5xl font-display font-bold text-blue-600 mb-3",children:a.horas_educacao}),s.jsx("p",{className:"text-sm text-muted-foreground font-body uppercase tracking-wider",children:"horas de educao ambiental"})]})]}),s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-500 to-amber-400 rounded-2xl blur-xl opacity-20 group-hover:opacity-30 transition-opacity"}),s.jsxs("div",{className:"relative bg-white border-2 border-amber-200 rounded-2xl p-8 text-center",children:[s.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-amber-500 to-amber-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-xl",children:s.jsx(fs,{className:"w-10 h-10 text-white"})}),s.jsx("p",{className:"text-5xl font-display font-bold text-amber-600 mb-3",children:a.embalagens_mapeadas}),s.jsx("p",{className:"text-sm text-muted-foreground font-body uppercase tracking-wider",children:"embalagens rastreadas"})]})]})]}),s.jsxs("div",{className:"bg-gradient-to-br from-muted/50 to-background rounded-3xl p-8 border-2 border-border/50",children:[s.jsx("h3",{className:"text-2xl font-display font-bold text-center mb-8 text-foreground",children:"Equivalncia de Impacto Ambiental"}),s.jsx("div",{className:"grid grid-cols-5 gap-4",children:[{icon:Hc,value:n,label:"kg CO",color:"blue"},{icon:eu,value:i,label:"rvores",color:"green"},{icon:Go,value:o,label:"kWh",color:"yellow"},{icon:Gc,value:c,label:"litros",color:"cyan"},{icon:oa,value:d,label:"pessoas",color:"purple"}].map((_,C)=>s.jsxs("div",{className:`bg-${_.color}-50 border-2 border-${_.color}-200 rounded-2xl p-6 text-center hover:scale-105 transition-transform`,children:[s.jsx(_.icon,{className:`w-10 h-10 text-${_.color}-600 mx-auto mb-3`}),s.jsx("p",{className:`text-3xl font-display font-bold text-${_.color}-700 mb-2`,children:typeof _.value=="string"?Number(_.value).toLocaleString("pt-BR"):_.value}),s.jsx("p",{className:`text-xs text-${_.color}-600 font-body`,children:_.label})]},C))})]}),s.jsxs("div",{className:"text-center space-y-6",children:[s.jsxs("div",{children:[s.jsx(Eh,{className:"w-12 h-12 text-primary mx-auto mb-4"}),s.jsx("h3",{className:"text-2xl font-display font-bold mb-2 text-foreground",children:"Objetivos de Desenvolvimento Sustentvel"}),s.jsx("p",{className:"text-muted-foreground font-body",children:"Contribuio verificada para a Agenda 2030 da ONU"})]}),s.jsx("div",{className:"flex justify-center gap-4",children:[Zc,Qc,Jc,ed,td,sd].map((_,C)=>s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute inset-0 bg-primary rounded-xl blur-lg opacity-0 group-hover:opacity-20 transition-opacity"}),s.jsx("img",{src:_,alt:`ODS ${C+8}`,className:"relative w-24 h-24 rounded-xl shadow-lg hover:scale-110 transition-transform"})]},C))})]}),s.jsxs("div",{className:"flex items-center justify-between border-t-2 pt-8",children:[s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"text-sm text-muted-foreground font-body mb-1",children:"Emitido em"}),s.jsx("p",{className:"text-xl font-display font-bold",children:Os(a.data_geracao,"dd/MM/yyyy",{locale:$s})})]}),s.jsx("div",{className:"text-center",children:s.jsx("div",{className:"w-40 h-40 bg-gradient-to-br from-primary/10 to-primary/5 rounded-2xl flex items-center justify-center border-2 border-primary/20 p-3",children:s.jsx("div",{className:"grid grid-cols-8 gap-0.5 w-full h-full",children:Array.from({length:64}).map((_,C)=>s.jsx("div",{className:`${Math.random()>.5?"bg-black":"bg-white"} rounded-sm`},C))})})}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-sm text-muted-foreground font-body mb-1",children:"Vlido permanentemente"}),s.jsx("p",{className:"text-xl font-display font-bold text-primary",children:"ciclik.com.br"})]})]})]})]}),v=()=>s.jsxs(Ne,{className:"border-0 overflow-hidden shadow-2xl max-w-4xl mx-auto bg-white",children:[s.jsx("div",{className:"bg-gradient-to-r from-slate-800 to-slate-700 text-white",children:s.jsxs("div",{className:"px-8 py-8",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("div",{className:"flex items-center gap-3",children:s.jsx("img",{src:Sa("logo-with-slogan.png"),alt:"Ciclik",className:"h-12 object-contain"})}),s.jsxs(Je,{className:"bg-white/20 text-white border-0 px-4 py-2 backdrop-blur-sm",children:[s.jsx(vi,{className:"w-4 h-4 mr-2"}),"Certificado Oficial #",a.numero_quota]})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-4xl font-display font-bold mb-2",children:"Certificado Digital Verde"}),s.jsx("p",{className:"text-lg opacity-90",children:"Comprovao de Impacto Ambiental Mensurvel"})]})]})}),s.jsxs(De,{className:"p-8 space-y-6",children:[s.jsxs("div",{className:"border-l-4 border-primary pl-6 py-4 bg-muted/30",children:[s.jsx("p",{className:"text-sm text-muted-foreground font-body mb-2 uppercase tracking-wider",children:"Certificado emitido para"}),s.jsx("h2",{className:"text-3xl font-display font-bold text-foreground mb-1",children:a.razao_social}),s.jsxs("p",{className:"text-muted-foreground font-body",children:["CNPJ: ",a.cnpj,"  Responsvel: ",a.nome_responsavel]})]}),s.jsx("div",{className:"border rounded-lg overflow-hidden",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-primary/5",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-left p-4 font-display font-semibold",children:"Categoria de Impacto"}),s.jsx("th",{className:"text-right p-4 font-display font-semibold",children:"Valor Certificado"})]})}),s.jsxs("tbody",{children:[s.jsxs("tr",{className:"border-t",children:[s.jsxs("td",{className:"p-4 flex items-center gap-3",children:[s.jsx(cr,{className:"w-5 h-5 text-primary"}),s.jsx("span",{className:"font-body",children:"Resduos Reciclados"})]}),s.jsxs("td",{className:"p-4 text-right font-display font-bold text-xl text-primary",children:[a.kg_reciclados," kg"]})]}),s.jsxs("tr",{className:"border-t bg-muted/20",children:[s.jsxs("td",{className:"p-4 flex items-center gap-3",children:[s.jsx(Xa,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"font-body",children:"Educao Ambiental"})]}),s.jsxs("td",{className:"p-4 text-right font-display font-bold text-xl text-blue-600",children:[a.horas_educacao," horas"]})]}),s.jsxs("tr",{className:"border-t",children:[s.jsxs("td",{className:"p-4 flex items-center gap-3",children:[s.jsx(fs,{className:"w-5 h-5 text-amber-600"}),s.jsx("span",{className:"font-body",children:"Embalagens Rastreadas"})]}),s.jsxs("td",{className:"p-4 text-right font-display font-bold text-xl text-amber-600",children:[a.embalagens_mapeadas," unidades"]})]})]})]})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-display font-bold mb-3 text-muted-foreground uppercase tracking-wider",children:"Equivalncia de Impacto Ambiental"}),s.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[s.jsxs("div",{className:"bg-white border border-blue-200 rounded-lg p-3 text-center shadow-sm",children:[s.jsx(Hc,{className:"w-6 h-6 text-blue-600 mx-auto mb-1"}),s.jsx("p",{className:"text-xl font-display font-bold text-blue-700",children:n}),s.jsx("p",{className:"text-[10px] text-blue-600 uppercase",children:"kg CO"})]}),s.jsxs("div",{className:"bg-white border border-green-200 rounded-lg p-3 text-center shadow-sm",children:[s.jsx(eu,{className:"w-6 h-6 text-green-600 mx-auto mb-1"}),s.jsx("p",{className:"text-xl font-display font-bold text-green-700",children:i}),s.jsx("p",{className:"text-[10px] text-green-600 uppercase",children:"rvores"})]}),s.jsxs("div",{className:"bg-white border border-yellow-200 rounded-lg p-3 text-center shadow-sm",children:[s.jsx(Go,{className:"w-6 h-6 text-yellow-600 mx-auto mb-1"}),s.jsx("p",{className:"text-xl font-display font-bold text-yellow-700",children:o}),s.jsx("p",{className:"text-[10px] text-yellow-600 uppercase",children:"kWh"})]}),s.jsxs("div",{className:"bg-white border border-cyan-200 rounded-lg p-3 text-center shadow-sm",children:[s.jsx(Gc,{className:"w-6 h-6 text-cyan-600 mx-auto mb-1"}),s.jsx("p",{className:"text-xl font-display font-bold text-cyan-700",children:c}),s.jsx("p",{className:"text-[10px] text-cyan-600 uppercase",children:"litros"})]}),s.jsxs("div",{className:"bg-white border border-purple-200 rounded-lg p-3 text-center shadow-sm",children:[s.jsx(oa,{className:"w-6 h-6 text-purple-600 mx-auto mb-1"}),s.jsx("p",{className:"text-xl font-display font-bold text-purple-700",children:d}),s.jsx("p",{className:"text-[10px] text-purple-600 uppercase",children:"pessoas"})]})]})]}),s.jsxs("div",{className:"border-t pt-6",children:[s.jsx("p",{className:"text-xs text-muted-foreground font-body text-center mb-3 uppercase tracking-wider",children:"Contribuio ODS da ONU - Agenda 2030"}),s.jsx("div",{className:"flex justify-center gap-2",children:[Zc,Qc,Jc,ed,td,sd].map((_,C)=>s.jsx("img",{src:_,alt:`ODS ${C+8}`,className:"w-14 h-14 rounded-lg"},C))})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-6 border-t pt-6 items-center",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-muted-foreground font-body mb-1",children:"Emitido em"}),s.jsx("p",{className:"font-display font-semibold",children:Os(a.data_geracao,"dd/MM/yyyy",{locale:$s})}),s.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Projeto"}),s.jsx("p",{className:"font-display font-semibold",children:a.projeto_titulo})]}),s.jsx("div",{className:"flex justify-center",children:s.jsx("div",{className:"w-32 h-32 bg-slate-100 border-2 border-slate-300 rounded-xl flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-24 h-24 bg-white rounded-lg flex items-center justify-center mb-1",children:s.jsx("div",{className:"grid grid-cols-5 gap-0.5 p-2",children:Array.from({length:25}).map((_,C)=>s.jsx("div",{className:`w-2 h-2 ${Math.random()>.5?"bg-black":"bg-white"}`},C))})}),s.jsx("p",{className:"text-[9px] text-muted-foreground font-mono",children:"Validar Online"})]})})}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-xs text-muted-foreground font-body mb-1",children:"Vlido permanentemente"}),s.jsx("p",{className:"font-display font-semibold text-primary",children:"ciclik.com.br"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"ID do Certificado"}),s.jsx("p",{className:"font-mono text-sm",children:a.numero_quota})]})]})]})]}),b=()=>s.jsxs(Ne,{className:"border-0 overflow-hidden shadow-2xl max-w-4xl mx-auto",children:[s.jsxs("div",{className:"relative h-48 bg-gradient-to-br from-primary via-primary/90 to-primary/70 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-transparent to-white/10",style:{clipPath:"polygon(0 0, 100% 0, 100% 60%, 0 100%)"}}),s.jsxs("div",{className:"relative z-10 p-8 h-full flex flex-col justify-between text-white",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-2xl flex items-center justify-center backdrop-blur-sm rotate-12",children:s.jsx(cr,{className:"w-7 h-7 text-white -rotate-12"})}),s.jsxs("div",{children:[s.jsx("span",{className:"text-2xl font-display font-bold",children:"ciclik"}),s.jsx("p",{className:"text-xs opacity-75",children:"Impacto Verificado"})]})]}),s.jsxs(Je,{className:"bg-ciclik-orange text-white border-0 px-3 py-1.5 font-bold",children:["#",a.numero_quota]})]}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-4xl font-display font-bold mb-1",children:"Certificado Digital Verde"}),s.jsx("p",{className:"text-sm opacity-90",children:"Impacto Real  Mensurvel  Auditado"})]})]})]}),s.jsxs(De,{className:"p-8 space-y-8",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute -left-4 top-0 bottom-0 w-1 bg-gradient-to-b from-primary to-ciclik-orange rounded-full"}),s.jsxs("div",{className:"pl-4",children:[s.jsx("p",{className:"text-xs text-primary font-body mb-2 uppercase tracking-widest font-bold",children:"Empresa Certificada"}),s.jsx("h2",{className:"text-3xl font-display font-bold text-foreground mb-1",children:a.razao_social}),s.jsxs("p",{className:"text-sm text-muted-foreground font-body",children:["CNPJ: ",a.cnpj]})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/5 via-primary/10 to-primary/5 rounded-3xl blur-2xl"}),s.jsxs("div",{className:"relative grid md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"group relative bg-white border-2 border-primary/20 rounded-2xl p-6 hover:border-primary/40 transition-all hover:-translate-y-1",children:[s.jsx("div",{className:"absolute top-4 right-4 w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform",children:s.jsx(cr,{className:"w-6 h-6 text-primary"})}),s.jsx("p",{className:"text-sm text-muted-foreground font-body mb-2",children:"Reciclagem"}),s.jsx("p",{className:"text-4xl font-display font-bold text-primary mb-1",children:a.kg_reciclados}),s.jsx("p",{className:"text-xs text-muted-foreground font-body",children:"quilogramas processados"})]}),s.jsxs("div",{className:"group relative bg-white border-2 border-blue-200 rounded-2xl p-6 hover:border-blue-400 transition-all hover:-translate-y-1",children:[s.jsx("div",{className:"absolute top-4 right-4 w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform",children:s.jsx(Xa,{className:"w-6 h-6 text-blue-600"})}),s.jsx("p",{className:"text-sm text-muted-foreground font-body mb-2",children:"Educao"}),s.jsx("p",{className:"text-4xl font-display font-bold text-blue-600 mb-1",children:a.horas_educacao}),s.jsx("p",{className:"text-xs text-muted-foreground font-body",children:"horas de formao ambiental"})]}),s.jsxs("div",{className:"group relative bg-white border-2 border-amber-200 rounded-2xl p-6 hover:border-amber-400 transition-all hover:-translate-y-1",children:[s.jsx("div",{className:"absolute top-4 right-4 w-12 h-12 bg-amber-100 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform",children:s.jsx(fs,{className:"w-6 h-6 text-amber-600"})}),s.jsx("p",{className:"text-sm text-muted-foreground font-body mb-2",children:"Rastreabilidade"}),s.jsx("p",{className:"text-4xl font-display font-bold text-amber-600 mb-1",children:a.embalagens_mapeadas}),s.jsx("p",{className:"text-xs text-muted-foreground font-body",children:"embalagens rastreadas"})]})]})]}),s.jsxs("div",{className:"bg-gradient-to-br from-muted/50 to-muted/20 rounded-3xl p-6 border",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Ir,{className:"w-5 h-5 text-primary"}),s.jsx("h3",{className:"text-lg font-display font-bold text-foreground",children:"Impacto Equivalente"})]}),s.jsx("div",{className:"grid grid-cols-5 gap-4",children:[{icon:Hc,value:n,label:`kg CO
evitados`,color:"blue"},{icon:eu,value:i,label:`rvores
preservadas`,color:"green"},{icon:Go,value:o,label:`kWh de
energia`,color:"yellow"},{icon:Gc,value:c,label:`litros de
gua`,color:"cyan"},{icon:oa,value:d,label:`pessoas
impactadas`,color:"purple"}].map((_,C)=>s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:`w-14 h-14 bg-${_.color}-50 border-2 border-${_.color}-200 rounded-xl flex items-center justify-center mx-auto mb-2`,children:s.jsx(_.icon,{className:`w-7 h-7 text-${_.color}-600`})}),s.jsx("p",{className:`text-2xl font-display font-bold text-${_.color}-700 mb-1`,children:typeof _.value=="string"?Number(_.value).toLocaleString("pt-BR"):_.value}),s.jsx("p",{className:`text-[10px] text-${_.color}-600 leading-tight whitespace-pre-line`,children:_.label})]},C))})]}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-8 border-t pt-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Eh,{className:"w-5 h-5 text-primary"}),s.jsx("h3",{className:"font-display font-bold text-foreground",children:"Objetivos de Desenvolvimento Sustentvel"})]}),s.jsx("div",{className:"grid grid-cols-3 gap-3",children:[Zc,Qc,Jc,ed,td,sd].map((_,C)=>s.jsx("img",{src:_,alt:`ODS ${C+8}`,className:"w-full rounded-lg shadow-md hover:scale-105 transition-transform"},C))}),s.jsx("p",{className:"text-xs text-muted-foreground mt-3 text-center",children:"Agenda 2030  Investimento em transformao sustentvel"})]}),s.jsxs("div",{className:"flex flex-col justify-between",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/50 rounded-xl",children:[s.jsx(Fa,{className:"w-5 h-5 text-primary flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-[10px] text-muted-foreground uppercase",children:"Emitido em"}),s.jsx("p",{className:"font-display font-semibold text-sm",children:Os(a.data_geracao,"dd/MM/yyyy",{locale:$s})})]})]}),s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/50 rounded-xl",children:[s.jsx(hn,{className:"w-5 h-5 text-primary flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-[10px] text-muted-foreground uppercase",children:"Projeto"}),s.jsx("p",{className:"font-display font-semibold text-sm",children:a.projeto_titulo})]})]})]}),s.jsx("div",{className:"mt-4 flex justify-center",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 bg-primary/20 rounded-2xl blur-xl"}),s.jsx("div",{className:"relative w-36 h-36 bg-white border-4 border-primary/30 rounded-2xl flex items-center justify-center shadow-xl",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-28 h-28 bg-gradient-to-br from-primary/10 to-primary/5 rounded-xl flex items-center justify-center mb-1",children:s.jsx("div",{className:"grid grid-cols-6 gap-0.5 p-2",children:Array.from({length:36}).map((_,C)=>s.jsx("div",{className:`w-2 h-2 rounded-sm ${Math.random()>.5?"bg-primary":"bg-white"}`},C))})}),s.jsx("p",{className:"text-[9px] text-primary font-bold uppercase tracking-wide",children:"Escaneie"})]})})]})})]})]}),s.jsx("div",{className:"text-center border-t pt-4",children:s.jsxs("p",{className:"text-xs text-muted-foreground font-body",children:["Certificado vlido permanentemente  Validao pblica em ",s.jsx("strong",{className:"text-primary",children:"ciclik.com.br"})]})})]})]}),N=()=>s.jsxs(Ne,{className:"border-0 overflow-hidden shadow-2xl max-w-4xl mx-auto bg-white",children:[s.jsxs("div",{className:"relative bg-gradient-to-br from-slate-800 via-slate-700 to-primary/90 text-white overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0",children:s.jsx("div",{className:"absolute top-0 right-0 w-2/3 h-full bg-gradient-to-br from-primary to-primary/80 transform skew-x-12 origin-top-right"})}),s.jsxs("div",{className:"relative z-10 px-8 py-8",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("div",{className:"flex items-center gap-3",children:s.jsx("img",{src:Sa("logo-with-slogan.png"),alt:"Ciclik",className:"h-12 object-contain"})}),s.jsxs(Je,{className:"bg-white/20 text-white border-0 px-4 py-2 backdrop-blur-sm",children:[s.jsx(vi,{className:"w-4 h-4 mr-2"}),"Certificado #",a.numero_quota]})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-4xl font-display font-bold mb-2",children:"Certificado Digital Verde"}),s.jsx("p",{className:"text-lg opacity-90",children:"Impacto Mensurvel  Validado  Transformador"})]})]})]}),s.jsxs(De,{className:"p-8 space-y-6",children:[s.jsxs("div",{className:"border-l-4 border-primary pl-6 py-4 bg-muted/30 rounded-r-lg",children:[s.jsx("p",{className:"text-sm text-muted-foreground font-body mb-2 uppercase tracking-wider",children:"Certificado emitido para"}),s.jsx("h2",{className:"text-3xl font-display font-bold text-foreground mb-1",children:a.razao_social}),s.jsxs("p",{className:"text-muted-foreground font-body",children:["CNPJ: ",a.cnpj,"  Responsvel: ",a.nome_responsavel]})]}),s.jsx("div",{className:"border rounded-lg overflow-hidden shadow-sm",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-primary/10",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-left p-4 font-display font-semibold text-primary",children:"Categoria de Impacto"}),s.jsx("th",{className:"text-right p-4 font-display font-semibold text-primary",children:"Valor Certificado"})]})}),s.jsxs("tbody",{children:[s.jsxs("tr",{className:"border-t hover:bg-muted/30 transition-colors",children:[s.jsxs("td",{className:"p-4 flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:s.jsx(cr,{className:"w-5 h-5 text-primary"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-display font-medium",children:"Resduos Reciclados"}),s.jsx("p",{className:"text-xs text-muted-foreground font-body",children:"Material desviado de aterros"})]})]}),s.jsx("td",{className:"p-4 text-right",children:s.jsxs("span",{className:"text-2xl font-display font-bold text-primary",children:[a.kg_reciclados," kg"]})})]}),s.jsxs("tr",{className:"border-t bg-muted/20 hover:bg-muted/40 transition-colors",children:[s.jsxs("td",{className:"p-4 flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:s.jsx(Xa,{className:"w-5 h-5 text-primary"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-display font-medium",children:"Educao Ambiental"}),s.jsx("p",{className:"text-xs text-muted-foreground font-body",children:"Horas de conscientizao"})]})]}),s.jsx("td",{className:"p-4 text-right",children:s.jsxs("span",{className:"text-2xl font-display font-bold text-primary",children:[a.horas_educacao,"h"]})})]}),s.jsxs("tr",{className:"border-t hover:bg-muted/30 transition-colors",children:[s.jsxs("td",{className:"p-4 flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:s.jsx(fs,{className:"w-5 h-5 text-primary"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-display font-medium",children:"Embalagens Mapeadas"}),s.jsx("p",{className:"text-xs text-muted-foreground font-body",children:"Rastreabilidade logstica"})]})]}),s.jsx("td",{className:"p-4 text-right",children:s.jsx("span",{className:"text-2xl font-display font-bold text-primary",children:a.embalagens_mapeadas})})]})]})]})}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-sm font-display font-bold mb-3 text-muted-foreground uppercase tracking-wider flex items-center gap-2",children:[s.jsx(Ir,{className:"w-4 h-4 text-primary"}),"Equivalncia de Impacto Ambiental"]}),s.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[s.jsxs("div",{className:"bg-white border-2 border-blue-200 rounded-xl p-3 text-center shadow-md hover:shadow-lg hover:scale-105 transition-all",children:[s.jsx(Hc,{className:"w-6 h-6 text-blue-600 mx-auto mb-1"}),s.jsx("p",{className:"text-xl font-display font-bold text-blue-700",children:n}),s.jsx("p",{className:"text-[10px] text-blue-600 uppercase font-semibold",children:"kg CO"})]}),s.jsxs("div",{className:"bg-white border-2 border-green-200 rounded-xl p-3 text-center shadow-md hover:shadow-lg hover:scale-105 transition-all",children:[s.jsx(eu,{className:"w-6 h-6 text-green-600 mx-auto mb-1"}),s.jsx("p",{className:"text-xl font-display font-bold text-green-700",children:i}),s.jsx("p",{className:"text-[10px] text-green-600 uppercase font-semibold",children:"rvores"})]}),s.jsxs("div",{className:"bg-white border-2 border-yellow-200 rounded-xl p-3 text-center shadow-md hover:shadow-lg hover:scale-105 transition-all",children:[s.jsx(Go,{className:"w-6 h-6 text-yellow-600 mx-auto mb-1"}),s.jsx("p",{className:"text-xl font-display font-bold text-yellow-700",children:o}),s.jsx("p",{className:"text-[10px] text-yellow-600 uppercase font-semibold",children:"kWh"})]}),s.jsxs("div",{className:"bg-white border-2 border-cyan-200 rounded-xl p-3 text-center shadow-md hover:shadow-lg hover:scale-105 transition-all",children:[s.jsx(Gc,{className:"w-6 h-6 text-cyan-600 mx-auto mb-1"}),s.jsx("p",{className:"text-xl font-display font-bold text-cyan-700",children:c}),s.jsx("p",{className:"text-[10px] text-cyan-600 uppercase font-semibold",children:"litros"})]}),s.jsxs("div",{className:"bg-white border-2 border-purple-200 rounded-xl p-3 text-center shadow-md hover:shadow-lg hover:scale-105 transition-all",children:[s.jsx(oa,{className:"w-6 h-6 text-purple-600 mx-auto mb-1"}),s.jsx("p",{className:"text-xl font-display font-bold text-purple-700",children:d}),s.jsx("p",{className:"text-[10px] text-purple-600 uppercase font-semibold",children:"pessoas"})]})]})]}),s.jsxs("div",{className:"border-t-2 border-primary/20 pt-6",children:[s.jsxs("div",{className:"flex items-center justify-center gap-2 mb-4",children:[s.jsx(Eh,{className:"w-5 h-5 text-primary"}),s.jsx("h3",{className:"text-sm font-display font-bold text-center text-foreground uppercase tracking-wider",children:"Contribuio ODS da ONU - Agenda 2030"})]}),s.jsx("div",{className:"flex justify-center gap-3",children:[Zc,Qc,Jc,ed,td,sd].map((_,C)=>s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute inset-0 bg-primary rounded-xl blur-md opacity-0 group-hover:opacity-30 transition-opacity"}),s.jsx("img",{src:_,alt:`ODS ${C+8}`,className:"relative w-16 h-16 rounded-xl shadow-md hover:scale-110 transition-transform"})]},C))})]}),s.jsx("div",{className:"bg-gradient-to-r from-muted/50 to-primary/5 rounded-xl p-6 border border-primary/10",children:s.jsxs("div",{className:"grid grid-cols-3 gap-6 items-center",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-muted-foreground font-body mb-1 uppercase tracking-wide",children:"Emitido em"}),s.jsx("p",{className:"font-display font-semibold text-lg mb-3",children:Os(a.data_geracao,"dd/MM/yyyy",{locale:$s})}),s.jsx("p",{className:"text-xs text-muted-foreground font-body mb-1 uppercase tracking-wide",children:"Projeto"}),s.jsx("p",{className:"font-display font-medium",children:a.projeto_titulo})]}),s.jsx("div",{className:"flex justify-center",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 bg-primary rounded-2xl blur-xl opacity-20"}),s.jsx("div",{className:"relative w-32 h-32 bg-gradient-to-br from-white to-primary/5 rounded-2xl border-2 border-primary/30 p-3 shadow-lg",children:s.jsx("div",{className:"grid grid-cols-6 gap-0.5 w-full h-full",children:Array.from({length:36}).map((_,C)=>s.jsx("div",{className:`${Math.random()>.5?"bg-black":"bg-white"} rounded-sm`},C))})}),s.jsx("div",{className:"mt-2 text-center",children:s.jsx("p",{className:"text-[10px] text-muted-foreground font-body uppercase tracking-wider font-semibold",children:"QR Code de Validao"})})]})}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-xs text-muted-foreground font-body mb-1 uppercase tracking-wide",children:"Perodo de Validade"}),s.jsxs("p",{className:"font-display font-semibold mb-3",children:[Os(a.data_compra,"MMM/yy",{locale:$s})," - ",Os(a.data_maturacao,"MMM/yy",{locale:$s})]}),s.jsxs("div",{className:"flex items-center justify-end gap-1 text-xs text-muted-foreground",children:[s.jsx(Tr,{className:"w-3 h-3 text-green-600"}),s.jsx("span",{className:"font-display font-medium text-primary",children:"Verificvel em ciclik.com.br"})]})]})]})})]})]});return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-background via-muted/30 to-background",children:[s.jsx("header",{className:"sticky top-0 z-50 bg-white/90 backdrop-blur-md border-b shadow-sm",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>e(-1),className:"gap-2",children:[s.jsx(As,{className:"w-4 h-4"}),"Voltar"]}),s.jsx("div",{className:"h-6 w-px bg-border"}),s.jsxs("div",{children:[s.jsx("h1",{className:"font-display font-bold text-lg",children:"Preview - Modelo de Certificado CDV"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Teste e compare diferentes layouts"})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(oe,{variant:t==="v1"?"default":"outline",size:"sm",onClick:()=>r("v1"),children:"V1"}),s.jsx(oe,{variant:t==="v2"?"default":"outline",size:"sm",onClick:()=>r("v2"),children:"V2"}),s.jsx(oe,{variant:t==="v3"?"default":"outline",size:"sm",onClick:()=>r("v3"),children:"V3"}),s.jsx(oe,{variant:t==="v4"?"default":"outline",size:"sm",onClick:()=>r("v4"),children:"V4"}),s.jsx(oe,{variant:t==="v5"?"default":"outline",size:"sm",onClick:()=>r("v5"),children:"V5"}),s.jsx(oe,{variant:t==="v6"?"default":"outline",size:"sm",onClick:()=>r("v6"),children:"V6"})]})]})})}),s.jsxs("div",{className:"max-w-7xl mx-auto p-8",children:[s.jsxs("div",{className:"mb-6 text-center",children:[s.jsxs(Je,{variant:"outline",className:"mb-2",children:[t==="v1"&&"V1: Premium - Layout Completo com QR Code",t==="v2"&&"V2: Minimalista - Design Limpo com QR Code",t==="v3"&&"V3: Elegante - Design Sofisticado com QR Code",t==="v4"&&"V4: Corporativo - Layout Formal com QR Code",t==="v5"&&"V5: Moderno - Design Impactante com QR Code",t==="v6"&&"V6: Hbrido - Melhor de V4 + V5 com QR Code"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Preview com dados mockados  QR Code includo em todas as verses"})]}),t==="v1"&&h(),t==="v2"&&p(),t==="v3"&&x(),t==="v4"&&v(),t==="v5"&&b(),t==="v6"&&N()]})]})},Ode=()=>{var x,v,b;const{id:e}=To(),t=ds(),[r,a]=E.useState(null),[n,i]=E.useState(!0),[o,c]=E.useState(!1),[d,h]=E.useState("");E.useEffect(()=>{p()},[e]);const p=async()=>{try{const{data:N,error:_}=await J.from("cdv_quotas").select(`
          *,
          investidor:cdv_investidores(razao_social, cnpj),
          projeto:cdv_projetos(titulo)
        `).eq("id",e).single();if(_||!N){c(!1),i(!1);return}a(N),c(N.status==="pronto"||N.status==="certificado_emitido");const C=Il(`/cdv/validate/${e}`),T=await kd({data:C,width:200,margin:2});h(T)}catch{c(!1)}finally{i(!1)}};return n?s.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-background to-primary/5",children:s.jsxs("div",{className:"flex flex-col items-center gap-4",children:[s.jsx("img",{src:Sa("ciclik-logo.png"),alt:"Ciclik",className:"h-12 animate-pulse"}),s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})]})}):r?s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-primary/5",children:[s.jsx("header",{className:"bg-white/80 backdrop-blur-md border-b border-border/50 shadow-sm",children:s.jsx("div",{className:"max-w-2xl mx-auto px-4 py-4",children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("img",{src:Sa("ciclik-logo-full.png"),alt:"Ciclik",className:"h-9 object-contain"}),s.jsx("div",{className:"h-6 w-px bg-border/50"}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(vi,{className:"w-4 h-4 text-primary"}),s.jsx("span",{className:"text-sm font-display font-medium text-primary",children:"Validao"})]})]})})})}),s.jsxs("div",{className:"max-w-2xl mx-auto p-4 md:p-8",children:[s.jsx(Ne,{className:`mb-6 border-2 overflow-hidden ${o?"border-green-500":"border-yellow-500"}`,children:s.jsx("div",{className:`p-6 ${o?"bg-gradient-to-r from-green-50 to-green-100/50":"bg-gradient-to-r from-yellow-50 to-yellow-100/50"}`,children:s.jsxs("div",{className:"flex items-center gap-4",children:[o?s.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:s.jsx(Tr,{className:"w-10 h-10 text-green-600"})}):s.jsx("div",{className:"p-3 bg-yellow-100 rounded-full",children:s.jsx(Va,{className:"w-10 h-10 text-yellow-600"})}),s.jsxs("div",{children:[s.jsx("h1",{className:`text-2xl font-display font-bold ${o?"text-green-700":"text-yellow-700"}`,children:o?"Certificado Vlido":"Certificado em Gerao"}),s.jsx("p",{className:`font-body ${o?"text-green-600":"text-yellow-600"}`,children:o?"Este certificado foi verificado e  autntico.":"Este certificado ainda est em processo de gerao de impacto."})]})]})})}),s.jsxs(Ne,{className:"border-primary/10 shadow-sm overflow-hidden",children:[s.jsx(Ye,{className:"bg-gradient-to-r from-primary/10 via-primary/5 to-transparent",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{children:s.jsxs(Qe,{className:"text-2xl font-display flex items-center gap-2",children:[s.jsx(Qn,{className:"w-6 h-6 text-primary"}),"CDV #",r.numero_quota]})}),s.jsx(Je,{className:`font-display ${o?"bg-green-500":"bg-yellow-500"}`,children:o?"Certificado":"Em Gerao"})]})}),s.jsxs(De,{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-start gap-3 p-4 bg-muted/50 rounded-xl",children:[s.jsx(m6,{className:"w-5 h-5 text-primary mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-display font-semibold text-foreground",children:(x=r.investidor)==null?void 0:x.razao_social}),s.jsxs("p",{className:"text-sm text-muted-foreground font-body",children:["CNPJ: ",(v=r.investidor)==null?void 0:v.cnpj]})]})]}),s.jsxs("div",{className:"flex items-center gap-3 p-4 bg-muted/50 rounded-xl",children:[s.jsx(Qn,{className:"w-5 h-5 text-primary"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground font-body",children:"Projeto"}),s.jsx("p",{className:"font-display font-semibold",children:((b=r.projeto)==null?void 0:b.titulo)||"Ciclik Digital Verde"})]})]}),s.jsxs("div",{className:"flex items-center gap-3 p-4 bg-muted/50 rounded-xl",children:[s.jsx(Fa,{className:"w-5 h-5 text-primary"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground font-body",children:"Perodo de Maturao"}),s.jsxs("p",{className:"font-display font-semibold",children:[Os(new Date(r.data_compra),"MMM/yyyy",{locale:$s})," - ",Os(new Date(r.data_maturacao),"MMM/yyyy",{locale:$s})]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-display font-semibold mb-4 text-foreground",children:"Impactos Ambientais"}),s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[s.jsxs("div",{className:"text-center p-4 bg-gradient-to-br from-primary/10 to-primary/5 rounded-xl",children:[s.jsx(cr,{className:"w-7 h-7 text-primary mx-auto mb-2"}),s.jsx("p",{className:"text-xl font-display font-bold text-primary",children:r.kg_conciliados}),s.jsx("p",{className:"text-xs text-muted-foreground font-body",children:"kg reciclados"})]}),s.jsxs("div",{className:"text-center p-4 bg-gradient-to-br from-primary/10 to-primary/5 rounded-xl",children:[s.jsx(Xa,{className:"w-7 h-7 text-primary mx-auto mb-2"}),s.jsx("p",{className:"text-xl font-display font-bold text-primary",children:r.horas_conciliadas}),s.jsx("p",{className:"text-xs text-muted-foreground font-body",children:"horas educao"})]}),s.jsxs("div",{className:"text-center p-4 bg-gradient-to-br from-primary/10 to-primary/5 rounded-xl",children:[s.jsx(fs,{className:"w-7 h-7 text-primary mx-auto mb-2"}),s.jsx("p",{className:"text-xl font-display font-bold text-primary",children:r.embalagens_conciliadas}),s.jsx("p",{className:"text-xs text-muted-foreground font-body",children:"embalagens"})]})]})]}),s.jsxs("div",{className:"flex flex-col items-center pt-6 border-t",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(Da,{className:"w-5 h-5 text-primary"}),s.jsx("span",{className:"text-sm font-display font-medium text-foreground",children:"QR Code de Validao"})]}),d&&s.jsx("div",{className:"p-3 bg-white rounded-xl shadow-sm border",children:s.jsx("img",{src:d,alt:"QR Code",className:"w-36 h-36"})}),s.jsxs("p",{className:"text-xs text-muted-foreground font-body mt-3 text-center",children:["ID: ",r.id]})]})]})]}),s.jsx("div",{className:"flex justify-center mt-6",children:s.jsxs(oe,{variant:"outline",onClick:()=>t("/"),className:"font-display",children:[s.jsx(As,{className:"w-4 h-4 mr-2"}),"Voltar ao Incio"]})}),s.jsxs("div",{className:"text-center mt-8 pt-6 border-t border-border/50",children:[s.jsx("img",{src:Sa("ciclik-logo.png"),alt:"Ciclik",className:"h-7 mx-auto mb-3 opacity-60"}),s.jsxs("p",{className:"text-xs text-muted-foreground font-body",children:["Verificado em ",Os(new Date,"dd/MM/yyyy 's' HH:mm",{locale:$s})]}),s.jsxs("p",{className:"text-xs text-muted-foreground font-body mt-1",children:[" ",new Date().getFullYear()," Ciclik - Digital Verde"]})]})]})]}):s.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gradient-to-br from-background to-destructive/5 p-4",children:[s.jsx("div",{className:"absolute top-0 left-0 right-0 p-4",children:s.jsx("div",{className:"max-w-2xl mx-auto flex justify-center",children:s.jsx("img",{src:Sa("ciclik-logo-full.png"),alt:"Ciclik",className:"h-10 object-contain opacity-60"})})}),s.jsxs(Ne,{className:"max-w-md w-full text-center p-8 border-destructive/20",children:[s.jsx(Va,{className:"w-20 h-20 text-destructive mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-display font-bold text-destructive mb-2",children:"Certificado Invlido"}),s.jsx("p",{className:"text-muted-foreground font-body mb-6",children:"Este cdigo de certificado no foi encontrado em nosso sistema."}),s.jsxs(oe,{onClick:()=>t("/"),variant:"outline",className:"font-display",children:[s.jsx(As,{className:"w-4 h-4 mr-2"}),"Voltar ao Incio"]})]})]})},Dde=()=>{const[e,t]=E.useState([]),[r,a]=E.useState(!0),[n,i]=E.useState(!1),[o,c]=E.useState(!1),[d,h]=E.useState(null),[p,x]=E.useState(!1),[v,b]=E.useState(null),{toast:N}=_r(),[_,C]=E.useState({titulo:"",descricao:"",valor_total:"",publico_alvo:"",data_inicio:"",data_fim:"",prazo_maturacao_meses:"12",quotas_por_periodo:"",meta_1:"",meta_2:"",meta_3:"",meta_4:"",meta_5:""}),[T,A]=E.useState({titulo:"",descricao:"",publico_alvo:"",data_inicio:"",data_fim:"",status:"",meta_1:"",meta_2:"",meta_3:"",meta_4:"",meta_5:""});E.useEffect(()=>{k()},[]);const k=async()=>{try{const{data:z,error:q}=await J.from("cdv_projetos").select("*").order("created_at",{ascending:!1});if(q)throw q;t(z||[])}catch(z){console.error("Erro ao buscar projetos:",z),N({title:"Erro ao carregar projetos",description:z.message,variant:"destructive"})}finally{a(!1)}},I=z=>{const q=Math.floor(z/2e3);return{total_quotas:q,meta_kg_residuos:q*250,meta_minutos_educacao:q*5,meta_produtos_catalogados:q*1,meta_co2_evitado_kg:q*225}},B=async z=>{z.preventDefault(),x(!0);try{const q=parseFloat(_.valor_total),Y=I(q),ae=[_.meta_1,_.meta_2,_.meta_3,_.meta_4,_.meta_5].filter(re=>re.trim()!==""),{data:je,error:H}=await J.from("cdv_projetos").insert({titulo:_.titulo,descricao:_.descricao,valor_total:q,metas_principais:ae,publico_alvo:_.publico_alvo,data_inicio:_.data_inicio,data_fim:_.data_fim,prazo_maturacao_meses:parseInt(_.prazo_maturacao_meses),quotas_por_periodo:_.quotas_por_periodo?parseInt(_.quotas_por_periodo):null,...Y}).select().single();if(H)throw H;const Z=parseInt(_.prazo_maturacao_meses),G=[];for(let re=1;re<=Y.total_quotas;re++){const le=new Date(_.data_inicio);le.setMonth(le.getMonth()+Z),G.push({id_projeto:je.id,numero_quota:`${je.id.substring(0,8).toUpperCase()}-${re.toString().padStart(4,"0")}`,valor_pago:2e3,data_maturacao:le.toISOString(),id_investidor:null,status_maturacao:null,meta_kg_residuos:250,meta_horas_educacao:5,meta_embalagens:1,meta_co2_evitado_kg:225})}const{error:Q}=await J.from("cdv_quotas").insert(G);if(Q)throw Q;N({title:"Projeto criado com sucesso!",description:`${Y.total_quotas} quotas geradas automaticamente.`}),i(!1),C({titulo:"",descricao:"",valor_total:"",publico_alvo:"",data_inicio:"",data_fim:"",prazo_maturacao_meses:"12",quotas_por_periodo:"",meta_1:"",meta_2:"",meta_3:"",meta_4:"",meta_5:""}),k()}catch(q){console.error("Erro ao criar projeto:",q),N({title:"Erro ao criar projeto",description:q.message,variant:"destructive"})}finally{x(!1)}},O=z=>{const q=z.meta_kg_residuos>0?z.kg_conciliados/z.meta_kg_residuos*100:0,Y=z.meta_minutos_educacao>0?z.minutos_conciliados/z.meta_minutos_educacao*100:0,ae=z.meta_produtos_catalogados>0?z.produtos_conciliados/z.meta_produtos_catalogados*100:0;return Math.round((q+Y+ae)/3)},D=async z=>{b(z);try{const{error:q}=await J.from("cdv_quotas").delete().eq("id_projeto",z);if(q)throw q;const{error:Y}=await J.from("cdv_projetos").delete().eq("id",z);if(Y)throw Y;N({title:"Projeto excludo",description:"O projeto e suas quotas foram removidos com sucesso."}),k()}catch(q){console.error("Erro ao excluir projeto:",q),N({title:"Erro ao excluir projeto",description:q.message,variant:"destructive"})}finally{b(null)}},F=z=>{const q=z.metas_principais||[];h(z),A({titulo:z.titulo,descricao:z.descricao,publico_alvo:z.publico_alvo||"",data_inicio:z.data_inicio,data_fim:z.data_fim,status:z.status,meta_1:q[0]||"",meta_2:q[1]||"",meta_3:q[2]||"",meta_4:q[3]||"",meta_5:q[4]||""}),c(!0)},M=async z=>{if(z.preventDefault(),!!d){x(!0);try{const q=[T.meta_1,T.meta_2,T.meta_3,T.meta_4,T.meta_5].filter(ae=>ae.trim()!==""),{error:Y}=await J.from("cdv_projetos").update({titulo:T.titulo,descricao:T.descricao,publico_alvo:T.publico_alvo,data_inicio:T.data_inicio,data_fim:T.data_fim,status:T.status,metas_principais:q}).eq("id",d.id);if(Y)throw Y;N({title:"Projeto atualizado",description:"As alteraes foram salvas com sucesso."}),c(!1),h(null),k()}catch(q){console.error("Erro ao atualizar projeto:",q),N({title:"Erro ao atualizar projeto",description:q.message,variant:"destructive"})}finally{x(!1)}}};return r?s.jsx("div",{className:"flex justify-center p-8",children:"Carregando projetos..."}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Projetos CDV"}),s.jsx("p",{className:"text-muted-foreground",children:"Gerencie os projetos de Certificado Digital Verde e suas quotas"})]}),s.jsxs(ar,{open:n,onOpenChange:i,children:[s.jsx(kp,{asChild:!0,children:s.jsxs(oe,{children:[s.jsx(ra,{className:"w-4 h-4 mr-2"}),"Criar Novo Projeto"]})}),s.jsxs(tr,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[s.jsxs(nr,{children:[s.jsx(ir,{children:"Criar Novo Projeto CDV"}),s.jsx(Vr,{children:"As quotas sero geradas automaticamente com base no valor total (R$ 2.000,00 por quota)"})]}),s.jsxs("form",{onSubmit:B,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"titulo",children:"Ttulo do Projeto *"}),s.jsx(We,{id:"titulo",value:_.titulo,onChange:z=>C({..._,titulo:z.target.value}),required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"descricao",children:"Descrio *"}),s.jsx(jn,{id:"descricao",value:_.descricao,onChange:z=>C({..._,descricao:z.target.value}),rows:3,required:!0})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"valor_total",children:"Valor Total (R$) *"}),s.jsx(We,{id:"valor_total",type:"number",step:"0.01",value:_.valor_total,onChange:z=>C({..._,valor_total:z.target.value}),required:!0}),_.valor_total&&s.jsxs("p",{className:"text-sm text-muted-foreground",children:[Math.floor(parseFloat(_.valor_total)/2e3)," quotas sero geradas"]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"publico_alvo",children:"Pblico Alvo"}),s.jsx(We,{id:"publico_alvo",value:_.publico_alvo,onChange:z=>C({..._,publico_alvo:z.target.value})})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"data_inicio",children:"Data Incio *"}),s.jsx(We,{id:"data_inicio",type:"date",value:_.data_inicio,onChange:z=>C({..._,data_inicio:z.target.value}),required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"data_fim",children:"Data Trmino do Projeto *"}),s.jsx(We,{id:"data_fim",type:"date",value:_.data_fim,onChange:z=>C({..._,data_fim:z.target.value}),required:!0})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"prazo_maturacao_meses",children:"Prazo de Maturao (meses) *"}),s.jsx(We,{id:"prazo_maturacao_meses",type:"number",min:"1",value:_.prazo_maturacao_meses,onChange:z=>C({..._,prazo_maturacao_meses:z.target.value}),required:!0}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Tempo padro para execuo dos impactos de cada quota (padro: 12 meses)"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"quotas_por_periodo",children:"Quotas por Perodo (opcional)"}),s.jsx(We,{id:"quotas_por_periodo",type:"number",min:"1",value:_.quotas_por_periodo,onChange:z=>C({..._,quotas_por_periodo:z.target.value}),placeholder:"Ex: 50"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Quantas quotas disponibilizar a cada 12 meses (deixe em branco para liberar todas)"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{children:"5 Metas Principais do Projeto"}),[1,2,3,4,5].map(z=>s.jsx(We,{placeholder:`Meta ${z}`,value:_[`meta_${z}`],onChange:q=>C({..._,[`meta_${z}`]:q.target.value})},z))]}),s.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[s.jsx(oe,{type:"button",variant:"outline",onClick:()=>i(!1),children:"Cancelar"}),s.jsx(oe,{type:"submit",disabled:p,children:p?"Criando...":"Criar Projeto"})]})]})]})]})]}),s.jsx("div",{className:"space-y-4",children:e.length===0?s.jsx(Ne,{children:s.jsx(De,{className:"text-center py-8",children:s.jsx("p",{className:"text-muted-foreground",children:"Nenhum projeto criado ainda."})})}):e.map(z=>{const q=O(z);return s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(Eo,{className:"w-5 h-5"}),z.titulo]}),s.jsx(Tt,{children:z.descricao})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Je,{variant:z.status==="ativo"?"default":"secondary",children:z.status}),s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>F(z),children:s.jsx(Fw,{className:"w-4 h-4"})}),s.jsxs(hc,{children:[s.jsx($Z,{asChild:!0,children:s.jsx(oe,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive hover:bg-destructive/10",disabled:v===z.id,children:s.jsx(Ba,{className:"w-4 h-4"})})}),s.jsxs(Dl,{children:[s.jsxs(Ml,{children:[s.jsx(Fl,{children:"Excluir Projeto CDV"}),s.jsxs(Bl,{children:['Tem certeza que deseja excluir o projeto "',z.titulo,'"? Isso tambm remover todas as ',z.total_quotas," quotas associadas. Esta ao no pode ser desfeita."]})]}),s.jsxs(Ll,{children:[s.jsx(Ul,{children:"Cancelar"}),s.jsx(Vl,{onClick:()=>D(z.id),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:v===z.id?"Excluindo...":"Excluir Projeto"})]})]})]})]})]})}),s.jsx(De,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(Mw,{className:"w-4 h-4"}),"Valor Total"]}),s.jsx("p",{className:"text-lg font-semibold",children:rb(z.valor_total)})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(Eo,{className:"w-4 h-4"}),"Quotas"]}),s.jsxs("p",{className:"text-lg font-semibold",children:[z.quotas_vendidas,"/",z.total_quotas]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(Fa,{className:"w-4 h-4"}),"Vigncia"]}),s.jsxs("p",{className:"text-sm",children:[new Date(z.data_inicio).toLocaleDateString("pt-BR")," - ",new Date(z.data_fim).toLocaleDateString("pt-BR")]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(Ir,{className:"w-4 h-4"}),"Progresso"]}),s.jsxs("p",{className:"text-lg font-semibold",children:[q,"%"]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-muted-foreground",children:"Progresso Geral"}),s.jsxs("span",{className:"font-medium",children:[q,"%"]})]}),s.jsx("div",{className:"w-full bg-secondary rounded-full h-2",children:s.jsx("div",{className:"bg-primary rounded-full h-2 transition-all",style:{width:`${q}%`}})})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-4 pt-2 border-t",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-xs text-muted-foreground",children:"CO Evitado"}),s.jsxs("p",{className:"text-sm font-semibold",children:[Br(z.co2_conciliado_kg,0),"/",Br(z.meta_co2_evitado_kg,0)," kg"]})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-xs text-muted-foreground",children:"Resduos"}),s.jsxs("p",{className:"text-sm font-semibold",children:[Br(z.kg_conciliados,0),"/",Br(z.meta_kg_residuos,0)," kg"]})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-xs text-muted-foreground",children:"Educao"}),s.jsxs("p",{className:"text-sm font-semibold",children:[Br(z.minutos_conciliados,0),"/",Br(z.meta_minutos_educacao,0)," min"]})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-xs text-muted-foreground",children:"Produtos"}),s.jsxs("p",{className:"text-sm font-semibold",children:[z.produtos_conciliados,"/",z.meta_produtos_catalogados]})]})]})]})})]},z.id)})}),s.jsx(ar,{open:o,onOpenChange:c,children:s.jsxs(tr,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[s.jsxs(nr,{children:[s.jsx(ir,{children:"Editar Projeto CDV"}),s.jsx(Vr,{children:"Altere as informaes do projeto. O valor total e nmero de quotas no podem ser alterados."})]}),s.jsxs("form",{onSubmit:M,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"edit_titulo",children:"Ttulo do Projeto *"}),s.jsx(We,{id:"edit_titulo",value:T.titulo,onChange:z=>A({...T,titulo:z.target.value}),required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"edit_descricao",children:"Descrio *"}),s.jsx(jn,{id:"edit_descricao",value:T.descricao,onChange:z=>A({...T,descricao:z.target.value}),rows:3,required:!0})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"edit_publico_alvo",children:"Pblico Alvo"}),s.jsx(We,{id:"edit_publico_alvo",value:T.publico_alvo,onChange:z=>A({...T,publico_alvo:z.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"edit_status",children:"Status"}),s.jsxs("select",{id:"edit_status",value:T.status,onChange:z=>A({...T,status:z.target.value}),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",children:[s.jsx("option",{value:"ativo",children:"Ativo"}),s.jsx("option",{value:"inativo",children:"Inativo"}),s.jsx("option",{value:"concluido",children:"Concludo"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"edit_data_inicio",children:"Data Incio *"}),s.jsx(We,{id:"edit_data_inicio",type:"date",value:T.data_inicio,onChange:z=>A({...T,data_inicio:z.target.value}),required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"edit_data_fim",children:"Data Trmino do Projeto *"}),s.jsx(We,{id:"edit_data_fim",type:"date",value:T.data_fim,onChange:z=>A({...T,data_fim:z.target.value}),required:!0})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{children:"5 Metas Principais do Projeto"}),[1,2,3,4,5].map(z=>s.jsx(We,{placeholder:`Meta ${z}`,value:T[`meta_${z}`],onChange:q=>A({...T,[`meta_${z}`]:q.target.value})},z))]}),s.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[s.jsx(oe,{type:"button",variant:"outline",onClick:()=>c(!1),children:"Cancelar"}),s.jsx(oe,{type:"submit",disabled:p,children:p?"Salvando...":"Salvar Alteraes"})]})]})]})})]})};var _S=1,Mde=.9,Lde=.8,Fde=.17,Rv=.1,Pv=.999,Bde=.9999,Vde=.99,Ude=/[\\\/_+.#"@\[\(\{&]/,zde=/[\\\/_+.#"@\[\(\{&]/g,$de=/[\s-]/,x8=/[\s-]/g;function vw(e,t,r,a,n,i,o){if(i===t.length)return n===e.length?_S:Vde;var c=`${n},${i}`;if(o[c]!==void 0)return o[c];for(var d=a.charAt(i),h=r.indexOf(d,n),p=0,x,v,b,N;h>=0;)x=vw(e,t,r,a,h+1,i+1,o),x>p&&(h===n?x*=_S:Ude.test(e.charAt(h-1))?(x*=Lde,b=e.slice(n,h-1).match(zde),b&&n>0&&(x*=Math.pow(Pv,b.length))):$de.test(e.charAt(h-1))?(x*=Mde,N=e.slice(n,h-1).match(x8),N&&n>0&&(x*=Math.pow(Pv,N.length))):(x*=Fde,n>0&&(x*=Math.pow(Pv,h-n))),e.charAt(h)!==t.charAt(i)&&(x*=Bde)),(x<Rv&&r.charAt(h-1)===a.charAt(i+1)||a.charAt(i+1)===a.charAt(i)&&r.charAt(h-1)!==a.charAt(i))&&(v=vw(e,t,r,a,h+1,i+2,o),v*Rv>x&&(x=v*Rv)),x>p&&(p=x),h=r.indexOf(d,h+1);return o[c]=p,p}function jS(e){return e.toLowerCase().replace(x8," ")}function qde(e,t,r){return e=r&&r.length>0?`${e+" "+r.join(" ")}`:e,vw(e,t,jS(e),jS(t),0,0,{})}var Cm='[cmdk-group=""]',Iv='[cmdk-group-items=""]',Wde='[cmdk-group-heading=""]',g8='[cmdk-item=""]',NS=`${g8}:not([aria-disabled="true"])`,yw="cmdk-item-select",Nh="data-value",Hde=(e,t,r)=>qde(e,t,r),v8=E.createContext(void 0),v0=()=>E.useContext(v8),y8=E.createContext(void 0),g2=()=>E.useContext(y8),w8=E.createContext(void 0),b8=E.forwardRef((e,t)=>{let r=Ch(()=>{var W,ee;return{search:"",value:(ee=(W=e.value)!=null?W:e.defaultValue)!=null?ee:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),a=Ch(()=>new Set),n=Ch(()=>new Map),i=Ch(()=>new Map),o=Ch(()=>new Set),c=_8(e),{label:d,children:h,value:p,onValueChange:x,filter:v,shouldFilter:b,loop:N,disablePointerSelection:_=!1,vimBindings:C=!0,...T}=e,A=Ai(),k=Ai(),I=Ai(),B=E.useRef(null),O=rue();Uu(()=>{if(p!==void 0){let W=p.trim();r.current.value=W,D.emit()}},[p]),Uu(()=>{O(6,ae)},[]);let D=E.useMemo(()=>({subscribe:W=>(o.current.add(W),()=>o.current.delete(W)),snapshot:()=>r.current,setState:(W,ee,ie)=>{var ce,xe,Ce,me;if(!Object.is(r.current[W],ee)){if(r.current[W]=ee,W==="search")Y(),z(),O(1,q);else if(W==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let fe=document.getElementById(I);fe?fe.focus():(ce=document.getElementById(A))==null||ce.focus()}if(O(7,()=>{var fe;r.current.selectedItemId=(fe=je())==null?void 0:fe.id,D.emit()}),ie||O(5,ae),((xe=c.current)==null?void 0:xe.value)!==void 0){let fe=ee??"";(me=(Ce=c.current).onValueChange)==null||me.call(Ce,fe);return}}D.emit()}},emit:()=>{o.current.forEach(W=>W())}}),[]),F=E.useMemo(()=>({value:(W,ee,ie)=>{var ce;ee!==((ce=i.current.get(W))==null?void 0:ce.value)&&(i.current.set(W,{value:ee,keywords:ie}),r.current.filtered.items.set(W,M(ee,ie)),O(2,()=>{z(),D.emit()}))},item:(W,ee)=>(a.current.add(W),ee&&(n.current.has(ee)?n.current.get(ee).add(W):n.current.set(ee,new Set([W]))),O(3,()=>{Y(),z(),r.current.value||q(),D.emit()}),()=>{i.current.delete(W),a.current.delete(W),r.current.filtered.items.delete(W);let ie=je();O(4,()=>{Y(),(ie==null?void 0:ie.getAttribute("id"))===W&&q(),D.emit()})}),group:W=>(n.current.has(W)||n.current.set(W,new Set),()=>{i.current.delete(W),n.current.delete(W)}),filter:()=>c.current.shouldFilter,label:d||e["aria-label"],getDisablePointerSelection:()=>c.current.disablePointerSelection,listId:A,inputId:I,labelId:k,listInnerRef:B}),[]);function M(W,ee){var ie,ce;let xe=(ce=(ie=c.current)==null?void 0:ie.filter)!=null?ce:Hde;return W?xe(W,r.current.search,ee):0}function z(){if(!r.current.search||c.current.shouldFilter===!1)return;let W=r.current.filtered.items,ee=[];r.current.filtered.groups.forEach(ce=>{let xe=n.current.get(ce),Ce=0;xe.forEach(me=>{let fe=W.get(me);Ce=Math.max(fe,Ce)}),ee.push([ce,Ce])});let ie=B.current;H().sort((ce,xe)=>{var Ce,me;let fe=ce.getAttribute("id"),ve=xe.getAttribute("id");return((Ce=W.get(ve))!=null?Ce:0)-((me=W.get(fe))!=null?me:0)}).forEach(ce=>{let xe=ce.closest(Iv);xe?xe.appendChild(ce.parentElement===xe?ce:ce.closest(`${Iv} > *`)):ie.appendChild(ce.parentElement===ie?ce:ce.closest(`${Iv} > *`))}),ee.sort((ce,xe)=>xe[1]-ce[1]).forEach(ce=>{var xe;let Ce=(xe=B.current)==null?void 0:xe.querySelector(`${Cm}[${Nh}="${encodeURIComponent(ce[0])}"]`);Ce==null||Ce.parentElement.appendChild(Ce)})}function q(){let W=H().find(ie=>ie.getAttribute("aria-disabled")!=="true"),ee=W==null?void 0:W.getAttribute(Nh);D.setState("value",ee||void 0)}function Y(){var W,ee,ie,ce;if(!r.current.search||c.current.shouldFilter===!1){r.current.filtered.count=a.current.size;return}r.current.filtered.groups=new Set;let xe=0;for(let Ce of a.current){let me=(ee=(W=i.current.get(Ce))==null?void 0:W.value)!=null?ee:"",fe=(ce=(ie=i.current.get(Ce))==null?void 0:ie.keywords)!=null?ce:[],ve=M(me,fe);r.current.filtered.items.set(Ce,ve),ve>0&&xe++}for(let[Ce,me]of n.current)for(let fe of me)if(r.current.filtered.items.get(fe)>0){r.current.filtered.groups.add(Ce);break}r.current.filtered.count=xe}function ae(){var W,ee,ie;let ce=je();ce&&(((W=ce.parentElement)==null?void 0:W.firstChild)===ce&&((ie=(ee=ce.closest(Cm))==null?void 0:ee.querySelector(Wde))==null||ie.scrollIntoView({block:"nearest"})),ce.scrollIntoView({block:"nearest"}))}function je(){var W;return(W=B.current)==null?void 0:W.querySelector(`${g8}[aria-selected="true"]`)}function H(){var W;return Array.from(((W=B.current)==null?void 0:W.querySelectorAll(NS))||[])}function Z(W){let ee=H()[W];ee&&D.setState("value",ee.getAttribute(Nh))}function G(W){var ee;let ie=je(),ce=H(),xe=ce.findIndex(me=>me===ie),Ce=ce[xe+W];(ee=c.current)!=null&&ee.loop&&(Ce=xe+W<0?ce[ce.length-1]:xe+W===ce.length?ce[0]:ce[xe+W]),Ce&&D.setState("value",Ce.getAttribute(Nh))}function Q(W){let ee=je(),ie=ee==null?void 0:ee.closest(Cm),ce;for(;ie&&!ce;)ie=W>0?tue(ie,Cm):sue(ie,Cm),ce=ie==null?void 0:ie.querySelector(NS);ce?D.setState("value",ce.getAttribute(Nh)):G(W)}let re=()=>Z(H().length-1),le=W=>{W.preventDefault(),W.metaKey?re():W.altKey?Q(1):G(1)},ye=W=>{W.preventDefault(),W.metaKey?Z(0):W.altKey?Q(-1):G(-1)};return E.createElement(ys.div,{ref:t,tabIndex:-1,...T,"cmdk-root":"",onKeyDown:W=>{var ee;(ee=T.onKeyDown)==null||ee.call(T,W);let ie=W.nativeEvent.isComposing||W.keyCode===229;if(!(W.defaultPrevented||ie))switch(W.key){case"n":case"j":{C&&W.ctrlKey&&le(W);break}case"ArrowDown":{le(W);break}case"p":case"k":{C&&W.ctrlKey&&ye(W);break}case"ArrowUp":{ye(W);break}case"Home":{W.preventDefault(),Z(0);break}case"End":{W.preventDefault(),re();break}case"Enter":{W.preventDefault();let ce=je();if(ce){let xe=new Event(yw);ce.dispatchEvent(xe)}}}}},E.createElement("label",{"cmdk-label":"",htmlFor:F.inputId,id:F.labelId,style:nue},d),h1(e,W=>E.createElement(y8.Provider,{value:D},E.createElement(v8.Provider,{value:F},W))))}),Gde=E.forwardRef((e,t)=>{var r,a;let n=Ai(),i=E.useRef(null),o=E.useContext(w8),c=v0(),d=_8(e),h=(a=(r=d.current)==null?void 0:r.forceMount)!=null?a:o==null?void 0:o.forceMount;Uu(()=>{if(!h)return c.item(n,o==null?void 0:o.id)},[h]);let p=j8(n,i,[e.value,e.children,i],e.keywords),x=g2(),v=Dd(O=>O.value&&O.value===p.current),b=Dd(O=>h||c.filter()===!1?!0:O.search?O.filtered.items.get(n)>0:!0);E.useEffect(()=>{let O=i.current;if(!(!O||e.disabled))return O.addEventListener(yw,N),()=>O.removeEventListener(yw,N)},[b,e.onSelect,e.disabled]);function N(){var O,D;_(),(D=(O=d.current).onSelect)==null||D.call(O,p.current)}function _(){x.setState("value",p.current,!0)}if(!b)return null;let{disabled:C,value:T,onSelect:A,forceMount:k,keywords:I,...B}=e;return E.createElement(ys.div,{ref:Jm(i,t),...B,id:n,"cmdk-item":"",role:"option","aria-disabled":!!C,"aria-selected":!!v,"data-disabled":!!C,"data-selected":!!v,onPointerMove:C||c.getDisablePointerSelection()?void 0:_,onClick:C?void 0:N},e.children)}),Kde=E.forwardRef((e,t)=>{let{heading:r,children:a,forceMount:n,...i}=e,o=Ai(),c=E.useRef(null),d=E.useRef(null),h=Ai(),p=v0(),x=Dd(b=>n||p.filter()===!1?!0:b.search?b.filtered.groups.has(o):!0);Uu(()=>p.group(o),[]),j8(o,c,[e.value,e.heading,d]);let v=E.useMemo(()=>({id:o,forceMount:n}),[n]);return E.createElement(ys.div,{ref:Jm(c,t),...i,"cmdk-group":"",role:"presentation",hidden:x?void 0:!0},r&&E.createElement("div",{ref:d,"cmdk-group-heading":"","aria-hidden":!0,id:h},r),h1(e,b=>E.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?h:void 0},E.createElement(w8.Provider,{value:v},b))))}),Xde=E.forwardRef((e,t)=>{let{alwaysRender:r,...a}=e,n=E.useRef(null),i=Dd(o=>!o.search);return!r&&!i?null:E.createElement(ys.div,{ref:Jm(n,t),...a,"cmdk-separator":"",role:"separator"})}),Yde=E.forwardRef((e,t)=>{let{onValueChange:r,...a}=e,n=e.value!=null,i=g2(),o=Dd(h=>h.search),c=Dd(h=>h.selectedItemId),d=v0();return E.useEffect(()=>{e.value!=null&&i.setState("search",e.value)},[e.value]),E.createElement(ys.input,{ref:t,...a,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":d.listId,"aria-labelledby":d.labelId,"aria-activedescendant":c,id:d.inputId,type:"text",value:n?e.value:o,onChange:h=>{n||i.setState("search",h.target.value),r==null||r(h.target.value)}})}),Zde=E.forwardRef((e,t)=>{let{children:r,label:a="Suggestions",...n}=e,i=E.useRef(null),o=E.useRef(null),c=Dd(h=>h.selectedItemId),d=v0();return E.useEffect(()=>{if(o.current&&i.current){let h=o.current,p=i.current,x,v=new ResizeObserver(()=>{x=requestAnimationFrame(()=>{let b=h.offsetHeight;p.style.setProperty("--cmdk-list-height",b.toFixed(1)+"px")})});return v.observe(h),()=>{cancelAnimationFrame(x),v.unobserve(h)}}},[]),E.createElement(ys.div,{ref:Jm(i,t),...n,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":c,"aria-label":a,id:d.listId},h1(e,h=>E.createElement("div",{ref:Jm(o,d.listInnerRef),"cmdk-list-sizer":""},h)))}),Qde=E.forwardRef((e,t)=>{let{open:r,onOpenChange:a,overlayClassName:n,contentClassName:i,container:o,...c}=e;return E.createElement(Wp,{open:r,onOpenChange:a},E.createElement(qp,{container:o},E.createElement(zu,{"cmdk-overlay":"",className:n}),E.createElement($u,{"aria-label":e.label,"cmdk-dialog":"",className:i},E.createElement(b8,{ref:t,...c}))))}),Jde=E.forwardRef((e,t)=>Dd(r=>r.filtered.count===0)?E.createElement(ys.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),eue=E.forwardRef((e,t)=>{let{progress:r,children:a,label:n="Loading...",...i}=e;return E.createElement(ys.div,{ref:t,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":n},h1(e,o=>E.createElement("div",{"aria-hidden":!0},o)))}),Di=Object.assign(b8,{List:Zde,Item:Gde,Input:Yde,Group:Kde,Separator:Xde,Dialog:Qde,Empty:Jde,Loading:eue});function tue(e,t){let r=e.nextElementSibling;for(;r;){if(r.matches(t))return r;r=r.nextElementSibling}}function sue(e,t){let r=e.previousElementSibling;for(;r;){if(r.matches(t))return r;r=r.previousElementSibling}}function _8(e){let t=E.useRef(e);return Uu(()=>{t.current=e}),t}var Uu=typeof window>"u"?E.useEffect:E.useLayoutEffect;function Ch(e){let t=E.useRef();return t.current===void 0&&(t.current=e()),t}function Dd(e){let t=g2(),r=()=>e(t.snapshot());return E.useSyncExternalStore(t.subscribe,r,r)}function j8(e,t,r,a=[]){let n=E.useRef(),i=v0();return Uu(()=>{var o;let c=(()=>{var h;for(let p of r){if(typeof p=="string")return p.trim();if(typeof p=="object"&&"current"in p)return p.current?(h=p.current.textContent)==null?void 0:h.trim():n.current}})(),d=a.map(h=>h.trim());i.value(e,c,d),(o=t.current)==null||o.setAttribute(Nh,c),n.current=c}),n}var rue=()=>{let[e,t]=E.useState(),r=Ch(()=>new Map);return Uu(()=>{r.current.forEach(a=>a()),r.current=new Map},[e]),(a,n)=>{r.current.set(a,n),t({})}};function aue(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function h1({asChild:e,children:t},r){return e&&E.isValidElement(t)?E.cloneElement(aue(t),{ref:t.ref},r(t.props.children)):r(t)}var nue={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const ww=E.forwardRef(({className:e,...t},r)=>s.jsx(Di,{ref:r,className:pt("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));ww.displayName=Di.displayName;const bw=E.forwardRef(({className:e,...t},r)=>s.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[s.jsx(eo,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),s.jsx(Di.Input,{ref:r,className:pt("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));bw.displayName=Di.Input.displayName;const _w=E.forwardRef(({className:e,...t},r)=>s.jsx(Di.List,{ref:r,className:pt("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));_w.displayName=Di.List.displayName;const jw=E.forwardRef((e,t)=>s.jsx(Di.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));jw.displayName=Di.Empty.displayName;const Nw=E.forwardRef(({className:e,...t},r)=>s.jsx(Di.Group,{ref:r,className:pt("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));Nw.displayName=Di.Group.displayName;const iue=E.forwardRef(({className:e,...t},r)=>s.jsx(Di.Separator,{ref:r,className:pt("-mx-1 h-px bg-border",e),...t}));iue.displayName=Di.Separator.displayName;const Cw=E.forwardRef(({className:e,...t},r)=>s.jsx(Di.Item,{ref:r,className:pt("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",e),...t}));Cw.displayName=Di.Item.displayName;const ix=e=>{const t=e.match(/\d+$/);return t?parseInt(t[0],10):0},CS=e=>{if(!e)return"";const t=e.match(/\d+/);return t?String(parseInt(t[0],10)):""},oue=()=>{var Lt,ps,ns;const[e,t]=E.useState([]),[r,a]=E.useState([]),[n,i]=E.useState(!0),[o,c]=E.useState(null),[d,h]=E.useState(null),[p,x]=E.useState(!1),[v,b]=E.useState(!1),[N,_]=E.useState(null),[C,T]=E.useState(new Set),[A]=E.useState(50),[k,I]=E.useState({}),[B,O]=E.useState(!1),[D,F]=E.useState(null),[M,z]=E.useState(""),[q,Y]=E.useState(""),[ae,je]=E.useState(null),[H,Z]=E.useState(!1),[G,Q]=E.useState(!1),[re,le]=E.useState(!1),[ye,W]=E.useState(!1),{toast:ee}=_r(),ie=E.useMemo(()=>{if(!D)return[];const Ke=e.find(dt=>dt.id===D);return Ke?Ke.quotas.filter(dt=>!dt.id_investidor).map(dt=>({id:dt.id,numero_quota:dt.numero_quota,num:ix(dt.numero_quota)})).sort((dt,It)=>dt.num-It.num):[]},[D,e]);E.useEffect(()=>{ce()},[]);const ce=async()=>{try{i(!0);const{data:Ke,error:dt}=await J.from("cdv_investidores").select("*").order("razao_social");if(dt)throw dt;a(Ke||[]);const{data:It,error:Ut}=await J.from("cdv_projetos").select("id, titulo, prazo_maturacao_meses, total_quotas").order("created_at",{ascending:!1});if(Ut)throw Ut;const ts=await Promise.all((It||[]).map(async us=>{let qe=[],jt=0;const _t=1e3;let Re=!0;for(;Re;){const{data:et,error:Ct}=await J.from("cdv_quotas").select(`
                *,
                cdv_investidores (
                  razao_social,
                  cnpj
                )
              `).eq("id_projeto",us.id).order("numero_quota").range(jt,jt+_t-1);if(Ct)throw Ct;et&&et.length>0?(qe=[...qe,...et],jt+=_t,Re=et.length===_t):Re=!1}return{...us,quotas:qe}}));t(ts)}catch(Ke){ee({title:"Erro ao carregar dados",description:Ke.message,variant:"destructive"})}finally{i(!1)}},xe=Ke=>{const dt=Ke.meta_kg_residuos||250,It=Ke.meta_horas_educacao||5,Ut=Ke.meta_embalagens||1,ts=Math.min(Ke.kg_conciliados/dt*100,100),us=Math.min(Ke.horas_conciliadas/It*100,100),qe=Math.min(Ke.embalagens_conciliadas/Ut*100,100);return Math.min((ts+us+qe)/3,100)},Ce=(Ke,dt)=>{if(!Ke.data_maturacao||!dt.prazo_maturacao_meses)return"N/A";const It=Math.ceil(dt.prazo_maturacao_meses/12),Ut=Math.ceil(dt.total_quotas/It),ts=parseInt(Ke.numero_quota.split("-")[1]);return`${Math.ceil(ts/Ut)} Ano`},me=Ke=>Ke?new Date(Ke).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}):"No definido",fe=Ke=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Ke),ve=Ke=>{const dt={em_geracao:{label:"Em Gerao",variant:"secondary"},pronto:{label:"Pronto",variant:"default"},certificado_emitido:{label:"Certificado Emitido",variant:"default"}},It=dt[Ke]||dt.em_geracao;return s.jsx(Je,{variant:It.variant,children:It.label})},ne=Ke=>{if(!Ke.status_maturacao)return s.jsx(Je,{variant:"secondary",children:"No atribuda"});const dt={no_prazo:{icon:Tr,label:"No Prazo",variant:"default"},em_maturacao:{icon:Gn,label:"Em Maturao",variant:"secondary"},atrasada:{icon:un,label:"Atrasada",variant:"destructive"}},It=dt[Ke.status_maturacao]||dt.no_prazo,Ut=It.icon;return s.jsxs(Je,{variant:It.variant,className:"flex items-center gap-1",children:[s.jsx(Ut,{className:"h-3 w-3"}),It.label]})},Me=Ke=>{const dt=new Map,It=Ke.filter(Ut=>!Ut.id_investidor);return It.length>0&&dt.set("disponivel",{investidor:null,quotas:It,progressoTotal:0,todasCompletas:!1}),Ke.filter(Ut=>Ut.id_investidor).forEach(Ut=>{const ts=Ut.id_investidor;dt.has(ts)||dt.set(ts,{investidor:Ut.cdv_investidores?{id:Ut.id_investidor,razao_social:Ut.cdv_investidores.razao_social,cnpj:Ut.cdv_investidores.cnpj}:null,quotas:[],progressoTotal:0,todasCompletas:!1}),dt.get(ts).quotas.push(Ut)}),dt.forEach(Ut=>{if(Ut.investidor){const ts=Ut.quotas.map(xe);Ut.progressoTotal=ts.reduce((us,qe)=>us+qe,0)/ts.length,Ut.todasCompletas=Ut.quotas.every(us=>xe(us)>=100)}}),Array.from(dt.values())},Ie=async Ke=>{try{const{data:dt,error:It}=await J.from("cdv_investidores").select("*").eq("id",Ke).single();if(It||!dt){console.error("Investidor no encontrado:",It);return}if(dt.convite_enviado)return;const Ut=Math.random().toString(36).slice(-12)+"A1!",{data:ts,error:us}=await J.auth.signUp({email:dt.email,password:Ut,options:{data:{nome:dt.nome_responsavel,tipo_pessoa:"PJ",cnpj:dt.cnpj,cep:"00000-000",role:"investidor"},emailRedirectTo:Il("/cdv/investor")}});if(us)throw console.error("Erro ao criar usurio auth:",us),us;if(!ts.user)throw new Error("Falha ao criar usurio");await new Promise(et=>setTimeout(et,1e3));try{await J.rpc("confirmar_email_usuario",{usuario_id:ts.user.id})}catch(et){console.error("Erro ao confirmar email automaticamente:",et)}await J.from("cdv_investidores").update({id_user:ts.user.id}).eq("id",Ke);const{error:qe}=await J.from("user_roles").insert({user_id:ts.user.id,role:"investidor"}).select().single();qe&&!qe.message.includes("duplicate key")&&console.error("Erro ao atribuir role investidor:",qe);const{data:jt,error:_t}=await J.auth.resetPasswordForEmail(dt.email,{redirectTo:Il("/reset-password")});_t&&console.error("Erro ao gerar link de reset:",_t);const{error:Re}=await J.functions.invoke("enviar-convite-investidor",{body:{email:dt.email,razaoSocial:dt.razao_social,nomeResponsavel:dt.nome_responsavel,resetLink:Il("/reset-password"),idInvestidor:Ke}});if(Re)throw console.error("Erro ao enviar email de convite:",Re),Re;ee({title:"Convite enviado",description:`Email de acesso enviado para ${dt.email}`})}catch(dt){console.error("Erro ao enviar convite:",dt),ee({title:"Aviso",description:"Quotas atribudas, mas houve um problema ao enviar o email de convite.",variant:"destructive"})}},Be=async()=>{if(!(!o||!d))try{const Ke=e.find(qe=>qe.quotas.some(jt=>jt.id===o));if(!Ke)return;const dt=r.find(qe=>qe.id===d),It=!(dt!=null&&dt.convite_enviado),Ut=new Date,ts=new Date(Ut);ts.setMonth(ts.getMonth()+Ke.prazo_maturacao_meses);const{error:us}=await J.from("cdv_quotas").update({id_investidor:d,data_atribuicao:Ut.toISOString(),data_maturacao:ts.toISOString(),status_maturacao:"no_prazo"}).eq("id",o);if(us)throw us;It&&await Ie(d),ee({title:"Investidor atribudo",description:It?"Quota atribuda e convite de acesso enviado ao investidor.":"Quota atribuda com sucesso ao investidor."}),x(!1),c(null),h(null),ce()}catch(Ke){ee({title:"Erro ao atribuir investidor",description:Ke.message,variant:"destructive"})}},ot=()=>{if(!D||!M||!q)return[];const Ke=parseInt(M,10),dt=parseInt(q,10);if(isNaN(Ke)||isNaN(dt)||Ke<=0||dt<=0)return[];const[It,Ut]=Ke<=dt?[Ke,dt]:[dt,Ke],ts=e.find(us=>us.id===D);return ts?ts.quotas.filter(us=>{if(us.id_investidor)return!1;const qe=ix(us.numero_quota);return qe>=It&&qe<=Ut}).sort((us,qe)=>ix(us.numero_quota)-ix(qe.numero_quota)):[]},Se=()=>{if(!D)return{total:0,available:0,inRange:0};const Ke=e.find(Ut=>Ut.id===D);if(!Ke)return{total:0,available:0,inRange:0};const dt=Ke.quotas.filter(Ut=>!Ut.id_investidor).length,It=ot().length;return{total:Ke.total_quotas||0,available:dt,inRange:It}},ze=async()=>{if(!ae||!D){ee({title:"Campos obrigatrios",description:"Selecione o projeto e o investidor.",variant:"destructive"});return}const Ke=ot();if(Ke.length===0){ee({title:"Nenhuma quota no range",description:"O range especificado no contm quotas disponveis para atribuio.",variant:"destructive"});return}try{Q(!0);const dt=e.find(_t=>_t.id===D);if(!dt)throw new Error("Projeto no encontrado");const It=r.find(_t=>_t.id===ae),Ut=!(It!=null&&It.convite_enviado),ts=new Date,us=new Date(ts);us.setMonth(us.getMonth()+(dt.prazo_maturacao_meses||12));const qe=Ke.map(_t=>_t.id),{error:jt}=await J.from("cdv_quotas").update({id_investidor:ae,data_atribuicao:ts.toISOString(),data_maturacao:us.toISOString(),status_maturacao:"no_prazo"}).in("id",qe);if(jt)throw jt;Ut&&await Ie(ae),ee({title:"Quotas atribudas com sucesso!",description:Ut?`${Ke.length} quota(s) atribuda(s) e convite enviado ao investidor.`:`${Ke.length} quota(s) atribuda(s) ao investidor.`}),Z(!1),F(null),z(""),Y(""),je(null),ce()}catch(dt){console.error("Erro ao atribuir quotas:",dt),ee({title:"Erro ao atribuir investidor",description:dt.message,variant:"destructive"})}finally{Q(!1)}},we=async()=>{if(!(!N||!N.investidor))try{const Ke=N.quotas.map(Re=>Re.id),dt=e.find(Re=>Re.quotas.some(et=>Ke.includes(et.id)));if(!dt)return;const It=N.quotas.reduce((Re,et)=>Re+et.kg_conciliados,0),Ut=N.quotas.reduce((Re,et)=>Re+et.horas_conciliadas,0),ts=N.quotas.reduce((Re,et)=>Re+et.embalagens_conciliadas,0),us=`CDV-${new Date().getFullYear()}-${Math.random().toString(36).substr(2,9).toUpperCase()}`,qe=Math.random().toString(36).substr(2,16).toUpperCase(),{error:jt}=await J.from("cdv_certificados").insert({id_projeto:dt.id,id_investidor:N.investidor.id,quotas_incluidas:Ke,total_quotas:Ke.length,numero_certificado:us,hash_validacao:qe,cnpj:N.investidor.cnpj,razao_social:N.investidor.razao_social,kg_certificados:It,horas_certificadas:Ut,embalagens_certificadas:ts,periodo_inicio:N.quotas[0].data_compra,periodo_fim:N.quotas[0].data_maturacao});if(jt)throw jt;const{error:_t}=await J.from("cdv_quotas").update({status:"certificado_emitido"}).in("id",Ke);if(_t)throw _t;ee({title:"Certificado emitido",description:`Certificado ${us} emitido com sucesso para ${N.quotas.length} quota(s).`}),b(!1),_(null),ce()}catch(Ke){ee({title:"Erro ao emitir certificado",description:Ke.message,variant:"destructive"})}},Le=Ke=>{T(dt=>{const It=new Set(dt);return It.has(Ke)?It.delete(Ke):(It.add(Ke),k[Ke]||I(Ut=>({...Ut,[Ke]:1}))),It})},Nt=Ke=>{I(dt=>({...dt,[Ke]:(dt[Ke]||1)+1}))},Ge=async Ke=>{try{O(!0);const{data:dt,error:It}=await J.rpc("distribuir_datas_maturacao_quotas",{p_id_projeto:Ke});if(It)throw It;ee({title:"Datas distribudas",description:`${dt} quotas tiveram suas datas de maturao distribudas automaticamente.`}),ce()}catch(dt){ee({title:"Erro ao distribuir datas",description:dt.message,variant:"destructive"})}finally{O(!1)}};return n?s.jsx("div",{className:"flex justify-center p-8",children:"Carregando..."}):s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Quotas CDV por Projeto"}),s.jsx("p",{className:"text-muted-foreground",children:"Gesto de quotas agrupadas por projeto e investidor"})]})}),s.jsxs(Ne,{className:"border-primary/30 bg-primary/5",children:[s.jsxs(Ye,{className:"pb-4",children:[s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(oa,{className:"h-5 w-5"}),"Atribuio em Lote"]}),s.jsx(Tt,{children:"Digite o range de nmeros de quota (ex: 1 at 100) para atribuir ao investidor"})]}),s.jsxs(De,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-end",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("label",{className:"text-sm font-medium",children:"Projeto"}),s.jsxs(Xn,{children:[s.jsx(Yn,{asChild:!0,children:s.jsx(Yi,{className:"h-3.5 w-3.5 text-muted-foreground cursor-help"})}),s.jsx(kn,{side:"top",className:"max-w-xs",children:s.jsx("p",{children:"Selecione o projeto CDV que contm as quotas a serem atribudas. Apenas projetos com quotas disponveis so mostrados."})})]})]}),s.jsxs(qs,{value:D||"",onValueChange:Ke=>{F(Ke),z(""),Y("")},children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Selecione o projeto"})}),s.jsx(Fs,{children:e.map(Ke=>{const dt=Ke.quotas.filter(It=>!It.id_investidor).length;return s.jsxs(xt,{value:Ke.id,disabled:dt===0,children:[Ke.titulo," (",dt," disponveis)"]},Ke.id)})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("label",{className:"text-sm font-medium",children:"Quota Inicial (n)"}),s.jsxs(Xn,{children:[s.jsx(Yn,{asChild:!0,children:s.jsx(Yi,{className:"h-3.5 w-3.5 text-muted-foreground cursor-help"})}),s.jsx(kn,{side:"top",className:"max-w-xs",children:s.jsx("p",{children:"Digite ou selecione a primeira quota do range a ser atribudo."})})]})]}),s.jsxs(bl,{open:re,onOpenChange:le,children:[s.jsx(_l,{asChild:!0,children:s.jsxs(oe,{variant:"outline",role:"combobox","aria-expanded":re,disabled:!D,className:"w-full justify-between font-normal",children:[M?s.jsx("span",{children:((Lt=ie.find(Ke=>String(Ke.num)===M))==null?void 0:Lt.numero_quota)||`N ${M}`}):s.jsx("span",{className:"text-muted-foreground",children:"Ex: 1 ou CIC-0001"}),s.jsx(B2,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),s.jsx(Xo,{className:"w-[240px] p-0",align:"start",children:s.jsxs(ww,{shouldFilter:!1,children:[s.jsx(bw,{placeholder:"Digite n ou cdigo (ex: CIC-0001)...",onValueChange:Ke=>{const dt=CS(Ke);(dt||Ke==="")&&z(dt)}}),s.jsxs(_w,{children:[s.jsx(jw,{children:M?s.jsxs("div",{className:"w-full p-2 text-sm text-left hover:bg-accent rounded cursor-pointer",onClick:()=>{le(!1)},children:["Usar: ",s.jsxs("span",{className:"font-medium",children:["Quota n ",M]})]}):"Digite um nmero ou cdigo de quota"}),s.jsx(Nw,{heading:`Quotas disponveis (${ie.length})`,children:ie.filter(Ke=>!M||String(Ke.num).includes(M)||Ke.numero_quota.toLowerCase().includes(M.toLowerCase())).map(Ke=>s.jsxs(Cw,{value:Ke.numero_quota,onSelect:()=>{z(String(Ke.num)),le(!1)},children:[s.jsx(Ea,{className:pt("mr-2 h-4 w-4",M===String(Ke.num)?"opacity-100":"opacity-0")}),Ke.numero_quota," (n ",Ke.num,")"]},Ke.id))})]})]})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("label",{className:"text-sm font-medium",children:"Quota Final (n)"}),s.jsxs(Xn,{children:[s.jsx(Yn,{asChild:!0,children:s.jsx(Yi,{className:"h-3.5 w-3.5 text-muted-foreground cursor-help"})}),s.jsx(kn,{side:"top",className:"max-w-xs",children:s.jsx("p",{children:"Digite ou selecione a ltima quota do range. Todas as quotas disponveis entre a inicial e final sero atribudas."})})]})]}),s.jsxs(bl,{open:ye,onOpenChange:W,children:[s.jsx(_l,{asChild:!0,children:s.jsxs(oe,{variant:"outline",role:"combobox","aria-expanded":ye,disabled:!D,className:"w-full justify-between font-normal",children:[q?s.jsx("span",{children:((ps=ie.find(Ke=>String(Ke.num)===q))==null?void 0:ps.numero_quota)||`N ${q}`}):s.jsx("span",{className:"text-muted-foreground",children:"Ex: 100 ou CIC-0100"}),s.jsx(B2,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),s.jsx(Xo,{className:"w-[240px] p-0",align:"start",children:s.jsxs(ww,{shouldFilter:!1,children:[s.jsx(bw,{placeholder:"Digite n ou cdigo (ex: CIC-0100)...",onValueChange:Ke=>{const dt=CS(Ke);(dt||Ke==="")&&Y(dt)}}),s.jsxs(_w,{children:[s.jsx(jw,{children:q?s.jsxs("div",{className:"w-full p-2 text-sm text-left hover:bg-accent rounded cursor-pointer",onClick:()=>{W(!1)},children:["Usar: ",s.jsxs("span",{className:"font-medium",children:["Quota n ",q]})]}):"Digite um nmero ou cdigo de quota"}),s.jsx(Nw,{heading:`Quotas disponveis (${ie.length})`,children:ie.filter(Ke=>!q||String(Ke.num).includes(q)||Ke.numero_quota.toLowerCase().includes(q.toLowerCase())).map(Ke=>s.jsxs(Cw,{value:Ke.numero_quota,onSelect:()=>{Y(String(Ke.num)),W(!1)},children:[s.jsx(Ea,{className:pt("mr-2 h-4 w-4",q===String(Ke.num)?"opacity-100":"opacity-0")}),Ke.numero_quota," (n ",Ke.num,")"]},Ke.id))})]})]})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("label",{className:"text-sm font-medium",children:"Investidor"}),s.jsxs(Xn,{children:[s.jsx(Yn,{asChild:!0,children:s.jsx(Yi,{className:"h-3.5 w-3.5 text-muted-foreground cursor-help"})}),s.jsx(kn,{side:"top",className:"max-w-xs",children:s.jsx("p",{children:"Investidor que receber as quotas. Se for a primeira atribuio deste investidor, um convite de acesso ser enviado automaticamente."})})]})]}),s.jsxs(qs,{value:ae||"",onValueChange:je,children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Selecione o investidor"})}),s.jsx(Fs,{children:r.map(Ke=>s.jsx(xt,{value:Ke.id,children:Ke.razao_social},Ke.id))})]})]}),s.jsxs(Xn,{children:[s.jsx(Yn,{asChild:!0,children:s.jsx(oe,{onClick:()=>Z(!0),disabled:!M||!q||!ae||!D||G,className:"w-full",children:G?"Atribuindo...":`Atribuir ${ot().length>0?`${ot().length} quota(s)`:""}`})}),s.jsx(kn,{side:"bottom",className:"max-w-xs",children:s.jsx("p",{children:"Confirme e atribua todas as quotas do range selecionado ao investidor. As quotas j atribudas sero ignoradas."})})]})]}),D&&s.jsx("div",{className:"mt-4 p-3 bg-muted rounded-lg text-sm",children:s.jsxs("div",{className:"flex gap-6",children:[s.jsxs("span",{children:["Total de quotas: ",s.jsx("strong",{children:Se().total})]}),s.jsxs("span",{children:["Disponveis: ",s.jsx("strong",{className:"text-primary",children:Se().available})]}),ot().length>0&&s.jsxs("span",{children:["No range selecionado: ",s.jsx("strong",{className:"text-green-600",children:Se().inRange})]})]})})]})]}),e.length===0?s.jsx(Ne,{children:s.jsx(De,{className:"py-8 text-center text-muted-foreground",children:"Nenhum projeto com quotas encontrado."})}):s.jsx("div",{className:"space-y-4",children:e.map(Ke=>{const dt=k[Ke.id]||1,It=Ke.quotas.slice(0,dt*A),Ut=Me(It),ts=C.has(Ke.id),us=Ke.total_quotas||0,qe=Ke.quotas.filter(Re=>Re.id_investidor).length,jt=us-qe,_t=It.length<Ke.quotas.length;return s.jsx(Ne,{children:s.jsxs(vx,{open:ts,onOpenChange:()=>Le(Ke.id),children:[s.jsxs(Ye,{className:"p-0",children:[s.jsx(yx,{className:"w-full",children:s.jsx("div",{className:"cursor-pointer hover:bg-accent/50 transition-colors p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Qn,{className:"h-6 w-6 text-primary"}),s.jsxs("div",{className:"text-left",children:[s.jsx(Qe,{children:Ke.titulo}),s.jsxs(Tt,{children:[us," quotas totais  ",qe," atribudas  ",jt," ","disponveis"]})]})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(Je,{variant:"outline",children:["Prazo: ",Ke.prazo_maturacao_meses||12," meses"]}),s.jsx(Ir,{className:`h-5 w-5 transition-transform ${ts?"rotate-180":""}`})]})]})})}),!ts&&s.jsx("div",{className:"px-6 pb-4",children:s.jsxs(oe,{variant:"outline",size:"sm",onClick:Re=>{Re.stopPropagation(),Ge(Ke.id)},disabled:B,children:[s.jsx(Fa,{className:"h-4 w-4 mr-2"}),"Distribuir Datas de Maturao"]})})]}),s.jsx(wx,{children:s.jsxs(De,{className:"space-y-6 pt-0",children:[s.jsx("div",{className:"border rounded-lg overflow-hidden",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-muted",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Quota"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Bloco"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Vencimento"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Investidor"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Status"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Maturao"}),s.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium",children:"Progresso"}),s.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium",children:"Valor"})]})}),s.jsx("tbody",{className:"divide-y",children:It.map(Re=>{const et=xe(Re),Ct=Re.cdv_investidores;return s.jsxs("tr",{className:"hover:bg-muted/50",children:[s.jsx("td",{className:"px-4 py-3",children:s.jsx(Je,{variant:"outline",className:"font-mono",children:Re.numero_quota})}),s.jsx("td",{className:"px-4 py-3",children:s.jsx(Je,{variant:"secondary",children:Ce(Re,Ke)})}),s.jsx("td",{className:"px-4 py-3 text-sm",children:me(Re.data_maturacao)}),s.jsx("td",{className:"px-4 py-3 text-sm",children:Ct?s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:Ct.razao_social}),s.jsx("p",{className:"text-xs text-muted-foreground",children:Ct.cnpj})]}):s.jsx("span",{className:"text-muted-foreground",children:"Disponvel"})}),s.jsx("td",{className:"px-4 py-3",children:ve(Re.status)}),s.jsx("td",{className:"px-4 py-3",children:ne(Re)}),s.jsx("td",{className:"px-4 py-3",children:s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsx(fn,{value:et,className:"w-24 h-2"}),s.jsxs("span",{className:"text-sm font-medium w-12 text-right",children:[et.toLocaleString("pt-BR",{maximumFractionDigits:0}),"%"]})]})}),s.jsx("td",{className:"px-4 py-3 text-sm text-right font-medium",children:fe(Re.valor_pago)})]},Re.id)})})]})})}),_t&&s.jsx("div",{className:"flex justify-center",children:s.jsxs(oe,{variant:"outline",onClick:()=>Nt(Ke.id),children:["Carregar mais quotas (",It.length," de ",Ke.quotas.length,")"]})}),s.jsx("div",{className:"space-y-4 mt-6",children:Ut.map((Re,et)=>Re.investidor?s.jsx("div",{className:"border rounded-lg p-4 space-y-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-lg",children:Re.investidor.razao_social}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["CNPJ: ",Re.investidor.cnpj,"  ",Re.quotas.length," quota",Re.quotas.length!==1?"s":""]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Progresso Total"}),s.jsxs("p",{className:"text-xl font-bold",children:[Re.progressoTotal.toLocaleString("pt-BR",{minimumFractionDigits:1,maximumFractionDigits:1}),"%"]})]}),Re.todasCompletas&&s.jsxs(oe,{onClick:()=>{_(Re),b(!0)},className:"gap-2",children:[s.jsx(Qn,{className:"h-4 w-4"}),"Emitir Certificado"]})]})]})},et):null)})]})})]})},Ke.id)})}),s.jsx(hc,{open:p,onOpenChange:x,children:s.jsxs(Dl,{children:[s.jsxs(Ml,{children:[s.jsx(Fl,{children:"Atribuir Investidor  Quota"}),s.jsx(Bl,{children:"Confirma a atribuio desta quota ao investidor selecionado? A data de maturao ser calculada automaticamente."})]}),s.jsxs(Ll,{children:[s.jsx(Ul,{children:"Cancelar"}),s.jsx(Vl,{onClick:Be,children:"Confirmar Atribuio"})]})]})}),s.jsx(hc,{open:v,onOpenChange:b,children:s.jsxs(Dl,{children:[s.jsxs(Ml,{children:[s.jsx(Fl,{children:"Emitir Certificado Consolidado"}),s.jsx(Bl,{children:N&&s.jsxs(s.Fragment,{children:["Ser emitido um certificado consolidado para ",s.jsx("strong",{children:(ns=N.investidor)==null?void 0:ns.razao_social})," ","incluindo ",s.jsx("strong",{children:N.quotas.length})," quota(s) com todos os impactos ambientais devidamente reconciliados e auditados."]})})]}),s.jsxs(Ll,{children:[s.jsx(Ul,{children:"Cancelar"}),s.jsx(Vl,{onClick:we,children:"Emitir Certificado"})]})]})}),s.jsx(hc,{open:H,onOpenChange:Z,children:s.jsxs(Dl,{children:[s.jsxs(Ml,{children:[s.jsx(Fl,{children:"Atribuir Quotas em Lote"}),s.jsx(Bl,{children:(()=>{const Ke=ot(),dt=r.find(It=>It.id===ae);return Ke.length===0||!dt?null:s.jsxs(s.Fragment,{children:["Confirma a atribuio de ",s.jsxs("strong",{children:[Ke.length," quota(s)"]})," (de ",Ke[0].numero_quota," at ",Ke[Ke.length-1].numero_quota,") ao investidor ",s.jsx("strong",{children:dt.razao_social}),"? A data de maturao ser calculada automaticamente."]})})()})]}),s.jsxs(Ll,{children:[s.jsx(Ul,{disabled:G,children:"Cancelar"}),s.jsx(Vl,{onClick:ze,disabled:G,children:G?"Atribuindo...":"Confirmar Atribuio"})]})]})})]})},lue=({onNavigateToReconciliation:e})=>{const[t,r]=E.useState({residuos_disponiveis:0,residuos_atribuidos:0,educacao_disponivel:0,educacao_atribuida:0,embalagens_disponiveis:0,embalagens_atribuidas:0}),[a,n]=E.useState([]),[i,o]=E.useState([]),[c,d]=E.useState([]),[h,p]=E.useState(!0);E.useState(!1);const{toast:x}=_r();E.useEffect(()=>{v()},[]);const v=async()=>{try{const{data:N}=await J.from("estoque_residuos").select("kg").eq("status","disponivel"),{data:_}=await J.from("estoque_residuos").select("kg").eq("status","atribuido"),{data:C}=await J.from("saldo_parcial").select("saldo").eq("tipo","educacao").single(),{data:T,error:A}=await J.from("impacto_bruto").select("id, valor_bruto, data_hora, descricao_origem, processado, id_usuario, id_missao").eq("tipo","educacao").order("data_hora",{ascending:!1}).limit(100);console.log(" Registros de educao do impacto_bruto:",T),A&&console.error("Erro ao buscar educao:",A);let k={};if(T&&T.length>0){const Y=[...new Set(T.map(ae=>ae.id_usuario).filter(Boolean))];if(console.log(" IDs de usurios encontrados:",Y),Y.length>0){let ae;if(Y.length===1)ae=J.from("profiles").select("id, nome").eq("id",Y[0]);else{const Z=Y.map(G=>`id.eq.${G}`).join(",");ae=J.from("profiles").select("id, nome").or(Z)}const{data:je,error:H}=await ae;console.log(" Resposta da query de usurios:",{usuarios:je,usuariosError:H}),je&&(k=(Array.isArray(je)?je:[je]).reduce((G,Q)=>(G[Q.id]=Q.nome,G),{}),console.log(" Mapa de usurios criado:",k))}}const{data:I,count:B}=await J.from("produtos_ciclik").select("*",{count:"exact"}),O=I||[],D=[],{data:F}=await J.from("estoque_residuos").select("*, cooperativas(nome_fantasia), cdv_quotas(numero_quota, cdv_projetos(titulo))").order("data_entrega",{ascending:!1}).limit(100),{data:M}=await J.from("produtos_ciclik").select("*").order("data_cadastro",{ascending:!1}).limit(100),z=Number((C==null?void 0:C.saldo)||0);r({residuos_disponiveis:(N==null?void 0:N.reduce((Y,ae)=>Y+Number(ae.kg),0))||0,residuos_atribuidos:(_==null?void 0:_.reduce((Y,ae)=>Y+Number(ae.kg),0))||0,educacao_disponivel:z,educacao_atribuida:0,embalagens_disponiveis:(O==null?void 0:O.length)||0,embalagens_atribuidas:(D==null?void 0:D.length)||0}),n(F||[]);const q=(T||[]).map(Y=>({id:Y.id,data:Y.data_hora,modulo:Y.descricao_origem||"Misso Educacional",minutos_assistidos:Math.round(Number(Y.valor_bruto)*60),status:Y.processado?"disponivel":"em_geracao",profiles:{nome:k[Y.id_usuario]||"Usurio no encontrado"},cdv_quotas:null,id_usuario:Y.id_usuario,id_missao:Y.id_missao}));o(q),d(M||[])}catch(N){x({title:"Erro ao carregar estatsticas",description:N.message,variant:"destructive"})}finally{p(!1)}},b=N=>new Date(N).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"});return h?s.jsx("div",{className:"flex justify-center p-8",children:"Carregando..."}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[s.jsxs(Ne,{className:"bg-gradient-to-br from-primary/10 to-primary/5 border-primary/20",children:[s.jsx(Ye,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(cr,{className:"h-8 w-8 text-primary"}),s.jsx(Je,{variant:"outline",className:"text-xs",children:"Resduos Coletados"})]})}),s.jsxs(De,{children:[s.jsxs("div",{className:"text-4xl font-bold text-primary mb-2",children:[Br(t.residuos_disponiveis+t.residuos_atribuidos)," kg"]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-muted-foreground",children:"Disponvel"}),s.jsxs("p",{className:"font-semibold",children:[Br(t.residuos_disponiveis)," kg"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-muted-foreground",children:"Atribudo"}),s.jsxs("p",{className:"font-semibold",children:[Br(t.residuos_atribuidos)," kg"]})]})]})]})]}),s.jsxs(Ne,{className:"bg-gradient-to-br from-primary/10 to-primary/5 border-primary/20",children:[s.jsx(Ye,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(Xa,{className:"h-8 w-8 text-primary"}),s.jsx(Je,{variant:"outline",className:"text-xs",children:"Educao Ambiental"})]})}),s.jsxs(De,{children:[s.jsxs("div",{className:"text-4xl font-bold text-primary mb-2",children:[Br(t.educacao_disponivel+t.educacao_atribuida,1)," h"]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-muted-foreground",children:"Disponvel"}),s.jsxs("p",{className:"font-semibold",children:[Br(t.educacao_disponivel,1)," h"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-muted-foreground",children:"Atribudo"}),s.jsxs("p",{className:"font-semibold",children:[Br(t.educacao_atribuida,1)," h"]})]})]})]})]}),s.jsxs(Ne,{className:"bg-gradient-to-br from-primary/10 to-primary/5 border-primary/20",children:[s.jsx(Ye,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(fs,{className:"h-8 w-8 text-primary"}),s.jsx(Je,{variant:"outline",className:"text-xs",children:"Embalagens Catalogadas"})]})}),s.jsxs(De,{children:[s.jsx("div",{className:"text-4xl font-bold text-primary mb-2",children:t.embalagens_disponiveis+t.embalagens_atribuidas}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-muted-foreground",children:"Disponvel"}),s.jsx("p",{className:"font-semibold",children:t.embalagens_disponiveis})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-muted-foreground",children:"Atribudo"}),s.jsx("p",{className:"font-semibold",children:t.embalagens_atribuidas})]})]})]})]})]}),s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(tp,{className:"w-5 h-5"}),"Estoque Detalhado de Impactos CDV"]}),s.jsx(Tt,{children:"Visualizao consolidada dos impactos acumulados no sistema"})]})})}),s.jsx(De,{children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg",children:[s.jsxs("h4",{className:"font-semibold mb-3 flex items-center gap-2",children:[s.jsx("span",{className:"text-primary",children:""}),"Como Funciona o Estoque de Impactos"]}),s.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground",children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-primary font-bold mt-0.5",children:""}),s.jsxs("span",{children:[s.jsx("strong",{children:"Resduos:"})," Gerados automaticamente quando cooperativas finalizam entregas validadas"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-primary font-bold mt-0.5",children:""}),s.jsxs("span",{children:[s.jsx("strong",{children:"Educao:"})," Registrada quando usurios completam misses educacionais (vdeos + quiz)"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-primary font-bold mt-0.5",children:""}),s.jsxs("span",{children:[s.jsx("strong",{children:"Embalagens:"})," Catalogadas quando produtos com GTIN so cadastrados via notas fiscais"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-primary font-bold mt-0.5",children:""}),s.jsxs("span",{children:[s.jsx("strong",{children:"Status Disponvel:"})," Impactos prontos para serem atribudos a quotas CDV"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-primary font-bold mt-0.5",children:""}),s.jsxs("span",{children:[s.jsx("strong",{children:"Status Atribudo:"})," Impactos j reconciliados com quotas CDV especficas"]})]})]})]}),s.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-center",children:[s.jsxs("div",{className:"p-4 border rounded-lg bg-card",children:[s.jsx(cr,{className:"w-8 h-8 text-primary mx-auto mb-2"}),s.jsx("div",{className:"text-3xl font-bold text-primary",children:B1(t.residuos_disponiveis/(t.residuos_disponiveis+t.residuos_atribuidos||1)*100,0)}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Resduos Disponveis"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"para atribuio"})]}),s.jsxs("div",{className:"p-4 border rounded-lg bg-card",children:[s.jsx(Xa,{className:"w-8 h-8 text-primary mx-auto mb-2"}),s.jsx("div",{className:"text-3xl font-bold text-primary",children:B1(t.educacao_disponivel/(t.educacao_disponivel+t.educacao_atribuida||1)*100,0)}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Educao Disponvel"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"para atribuio"})]}),s.jsxs("div",{className:"p-4 border rounded-lg bg-card",children:[s.jsx(fs,{className:"w-8 h-8 text-primary mx-auto mb-2"}),s.jsx("div",{className:"text-3xl font-bold text-primary",children:B1(t.embalagens_disponiveis/(t.embalagens_disponiveis+t.embalagens_atribuidas||1)*100,0)}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Embalagens Disponveis"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"para atribuio"})]})]}),s.jsx("div",{className:"p-4 border-2 border-primary/30 rounded-lg bg-primary/5",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"bg-primary text-primary-foreground rounded-full p-2 mt-1",children:s.jsx(tp,{className:"w-5 h-5"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-semibold mb-1",children:"Prximo Passo: Reconciliao"}),s.jsxs("p",{className:"text-sm text-muted-foreground mb-3",children:["Para atribuir estes impactos disponveis s quotas CDV em gerao, acesse a aba ",s.jsx("strong",{children:"Reconciliao"})," e execute o processo de atribuio automtica."]}),s.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:" A reconciliao vincula automaticamente os impactos acumulados (resduos, educao e embalagens) s quotas que ainda no atingiram 100% das metas."}),s.jsxs(oe,{variant:"default",size:"sm",onClick:e,className:"gap-2",children:["Ir para Reconciliao",s.jsx(Hn,{className:"w-4 h-4"})]})]})]})})]})})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Registros Detalhados de Estoque"}),s.jsx(Tt,{children:"Visualize cada registro individual de impacto capturado pelo sistema"})]}),s.jsx(De,{children:s.jsxs(Mn,{defaultValue:"residuos",className:"w-full",children:[s.jsxs(Nn,{className:"grid w-full grid-cols-3",children:[s.jsxs(Gs,{value:"residuos",className:"flex items-center gap-2",children:[s.jsx(cr,{className:"w-4 h-4"}),"Resduos"]}),s.jsxs(Gs,{value:"educacao",className:"flex items-center gap-2",children:[s.jsx(Xa,{className:"w-4 h-4"}),"Educao"]}),s.jsxs(Gs,{value:"embalagens",className:"flex items-center gap-2",children:[s.jsx(fs,{className:"w-4 h-4"}),"Embalagens"]})]}),s.jsx(hr,{value:"residuos",className:"mt-4",children:s.jsx("div",{className:"rounded-md border",children:s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{children:"Data"}),s.jsx(rt,{children:"Submaterial"}),s.jsx(rt,{children:"Peso (kg)"}),s.jsx(rt,{children:"Cooperativa"}),s.jsx(rt,{children:"Status"}),s.jsx(rt,{children:"Quota CDV"}),s.jsx(rt,{children:"Projeto"})]})}),s.jsx(da,{children:a.length===0?s.jsx(Cs,{children:s.jsx(Ze,{colSpan:7,className:"text-center text-muted-foreground",children:"Nenhum registro de resduo encontrado"})}):a.map(N=>{var _,C,T,A;return s.jsxs(Cs,{children:[s.jsx(Ze,{className:"font-medium",children:b(N.data_entrega)}),s.jsx(Ze,{children:N.submaterial}),s.jsxs(Ze,{children:[Br(Number(N.kg),3)," kg"]}),s.jsx(Ze,{children:((_=N.cooperativas)==null?void 0:_.nome_fantasia)||"-"}),s.jsx(Ze,{children:s.jsx(Je,{variant:N.status==="disponivel"?"default":"secondary",children:N.status==="disponivel"?"Disponvel":"Atribudo"})}),s.jsx(Ze,{children:(C=N.cdv_quotas)!=null&&C.numero_quota?s.jsx(Je,{variant:"outline",className:"text-xs",children:N.cdv_quotas.numero_quota}):"-"}),s.jsx(Ze,{className:"max-w-[150px] truncate",children:((A=(T=N.cdv_quotas)==null?void 0:T.cdv_projetos)==null?void 0:A.titulo)||"-"})]},N.id)})})]})})}),s.jsx(hr,{value:"educacao",className:"mt-4",children:s.jsx("div",{className:"rounded-md border",children:s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{children:"Data"}),s.jsx(rt,{children:"Mdulo"}),s.jsx(rt,{children:"Minutos"}),s.jsx(rt,{children:"Usurio"}),s.jsx(rt,{children:"Status"}),s.jsx(rt,{children:"Quota CDV"}),s.jsx(rt,{children:"Projeto"})]})}),s.jsx(da,{children:i.length===0?s.jsx(Cs,{children:s.jsx(Ze,{colSpan:7,className:"text-center text-muted-foreground",children:"Nenhum registro de educao encontrado"})}):i.map(N=>{var _,C,T,A;return s.jsxs(Cs,{children:[s.jsx(Ze,{className:"font-medium",children:b(N.data)}),s.jsx(Ze,{children:N.modulo}),s.jsxs(Ze,{children:[Br(Number(N.minutos_assistidos),1)," min"]}),s.jsx(Ze,{children:((_=N.profiles)==null?void 0:_.nome)||"-"}),s.jsx(Ze,{children:s.jsx(Je,{variant:N.status==="disponivel"?"default":"secondary",children:N.status==="disponivel"?"Disponvel":"Atribudo"})}),s.jsx(Ze,{children:(C=N.cdv_quotas)!=null&&C.numero_quota?s.jsx(Je,{variant:"outline",className:"text-xs",children:N.cdv_quotas.numero_quota}):"-"}),s.jsx(Ze,{className:"max-w-[150px] truncate",children:((A=(T=N.cdv_quotas)==null?void 0:T.cdv_projetos)==null?void 0:A.titulo)||"-"})]},N.id)})})]})})}),s.jsx(hr,{value:"embalagens",className:"mt-4",children:s.jsx("div",{className:"rounded-md border",children:s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{children:"Data Cadastro"}),s.jsx(rt,{children:"GTIN"}),s.jsx(rt,{children:"NCM"}),s.jsx(rt,{children:"Descrio"}),s.jsx(rt,{children:"Tipo Embalagem"}),s.jsx(rt,{children:"Reciclvel"}),s.jsx(rt,{children:"Reciclabilidade"}),s.jsx(rt,{children:"Peso (g)"})]})}),s.jsx(da,{children:c.length===0?s.jsx(Cs,{children:s.jsx(Ze,{colSpan:8,className:"text-center text-muted-foreground",children:"Nenhum produto cadastrado encontrado"})}):c.map(N=>s.jsxs(Cs,{children:[s.jsx(Ze,{className:"font-medium",children:N.data_cadastro?b(N.data_cadastro):"-"}),s.jsx(Ze,{children:N.gtin}),s.jsx(Ze,{children:N.ncm}),s.jsx(Ze,{className:"max-w-[200px] truncate",children:N.descricao}),s.jsx(Ze,{children:N.tipo_embalagem||"-"}),s.jsx(Ze,{children:s.jsx(Je,{variant:N.reciclavel?"default":"secondary",children:N.reciclavel?"Sim":"No"})}),s.jsxs(Ze,{children:[Br(N.percentual_reciclabilidade,0),"%"]}),s.jsx(Ze,{children:N.peso_medio_gramas?`${N.peso_medio_gramas}g`:"-"})]},N.id))})]})})})]})})]})]})},Ta={uib_residuos:250,uib_educacao:5,uib_produtos:1,total_uib:256},cue=()=>{const[e,t]=E.useState({residuo:0,educacao:0,produto:0}),[r,a]=E.useState([]),[n,i]=E.useState(0),[o,c]=E.useState([]),[d,h]=E.useState([]),[p,x]=E.useState(""),[v,b]=E.useState(""),[N,_]=E.useState(!0),[C,T]=E.useState(!1),[A,k]=E.useState(!1),[I,B]=E.useState(null),[O,D]=E.useState(!1),[F,M]=E.useState(!1),[z,q]=E.useState([]),[Y,ae]=E.useState([]),{toast:je}=_r();E.useEffect(()=>{H()},[]),E.useEffect(()=>{p?Z(p):(h([]),b(""))},[p]);const H=async(Ce=!1)=>{var me,fe,ve;_(!0);try{const ne=new Date().getTime();console.log(`[${ne}]  Buscando dados atualizados... ${Ce?"(FORA REFRESH)":""}`);const{data:Me,error:Ie}=await J.from("uib").select("tipo, status",{count:"exact",head:!1});if(!Ie&&Me){const Nt=Me.reduce((Ge,Lt)=>{const ps=`${Lt.tipo}_${Lt.status}`;return Ge[ps]=(Ge[ps]||0)+1,Ge},{});console.log(" DIAGNSTICO - Todas UIBs no banco:",Nt)}const[Be,ot,Se,ze,we]=await Promise.all([J.from("uib").select("id",{count:"exact",head:!1}).eq("tipo","residuo").eq("status","disponivel"),J.from("uib").select("id",{count:"exact",head:!1}).eq("tipo","educacao").eq("status","disponivel"),J.from("produtos_ciclik").select("id",{count:"exact",head:!1}),J.from("cdv_projetos").select("id, titulo").eq("status","ativo"),J.from("impacto_bruto").select("id",{count:"exact",head:!1}).eq("processado",!1)]);console.log(`[${ne}]  Contagens obtidas:`,{residuo:Be.count,educacao:ot.count,produto:Se.count,erros:{residuo:(me=Be.error)==null?void 0:me.message,educacao:(fe=ot.error)==null?void 0:fe.message,produto:(ve=Se.error)==null?void 0:ve.message}}),Be.error&&console.error("Erro ao buscar UIBs Resduo:",Be.error),ot.error&&console.error("Erro ao buscar UIBs Educao:",ot.error),Se.error&&console.error("Erro ao buscar Produtos:",Se.error),t({residuo:Be.count||0,educacao:ot.count||0,produto:Se.count||0}),c(ze.data||[]);const Le=await J.from("saldo_parcial").select("*");if(Le.error)a([]);else{const Nt=(Le.data||[]).map(Ge=>({tipo:Ge.tipo,saldo_decimal:Ge.saldo_decimal||Ge.saldo||Ge.valor||0}));a(Nt)}i(we.count||0)}catch(ne){console.error(" Erro ao carregar dados:",ne),je({title:"Erro ao carregar dados",description:ne.message,variant:"destructive",duration:3e3})}finally{_(!1)}},Z=async Ce=>{try{const{data:me,error:fe}=await J.from("cdv_quotas").select(`
          id,
          numero_quota,
          status,
          id_investidor,
          cdv_investidores (
            razao_social
          )
        `).eq("id_projeto",Ce).eq("status","em_geracao").order("numero_quota",{ascending:!0});if(fe)throw fe;const ve=(me||[]).map(ne=>({...ne,cdv_investidores:Array.isArray(ne.cdv_investidores)?ne.cdv_investidores[0]||null:ne.cdv_investidores}));h(ve)}catch(me){je({title:"Erro ao carregar quotas",description:me.message,variant:"destructive",duration:3e3})}},G=async()=>{var Ce,me,fe,ve,ne;k(!0);try{console.log(" Iniciando Motor UIB...");const{data:Me,error:Ie}=await J.functions.invoke("motor-uib");if(Ie)throw Ie;console.log(" Resultado COMPLETO do Motor UIB:",JSON.stringify(Me,null,2)),console.log(" Resultados detalhados:",{residuo:(Ce=Me.resultados)==null?void 0:Ce.residuo,educacao:(me=Me.resultados)==null?void 0:me.educacao,produto:(fe=Me.resultados)==null?void 0:fe.produto,totais:Me.totais});const Be=((ve=Me.totais)==null?void 0:ve.uibs_geradas)||0,ot=((ne=Me.totais)==null?void 0:ne.impactos_processados)||0;console.log(` Motor processou ${ot} impactos e gerou ${Be} UIBs`),je({title:" Motor UIB executado",description:`${Be} UIBs geradas a partir de ${ot} impactos`,duration:3e3}),console.log(" Aguardando banco finalizar operaes..."),await new Promise(Se=>setTimeout(Se,1500)),console.log(" Atualizando dados do dashboard com FORCE REFRESH..."),await H(!0),console.log(" Dados atualizados com sucesso!")}catch(Me){console.error(" Erro ao executar Motor UIB:",Me),je({title:"Erro ao executar Motor UIB",description:Me.message,variant:"destructive",duration:3e3})}finally{k(!1)}},Q=async Ce=>{B(Ce);try{const me=`processar-historico-${Ce}`,{data:fe,error:ve}=await J.functions.invoke(me);if(ve)throw ve;const ne=fe.impactos_registrados||fe.registrados||0;je({title:` Migrao de ${Ce} concluda`,description:`${ne} impactos registrados em impacto_bruto`,duration:3e3}),await H()}catch(me){je({title:`Erro na migrao de ${Ce}`,description:me.message,variant:"destructive",duration:3e3})}finally{B(null)}},re=async Ce=>{try{const{data:me,error:fe}=await J.from("uib").select("id, tipo, numero_sequencial, status, ids_origem, data_geracao").eq("tipo",Ce).eq("status","disponivel").order("numero_sequencial",{ascending:!1}).limit(10);if(fe)throw fe;if(q(me||[]),me&&me.length>0){const ve=me.flatMap(ne=>ne.ids_origem||[]).slice(0,20);if(ve.length>0){const{data:ne}=await J.from("impacto_bruto").select("id, tipo, valor_bruto, submaterial, gtin, descricao_origem, data_hora, processado").in("id",ve).limit(20);ae(ne||[])}}M(!0)}catch(me){je({title:"Erro ao carregar rastreabilidade",description:me.message,variant:"destructive",duration:3e3})}},le=()=>e.residuo>=Ta.uib_residuos&&e.educacao>=Ta.uib_educacao&&e.produto>=Ta.uib_produtos&&v!=="",ye=async()=>{D(!1),T(!0);try{const{data:Ce,error:me}=await J.functions.invoke("gerar-cdv-manual",{body:{id_quota:v,id_projeto:p}});if(me)throw me;if(!Ce.success)throw new Error(Ce.error);je({title:" CDV Gerado com Sucesso!",description:`${Ce.cdv.numero_cdv} vinculado  quota selecionada`,duration:3e3}),await H(),p&&await Z(p),b("")}catch(Ce){je({title:"Erro ao gerar CDV",description:Ce.message,variant:"destructive",duration:3e3})}finally{T(!1)}},W=(Ce,me)=>{const fe=Ce/me*100;return fe>=100?{color:"text-green-600",bg:"bg-green-50",status:"Disponvel"}:fe>=50?{color:"text-yellow-600",bg:"bg-yellow-50",status:"Parcial"}:{color:"text-red-600",bg:"bg-red-50",status:"Insuficiente"}},ee=Ce=>{const me=r.find(fe=>fe.tipo===Ce);return(me==null?void 0:me.saldo_decimal)||0};if(N)return s.jsx("div",{className:"flex justify-center p-8",children:s.jsx(_s,{className:"w-6 h-6 animate-spin"})});const ie=W(e.residuo,Ta.uib_residuos),ce=W(e.educacao,Ta.uib_educacao),xe=W(e.produto,Ta.uib_produtos);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs(Mn,{defaultValue:"reconciliation",className:"w-full",children:[s.jsxs(Nn,{className:"grid w-full grid-cols-3",children:[s.jsx(Gs,{value:"reconciliation",children:"Reconciliao"}),s.jsx(Gs,{value:"migration",children:"Migrao Histrica"}),s.jsx(Gs,{value:"monitoring",children:"Monitoramento"})]}),s.jsxs(hr,{value:"reconciliation",className:"space-y-6 mt-6",children:[s.jsx(Ne,{className:"border-primary/20",children:s.jsx(Ye,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(j1,{className:"w-5 h-5"}),"Reconciliao Manual de CDV"]}),s.jsx(Tt,{children:"Selecione um projeto e quota para atribuir UIBs e gerar o CDV manualmente"})]}),s.jsx(oe,{variant:"outline",onClick:G,disabled:A,className:"gap-2",children:A?s.jsxs(s.Fragment,{children:[s.jsx(_s,{className:"w-4 h-4 animate-spin"}),"Processando..."]}):s.jsxs(s.Fragment,{children:[s.jsx(j1,{className:"w-4 h-4"}),"Executar Motor UIB"]})})]})})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs(Ne,{className:ie.bg,children:[s.jsx(Ye,{className:"pb-2",children:s.jsxs(Qe,{className:"text-lg flex items-center justify-between",children:[s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(Ur,{className:"w-5 h-5 text-green-600"}),"UIBs Resduo"]}),s.jsx(oe,{variant:"ghost",size:"sm",onClick:()=>re("residuo"),children:s.jsx(ki,{className:"w-4 h-4"})})]})}),s.jsxs(De,{children:[s.jsxs("div",{className:"flex items-end justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:`text-3xl font-bold ${ie.color}`,children:e.residuo.toLocaleString("pt-BR")}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Necessrio: ",Ta.uib_residuos," por CDV"]})]}),s.jsx(Je,{variant:e.residuo>=Ta.uib_residuos?"default":"destructive",children:ie.status})]}),s.jsx(fn,{value:Math.min(e.residuo/Ta.uib_residuos*100,100),className:"mt-3 h-2"})]})]}),s.jsxs(Ne,{className:ce.bg,children:[s.jsx(Ye,{className:"pb-2",children:s.jsxs(Qe,{className:"text-lg flex items-center justify-between",children:[s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(cx,{className:"w-5 h-5 text-blue-600"}),"UIBs Educao"]}),s.jsx(oe,{variant:"ghost",size:"sm",onClick:()=>re("educacao"),children:s.jsx(ki,{className:"w-4 h-4"})})]})}),s.jsxs(De,{children:[s.jsxs("div",{className:"flex items-end justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:`text-3xl font-bold ${ce.color}`,children:e.educacao.toLocaleString("pt-BR")}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Necessrio: ",Ta.uib_educacao," por CDV"]})]}),s.jsx(Je,{variant:e.educacao>=Ta.uib_educacao?"default":"destructive",children:ce.status})]}),s.jsx(fn,{value:Math.min(e.educacao/Ta.uib_educacao*100,100),className:"mt-3 h-2"})]})]}),s.jsxs(Ne,{className:xe.bg,children:[s.jsx(Ye,{className:"pb-2",children:s.jsxs(Qe,{className:"text-lg flex items-center justify-between",children:[s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(fs,{className:"w-5 h-5 text-purple-600"}),"UIBs Produto"]}),s.jsx(oe,{variant:"ghost",size:"sm",onClick:()=>re("produto"),children:s.jsx(ki,{className:"w-4 h-4"})})]})}),s.jsxs(De,{children:[s.jsxs("div",{className:"flex items-end justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:`text-3xl font-bold ${xe.color}`,children:e.produto.toLocaleString("pt-BR")}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Necessrio: ",Ta.uib_produtos," por CDV"]})]}),s.jsx(Je,{variant:e.produto>=Ta.uib_produtos?"default":"destructive",children:xe.status})]}),s.jsx(fn,{value:Math.min(e.produto/Ta.uib_produtos*100,100),className:"mt-3 h-2"})]})]})]}),s.jsxs(Ne,{children:[s.jsx(Ye,{className:"pb-3",children:s.jsx(Qe,{className:"text-lg",children:"Frmula do CDV"})}),s.jsx(De,{children:s.jsxs("div",{className:"flex items-center gap-2 text-sm font-mono bg-muted p-3 rounded-lg flex-wrap",children:[s.jsxs("span",{className:"text-green-600 font-bold",children:[Ta.uib_residuos," UIB(resduo)"]}),s.jsx("span",{children:"+"}),s.jsxs("span",{className:"text-blue-600 font-bold",children:[Ta.uib_educacao," UIB(educao)"]}),s.jsx("span",{children:"+"}),s.jsxs("span",{className:"text-purple-600 font-bold",children:[Ta.uib_produtos," UIB(produto)"]}),s.jsx("span",{children:"="}),s.jsxs("span",{className:"text-primary font-bold",children:[Ta.total_uib," UIB = 1 CDV"]})]})})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Atribuir CDV a Quota"}),s.jsx(Tt,{children:"Selecione o projeto e a quota que receber o CDV"})]}),s.jsxs(De,{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Projeto"}),s.jsxs(qs,{value:p,onValueChange:x,children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Selecione um projeto"})}),s.jsx(Fs,{children:o.map(Ce=>s.jsx(xt,{value:Ce.id,children:Ce.titulo},Ce.id))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Quota Pendente"}),s.jsxs(qs,{value:v,onValueChange:b,disabled:!p||d.length===0,children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:p?d.length===0?"Nenhuma quota pendente":"Selecione uma quota":"Selecione um projeto primeiro"})}),s.jsx(Fs,{children:d.map(Ce=>{var me;return s.jsxs(xt,{value:Ce.id,children:["#",Ce.numero_quota," - ",((me=Ce.cdv_investidores)==null?void 0:me.razao_social)||"Sem investidor"]},Ce.id)})})]})]})]}),!le()&&v&&s.jsxs("div",{className:"flex items-center gap-2 text-destructive text-sm",children:[s.jsx(Kr,{className:"w-4 h-4"}),"UIBs insuficientes para gerar CDV"]}),s.jsx(oe,{onClick:()=>D(!0),disabled:!le()||C,className:"w-full gap-2",size:"lg",children:C?s.jsxs(s.Fragment,{children:[s.jsx(_s,{className:"w-4 h-4 animate-spin"}),"Gerando CDV..."]}):s.jsxs(s.Fragment,{children:[s.jsx(_n,{className:"w-4 h-4"}),"Gerar CDV e Atribuir  Quota"]})})]})]})]}),s.jsx(hr,{value:"migration",className:"space-y-6 mt-6",children:s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(Dv,{className:"w-5 h-5"}),"Migrao de Dados Histricos"]}),s.jsx(Tt,{children:"Processe dados histricos das tabelas legadas para impacto_bruto"})]}),s.jsxs(De,{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs(Ne,{children:[s.jsxs(Ye,{className:"pb-2",children:[s.jsxs(Qe,{className:"text-base flex items-center gap-2",children:[s.jsx(Ur,{className:"w-4 h-4 text-green-600"}),"Resduos"]}),s.jsx(Tt,{className:"text-xs",children:"Entregas finalizadas  impacto_bruto"})]}),s.jsx(De,{children:s.jsx(oe,{onClick:()=>Q("residuos"),disabled:I!==null,className:"w-full gap-2",variant:"outline",children:I==="residuos"?s.jsxs(s.Fragment,{children:[s.jsx(_s,{className:"w-4 h-4 animate-spin"})," Processando..."]}):s.jsxs(s.Fragment,{children:[s.jsx(N1,{className:"w-4 h-4"})," Executar"]})})})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{className:"pb-2",children:[s.jsxs(Qe,{className:"text-base flex items-center gap-2",children:[s.jsx(cx,{className:"w-4 h-4 text-blue-600"}),"Educao"]}),s.jsx(Tt,{className:"text-xs",children:"Misses concludas  impacto_bruto"})]}),s.jsx(De,{children:s.jsx(oe,{onClick:()=>Q("educacao"),disabled:I!==null,className:"w-full gap-2",variant:"outline",children:I==="educacao"?s.jsxs(s.Fragment,{children:[s.jsx(_s,{className:"w-4 h-4 animate-spin"})," Processando..."]}):s.jsxs(s.Fragment,{children:[s.jsx(N1,{className:"w-4 h-4"})," Executar"]})})})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{className:"pb-2",children:[s.jsxs(Qe,{className:"text-base flex items-center gap-2",children:[s.jsx(fs,{className:"w-4 h-4 text-purple-600"}),"Embalagens"]}),s.jsx(Tt,{className:"text-xs",children:"Notas fiscais  impacto_bruto"})]}),s.jsx(De,{children:s.jsx(oe,{onClick:()=>Q("embalagens"),disabled:I!==null,className:"w-full gap-2",variant:"outline",children:I==="embalagens"?s.jsxs(s.Fragment,{children:[s.jsx(_s,{className:"w-4 h-4 animate-spin"})," Processando..."]}):s.jsxs(s.Fragment,{children:[s.jsx(N1,{className:"w-4 h-4"})," Executar"]})})})]})]}),s.jsx(al,{}),s.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.jsx("p",{className:"font-medium mb-2",children:"Fluxo de migrao:"}),s.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[s.jsx("li",{children:"Execute as migraes histricas para popular impacto_bruto"}),s.jsx("li",{children:"Execute o Motor UIB para gerar UIBs a partir dos impactos"}),s.jsx("li",{children:"Use a aba Reconciliao para atribuir UIBs e gerar CDVs"})]})]})]})]})}),s.jsx(hr,{value:"monitoring",className:"space-y-6 mt-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(tp,{className:"w-5 h-5"}),"Impactos Pendentes"]}),s.jsx(Tt,{children:"Impactos brutos aguardando processamento pelo Motor UIB"})]}),s.jsx(De,{children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-4xl font-bold text-primary",children:n.toLocaleString("pt-BR")}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"impactos no processados"}),n>0&&s.jsxs(oe,{onClick:G,disabled:A,className:"mt-4 gap-2",size:"sm",children:[A?s.jsx(_s,{className:"w-4 h-4 animate-spin"}):s.jsx(j1,{className:"w-4 h-4"}),"Processar Agora"]})]})})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsxs(Qe,{className:"flex items-center gap-2",children:[s.jsx(tp,{className:"w-5 h-5"}),"Saldo Parcial"]}),s.jsx(Tt,{children:"Valores decimais acumulados aguardando completar 1 UIB"})]}),s.jsx(De,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("span",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Ur,{className:"w-4 h-4 text-green-600"}),"Resduo"]}),s.jsxs("span",{className:"font-mono text-sm",children:[ee("residuo").toFixed(3)," kg"]})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("span",{className:"flex items-center gap-2 text-sm",children:[s.jsx(cx,{className:"w-4 h-4 text-blue-600"}),"Educao"]}),s.jsxs("span",{className:"font-mono text-sm",children:[ee("educacao").toFixed(3)," min"]})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("span",{className:"flex items-center gap-2 text-sm",children:[s.jsx(fs,{className:"w-4 h-4 text-purple-600"}),"Produto"]}),s.jsxs("span",{className:"font-mono text-sm",children:[ee("produto").toFixed(3)," un"]})]})]})})]})]})})]}),s.jsx(hc,{open:O,onOpenChange:D,children:s.jsxs(Dl,{children:[s.jsxs(Ml,{children:[s.jsx(Fl,{children:"Confirmar Gerao de CDV"}),s.jsxs(Bl,{children:["Esta ao ir:",s.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[s.jsxs("li",{children:["Reservar ",Ta.uib_residuos," UIBs de resduo"]}),s.jsxs("li",{children:["Reservar ",Ta.uib_educacao," UIBs de educao"]}),s.jsxs("li",{children:["Reservar ",Ta.uib_produtos," UIBs de produto"]}),s.jsx("li",{children:"Gerar um novo CDV"}),s.jsx("li",{children:"Vincular o CDV  quota selecionada"})]}),s.jsx("p",{className:"mt-3 font-medium",children:"Esta ao no pode ser desfeita."})]})]}),s.jsxs(Ll,{children:[s.jsx(Ul,{children:"Cancelar"}),s.jsx(Vl,{onClick:ye,children:"Confirmar e Gerar CDV"})]})]})}),s.jsx(ar,{open:F,onOpenChange:M,children:s.jsxs(tr,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[s.jsxs(nr,{children:[s.jsx(ir,{children:"Rastreabilidade UIB"}),s.jsx(Vr,{children:"Visualize a composio das UIBs e seus impactos originais"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium mb-2",children:"UIBs Recentes (ltimas 10)"}),s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{children:"Sequencial"}),s.jsx(rt,{children:"Tipo"}),s.jsx(rt,{children:"Status"}),s.jsx(rt,{children:"Impactos"}),s.jsx(rt,{children:"Data"})]})}),s.jsx(da,{children:z.map(Ce=>{var me;return s.jsxs(Cs,{children:[s.jsxs(Ze,{className:"font-mono",children:["#",Ce.numero_sequencial]}),s.jsx(Ze,{children:s.jsx(Je,{variant:"outline",children:Ce.tipo})}),s.jsx(Ze,{children:s.jsx(Je,{variant:Ce.status==="disponivel"?"default":"secondary",children:Ce.status})}),s.jsx(Ze,{children:((me=Ce.ids_origem)==null?void 0:me.length)||0}),s.jsx(Ze,{className:"text-sm",children:new Date(Ce.data_geracao).toLocaleDateString("pt-BR")})]},Ce.id)})})]})]}),s.jsx(al,{}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium mb-2",children:"Impactos Originais (amostra)"}),s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{children:"Tipo"}),s.jsx(rt,{children:"Valor"}),s.jsx(rt,{children:"Detalhe"}),s.jsx(rt,{children:"Data"})]})}),s.jsx(da,{children:Y.map(Ce=>s.jsxs(Cs,{children:[s.jsx(Ze,{children:s.jsx(Je,{variant:"outline",children:Ce.tipo})}),s.jsx(Ze,{className:"font-mono",children:Ce.valor_bruto.toFixed(2)}),s.jsx(Ze,{className:"text-sm max-w-[200px] truncate",children:Ce.submaterial||Ce.gtin||Ce.descricao_origem||"-"}),s.jsx(Ze,{className:"text-sm",children:new Date(Ce.data_hora).toLocaleDateString("pt-BR")})]},Ce.id))})]})]})]})]})})]})},due=()=>{const[e,t]=E.useState([]),[r,a]=E.useState({totalActiveInvestors:0,totalQuotasAssigned:0,totalValueInvested:0}),[n,i]=E.useState(!0),[o,c]=E.useState(""),[d,h]=E.useState(!1),[p,x]=E.useState({razao_social:"",cnpj:"",email:"",nome_responsavel:"",telefone:""}),[v,b]=E.useState(!1),[N,_]=E.useState(!1),[C,T]=E.useState(null),[A,k]=E.useState([]),[I,B]=E.useState(!1),[O,D]=E.useState(!1),{toast:F}=_r();E.useEffect(()=>{M(),z()},[]);const M=async()=>{try{const{data:G,error:Q}=await J.from("cdv_investidores").select("*").order("data_cadastro",{ascending:!1});if(Q)throw Q;const re=await Promise.all((G||[]).map(async le=>{const{count:ye}=await J.from("cdv_quotas").select("*",{count:"exact",head:!0}).eq("id_investidor",le.id);return{...le,quotas_count:ye||0}}));t(re)}catch(G){F({title:"Erro ao carregar investidores",description:G.message,variant:"destructive"})}finally{i(!1)}},z=async()=>{try{const{count:G,error:Q}=await J.from("cdv_investidores").select("*",{count:"exact",head:!0}).eq("status","ativo");if(Q)throw Q;const{data:re,error:le}=await J.from("cdv_quotas").select("valor_pago").not("id_investidor","is",null);if(le)throw le;const ye=(re==null?void 0:re.length)||0,W=(re==null?void 0:re.reduce((ee,ie)=>ee+(ie.valor_pago||0),0))||0;a({totalActiveInvestors:G||0,totalQuotasAssigned:ye,totalValueInvested:W})}catch(G){console.error("Erro ao carregar estatsticas:",G)}},q=async()=>{if(!p.razao_social||!p.cnpj||!p.email||!p.nome_responsavel){F({title:"Campos obrigatrios",description:"Preencha todos os campos obrigatrios",variant:"destructive"});return}try{b(!0);const{error:G}=await J.from("cdv_investidores").insert({id_user:crypto.randomUUID(),razao_social:p.razao_social,cnpj:p.cnpj,email:p.email,nome_responsavel:p.nome_responsavel,telefone:p.telefone||null,status:"aguardando_quotas"});if(G)throw G;F({title:"Investidor cadastrado",description:"O investidor receber um email de acesso quando quotas forem atribudas."}),h(!1),x({razao_social:"",cnpj:"",email:"",nome_responsavel:"",telefone:""}),M(),z()}catch(G){F({title:"Erro ao criar investidor",description:G.message,variant:"destructive"})}finally{b(!1)}},Y=async G=>{T(G),_(!0),B(!0);try{const{data:Q,error:re}=await J.from("emails_investidores").select("*").eq("id_investidor",G.id).order("created_at",{ascending:!1});if(re)throw re;k(Q||[])}catch(Q){F({title:"Erro ao carregar histrico",description:Q.message,variant:"destructive"})}finally{B(!1)}},ae=async(G,Q=!1)=>{if(!Q&&(G.quotas_count||0)===0){F({title:"Ao no permitida",description:"Este investidor ainda no possui quotas atribudas. Atribua quotas primeiro.",variant:"destructive"});return}D(!0);try{const{data:re,error:le}=await J.functions.invoke("enviar-convite-investidor",{body:{email:G.email,razaoSocial:G.razao_social,nomeResponsavel:G.nome_responsavel,cnpj:G.cnpj,idInvestidor:G.id,reenvio:Q,originUrl:window.location.origin}});if(le)throw le;if(re!=null&&re.error)throw new Error(re.error);re!=null&&re.accessLink?(await navigator.clipboard.writeText(re.accessLink),F({title:"Link de acesso gerado!",description:s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{children:"O link foi copiado para sua rea de transferncia."}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Envie este link para ",G.email," via WhatsApp ou email."]})]}),duration:1e4})):F({title:Q?"Convite reenviado":"Convite enviado",description:`Convite processado para ${G.email}`}),M(),N&&(C==null?void 0:C.id)===G.id&&await Y(G)}catch(re){F({title:`Erro ao ${Q?"re":""}enviar convite`,description:re.message,variant:"destructive"})}finally{D(!1)}},je=G=>{const Q=(G.quotas_count||0)>0;if(Q&&!G.convite_enviado)return s.jsx(Zo,{children:s.jsxs(Xn,{children:[s.jsx(Yn,{asChild:!0,children:s.jsxs(Je,{variant:"outline",className:"flex items-center gap-1 border-orange-500 text-orange-600 cursor-help",children:[s.jsx(Kr,{className:"h-3 w-3"}),"Enviar Convite"]})}),s.jsxs(kn,{children:[s.jsxs("p",{children:["Possui ",G.quotas_count," quota(s) mas convite no foi enviado"]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Clique no cone de enviar para convidar"})]})]})});if(!Q&&!G.convite_enviado)return s.jsxs(Je,{variant:"secondary",className:"flex items-center gap-1",children:[s.jsx(Gn,{className:"h-3 w-3"}),"Aguardando Quotas"]});if(G.convite_enviado&&!G.primeiro_acesso){const re=G.data_convite?Math.floor((Date.now()-new Date(G.data_convite).getTime())/864e5):0;return s.jsx(Zo,{children:s.jsxs(Xn,{children:[s.jsx(Yn,{asChild:!0,children:s.jsxs(Je,{variant:"outline",className:"flex items-center gap-1 border-amber-500 text-amber-600 cursor-help",children:[s.jsx(Kr,{className:"h-3 w-3"}),"Convite Pendente"]})}),s.jsxs(kn,{children:[s.jsxs("p",{children:["Convite enviado h ",re," dia(s)"]}),G.data_convite&&s.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(G.data_convite).toLocaleString("pt-BR")})]})]})})}return s.jsxs(Je,{variant:"default",className:"flex items-center gap-1",children:[s.jsx(Tr,{className:"h-3 w-3"}),"Ativo"]})},H=G=>{switch(G){case"enviado":return s.jsx(Je,{variant:"default",className:"bg-green-600",children:"Enviado"});case"pendente":return s.jsx(Je,{variant:"secondary",children:"Pendente"});case"erro":return s.jsx(Je,{variant:"destructive",children:"Erro"});default:return s.jsx(Je,{variant:"outline",children:G})}},Z=e.filter(G=>G.razao_social.toLowerCase().includes(o.toLowerCase())||G.cnpj.includes(o)||G.email.toLowerCase().includes(o.toLowerCase()));return n?s.jsx("div",{className:"flex justify-center p-8",children:"Carregando..."}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[s.jsxs(Ne,{children:[s.jsxs(Ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(Qe,{className:"text-sm font-medium",children:"Investidores Ativos"}),s.jsx(oa,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(De,{children:[s.jsx("div",{className:"text-2xl font-bold",children:r.totalActiveInvestors}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Empresas investidoras cadastradas"})]})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(Qe,{className:"text-sm font-medium",children:"Quotas Atribudas"}),s.jsx(Ir,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(De,{children:[s.jsx("div",{className:"text-2xl font-bold",children:r.totalQuotasAssigned}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Total de quotas vendidas"})]})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(Qe,{className:"text-sm font-medium",children:"Valor Total Investido"}),s.jsx(Mw,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(De,{children:[s.jsx("div",{className:"text-2xl font-bold",children:rb(r.totalValueInvested)}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Investimento acumulado em CDV"})]})]})]}),s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(Qe,{children:"Investidores CDV"}),s.jsx(Tt,{children:"Gerenciar empresas investidoras. O convite de acesso  enviado automaticamente quando quotas so atribudas."})]}),s.jsxs(ar,{open:d,onOpenChange:h,children:[s.jsx(kp,{asChild:!0,children:s.jsxs(oe,{className:"gap-2",children:[s.jsx(ra,{className:"w-4 h-4"}),"Novo Investidor"]})}),s.jsxs(tr,{className:"max-w-2xl",children:[s.jsxs(nr,{children:[s.jsx(ir,{children:"Cadastrar Novo Investidor"}),s.jsx(Vr,{children:"Preencha os dados da empresa investidora. O convite de acesso ser enviado automaticamente quando voc atribuir quotas."})]}),s.jsxs("div",{className:"grid gap-4 py-4",children:[s.jsxs("div",{className:"grid gap-2",children:[s.jsx(ke,{htmlFor:"razao_social",children:"Razo Social *"}),s.jsx(We,{id:"razao_social",value:p.razao_social,onChange:G=>x({...p,razao_social:G.target.value}),placeholder:"Nome da empresa"})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(ke,{htmlFor:"cnpj",children:"CNPJ *"}),s.jsx(We,{id:"cnpj",value:p.cnpj,onChange:G=>x({...p,cnpj:G.target.value}),placeholder:"00.000.000/0001-00"})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(ke,{htmlFor:"nome_responsavel",children:"Nome do Responsvel *"}),s.jsx(We,{id:"nome_responsavel",value:p.nome_responsavel,onChange:G=>x({...p,nome_responsavel:G.target.value}),placeholder:"Nome completo"})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(ke,{htmlFor:"email",children:"Email *"}),s.jsx(We,{id:"email",type:"email",value:p.email,onChange:G=>x({...p,email:G.target.value}),placeholder:"contato@empresa.com"})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(ke,{htmlFor:"telefone",children:"Telefone (opcional)"}),s.jsx(We,{id:"telefone",value:p.telefone,onChange:G=>x({...p,telefone:G.target.value}),placeholder:"(00) 00000-0000"})]})]}),s.jsxs(Ya,{children:[s.jsx(oe,{variant:"outline",onClick:()=>h(!1),children:"Cancelar"}),s.jsx(oe,{onClick:q,disabled:v,children:v?"Cadastrando...":"Cadastrar Investidor"})]})]})]})]})}),s.jsxs(De,{children:[s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"relative",children:[s.jsx(eo,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),s.jsx(We,{placeholder:"Buscar por razo social, CNPJ ou email...",value:o,onChange:G=>c(G.target.value),className:"pl-10"})]})}),s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{children:"Empresa"}),s.jsx(rt,{children:"CNPJ"}),s.jsx(rt,{children:"Responsvel"}),s.jsx(rt,{children:"Contato"}),s.jsx(rt,{children:"Status"}),s.jsx(rt,{children:"Data Cadastro"}),s.jsx(rt,{className:"text-right",children:"Aes"})]})}),s.jsx(da,{children:Z.map(G=>s.jsxs(Cs,{children:[s.jsx(Ze,{children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(hn,{className:"w-4 h-4 text-muted-foreground"}),s.jsx("span",{className:"font-medium",children:G.razao_social})]})}),s.jsx(Ze,{children:G.cnpj}),s.jsx(Ze,{children:G.nome_responsavel}),s.jsx(Ze,{children:s.jsxs("div",{className:"space-y-1 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(sf,{className:"w-3 h-3 text-muted-foreground"}),G.email]}),G.telefone&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Bw,{className:"w-3 h-3 text-muted-foreground"}),G.telefone]})]})}),s.jsx(Ze,{children:je(G)}),s.jsx(Ze,{children:new Date(G.data_cadastro).toLocaleDateString("pt-BR")}),s.jsx(Ze,{children:s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsx(Zo,{children:s.jsxs(Xn,{children:[s.jsx(Yn,{asChild:!0,children:s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>Y(G),children:s.jsx(Dv,{className:"h-4 w-4"})})}),s.jsx(kn,{children:s.jsx("p",{children:"Ver histrico de emails"})})]})}),!G.convite_enviado&&(G.quotas_count||0)>0&&s.jsx(Zo,{children:s.jsxs(Xn,{children:[s.jsx(Yn,{asChild:!0,children:s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>ae(G,!1),disabled:O,className:"text-primary",children:O?s.jsx(Kn,{className:"h-4 w-4 animate-spin"}):s.jsx(k0,{className:"h-4 w-4"})})}),s.jsx(kn,{children:s.jsxs("p",{children:["Enviar convite (possui ",G.quotas_count," quota(s))"]})})]})}),G.convite_enviado&&!G.primeiro_acesso&&s.jsx(Zo,{children:s.jsxs(Xn,{children:[s.jsx(Yn,{asChild:!0,children:s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>ae(G,!0),disabled:O,children:O?s.jsx(Kn,{className:"h-4 w-4 animate-spin"}):s.jsx(k0,{className:"h-4 w-4"})})}),s.jsx(kn,{children:s.jsx("p",{children:"Reenviar convite"})})]})})]})})]},G.id))})]}),Z.length===0&&s.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"Nenhum investidor encontrado"})]})]}),s.jsx(ar,{open:N,onOpenChange:_,children:s.jsxs(tr,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[s.jsxs(nr,{children:[s.jsxs(ir,{className:"flex items-center gap-2",children:[s.jsx(Dv,{className:"h-5 w-5"}),"Histrico de Emails"]}),s.jsx(Vr,{children:C&&s.jsxs("span",{children:["Emails enviados para ",s.jsx("strong",{children:C.razao_social})," (",C.email,")"]})})]}),I?s.jsx("div",{className:"flex justify-center py-8",children:s.jsx(Kn,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):A.length===0?s.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[s.jsx(sf,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"Nenhum email enviado para este investidor"}),s.jsx("p",{className:"text-sm mt-2",children:C&&(C.quotas_count||0)>0?`Este investidor possui ${C.quotas_count} quota(s) atribuda(s). Clique em "Enviar Convite" abaixo para enviar o email de acesso.`:"O primeiro email ser enviado automaticamente quando quotas forem atribudas."})]}):s.jsx("div",{className:"space-y-4",children:A.map(G=>s.jsx("div",{className:"p-4 border rounded-lg bg-muted/30",children:s.jsx("div",{className:"flex items-start justify-between gap-4",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"font-medium",children:G.assunto}),H(G.status_envio)]}),s.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[s.jsxs("p",{children:["Tipo: ",G.tipo_email]}),s.jsxs("p",{children:["Destinatrio: ",G.email_destino]}),s.jsxs("p",{children:["Enviado: ",new Date(G.created_at).toLocaleString("pt-BR"),s.jsxs("span",{className:"ml-1",children:["(",Ad(new Date(G.created_at),{addSuffix:!0,locale:$s}),")"]})]})]}),G.mensagem_erro&&s.jsxs("div",{className:"mt-2 p-2 bg-destructive/10 border border-destructive/20 rounded text-sm text-destructive",children:[s.jsxs("div",{className:"flex items-center gap-1 font-medium",children:[s.jsx(Va,{className:"h-3 w-3"}),"Erro:"]}),s.jsx("p",{className:"mt-1",children:G.mensagem_erro})]})]})})},G.id))}),s.jsxs(Ya,{children:[C&&!C.convite_enviado&&(C.quotas_count||0)>0&&s.jsxs(oe,{variant:"default",onClick:()=>C&&ae(C,!1),disabled:O,className:"gap-2",children:[O?s.jsx(Kn,{className:"h-4 w-4 animate-spin"}):s.jsx(k0,{className:"h-4 w-4"}),"Enviar Convite"]}),(C==null?void 0:C.convite_enviado)&&!(C!=null&&C.primeiro_acesso)&&s.jsxs(oe,{variant:"outline",onClick:()=>C&&ae(C,!0),disabled:O,className:"gap-2",children:[O?s.jsx(Kn,{className:"h-4 w-4 animate-spin"}):s.jsx(k0,{className:"h-4 w-4"}),"Reenviar Convite"]}),s.jsx(oe,{onClick:()=>_(!1),children:"Fechar"})]})]})})]})},uue={novo:"bg-blue-500/10 text-blue-600 border-blue-500/20",em_contato:"bg-yellow-500/10 text-yellow-600 border-yellow-500/20",convertido:"bg-green-500/10 text-green-600 border-green-500/20",descartado:"bg-red-500/10 text-red-600 border-red-500/20"},hue={novo:"Novo",em_contato:"Em Contato",convertido:"Convertido",descartado:"Descartado"},fue=()=>{const e=Gw(),[t,r]=E.useState("todos"),[a,n]=E.useState(null),[i,o]=E.useState(""),[c,d]=E.useState(!1),{data:h=[],isLoading:p,refetch:x}=KM({queryKey:["cdv-leads",t],queryFn:async()=>{let T=J.from("cdv_leads").select("*").order("data_cadastro",{ascending:!1});t!=="todos"&&(T=T.eq("status",t));const{data:A,error:k}=await T;if(k)throw k;return A}}),v=S1({mutationFn:async({id:T,status:A})=>{const k={status:A};A==="em_contato"&&(k.data_contato=new Date().toISOString());const{error:I}=await J.from("cdv_leads").update(k).eq("id",T);if(I)throw I},onSuccess:()=>{e.invalidateQueries({queryKey:["cdv-leads"]}),ct.success("Status atualizado")},onError:()=>{ct.error("Erro ao atualizar status")}}),b=S1({mutationFn:async({id:T,notas:A})=>{const{error:k}=await J.from("cdv_leads").update({notas:A}).eq("id",T);if(k)throw k},onSuccess:()=>{e.invalidateQueries({queryKey:["cdv-leads"]}),ct.success("Notas salvas"),d(!1)},onError:()=>{ct.error("Erro ao salvar notas")}}),N=S1({mutationFn:async T=>{let A=null;if(T.email&&T.email.trim()!==""){const{data:D,error:F}=await J.from("cdv_investidores").select("id, razao_social, email").eq("email",T.email.trim()).maybeSingle();if(F)throw F;D&&(A={field:"email",value:T.email,investor:D})}if(!A&&T.empresa){const D=/\d{2}\.\d{3}\.\d{3}\/\d{4}-\d{2}/,F=T.empresa.match(D);if(F){const M=F[0],{data:z,error:q}=await J.from("cdv_investidores").select("id, razao_social, cnpj").eq("cnpj",M).maybeSingle();if(q)throw q;z&&(A={field:"CNPJ",value:M,investor:z})}}if(A)throw new Error(`J existe um investidor cadastrado:
Empresa: ${A.investor.razao_social}
${A.field}: ${A.value}`);const k=`TEMP-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,{data:I,error:B}=await J.from("cdv_investidores").insert({razao_social:T.empresa,cnpj:k,nome_responsavel:T.nome,email:T.email||`temp-${Date.now()}@aguardando-email.com`,telefone:T.telefone,id_user:crypto.randomUUID(),status:"aguardando_quotas"}).select().single();if(B)throw B;const{error:O}=await J.from("cdv_leads").update({status:"convertido",id_investidor:I.id}).eq("id",T.id);if(O)throw O;return I},onSuccess:()=>{e.invalidateQueries({queryKey:["cdv-leads"]}),e.invalidateQueries({queryKey:["cdv-investidores"]}),ct.success("Lead convertido para investidor com sucesso!")},onError:T=>{const A=T.message||"Erro ao converter lead";ct.error(A)}}),_={total:h.length,novos:h.filter(T=>T.status==="novo").length,emContato:h.filter(T=>T.status==="em_contato").length,convertidos:h.filter(T=>T.status==="convertido").length},C=T=>{n(T),o(T.notas||""),d(!0)};return p?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(Kn,{className:"w-6 h-6 animate-spin text-muted-foreground"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsx(Ne,{children:s.jsx(De,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:s.jsx(oa,{className:"w-5 h-5 text-primary"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total de Leads"}),s.jsx("p",{className:"text-2xl font-bold",children:_.total})]})]})})}),s.jsx(Ne,{children:s.jsx(De,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 rounded-lg bg-blue-500/10",children:s.jsx(Mv,{className:"w-5 h-5 text-blue-500"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Novos"}),s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:_.novos})]})]})})}),s.jsx(Ne,{children:s.jsx(De,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 rounded-lg bg-yellow-500/10",children:s.jsx(z2,{className:"w-5 h-5 text-yellow-500"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Em Contato"}),s.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:_.emContato})]})]})})}),s.jsx(Ne,{children:s.jsx(De,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 rounded-lg bg-green-500/10",children:s.jsx(oa,{className:"w-5 h-5 text-green-500"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Convertidos"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:_.convertidos})]})]})})})]}),s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(Qe,{children:"Leads de Investidores"}),s.jsx(Tt,{children:"Interessados que preencheram o formulrio da landing page"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Of,{className:"w-4 h-4 text-muted-foreground"}),s.jsxs(qs,{value:t,onValueChange:r,children:[s.jsx(Ls,{className:"w-40",children:s.jsx(Ws,{})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"todos",children:"Todos"}),s.jsx(xt,{value:"novo",children:"Novos"}),s.jsx(xt,{value:"em_contato",children:"Em Contato"}),s.jsx(xt,{value:"convertido",children:"Convertidos"}),s.jsx(xt,{value:"descartado",children:"Descartados"})]})]}),s.jsx(oe,{variant:"outline",size:"icon",onClick:()=>x(),children:s.jsx(Kn,{className:"w-4 h-4"})})]})]})}),s.jsx(De,{children:h.length===0?s.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[s.jsx(oa,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"Nenhum lead encontrado"})]}):s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{children:"Nome"}),s.jsx(rt,{children:"Empresa"}),s.jsx(rt,{children:"Contato"}),s.jsx(rt,{children:"Status"}),s.jsx(rt,{children:"Data"}),s.jsx(rt,{className:"text-right",children:"Aes"})]})}),s.jsx(da,{children:h.map(T=>s.jsxs(Cs,{children:[s.jsx(Ze,{className:"font-medium",children:T.nome}),s.jsx(Ze,{children:T.empresa}),s.jsx(Ze,{children:s.jsxs("div",{className:"text-sm",children:[s.jsx("p",{children:T.email}),T.telefone&&s.jsx("p",{className:"text-muted-foreground",children:T.telefone})]})}),s.jsx(Ze,{children:s.jsx(Je,{variant:"outline",className:uue[T.status],children:hue[T.status]})}),s.jsx(Ze,{children:Os(new Date(T.data_cadastro),"dd/MM/yyyy HH:mm",{locale:$s})}),s.jsx(Ze,{children:s.jsxs("div",{className:"flex items-center justify-end gap-1",children:[T.status==="novo"&&s.jsxs(oe,{size:"sm",variant:"outline",onClick:()=>v.mutate({id:T.id,status:"em_contato"}),children:[s.jsx(z2,{className:"w-3 h-3 mr-1"}),"Contatar"]}),(T.status==="novo"||T.status==="em_contato")&&s.jsxs(s.Fragment,{children:[s.jsxs(oe,{size:"sm",variant:"default",onClick:()=>N.mutate(T),disabled:N.isPending,children:[s.jsx(Mv,{className:"w-3 h-3 mr-1"}),"Converter"]}),s.jsx(oe,{size:"sm",variant:"ghost",onClick:()=>v.mutate({id:T.id,status:"descartado"}),children:s.jsx(Va,{className:"w-3 h-3"})})]}),s.jsx(oe,{size:"sm",variant:"ghost",onClick:()=>C(T),children:s.jsx(T6,{className:"w-3 h-3"})})]})})]},T.id))})]})})]}),s.jsx(ar,{open:c,onOpenChange:d,children:s.jsxs(tr,{children:[s.jsxs(nr,{children:[s.jsxs(ir,{children:["Notas - ",a==null?void 0:a.nome]}),s.jsx(Vr,{children:"Adicione observaes sobre este lead"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(jn,{value:i,onChange:T=>o(T.target.value),placeholder:"Digite suas notas aqui...",rows:5}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(oe,{variant:"outline",onClick:()=>d(!1),children:"Cancelar"}),s.jsx(oe,{onClick:()=>a&&b.mutate({id:a.id,notas:i}),disabled:b.isPending,children:"Salvar"})]})]})]})})]})},mue={leads:"Gerencie leads interessados em investir. Acompanhe o funil de captao e converta leads em investidores.",projetos:"Crie e gerencie projetos CDV. Defina metas de impacto, prazo de maturao e valor total do projeto.",investidores:"Visualize investidores cadastrados, envie convites e acompanhe o portflio de cada um.",quotas:"Gerencie quotas por projeto. Atribua quotas a investidores e acompanhe o progresso de maturao.",stock:"Visualize o estoque de impactos disponveis (resduos, educao, embalagens) para atribuio s quotas.",reconciliation:"Atribua manualmente UIBs do estoque s quotas de projetos para gerar CDVs completos."},pue=()=>{const e=ds(),[t,r]=E.useState("leads");return s.jsx("div",{className:"min-h-screen bg-background p-8",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-8",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Gesto CDV"}),s.jsx("p",{className:"text-muted-foreground",children:"Gerenciar investidores, quotas e estoque de impactos"})]}),s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>e("/admin"),className:"gap-2",children:[s.jsx(As,{className:"h-4 w-4"}),"Voltar"]})]}),s.jsxs(Mn,{value:t,onValueChange:r,className:"space-y-6",children:[s.jsx(Nn,{className:"grid w-full grid-cols-6 bg-muted/50 p-1.5 rounded-xl",children:[{value:"leads",label:"Leads"},{value:"projetos",label:"Projetos"},{value:"investidores",label:"Investidores"},{value:"quotas",label:"Quotas"},{value:"stock",label:"Estoque"},{value:"reconciliation",label:"Reconciliao"}].map(a=>s.jsxs(Xn,{children:[s.jsx(Yn,{asChild:!0,children:s.jsxs("button",{onClick:()=>r(a.value),className:`
                      relative px-4 py-2.5 rounded-lg font-display text-sm font-medium
                      transition-all duration-200 ease-out
                      ${t===a.value?"bg-primary text-primary-foreground shadow-md":"text-muted-foreground hover:text-foreground hover:bg-muted"}
                    `,children:[a.label,t===a.value&&s.jsx("span",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-8 h-1 bg-primary-foreground/30 rounded-full"})]})}),s.jsx(kn,{side:"bottom",className:"max-w-xs",children:s.jsx("p",{children:mue[a.value]})})]},a.value))}),s.jsx(hr,{value:"leads",children:s.jsx(fue,{})}),s.jsx(hr,{value:"projetos",children:s.jsx(Dde,{})}),s.jsx(hr,{value:"investidores",children:s.jsx(due,{})}),s.jsx(hr,{value:"quotas",children:s.jsx(oue,{})}),s.jsx(hr,{value:"stock",children:s.jsx(lue,{onNavigateToReconciliation:()=>r("reconciliation")})}),s.jsx(hr,{value:"reconciliation",children:s.jsx(cue,{})})]})]})})},xue=[{uf:"AC",nome:"Acre"},{uf:"AL",nome:"Alagoas"},{uf:"AP",nome:"Amap"},{uf:"AM",nome:"Amazonas"},{uf:"BA",nome:"Bahia"},{uf:"CE",nome:"Cear"},{uf:"DF",nome:"Distrito Federal"},{uf:"ES",nome:"Esprito Santo"},{uf:"GO",nome:"Gois"},{uf:"MA",nome:"Maranho"},{uf:"MT",nome:"Mato Grosso"},{uf:"MS",nome:"Mato Grosso do Sul"},{uf:"MG",nome:"Minas Gerais"},{uf:"PA",nome:"Par"},{uf:"PB",nome:"Paraba"},{uf:"PR",nome:"Paran"},{uf:"PE",nome:"Pernambuco"},{uf:"PI",nome:"Piau"},{uf:"RJ",nome:"Rio de Janeiro"},{uf:"RN",nome:"Rio Grande do Norte"},{uf:"RS",nome:"Rio Grande do Sul"},{uf:"RO",nome:"Rondnia"},{uf:"RR",nome:"Roraima"},{uf:"SC",nome:"Santa Catarina"},{uf:"SP",nome:"So Paulo"},{uf:"SE",nome:"Sergipe"},{uf:"TO",nome:"Tocantins"}],ES=[{value:0,label:"Domingo"},{value:1,label:"Segunda-feira"},{value:2,label:"Tera-feira"},{value:3,label:"Quarta-feira"},{value:4,label:"Quinta-feira"},{value:5,label:"Sexta-feira"},{value:6,label:"Sbado"}];function gue(){const e=ds(),[t,r]=E.useState(!0),[a,n]=E.useState([]),[i,o]=E.useState([]),[c,d]=E.useState([]),[h,p]=E.useState("rotas"),[x,v]=E.useState(!1),[b,N]=E.useState(!1),[_,C]=E.useState(null),[T,A]=E.useState(null),[k,I]=E.useState(!1),[B,O]=E.useState(""),[D,F]=E.useState(""),[M,z]=E.useState(""),[q,Y]=E.useState("ativa"),[ae,je]=E.useState([]),[H,Z]=E.useState([""]),[G,Q]=E.useState([""]),[re,le]=E.useState([""]),[ye,W]=E.useState(""),[ee,ie]=E.useState(""),[ce,xe]=E.useState("");E.useEffect(()=>{Ce()},[]);const Ce=async()=>{r(!0),await Promise.all([me(),fe(),ve()]),r(!1)},me=async()=>{try{const{data:qe,error:jt}=await J.from("rotas_coleta").select(`
          *,
          operador:cooperativas(nome_fantasia)
        `).order("nome");if(jt)throw jt;const _t=await Promise.all((qe||[]).map(async Re=>{const[et,Ct,Yt]=await Promise.all([J.from("rotas_dias_coleta").select("*").eq("id_rota",Re.id),J.from("rotas_areas_cobertura").select("*").eq("id_rota",Re.id),J.from("usuarios_rotas").select("id",{count:"exact",head:!0}).eq("id_rota",Re.id)]);return{...Re,dias:et.data||[],areas:Ct.data||[],_count:{adesoes:Yt.count||0}}}));n(_t)}catch(qe){ct.error("Erro ao carregar rotas",{description:qe.message})}},fe=async()=>{try{const{data:qe,error:jt}=await J.from("cooperativas").select("id, nome_fantasia").eq("status","aprovada").order("nome_fantasia");if(jt)throw jt;o(qe||[])}catch(qe){ct.error("Erro ao carregar operadores",{description:qe.message})}},ve=async()=>{try{const{data:qe,error:jt}=await J.from("usuarios_rotas").select(`
          *,
          usuario:profiles(nome, email),
          rota:rotas_coleta(nome)
        `).order("data_adesao",{ascending:!1});if(jt)throw jt;d(qe||[])}catch(qe){ct.error("Erro ao carregar adeses",{description:qe.message})}},ne=qe=>{qe?(C(qe),O(qe.nome),F(qe.descricao||""),z(qe.id_operador||""),Y(qe.status),je((qe.dias||[]).map(jt=>({dia:jt.dia_semana,inicio:jt.horario_inicio||"",fim:jt.horario_fim||""})))):(C(null),O(""),F(""),z(""),Y("ativa"),je([])),v(!0)},Me=qe=>{A(qe),Z([""]),Q([""]),le([""]),W(""),ie(""),xe(""),N(!0)},Ie=()=>Z([...H,""]),Be=qe=>Z(H.filter((jt,_t)=>_t!==qe)),ot=(qe,jt)=>{const _t=[...H];_t[qe]=jt,Z(_t)},Se=()=>Q([...G,""]),ze=qe=>Q(G.filter((jt,_t)=>_t!==qe)),we=(qe,jt)=>{const _t=[...G];_t[qe]=jt,Q(_t)},Le=()=>le([...re,""]),Nt=qe=>le(re.filter((jt,_t)=>_t!==qe)),Ge=(qe,jt)=>{const _t=[...re];_t[qe]=jt,le(_t)},Lt=qe=>{const jt=ae.find(_t=>_t.dia===qe);je(jt?ae.filter(_t=>_t.dia!==qe):[...ae,{dia:qe,inicio:"08:00",fim:"17:00"}])},ps=(qe,jt,_t)=>{je(ae.map(Re=>Re.dia===qe?{...Re,[jt]:_t}:Re))},ns=async()=>{if(!B.trim()){ct.error("Nome da rota  obrigatrio");return}I(!0);try{let qe;if(_){const{error:jt}=await J.from("rotas_coleta").update({nome:B,descricao:D||null,id_operador:M||null,status:q}).eq("id",_.id);if(jt)throw jt;qe=_.id,await J.from("rotas_dias_coleta").delete().eq("id_rota",qe)}else{const{data:jt,error:_t}=await J.from("rotas_coleta").insert({nome:B,descricao:D||null,id_operador:M||null,status:q}).select().single();if(_t)throw _t;qe=jt.id}if(ae.length>0){const jt=ae.map(Re=>({id_rota:qe,dia_semana:Re.dia,horario_inicio:Re.inicio||null,horario_fim:Re.fim||null})),{error:_t}=await J.from("rotas_dias_coleta").insert(jt);if(_t)throw _t}ct.success(_?"Rota atualizada!":"Rota criada!"),v(!1),me()}catch(qe){ct.error("Erro ao salvar rota",{description:qe.message})}finally{I(!1)}},Ke=async()=>{if(!T)return;const qe=ee.trim(),jt=ye.trim();if(!jt||!qe){ct.error("Cidade e UF so obrigatrios.");return}const _t=H.filter(Ct=>Ct.trim()),Re=G.filter(Ct=>Ct.trim()),et=re.filter(Ct=>Ct.trim());if(_t.length===0&&Re.length===0){ct.error("Informe pelo menos um bairro ou logradouro");return}I(!0);try{const Ct=[];if(_t.length>0)for(const bt of _t)if(Re.length>0)for(let Dt=0;Dt<Re.length;Dt++)Ct.push({id_rota:T.id,bairro:bt,logradouro:Re[Dt],cep:et[Dt]||null,cidade:jt,uf:qe.toUpperCase(),complemento_endereco:ce||null});else Ct.push({id_rota:T.id,bairro:bt,logradouro:null,cep:et[0]||null,cidade:jt,uf:qe.toUpperCase(),complemento_endereco:ce||null});else for(let bt=0;bt<Re.length;bt++)Ct.push({id_rota:T.id,bairro:null,logradouro:Re[bt],cep:et[bt]||null,cidade:jt,uf:qe.toUpperCase(),complemento_endereco:ce||null});const{error:Yt}=await J.from("rotas_areas_cobertura").insert(Ct);if(Yt)throw Yt;ct.success(`${Ct.length} rea(s) adicionada(s)!`),N(!1),me()}catch(Ct){ct.error("Erro ao salvar rea",{description:Ct.message})}finally{I(!1)}},dt=async qe=>{if(confirm("Deseja realmente excluir esta rota? Todas as reas e adeses sero removidas."))try{const{error:jt}=await J.from("rotas_coleta").delete().eq("id",qe);if(jt)throw jt;ct.success("Rota excluda!"),me()}catch(jt){ct.error("Erro ao excluir rota",{description:jt.message})}},It=async qe=>{if(confirm("Deseja realmente excluir esta rea?"))try{const{error:jt}=await J.from("rotas_areas_cobertura").delete().eq("id",qe);if(jt)throw jt;ct.success("rea excluda!"),me()}catch(jt){ct.error("Erro ao excluir rea",{description:jt.message})}},Ut=async qe=>{const jt=qe.status==="ativa"?"bloqueada":"ativa";try{const{error:_t}=await J.from("rotas_coleta").update({status:jt}).eq("id",qe.id);if(_t)throw _t;ct.success(`Rota ${jt==="ativa"?"ativada":"bloqueada"}!`),me()}catch(_t){ct.error("Erro ao alterar status",{description:_t.message})}},ts=qe=>{var jt;return((jt=ES.find(_t=>_t.value===qe))==null?void 0:jt.label)||""},us=qe=>{switch(qe){case"ativa":return s.jsx(Je,{className:"bg-success/20 text-success",children:"Ativa"});case"bloqueada":return s.jsx(Je,{className:"bg-destructive/20 text-destructive",children:"Bloqueada"});case"inativa":return s.jsx(Je,{variant:"secondary",children:"Inativa"});default:return s.jsx(Je,{variant:"outline",children:qe})}};return s.jsx(Nc,{children:s.jsxs("div",{className:"min-h-screen bg-background p-4 md:p-8",children:[s.jsxs("div",{className:"mx-auto max-w-7xl space-y-6",children:[s.jsxs(oe,{onClick:()=>e("/admin"),variant:"ghost",size:"sm",className:"gap-2 mb-4",children:[s.jsx(As,{className:"h-4 w-4"}),"Voltar"]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"rounded-full bg-primary p-2",children:s.jsx(Sl,{className:"h-6 w-6 text-primary-foreground"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Gesto de Rotas de Coleta"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Gerencie rotas, reas de cobertura e adeses"})]})]}),s.jsxs(oe,{onClick:()=>ne(),children:[s.jsx(ra,{className:"mr-2 h-4 w-4"}),"Nova Rota"]})]}),s.jsxs(Mn,{value:h,onValueChange:p,children:[s.jsxs(Nn,{children:[s.jsxs(Gs,{value:"rotas",className:"gap-2",children:[s.jsx(Sl,{className:"h-4 w-4"}),"Rotas (",a.length,")"]}),s.jsxs(Gs,{value:"adesoes",className:"gap-2",children:[s.jsx(oa,{className:"h-4 w-4"}),"Adeses (",c.length,")"]})]}),s.jsx(hr,{value:"rotas",className:"space-y-4",children:t?s.jsx("div",{className:"flex justify-center py-8",children:s.jsx(_s,{className:"h-8 w-8 animate-spin text-primary"})}):a.length===0?s.jsx(Ne,{children:s.jsxs(De,{className:"flex flex-col items-center justify-center py-12",children:[s.jsx(Sl,{className:"h-12 w-12 text-muted-foreground mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Nenhuma rota cadastrada"}),s.jsxs(oe,{onClick:()=>ne(),className:"mt-4",children:[s.jsx(ra,{className:"mr-2 h-4 w-4"}),"Criar Primeira Rota"]})]})}):s.jsx("div",{className:"grid gap-4",children:a.map(qe=>{var jt,_t,Re;return s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Qe,{children:qe.nome}),us(qe.status)]}),s.jsx(Tt,{className:"mt-1",children:qe.descricao||"Sem descrio"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>Me(qe),children:[s.jsx(Co,{className:"mr-2 h-4 w-4"}),"reas"]}),s.jsx(oe,{variant:"outline",size:"sm",onClick:()=>ne(qe),children:s.jsx(Fw,{className:"h-4 w-4"})}),s.jsx(oe,{variant:"outline",size:"sm",onClick:()=>Ut(qe),children:qe.status==="ativa"?s.jsx(f6,{className:"h-4 w-4 text-destructive"}):s.jsx(_n,{className:"h-4 w-4 text-success"})}),s.jsx(oe,{variant:"outline",size:"sm",onClick:()=>dt(qe.id),children:s.jsx(Ba,{className:"h-4 w-4 text-destructive"})})]})]})}),s.jsxs(De,{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-muted-foreground",children:"Operador"}),s.jsx("p",{className:"font-medium",children:((jt=qe.operador)==null?void 0:jt.nome_fantasia)||"No definido"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-muted-foreground",children:"Adeses"}),s.jsx("p",{className:"font-medium",children:((_t=qe._count)==null?void 0:_t.adesoes)||0})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-muted-foreground",children:"reas de Cobertura"}),s.jsx("p",{className:"font-medium",children:((Re=qe.areas)==null?void 0:Re.length)||0})]})]}),qe.areas&&qe.areas.length>0&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-muted/30 rounded-lg p-3",children:[s.jsxs("p",{className:"text-sm font-medium text-muted-foreground mb-2 flex items-center gap-1",children:[s.jsx(Co,{className:"h-3 w-3"})," Bairros"]}),s.jsx("div",{className:"flex flex-wrap gap-1",children:[...new Set(qe.areas.filter(et=>et.bairro).map(et=>et.bairro))].length>0?[...new Set(qe.areas.filter(et=>et.bairro).map(et=>et.bairro))].map((et,Ct)=>s.jsx(Je,{variant:"secondary",className:"text-xs",children:et},Ct)):s.jsx("span",{className:"text-xs text-muted-foreground",children:"Nenhum bairro definido"})})]}),s.jsxs("div",{className:"bg-muted/30 rounded-lg p-3",children:[s.jsxs("p",{className:"text-sm font-medium text-muted-foreground mb-2 flex items-center gap-1",children:[s.jsx(Sl,{className:"h-3 w-3"})," Ruas"]}),s.jsx("div",{className:"flex flex-wrap gap-1",children:[...new Set(qe.areas.filter(et=>et.logradouro).map(et=>et.logradouro))].length>0?[...new Set(qe.areas.filter(et=>et.logradouro).map(et=>et.logradouro))].map((et,Ct)=>s.jsx(Je,{variant:"outline",className:"text-xs",children:et},Ct)):s.jsx("span",{className:"text-xs text-muted-foreground",children:"Nenhuma rua definida"})})]})]}),qe.dias&&qe.dias.length>0&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Dias de Coleta"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:qe.dias.map(et=>s.jsxs(Je,{variant:"outline",children:[s.jsx(Fa,{className:"mr-1 h-3 w-3"}),ts(et.dia_semana),et.horario_inicio&&` ${et.horario_inicio.slice(0,5)}`,et.horario_fim&&`-${et.horario_fim.slice(0,5)}`]},et.id))})]}),qe.areas&&qe.areas.length>0&&s.jsxs("details",{className:"group",children:[s.jsxs("summary",{className:"text-sm text-muted-foreground cursor-pointer hover:text-foreground transition-colors",children:["Ver todas as ",qe.areas.length," reas de cobertura"]}),s.jsx("div",{className:"border rounded-lg overflow-hidden mt-2",children:s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{children:"Logradouro"}),s.jsx(rt,{children:"Bairro"}),s.jsx(rt,{children:"Cidade/UF"}),s.jsx(rt,{children:"CEP"}),s.jsx(rt,{className:"w-10"})]})}),s.jsx(da,{children:qe.areas.map(et=>s.jsxs(Cs,{children:[s.jsx(Ze,{children:et.logradouro||"-"}),s.jsx(Ze,{children:et.bairro||"-"}),s.jsxs(Ze,{children:[et.cidade,"/",et.uf]}),s.jsx(Ze,{children:et.cep||"-"}),s.jsx(Ze,{children:s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>It(et.id),children:s.jsx(Ba,{className:"h-4 w-4 text-destructive"})})})]},et.id))})]})})]})]})]},qe.id)})})}),s.jsx(hr,{value:"adesoes",children:s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:"Adeses de Usurios"}),s.jsx(Tt,{children:"Usurios que aderiram a rotas de coleta"})]}),s.jsx(De,{children:c.length===0?s.jsx("p",{className:"text-center text-muted-foreground py-8",children:"Nenhuma adeso registrada"}):s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{children:"Usurio"}),s.jsx(rt,{children:"Rota"}),s.jsx(rt,{children:"QR Code"}),s.jsx(rt,{children:"Endereo"}),s.jsx(rt,{children:"Status"}),s.jsx(rt,{children:"Data"})]})}),s.jsx(da,{children:c.map(qe=>{var jt,_t,Re;return s.jsxs(Cs,{children:[s.jsx(Ze,{children:s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:((jt=qe.usuario)==null?void 0:jt.nome)||"-"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:(_t=qe.usuario)==null?void 0:_t.email})]})}),s.jsx(Ze,{children:((Re=qe.rota)==null?void 0:Re.nome)||"-"}),s.jsx(Ze,{children:s.jsx("code",{className:"text-xs bg-muted px-2 py-1 rounded",children:qe.qrcode_adesao})}),s.jsx(Ze,{className:"max-w-[200px] truncate",children:qe.endereco_coleta}),s.jsx(Ze,{children:qe.status==="ativa"?s.jsx(Je,{className:"bg-success/20 text-success",children:"Ativa"}):qe.status==="pausada"?s.jsx(Je,{variant:"secondary",children:"Pausada"}):s.jsx(Je,{variant:"destructive",children:"Cancelada"})}),s.jsx(Ze,{children:new Date(qe.data_adesao).toLocaleDateString("pt-BR")})]},qe.id)})})]})})]})})]})]}),s.jsx(ar,{open:x,onOpenChange:v,children:s.jsxs(tr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(nr,{children:[s.jsx(ir,{children:_?"Editar Rota":"Nova Rota"}),s.jsx(Vr,{children:"Configure os detalhes da rota de coleta"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"nome",children:"Nome da Rota *"}),s.jsx(We,{id:"nome",value:B,onChange:qe=>O(qe.target.value),placeholder:"Ex: Rota Centro"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"operador",children:"Operador"}),s.jsxs(qs,{value:M,onValueChange:z,children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Selecione o operador"})}),s.jsx(Fs,{children:i.map(qe=>s.jsx(xt,{value:qe.id,children:qe.nome_fantasia},qe.id))})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"descricao",children:"Descrio"}),s.jsx(jn,{id:"descricao",value:D,onChange:qe=>F(qe.target.value),placeholder:"Descrio da rota...",rows:2})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"status",children:"Status"}),s.jsxs(qs,{value:q,onValueChange:Y,children:[s.jsx(Ls,{children:s.jsx(Ws,{})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"ativa",children:"Ativa"}),s.jsx(xt,{value:"bloqueada",children:"Bloqueada"}),s.jsx(xt,{value:"inativa",children:"Inativa"})]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(ke,{children:"Dias de Coleta"}),s.jsx("div",{className:"grid gap-3",children:ES.map(qe=>{const jt=ae.find(_t=>_t.dia===qe.value);return s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2 w-40",children:[s.jsx(Ef,{checked:!!jt,onCheckedChange:()=>Lt(qe.value)}),s.jsx("span",{className:"text-sm",children:qe.label})]}),jt&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(We,{type:"time",value:jt.inicio,onChange:_t=>ps(qe.value,"inicio",_t.target.value),className:"w-28"}),s.jsx("span",{children:"at"}),s.jsx(We,{type:"time",value:jt.fim,onChange:_t=>ps(qe.value,"fim",_t.target.value),className:"w-28"})]})]},qe.value)})})]})]}),s.jsxs(Ya,{children:[s.jsx(oe,{variant:"outline",onClick:()=>v(!1),children:"Cancelar"}),s.jsxs(oe,{onClick:ns,disabled:k,children:[k&&s.jsx(_s,{className:"mr-2 h-4 w-4 animate-spin"}),_?"Salvar":"Criar Rota"]})]})]})}),s.jsx(ar,{open:b,onOpenChange:N,children:s.jsxs(tr,{className:"max-w-xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(nr,{children:[s.jsx(ir,{children:"Adicionar rea de Cobertura"}),s.jsxs(Vr,{children:["Rota: ",T==null?void 0:T.nome]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"border rounded-lg p-4 bg-muted/30",children:[s.jsx(ke,{className:"text-sm font-medium mb-3 block",children:" Localizao"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"areaUf",children:"Estado *"}),s.jsxs(qs,{value:ee,onValueChange:ie,children:[s.jsx(Ls,{children:s.jsx(Ws,{placeholder:"Selecione"})}),s.jsx(Fs,{children:xue.map(qe=>s.jsxs(xt,{value:qe.uf,children:[qe.uf," - ",qe.nome]},qe.uf))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"areaCidade",children:"Cidade *"}),s.jsx(We,{id:"areaCidade",value:ye,onChange:qe=>W(qe.target.value),placeholder:"Ex: Salvador"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(ke,{children:"Bairros *"}),s.jsxs(oe,{type:"button",variant:"outline",size:"sm",onClick:Ie,children:[s.jsx(ra,{className:"h-3 w-3 mr-1"}),"Adicionar"]})]}),s.jsx("div",{className:"space-y-2",children:H.map((qe,jt)=>s.jsxs("div",{className:"flex gap-2",children:[s.jsx(We,{value:qe,onChange:_t=>ot(jt,_t.target.value),placeholder:"Ex: Piat, Itapu, Centro"}),H.length>1&&s.jsx(oe,{type:"button",variant:"ghost",size:"icon",onClick:()=>Be(jt),className:"shrink-0 text-destructive hover:text-destructive",children:s.jsx(Ba,{className:"h-4 w-4"})})]},jt))})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(ke,{children:"Logradouros (opcional)"}),s.jsxs(oe,{type:"button",variant:"outline",size:"sm",onClick:Se,children:[s.jsx(ra,{className:"h-3 w-3 mr-1"}),"Adicionar"]})]}),s.jsx("div",{className:"space-y-2",children:G.map((qe,jt)=>s.jsxs("div",{className:"flex gap-2",children:[s.jsx(We,{value:qe,onChange:_t=>we(jt,_t.target.value),placeholder:"Ex: Rua das Flores, Av. Principal"}),G.length>1&&s.jsx(oe,{type:"button",variant:"ghost",size:"icon",onClick:()=>ze(jt),className:"shrink-0 text-destructive hover:text-destructive",children:s.jsx(Ba,{className:"h-4 w-4"})})]},jt))})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(ke,{children:"CEPs (opcional)"}),s.jsxs(oe,{type:"button",variant:"outline",size:"sm",onClick:Le,children:[s.jsx(ra,{className:"h-3 w-3 mr-1"}),"Adicionar"]})]}),s.jsx("div",{className:"space-y-2",children:re.map((qe,jt)=>s.jsxs("div",{className:"flex gap-2",children:[s.jsx(We,{value:qe,onChange:_t=>Ge(jt,_t.target.value),placeholder:"00000-000",className:"w-40"}),re.length>1&&s.jsx(oe,{type:"button",variant:"ghost",size:"icon",onClick:()=>Nt(jt),className:"shrink-0 text-destructive hover:text-destructive",children:s.jsx(Ba,{className:"h-4 w-4"})})]},jt))})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(ke,{htmlFor:"complemento",children:"Complemento (opcional)"}),s.jsx(We,{id:"complemento",value:ce,onChange:qe=>xe(qe.target.value),placeholder:"Ex: Nmeros pares, prximo  praa"})]})]}),s.jsxs(Ya,{children:[s.jsx(oe,{variant:"outline",onClick:()=>N(!1),children:"Cancelar"}),s.jsxs(oe,{onClick:Ke,disabled:k,children:[k&&s.jsx(_s,{className:"mr-2 h-4 w-4 animate-spin"}),"Adicionar reas"]})]})]})})]})})}const vue={nota_fiscal:"Nota Fiscal (SEFAZ)"};function yue(){var x;const e=ds(),[t,r]=E.useState([]),[a,n]=E.useState(!0),[i,o]=E.useState("todas");E.useEffect(()=>{c()},[]);const c=async()=>{try{const{data:v,error:b}=await J.from("interesses_funcionalidades").select("estado, cidade, funcionalidade");if(b)throw b;const N={};v==null||v.forEach(C=>{const T=`${C.estado||"N/A"}-${C.cidade||"N/A"}-${C.funcionalidade}`;N[T]||(N[T]={estado:C.estado,cidade:C.cidade,funcionalidade:C.funcionalidade,total:0}),N[T].total++});const _=Object.values(N).sort((C,T)=>T.total-C.total);r(_)}catch(v){console.error("Erro ao carregar interesses:",v)}finally{n(!1)}},d=i==="todas"?t:t.filter(v=>v.funcionalidade===i),h=d.reduce((v,b)=>v+b.total,0),p=new Set(d.map(v=>v.estado)).size;return s.jsx(Nc,{children:s.jsx("div",{className:"min-h-screen bg-background",children:s.jsxs("div",{className:"mx-auto max-w-6xl px-4 py-6",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>e("/admin"),className:"gap-2",children:[s.jsx(As,{className:"h-4 w-4"}),"Voltar"]}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Interesses por Funcionalidade"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Demanda de usurios por estado e cidade"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[s.jsx(Ne,{children:s.jsxs(De,{className:"p-4 flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:s.jsx(oa,{className:"h-6 w-6 text-primary"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total de Interesses"}),s.jsx("p",{className:"text-2xl font-bold",children:h})]})]})}),s.jsx(Ne,{children:s.jsxs(De,{className:"p-4 flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-amber-500/10 flex items-center justify-center",children:s.jsx(Co,{className:"h-6 w-6 text-amber-500"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Estados com Demanda"}),s.jsx("p",{className:"text-2xl font-bold",children:p})]})]})}),s.jsx(Ne,{children:s.jsxs(De,{className:"p-4 flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-500/10 flex items-center justify-center",children:s.jsx(Ir,{className:"h-6 w-6 text-blue-500"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Maior Demanda"}),s.jsx("p",{className:"text-lg font-bold truncate",children:((x=d[0])==null?void 0:x.estado)||"-"})]})]})})]}),s.jsx(Ne,{className:"mb-6",children:s.jsx(De,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Filtrar por:"}),s.jsxs(qs,{value:i,onValueChange:o,children:[s.jsx(Ls,{className:"w-[200px]",children:s.jsx(Ws,{placeholder:"Funcionalidade"})}),s.jsxs(Fs,{children:[s.jsx(xt,{value:"todas",children:"Todas"}),s.jsx(xt,{value:"nota_fiscal",children:"Nota Fiscal (SEFAZ)"})]})]})]})})}),s.jsxs(Ne,{children:[s.jsx(Ye,{children:s.jsx(Qe,{className:"text-lg",children:"Demanda por Localidade"})}),s.jsx(De,{children:a?s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Carregando..."}):d.length===0?s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Nenhum interesse registrado ainda."}):s.jsxs(la,{children:[s.jsx(ca,{children:s.jsxs(Cs,{children:[s.jsx(rt,{children:"Estado"}),s.jsx(rt,{children:"Cidade"}),s.jsx(rt,{children:"Funcionalidade"}),s.jsx(rt,{className:"text-right",children:"Interessados"})]})}),s.jsx(da,{children:d.map((v,b)=>s.jsxs(Cs,{children:[s.jsx(Ze,{children:s.jsx(Je,{variant:"outline",className:"font-mono",children:v.estado||"N/A"})}),s.jsx(Ze,{className:"font-medium",children:v.cidade||"No informada"}),s.jsx(Ze,{children:vue[v.funcionalidade]||v.funcionalidade}),s.jsx(Ze,{className:"text-right",children:s.jsx(Je,{className:"bg-primary/10 text-primary border-0",children:v.total})})]},b))})]})})]})]})})})}const Ew=()=>{const e=ds();return E.useEffect(()=>{window.scrollTo(0,1),setTimeout(()=>{window.scrollTo(0,0)},0)},[]),s.jsxs("div",{className:"bg-background text-foreground overflow-x-hidden",children:[s.jsx(Ee.div,{className:"fixed top-4 right-4 z-50",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5},children:s.jsx(oe,{variant:"outline",size:"sm",onClick:()=>e("/auth"),className:"font-display font-medium bg-white/90 backdrop-blur-sm hover:bg-white shadow-md rounded-full gap-2",children:"Entrar"})}),s.jsxs("section",{className:"relative py-20 px-4 md:px-8 overflow-hidden bg-gradient-to-b from-primary/5 to-background",children:[s.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[s.jsx("div",{className:"absolute -top-20 -right-20 w-96 h-96 bg-primary/10 rounded-full blur-3xl opacity-40"}),s.jsx("div",{className:"absolute -bottom-20 -left-20 w-80 h-80 bg-accent/10 rounded-full blur-3xl opacity-30"})]}),s.jsxs("div",{className:"max-w-5xl mx-auto text-center relative z-10",children:[s.jsx(Ee.img,{src:"/Ciclik_validacoes/logo-with-slogan.png",alt:"Ciclik",className:"h-24 mx-auto mb-8",initial:{opacity:0,y:-20},animate:{opacity:1,y:0}}),s.jsxs(Ee.h1,{className:"font-display text-3xl md:text-5xl lg:text-6xl font-bold text-foreground mb-6 leading-tight",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:["A reciclagem no Brasil"," ",s.jsx("span",{className:"text-destructive",children:"no funciona."}),s.jsx("br",{}),s.jsx("span",{className:"text-primary",children:"Ns criamos o mtodo definitivo que vai fazer funcionar."})]}),s.jsxs(Ee.p,{className:"text-lg md:text-xl text-muted-foreground max-w-3xl mx-auto mb-10",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:["Um programa de fidelidade ambiental que transforma cidados em agentes de mudana e empresas em patrocinadoras de impacto real."," ",s.jsx("span",{className:"font-display italic text-accent",children:"Assim ajudamos todo mundo a ajudar o mundo!"})]}),s.jsx(Ee.div,{className:"flex flex-wrap justify-center gap-4 mb-10",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},children:[{icon:vi,text:"100% Auditvel"},{icon:Ur,text:"3 Mdulos Integrados"},{icon:Qn,text:"nico no Brasil"}].map((t,r)=>s.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-card rounded-full border border-border shadow-sm",children:[s.jsx(t.icon,{className:"w-5 h-5 text-primary"}),s.jsx("span",{className:"font-medium text-sm",children:t.text})]},r))}),s.jsx(Ee.p,{className:"text-muted-foreground text-lg mb-6 max-w-lg mx-auto",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7},children:"Faa parte do movimento que est reinventando a economia circular no Brasil."}),s.jsxs(Ee.div,{className:"flex flex-col sm:flex-row gap-4 justify-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},children:[s.jsxs(oe,{size:"lg",className:"text-lg px-8",onClick:()=>e("/auth"),children:[s.jsx(cr,{className:"w-5 h-5 mr-2"}),"Participar e Ganhar Pontos"]}),s.jsxs(oe,{variant:"outline",size:"lg",className:"text-lg px-8 border-accent text-accent hover:bg-accent hover:text-accent-foreground",onClick:()=>{window.scrollTo(0,0),e("/apresentacao-investidor")},children:[s.jsx(hn,{className:"w-5 h-5 mr-2"}),"Patrocinar Impacto Real",s.jsx(Hn,{className:"w-5 h-5 ml-2"})]})]})]})]}),s.jsx("section",{className:"py-20 px-4 md:px-8 bg-card",children:s.jsxs("div",{className:"max-w-5xl mx-auto",children:[s.jsxs(Ee.div,{className:"text-center mb-12",initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},children:[s.jsxs("h2",{className:"font-display text-2xl md:text-4xl font-bold mb-4",children:["Por que a reciclagem ",s.jsx("span",{className:"text-destructive",children:"no funciona"})," no Brasil?"]}),s.jsx("p",{className:"text-muted-foreground text-lg",children:"Menos de 4% dos resduos reciclveis so efetivamente reciclados."})]}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[s.jsx(Ee.div,{initial:{opacity:0,x:-30},whileInView:{opacity:1,x:0},viewport:{once:!0},children:s.jsxs(Ne,{className:"p-6 border-destructive/30 bg-destructive/5",children:[s.jsxs("h3",{className:"font-display text-xl font-semibold mb-4 flex items-center gap-2 text-destructive",children:[s.jsx(Va,{className:"w-6 h-6"}),"O Problema"]}),s.jsx("ul",{className:"space-y-4",children:["Falta educao ambiental acessvel","Ningum sabe o que  reciclvel de verdade","No h incentivo real para reciclar","Impactos ambientais so impossveis de rastrear"].map((t,r)=>s.jsxs("li",{className:"flex items-start gap-3 text-muted-foreground",children:[s.jsx(Va,{className:"w-5 h-5 text-destructive shrink-0 mt-0.5"}),t]},r))})]})}),s.jsx(Ee.div,{initial:{opacity:0,x:30},whileInView:{opacity:1,x:0},viewport:{once:!0},children:s.jsxs(Ne,{className:"p-6 border-primary/30 bg-primary/5",children:[s.jsxs("h3",{className:"font-display text-xl font-semibold mb-4 flex items-center gap-2 text-primary",children:[s.jsx(_n,{className:"w-6 h-6"}),"A Soluo Ciclik"]}),s.jsx("ul",{className:"space-y-4",children:["Misses educativas que ensinam na prtica","Anlise de reciclabilidade via nota fiscal","Pontos que viram benefcios reais","Cada ao gera um UIB (Unidade de Impacto) rastrevel"].map((t,r)=>s.jsxs("li",{className:"flex items-start gap-3 text-foreground",children:[s.jsx(_n,{className:"w-5 h-5 text-primary shrink-0 mt-0.5"}),t]},r))})]})})]})]})}),s.jsx("section",{className:"py-20 px-4 md:px-8",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsxs(Ee.div,{className:"text-center mb-12",initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},children:[s.jsxs("h2",{className:"font-display text-2xl md:text-4xl font-bold mb-4",children:["O Ciclo ",s.jsx("span",{className:"text-primary",children:"Completo"})]}),s.jsx("p",{className:"text-muted-foreground text-lg",children:"Um ecossistema que conecta empresas, pessoas e cooperativas."})]}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[{icon:hn,title:"Empresas",subtitle:"Investem",desc:"Financiam aes reais de sustentabilidade",color:"bg-accent"},{icon:oa,title:"Usurios",subtitle:"Agem",desc:"Aprendem, consomem consciente e entregam reciclveis",color:"bg-primary"},{icon:j6,title:"Cooperativas",subtitle:"Transformam",desc:"Recebem materiais e geram renda para catadores",color:"bg-green-600"}].map((t,r)=>s.jsxs(Ee.div,{className:"text-center",initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:r*.15},children:[s.jsx("div",{className:`w-20 h-20 ${t.color} rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg`,children:s.jsx(t.icon,{className:"w-10 h-10 text-white"})}),s.jsx("h3",{className:"font-display text-xl font-bold",children:t.title}),s.jsx("p",{className:"text-primary font-medium text-sm mb-2",children:t.subtitle}),s.jsx("p",{className:"text-sm text-muted-foreground",children:t.desc})]},r))}),s.jsxs("div",{className:"hidden md:flex absolute top-10 left-1/2 transform -translate-x-1/2 w-2/3 justify-around",children:[s.jsx(Ee.div,{initial:{opacity:0},whileInView:{opacity:1},viewport:{once:!0},transition:{delay:.5},children:s.jsx(Hn,{className:"w-8 h-8 text-primary/50"})}),s.jsx(Ee.div,{initial:{opacity:0},whileInView:{opacity:1},viewport:{once:!0},transition:{delay:.7},children:s.jsx(Hn,{className:"w-8 h-8 text-primary/50"})})]})]}),s.jsxs(Ee.div,{className:"mt-12 text-center",initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},children:[s.jsxs("div",{className:"inline-flex items-center gap-3 px-6 py-3 bg-primary/10 rounded-full border border-primary/20",children:[s.jsx(Ur,{className:"w-6 h-6 text-primary"}),s.jsxs("span",{className:"font-medium text-foreground",children:["= ",s.jsx("span",{className:"text-primary font-bold",children:"Impacto Real Certificado"})," (CDV)"]})]}),s.jsxs("p",{className:"mt-6 text-muted-foreground max-w-xl mx-auto",children:["100% dos resduos vo para cooperativas de catadores. Sua ao no apenas recicla  ",s.jsx("span",{className:"text-primary font-medium",children:"ela transforma vidas."})]})]})]})}),s.jsx("section",{className:"py-20 px-4 md:px-8 bg-card",children:s.jsxs("div",{className:"max-w-6xl mx-auto",children:[s.jsxs("div",{className:"grid md:grid-cols-2 gap-8 lg:gap-12 items-stretch",children:[s.jsxs(Ee.div,{initial:{opacity:0,x:-30},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{duration:.5},className:"flex flex-col h-full",children:[s.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-1.5 bg-primary/20 rounded-full text-primary text-sm font-medium mb-4",children:[s.jsx(oa,{className:"w-4 h-4"}),"Para Voc"]}),s.jsxs("h2",{className:"font-display text-2xl md:text-3xl font-bold mb-3",children:["Como Voc ",s.jsx("span",{className:"text-primary",children:"Participa"})]}),s.jsx("p",{className:"text-muted-foreground mb-6",children:"Recicle, aprenda e ganhe. Simples assim."}),s.jsx("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[{icon:cx,step:"1",title:"Aprenda",desc:"Misses de educao ambiental",color:"bg-blue-500"},{icon:D6,step:"2",title:"Registre",desc:"Escaneie notas fiscais",color:"bg-purple-500"},{icon:tl,step:"3",title:"Entregue",desc:"Leve s cooperativas",color:"bg-primary"},{icon:Jn,step:"4",title:"Ganhe",desc:"Troque por descontos",color:"bg-accent"}].map((t,r)=>s.jsx(Ee.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:r*.1},children:s.jsxs(Ne,{className:"p-4 h-full text-center hover:shadow-md transition-shadow",children:[s.jsx("div",{className:`w-10 h-10 ${t.color} rounded-xl flex items-center justify-center mx-auto mb-2`,children:s.jsx(t.icon,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{className:"text-[10px] font-semibold text-muted-foreground mb-0.5",children:["PASSO ",t.step]}),s.jsx("h3",{className:"font-display text-sm font-semibold mb-1",children:t.title}),s.jsx("p",{className:"text-xs text-muted-foreground leading-tight",children:t.desc})]})},r))}),s.jsx("div",{className:"p-4 bg-gradient-to-r from-primary/10 to-accent/10 rounded-xl border border-primary/20 mb-6",children:s.jsxs("p",{className:"text-sm font-medium text-foreground text-center",children:[s.jsx("span",{className:"text-primary font-semibold",children:"Quanto mais voc recicla,"})," ","mais voc ganha."]})}),s.jsx("div",{className:"flex-grow"}),s.jsxs(oe,{className:"w-full bg-primary hover:bg-primary/90 text-white font-display mt-auto",onClick:()=>e("/auth"),children:["Cadastre Grtis",s.jsx(Hn,{className:"w-4 h-4 ml-2"})]})]}),s.jsxs(Ee.div,{initial:{opacity:0,x:30},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{duration:.5},className:"flex flex-col h-full",children:[s.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-1.5 bg-accent/20 rounded-full text-accent text-sm font-medium mb-4",children:[s.jsx(hn,{className:"w-4 h-4"}),"Para Empresas"]}),s.jsxs("h2",{className:"font-display text-2xl md:text-3xl font-bold mb-3",children:["Por Que ",s.jsx("span",{className:"text-primary",children:"Investir"})]}),s.jsx("p",{className:"text-muted-foreground mb-6",children:"Patrocine impacto real e comprove resultados."}),s.jsx("div",{className:"space-y-3 mb-6",children:[{icon:Qn,title:"Certificado Digital Verde (CDV)",desc:"QR Code pblico e verificvel"},{icon:Su,title:"Dashboard em Tempo Real",desc:"Acompanhe kg, horas e famlias"},{icon:S6,title:"Marketing Verde Autntico",desc:"Comunicao baseada em dados"},{icon:jl,title:"Compliance ESG",desc:"Relatrios auditveis"}].map((t,r)=>s.jsxs(Ee.div,{initial:{opacity:0,x:20},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{delay:r*.1},className:"flex items-center gap-3 p-3 bg-background rounded-lg border hover:border-primary/30 transition-colors",children:[s.jsx("div",{className:"w-9 h-9 bg-primary/10 rounded-lg flex items-center justify-center shrink-0",children:s.jsx(t.icon,{className:"w-5 h-5 text-primary"})}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("h3",{className:"font-display text-sm font-semibold truncate",children:t.title}),s.jsx("p",{className:"text-xs text-muted-foreground",children:t.desc})]})]},r))}),s.jsxs("div",{className:"p-4 bg-accent/5 rounded-xl border border-accent/20 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ir,{className:"w-4 h-4 text-accent"}),s.jsx("span",{className:"text-sm font-semibold",children:"Projetos Disponveis via LIR"})]}),s.jsxs("p",{className:"text-xs text-muted-foreground mb-3",children:["Invista at ",s.jsx("span",{className:"font-semibold text-primary",children:"1% do seu Imposto de Renda"})," em projetos aprovados pelo MMA."]})]}),s.jsxs(oe,{className:"w-full bg-accent hover:bg-accent/90 text-white font-display",onClick:()=>e("/cdv-investidor"),children:["Consulte Condies",s.jsx(Hn,{className:"w-4 h-4 ml-2"})]})]})]}),s.jsxs(Ee.div,{className:"mt-12 pt-8 border-t flex flex-wrap justify-center gap-6 items-center",initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(Da,{className:"w-5 h-5 text-primary"}),"Validao pblica por QR Code"]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(vi,{className:"w-5 h-5 text-primary"}),"Auditoria independente"]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(jl,{className:"w-5 h-5 text-primary"}),"Projetos aprovados pelo MMA"]})]})]})}),s.jsx("section",{className:"py-20 px-4 md:px-8 bg-gradient-to-b from-card to-background",children:s.jsxs("div",{className:"max-w-5xl mx-auto",children:[s.jsx(Ee.div,{className:"text-center",initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},children:s.jsxs(Ne,{className:"p-8 md:p-12 bg-gradient-to-br from-primary/5 to-accent/5 border-primary/20",children:[s.jsx("h3",{className:"font-display text-2xl md:text-3xl font-bold mb-4",children:"Faa Parte da Revoluo"}),s.jsx("p",{className:"text-muted-foreground mb-8 max-w-lg mx-auto",children:"Faa parte do movimento que est reinventando a economia circular no Brasil."}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[s.jsxs(oe,{size:"lg",className:"text-lg px-8",onClick:()=>e("/auth"),children:[s.jsx(cr,{className:"w-5 h-5 mr-2"}),"Participar e Ganhar Pontos"]}),s.jsxs(oe,{variant:"outline",size:"lg",className:"text-lg px-8 border-accent text-accent hover:bg-accent hover:text-accent-foreground",onClick:()=>{window.scrollTo(0,0),e("/apresentacao-investidor")},children:[s.jsx(hn,{className:"w-5 h-5 mr-2"}),"Patrocinar Impacto Real",s.jsx(Hn,{className:"w-5 h-5 ml-2"})]})]})]})}),s.jsx("div",{className:"mt-12 text-center text-sm text-muted-foreground",children:s.jsx("p",{children:"contato@ciclik.com.br  ciclik.com.br"})})]})})]})},wue={8:Zc,9:Qc,10:Jc,11:ed,12:td,13:sd},$c=({children:e,className:t="",id:r})=>{const a=E.useRef(null),n=zb(a,{once:!0,margin:"-100px"});return s.jsx(Ee.section,{ref:a,id:r,initial:{opacity:0,y:50},animate:n?{opacity:1,y:0}:{},transition:{duration:.8,ease:"easeOut"},className:`min-h-screen flex items-center justify-center py-16 px-4 md:px-8 ${t}`,children:e})},bue=()=>{const e=ds(),t=r=>{var a;(a=document.getElementById(r))==null||a.scrollIntoView({behavior:"smooth"})};return s.jsxs("div",{className:"bg-background text-foreground overflow-x-hidden",children:[s.jsx(Ee.div,{className:"fixed top-4 left-4 z-50",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5},children:s.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>e("/apresentacao"),className:"font-display font-medium bg-white/90 backdrop-blur-sm hover:bg-white shadow-md rounded-full gap-2",children:[s.jsx(As,{className:"w-4 h-4"}),"Voltar"]})}),s.jsxs($c,{id:"hero",className:"bg-gradient-to-br from-primary/10 via-background to-secondary/10 relative",children:[s.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[...Array(8)].map((r,a)=>s.jsx("div",{className:"absolute",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,opacity:.3},children:s.jsx(cr,{className:"w-6 h-6 text-primary/30"})},a))}),s.jsxs("div",{className:"max-w-6xl mx-auto text-center relative z-10",children:[s.jsx(Ee.div,{initial:{scale:0},animate:{scale:1},transition:{duration:.8,type:"spring"},className:"mb-6",children:s.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-primary/10 rounded-full mb-4",children:[s.jsx(hn,{className:"w-5 h-5 text-primary"}),s.jsx("span",{className:"font-display text-primary font-medium",children:"Para Empresas Investidoras"})]})}),s.jsx(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"mb-6",children:s.jsx("img",{src:"/Ciclik_validacoes/logo-with-slogan.png",alt:"Ciclik",className:"h-20 md:h-24 mx-auto"})}),s.jsxs(Ee.h1,{className:"text-3xl md:text-5xl lg:text-6xl font-display font-bold text-foreground mb-6",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.3},children:["Certificado Digital",s.jsx("br",{}),s.jsx("span",{className:"text-primary",children:"Verde (CDV)"})]}),s.jsxs(Ee.p,{className:"text-lg md:text-xl text-muted-foreground font-body max-w-3xl mx-auto mb-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:["Invista em impacto ambiental ",s.jsx("strong",{children:"real, mensurvel e auditvel"}),". Associe sua marca a aes concretas de reciclagem e educao ambiental."]}),s.jsx(Ee.div,{className:"grid grid-cols-3 gap-4 max-w-2xl mx-auto mb-10",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},children:[{value:"256",label:"UIBs por CDV"},{value:"100%",label:"Rastrevel"},{value:"QR Code",label:"Validao Pblica"}].map((r,a)=>s.jsxs("div",{className:"bg-card/80 backdrop-blur p-4 rounded-xl border",children:[s.jsx("div",{className:"text-2xl font-display font-bold text-primary",children:r.value}),s.jsx("div",{className:"text-xs text-muted-foreground",children:r.label})]},a))}),s.jsxs(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7},className:"flex flex-col sm:flex-row gap-4 justify-center",children:[s.jsxs(oe,{size:"lg",className:"bg-primary hover:bg-primary/90 text-primary-foreground font-display text-lg px-8",onClick:()=>e("/investidor"),children:[s.jsx(dx,{className:"w-5 h-5 mr-2"}),"Quero Investir"]}),s.jsxs(oe,{size:"lg",variant:"outline",className:"font-display text-lg px-8",onClick:()=>t("oque"),children:["Saiba Mais",s.jsx(Hn,{className:"w-5 h-5 ml-2"})]})]}),s.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 cursor-pointer opacity-60 hover:opacity-100 transition-opacity",onClick:()=>t("oque"),children:s.jsx(If,{className:"w-8 h-8 text-muted-foreground"})})]})]}),s.jsx($c,{id:"oque",className:"bg-card",children:s.jsxs("div",{className:"max-w-6xl mx-auto",children:[s.jsxs("div",{className:"text-center mb-12",children:[s.jsx(Ee.span,{className:"inline-block px-4 py-2 bg-primary/10 text-primary rounded-full font-display text-sm mb-4",whileInView:{scale:[.8,1]},children:"O Produto"}),s.jsxs("h2",{className:"text-3xl md:text-4xl font-display font-bold mb-6",children:["Como funciona o ",s.jsx("span",{className:"text-primary",children:"CDV"}),"?"]}),s.jsxs("p",{className:"text-lg text-muted-foreground font-body max-w-3xl mx-auto",children:["A Ciclik desenvolve ",s.jsx("strong",{children:"projetos de sustentabilidade"})," que geram impacto ambiental real, rastrevel e auditvel. Cada projeto  dividido em ",s.jsx("strong",{children:"quotas"})," que podem ser adquiridas por investidores."]})]}),s.jsxs("div",{className:"grid lg:grid-cols-2 gap-8 mb-12",children:[s.jsxs(Ee.div,{className:"bg-gradient-to-br from-primary/10 to-primary/5 p-8 rounded-3xl border",whileInView:{opacity:1,x:0},initial:{opacity:0,x:-30},children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx("div",{className:"w-12 h-12 bg-primary rounded-xl flex items-center justify-center",children:s.jsx(dx,{className:"w-6 h-6 text-primary-foreground"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-display font-bold text-xl",children:"Cada Quota = R$ 2.000"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Investimento mnimo por quota"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("p",{className:"text-muted-foreground font-body",children:["Cada quota adquirida d direito a ",s.jsx("strong",{children:"1 CDV"})," que ser emitido quando o projeto gerar o impacto correspondente:"]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[{icon:Ur,value:"250 kg",label:"Resduos Reciclados"},{icon:Xa,value:"5 horas",label:"Educao Ambiental"},{icon:$2,value:"1 estudo",label:"Reciclabilidade"},{icon:oa,value:"~134",label:"Pessoas Impactadas"}].map((r,a)=>s.jsxs(Ee.div,{className:"text-center p-4 bg-background/80 rounded-xl",whileInView:{opacity:1,y:0},initial:{opacity:0,y:20},transition:{delay:a*.1},children:[s.jsx(r.icon,{className:"w-6 h-6 text-primary mx-auto mb-2"}),s.jsx("div",{className:"text-lg font-display font-bold",children:r.value}),s.jsx("div",{className:"text-xs text-muted-foreground hyphens-auto",lang:"pt-BR",children:r.label})]},a))})]})]}),s.jsxs(Ee.div,{className:"bg-card p-8 rounded-3xl border shadow-lg",whileInView:{opacity:1,x:0},initial:{opacity:0,x:30},children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx("div",{className:"w-12 h-12 bg-secondary rounded-xl flex items-center justify-center",children:s.jsx(Ir,{className:"w-6 h-6 text-secondary-foreground"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-display font-bold text-xl",children:"Exemplo: Projeto 1.000 Quotas"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Valor total: R$ 2.000.000"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[s.jsx("span",{className:"font-body",children:"Resduos Reciclados"}),s.jsx("span",{className:"font-display font-bold text-primary",children:"250 toneladas"})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[s.jsx("span",{className:"font-body",children:"Educao Ambiental"}),s.jsx("span",{className:"font-display font-bold text-primary",children:"5.000 horas"})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[s.jsx("span",{className:"font-body",children:"Estudos de Reciclabilidade"}),s.jsx("span",{className:"font-display font-bold text-primary",children:"1.000 produtos"})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 bg-primary/10 rounded-lg border border-primary/20",children:[s.jsx("span",{className:"font-display font-semibold",children:"CDVs Emitidos"}),s.jsx("span",{className:"font-display font-bold text-2xl text-primary",children:"1.000"})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 bg-ciclik-orange/10 rounded-lg border border-ciclik-orange/30",children:[s.jsx("span",{className:"font-display font-semibold",children:"Pessoas Impactadas"}),s.jsx("span",{className:"font-display font-bold text-2xl text-ciclik-orange",children:"~134 mil"})]})]}),s.jsxs("div",{className:"mt-6 p-4 bg-gradient-to-r from-primary/5 to-ciclik-orange/5 rounded-xl border border-primary/10",children:[s.jsx("p",{className:"text-xs text-muted-foreground text-center mb-3 font-body",children:" Ecossistema Ciclik Atual"}),s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-lg font-display font-bold text-primary",children:"+4 mil"}),s.jsx("div",{className:"text-xs text-muted-foreground",children:"CDVs Ativos"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-lg font-display font-bold text-primary",children:"382 ton"}),s.jsx("div",{className:"text-xs text-muted-foreground",children:"Reciclado"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-lg font-display font-bold text-primary",children:"800h"}),s.jsx("div",{className:"text-xs text-muted-foreground",children:"Educao"})]})]})]})]})]}),s.jsxs("div",{className:"bg-muted/30 p-8 rounded-3xl",children:[s.jsx("h3",{className:"text-xl font-display font-bold text-center mb-8",children:"Jornada do Investidor"}),s.jsx("div",{className:"grid md:grid-cols-4 gap-6",children:[{step:1,icon:ki,title:"Escolha o Projeto",desc:"Analise os projetos Ciclik disponveis e seus impactos"},{step:2,icon:dx,title:"Adquira Quotas",desc:"Invista R$ 2.000 por quota no projeto escolhido"},{step:3,icon:Gn,title:"Acompanhe",desc:"Monitore o progresso do impacto em tempo real no dashboard"},{step:4,icon:Qn,title:"Receba seu CDV",desc:"Certificado emitido quando o impacto for gerado e auditado"}].map((r,a)=>s.jsxs(Ee.div,{className:"relative text-center",whileInView:{opacity:1,y:0},initial:{opacity:0,y:20},transition:{delay:a*.1},children:[s.jsx("div",{className:"w-10 h-10 bg-primary text-primary-foreground rounded-full flex items-center justify-center mx-auto mb-3 font-display font-bold",children:r.step}),s.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-xl flex items-center justify-center mx-auto mb-3",children:s.jsx(r.icon,{className:"w-6 h-6 text-primary"})}),s.jsx("h4",{className:"font-display font-semibold mb-2",children:r.title}),s.jsx("p",{className:"text-sm text-muted-foreground font-body",children:r.desc}),a<3&&s.jsx("div",{className:"hidden md:block absolute top-8 -right-3",children:s.jsx(Hn,{className:"w-6 h-6 text-primary/30"})})]},a))})]}),s.jsx(Ee.div,{className:"mt-12 p-6 bg-gradient-to-br from-ciclik-green/10 to-ciclik-green/5 rounded-2xl border border-ciclik-green/30",whileInView:{opacity:1,y:0},initial:{opacity:0,y:20},children:s.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-4",children:[s.jsx("div",{className:"p-4 bg-ciclik-green rounded-2xl shrink-0",children:s.jsx(jl,{className:"w-8 h-8 text-white"})}),s.jsxs("div",{className:"text-center md:text-left",children:[s.jsx("h4",{className:"font-display font-bold text-xl text-ciclik-green mb-2",children:" Incentivo Fiscal via LIR"}),s.jsxs("p",{className:"text-muted-foreground font-body",children:["CDVs podem ser adquiridos por meio da ",s.jsx("strong",{className:"text-foreground",children:"Lei de Incentivo  Reciclagem (LIR)"}),", utilizando um percentual do ",s.jsx("strong",{className:"text-foreground",children:"Imposto de Renda devido"}),". Consulte a disponibilidade de projetos aprovados pelo ",s.jsx("strong",{className:"text-foreground",children:"Ministrio do Meio Ambiente"}),"."]})]})]})}),s.jsxs(Ee.div,{className:"mt-12 p-8 bg-gradient-to-br from-ciclik-green/5 to-transparent rounded-2xl border",whileInView:{opacity:1,y:0},initial:{opacity:0,y:20},children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h4",{className:"font-display font-bold text-2xl mb-3",children:" Alinhamento com a Agenda 2030"}),s.jsx("p",{className:"text-muted-foreground font-body max-w-2xl mx-auto",children:"Os CDVs Ciclik contribuem diretamente para 6 Objetivos de Desenvolvimento Sustentvel da ONU."})]}),s.jsx("div",{className:"grid grid-cols-3 md:grid-cols-6 gap-4",children:[{num:8,name:"Trabalho Decente e Crescimento Econmico"},{num:9,name:"Indstria, Inovao e Infraestrutura"},{num:10,name:"Reduo das Desigualdades"},{num:11,name:"Cidades e Comunidades Sustentveis"},{num:12,name:"Consumo e Produo Responsveis"},{num:13,name:"Ao Contra a Mudana Global do Clima"}].map((r,a)=>s.jsxs(Ee.div,{className:"group relative",whileInView:{opacity:1,scale:1},initial:{opacity:0,scale:.8},transition:{delay:a*.1},whileHover:{scale:1.1,zIndex:10},children:[s.jsx("img",{src:wue[r.num],alt:`ODS ${r.num}: ${r.name}`,className:"w-full rounded-lg shadow-md"}),s.jsx("div",{className:"absolute inset-0 bg-black/80 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center p-2",children:s.jsx("p",{className:"text-white text-xs font-body text-center",children:r.name})})]},r.num))})]}),s.jsx(Ee.div,{className:"mt-8 p-6 bg-gradient-to-r from-primary to-primary/80 rounded-2xl text-primary-foreground text-center",whileInView:{opacity:1,scale:1},initial:{opacity:0,scale:.95},children:s.jsxs("p",{className:"text-lg font-display font-semibold",children:[" O CDV  emitido apenas quando o impacto ambiental  ",s.jsx("strong",{children:"efetivamente gerado"}),",",s.jsx("strong",{children:" rastreado"})," e ",s.jsx("strong",{children:"auditado"}),"  garantindo total transparncia e credibilidade."]})})]})}),s.jsx($c,{id:"como",className:"bg-muted/30",children:s.jsxs("div",{className:"max-w-6xl mx-auto",children:[s.jsxs("div",{className:"text-center mb-16",children:[s.jsx(Ee.span,{className:"inline-block px-4 py-2 bg-secondary/10 text-secondary-foreground rounded-full font-display text-sm mb-4",whileInView:{scale:[.8,1]},children:"O Processo"}),s.jsxs("h2",{className:"text-3xl md:text-4xl font-display font-bold mb-6",children:["Como o ",s.jsx("span",{className:"text-primary",children:"Impacto"}),"  Gerado?"]}),s.jsx("p",{className:"text-lg text-muted-foreground font-body max-w-2xl mx-auto",children:"Cada ao de um cidado no ecossistema Ciclik gera UIBs rastreveis que so atribudas ao seu CDV."})]}),s.jsx("div",{className:"grid md:grid-cols-4 gap-6 mb-12",children:[{step:1,icon:oa,title:"Usurio Age",desc:"Recicla, estuda ou registra compras no app Ciclik"},{step:2,icon:Su,title:"UIB Gerada",desc:"Sistema registra a Unidade de Impacto Base"},{step:3,icon:Eo,title:"Atribuio",desc:"UIB  vinculada ao seu CDV em maturao"},{step:4,icon:jl,title:"Certificado",desc:"Ao completar 256 UIBs, certificado  emitido"}].map((r,a)=>s.jsxs(Ee.div,{className:"relative",whileInView:{opacity:1,y:0},initial:{opacity:0,y:30},transition:{delay:a*.15},children:[s.jsxs("div",{className:"bg-card p-6 rounded-2xl border shadow-lg h-full text-center",children:[s.jsx("div",{className:"w-8 h-8 bg-primary text-primary-foreground rounded-full flex items-center justify-center mx-auto mb-4 font-display font-bold",children:r.step}),s.jsx("div",{className:"w-14 h-14 bg-primary/10 rounded-xl flex items-center justify-center mx-auto mb-4",children:s.jsx(r.icon,{className:"w-7 h-7 text-primary"})}),s.jsx("h3",{className:"text-lg font-display font-semibold mb-2",children:r.title}),s.jsx("p",{className:"text-sm text-muted-foreground font-body",children:r.desc})]}),a<3&&s.jsx("div",{className:"hidden md:block absolute top-1/2 -right-3 w-6",children:s.jsx(Hn,{className:"w-6 h-6 text-primary/30"})})]},a))}),s.jsxs(Ee.div,{className:"bg-card p-8 rounded-2xl border shadow-lg max-w-3xl mx-auto",whileInView:{opacity:1,scale:1},initial:{opacity:0,scale:.95},children:[s.jsx("h3",{className:"text-center font-display font-bold mb-6",children:"Frmula do CDV"}),s.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-4",children:[s.jsxs("div",{className:"bg-primary/10 p-4 rounded-xl text-center",children:[s.jsx(Ur,{className:"w-8 h-8 text-primary mx-auto mb-2"}),s.jsx("div",{className:"font-display font-bold",children:"250 kg"}),s.jsx("div",{className:"text-xs text-muted-foreground",children:"Resduos"})]}),s.jsx("span",{className:"text-2xl font-bold text-muted-foreground",children:"+"}),s.jsxs("div",{className:"bg-blue-500/10 p-4 rounded-xl text-center",children:[s.jsx(Xa,{className:"w-8 h-8 text-blue-500 mx-auto mb-2"}),s.jsx("div",{className:"font-display font-bold",children:"5 horas"}),s.jsx("div",{className:"text-xs text-muted-foreground",children:"Educao"})]}),s.jsx("span",{className:"text-2xl font-bold text-muted-foreground",children:"+"}),s.jsxs("div",{className:"bg-secondary/10 p-4 rounded-xl text-center",children:[s.jsx($2,{className:"w-8 h-8 text-secondary mx-auto mb-2"}),s.jsx("div",{className:"font-display font-bold",children:"1 produto"}),s.jsx("div",{className:"text-xs text-muted-foreground",children:"Mapeado"})]}),s.jsx("span",{className:"text-2xl font-bold text-muted-foreground",children:"="}),s.jsxs("div",{className:"bg-gradient-to-br from-primary to-primary/80 p-4 rounded-xl text-center text-primary-foreground",children:[s.jsx(Qn,{className:"w-8 h-8 mx-auto mb-2"}),s.jsx("div",{className:"font-display font-bold",children:"1 CDV"}),s.jsx("div",{className:"text-xs opacity-80",children:"256 UIBs"})]})]})]})]})}),s.jsx($c,{id:"beneficios",className:"bg-gradient-to-br from-primary/5 to-secondary/5",children:s.jsxs("div",{className:"max-w-6xl mx-auto",children:[s.jsxs("div",{className:"text-center mb-16",children:[s.jsx(Ee.span,{className:"inline-block px-4 py-2 bg-primary/10 text-primary rounded-full font-display text-sm mb-4",whileInView:{scale:[.8,1]},children:"Vantagens"}),s.jsxs("h2",{className:"text-3xl md:text-4xl font-display font-bold mb-6",children:["Por que investir em ",s.jsx("span",{className:"text-primary",children:"CDV"}),"?"]})]}),s.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[{icon:vi,title:"Compliance ESG",desc:"Atenda requisitos regulatrios e de investidores com impacto comprovado",color:"primary"},{icon:h6,title:"Marketing Autntico",desc:"Comunique sustentabilidade com dados reais, no promessas vazias",color:"secondary"},{icon:Da,title:"Validao Pblica",desc:"Qualquer pessoa pode verificar seu impacto via QR Code",color:"primary"},{icon:x6,title:"Dashboard em Tempo Real",desc:"Acompanhe o progresso do seu CDV a qualquer momento",color:"blue-500"},{icon:Eh,title:"Impacto Local",desc:"Apoie cooperativas e comunidades brasileiras diretamente",color:"primary"},{icon:Ir,title:"Valorizao de Marca",desc:"Diferenciao competitiva com selo Ciclik - Digital Verde",color:"secondary"}].map((r,a)=>s.jsxs(Ee.div,{className:"bg-card p-6 rounded-2xl border shadow-lg",whileInView:{opacity:1,y:0},initial:{opacity:0,y:30},transition:{delay:a*.1},whileHover:{y:-5,transition:{duration:.2}},children:[s.jsx("div",{className:`w-14 h-14 bg-${r.color}/10 rounded-xl flex items-center justify-center mb-4`,children:s.jsx(r.icon,{className:`w-7 h-7 text-${r.color}`})}),s.jsx("h3",{className:"text-lg font-display font-semibold mb-2",children:r.title}),s.jsx("p",{className:"text-muted-foreground font-body text-sm",children:r.desc})]},a))})]})}),s.jsx($c,{id:"dashboard",className:"bg-card",children:s.jsx("div",{className:"max-w-6xl mx-auto",children:s.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 items-center",children:[s.jsxs(Ee.div,{whileInView:{opacity:1,x:0},initial:{opacity:0,x:-30},children:[s.jsx(Ee.span,{className:"inline-block px-4 py-2 bg-primary/10 text-primary rounded-full font-display text-sm mb-4",whileInView:{scale:[.8,1]},children:"Sua Experincia"}),s.jsxs("h2",{className:"text-3xl md:text-4xl font-display font-bold mb-6",children:["Dashboard do ",s.jsx("span",{className:"text-primary",children:"Investidor"})]}),s.jsx("p",{className:"text-lg text-muted-foreground font-body mb-8",children:"Acompanhe em tempo real o progresso dos seus CDVs, visualize mtricas de impacto e emita certificados quando estiverem completos."}),s.jsx("div",{className:"space-y-4",children:[{icon:g6,text:"Progresso detalhado por tipo de impacto"},{icon:ki,text:"Visibilidade total das UIBs atribudas"},{icon:Fa,text:"Acompanhamento do perodo de maturao"},{icon:jl,text:"Emisso automtica de certificados"},{icon:Da,text:"QR Codes para validao pblica"}].map((r,a)=>s.jsxs(Ee.div,{className:"flex items-center gap-4",whileInView:{opacity:1,x:0},initial:{opacity:0,x:-20},transition:{delay:a*.1},children:[s.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:s.jsx(r.icon,{className:"w-5 h-5 text-primary"})}),s.jsx("span",{className:"font-body",children:r.text})]},a))})]}),s.jsxs(Ee.div,{className:"relative",whileInView:{opacity:1,scale:1},initial:{opacity:0,scale:.9},transition:{delay:.3},children:[s.jsxs("div",{className:"bg-muted/50 p-6 rounded-3xl border shadow-2xl",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("img",{src:"/Ciclik_validacoes/ciclik-logo.png",alt:"Ciclik",className:"h-6"}),s.jsx("span",{className:"font-display font-semibold",children:"Meu Portflio"})]}),s.jsx("div",{className:"px-3 py-1 bg-primary/10 rounded-full text-sm text-primary font-medium",children:"3 CDVs Ativos"})]}),s.jsx("div",{className:"space-y-4 mb-6",children:[{label:"Resduos",progress:78,color:"bg-primary",value:"585 kg"},{label:"Educao",progress:92,color:"bg-blue-500",value:"13,8 h"},{label:"Produtos",progress:100,color:"bg-[#FBBB1A]",value:"3"}].map((r,a)=>s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[s.jsx("span",{className:"font-medium font-body",children:r.label}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-display font-semibold text-foreground",children:r.value}),s.jsxs("span",{className:`text-xs px-2 py-0.5 rounded-full ${r.progress===100?"bg-primary/20 text-primary font-semibold":"text-muted-foreground bg-muted"}`,children:[r.progress,"%"]})]})]}),s.jsx("div",{className:"h-3 bg-muted rounded-full overflow-hidden shadow-inner",children:s.jsx(Ee.div,{className:`h-full ${r.color} rounded-full shadow-sm`,initial:{width:0},whileInView:{width:`${r.progress}%`},transition:{duration:1.2,delay:a*.15,ease:"easeOut"}})})]},a))}),s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[s.jsxs("div",{className:"bg-gradient-to-br from-primary/10 to-primary/5 p-4 rounded-xl text-center border border-primary/20",children:[s.jsx("div",{className:"text-xl font-display font-bold text-primary",children:"585 kg"}),s.jsx("div",{className:"text-xs text-muted-foreground font-body",children:"Total Reciclado"})]}),s.jsxs("div",{className:"bg-gradient-to-br from-blue-500/10 to-blue-500/5 p-4 rounded-xl text-center border border-blue-500/20",children:[s.jsx("div",{className:"text-xl font-display font-bold text-blue-600",children:"13,8 h"}),s.jsx("div",{className:"text-xs text-muted-foreground font-body",children:"Educao"})]}),s.jsxs("div",{className:"bg-gradient-to-br from-ciclik-orange/10 to-ciclik-orange/5 p-4 rounded-xl text-center border border-ciclik-orange/20",children:[s.jsx("div",{className:"text-xl font-display font-bold text-ciclik-orange",children:"3"}),s.jsx("div",{className:"text-xs text-muted-foreground font-body",children:"Produtos"})]})]})]}),s.jsx("div",{className:"absolute -z-10 -top-4 -left-4 w-full h-full bg-primary/10 rounded-3xl"})]})]})})}),s.jsx($c,{id:"certificado",className:"bg-muted/30",children:s.jsxs("div",{className:"max-w-6xl mx-auto",children:[s.jsxs("div",{className:"text-center mb-16",children:[s.jsx(Ee.span,{className:"inline-block px-4 py-2 bg-primary/10 text-primary rounded-full font-display text-sm mb-4",whileInView:{scale:[.8,1]},children:"O Resultado"}),s.jsxs("h2",{className:"text-3xl md:text-4xl font-display font-bold mb-6",children:["Seu ",s.jsx("span",{className:"text-primary",children:"Certificado"})," Digital"]}),s.jsx("p",{className:"text-lg text-muted-foreground font-body max-w-2xl mx-auto",children:"Ao completar 100% das metas, seu certificado  emitido automaticamente com validao pblica via QR Code."})]}),s.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 items-center",children:[s.jsxs(Ee.div,{className:"bg-card p-8 rounded-3xl border shadow-2xl",whileInView:{opacity:1,rotateY:0},initial:{opacity:0,rotateY:-15},transition:{duration:.8},children:[s.jsx("div",{className:"border-b pb-6 mb-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("img",{src:"/Ciclik_validacoes/ciclik-logo.png",alt:"Ciclik",className:"h-10"}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-xs text-muted-foreground",children:"Certificado N"}),s.jsx("div",{className:"font-mono text-sm",children:"CDV-2025-00142"})]})]})}),s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("h3",{className:"text-xl font-display font-bold mb-2",children:"Certificado Digital Verde"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Ciclik - Digital Verde"})]}),s.jsx("div",{className:"bg-muted/50 p-4 rounded-xl mb-6",children:s.jsxs("div",{className:"text-center mb-4",children:[s.jsx("div",{className:"text-sm text-muted-foreground",children:"Empresa Certificada"}),s.jsx("div",{className:"font-display font-bold text-lg",children:"Sua Empresa LTDA"}),s.jsx("div",{className:"text-xs text-muted-foreground",children:"CNPJ: 00.000.000/0001-00"})]})}),s.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[s.jsxs("div",{className:"text-center p-3 bg-primary/5 rounded-lg",children:[s.jsx(Ur,{className:"w-6 h-6 text-primary mx-auto mb-1"}),s.jsx("div",{className:"font-bold",children:"250 kg"}),s.jsx("div",{className:"text-xs text-muted-foreground",children:"Reciclados"})]}),s.jsxs("div",{className:"text-center p-3 bg-blue-500/5 rounded-lg",children:[s.jsx(Xa,{className:"w-6 h-6 text-blue-500 mx-auto mb-1"}),s.jsx("div",{className:"font-bold",children:"5 horas"}),s.jsx("div",{className:"text-xs text-muted-foreground",children:"Educao"})]}),s.jsxs("div",{className:"text-center p-3 bg-secondary/5 rounded-lg",children:[s.jsx(y4,{className:"w-6 h-6 text-secondary mx-auto mb-1"}),s.jsx("div",{className:"font-bold",children:"425 kg"}),s.jsx("div",{className:"text-xs text-muted-foreground",children:"CO Evitado"})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-xs text-muted-foreground",children:[s.jsx("div",{children:"Emitido em: 05/01/2026"}),s.jsx("div",{children:"Vlido permanentemente"})]}),s.jsx("div",{className:"w-16 h-16 bg-muted rounded-lg flex items-center justify-center",children:s.jsx(Da,{className:"w-12 h-12 text-muted-foreground"})})]})]}),s.jsx("div",{className:"space-y-6",children:[{icon:E6,title:"Imutvel e Permanente",desc:"Uma vez emitido, o certificado  permanente e no pode ser alterado"},{icon:Da,title:"Validao Pblica",desc:"Qualquer pessoa pode escanear o QR Code e verificar a autenticidade"},{icon:Eh,title:"Compartilhvel",desc:"Link pblico para incluir em relatrios, sites e materiais de marketing"},{icon:jl,title:"Download em PDF",desc:"Baixe o certificado em alta resoluo para impresso ou arquivo"}].map((r,a)=>s.jsxs(Ee.div,{className:"flex gap-4",whileInView:{opacity:1,x:0},initial:{opacity:0,x:20},transition:{delay:a*.15},children:[s.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-xl flex items-center justify-center flex-shrink-0",children:s.jsx(r.icon,{className:"w-6 h-6 text-primary"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-display font-semibold mb-1",children:r.title}),s.jsx("p",{className:"text-sm text-muted-foreground font-body",children:r.desc})]})]},a))})]})]})}),s.jsx($c,{id:"projetos-lir",className:"bg-background",children:s.jsxs("div",{className:"max-w-6xl mx-auto",children:[s.jsxs("div",{className:"text-center mb-12",children:[s.jsx(Ee.span,{className:"inline-block px-4 py-2 bg-primary/10 text-primary rounded-full font-display text-sm mb-4",whileInView:{scale:[.8,1]},children:"Aprovados pelo MMA"}),s.jsxs("h2",{className:"text-3xl md:text-4xl font-display font-bold mb-4",children:["Projetos ",s.jsx("span",{className:"text-primary",children:"LIR"})," Disponveis"]}),s.jsx("p",{className:"text-lg text-muted-foreground font-body max-w-3xl mx-auto",children:"Projetos aprovados pelo Ministrio do Meio Ambiente elegveis para captao via Lei de Incentivo  Reciclagem (Lei n 14.260/2021)"})]}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[s.jsxs(Ee.div,{className:"bg-card p-8 rounded-3xl border shadow-lg",whileInView:{opacity:1,y:0},initial:{opacity:0,y:30},transition:{delay:.1},children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-xl flex items-center justify-center",children:s.jsx(Ur,{className:"w-6 h-6 text-primary"})}),s.jsxs("div",{children:[s.jsx(Je,{variant:"outline",className:"bg-primary/5 text-primary border-primary/20 mb-1",children:"MMA e ILZB"}),s.jsx("h3",{className:"font-display font-bold text-xl",children:"Ciclik Gamificao"})]})]}),s.jsxs("div",{className:"space-y-4 mb-6",children:[s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-border/50",children:[s.jsx("span",{className:"text-muted-foreground font-body",children:"Valor Total"}),s.jsx("span",{className:"font-display font-bold text-lg",children:"R$ 1.200.000,00"})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-border/50",children:[s.jsx("span",{className:"text-muted-foreground font-body",children:"Quotas"}),s.jsx("span",{className:"font-display font-bold text-primary",children:"600"})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-border/50",children:[s.jsx("span",{className:"text-muted-foreground font-body",children:"Vigncia"}),s.jsx("span",{className:"font-display font-semibold",children:"10/02/2026 - 10/02/2027"})]}),s.jsxs("div",{className:"flex justify-between items-center py-2",children:[s.jsx("span",{className:"text-muted-foreground font-body",children:"Valor por Quota"}),s.jsx("span",{className:"font-display font-semibold",children:"R$ 2.000,00"})]})]}),s.jsx("div",{className:"p-4 bg-muted/50 rounded-xl mb-4 min-h-[88px] flex items-center",children:s.jsx("p",{className:"text-sm text-muted-foreground font-body",children:"Soluo que combina tecnologia, economia circular, educao ambiental e justia social  com impacto direto na valorizao dos catadores, no fortalecimento das cadeias de reciclagem e na regenerao dos territrios."})}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs mb-4",children:[s.jsxs("div",{className:"p-2 bg-primary/5 rounded-lg text-center",children:[s.jsx("div",{className:"font-semibold",children:"150.000 kg"}),s.jsx("div",{className:"text-muted-foreground",children:"Resduos"})]}),s.jsxs("div",{className:"p-2 bg-primary/5 rounded-lg text-center",children:[s.jsx("div",{className:"font-semibold",children:"3.000 min"}),s.jsx("div",{className:"text-muted-foreground",children:"Educao"})]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[s.jsx(vi,{className:"w-4 h-4 text-primary"}),s.jsx("span",{children:"Aprovado pelo Ministrio do Meio Ambiente"})]})]}),s.jsxs(Ee.div,{className:"bg-card p-8 rounded-3xl border shadow-lg",whileInView:{opacity:1,y:0},initial:{opacity:0,y:30},transition:{delay:.2},children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx("div",{className:"w-12 h-12 bg-[#FBBB1A]/10 rounded-xl flex items-center justify-center",children:s.jsx(Xa,{className:"w-6 h-6 text-[#FBBB1A]"})}),s.jsxs("div",{children:[s.jsx(Je,{variant:"outline",className:"bg-[#FBBB1A]/5 text-[#FBBB1A] border-[#FBBB1A]/20 mb-1",children:"MMA e ILZB"}),s.jsx("h3",{className:"font-display font-bold text-xl",children:"Ciclik Conecta"})]})]}),s.jsxs("div",{className:"space-y-4 mb-6",children:[s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-border/50",children:[s.jsx("span",{className:"text-muted-foreground font-body",children:"Valor Total"}),s.jsx("span",{className:"font-display font-bold text-lg",children:"R$ 3.000.000,00"})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-border/50",children:[s.jsx("span",{className:"text-muted-foreground font-body",children:"Quotas"}),s.jsx("span",{className:"font-display font-bold text-[#FBBB1A]",children:"1.500"})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-border/50",children:[s.jsx("span",{className:"text-muted-foreground font-body",children:"Vigncia"}),s.jsx("span",{className:"font-display font-semibold",children:"31/12/2025 - 31/12/2027"})]}),s.jsxs("div",{className:"flex justify-between items-center py-2",children:[s.jsx("span",{className:"text-muted-foreground font-body",children:"Valor por Quota"}),s.jsx("span",{className:"font-display font-semibold",children:"R$ 2.000,00"})]})]}),s.jsx("div",{className:"p-4 bg-muted/50 rounded-xl mb-4 min-h-[88px] flex items-center",children:s.jsx("p",{className:"text-sm text-muted-foreground font-body",children:"Implantao de rotas inteligentes de coletas seletivas por meio do programa de fidelidade ambiental da Ciclik em parceria com cooperativas selecionadas."})}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs mb-4",children:[s.jsxs("div",{className:"p-2 bg-[#FBBB1A]/10 rounded-lg text-center",children:[s.jsx("div",{className:"font-semibold",children:"375.000 kg"}),s.jsx("div",{className:"text-muted-foreground",children:"Resduos"})]}),s.jsxs("div",{className:"p-2 bg-[#FBBB1A]/10 rounded-lg text-center",children:[s.jsx("div",{className:"font-semibold",children:"7.500 min"}),s.jsx("div",{className:"text-muted-foreground",children:"Educao"})]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[s.jsx(vi,{className:"w-4 h-4 text-[#FBBB1A]"}),s.jsx("span",{children:"Aprovado pelo Ministrio do Meio Ambiente"})]})]})]}),s.jsx(Ee.div,{className:"mt-12 p-6 bg-gradient-to-r from-primary/5 via-primary/10 to-ciclik-orange/5 rounded-2xl border border-primary/10",whileInView:{opacity:1,y:0},initial:{opacity:0,y:20},children:s.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[s.jsx("div",{className:"w-16 h-16 bg-white rounded-xl flex items-center justify-center shadow-sm flex-shrink-0",children:s.jsx(jl,{className:"w-8 h-8 text-primary"})}),s.jsxs("div",{className:"text-center md:text-left",children:[s.jsx("h4",{className:"font-display font-bold text-lg mb-2",children:"Lei de Incentivo  Reciclagem (LIR)"}),s.jsxs("p",{className:"text-sm text-muted-foreground font-body",children:["Empresas podem deduzir at ",s.jsx("strong",{children:"1% do IRPJ"})," ao investir em projetos aprovados pelo MMA, transformando tributos em impacto ambiental real e certificado."]})]})]})})]})}),s.jsx($c,{id:"cta",className:"bg-gradient-to-br from-primary via-primary/90 to-primary/80 text-primary-foreground",children:s.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[s.jsx(Ee.div,{whileInView:{scale:[.8,1]},className:"mb-8",children:s.jsx("div",{className:"w-24 h-24 bg-white/10 rounded-full flex items-center justify-center mx-auto",children:s.jsx(Qn,{className:"w-12 h-12"})})}),s.jsxs("h2",{className:"text-3xl md:text-5xl font-display font-bold mb-6",children:["Pronto para Certificar",s.jsx("br",{}),"o Impacto da sua Empresa?"]}),s.jsx("p",{className:"text-xl text-primary-foreground/80 font-body mb-8 max-w-2xl mx-auto",children:"Junte-se s empresas que j esto comprovando seu compromisso ambiental com o Certificado Digital Verde."}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[s.jsxs(oe,{size:"lg",className:"bg-white text-primary hover:bg-white/90 font-display text-lg px-8",onClick:()=>e("/investidor"),children:[s.jsx(Go,{className:"w-5 h-5 mr-2"}),"Investir Agora"]}),s.jsxs(oe,{size:"lg",variant:"outline",className:"border-white text-white hover:bg-white/10 font-display text-lg px-8",onClick:()=>e("/investidor#projetos"),children:[s.jsx(ki,{className:"w-5 h-5 mr-2"}),"Ver Projetos Disponveis"]})]}),s.jsxs(Ee.div,{className:"mt-16 pt-8 border-t border-white/20",whileInView:{opacity:1},initial:{opacity:0},children:[s.jsx("p",{className:"text-primary-foreground/60 font-body text-sm mb-4",children:"Dvidas? Fale com nossa equipe comercial"}),s.jsx("p",{className:"font-display text-lg",children:"comercial@ciclik.com.br"})]})]})}),s.jsx("footer",{className:"bg-card py-8 px-4 border-t",children:s.jsxs("div",{className:"max-w-6xl mx-auto flex flex-col md:flex-row items-center justify-between gap-4",children:[s.jsx("img",{src:"/Ciclik_validacoes/ciclik-logo.png",alt:"Ciclik",className:"h-8"}),s.jsxs("p",{className:"text-sm text-muted-foreground font-body",children:[" ",new Date().getFullYear()," Ciclik. Todos os direitos reservados."]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx(oe,{variant:"ghost",size:"sm",onClick:()=>e("/apresentacao"),children:"Apresentao Geral"}),s.jsx(oe,{variant:"ghost",size:"sm",onClick:()=>e("/"),children:"Voltar ao App"})]})]})})]})};function _ue(){const{notifications:e,unreadCount:t,loading:r,preferences:a,markAsRead:n,markAllAsRead:i,deleteNotification:o,updatePreferences:c,requestPushPermission:d}=R7(),h=ds(),p=async N=>{N.read||await n(N.id),N.action_url&&h(N.action_url)},x=async()=>{a!=null&&a.enable_push?(await c({enable_push:!1}),ct.info("Notificaes push desativadas")):await d()?ct.success("Notificaes push ativadas!"):ct.error("Permisso de notificao negada")},v=N=>{switch(N){case"success":return"";case"warning":return"";case"error":return"";case"info":return"";default:return""}},b=e.filter(N=>!N.read);return e.filter(N=>N.read),s.jsxs("div",{className:"container max-w-4xl py-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>{window.scrollTo(0,1),setTimeout(()=>window.scrollTo(0,0),10),h(-1)},children:s.jsx(As,{className:"h-5 w-5"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Notificaes"}),s.jsx("p",{className:"text-muted-foreground",children:"Gerencie suas notificaes e preferncias"})]})]}),s.jsxs(Mn,{defaultValue:"all",className:"w-full",children:[s.jsxs(Nn,{className:"grid w-full grid-cols-3",children:[s.jsxs(Gs,{value:"all",children:["Todas (",e.length,")"]}),s.jsxs(Gs,{value:"unread",children:["No lidas (",t,")"]}),s.jsxs(Gs,{value:"settings",children:[s.jsx(Cx,{className:"h-4 w-4 mr-2"}),"Configuraes"]})]}),s.jsxs(hr,{value:"all",className:"space-y-4",children:[t>0&&s.jsx("div",{className:"flex justify-end",children:s.jsxs(oe,{variant:"outline",size:"sm",onClick:i,children:[s.jsx(Ea,{className:"h-4 w-4 mr-2"}),"Marcar todas como lidas"]})}),r?s.jsx(Ne,{className:"p-8",children:s.jsx("div",{className:"flex items-center justify-center text-muted-foreground",children:"Carregando notificaes..."})}):e.length===0?s.jsx(Ne,{className:"p-8",children:s.jsxs("div",{className:"flex flex-col items-center justify-center text-muted-foreground space-y-2",children:[s.jsx(Dw,{className:"h-12 w-12 opacity-50"}),s.jsx("p",{className:"text-lg font-medium",children:"Nenhuma notificao"}),s.jsx("p",{className:"text-sm",children:"Voc est em dia! "})]})}):s.jsx("div",{className:"space-y-2",children:e.map(N=>s.jsx(Ne,{className:pt("p-4 cursor-pointer transition-all hover:shadow-md",!N.read&&"border-l-4 border-l-blue-600 bg-accent/50"),onClick:()=>p(N),children:s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"flex-shrink-0 text-3xl",children:v(N.type)}),s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsx("h3",{className:pt("font-medium",!N.read&&"font-semibold"),children:N.title}),s.jsx(oe,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:_=>{_.stopPropagation(),o(N.id)},children:s.jsx(Ba,{className:"h-4 w-4"})})]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:N.message}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-xs text-muted-foreground",children:Ad(new Date(N.created_at),{addSuffix:!0,locale:$s})}),N.action_label&&s.jsxs("span",{className:"text-sm font-medium text-primary",children:[N.action_label," "]})]})]})]})},N.id))})]}),s.jsx(hr,{value:"unread",className:"space-y-4",children:b.length===0?s.jsx(Ne,{className:"p-8",children:s.jsxs("div",{className:"flex flex-col items-center justify-center text-muted-foreground space-y-2",children:[s.jsx(Ea,{className:"h-12 w-12 opacity-50"}),s.jsx("p",{className:"text-lg font-medium",children:"Tudo lido!"}),s.jsx("p",{className:"text-sm",children:"Voc no tem notificaes pendentes"})]})}):s.jsx("div",{className:"space-y-2",children:b.map(N=>s.jsx(Ne,{className:"p-4 cursor-pointer transition-all hover:shadow-md border-l-4 border-l-blue-600 bg-accent/50",onClick:()=>p(N),children:s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"flex-shrink-0 text-3xl",children:v(N.type)}),s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsx("h3",{className:"font-semibold",children:N.title}),s.jsx(oe,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:_=>{_.stopPropagation(),o(N.id)},children:s.jsx(Ba,{className:"h-4 w-4"})})]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:N.message}),s.jsx("p",{className:"text-xs text-muted-foreground",children:Ad(new Date(N.created_at),{addSuffix:!0,locale:$s})})]})]})},N.id))})}),s.jsx(hr,{value:"settings",children:s.jsxs(Ne,{className:"p-6 space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Canais de Notificao"}),s.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Escolha como voc deseja receber notificaes"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx(ke,{htmlFor:"in-app",children:"Notificaes no App"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Receba notificaes dentro da aplicao"})]}),s.jsx(fi,{id:"in-app",checked:(a==null?void 0:a.enable_in_app)??!0,onCheckedChange:N=>c({enable_in_app:N})})]}),s.jsx(al,{}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx(ke,{htmlFor:"push",children:"Push Notifications"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Receba notificaes mesmo quando no estiver usando o app"})]}),s.jsx(fi,{id:"push",checked:(a==null?void 0:a.enable_push)??!1,onCheckedChange:x})]})]})]}),s.jsx(al,{}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Tipos de Notificao"}),s.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Escolha quais notificaes voc deseja receber"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(ke,{htmlFor:"new-coleta",children:"Novas Coletas"}),s.jsx(fi,{id:"new-coleta",checked:(a==null?void 0:a.notify_new_coleta)??!0,onCheckedChange:N=>c({notify_new_coleta:N})})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(ke,{htmlFor:"status-change",children:"Mudanas de Status"}),s.jsx(fi,{id:"status-change",checked:(a==null?void 0:a.notify_status_change)??!0,onCheckedChange:N=>c({notify_status_change:N})})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(ke,{htmlFor:"messages",children:"Novas Mensagens"}),s.jsx(fi,{id:"messages",checked:(a==null?void 0:a.notify_new_message)??!0,onCheckedChange:N=>c({notify_new_message:N})})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(ke,{htmlFor:"system",children:"Atualizaes do Sistema"}),s.jsx(fi,{id:"system",checked:(a==null?void 0:a.notify_system_updates)??!0,onCheckedChange:N=>c({notify_system_updates:N})})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(ke,{htmlFor:"achievements",children:"Conquistas e Marcos"}),s.jsx(fi,{id:"achievements",checked:(a==null?void 0:a.notify_achievements)??!0,onCheckedChange:N=>c({notify_achievements:N})})]})]})]})]})})]})]})}const jue=()=>{const e=jg(),t=ds();return E.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-background via-primary/5 to-secondary/10 flex items-center justify-center p-4 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[...Array(8)].map((r,a)=>s.jsx(Ee.div,{className:"absolute",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`},animate:{y:[0,-30,0],rotate:[0,180,360],opacity:[.1,.3,.1]},transition:{duration:8+Math.random()*4,repeat:1/0,delay:Math.random()*2},children:s.jsx(cr,{className:"w-12 h-12 text-primary/20"})},a))}),s.jsx(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"max-w-2xl w-full relative z-10",children:s.jsxs(Ne,{className:"p-8 md:p-12 border-2 shadow-2xl bg-card/95 backdrop-blur",children:[s.jsx(Ee.div,{className:"flex justify-center mb-6",initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},children:s.jsxs("div",{className:"relative",children:[s.jsx(Ee.div,{className:"absolute inset-0 rounded-full bg-destructive/20",animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0}}),s.jsx("div",{className:"relative w-24 h-24 rounded-full bg-destructive/10 flex items-center justify-center",children:s.jsx(Kr,{className:"w-12 h-12 text-destructive"})})]})}),s.jsxs(Ee.div,{className:"text-center mb-6",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:[s.jsx("h1",{className:"text-8xl md:text-9xl font-display font-bold text-primary mb-2",children:"404"}),s.jsxs("div",{className:"flex items-center justify-center gap-2 text-muted-foreground mb-2",children:[s.jsx(eo,{className:"w-4 h-4"}),s.jsx("p",{className:"text-sm font-mono",children:e.pathname})]})]}),s.jsxs(Ee.div,{className:"text-center mb-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:[s.jsx("h2",{className:"text-2xl md:text-3xl font-display font-bold mb-3",children:"Pgina no encontrada"}),s.jsx("p",{className:"text-muted-foreground text-lg mb-2",children:"Ops! Parece que voc se perdeu na reciclagem..."}),s.jsx("p",{className:"text-muted-foreground",children:"A pgina que voc est procurando no existe ou foi movida."})]}),s.jsxs(Ee.div,{className:"bg-muted/50 rounded-lg p-6 mb-8",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},children:[s.jsxs("p",{className:"font-semibold mb-3 flex items-center gap-2",children:[s.jsx(cr,{className:"w-4 h-4 text-primary"}),"Sugestes:"]}),s.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground",children:[s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-primary"}),"Verifique se digitou o endereo corretamente"]}),s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-primary"}),"Tente voltar  pgina anterior"]}),s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-primary"}),"Ou retorne  pgina inicial"]})]})]}),s.jsxs(Ee.div,{className:"flex flex-col sm:flex-row gap-3 justify-center",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:[s.jsxs(oe,{size:"lg",onClick:()=>t("/"),className:"gap-2",children:[s.jsx(g4,{className:"w-5 h-5"}),"Ir para Incio"]}),s.jsxs(oe,{size:"lg",variant:"outline",onClick:()=>{window.scrollTo(0,1),setTimeout(()=>window.scrollTo(0,0),10),t(-1)},className:"gap-2",children:[s.jsx(As,{className:"w-5 h-5"}),"Voltar"]})]}),s.jsx(Ee.div,{className:"mt-8 pt-6 border-t text-center",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7},children:s.jsx("img",{src:"/Ciclik_validacoes/ciclik-logo.png",alt:"Ciclik",className:"h-8 mx-auto opacity-50 hover:opacity-100 transition-opacity"})})]})})]})};function Nue(){const[e,t]=E.useState(!0),[r,a]=E.useState([]),[n,i]=E.useState(""),[o,c]=E.useState(""),[d,h]=E.useState(!1);E.useEffect(()=>{p()},[]);const p=async()=>{t(!0);const N=[],_=["ajustes_pontos_manuais","alertas_estoque","cache_notas_fiscais","cdv_certificados","cdv_conciliacoes","cdv_config","cdv_investidores","cdv_leads","cdv_novo","cdv_projetos","cdv_quotas","chatbot_conversas","configuracoes_sistema","cooperativas","cupons","cupons_resgates","emails_cooperativas","emails_investidores","empresas","entregas_reciclaveis","estoque_educacao","estoque_embalagens","estoque_residuos","impacto_bruto","indicacoes","kpis","materiais_coletados_detalhado","materiais_pontuacao","materiais_reciclaveis_usuario","metricas_empresas","missoes","missoes_usuarios","notas_fiscais","notas_fiscais_cooperativa","notificacoes","pontos_mensais_usuarios","produto_embalagens","produtos_ciclik","profiles","questoes_missao","respostas_quiz","saldo_parcial","uib","user_roles","variacoes_peso_entrega"];for(const C of _)try{const{data:T,error:A,count:k}=await J.from(C).select("*",{count:"exact",head:!1}).limit(1);A?A.code==="PGRST116"?N.push({table:C,status:"notFound",message:"Tabela no existe"}):A.code==="42501"?N.push({table:C,status:"noPermission",message:"Sem permisso RLS"}):A.code==="PGRST301"?N.push({table:C,status:"noPermission",message:"JWT expirado ou invlido"}):N.push({table:C,status:"error",message:`[${A.code}] ${A.message.substring(0,50)}`}):(N.push({table:C,status:"success",message:"Acessvel",count:k||0}),h(!0))}catch(T){N.push({table:C,status:"error",message:T.message.substring(0,50)})}a(N);try{const{data:{session:C}}=await J.auth.getSession();i(C?` Autenticado como: ${C.user.email}`:" Nenhum usurio autenticado")}catch(C){i(` Erro: ${C.message}`)}try{const{data:C,error:T}=await J.storage.listBuckets();T?c(` Erro ao acessar storage: ${T.message}`):C&&C.length>0?c(` ${C.length} bucket(s) configurado(s): ${C.map(A=>A.name).join(", ")}`):c(" Nenhum bucket configurado")}catch(C){c(` Erro: ${C.message}`)}t(!1)},x=N=>{switch(N){case"success":return s.jsx(_n,{className:"w-5 h-5 text-green-500"});case"notFound":return s.jsx(Kr,{className:"w-5 h-5 text-gray-400"});case"noPermission":return s.jsx(Kr,{className:"w-5 h-5 text-orange-500"});case"error":return s.jsx(Va,{className:"w-5 h-5 text-red-500"})}},v=N=>({success:{variant:"default",label:"Acessvel"},notFound:{variant:"secondary",label:"No existe"},noPermission:{variant:"destructive",label:"Sem permisso"},error:{variant:"destructive",label:"Erro"}})[N],b=r.filter(N=>N.status==="success").length;return s.jsxs("div",{className:"container mx-auto p-6 max-w-6xl",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-4xl font-bold mb-2",children:" Teste de Conexo Supabase"}),s.jsx("p",{className:"text-muted-foreground",children:"Verificando conectividade e acessibilidade das tabelas do banco de dados"})]}),e?s.jsx(Ne,{children:s.jsx(De,{className:"flex items-center justify-center p-12",children:s.jsxs("div",{className:"text-center",children:[s.jsx(_s,{className:"w-12 h-12 animate-spin mx-auto mb-4 text-primary"}),s.jsx("p",{className:"text-lg",children:"Testando conexo com Supabase..."})]})})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs(Ne,{className:d?"border-green-500":"border-red-500",children:[s.jsxs(Ye,{children:[s.jsx(Qe,{className:"flex items-center gap-2",children:d?s.jsxs(s.Fragment,{children:[s.jsx(_n,{className:"w-6 h-6 text-green-500"}),"Conexo Estabelecida"]}):s.jsxs(s.Fragment,{children:[s.jsx(Va,{className:"w-6 h-6 text-red-500"}),"Problemas na Conexo"]})}),s.jsxs(Tt,{children:[b," de ",r.length," tabelas acessveis"]})]}),s.jsxs(De,{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("strong",{children:"URL:"}),s.jsx("code",{className:"text-sm bg-muted px-2 py-1 rounded",children:"https://yfoqehkemzxbwzrbfubq.supabase.co"})]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Autenticao:"})," ",n]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Storage:"})," ",o]})]})]}),s.jsxs(Ne,{children:[s.jsxs(Ye,{children:[s.jsx(Qe,{children:" Tabelas do Banco de Dados"}),s.jsx(Tt,{children:"Status de acesso s tabelas do projeto"})]}),s.jsx(De,{children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:r.map(N=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-muted/50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[x(N.status),s.jsxs("div",{children:[s.jsx("div",{className:"font-mono font-semibold",children:N.table}),N.count!==void 0&&s.jsxs("div",{className:"text-xs text-muted-foreground",children:[N.count," registro(s)"]})]})]}),s.jsx(Je,{variant:v(N.status).variant,children:v(N.status).label})]},N.table))})})]})]})]})}function Cue(){const[e]=l4(),t=ds(),[r,a]=E.useState("loading"),[n,i]=E.useState("");E.useEffect(()=>{(async()=>{let d;if(window.location.hash){const v=window.location.hash.substring(1);d=new URLSearchParams(v)}else d=e;const h=d.get("access_token"),p=d.get("refresh_token"),x=d.get("type");if(!h||!p||x!=="signup"){a("pending"),i("Verifique seu email para confirmar seu cadastro.");return}try{const{data:v,error:b}=await J.auth.setSession({access_token:h,refresh_token:p});if(b){console.error(" [EMAIL-CONFIRM] Erro na confirmao:",b),a("error"),i("Erro ao confirmar email. O link pode ter expirado.");return}v.user&&(a("success"),i("Email confirmado com sucesso! Voc j pode fazer login."))}catch(v){console.error(" [EMAIL-CONFIRM] Erro inesperado:",v),a("error"),i("Erro ao confirmar email. Por favor, tente novamente.")}})()},[e,t]);const o=()=>{switch(r){case"loading":return s.jsxs(s.Fragment,{children:[s.jsx(_s,{className:"h-16 w-16 text-primary animate-spin mx-auto mb-4"}),s.jsx(Qe,{className:"text-2xl text-center mb-2",children:"Confirmando email..."}),s.jsx(Tt,{className:"text-center",children:"Aguarde enquanto confirmamos seu cadastro."})]});case"success":return s.jsxs(s.Fragment,{children:[s.jsx(Tr,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),s.jsx(Qe,{className:"text-2xl text-center mb-2",children:" Email Confirmado!"}),s.jsx(Tt,{className:"text-center mb-4",children:n}),s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4",children:s.jsxs("p",{className:"text-sm text-green-800 text-center",children:[s.jsx("strong",{children:"Parabns!"})," Sua conta foi ativada com sucesso. Agora voc pode fazer login e comear a usar a plataforma."]})}),s.jsx(oe,{onClick:()=>t("/auth"),className:"w-full",children:"Ir para o Login"})]});case"error":return s.jsxs(s.Fragment,{children:[s.jsx(Va,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),s.jsx(Qe,{className:"text-2xl text-center mb-2",children:"Erro na Confirmao"}),s.jsx(Tt,{className:"text-center mb-4",children:n}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(oe,{onClick:()=>t("/auth"),className:"w-full",children:"Voltar para Login"}),s.jsx(oe,{variant:"outline",onClick:()=>window.location.reload(),className:"w-full",children:"Tentar Novamente"})]})]});case"pending":return s.jsxs(s.Fragment,{children:[s.jsx(sf,{className:"h-16 w-16 text-primary mx-auto mb-4"}),s.jsx(Qe,{className:"text-2xl text-center mb-2",children:"Verifique seu Email"}),s.jsx(Tt,{className:"text-center mb-4",children:"Enviamos um link de confirmao para seu email. Clique no link para ativar sua conta."}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:s.jsxs("p",{className:"text-sm text-blue-800",children:[s.jsx("strong",{children:"Dica:"})," Verifique tambm sua caixa de spam ou lixo eletrnico."]})}),s.jsx(oe,{onClick:()=>t("/auth"),variant:"outline",className:"w-full",children:"Voltar para Login"})]})}};return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-background to-secondary/20 p-4",children:s.jsxs(Ne,{className:"w-full max-w-md shadow-lg",children:[s.jsx(Ye,{children:s.jsx("div",{className:"flex justify-center mb-4",children:s.jsx("img",{src:Sa("ciclik-logo-full.png"),alt:"Ciclik - Recicle e Ganhe",className:"h-20 w-auto object-contain"})})}),s.jsx(De,{className:"space-y-4",children:o()})]})})}const Eue=new RM({defaultOptions:{queries:{refetchOnWindowFocus:!1,staleTime:5*60*1e3}}});function Sue(){const{userRole:e,loading:t,user:r}=sr(),a=jg();return t?null:r?a.pathname==="/termos-pendentes"?null:e==="admin"?s.jsx(ic,{to:"/admin",replace:!0}):e==="cooperativa"?s.jsx(ic,{to:"/cooperative",replace:!0}):e==="empresa"?s.jsx(ic,{to:"/company",replace:!0}):e==="investidor"?s.jsx(ic,{to:"/cdv/investor",replace:!0}):e==="vendedor"||e==="usuario"?s.jsx(ic,{to:"/user",replace:!0}):s.jsx(ic,{to:"/auth",replace:!0}):s.jsx(Ew,{})}function Tue(){return s.jsxs(X8,{children:[s.jsx(cs,{path:"/auth",element:s.jsx(Q9,{})}),s.jsx(cs,{path:"/auth/confirm",element:s.jsx(Cue,{})}),s.jsx(cs,{path:"/forgot-password",element:s.jsx(J9,{})}),s.jsx(cs,{path:"/reset-password",element:s.jsx(eB,{})}),s.jsx(cs,{path:"/",element:s.jsx(Sue,{})}),s.jsx(cs,{path:"/institucional",element:s.jsx(Ew,{})}),s.jsx(cs,{path:"/user",element:s.jsx(ks,{allowedRoles:["usuario","vendedor"],children:s.jsx(KX,{})})}),s.jsx(cs,{path:"/missions",element:s.jsx(ks,{allowedRoles:["usuario","vendedor"],children:s.jsx(ZX,{})})}),s.jsx(cs,{path:"/mission/content/:id",element:s.jsx(ks,{allowedRoles:["usuario","vendedor"],children:s.jsx(yY,{})})}),s.jsx(cs,{path:"/mission/study/:id",element:s.jsx(ks,{allowedRoles:["usuario","vendedor"],children:s.jsx(QX,{})})}),s.jsx(cs,{path:"/mission/quiz/:id",element:s.jsx(ks,{allowedRoles:["usuario","vendedor"],children:s.jsx(cY,{})})}),s.jsx(cs,{path:"/upload-receipt",element:s.jsx(ks,{allowedRoles:["usuario","vendedor"],children:s.jsx(eZ,{})})}),s.jsx(cs,{path:"/select-materials",element:s.jsx(ks,{allowedRoles:["usuario","vendedor"],children:s.jsx(rde,{})})}),s.jsx(cs,{path:"/deliver-recyclables",element:s.jsx(ks,{allowedRoles:["usuario","vendedor"],children:s.jsx(tZ,{})})}),s.jsx(cs,{path:"/delivery-history",element:s.jsx(ks,{allowedRoles:["usuario","vendedor"],children:s.jsx(sZ,{})})}),s.jsx(cs,{path:"/materials-history",element:s.jsx(ks,{allowedRoles:["usuario","vendedor"],children:s.jsx(aZ,{})})}),s.jsx(cs,{path:"/coupons",element:s.jsx(ks,{allowedRoles:["usuario","vendedor"],children:s.jsx(nZ,{})})}),s.jsx(cs,{path:"/redeem-coupons",element:s.jsx(ks,{allowedRoles:["usuario","vendedor"],children:s.jsx(gce,{})})}),s.jsx(cs,{path:"/points-statement",element:s.jsx(ks,{allowedRoles:["usuario","vendedor"],children:s.jsx(ide,{})})}),s.jsx(cs,{path:"/goals",element:s.jsx(ks,{allowedRoles:["usuario","vendedor"],children:s.jsx(ude,{})})}),s.jsx(cs,{path:"/profile",element:s.jsx(ks,{allowedRoles:["usuario","vendedor"],children:s.jsx(CZ,{})})}),s.jsx(cs,{path:"/termos-pendentes",element:s.jsx(ks,{allowedRoles:["admin","usuario","vendedor","cooperativa","investidor"],skipTermosCheck:!0,children:s.jsx(Ale,{})})}),s.jsx(cs,{path:"/notifications",element:s.jsx(ks,{allowedRoles:["usuario","vendedor","cooperativa","empresa","admin","investidor"],children:s.jsx(_ue,{})})}),s.jsx(cs,{path:"/cooperative",element:s.jsx(ks,{allowedRoles:["cooperativa"],children:s.jsx(SZ,{})})}),s.jsx(cs,{path:"/cooperative/scan-qrcode",element:s.jsx(ks,{allowedRoles:["cooperativa"],children:s.jsx(TZ,{})})}),s.jsx(cs,{path:"/cooperative/register-materials/:entregaId",element:s.jsx(ks,{allowedRoles:["cooperativa"],children:s.jsx(WZ,{})})}),s.jsx(cs,{path:"/cooperative/triagem/:entregaId",element:s.jsx(ks,{allowedRoles:["cooperativa"],children:s.jsx(HZ,{})})}),s.jsx(cs,{path:"/cooperative/validate",element:s.jsx(ks,{allowedRoles:["cooperativa"],children:s.jsx(GZ,{})})}),s.jsx(cs,{path:"/cooperative/deliveries",element:s.jsx(ks,{allowedRoles:["cooperativa"],children:s.jsx(KZ,{})})}),s.jsx(cs,{path:"/company",element:s.jsx(ks,{allowedRoles:["empresa"],children:s.jsx(Aoe,{})})}),s.jsx(cs,{path:"/company/metrics",element:s.jsx(ks,{allowedRoles:["empresa"],children:s.jsx(koe,{})})}),s.jsx(cs,{path:"/admin",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(XZ,{})})}),s.jsx(cs,{path:"/admin/missions",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(YZ,{})})}),s.jsx(cs,{path:"/admin/missions/edit/:id",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(ZZ,{})})}),s.jsx(cs,{path:"/admin/coupons",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(QZ,{})})}),s.jsx(cs,{path:"/admin/operadores-logisticos",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(Kne,{})})}),s.jsx(cs,{path:"/admin/companies",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(Xne,{})})}),s.jsx(cs,{path:"/admin/companies/:id/metrics",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(Toe,{})})}),s.jsx(cs,{path:"/admin/users",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(Roe,{})})}),s.jsx(cs,{path:"/admin/kpis",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(Woe,{})})}),s.jsx(cs,{path:"/admin/documentation",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(Hoe,{})})}),s.jsx(cs,{path:"/admin/termos",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(tle,{})})}),s.jsx(cs,{path:"/admin/termos/novo",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(lS,{})})}),s.jsx(cs,{path:"/admin/termos/:id",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(ile,{})})}),s.jsx(cs,{path:"/admin/termos/:id/editar",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(lS,{})})}),s.jsx(cs,{path:"/admin/termos/:id/relatorio",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(ole,{})})}),s.jsx(cs,{path:"/admin/products",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(Qle,{})})}),s.jsx(cs,{path:"/admin/products/report",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(Jle,{})})}),s.jsx(cs,{path:"/admin/products/analysis",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(cce,{})})}),s.jsx(cs,{path:"/admin/settings",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(uce,{})})}),s.jsx(cs,{path:"/admin/gamification",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(hce,{})})}),s.jsx(cs,{path:"/admin/points-audit",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(fce,{})})}),s.jsx(cs,{path:"/admin/delivery-promises",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(nde,{})})}),s.jsx(cs,{path:"/admin/cdv",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(pue,{})})}),s.jsx(cs,{path:"/admin/rotas",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(gue,{})})}),s.jsx(cs,{path:"/admin/interesses",element:s.jsx(ks,{allowedRoles:["admin"],children:s.jsx(yue,{})})}),s.jsx(cs,{path:"/cdv",element:s.jsx(hde,{})}),s.jsx(cs,{path:"/investidor",element:s.jsx(bS,{})}),s.jsx(cs,{path:"/cdv-investidor",element:s.jsx(bS,{})}),s.jsx(cs,{path:"/apresentacao",element:s.jsx(Ew,{})}),s.jsx(cs,{path:"/apresentacao-investidor",element:s.jsx(bue,{})}),s.jsx(cs,{path:"/cdv/investor",element:s.jsx(ks,{allowedRoles:["investidor"],children:s.jsx(Rde,{})})}),s.jsx(cs,{path:"/cdv/certificate/:id",element:s.jsx(ks,{allowedRoles:["investidor"],children:s.jsx(Pde,{})})}),s.jsx(cs,{path:"/preview-certificado",element:s.jsx(Ide,{})}),s.jsx(cs,{path:"/cdv/validate/:id",element:s.jsx(Ode,{})}),s.jsx(cs,{path:"/test/supabase",element:s.jsx(Nue,{})}),s.jsx(cs,{path:"*",element:s.jsx(jue,{})})]})}const Aue=()=>s.jsx(MM,{client:Eue,children:s.jsxs(Zo,{children:[s.jsx(vD,{}),s.jsx(YD,{}),s.jsx(z7,{}),s.jsx(K8,{basename:"/Ciclik_validacoes",future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:s.jsx(A7,{children:s.jsx(k7,{children:s.jsx(Tue,{})})})})]})}),kue=console.warn;console.warn=(...e)=>{var r;const t=((r=e[0])==null?void 0:r.toString())||"";t.includes("Download the React DevTools")||t.includes("React DevTools")||t.includes("icon from the Manifest")||kue(...e)};const Rue=console.error;console.error=(...e)=>{var r;const t=((r=e[0])==null?void 0:r.toString())||"";t.includes("icon from the Manifest")||t.includes("Download error or resource isn't a valid image")||Rue(...e)};u4(document.getElementById("root")).render(s.jsx(Aue,{}));
